<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: bridge.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">bridge.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d0/d95/bridge_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Asterisk -- An open source telephony toolkit.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (C) 2007 - 2009, Digium, Inc.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Joshua Colp &lt;jcolp@digium.com&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * See http://www.asterisk.org for more information about</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Asterisk project. Please do not directly contact</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * any of the maintainers of this project for assistance;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * the project provides a web site, mailing lists and IRC</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * channels for your use.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * This program is free software, distributed under the terms of</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * at the top of the source tree.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/*! \file</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * \brief Bridging API</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * \author Joshua Colp &lt;jcolp@digium.com&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/*** MODULEINFO</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">   &lt;support_level&gt;core&lt;/support_level&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/*** DOCUMENTATION</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">   &lt;manager name=&quot;BridgeTechnologyList&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">         List available bridging technologies and their statuses.</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">         &lt;para&gt;Returns detailed information about the available bridging technologies.&lt;/para&gt;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;BridgeTechnologySuspend&lt;/ref&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;BridgeTechnologyUnsuspend&lt;/ref&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">   &lt;manager name=&quot;BridgeTechnologySuspend&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">         Suspend a bridging technology.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">         &lt;parameter name=&quot;BridgeTechnology&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">            &lt;para&gt;The name of the bridging technology to suspend.&lt;/para&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">         &lt;para&gt;Marks a bridging technology as suspended, which prevents subsequently created bridges from using it.&lt;/para&gt;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;BridgeTechnologySuspend&lt;/ref&gt;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;BridgeTechnologyUnsuspend&lt;/ref&gt;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">   &lt;manager name=&quot;BridgeTechnologyUnsuspend&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">         Unsuspend a bridging technology.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">         &lt;parameter name=&quot;BridgeTechnology&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">            &lt;para&gt;The name of the bridging technology to unsuspend.&lt;/para&gt;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">         &lt;para&gt;Clears a previously suspended bridging technology, which allows subsequently created bridges to use it.&lt;/para&gt;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;BridgeTechnologyList&lt;/ref&gt;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;BridgeTechnologySuspend&lt;/ref&gt;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">***/</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db2/asterisk_8h.html">asterisk.h</a>&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d8c/logger_8h.html">asterisk/logger.h</a>&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7b/channel_8h.html">asterisk/channel.h</a>&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d5b/options_8h.html">asterisk/options.h</a>&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d60/utils_8h.html">asterisk/utils.h</a>&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d42/lock_8h.html">asterisk/lock.h</a>&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d90/linkedlists_8h.html">asterisk/linkedlists.h</a>&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d56/bridge_8h.html">asterisk/bridge.h</a>&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dde/bridge__internal_8h.html">asterisk/bridge_internal.h</a>&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html">asterisk/bridge_channel_internal.h</a>&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d7a/bridge__features_8h.html">asterisk/bridge_features.h</a>&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d1e/bridge__basic_8h.html">asterisk/bridge_basic.h</a>&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d3b/bridge__technology_8h.html">asterisk/bridge_technology.h</a>&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d41/bridge__channel_8h.html">asterisk/bridge_channel.h</a>&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d85/bridge__after_8h.html">asterisk/bridge_after.h</a>&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d4e/stasis__bridges_8h.html">asterisk/stasis_bridges.h</a>&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d4a/stasis__channels_8h.html">asterisk/stasis_channels.h</a>&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d8f/stasis__cache__pattern_8h.html">asterisk/stasis_cache_pattern.h</a>&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html">asterisk/app.h</a>&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4d/file_8h.html">asterisk/file.h</a>&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d16/module_8h.html">asterisk/module.h</a>&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da5/astobj2_8h.html">asterisk/astobj2.h</a>&quot;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de0/pbx_8h.html">asterisk/pbx.h</a>&quot;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/ddc/test_8h.html">asterisk/test.h</a>&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d78/__private_8h.html">asterisk/_private.h</a>&quot;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/ddb/heap_8h.html">asterisk/heap.h</a>&quot;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dce/say_8h.html">asterisk/say.h</a>&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d41/timing_8h.html">asterisk/timing.h</a>&quot;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d0f/stringfields_8h.html">asterisk/stringfields.h</a>&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d07/musiconhold_8h.html">asterisk/musiconhold.h</a>&quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/features_8h.html">asterisk/features.h</a>&quot;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db0/cli_8h.html">asterisk/cli.h</a>&quot;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d33/parking_8h.html">asterisk/parking.h</a>&quot;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da6/core__local_8h.html">asterisk/core_local.h</a>&quot;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dea/core__unreal_8h.html">asterisk/core_unreal.h</a>&quot;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/da3/causes_8h.html">asterisk/causes.h</a>&quot;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/*! All bridges container. */</span></div><div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aaa64e0df7082a1a31b65d0c956bc2534">  123</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d95/bridge_8c.html#aaa64e0df7082a1a31b65d0c956bc2534">bridges</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="../../da/de0/structbridge__technologies.html#ace4e0066a5b24f84b90536e9906619f6">  125</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d90/linkedlists_8h.html#a39918fd433ac42184b152c86016ef139">AST_RWLIST_HEAD_STATIC</a>(<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, <a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3a4e6edefaf27f09e1bc4957eebd7b03">  127</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a4e6edefaf27f09e1bc4957eebd7b03">optimization_id</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">/* Initial starting point for the bridge array of channels */</span></div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a19adb1771f07f8371b7ae604b54b4752">  130</a></span>&#160;<span class="preprocessor">#define BRIDGE_ARRAY_START 128</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">/* Grow rate of bridge array of channels */</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a2bb5c159af5ed3ac286e5129999b351b">  133</a></span>&#160;<span class="preprocessor">#define BRIDGE_ARRAY_GROW 32</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/* Variable name - stores peer information about the most recent blind transfer */</span></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a46076d7116497bc6fd9c69b57d15d18c">  136</a></span>&#160;<span class="preprocessor">#define BLINDTRANSFER &quot;BLINDTRANSFER&quot;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">/* Variable name - stores peer information about the most recent attended transfer */</span></div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#acace2c216334d2be31f0323bfc4af2ab">  139</a></span>&#160;<span class="preprocessor">#define ATTENDEDTRANSFER &quot;ATTENDEDTRANSFER&quot;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1">cleanup_video_mode</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/*! Default DTMF keys for built in features */</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a2df991cc86ea9bb473f730f2af4b2649">  144</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="../../d0/d95/bridge_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a>[<a class="code" href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717">AST_BRIDGE_BUILTIN_END</a>][<a class="code" href="../../dc/d7a/bridge__features_8h.html#a8f882f130b89dd63d656d176884095a1">MAXIMUM_DTMF_FEATURE_STRING</a>];</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/*! Function handlers for the built in features */</span></div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">  147</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[<a class="code" href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717">AST_BRIDGE_BUILTIN_END</a>];</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/*! Function handlers for built in interval features */</span></div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">  150</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#acf985c9cba5e118bd24fdf980b59f955">ast_bridge_builtin_set_limits_fn</a> <a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>[<a class="code" href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960dad5e042dd402144426b46a6590485d88b">AST_BRIDGE_BUILTIN_INTERVAL_END</a>];</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/*! Bridge manager service request */</span></div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="../../db/d89/structbridge__manager__request.html">  153</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../db/d89/structbridge__manager__request.html">bridge_manager_request</a> {<span class="comment"></span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">   /*! List of bridge service requests. */</span></div><div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="../../db/d89/structbridge__manager__request.html#aadb321faae7db85784fe74bf2f20dfe1">  155</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../db/d89/structbridge__manager__request.html">bridge_manager_request</a>) <a class="code" href="../../db/d89/structbridge__manager__request.html#a3ed9421e7d90ae54555fbcf4bc96d2b4">node</a>;<span class="comment"></span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">   /*! Refed bridge requesting service. */</span></div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">  157</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;};</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../d4/d7c/structbridge__manager__controller.html">  160</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d7c/structbridge__manager__controller.html">bridge_manager_controller</a> {<span class="comment"></span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">   /*! Condition, used to wake up the bridge manager thread. */</span></div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">  162</a></span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab134d98cdfe7de0f7a72b377c0765dc7">ast_cond_t</a> <a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>;<span class="comment"></span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">   /*! Queue of bridge service requests. */</span></div><div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="../../d4/d7c/structbridge__manager__controller.html#a50f9ed6ff4633443b179ef06233d8389">  164</a></span>&#160;   <a class="code" href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a>(, <a class="code" href="../../db/d89/structbridge__manager__request.html">bridge_manager_request</a>) service_requests;<span class="comment"></span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">   /*! Manager thread */</span></div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="../../d4/d7c/structbridge__manager__controller.html#a01f75a9ad916f63a94e06a27635ba278">  166</a></span>&#160;   pthread_t <a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>;<span class="comment"></span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">   /*! TRUE if the manager needs to stop. */</span></div><div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="../../d4/d7c/structbridge__manager__controller.html#a111277a0849f92b793ed6aa1efe54462">  168</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a111277a0849f92b793ed6aa1efe54462">stop</a>:1;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;};</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">/*! Bridge manager controller. */</span></div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a078811ef622f47d248e59caeb8941ad0">  172</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d7c/structbridge__manager__controller.html">bridge_manager_controller</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a078811ef622f47d248e59caeb8941ad0">bridge_manager</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab9fc36aaff74fae0efd0f683353baa7e">  174</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d95/bridge_8c.html#ab9fc36aaff74fae0efd0f683353baa7e">ast_bridges</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(bridges);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> * \brief Request service for a bridge from the bridge manager.</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> * \param bridge Requesting service.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#adf663a62058148fc5107fceda14b59a9">  188</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#adf663a62058148fc5107fceda14b59a9">bridge_manager_service_req</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d89/structbridge__manager__request.html">bridge_manager_request</a> *<a class="code" href="../../d0/d29/chan__pjsip_8c.html#a4e2e6fb7d874f0d2deddd2ecfc8afb32">request</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(bridge_manager);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="keywordflow">if</span> (bridge_manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a111277a0849f92b793ed6aa1efe54462">stop</a>) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(bridge_manager);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="comment">/* Create the service request. */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   request = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*request));</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="keywordflow">if</span> (!request) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">/* Well. This isn&#39;t good. */</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(bridge_manager);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, +1);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   request-&gt;<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a> = <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="comment">/* Put request into the queue and wake the bridge manager. */</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;bridge_manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a4c0e99774fbc08689db34d6ad5104f35">service_requests</a>, request, <a class="code" href="../../d5/da1/structnode.html">node</a>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;bridge_manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(bridge_manager);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad28289949f5625726a53e10379eea032">  214</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad28289949f5625726a53e10379eea032">__ast_bridge_technology_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *technology, <span class="keyword">struct</span> <a class="code" href="../../d9/df5/structast__module.html">ast_module</a> *module)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *current;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="comment">/* Perform a sanity check to make sure the bridge technology conforms to our needed requirements */</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      || !technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      || !technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a81567dc49b2915ad81d9cb89dbbfbc70">write</a>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge technology %s failed registration sanity check.\n&quot;</span>,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="comment">/* Look for duplicate bridge technology already using this name, or already registered */</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, current, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">if</span> ((!strcasecmp(current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)) || (current == technology)) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;A bridge technology of %s already claims to exist in our world.\n&quot;</span>,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="comment">/* Copy module pointer so reference counting can keep the module from unloading */</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a> = module;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="comment">/* Find the correct position to insert the technology. */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, current, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">/* Put the highest preference tech&#39;s first in the list. */</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span> (technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a> &gt;= current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a>) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#acf8253a64f9a4e2170454f4bf0559e33">AST_RWLIST_INSERT_BEFORE_CURRENT</a>(technology, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordflow">if</span> (!current) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="comment">/* Insert our new bridge technology to the end of the list. */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, technology, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Registered bridge technology %s\n&quot;</span>, technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ac74018e91ff4fc7374f6137dd76c40f5">  265</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#ac74018e91ff4fc7374f6137dd76c40f5">ast_bridge_technology_unregister</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *technology)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *current;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="comment">/* Ensure the bridge technology is registered before removing it */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, current, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">if</span> (current == technology) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(<a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Unregistered bridge technology %s\n&quot;</span>, technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   <span class="keywordflow">return</span> current ? 0 : -1;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> * \brief Put an action onto the specified bridge. Don&#39;t dup the action frame.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> * \param bridge What to queue the action on.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> * \param action What to do.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a33e57ad4748df60e32e16393cfd285b4">  296</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a33e57ad4748df60e32e16393cfd285b4">bridge_queue_action_nodup</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *action)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: queueing action type:%u sub:%d\n&quot;</span>,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, action-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>, action-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a641f383bfa9823e61aad41ba854dbe26">action_queue</a>, action, <a class="code" href="../../d9/d42/structframe__list.html">frame_list</a>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#adf663a62058148fc5107fceda14b59a9">bridge_manager_service_req</a>(bridge);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a4a80435538e9bd93331f54d6aac9201b">  307</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a4a80435538e9bd93331f54d6aac9201b">ast_bridge_queue_action</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *action)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *dup;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   dup = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a417ee8a61074ec7570971202908e2c4f">ast_frdup</a>(action);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="keywordflow">if</span> (!dup) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a33e57ad4748df60e32e16393cfd285b4">bridge_queue_action_nodup</a>(bridge, dup);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3dfc360c4ef5a43d854d75e9b94b58e1">  319</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3dfc360c4ef5a43d854d75e9b94b58e1">bridge_dissolve</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">int</span> cause)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;{</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> action = {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      .<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0af36653b08c00f5d824ed6046e9233ef9">AST_FRAME_BRIDGE_ACTION</a>,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      .subclass.integer = <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#adadb2f6b306233caecdabcf1a7440b0aad8d415b984f05d05f9295fb6cbee3004">BRIDGE_CHANNEL_ACTION_DEFERRED_DISSOLVING</a>,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   };</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a> = 1;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordflow">if</span> (cause &lt;= 0) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      cause = <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a> = cause;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: dissolving bridge with cause %d(%s)\n&quot;</span>,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, cause, <a class="code" href="../../d5/d7b/channel_8h.html#abb5f5ff5988e039726f2c0d982342378">ast_cause2str</a>(cause));</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, cause);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="comment">/* Must defer dissolving bridge because it is already locked. */</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a4a80435538e9bd93331f54d6aac9201b">ast_bridge_queue_action</a>(bridge, &amp;action);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"> * \brief Check if a bridge should dissolve because of a stolen channel and do it.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> * \param bridge Bridge to check.</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"> * \param bridge_channel Stolen channel causing the check.  It is not in the bridge to check and may be in another bridge.</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"> * \note On entry, bridge and bridge_channel-&gt;bridge are already locked.</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae73ffed95c5c683369117e42e864d3c4">  361</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ae73ffed95c5c683369117e42e864d3c4">bridge_dissolve_check_stolen</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a080125973deec97104866dd31867e3ce">usable</a></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      &amp;&amp; <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a88f541f13934e4f8ad5d88e31f694e2b">AST_BRIDGE_CHANNEL_FLAG_DISSOLVE_HANGUP</a>)) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="comment">/* The stolen channel controlled the bridge it was stolen from. */</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a3dfc360c4ef5a43d854d75e9b94b58e1">bridge_dissolve</a>(bridge, 0);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> &lt; 2</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      &amp;&amp; <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aab11deff15a9ae22b58e49e9d6d53e16">AST_BRIDGE_FLAG_DISSOLVE_HANGUP</a>)) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">       * The stolen channel has not left enough channels to keep the</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">       * bridge alive.  Assume the stolen channel hung up.</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a3dfc360c4ef5a43d854d75e9b94b58e1">bridge_dissolve</a>(bridge, 0);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> * \brief Update connected line information after a bridge has been reconfigured.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"> * \param bridge The bridge itself.</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aa6c59e682620f50fc028a30c822e083c">  393</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aa6c59e682620f50fc028a30c822e083c">bridge_reconfigured_connected_line_update</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;{</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> connected;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel = <a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>), *peer;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[1024];</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="keywordtype">size_t</span> datalen;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel ||</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      !(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a> &amp; (<a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaf483c951b835fcc35da807b6a4b12509">AST_BRIDGE_CAPABILITY_1TO1MIX</a> | <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaec2d0fff3f4f8df0d9ef6b4d9be78380">AST_BRIDGE_CAPABILITY_NATIVE</a>)) ||</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      !(peer = <a class="code" href="../../de/d41/bridge__channel_8h.html#a0a9bea2845810c6891440a012a275a36">ast_bridge_channel_peer</a>(bridge_channel)) ||</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d">AST_FLAG_ZOMBIE</a>) ||</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(peer-&gt;chan), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d">AST_FLAG_ZOMBIE</a>) ||</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) ||</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a>(peer-&gt;chan)) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a>(&amp;connected);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a>(&amp;connected, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordflow">if</span> ((datalen = <a class="code" href="../../d5/d7b/channel_8h.html#ab380c81e4514ab48ca8402f7950a354a">ast_connected_line_build_data</a>(data, <span class="keyword">sizeof</span>(data), &amp;connected, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) != (<span class="keywordtype">size_t</span>) -1) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#abc0302bab9fb2f318db695fe1f9047d8">ast_bridge_channel_queue_control_data</a>(peer, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>, data, datalen);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(peer-&gt;chan);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a>(&amp;connected, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer-&gt;chan));</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer-&gt;chan);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keywordflow">if</span> ((datalen = <a class="code" href="../../d5/d7b/channel_8h.html#ab380c81e4514ab48ca8402f7950a354a">ast_connected_line_build_data</a>(data, <span class="keyword">sizeof</span>(data), &amp;connected, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) != (<span class="keywordtype">size_t</span>) -1) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#abc0302bab9fb2f318db695fe1f9047d8">ast_bridge_channel_queue_control_data</a>(bridge_channel, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>, data, datalen);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;connected);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"> * \brief Complete joining a channel to the bridge.</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"> * \param bridge What to operate upon.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"> * \param bridge_channel What is joining the bridge technology.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"> * \note On entry, bridge is already locked.</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a0fa5438fc193ab54b5deb0c80a1ca76f">  443</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a0fa5438fc193ab54b5deb0c80a1ca76f">bridge_channel_complete_join</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel)</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;{</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="comment">/* Tell the bridge technology we are joining so they set us up */</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: %p(%s) is joining %s technology\n&quot;</span>,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ae1d135c1fb07550e5f23ef965b58ce35">join</a></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      &amp;&amp; bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ae1d135c1fb07550e5f23ef965b58ce35">join</a>(bridge, bridge_channel)) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="comment">/* We cannot leave the channel partially in the bridge so we must kick it out */</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: %p(%s) failed to join %s technology (Kicking it out)\n&quot;</span>,</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a82df0e78742524f455a24e874ba28f49">just_joined</a> = 1;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>, 0);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a82df0e78742524f455a24e874ba28f49">just_joined</a> = 0;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">    * When a channel joins the bridge its streams need to be mapped to the bridge&#39;s</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">    * media types vector. This way all streams map to the same media type index for</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">    * a given channel.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a71189769795dc03db956d60eca08d377">stream_topology_changed</a>) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a71189769795dc03db956d60eca08d377">stream_topology_changed</a>(</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;         bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, bridge_channel);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#aa464f1acd378d6a297a514007cec8d18">ast_bridge_channel_stream_map</a>(bridge_channel);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;}</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"> * \brief Complete joining new channels to the bridge.</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"> * \param bridge Check for new channels on this bridge.</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"> * \note On entry, bridge is already locked.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ac776f2eff5f02e48a3c6492a6dccd444">  486</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ac776f2eff5f02e48a3c6492a6dccd444">bridge_complete_join</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;{</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">       * No sense in completing the join on channels for a dissolved</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">       * bridge.  They are just going to be removed soon anyway.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">       * However, we do have reason to abort here because the bridge</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">       * technology may not be able to handle the number of channels</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">       * still in the bridge.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#aeefa5121d4fde67d827c3daa2ef778d3">bridge_channel_queue_deferred_frames</a>(bridge_channel);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">if</span> (!bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a82df0e78742524f455a24e874ba28f49">just_joined</a>) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a0fa5438fc193ab54b5deb0c80a1ca76f">bridge_channel_complete_join</a>(bridge, bridge_channel);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">/*! \brief Helper function used to find the &quot;best&quot; bridge technology given specified capabilities */</span></div><div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a407073589cd8fa355d5772da7f9a6529">  511</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a407073589cd8fa355d5772da7f9a6529">find_best_technology</a>(uint32_t <a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a>, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;{</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *current;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *best = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, current, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">suspended</a>) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge technology %s is suspended. Skipping.\n&quot;</span>,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordflow">if</span> (!(current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a> &amp; capabilities)) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge technology %s does not have any capabilities we want.\n&quot;</span>,</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      <span class="keywordflow">if</span> (best &amp;&amp; current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a> &lt;= best-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a>) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge technology %s has less preference than %s (%u &lt;= %u). Skipping.\n&quot;</span>,</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, best-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a>, best-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ab941919d17b5a06038e085389ec32572">compatible</a> &amp;&amp; !current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ab941919d17b5a06038e085389ec32572">compatible</a>(bridge)) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge technology %s is not compatible with properties of existing bridge.\n&quot;</span>,</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d16/module_8h.html#ad2dd3dce05926913c40b883cc7cff0a8">ast_module_running_ref</a>(current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>)) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge technology %s is not running, skipping.\n&quot;</span>, current-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">if</span> (best) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;         <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(best-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      }</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      best = current;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keywordflow">if</span> (best) {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Chose bridge technology %s\n&quot;</span>, best-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordflow">return</span> best;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="../../d0/df8/structtech__deferred__destroy.html">  557</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d0/df8/structtech__deferred__destroy.html">tech_deferred_destroy</a> {</div><div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="../../d0/df8/structtech__deferred__destroy.html#afd481155c858ef52f7b0c4c5906f0ef5">  558</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *<a class="code" href="../../d0/df8/structtech__deferred__destroy.html#afd481155c858ef52f7b0c4c5906f0ef5">tech</a>;</div><div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="../../d0/df8/structtech__deferred__destroy.html#a19aa04db5508cf9496602e694dc69e2f">  559</a></span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../d0/df8/structtech__deferred__destroy.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;};</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"> * \brief Deferred destruction of bridge tech private structure.</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"> * \param bridge What to execute the action on.</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"> * \param action Deferred bridge tech destruction.</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"> * \note On entry, bridge must not be locked.</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af1a0d3e827043d45b8326ae30f23a116">  574</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#af1a0d3e827043d45b8326ae30f23a116">bridge_tech_deferred_destroy</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *action)</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;{</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/df8/structtech__deferred__destroy.html">tech_deferred_destroy</a> *deferred = action-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> dummy_bridge = {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      .<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a> = deferred-&gt;<a class="code" href="../../d0/df8/structtech__deferred__destroy.html#afd481155c858ef52f7b0c4c5906f0ef5">tech</a>,</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      .tech_pvt = deferred-&gt;<a class="code" href="../../d0/df8/structtech__deferred__destroy.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      .creator = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a6e62c2774ca18846e6e45057fb8b7a22">creator</a>,</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      .name = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      .uniqueid = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      };</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology destructor (deferred, dummy)\n&quot;</span>,</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a5e3829ec44bca8cdbb274a6bb478b07f">destroy</a>(&amp;dummy_bridge);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"> * \brief Handle bridge action frame.</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"> * \param bridge What to execute the action on.</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"> * \param action What to do.</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment"> * \note On entry, bridge is already locked.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"> * \note Can be called by the bridge destructor.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab01c130ded2ec421cf217cc1d5d98816">  604</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab01c130ded2ec421cf217cc1d5d98816">bridge_action_bridge</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *action)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="preprocessor">#if 0 </span><span class="comment">/* In case we need to know when the destructor is calling us. */</span><span class="preprocessor"></span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keywordtype">int</span> in_destructor = !<a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, 0);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <span class="keywordflow">switch</span> (action-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#adadb2f6b306233caecdabcf1a7440b0aa00f1087c3c938aa4672d997d16930fb9">BRIDGE_CHANNEL_ACTION_DEFERRED_TECH_DESTROY</a>:</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#af1a0d3e827043d45b8326ae30f23a116">bridge_tech_deferred_destroy</a>(bridge, action);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#adadb2f6b306233caecdabcf1a7440b0aad8d415b984f05d05f9295fb6cbee3004">BRIDGE_CHANNEL_ACTION_DEFERRED_DISSOLVING</a>:</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a5b1a8e69c6546121e0b4dcec16be3373">dissolving</a>(bridge);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="comment">/* Unexpected deferred action type.  Should never happen. */</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"> * \brief Do any pending bridge actions.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"> * \param bridge What to do actions on.</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"> * \note On entry, bridge is already locked.</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"> * \note Can be called by the bridge destructor.</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ac31ac154d47208c964f68cb3f03cb997">  640</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ac31ac154d47208c964f68cb3f03cb997">bridge_handle_actions</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *action;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <span class="keywordflow">while</span> ((action = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a641f383bfa9823e61aad41ba854dbe26">action_queue</a>, <a class="code" href="../../d9/d42/structframe__list.html">frame_list</a>))) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordflow">switch</span> (action-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0af36653b08c00f5d824ed6046e9233ef9">AST_FRAME_BRIDGE_ACTION</a>:</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#ab01c130ded2ec421cf217cc1d5d98816">bridge_action_bridge</a>(bridge, action);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         <span class="comment">/* Unexpected deferred frame type.  Should never happen. */</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(action);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;}</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a99f699e128b44c627baa3587d99a0661">  658</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a99f699e128b44c627baa3587d99a0661">destroy_bridge</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a> = obj;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: actually destroying %s bridge, nobody wants it anymore\n&quot;</span>,</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#abc1d460759585bcaddb392327e9cc9ea">construction_completed</a>) {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#ae533d4edc97a21476c3f0600a6665eb1">bridge_topics_destroy</a>(bridge);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <span class="comment">/* Do any pending actions in the context of destruction. */</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ac31ac154d47208c964f68cb3f03cb997">bridge_handle_actions</a>(bridge);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <span class="comment">/* There should not be any channels left in the bridge. */</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>));</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s bridge destructor\n&quot;</span>,</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#abf4c4f9d73d43950e5e1882db332f00b">destroy</a>(bridge);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <span class="comment">/* Pass off the bridge to the technology to destroy if needed */</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>) {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology stop\n&quot;</span>,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ac53486d83b1e8c097744f32d269a3ff3">stop</a>) {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ac53486d83b1e8c097744f32d269a3ff3">stop</a>(bridge);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology destructor\n&quot;</span>,</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a5e3829ec44bca8cdbb274a6bb478b07f">destroy</a>) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a5e3829ec44bca8cdbb274a6bb478b07f">destroy</a>(bridge);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a19fea4d448628d518b0043b2b17037dd">media_types</a>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a> = 0;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1">cleanup_video_mode</a>(bridge);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(bridge);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a7dbe1cd4b391636e49491eafab9095e0">current_snapshot</a>);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;}</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a8690315fd0d12e16671f9d22eacfa8f0">  709</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a8690315fd0d12e16671f9d22eacfa8f0">bridge_register</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;{</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keywordflow">if</span> (bridge) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#abc1d460759585bcaddb392327e9cc9ea">construction_completed</a> = 1;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#aa8bd54e09b0c348a3232053e4be9bcfb">ast_bridge_publish_state</a>(bridge);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(bridges, bridge)) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(bridge, 0);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         bridge = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#adf0e64783980f762008ac238f2dbe715">  724</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#adf0e64783980f762008ac238f2dbe715">bridge_alloc</a>(<span class="keywordtype">size_t</span> size, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/dd3/structast__bridge__methods.html">ast_bridge_methods</a> *<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>)</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="comment">/* Check v_table that all methods are present. */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="keywordflow">if</span> (!v_table</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      || !v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      || !v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#abf4c4f9d73d43950e5e1882db332f00b">destroy</a></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      || !v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a5b1a8e69c6546121e0b4dcec16be3373">dissolving</a></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      || !v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a60b76bf280f288b3ef3f1facf873b104">push</a></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      || !v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#adcfc7ef2b1ee5305158a584970ddea65">pull</a></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      || !v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#ab72b2fb844367bda53a258a6059f6290">notify_masquerade</a></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      || !v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#ad74029594a0d1e6b9863ce3f02c82d25">get_merge_priority</a>) {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Virtual method table for bridge class %s not complete.\n&quot;</span>,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;         v_table &amp;&amp; v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> ? v_table-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> : <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   }</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   bridge = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(size, <a class="code" href="../../d0/d95/bridge_8c.html#a99f699e128b44c627baa3587d99a0661">destroy_bridge</a>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="keywordflow">if</span> (!bridge) {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(bridge, 80)) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(bridge);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a> = <a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a19fea4d448628d518b0043b2b17037dd">media_types</a>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a38c501242153bbe13d0eda31220637b8">  760</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a38c501242153bbe13d0eda31220637b8">bridge_base_init</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>, uint32_t capabilities, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d84/structast__bridge.html#a6e62c2774ca18846e6e45057fb8b7a22">creator</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;{</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="keywordtype">char</span> uuid_hold[<a class="code" href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a>];</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <span class="keywordflow">if</span> (!<span class="keyword">self</span>) {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(<span class="keyword">self</span>, <a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <a class="code" href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a>(uuid_hold, <a class="code" href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(<span class="keyword">self</span>, <a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, uuid_hold);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(<span class="keyword">self</span>, creator, creator);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(creator)) {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(<span class="keyword">self</span>, name, name);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;self-&gt;feature_flags, flags);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   <span class="keyword">self</span>-&gt;allowed_capabilities = capabilities;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444af791f0352f324b81c3eb1adcedc31364">AST_BRIDGE_FLAG_INVISIBLE</a>)) {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a47e2e9503f7beb080c820edc385d0ca6">bridge_topics_init</a>(<span class="keyword">self</span>) != 0) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge %s: Could not initialize topics\n&quot;</span>,</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            self-&gt;uniqueid);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<span class="keyword">self</span>, -1);</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <span class="comment">/* Use our helper function to find the &quot;best&quot; bridge technology. */</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <span class="keyword">self</span>-&gt;technology = <a class="code" href="../../d0/d95/bridge_8c.html#a407073589cd8fa355d5772da7f9a6529">find_best_technology</a>(capabilities, <span class="keyword">self</span>);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   <span class="keywordflow">if</span> (!self-&gt;technology) {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge %s: Could not create class %s.  No technology to support it.\n&quot;</span>,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;         self-&gt;uniqueid, self-&gt;v_table-&gt;name);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<span class="keyword">self</span>, -1);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   }</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   <span class="comment">/* Pass off the bridge to the technology to manipulate if needed */</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology constructor\n&quot;</span>,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      self-&gt;uniqueid, self-&gt;technology-&gt;name);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="keywordflow">if</span> (self-&gt;technology-&gt;create &amp;&amp; self-&gt;technology-&gt;create(<span class="keyword">self</span>)) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge %s: failed to setup bridge technology %s\n&quot;</span>,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         self-&gt;uniqueid, self-&gt;technology-&gt;name);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<span class="keyword">self</span>, -1);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology start\n&quot;</span>,</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      self-&gt;uniqueid, self-&gt;technology-&gt;name);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   <span class="keywordflow">if</span> (self-&gt;technology-&gt;start &amp;&amp; self-&gt;technology-&gt;start(<span class="keyword">self</span>)) {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge %s: failed to start bridge technology %s\n&quot;</span>,</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;         self-&gt;uniqueid, self-&gt;technology-&gt;name);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<span class="keyword">self</span>, -1);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <span class="keywordflow">if</span> (!(flags &amp; AST_BRIDGE_FLAG_INVISIBLE)) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a7bdfd8273bb885f7a65f6f5d8188c915">ast_bridge_topic</a>(<span class="keyword">self</span>)) {</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<span class="keyword">self</span>, -1);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   <span class="keyword">self</span>-&gt;creationtime = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">self</span>;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"> * \brief ast_bridge base class destructor.</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"> * \note Stub because of nothing to do.</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00841"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a8eb8e30144686ae8a70116b25c777bfd">  841</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a8eb8e30144686ae8a70116b25c777bfd">bridge_base_destroy</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;{</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"> * \brief The bridge is being dissolved.</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3cc48dec5fd6f558ac127f3a4fe50fe8">  854</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3cc48dec5fd6f558ac127f3a4fe50fe8">bridge_base_dissolving</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;{</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(bridges, <span class="keyword">self</span>);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"> * \brief ast_bridge base push method.</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment"> * \param bridge_channel Bridge channel to push.</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment"> * \param swap Bridge channel to swap places with if not NULL.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment"> * \note On entry, self is already locked.</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment"> * \note Stub because of nothing to do.</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"> * \retval -1 on failure</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00874"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a7522973439e934a28037444ca5f56599">  874</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a7522973439e934a28037444ca5f56599">bridge_base_push</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *swap)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;{</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment"> * \brief ast_bridge base pull method.</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"> * \param bridge_channel Bridge channel to pull.</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"> * \note On entry, self is already locked.</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00891"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae7078806f36ab599840879be881a2c59">  891</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ae7078806f36ab599840879be881a2c59">bridge_base_pull</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;{</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a488815ff58d7ea1d8f5e7ce0ef370df5">ast_bridge_features_remove</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;}</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment"> * \brief ast_bridge base notify_masquerade method.</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment"> * \param bridge_channel Bridge channel that was masqueraded.</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"> * \note On entry, self is already locked.</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00908"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af326bb3722c4cdd5413a8f4744a6e5d1">  908</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#af326bb3722c4cdd5413a8f4744a6e5d1">bridge_base_notify_masquerade</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel)</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;{</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   <span class="keyword">self</span>-&gt;reconfigured = 1;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;}</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment"> * \brief Get the merge priority of this bridge.</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment"> * \note On entry, self is already locked.</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment"> * \return Merge priority</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00924"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a76352d8441d067d8758630bf07d1b8fc">  924</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a76352d8441d067d8758630bf07d1b8fc">bridge_base_get_merge_priority</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;{</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;}</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment"> * \brief ast_bridge base push_peek method.</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment"> * \since 13.2.0</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"> * \param bridge_channel Bridge channel to push.</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment"> * \param swap Bridge channel to swap places with if not NULL.</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment"> * \note On entry, self is already locked.</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment"> * \note Stub because of nothing to do.</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment"> * \retval -1 on failure</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00944"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a11e10081e2a144749472fbecb120bdb1">  944</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a11e10081e2a144749472fbecb120bdb1">bridge_base_push_peek</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *swap)</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;{</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a5a2fef16c6520d265d7f81002eb96ee7">  949</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/dd3/structast__bridge__methods.html">ast_bridge_methods</a> <a class="code" href="../../d0/d95/bridge_8c.html#a5a2fef16c6520d265d7f81002eb96ee7">ast_bridge_base_v_table</a> = {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   .<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;base&quot;</span>,</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   .destroy = <a class="code" href="../../d0/d95/bridge_8c.html#a8eb8e30144686ae8a70116b25c777bfd">bridge_base_destroy</a>,</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   .dissolving = <a class="code" href="../../d0/d95/bridge_8c.html#a3cc48dec5fd6f558ac127f3a4fe50fe8">bridge_base_dissolving</a>,</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   .push = <a class="code" href="../../d0/d95/bridge_8c.html#a7522973439e934a28037444ca5f56599">bridge_base_push</a>,</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   .pull = <a class="code" href="../../d0/d95/bridge_8c.html#ae7078806f36ab599840879be881a2c59">bridge_base_pull</a>,</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   .notify_masquerade = <a class="code" href="../../d0/d95/bridge_8c.html#af326bb3722c4cdd5413a8f4744a6e5d1">bridge_base_notify_masquerade</a>,</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   .get_merge_priority = <a class="code" href="../../d0/d95/bridge_8c.html#a76352d8441d067d8758630bf07d1b8fc">bridge_base_get_merge_priority</a>,</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   .push_peek = <a class="code" href="../../d0/d95/bridge_8c.html#a11e10081e2a144749472fbecb120bdb1">bridge_base_push_peek</a>,</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;};</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a32767ed0f51795590f41a662523c88b0">  960</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a32767ed0f51795590f41a662523c88b0">ast_bridge_base_new</a>(uint32_t capabilities, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d84/structast__bridge.html#a6e62c2774ca18846e6e45057fb8b7a22">creator</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;{</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;   bridge = <a class="code" href="../../d0/d95/bridge_8c.html#adf0e64783980f762008ac238f2dbe715">bridge_alloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a>), &amp;ast_bridge_base_v_table);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;   bridge = <a class="code" href="../../d0/d95/bridge_8c.html#a38c501242153bbe13d0eda31220637b8">bridge_base_init</a>(bridge, capabilities, flags, creator, name, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   bridge = <a class="code" href="../../d0/d95/bridge_8c.html#a8690315fd0d12e16671f9d22eacfa8f0">bridge_register</a>(bridge);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;}</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a4adad484788bb018b8699eeed2ddfedd">  970</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">int</span> <a class="code" href="../../d4/d84/structast__bridge.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a>)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: telling all channels to leave the party\n&quot;</span>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a3dfc360c4ef5a43d854d75e9b94b58e1">bridge_dissolve</a>(bridge, cause);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, -1);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;}</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"> * \brief Perform the smart bridge operation.</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"> * \param bridge Work on this bridge.</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment"> * \details</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"> * Basically see if a new bridge technology should be used instead</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment"> * of the current one.</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"> * \note On entry, bridge is already locked.</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment"> * \retval 0 on success.</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment"> * \retval -1 on error.</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00998"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a715f970eeab295c92ecc511b2a2d1c0e">  998</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a715f970eeab295c92ecc511b2a2d1c0e">smart_bridge_operation</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;{</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   uint32_t new_capabilities;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *new_technology;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *old_technology = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *<a class="code" href="../../d8/d66/bridge__holding_8c.html#adf38df86af98cfdb636531a8426af096">deferred_action</a>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> dummy_bridge = {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      .<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a> = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>,</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      .tech_pvt = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>,</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      .creator = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a6e62c2774ca18846e6e45057fb8b7a22">creator</a>,</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      .name = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      .uniqueid = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;   };</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s is dissolved, not performing smart bridge operation.\n&quot;</span>,</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;   }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   <span class="comment">/* Determine new bridge technology capabilities needed. */</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   <span class="keywordflow">if</span> (2 &lt; bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a>) {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      new_capabilities = <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      new_capabilities &amp;= bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#afe58250d4d4352ae4f0da4012ed4e9fa">allowed_capabilities</a>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      new_capabilities = <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaec2d0fff3f4f8df0d9ef6b4d9be78380">AST_BRIDGE_CAPABILITY_NATIVE</a> | <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaf483c951b835fcc35da807b6a4b12509">AST_BRIDGE_CAPABILITY_1TO1MIX</a>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      new_capabilities &amp;= bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#afe58250d4d4352ae4f0da4012ed4e9fa">allowed_capabilities</a>;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">if</span> (!new_capabilities</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;         &amp;&amp; (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#afe58250d4d4352ae4f0da4012ed4e9fa">allowed_capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>)) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;         <span class="comment">/* Allow switching between different multimix bridge technologies. */</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         new_capabilities = <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      }</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   }</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;   <span class="comment">/* Find a bridge technology to satisfy the new capabilities. */</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;   new_technology = <a class="code" href="../../d0/d95/bridge_8c.html#a407073589cd8fa355d5772da7f9a6529">find_best_technology</a>(new_capabilities, bridge);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   <span class="keywordflow">if</span> (!new_technology) {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordtype">int</span> is_compatible = 0;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">if</span> (old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ab941919d17b5a06038e085389ec32572">compatible</a>) {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;         is_compatible = old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ab941919d17b5a06038e085389ec32572">compatible</a>(bridge);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;         is_compatible = 1;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> &lt;= 2</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         &amp;&amp; (old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaf483c951b835fcc35da807b6a4b12509">AST_BRIDGE_CAPABILITY_1TO1MIX</a>)) {</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;         is_compatible = 1;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      <span class="keywordflow">if</span> (is_compatible) {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s could not get a new technology, staying with old technology.\n&quot;</span>,</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge %s has no technology available to support it.\n&quot;</span>,</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;   <span class="keywordflow">if</span> (new_technology == old_technology) {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s is already using the new technology.\n&quot;</span>,</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   }</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <span class="keywordflow">if</span> (old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a5e3829ec44bca8cdbb274a6bb478b07f">destroy</a>) {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/df8/structtech__deferred__destroy.html">tech_deferred_destroy</a> deferred_tech_destroy = {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;         .<a class="code" href="../../d0/df8/structtech__deferred__destroy.html#afd481155c858ef52f7b0c4c5906f0ef5">tech</a> = dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>,</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;         .tech_pvt = dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>,</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      };</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> action = {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;         .<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0af36653b08c00f5d824ed6046e9233ef9">AST_FRAME_BRIDGE_ACTION</a>,</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;         .subclass.integer = <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#adadb2f6b306233caecdabcf1a7440b0aa00f1087c3c938aa4672d997d16930fb9">BRIDGE_CHANNEL_ACTION_DEFERRED_TECH_DESTROY</a>,</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;         .data.ptr = &amp;deferred_tech_destroy,</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;         .datalen = <span class="keyword">sizeof</span>(deferred_tech_destroy),</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      };</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">       * We need to defer the bridge technology destroy callback</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">       * because we have the bridge locked.</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      deferred_action = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a417ee8a61074ec7570971202908e2c4f">ast_frdup</a>(&amp;action);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">if</span> (!deferred_action) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;         <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      }</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      deferred_action = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">    * We are now committed to changing the bridge technology.  We</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">    * must not release the bridge lock until we have installed the</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">    * new bridge technology.</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(4, <span class="stringliteral">&quot;Bridge %s: switching from %s technology to %s\n&quot;</span>,</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">    * Since we are soon going to pass this bridge to a new</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">    * technology we need to NULL out the tech_pvt pointer but</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">    * don&#39;t worry as it still exists in dummy_bridge, ditto for the</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">    * old technology.</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a> = new_technology;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   <span class="comment">/* Setup the new bridge technology. */</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology constructor\n&quot;</span>,</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   <span class="keywordflow">if</span> (new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#af2e29d0c7f999e958eb80500c411b374">create</a> &amp;&amp; new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#af2e29d0c7f999e958eb80500c411b374">create</a>(bridge)) {</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge %s: failed to setup bridge technology %s\n&quot;</span>,</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a> = dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a19aa04db5508cf9496602e694dc69e2f">tech_pvt</a>;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a> = dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   <span class="comment">/* To ensure that things are sane for the old technology move the channels it</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">    * expects to the dummy bridge</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a82df0e78742524f455a24e874ba28f49">just_joined</a>) {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: moving %p(%s) to dummy bridge temporarily\n&quot;</span>,</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a>++;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a29fbd7797e61564f5f40c3361e7f4fc2">AST_BRIDGE_CHANNEL_FLAG_LONELY</a>)) {</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;         dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#adaedd59efa9e3a1bf9ef24db6771e0a2">num_lonely</a>++;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordflow">if</span> (!bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a2862ffde11c780129862e5549415a6f6">suspended</a>) {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;         dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a4d514eabb35f71dee132ef1df1c6cdbb">num_active</a>++;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;   }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;   <span class="comment">/* Take all the channels out of the old technology */</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: %p(%s) is leaving %s technology (dummy)\n&quot;</span>,</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;         dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;         old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">if</span> (old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afe176c25906bf1cd867d59baeb920dc7">leave</a>) {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;         old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afe176c25906bf1cd867d59baeb920dc7">leave</a>(&amp;dummy_bridge, bridge_channel);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a>--;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a29fbd7797e61564f5f40c3361e7f4fc2">AST_BRIDGE_CHANNEL_FLAG_LONELY</a>)) {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;         dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#adaedd59efa9e3a1bf9ef24db6771e0a2">num_lonely</a>--;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      }</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">if</span> (!bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a2862ffde11c780129862e5549415a6f6">suspended</a>) {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;         dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a4d514eabb35f71dee132ef1df1c6cdbb">num_active</a>--;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      }</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology stop\n&quot;</span>,</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <span class="keywordflow">if</span> (old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ac53486d83b1e8c097744f32d269a3ff3">stop</a>) {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#ac53486d83b1e8c097744f32d269a3ff3">stop</a>(&amp;dummy_bridge);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;   }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;   <span class="comment">/* Add any new channels or re-add existing channels to the bridge. */</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a0fa5438fc193ab54b5deb0c80a1ca76f">bridge_channel_complete_join</a>(bridge, bridge_channel);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;   }</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology start\n&quot;</span>,</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;   <span class="keywordflow">if</span> (new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a6addef84db409d5d7ba250634555c4c8">start</a> &amp;&amp; new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a6addef84db409d5d7ba250634555c4c8">start</a>(bridge)) {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Bridge %s: failed to start bridge technology %s\n&quot;</span>,</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, new_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">    * Now that all the channels have been moved over we need to get</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">    * rid of all the information the old technology may have left</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">    * around.</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;   <span class="keywordflow">if</span> (old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a5e3829ec44bca8cdbb274a6bb478b07f">destroy</a>) {</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: deferring %s technology destructor\n&quot;</span>,</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;         dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a33e57ad4748df60e32e16393cfd285b4">bridge_queue_action_nodup</a>(bridge, deferred_action);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Bridge %s: calling %s technology destructor\n&quot;</span>,</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         dummy_bridge.<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(old_technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">mod</a>);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;   }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;}</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment"> * \brief Bridge channel to check if a BRIDGE_PLAY_SOUND needs to be played.</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment"> * \param bridge_channel What to check.</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01203"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad5496403d428bccf4dfffed404bb927e"> 1203</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad5496403d428bccf4dfffed404bb927e">check_bridge_play_sound</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel)</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;{</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/dcf/app__confbridge_8c.html#ac43e427fd7bbe26987bbeed52777898d">play_file</a>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;   play_file = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;BRIDGE_PLAY_SOUND&quot;</span>);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(play_file)) {</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      play_file = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(play_file);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;BRIDGE_PLAY_SOUND&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      play_file = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;   }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   <span class="keywordflow">if</span> (play_file) {</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ac352fd6d6188d7431155f34ae2a38799">ast_bridge_channel_queue_playfile</a>(bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, play_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   }</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"> * \brief Check for any BRIDGE_PLAY_SOUND channel variables in the bridge.</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment"> * \param bridge What to operate on.</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment"> * \note On entry, the bridge is already locked.</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01233"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a52be65600729342154b0dae671f1030a"> 1233</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a52be65600729342154b0dae671f1030a">check_bridge_play_sounds</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;{</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#ad5496403d428bccf4dfffed404bb927e">check_bridge_play_sound</a>(bridge_channel);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;}</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a67a0030855111322bb27b3502345adc6"> 1242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a67a0030855111322bb27b3502345adc6">ast_bridge_vars_set</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *pvtid)</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;{</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf195fcf1686408b5e52ad76996653cea">ast_channel_stage_snapshot</a>(chan);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;BRIDGEPEER&quot;</span>, name);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;BRIDGEPVTCALLID&quot;</span>, pvtid);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga920b9d3e484257c7e593452a8e36d8d4">ast_channel_stage_snapshot_done</a>(chan);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment"> * \brief Set BRIDGEPEER and BRIDGEPVTCALLID channel variables in a 2 party bridge.</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment"> * \param c0 Party of the first part.</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment"> * \param c1 Party of the second part.</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment"> * \note On entry, the bridge is already locked.</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment"> * \note The bridge is expected to have exactly two parties.</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01263"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a2a0fb2033d63f4d58127cd3c3adb3965"> 1263</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a2a0fb2033d63f4d58127cd3c3adb3965">set_bridge_peer_vars_2party</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *c0, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *c1)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;{</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *c0_name;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *c1_name;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *c0_pvtid = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *c1_pvtid = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="preprocessor">#define UPDATE_BRIDGE_VARS_GET(chan, name, pvtid)                          \</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="preprocessor">   do {                                                        \</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="preprocessor">      name = ast_strdupa(ast_channel_name(chan));                          \</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="preprocessor">      if (ast_channel_tech(chan)-&gt;get_pvt_uniqueid) {                      \</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="preprocessor">         pvtid = ast_strdupa(ast_channel_tech(chan)-&gt;get_pvt_uniqueid(chan)); \</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="preprocessor">      }                                                        \</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="preprocessor">   } while (0)</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(c1);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a2fce0d593cf609fef9c414ab71c6aa24">UPDATE_BRIDGE_VARS_GET</a>(c1, c1_name, c1_pvtid);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(c1);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(c0);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a67a0030855111322bb27b3502345adc6">ast_bridge_vars_set</a>(c0, c1_name, c1_pvtid);</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a2fce0d593cf609fef9c414ab71c6aa24">UPDATE_BRIDGE_VARS_GET</a>(c0, c0_name, c0_pvtid);</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(c0);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(c1);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a67a0030855111322bb27b3502345adc6">ast_bridge_vars_set</a>(c1, c0_name, c0_pvtid);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(c1);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;}</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment"> * \brief Fill the BRIDGEPEER value buffer with a comma separated list of channel names.</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment"> * \param buf Buffer to fill.  The caller must guarantee the buffer is large enough.</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment"> * \param cur_idx Which index into names[] to skip.</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment"> * \param names Channel names to put in the buffer.</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment"> * \param num_names Number of names in the array.</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01303"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a6c03492ca8c37dd73d47e07d6459bdb1"> 1303</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a6c03492ca8c37dd73d47e07d6459bdb1">fill_bridgepeer_buf</a>(<span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cur_idx, <span class="keyword">const</span> <span class="keywordtype">char</span> *names[], <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_names)</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;{</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;   <span class="keywordtype">int</span> need_separator = 0;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *src;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   <span class="keywordtype">char</span> *pos;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   pos = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; num_names; ++idx) {</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">if</span> (idx == cur_idx) {</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      }</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">if</span> (need_separator) {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;         *pos++ = <span class="charliteral">&#39;,&#39;</span>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      }</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      need_separator = 1;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="comment">/* Copy name into buffer. */</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      src = names[idx];</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">while</span> (*src) {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;         *pos++ = *src++;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      }</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;   }</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   *pos = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;}</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment"> * \brief Set BRIDGEPEER and BRIDGEPVTCALLID channel variables in a multi-party bridge.</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment"> * \param bridge What to operate on.</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment"> * \note On entry, the bridge is already locked.</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment"> * \note The bridge is expected to have more than two parties.</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01342"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aae1da0bc376b0767f72e637eca0e0d4b"> 1342</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aae1da0bc376b0767f72e637eca0e0d4b">set_bridge_peer_vars_multiparty</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;{</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment"> * Set a maximum number of channel names for the BRIDGEPEER</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment"> * list.  The plus one is for the current channel which is not</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment"> * put in the list.</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="preprocessor">#define MAX_BRIDGEPEER_CHANS  (10 + 1)</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_names;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> **names;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;   <span class="comment">/* Get first MAX_BRIDGEPEER_CHANS channel names. */</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;   num_names = <a class="code" href="../../d5/d60/utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a>, <a class="code" href="../../d0/d95/bridge_8c.html#a8d0d9f0c35f7276cf481a4da6439b417">MAX_BRIDGEPEER_CHANS</a>);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;   names = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(num_names * <span class="keyword">sizeof</span>(*names));</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;   idx = 0;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">if</span> (num_names &lt;= idx) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      }</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      names[idx++] = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   }</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   <span class="comment">/* Determine maximum buf size needed. */</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;   len = num_names;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; num_names; ++idx) {</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      len += strlen(names[idx]);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   }</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   buf = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(len);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   <span class="comment">/* Set the bridge channel variables. */</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;   idx = 0;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordflow">if</span> (idx &lt; num_names) {</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#a6c03492ca8c37dd73d47e07d6459bdb1">fill_bridgepeer_buf</a>(buf, idx, names, num_names);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      }</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      ++idx;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a67a0030855111322bb27b3502345adc6">ast_bridge_vars_set</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, buf, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;   }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;}</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment"> * \brief Set BRIDGEPEER and BRIDGEPVTCALLID channel variables in a holding bridge.</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment"> * \param bridge What to operate on.</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment"> * \note On entry, the bridge is already locked.</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01404"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#affd07213438991c65c87eaaed9b71cc9"> 1404</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#affd07213438991c65c87eaaed9b71cc9">set_bridge_peer_vars_holding</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;{</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a67a0030855111322bb27b3502345adc6">ast_bridge_vars_set</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   }</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment"> * \brief Set BRIDGEPEER and BRIDGEPVTCALLID channel variables in the bridge.</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment"> * \param bridge What to operate on.</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment"> * \note On entry, the bridge is already locked.</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01426"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad6f253ce6ca83c50fd56077f98fcaaf7"> 1426</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad6f253ce6ca83c50fd56077f98fcaaf7">set_bridge_peer_vars</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;{</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaff2606e446a3b7e22fb3785a06110554">AST_BRIDGE_CAPABILITY_HOLDING</a>) {</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#affd07213438991c65c87eaaed9b71cc9">set_bridge_peer_vars_holding</a>(bridge);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;   }</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> &lt; 2) {</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;   }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> == 2) {</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a2a0fb2033d63f4d58127cd3c3adb3965">set_bridge_peer_vars_2party</a>(<a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>)-&gt;chan,</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a1e37109bb72d95999821eb45f28c261c">AST_LIST_LAST</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>)-&gt;chan);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#aae1da0bc376b0767f72e637eca0e0d4b">set_bridge_peer_vars_multiparty</a>(bridge);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;   }</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;}</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5"> 1443</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colp_update)</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;{</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;   <span class="keywordflow">if</span> (!bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a41d441063234a215e985a56318a07a6f">reconfigured</a>) {</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;   }</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a41d441063234a215e985a56318a07a6f">reconfigured</a> = 0;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b">AST_BRIDGE_FLAG_SMART</a>)</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      &amp;&amp; <a class="code" href="../../d0/d95/bridge_8c.html#a715f970eeab295c92ecc511b2a2d1c0e">smart_bridge_operation</a>(bridge)) {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="comment">/* Smart bridge failed. */</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a3dfc360c4ef5a43d854d75e9b94b58e1">bridge_dissolve</a>(bridge, 0);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;   }</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ac776f2eff5f02e48a3c6492a6dccd444">bridge_complete_join</a>(bridge);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;   }</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a52be65600729342154b0dae671f1030a">check_bridge_play_sounds</a>(bridge);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ad6f253ce6ca83c50fd56077f98fcaaf7">set_bridge_peer_vars</a>(bridge);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#aa8bd54e09b0c348a3232053e4be9bcfb">ast_bridge_publish_state</a>(bridge);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   <span class="keywordflow">if</span> (colp_update) {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#aa6c59e682620f50fc028a30c822e083c">bridge_reconfigured_connected_line_update</a>(bridge);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;   }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;}</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc"> 1469</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *<a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;{</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == chan) {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      }</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;   }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;   <span class="keywordflow">return</span> bridge_channel;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;}</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aeb11f378e45f0beb05de964b3af9a6bc"> 1482</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aeb11f378e45f0beb05de964b3af9a6bc">ast_bridge_notify_masquerade</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;{</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   <span class="comment">/* Safely get the bridge_channel pointer for the chan. */</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;   bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(chan);</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel) {</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      <span class="comment">/* Not in a bridge */</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;   }</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a7d01ff5caf025a97796d2dbb78f5f02c">ast_bridge_channel_lock_bridge</a>(bridge_channel);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;   bridge = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;   <span class="keywordflow">if</span> (bridge_channel == <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(bridge, chan)) {</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment"> * XXX ASTERISK-22366 this needs more work.  The channels need</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment"> * to be made compatible again if the formats change. The</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment"> * bridge_channel thread needs to monitor for this case.</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="comment">/* The channel we want to notify is still in a bridge. */</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#ab72b2fb844367bda53a258a6059f6290">notify_masquerade</a>(bridge, bridge_channel);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a>(bridge, 1);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;   }</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge_channel, -1);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;}</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment"> * \brief Internal bridge impart wait condition and associated conditional.</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01515"></a><span class="lineno"><a class="line" href="../../d5/df4/structbridge__channel__impart__cond.html"> 1515</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a> {</div><div class="line"><a name="l01516"></a><span class="lineno"><a class="line" href="../../d5/df4/structbridge__channel__impart__cond.html#aeded56c37424bbb7c60e546ccf6956fa"> 1516</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a>) <a class="code" href="../../db/d89/structbridge__manager__request.html#a3ed9421e7d90ae54555fbcf4bc96d2b4">node</a>;<span class="comment"></span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">   /*! Lock for the data structure */</span></div><div class="line"><a name="l01518"></a><span class="lineno"><a class="line" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902"> 1518</a></span>&#160;   <a class="code" href="../../d8/dc5/structast__mutex__info.html">ast_mutex_t</a> <a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>;<span class="comment"></span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">   /*! Wait condition */</span></div><div class="line"><a name="l01520"></a><span class="lineno"><a class="line" href="../../d5/df4/structbridge__channel__impart__cond.html#a1c7181c39f99ee801943a0d0aa9872b9"> 1520</a></span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab134d98cdfe7de0f7a72b377c0765dc7">ast_cond_t</a> <a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>;<span class="comment"></span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">   /*! Wait until done */</span></div><div class="line"><a name="l01522"></a><span class="lineno"><a class="line" href="../../d5/df4/structbridge__channel__impart__cond.html#a5992b274cfdcacdbc1fa8347fd01ebde"> 1522</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;};</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div><div class="line"><a name="l01525"></a><span class="lineno"><a class="line" href="../../d3/d44/structbridge__channel__impart__ds__head.html#a215e672014f0c07e57db7872a9093f3c"> 1525</a></span>&#160;<a class="code" href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a>(<a class="code" href="../../d3/d44/structbridge__channel__impart__ds__head.html">bridge_channel_impart_ds_head</a>, <a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a>);</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment"> * \brief Signal imparting threads to wake up.</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment"> * \since 13.9.0</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment"> * \param ds_head List of imparting threads to wake up.</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01536"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a17dab193f18bf5abfd10c00735925e28"> 1536</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a17dab193f18bf5abfd10c00735925e28">bridge_channel_impart_ds_head_signal</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d44/structbridge__channel__impart__ds__head.html">bridge_channel_impart_ds_head</a> *ds_head)</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;{</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;   <span class="keywordflow">if</span> (ds_head) {</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a> *<a class="code" href="../../df/d44/app__meetme_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      <span class="keywordflow">while</span> ((cond = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(ds_head, <a class="code" href="../../d5/da1/structnode.html">node</a>))) {</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;         cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a> = 1;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      }</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   }</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;}</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="line"><a name="l01550"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a65e3d013d7b6a10877663ac56f3f443f"> 1550</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a65e3d013d7b6a10877663ac56f3f443f">bridge_channel_impart_ds_head_dtor</a>(<span class="keywordtype">void</span> *doomed)</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;{</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a17dab193f18bf5abfd10c00735925e28">bridge_channel_impart_ds_head_signal</a>(doomed);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(doomed);</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;}</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment"> * \brief Fixup the bridge impart datastore.</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment"> * \since 13.9.0</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment"> * \param data Bridge impart datastore data to fixup from old_chan.</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment"> * \param old_chan The datastore is moving from this channel.</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment"> * \param new_chan The datastore is moving to this channel.</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01567"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a2e2014a0a213113e3fbc31077aea31a5"> 1567</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a2e2014a0a213113e3fbc31077aea31a5">bridge_channel_impart_ds_head_fixup</a>(<span class="keywordtype">void</span> *data, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *old_chan, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *new_chan)</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;{</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">    * Signal any waiting impart threads.  The masquerade is going to kill</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">    * old_chan and we don&#39;t need to be waiting on new_chan.</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a17dab193f18bf5abfd10c00735925e28">bridge_channel_impart_ds_head_signal</a>(data);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;}</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a86532569e14381b173afcbf4e5a3c4cb"> 1576</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> <a class="code" href="../../d0/d95/bridge_8c.html#a86532569e14381b173afcbf4e5a3c4cb">bridge_channel_impart_ds_info</a> = {</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;   .<a class="code" href="../../d9/dfb/structast__datastore__info.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a> = <span class="stringliteral">&quot;bridge-impart-ds&quot;</span>,</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;   .destroy = <a class="code" href="../../d0/d95/bridge_8c.html#a65e3d013d7b6a10877663ac56f3f443f">bridge_channel_impart_ds_head_dtor</a>,</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;   .chan_fixup = <a class="code" href="../../d0/d95/bridge_8c.html#a2e2014a0a213113e3fbc31077aea31a5">bridge_channel_impart_ds_head_fixup</a>,</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;};</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment"> * \brief Add impart wait datastore conditional to channel.</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment"> * \since 13.9.0</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment"> * \param chan Channel to add the impart wait conditional.</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment"> * \param cond Imparting conditional to add.</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment"> * \retval 0 on success.</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment"> * \retval -1 on error.</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01593"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad820f44d2f7988332045260d21a41b50"> 1593</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad820f44d2f7988332045260d21a41b50">bridge_channel_impart_add</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">struct</span> <a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a> *<a class="code" href="../../df/d44/app__meetme_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>)</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;{</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d44/structbridge__channel__impart__ds__head.html">bridge_channel_impart_ds_head</a> *ds_head;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   datastore = <a class="code" href="../../d5/d7b/channel_8h.html#aad1e09cd7c79237d05cffb45d6cdfd7c">ast_channel_datastore_find</a>(chan, &amp;bridge_channel_impart_ds_info, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      datastore = <a class="code" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc</a>(&amp;bridge_channel_impart_ds_info, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      }</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      ds_head = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*ds_head));</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keywordflow">if</span> (!ds_head) {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;         <a class="code" href="../../d9/db6/datastore_8h.html#aee27286888b30c6448a9bce928040a14">ast_datastore_free</a>(datastore);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      }</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a> = ds_head;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a1ed3e98d33d5587948a0e2ef67a81f52">ast_channel_datastore_add</a>(chan, datastore);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      ds_head = datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(ds_head != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;   }</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(ds_head, cond, <a class="code" href="../../d5/da1/structnode.html">node</a>);</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;}</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a74e792941ccfcad7b6ba895ec44b2025"> 1626</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a74e792941ccfcad7b6ba895ec44b2025">bridge_channel_impart_signal</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;{</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;   datastore = <a class="code" href="../../d5/d7b/channel_8h.html#aad1e09cd7c79237d05cffb45d6cdfd7c">ast_channel_datastore_find</a>(chan, &amp;bridge_channel_impart_ds_info, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;   <span class="keywordflow">if</span> (datastore) {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a17dab193f18bf5abfd10c00735925e28">bridge_channel_impart_ds_head_signal</a>(datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;   }</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;}</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment"> * \brief Block imparting channel thread until signaled.</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment"> * \since 13.9.0</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment"> * \param cond Imparting conditional to wait for.</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01647"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a400a0c9203d666b2a6d75944a4edaba4"> 1647</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a400a0c9203d666b2a6d75944a4edaba4">bridge_channel_impart_wait</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a> *<a class="code" href="../../df/d44/app__meetme_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>)</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;{</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;   <span class="keywordflow">while</span> (!cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>) {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a>(&amp;cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, &amp;cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;   }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;cond-&gt;<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;}</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment"> * XXX ASTERISK-21271 make ast_bridge_join() require features to be allocated just like ast_bridge_impart() and not expect the struct back.</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment"> * This change is really going to break ConfBridge.  All other</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment"> * users are easily changed.  However, it is needed so the</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment"> * bridging code can manipulate features on all channels</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment"> * consistently no matter how they joined.</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment"> * Need to update the features parameter doxygen when this</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment"> * change is made to be like ast_bridge_impart().</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01667"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a116a27b8e1e111729ee1828d4fab6b5a"> 1667</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a116a27b8e1e111729ee1828d4fab6b5a">ast_bridge_join</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>,</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan,</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *swap,</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d6/d97/structast__bridge__tech__optimizations.html">ast_bridge_tech_optimizations</a> *tech_args,</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93">ast_bridge_join_flags</a> flags)</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;{</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac7388257651bb6a92d3208512fab0ba6">SCOPE_TRACE</a>(1, <span class="stringliteral">&quot;%s Bridge: %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;   bridge_channel = <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a46acfb8805bd7c339b2c8300a154e9e8">bridge_channel_internal_alloc</a>(bridge);</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;   <span class="keywordflow">if</span> (flags &amp; <a class="code" href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93a9106169928c6eeccad5b5ebcf762ac9d">AST_BRIDGE_JOIN_PASS_REFERENCE</a>) {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, -1);</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;   }</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#abd9eeaf9633f630d7588f6a7de7b9fbe">ao2_t_cleanup</a>(swap, <span class="stringliteral">&quot;Error exit: bridge_channel alloc failed&quot;</span>);</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      res = -1;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="keywordflow">goto</span> join_exit;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;   }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="comment">/* XXX ASTERISK-21271 features cannot be NULL when passed in. When it is changed to allocated we can do like ast_bridge_impart() and allocate one. */</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(features != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;   <span class="keywordflow">if</span> (!features) {</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge_channel, -1);</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#abd9eeaf9633f630d7588f6a7de7b9fbe">ao2_t_cleanup</a>(swap, <span class="stringliteral">&quot;Error exit: features is NULL&quot;</span>);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      res = -1;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <span class="keywordflow">goto</span> join_exit;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;   }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;   <span class="keywordflow">if</span> (tech_args) {</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#acfc2cc36cba9e208c9d45e39d7cff506">tech_args</a> = *<a class="code" href="../../d5/dca/structast__bridge__channel.html#acfc2cc36cba9e208c9d45e39d7cff506">tech_args</a>;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;   }</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(chan), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d">AST_FLAG_ZOMBIE</a>)) {</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      res = -1;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a41082b7d1c406087d152d8f40812b7a2">ast_channel_internal_bridge_channel_set</a>(chan, bridge_channel);</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;   }</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a01f75a9ad916f63a94e06a27635ba278">thread</a> = pthread_self();</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a> = <a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#aa30fb781e59e7c7b6449914dd9ad08d2">inhibit_colp</a> = !!(flags &amp; <a class="code" href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93a3ebef74566687cfbc25d174725fc6d56">AST_BRIDGE_JOIN_INHIBIT_JOIN_COLP</a>);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;   <span class="comment">/* allow subclass to peek at upcoming push operation */</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#aeab2ad12e267a1bc7bfd840f1514f664">push_peek</a> &amp;&amp; !res) {</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bcswap = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>) {</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;         bcswap = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(bridge, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      }</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      res = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#aeab2ad12e267a1bc7bfd840f1514f664">push_peek</a>(bridge, bridge_channel, bcswap);</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;   }</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      res = <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#acd65272991204985a1c6ca5a30769472">bridge_channel_internal_join</a>(bridge_channel);</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   }</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;   <span class="comment">/* Cleanup all the data in the bridge channel after it leaves the bridge. */</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a41082b7d1c406087d152d8f40812b7a2">ast_channel_internal_bridge_channel_set</a>(chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;   <span class="comment">/* Due to a race condition, we lock the bridge channel here for ast_bridge_channel_get_chan */</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(bridge_channel);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(bridge_channel);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;   <span class="comment">/* If bridge_channel-&gt;swap is not NULL then the join failed. */</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#abd9eeaf9633f630d7588f6a7de7b9fbe">ao2_t_cleanup</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>, <span class="stringliteral">&quot;Bridge complete: join failed&quot;</span>);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge_channel, -1);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;join_exit:</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;   <a class="code" href="../../d8/d85/bridge__after_8h.html#a7c547699abaa46137bafc0940e6ff694">ast_bridge_run_after_callback</a>(chan);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a74e792941ccfcad7b6ba895ec44b2025">bridge_channel_impart_signal</a>(chan);</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../d5/d7b/channel_8h.html#adac99999f1e55833e7f903979d67b48b">ast_channel_softhangup_internal_flag</a>(chan) &amp; <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a085c0c603de12dc2474a17a92e1cb5a4">AST_SOFTHANGUP_ASYNCGOTO</a>)</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      &amp;&amp; !<a class="code" href="../../d8/d85/bridge__after_8h.html#a6231027722f2bdd4093d15defa0d7b94">ast_bridge_setup_after_goto</a>(chan)) {</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="comment">/* Claim the after bridge goto is an async goto destination. */</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ae90da1877e143b996d202d4c88a9c862">ast_softhangup_nolock</a>(chan, AST_SOFTHANGUP_ASYNCGOTO);</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;   }</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;}</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">/*! \brief Thread responsible for imparted bridged channels to be departed */</span></div><div class="line"><a name="l01757"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a77ab17853d64d147b9decab33c4e6ac5"> 1757</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a77ab17853d64d147b9decab33c4e6ac5">bridge_channel_depart_thread</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;{</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel = data;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a>) {</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a6956becf4d7e3906c74b6e30b834ebd8">ast_callid_threadassoc_add</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a>);</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;   }</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;   res = <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#acd65272991204985a1c6ca5a30769472">bridge_channel_internal_join</a>(bridge_channel);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">    * cleanup</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">    * If bridge_channel-&gt;swap is not NULL then the join failed.</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#abd9eeaf9633f630d7588f6a7de7b9fbe">ao2_t_cleanup</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>, <span class="stringliteral">&quot;Bridge complete: Departable impart join failed&quot;</span>);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;   <a class="code" href="../../d8/d85/bridge__after_8h.html#a10b6f3295f847d20f6706a222fe55828">ast_bridge_discard_after_callback</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      res ? <a class="code" href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9ca2a6093cf7896d7224f478d6b8883bed2">AST_BRIDGE_AFTER_CB_REASON_IMPART_FAILED</a> : <a class="code" href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9ca41c2a3c2740424d3c072de1fa0dceb3d">AST_BRIDGE_AFTER_CB_REASON_DEPART</a>);</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;   <span class="comment">/* If join failed there will be impart threads waiting. */</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a74e792941ccfcad7b6ba895ec44b2025">bridge_channel_impart_signal</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;   <a class="code" href="../../d8/d85/bridge__after_8h.html#a7e45f2d09f551ef40a26ae0d8c3f410f">ast_bridge_discard_after_goto</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;}</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">/*! \brief Thread responsible for independent imparted bridged channels */</span></div><div class="line"><a name="l01788"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae07278f47ac7c857c97175b0995fc6ca"> 1788</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d0/d95/bridge_8c.html#ae07278f47ac7c857c97175b0995fc6ca">bridge_channel_ind_thread</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;{</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel = data;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a>) {</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a6956becf4d7e3906c74b6e30b834ebd8">ast_callid_threadassoc_add</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a>);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;   }</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;   <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#acd65272991204985a1c6ca5a30769472">bridge_channel_internal_join</a>(bridge_channel);</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;   chan = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;   <span class="comment">/* cleanup */</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a41082b7d1c406087d152d8f40812b7a2">ast_channel_internal_bridge_channel_set</a>(chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;   <span class="comment">/* Lock here for ast_bridge_channel_get_chan */</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(bridge_channel);</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(bridge_channel);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;   <span class="comment">/* If bridge_channel-&gt;swap is not NULL then the join failed. */</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#abd9eeaf9633f630d7588f6a7de7b9fbe">ao2_t_cleanup</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>, <span class="stringliteral">&quot;Bridge complete: Independent impart join failed&quot;</span>);</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge_channel, -1);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   <a class="code" href="../../d8/d85/bridge__after_8h.html#a7c547699abaa46137bafc0940e6ff694">ast_bridge_run_after_callback</a>(chan);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;   <span class="comment">/* If join failed there will be impart threads waiting. */</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a74e792941ccfcad7b6ba895ec44b2025">bridge_channel_impart_signal</a>(chan);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;   <a class="code" href="../../d8/d85/bridge__after_8h.html#a1d2fbb74f819b904b199bc02307fed7e">ast_bridge_run_after_goto</a>(chan);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;}</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;</div><div class="line"><a name="l01823"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ac529e02d743fa8b819a18cf73c5ffa87"> 1823</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#ac529e02d743fa8b819a18cf73c5ffa87">bridge_impart_internal</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>,</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan,</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *swap,</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101">ast_bridge_impart_flags</a> flags,</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a> *<a class="code" href="../../df/d44/app__meetme_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>)</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;{</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   <span class="comment">/* Imparted channels cannot have a PBX. */</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a488b7d6f7488bedc53be45d4ef4471c9">ast_channel_pbx</a>(chan)) {</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Channel %s has a PBX thread and cannot be imparted into bridge %s\n&quot;</span>,</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(features);</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;   }</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;   <span class="comment">/* Supply an empty features structure if the caller did not. */</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;   <span class="keywordflow">if</span> (!features) {</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      features = <a class="code" href="../../d0/d95/bridge_8c.html#abf9e5d393615c63d27e0bd530301a1ed">ast_bridge_features_new</a>();</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      <span class="keywordflow">if</span> (!features) {</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      }</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;   }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;   <span class="comment">/* Try to allocate a structure for the bridge channel */</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   bridge_channel = <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a46acfb8805bd7c339b2c8300a154e9e8">bridge_channel_internal_alloc</a>(bridge);</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel) {</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(features);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;   }</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(chan), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d">AST_FLAG_ZOMBIE</a>)) {</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a>, <span class="stringliteral">&quot;Channel %s is a zombie and cannot be imparted into bridge %s\n&quot;</span>,</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      res = -1;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a41082b7d1c406087d152d8f40812b7a2">ast_channel_internal_bridge_channel_set</a>(chan, bridge_channel);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;   }</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aaff8d563ccbab36b41b093709681de2a">ao2_t_bump</a>(swap, <span class="stringliteral">&quot;Setting up bridge impart&quot;</span>);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a> = <a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#aa30fb781e59e7c7b6449914dd9ad08d2">inhibit_colp</a> = !!(flags &amp; <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101a9d897e78dc2fcd2447531e2ee0310933">AST_BRIDGE_IMPART_INHIBIT_JOIN_COLP</a>);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#aad730dbfaf13dfa770055ce31d0a45e4">depart_wait</a> =</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      (flags &amp; <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101a99da763f0bd676f299a215ea9d1055db">AST_BRIDGE_IMPART_CHAN_MASK</a>) == <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101a01be425a6fb9fefd36905b542e903087">AST_BRIDGE_IMPART_CHAN_DEPARTABLE</a>;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a> = <a class="code" href="../../d1/d8c/logger_8h.html#a5b3f39ea262ffa795ce4b597968ad00b">ast_read_threadstorage_callid</a>();</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;   <span class="comment">/* allow subclass to peek at swap channel before it can hangup */</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#aeab2ad12e267a1bc7bfd840f1514f664">push_peek</a> &amp;&amp; !res) {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bcswap = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>) {</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;         bcswap = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(bridge, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>);</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      }</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      res = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#aeab2ad12e267a1bc7bfd840f1514f664">push_peek</a>(bridge, bridge_channel, bcswap);</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;   }</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;   <span class="comment">/* Actually create the thread that will handle the channel */</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      res = <a class="code" href="../../d0/d95/bridge_8c.html#ad820f44d2f7988332045260d21a41b50">bridge_channel_impart_add</a>(chan, cond);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;   }</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101a99da763f0bd676f299a215ea9d1055db">AST_BRIDGE_IMPART_CHAN_MASK</a>) == <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101aecfd8e6279a21b20ee4db0ab69c847e8">AST_BRIDGE_IMPART_CHAN_INDEPENDENT</a>) {</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;         res = <a class="code" href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a>(&amp;bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <a class="code" href="../../d0/d95/bridge_8c.html#ae07278f47ac7c857c97175b0995fc6ca">bridge_channel_ind_thread</a>, bridge_channel);</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;         res = <a class="code" href="../../d5/d60/utils_8h.html#a4781fd54a4ca8c7f0f8a32a6cce503c0">ast_pthread_create</a>(&amp;bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            <a class="code" href="../../d0/d95/bridge_8c.html#a77ab17853d64d147b9decab33c4e6ac5">bridge_channel_depart_thread</a>, bridge_channel);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      }</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#a400a0c9203d666b2a6d75944a4edaba4">bridge_channel_impart_wait</a>(cond);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;      }</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   }</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      <span class="comment">/* cleanup */</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a41082b7d1c406087d152d8f40812b7a2">ast_channel_internal_bridge_channel_set</a>(chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="comment">/* Lock here for ast_bridge_channel_get_chan */</span></div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(bridge_channel);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(bridge_channel);</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#abd9eeaf9633f630d7588f6a7de7b9fbe">ao2_t_cleanup</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>, <span class="stringliteral">&quot;Bridge complete: Impart failed&quot;</span>);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge_channel, -1);</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;   }</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;}</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a4a1f0ebb4769ef2340211b0d05a1077a"> 1924</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a4a1f0ebb4769ef2340211b0d05a1077a">ast_bridge_impart</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>,</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>,</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>,</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101">ast_bridge_impart_flags</a> flags)</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;{</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a> cond = {</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      .<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a> = 0,</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   };</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac7388257651bb6a92d3208512fab0ba6">SCOPE_TRACE</a>(1, <span class="stringliteral">&quot;%s Bridge: %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;cond.<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;cond.<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;   res = <a class="code" href="../../d0/d95/bridge_8c.html#ac529e02d743fa8b819a18cf73c5ffa87">bridge_impart_internal</a>(bridge, chan, swap, features, flags, &amp;cond);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="comment">/* Impart failed.  Signal any other waiting impart threads */</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      <a class="code" href="../../d8/d85/bridge__after_8h.html#a10b6f3295f847d20f6706a222fe55828">ast_bridge_discard_after_callback</a>(chan, <a class="code" href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9ca2a6093cf7896d7224f478d6b8883bed2">AST_BRIDGE_AFTER_CB_REASON_IMPART_FAILED</a>);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a74e792941ccfcad7b6ba895ec44b2025">bridge_channel_impart_signal</a>(chan);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a>(&amp;cond.<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;cond.<a class="code" href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;}</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;</div><div class="line"><a name="l01952"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a0075715d330c8492e03c6d3ca3f48e13"> 1952</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a0075715d330c8492e03c6d3ca3f48e13">ast_bridge_depart</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;{</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;   <span class="keywordtype">int</span> departable;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac7388257651bb6a92d3208512fab0ba6">SCOPE_TRACE</a>(1, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;   bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a5e41daaa81df59fc1e8eea2796029c31">ast_channel_internal_bridge_channel</a>(chan);</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;   departable = bridge_channel &amp;&amp; bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#aad730dbfaf13dfa770055ce31d0a45e4">depart_wait</a>;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;   <span class="keywordflow">if</span> (!departable) {</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Channel %s cannot be departed.\n&quot;</span>,</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment">       * Should never happen.  It likely means that</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">       * ast_bridge_depart() is called by two threads for the same</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">       * channel, the channel was never imparted to be departed, or it</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">       * has already been departed.</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   }</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment">    * We are claiming the bridge_channel reference held by</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">    * bridge_channel_depart_thread().</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel,</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   <span class="comment">/* Wait for the depart thread to die */</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Waiting for %p(%s) bridge thread to die.\n&quot;</span>,</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   pthread_join(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a41082b7d1c406087d152d8f40812b7a2">ast_channel_internal_bridge_channel_set</a>(chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;   <span class="comment">/* We can get rid of the bridge_channel after the depart thread has died. */</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge_channel, -1);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;}</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div><div class="line"><a name="l01997"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a66d6a521530f4fb208eb8ee33e257b6c"> 1997</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a66d6a521530f4fb208eb8ee33e257b6c">ast_bridge_remove</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;{</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Removing channel %s from bridge %s\n&quot;</span>,</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;   <span class="comment">/* Try to find the channel that we want to remove */</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <span class="keywordflow">if</span> (!(bridge_channel = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(bridge, chan))) {</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;   }</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel,</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;}</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div><div class="line"><a name="l02020"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#acc33b8d4fe39d089f5987e86e0333617"> 2020</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#acc33b8d4fe39d089f5987e86e0333617">kick_it</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">const</span> <span class="keywordtype">void</span> *payload, <span class="keywordtype">size_t</span> payload_size)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;{</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a7e482bb2dcffd792205f114ddfa098fb">ast_bridge_channel_kick</a>(bridge_channel, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;}</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div><div class="line"><a name="l02025"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a7132d0a0b71844641ce3a1035e05c67b"> 2025</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a7132d0a0b71844641ce3a1035e05c67b">ast_bridge_kick</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;{</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   <span class="comment">/* Try to find the channel that we want to kick. */</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;   <span class="keywordflow">if</span> (!(bridge_channel = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(bridge, chan))) {</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;   }</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;   res = <a class="code" href="../../de/d41/bridge__channel_8h.html#ad7de2a71d5af8f85035713f1f3cb69a9">ast_bridge_channel_queue_callback</a>(bridge_channel, 0, <a class="code" href="../../d0/d95/bridge_8c.html#acc33b8d4fe39d089f5987e86e0333617">kick_it</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;}</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment"> * \brief Point the bridge_channel to a new bridge.</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment"> * \param bridge_channel What is to point to a new bridge.</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment"> * \param new_bridge Where the bridge channel should point.</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02055"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#abfc1433d64d6a616081e96845af349e3"> 2055</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#abfc1433d64d6a616081e96845af349e3">bridge_channel_change_bridge</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *new_bridge)</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;{</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *old_bridge;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(new_bridge, +1);</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#aa467e25606c2a21df25c61f139007782">ast_bridge_channel_lock</a>(bridge_channel);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;   old_bridge = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a> = new_bridge;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a9860b7152c790e2c80244deb5c67ce5d">ast_channel_internal_bridge_set</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, new_bridge);</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(bridge_channel);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(old_bridge, -1);</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;}</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#add13b23d954c41a17ba991217857c953"> 2070</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#add13b23d954c41a17ba991217857c953">bridge_channel_moving</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *src, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst)</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;{</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a> *hook;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   <span class="comment">/* Run any moving hooks. */</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;   iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>, 0);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;   <span class="keywordflow">for</span> (; (hook = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(hook, -1)) {</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <span class="keywordtype">int</span> remove_me;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a0394614533c00a6ac5483fbb14bae4d5">ast_bridge_move_indicate_callback</a> move_cb;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      <span class="keywordflow">if</span> (hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a9b8d1356a63d1d2c5892a83ea93af921">type</a> != <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ab1e55b40373b3dda769e106081d9dbf1">AST_BRIDGE_HOOK_TYPE_MOVE</a>) {</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      }</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      move_cb = (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a0394614533c00a6ac5483fbb14bae4d5">ast_bridge_move_indicate_callback</a>) hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;      remove_me = move_cb(bridge_channel, hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>, src, dst);</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;      <span class="keywordflow">if</span> (remove_me) {</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Move detection hook %p is being removed from %p(%s)\n&quot;</span>,</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            hook, bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>, hook);</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      }</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   }</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter);</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;}</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a33ad1b704c3dedf9fbf0bf8c2429561a"> 2096</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a33ad1b704c3dedf9fbf0bf8c2429561a">bridge_do_merge</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst_bridge, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *src_bridge, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> **kick_me, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_kick,</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> optimized)</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;{</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Merging bridge %s into bridge %s\n&quot;</span>,</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;   <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a075388377d67766550e9e53761404b99">ast_bridge_publish_merge</a>(dst_bridge, src_bridge);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">    * Move channels from src_bridge over to dst_bridge.</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">    * We must use AST_LIST_TRAVERSE_SAFE_BEGIN() because</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">    * bridge_channel_internal_pull() alters the list we are traversing.</span></div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a>) {</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">          * The channel is already leaving let it leave normally because</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">          * pulling it may delete hooks that should run for this channel.</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      }</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a0e985ea384c79e5e35055ecc0ffb2c57">AST_BRIDGE_CHANNEL_FLAG_IMMOVABLE</a>)) {</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      }</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      <span class="keywordflow">if</span> (kick_me) {</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;         <span class="keywordflow">for</span> (idx = 0; idx &lt; num_kick; ++idx) {</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <span class="keywordflow">if</span> (bridge_channel == kick_me[idx]) {</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;               <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel,</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                  <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            }</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;         }</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      }</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#abbcf6b683169c58f6441e3956257c827">bridge_channel_internal_pull</a>(bridge_channel);</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a>) {</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">          * The channel died as a result of being pulled or it was</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">          * kicked.  Leave it pointing to the original bridge.</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      }</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#add13b23d954c41a17ba991217857c953">bridge_channel_moving</a>(bridge_channel, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, dst_bridge);</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;      <span class="comment">/* Point to new bridge.*/</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#abfc1433d64d6a616081e96845af349e3">bridge_channel_change_bridge</a>(bridge_channel, dst_bridge);</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a9798f7ecff1382a175d9dfcf1e8334e6">bridge_channel_internal_push</a>(bridge_channel)) {</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#a488815ff58d7ea1d8f5e7ce0ef370df5">ast_bridge_features_remove</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>,</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a>);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel,</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a>);</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      }</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;   }</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;   <span class="keywordflow">if</span> (kick_me) {</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment">       * Now we can kick any channels in the dst_bridge without</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment">       * potentially dissolving the bridge.</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keywordflow">for</span> (idx = 0; idx &lt; num_kick; ++idx) {</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;         bridge_channel = kick_me[idx];</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#aa467e25606c2a21df25c61f139007782">ast_bridge_channel_lock</a>(bridge_channel);</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;         <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> == <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a>) {</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            <a class="code" href="../../de/d41/bridge__channel_8h.html#ab37a1835212d045dcfe7ef7f25eb5e31">ast_bridge_channel_leave_bridge_nolock</a>(bridge_channel,</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;               <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;            <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#abbcf6b683169c58f6441e3956257c827">bridge_channel_internal_pull</a>(bridge_channel);</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;         }</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(bridge_channel);</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      }</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;   }</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a>(dst_bridge, !optimized);</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a>(src_bridge, !optimized);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Merged bridge %s into bridge %s\n&quot;</span>,</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;}</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;</div><div class="line"><a name="l02182"></a><span class="lineno"><a class="line" href="../../d0/ddf/structmerge__direction.html"> 2182</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d0/ddf/structmerge__direction.html">merge_direction</a> {<span class="comment"></span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">   /*! Destination merge bridge. */</span></div><div class="line"><a name="l02184"></a><span class="lineno"><a class="line" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1"> 2184</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>;<span class="comment"></span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">   /*! Source merge bridge. */</span></div><div class="line"><a name="l02186"></a><span class="lineno"><a class="line" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2"> 2186</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;};</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment"> * \brief Determine which bridge should merge into the other.</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment"> * \param bridge1 A bridge for merging</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment"> * \param bridge2 A bridge for merging</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment"> * \note The two bridges are assumed already locked.</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment"> * \return Which bridge merges into which or NULL bridges if cannot merge.</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02201"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae6b6b3ffbc54700752cf15b28602e2ba"> 2201</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/ddf/structmerge__direction.html">merge_direction</a> <a class="code" href="../../d0/d95/bridge_8c.html#ae6b6b3ffbc54700752cf15b28602e2ba">bridge_merge_determine_direction</a>(struct <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge1, <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge2)</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;{</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/ddf/structmerge__direction.html">merge_direction</a> merge = { <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> };</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;   <span class="keywordtype">int</span> bridge1_priority;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;   <span class="keywordtype">int</span> bridge2_priority;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge1-&gt;feature_flags,</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a>)</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge2-&gt;feature_flags,</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a>)) {</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">       * Can merge either way.  Merge to the higher priority merge</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">       * bridge.  Otherwise merge to the larger bridge.</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      bridge1_priority = bridge1-&gt;v_table-&gt;get_merge_priority(bridge1);</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;      bridge2_priority = bridge2-&gt;v_table-&gt;get_merge_priority(bridge2);</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keywordflow">if</span> (bridge2_priority &lt; bridge1_priority) {</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;         merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> = bridge1;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;         merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a> = bridge2;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bridge1_priority &lt; bridge2_priority) {</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;         merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> = bridge2;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;         merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a> = bridge1;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;         <span class="comment">/* Merge to the larger bridge. */</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;         <span class="keywordflow">if</span> (bridge2-&gt;num_channels &lt;= bridge1-&gt;num_channels) {</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> = bridge1;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a> = bridge2;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> = bridge2;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a> = bridge1;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;         }</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      }</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge1-&gt;feature_flags, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a>)</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge2-&gt;feature_flags, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a>)) {</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="comment">/* Can merge only one way. */</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> = bridge1;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a> = bridge2;</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge2-&gt;feature_flags, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a>)</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge1-&gt;feature_flags, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a>)) {</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <span class="comment">/* Can merge only one way. */</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> = bridge2;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a> = bridge1;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;   }</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;   <span class="keywordflow">return</span> merge;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;}</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment"> * \brief Merge two bridges together</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment"> * \param dst_bridge Destination bridge of merge.</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment"> * \param src_bridge Source bridge of merge.</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment"> * \param merge_best_direction TRUE if don&#39;t care about which bridge merges into the other.</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment"> * \param kick_me Array of channels to kick from the bridges.</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment"> * \param num_kick Number of channels in the kick_me array.</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment"> * \note The dst_bridge and src_bridge are assumed already locked.</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment"> * \retval -1 on failure</span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02264"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a62e8ca52375a468fe74ec88d1eceea5d"> 2264</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a62e8ca52375a468fe74ec88d1eceea5d">bridge_merge_locked</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst_bridge, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *src_bridge, <span class="keywordtype">int</span> merge_best_direction, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> **kick_me, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_kick)</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;{</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/ddf/structmerge__direction.html">merge_direction</a> merge;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> **kick_them = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;   <span class="comment">/* Sanity check. */</span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(dst_bridge &amp;&amp; src_bridge &amp;&amp; dst_bridge != src_bridge &amp;&amp; (!num_kick || kick_me));</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;   <span class="keywordflow">if</span> (dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a> || src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t merge bridges %s and %s, at least one bridge is dissolved.\n&quot;</span>,</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;         src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;   }</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d">AST_BRIDGE_FLAG_MASQUERADE_ONLY</a>)</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      || <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d">AST_BRIDGE_FLAG_MASQUERADE_ONLY</a>)) {</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t merge bridges %s and %s, masquerade only.\n&quot;</span>,</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;         src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;   }</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;   <span class="keywordflow">if</span> (dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a> || src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a>) {</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t merge bridges %s and %s, merging temporarily inhibited.\n&quot;</span>,</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;         src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;   }</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   <span class="keywordflow">if</span> (merge_best_direction) {</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      merge = <a class="code" href="../../d0/d95/bridge_8c.html#ae6b6b3ffbc54700752cf15b28602e2ba">bridge_merge_determine_direction</a>(dst_bridge, src_bridge);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> = dst_bridge;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a> = src_bridge;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;   }</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;   <span class="keywordflow">if</span> (!merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      || <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a>)</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      || <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a>)) {</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t merge bridges %s and %s, merging inhibited.\n&quot;</span>,</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;         src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;   }</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;   <span class="keywordflow">if</span> (merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> &lt; 2) {</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">       * For a two party bridge, a channel may be temporarily removed</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">       * from the source bridge or the initial bridge members have not</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">       * joined yet.</span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t merge bridge %s into bridge %s, not enough channels in source bridge.\n&quot;</span>,</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;         merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;   }</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;   <span class="keywordflow">if</span> (2 + num_kick &lt; merge.dest-&gt;num_channels + merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      &amp;&amp; !(merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>)</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      &amp;&amp; (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b">AST_BRIDGE_FLAG_SMART</a>)</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;         || !(merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#afe58250d4d4352ae4f0da4012ed4e9fa">allowed_capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>))) {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t merge bridge %s into bridge %s, multimix is needed and it cannot be acquired.\n&quot;</span>,</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;         merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;   }</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;   <span class="keywordflow">if</span> (num_kick) {</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_to_kick = 0;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      kick_them = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(num_kick * <span class="keyword">sizeof</span>(*kick_them));</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <span class="keywordflow">for</span> (idx = 0; idx &lt; num_kick; ++idx) {</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;         kick_them[num_to_kick] = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>, kick_me[idx]);</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;         <span class="keywordflow">if</span> (!kick_them[num_to_kick]) {</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            kick_them[num_to_kick] = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>, kick_me[idx]);</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;         }</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;         <span class="keywordflow">if</span> (kick_them[num_to_kick]) {</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            ++num_to_kick;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;         }</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      }</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;      <span class="keywordflow">if</span> (num_to_kick != num_kick) {</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t merge bridge %s into bridge %s, at least one kicked channel is not in either bridge.\n&quot;</span>,</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      }</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   }</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a33ad1b704c3dedf9fbf0bf8c2429561a">bridge_do_merge</a>(merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>, merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>, kick_them, num_kick, 0);</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;}</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;</div><div class="line"><a name="l02348"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aa88f0cbb002c6f26133bb5d277d4dc49"> 2348</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#aa88f0cbb002c6f26133bb5d277d4dc49">ast_bridge_merge</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst_bridge, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *src_bridge, <span class="keywordtype">int</span> merge_best_direction, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> **kick_me, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_kick)</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;{</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;   <span class="comment">/* Sanity check. */</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(dst_bridge &amp;&amp; src_bridge);</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a04a2852f4166568323aa33cd3d0158c7">ast_bridge_lock_both</a>(dst_bridge, src_bridge);</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;   res = <a class="code" href="../../d0/d95/bridge_8c.html#a62e8ca52375a468fe74ec88d1eceea5d">bridge_merge_locked</a>(dst_bridge, src_bridge, merge_best_direction, kick_me, num_kick);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(src_bridge);</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(dst_bridge);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;}</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div><div class="line"><a name="l02362"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad663022ff4700bb2d53afeea24f402d4"> 2362</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad663022ff4700bb2d53afeea24f402d4">bridge_do_move</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst_bridge, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keywordtype">int</span> attempt_recovery,</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> optimized)</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;{</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *orig_bridge;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;   <span class="keywordtype">int</span> was_in_bridge;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>) {</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Moving %p(%s) into bridge %s swapping with %s\n&quot;</span>,</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;         bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>));</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Moving %p(%s) into bridge %s\n&quot;</span>,</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;         bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;   }</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;   orig_bridge = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;   was_in_bridge = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#afacf05ff49bf5cd3c7170b3c51943d2e">in_bridge</a>;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#abbcf6b683169c58f6441e3956257c827">bridge_channel_internal_pull</a>(bridge_channel);</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a>) {</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">       * The channel died as a result of being pulled.  Leave it</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">       * pointing to the original bridge.</span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">       * Clear out the swap channel pointer.  A ref is not held</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">       * by bridge_channel-&gt;swap at this point.</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a>(orig_bridge, 0);</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;   }</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;   <span class="comment">/* Point to new bridge.*/</span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(orig_bridge, +1);<span class="comment">/* Keep a ref in case the push fails. */</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#abfc1433d64d6a616081e96845af349e3">bridge_channel_change_bridge</a>(bridge_channel, dst_bridge);</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#add13b23d954c41a17ba991217857c953">bridge_channel_moving</a>(bridge_channel, orig_bridge, dst_bridge);</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a5c5538e7375dc6d55c8c0efff87a21f8">bridge_channel_internal_push_full</a>(bridge_channel, optimized)) {</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;      <span class="comment">/* Try to put the channel back into the original bridge. */</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a488815ff58d7ea1d8f5e7ce0ef370df5">ast_bridge_features_remove</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>,</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a>);</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">if</span> (attempt_recovery &amp;&amp; was_in_bridge) {</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;         <span class="comment">/* Point back to original bridge. */</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#abfc1433d64d6a616081e96845af349e3">bridge_channel_change_bridge</a>(bridge_channel, orig_bridge);</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a9798f7ecff1382a175d9dfcf1e8334e6">bridge_channel_internal_push</a>(bridge_channel)) {</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            <a class="code" href="../../d0/d95/bridge_8c.html#a488815ff58d7ea1d8f5e7ce0ef370df5">ast_bridge_features_remove</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>,</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;               <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a>);</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel,</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;               <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a>);</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;         }</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel,</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aa4d0ccb9d0904892652f2f258c5ad225">cause</a>);</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;         <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a47058a18972f43983eb9109737c43229">bridge_channel_settle_owed_events</a>(orig_bridge, bridge_channel);</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      }</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      res = -1;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!optimized) {</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a47058a18972f43983eb9109737c43229">bridge_channel_settle_owed_events</a>(orig_bridge, bridge_channel);</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   }</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a>(dst_bridge, !optimized);</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a>(orig_bridge, !optimized);</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(orig_bridge, -1);</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;}</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment"> * \brief Move a channel from one bridge to another.</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment"> * \param dst_bridge Destination bridge of bridge channel move.</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment"> * \param src_bridge Source bridge of bridge channel move.</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment"> * \param chan Channel to move.</span></div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment"> * \param swap Channel to replace in dst_bridge.</span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment"> * \param attempt_recovery TRUE if failure attempts to push channel back into original bridge.</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment"> * \note The dst_bridge and src_bridge are assumed already locked.</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment"> * \retval 0 on success.</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment"> * \retval -1 on failure.</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02447"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a64d0fdf87038032f7f5032752114e0ef"> 2447</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a64d0fdf87038032f7f5032752114e0ef">bridge_move_locked</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst_bridge, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *src_bridge, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *swap, <span class="keywordtype">int</span> attempt_recovery)</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;{</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;   <span class="keywordflow">if</span> (dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a> || src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, at least one bridge is dissolved.\n&quot;</span>,</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;   }</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d">AST_BRIDGE_FLAG_MASQUERADE_ONLY</a>)</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      || <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d">AST_BRIDGE_FLAG_MASQUERADE_ONLY</a>)) {</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, masquerade only.\n&quot;</span>,</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;   }</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;   <span class="keywordflow">if</span> (dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a> || src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a>) {</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, temporarily inhibited.\n&quot;</span>,</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;   }</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;   bridge_channel = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(src_bridge, chan);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel) {</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, channel not in bridge.\n&quot;</span>,</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;   }</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a>) {</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, channel leaving bridge.\n&quot;</span>,</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;   }</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a0e985ea384c79e5e35055ecc0ffb2c57">AST_BRIDGE_CHANNEL_FLAG_IMMOVABLE</a>)) {</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, channel immovable.\n&quot;</span>,</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;   }</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;   <span class="keywordflow">if</span> (swap) {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel_swap;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      bridge_channel_swap = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(dst_bridge, swap);</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      <span class="keywordflow">if</span> (!bridge_channel_swap) {</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, swap channel %s not in bridge.\n&quot;</span>,</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(swap));</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      }</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="keywordflow">if</span> (bridge_channel_swap-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a>) {</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Can&#39;t move channel %s from bridge %s into bridge %s, swap channel %s leaving bridge.\n&quot;</span>,</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), src_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, dst_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(swap));</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      }</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;   }</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;   bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = <a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad663022ff4700bb2d53afeea24f402d4">bridge_do_move</a>(dst_bridge, bridge_channel, attempt_recovery, 0);</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;}</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div><div class="line"><a name="l02508"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af0e3d51ad653134a92545dec4610b83a"> 2508</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#af0e3d51ad653134a92545dec4610b83a">ast_bridge_move</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst_bridge, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *src_bridge, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a>, <span class="keywordtype">int</span> attempt_recovery)</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;{</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a04a2852f4166568323aa33cd3d0158c7">ast_bridge_lock_both</a>(dst_bridge, src_bridge);</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   res = <a class="code" href="../../d0/d95/bridge_8c.html#a64d0fdf87038032f7f5032752114e0ef">bridge_move_locked</a>(dst_bridge, src_bridge, chan, swap, attempt_recovery);</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(src_bridge);</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(dst_bridge);</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;}</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div><div class="line"><a name="l02519"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aabeca6aae7e5db0dfe25ab88c1a40b07"> 2519</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#aabeca6aae7e5db0dfe25ab88c1a40b07">ast_bridge_add_channel</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>, <span class="keywordtype">int</span> play_tone, <span class="keyword">const</span> <span class="keywordtype">char</span> *xfersound)</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;{</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *, chan_bridge, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, yanked_chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   <a class="code" href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a>(chan);</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;   chan_bridge = <a class="code" href="../../d5/d7b/channel_8h.html#a557663006d52a9cdc11f42602bf48326">ast_channel_get_bridge</a>(chan);</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   <span class="keywordflow">if</span> (chan_bridge) {</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;      <span class="comment">/* The channel is in a bridge so it is not getting any new features. */</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(features);</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a04a2852f4166568323aa33cd3d0158c7">ast_bridge_lock_both</a>(bridge, chan_bridge);</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      bridge_channel = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(chan_bridge, chan);</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a64d0fdf87038032f7f5032752114e0ef">bridge_move_locked</a>(bridge, chan_bridge, chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1)) {</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(chan_bridge);</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;      }</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment">       * bridge_move_locked() will implicitly ensure that</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="comment">       * bridge_channel is not NULL.</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(bridge_channel != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">       * Additional checks if the channel we just stole dissolves the</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment">       * original bridge.</span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#ae73ffed95c5c683369117e42e864d3c4">bridge_dissolve_check_stolen</a>(chan_bridge, bridge_channel);</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(chan_bridge);</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <span class="comment">/* Slightly less easy case. We need to yank channel A from</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment">       * where he currently is and impart him into our bridge.</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      yanked_chan = <a class="code" href="../../d5/d7b/channel_8h.html#a17e5eed14e9256176bb685dc7bac620a">ast_channel_yank</a>(chan);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;      <span class="keywordflow">if</span> (!yanked_chan) {</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Could not gain control of channel %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(features);</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      }</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(yanked_chan) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>) {</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aec583a3e25358ee552a4f3df53914cd0">ast_answer</a>(yanked_chan);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      }</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(yanked_chan);</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a4a1f0ebb4769ef2340211b0d05a1077a">ast_bridge_impart</a>(bridge, yanked_chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, features,</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101aecfd8e6279a21b20ee4db0ab69c847e8">AST_BRIDGE_IMPART_CHAN_INDEPENDENT</a>)) {</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;         <span class="comment">/* It is possible for us to yank a channel and have some other</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment">          * thread start a PBX on the channl after we yanked it. In particular,</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment">          * this can theoretically happen on the ;2 of a Local channel if we</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment">          * yank it prior to the ;1 being answered. Make sure that it isn&#39;t</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment">          * executing a PBX before hanging it up.</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a488b7d6f7488bedc53be45d4ef4471c9">ast_channel_pbx</a>(yanked_chan)) {</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(yanked_chan);</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(yanked_chan);</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;         }</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      }</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;   }</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;   <span class="keywordflow">if</span> (play_tone &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(xfersound)) {</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *play_chan = yanked_chan ?: chan;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *, play_bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(play_chan);</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      play_bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(play_chan);</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(play_chan);</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="keywordflow">if</span> (!play_bridge_channel) {</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to play tone for channel %s. No longer in a bridge.\n&quot;</span>,</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(play_chan));</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ac352fd6d6188d7431155f34ae2a38799">ast_bridge_channel_queue_playfile</a>(play_bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, xfersound, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      }</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;   }</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;}</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;</div><div class="line"><a name="l02608"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af3b2e27d3b3da68a7a5138232ad83a41"> 2608</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#af3b2e27d3b3da68a7a5138232ad83a41">bridge_allows_optimization</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;{</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;   <span class="keywordflow">return</span> !(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      || bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      || <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d">AST_BRIDGE_FLAG_MASQUERADE_ONLY</a>));</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;}</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="comment"> * \brief Lock the unreal channel stack for chan and prequalify it.</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="comment"> * \param chan Unreal channel writing a frame into the channel driver.</span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment"> * \note It is assumed that chan is already locked.</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment"> * \retval bridge on success with bridge and bridge_channel locked.</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment"> * \retval NULL if cannot do optimization now.</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02627"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af896b3004eea94ee58a6b027ac4aed7a"> 2627</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#af896b3004eea94ee58a6b027ac4aed7a">optimize_lock_chan_stack</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;{</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ad89ab3133d87a496f63da917148d02be">ast_channel_readq</a>(chan))) {</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;   }</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(chan), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a7aeded1dc9df91dee01bb7af719880c1">AST_FLAG_EMULATE_DTMF</a>)) {</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;   }</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#affc167c91eb29d524a3dda826715a695">ast_channel_has_audio_frame_or_monitor</a>(chan)) {</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;      <span class="comment">/* Channel has an active monitor, audiohook, or framehook. */</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;   }</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;   bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a5e41daaa81df59fc1e8eea2796029c31">ast_channel_internal_bridge_channel</a>(chan);</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel || <a class="code" href="../../de/d41/bridge__channel_8h.html#aaa58823cb0b78a23c0b9e869d2ccfe7f">ast_bridge_channel_trylock</a>(bridge_channel)) {</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;   }</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;   bridge = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#ab1fa9a8c0210d018531c277982b76b44">activity</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ad52acdbb06c9299895662cf57a4323a3aae37f04db23e9c3e3d350cc34c6476ef">BRIDGE_CHANNEL_THREAD_SIMPLE</a></div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      || bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;      || <a class="code" href="../../d4/d56/bridge_8h.html#a2739c3a2cbad57dc988580e02082295c">ast_bridge_trylock</a>(bridge)) {</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(bridge_channel);</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;   }</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#aa08031dd21d51319a38015ed87e74687">bridge_channel_internal_allows_optimization</a>(bridge_channel) ||</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;         !<a class="code" href="../../d0/d95/bridge_8c.html#af3b2e27d3b3da68a7a5138232ad83a41">bridge_allows_optimization</a>(bridge)) {</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(bridge_channel);</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;   }</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;}</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment"> * \brief Lock the unreal channel stack for peer and prequalify it.</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment"> * \param peer Other unreal channel in the pair.</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment"> * \retval bridge on success with bridge, bridge_channel, and peer locked.</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment"> * \retval NULL if cannot do optimization now.</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02672"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#adcadbc8335db73d28f48f0c10473d2d5"> 2672</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#adcadbc8335db73d28f48f0c10473d2d5">optimize_lock_peer_stack</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer)</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;{</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a7dc0d696d897c864c6f41a3a1795c82e">ast_channel_trylock</a>(peer)) {</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;   }</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ad89ab3133d87a496f63da917148d02be">ast_channel_readq</a>(peer))) {</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;   }</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(peer), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a7aeded1dc9df91dee01bb7af719880c1">AST_FLAG_EMULATE_DTMF</a>)) {</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;   }</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#affc167c91eb29d524a3dda826715a695">ast_channel_has_audio_frame_or_monitor</a>(peer)) {</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      <span class="comment">/* Peer has an active monitor, audiohook, or framehook. */</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;   }</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;   bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a5e41daaa81df59fc1e8eea2796029c31">ast_channel_internal_bridge_channel</a>(peer);</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel || <a class="code" href="../../de/d41/bridge__channel_8h.html#aaa58823cb0b78a23c0b9e869d2ccfe7f">ast_bridge_channel_trylock</a>(bridge_channel)) {</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;   }</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;   bridge = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;   <span class="keywordflow">if</span> (bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#ab1fa9a8c0210d018531c277982b76b44">activity</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ad52acdbb06c9299895662cf57a4323a3aeaf381ba8ae8b2716b0dff5e77d539f4">BRIDGE_CHANNEL_THREAD_IDLE</a></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      || bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> != <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      || <a class="code" href="../../d4/d56/bridge_8h.html#a2739c3a2cbad57dc988580e02082295c">ast_bridge_trylock</a>(bridge)) {</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(bridge_channel);</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;   }</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d95/bridge_8c.html#af3b2e27d3b3da68a7a5138232ad83a41">bridge_allows_optimization</a>(bridge) ||</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;         !<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#aa08031dd21d51319a38015ed87e74687">bridge_channel_internal_allows_optimization</a>(bridge_channel)) {</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(bridge_channel);</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;   }</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;}</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment"> * \brief Indicates allowability of a swap optimization</span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02720"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfa"> 2720</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfa">bridge_allow_swap</a> {<span class="comment"></span></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;<span class="comment">   /*! Bridges cannot allow for a swap optimization to occur */</span></div><div class="line"><a name="l02722"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa11c04bbc25aef5e5c5628ef5d9ccc5c9"> 2722</a></span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa11c04bbc25aef5e5c5628ef5d9ccc5c9">SWAP_PROHIBITED</a>,<span class="comment"></span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="comment">   /*! Bridge swap optimization can occur into the chan_bridge */</span></div><div class="line"><a name="l02724"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8"> 2724</a></span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8">SWAP_TO_CHAN_BRIDGE</a>,<span class="comment"></span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="comment">   /*! Bridge swap optimization can occur into the peer_bridge */</span></div><div class="line"><a name="l02726"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396"> 2726</a></span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396">SWAP_TO_PEER_BRIDGE</a>,</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;};</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="comment"> * \brief Determine if two bridges allow for swap optimization to occur</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="comment"> * \param chan_bridge First bridge being tested</span></div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="comment"> * \param peer_bridge Second bridge being tested</span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="comment"> * \return Allowability of swap optimization</span></div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02737"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae87543d0bf935a2f28cfc8b7e8cacf9c"> 2737</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfa">bridge_allow_swap</a> <a class="code" href="../../d0/d95/bridge_8c.html#ae87543d0bf935a2f28cfc8b7e8cacf9c">bridges_allow_swap_optimization</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *chan_bridge,</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *peer_bridge)</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;{</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;   <span class="keywordtype">int</span> chan_priority;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;   <span class="keywordtype">int</span> peer_priority;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;chan_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a173b4026818e079f4ad64dcb090863b0">AST_BRIDGE_FLAG_SWAP_INHIBIT_TO</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a> |</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3">AST_BRIDGE_FLAG_TRANSFER_BRIDGE_ONLY</a>)</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;peer_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a173b4026818e079f4ad64dcb090863b0">AST_BRIDGE_FLAG_SWAP_INHIBIT_TO</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a> |</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3">AST_BRIDGE_FLAG_TRANSFER_BRIDGE_ONLY</a>)) {</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment">       * Can swap either way.  Swap to the higher priority merge</span></div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment">       * bridge.</span></div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      chan_priority = chan_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#ad74029594a0d1e6b9863ce3f02c82d25">get_merge_priority</a>(chan_bridge);</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;      peer_priority = peer_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#ad74029594a0d1e6b9863ce3f02c82d25">get_merge_priority</a>(peer_bridge);</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      <span class="keywordflow">if</span> (chan_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> == 2</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;         &amp;&amp; chan_priority &lt;= peer_priority) {</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396">SWAP_TO_PEER_BRIDGE</a>;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (peer_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> == 2</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;         &amp;&amp; peer_priority &lt;= chan_priority) {</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8">SWAP_TO_CHAN_BRIDGE</a>;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      }</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (chan_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> == 2</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;chan_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3">AST_BRIDGE_FLAG_TRANSFER_BRIDGE_ONLY</a>)</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;peer_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a173b4026818e079f4ad64dcb090863b0">AST_BRIDGE_FLAG_SWAP_INHIBIT_TO</a>)) {</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      <span class="comment">/* Can swap optimize only one way. */</span></div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396">SWAP_TO_PEER_BRIDGE</a>;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (peer_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> == 2</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;peer_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3">AST_BRIDGE_FLAG_TRANSFER_BRIDGE_ONLY</a>)</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;chan_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a173b4026818e079f4ad64dcb090863b0">AST_BRIDGE_FLAG_SWAP_INHIBIT_TO</a>)) {</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;      <span class="comment">/* Can swap optimize only one way. */</span></div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8">SWAP_TO_CHAN_BRIDGE</a>;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;   }</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa11c04bbc25aef5e5c5628ef5d9ccc5c9">SWAP_PROHIBITED</a>;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;}</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="comment"> * \brief Check and attempt to swap optimize out the unreal channels.</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="comment"> * \param chan_bridge</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment"> * \param chan_bridge_channel</span></div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment"> * \param peer_bridge</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment"> * \param peer_bridge_channel</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment"> * \param pvt Unreal data containing callbacks to call if the optimization actually</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment"> * happens</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="comment"> * \retval 1 if unreal channels failed to optimize out.</span></div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment"> * \retval 0 if unreal channels were not optimized out.</span></div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment"> * \retval -1 if unreal channels were optimized out.</span></div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02793"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a92647c50f3371f83be09ba7a75cceda4"> 2793</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a92647c50f3371f83be09ba7a75cceda4">try_swap_optimize_out</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *chan_bridge,</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *chan_bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *peer_bridge,</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *peer_bridge_channel,</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d6/df3/structast__unreal__pvt.html">ast_unreal_pvt</a> *pvt)</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;{</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dst_bridge;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *dst_bridge_channel;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *src_bridge_channel;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *other;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;   <span class="keywordtype">int</span> res = 1;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d95/bridge_8c.html#ae87543d0bf935a2f28cfc8b7e8cacf9c">bridges_allow_swap_optimization</a>(chan_bridge, peer_bridge)) {</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8">SWAP_TO_CHAN_BRIDGE</a>:</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      dst_bridge = chan_bridge;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;      dst_bridge_channel = chan_bridge_channel;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      src_bridge_channel = peer_bridge_channel;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396">SWAP_TO_PEER_BRIDGE</a>:</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      dst_bridge = peer_bridge;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      dst_bridge_channel = peer_bridge_channel;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      src_bridge_channel = chan_bridge_channel;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa11c04bbc25aef5e5c5628ef5d9ccc5c9">SWAP_PROHIBITED</a>:</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;   }</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;   other = <a class="code" href="../../de/d41/bridge__channel_8h.html#a0a9bea2845810c6891440a012a275a36">ast_bridge_channel_peer</a>(src_bridge_channel);</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;   <span class="keywordflow">if</span> (other &amp;&amp; other-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> == <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a>) {</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a7dc0d696d897c864c6f41a3a1795c82e">ast_channel_trylock</a>(other-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)) {</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      }</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;      <span class="keywordtype">id</span> = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>((<span class="keywordtype">int</span> *) &amp;<a class="code" href="../../d0/d95/bridge_8c.html#a3a4e6edefaf27f09e1bc4957eebd7b03">optimization_id</a>, +1);</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(4, <span class="stringliteral">&quot;Move-swap optimizing %s &lt;-- %s.\n&quot;</span>,</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(dst_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(other-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;      <span class="keywordflow">if</span> (pvt &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(pvt, <a class="code" href="../../de/dea/core__unreal_8h.html#ad55f22267e8737cc26281d7d3c6f8bc2">AST_UNREAL_OPTIMIZE_BEGUN</a>) &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;            &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a3c5890f67bf431d002c55d3ed27adfa0">optimization_started</a>) {</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;         pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a3c5890f67bf431d002c55d3ed27adfa0">optimization_started</a>(pvt, other-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;               dst_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> ? <a class="code" href="../../de/dea/core__unreal_8h.html#abc6dcce8e64173a023700dd4288d7c97add17eccb0c0c8596b9327fd0fad20742">AST_UNREAL_OWNER</a> : <a class="code" href="../../de/dea/core__unreal_8h.html#abc6dcce8e64173a023700dd4288d7c97a73803b5d3e3bb9524f6d741e854f201e">AST_UNREAL_CHAN</a>,</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;               <span class="keywordtype">id</span>);</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(pvt, <a class="code" href="../../de/dea/core__unreal_8h.html#ad55f22267e8737cc26281d7d3c6f8bc2">AST_UNREAL_OPTIMIZE_BEGUN</a>);</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      }</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      other-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = dst_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d95/bridge_8c.html#ad663022ff4700bb2d53afeea24f402d4">bridge_do_move</a>(dst_bridge, other, 1, 1)) {</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(src_bridge_channel,</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;            <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;         res = -1;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      }</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      <span class="keywordflow">if</span> (pvt &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a> &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a54bf951daa7d73ff3854c6732d286212">optimization_finished</a>) {</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;         pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a54bf951daa7d73ff3854c6732d286212">optimization_finished</a>(pvt, res == 1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      }</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(other-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;   }</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;}</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment"> * \brief Indicates allowability of a merge optimization</span></div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02859"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809"> 2859</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809">bridge_allow_merge</a> {<span class="comment"></span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="comment">   /*! Bridge properties prohibit merge optimization */</span></div><div class="line"><a name="l02861"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809ac027a2515d44ca996604448ede37c6c7"> 2861</a></span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809ac027a2515d44ca996604448ede37c6c7">MERGE_PROHIBITED</a>,<span class="comment"></span></div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="comment">   /*! Merge optimization cannot occur because the source bridge has too few channels */</span></div><div class="line"><a name="l02863"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a47b44b85339b2afeaece06fe40406320"> 2863</a></span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a47b44b85339b2afeaece06fe40406320">MERGE_NOT_ENOUGH_CHANNELS</a>,<span class="comment"></span></div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="comment">   /*! Merge optimization cannot occur because multimix capability could not be requested */</span></div><div class="line"><a name="l02865"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a6331216e8bbd887cfd1ef11b5e73b0ff"> 2865</a></span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a6331216e8bbd887cfd1ef11b5e73b0ff">MERGE_NO_MULTIMIX</a>,<span class="comment"></span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment">   /*! Merge optimization allowed between bridges */</span></div><div class="line"><a name="l02867"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a3caf33d916f7fcd0541cc595538624ce"> 2867</a></span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a3caf33d916f7fcd0541cc595538624ce">MERGE_ALLOWED</a>,</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;};</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="comment"> * \brief Determines allowability of a merge optimization</span></div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="comment"> * \note The merge output parameter is undefined if MERGE_PROHIBITED is returned. For success</span></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment"> * and other failure returns, a merge direction was determined, and the parameter is safe to</span></div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment"> * access.</span></div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;<span class="comment"> * \param chan_bridge First bridge being tested</span></div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;<span class="comment"> * \param peer_bridge Second bridge being tested</span></div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="comment"> * \param num_kick_channels The number of channels to remove from the bridges during merging</span></div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="comment"> * \param[out] merge Indicates the recommended direction for the bridge merge</span></div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02883"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a648cca4e2d0e75ab65456c291ad1e11a"> 2883</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809">bridge_allow_merge</a> <a class="code" href="../../d0/d95/bridge_8c.html#a648cca4e2d0e75ab65456c291ad1e11a">bridges_allow_merge_optimization</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *chan_bridge,</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *peer_bridge, <span class="keywordtype">int</span> num_kick_channels, <span class="keyword">struct</span> <a class="code" href="../../d0/ddf/structmerge__direction.html">merge_direction</a> *merge)</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;{</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;   *merge = <a class="code" href="../../d0/d95/bridge_8c.html#ae6b6b3ffbc54700752cf15b28602e2ba">bridge_merge_determine_direction</a>(chan_bridge, peer_bridge);</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;   <span class="keywordflow">if</span> (!merge-&gt;<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>) {</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809ac027a2515d44ca996604448ede37c6c7">MERGE_PROHIBITED</a>;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;   }</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;   <span class="keywordflow">if</span> (merge-&gt;<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> &lt; 2) {</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a47b44b85339b2afeaece06fe40406320">MERGE_NOT_ENOUGH_CHANNELS</a>;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((2 + num_kick_channels) &lt; merge-&gt;<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> + merge-&gt;<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a></div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;      &amp;&amp; !(merge-&gt;<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>)</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;      &amp;&amp; (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;merge-&gt;<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b">AST_BRIDGE_FLAG_SMART</a>)</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;         || !(merge-&gt;<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#afe58250d4d4352ae4f0da4012ed4e9fa">allowed_capabilities</a> &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>))) {</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a6331216e8bbd887cfd1ef11b5e73b0ff">MERGE_NO_MULTIMIX</a>;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;   }</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a3caf33d916f7fcd0541cc595538624ce">MERGE_ALLOWED</a>;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;}</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="comment"> * \brief Check and attempt to merge optimize out the unreal channels.</span></div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;<span class="comment"> * \param chan_bridge</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;<span class="comment"> * \param chan_bridge_channel</span></div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="comment"> * \param peer_bridge</span></div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="comment"> * \param peer_bridge_channel</span></div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;<span class="comment"> * \param pvt Unreal data containing callbacks to call if the optimization actually</span></div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="comment"> * happens</span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="comment"> * \retval 0 if unreal channels were not optimized out.</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;<span class="comment"> * \retval -1 if unreal channels were optimized out.</span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02917"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a5991ed87aa081fe89ca273cd4c029cfa"> 2917</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a5991ed87aa081fe89ca273cd4c029cfa">try_merge_optimize_out</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *chan_bridge,</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *chan_bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *peer_bridge,</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *peer_bridge_channel,</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d6/df3/structast__unreal__pvt.html">ast_unreal_pvt</a> *pvt)</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;{</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/ddf/structmerge__direction.html">merge_direction</a> merge;</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *kick_me[] = {</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;      chan_bridge_channel,</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      peer_bridge_channel,</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;   };</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a648cca4e2d0e75ab65456c291ad1e11a">bridges_allow_merge_optimization</a>(chan_bridge, peer_bridge, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(kick_me), &amp;merge)) {</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a3caf33d916f7fcd0541cc595538624ce">MERGE_ALLOWED</a>:</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809ac027a2515d44ca996604448ede37c6c7">MERGE_PROHIBITED</a>:</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a47b44b85339b2afeaece06fe40406320">MERGE_NOT_ENOUGH_CHANNELS</a>:</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Can&#39;t optimize %s -- %s out, not enough channels in bridge %s.\n&quot;</span>,</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;         merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a6331216e8bbd887cfd1ef11b5e73b0ff">MERGE_NO_MULTIMIX</a>:</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Can&#39;t optimize %s -- %s out, multimix is needed and it cannot be acquired.\n&quot;</span>,</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;   }</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(4, <span class="stringliteral">&quot;Merge optimizing %s -- %s out.\n&quot;</span>,</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer_bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;   <span class="keywordtype">id</span> = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>((<span class="keywordtype">int</span> *) &amp;<a class="code" href="../../d0/d95/bridge_8c.html#a3a4e6edefaf27f09e1bc4957eebd7b03">optimization_id</a>, +1);</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;   <span class="keywordflow">if</span> (pvt &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(pvt, <a class="code" href="../../de/dea/core__unreal_8h.html#ad55f22267e8737cc26281d7d3c6f8bc2">AST_UNREAL_OPTIMIZE_BEGUN</a>) &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;         &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a3c5890f67bf431d002c55d3ed27adfa0">optimization_started</a>) {</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;      pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a3c5890f67bf431d002c55d3ed27adfa0">optimization_started</a>(pvt, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;            merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> == <a class="code" href="../../d5/d7b/channel_8h.html#a2e46e4da6a025dfe7c64c4f1a480967b">ast_channel_internal_bridge</a>(pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) ? <a class="code" href="../../de/dea/core__unreal_8h.html#abc6dcce8e64173a023700dd4288d7c97add17eccb0c0c8596b9327fd0fad20742">AST_UNREAL_OWNER</a> : <a class="code" href="../../de/dea/core__unreal_8h.html#abc6dcce8e64173a023700dd4288d7c97a73803b5d3e3bb9524f6d741e854f201e">AST_UNREAL_CHAN</a>,</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;            <span class="keywordtype">id</span>);</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(pvt, <a class="code" href="../../de/dea/core__unreal_8h.html#ad55f22267e8737cc26281d7d3c6f8bc2">AST_UNREAL_OPTIMIZE_BEGUN</a>);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;   }</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a33ad1b704c3dedf9fbf0bf8c2429561a">bridge_do_merge</a>(merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a>, merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">src</a>, kick_me, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(kick_me), 1);</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;   <span class="keywordflow">if</span> (pvt &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a> &amp;&amp; pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a54bf951daa7d73ff3854c6732d286212">optimization_finished</a>) {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      pvt-&gt;<a class="code" href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">callbacks</a>-&gt;<a class="code" href="../../df/d09/structast__unreal__pvt__callbacks.html#a54bf951daa7d73ff3854c6732d286212">optimization_finished</a>(pvt, 1, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;   }</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;}</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;</div><div class="line"><a name="l02968"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#acbc344c8fa0a95134e759c71b87af890"> 2968</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#acbc344c8fa0a95134e759c71b87af890">ast_bridge_unreal_optimize_out</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer, <span class="keyword">struct</span> <a class="code" href="../../d6/df3/structast__unreal__pvt.html">ast_unreal_pvt</a> *pvt)</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;{</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *chan_bridge;</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *peer_bridge;</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *chan_bridge_channel;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *peer_bridge_channel;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;   chan_bridge = <a class="code" href="../../d0/d95/bridge_8c.html#af896b3004eea94ee58a6b027ac4aed7a">optimize_lock_chan_stack</a>(chan);</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;   <span class="keywordflow">if</span> (!chan_bridge) {</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;   }</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   chan_bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a5e41daaa81df59fc1e8eea2796029c31">ast_channel_internal_bridge_channel</a>(chan);</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   peer_bridge = <a class="code" href="../../d0/d95/bridge_8c.html#adcadbc8335db73d28f48f0c10473d2d5">optimize_lock_peer_stack</a>(peer);</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;   <span class="keywordflow">if</span> (peer_bridge) {</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      peer_bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a5e41daaa81df59fc1e8eea2796029c31">ast_channel_internal_bridge_channel</a>(peer);</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;      res = <a class="code" href="../../d0/d95/bridge_8c.html#a92647c50f3371f83be09ba7a75cceda4">try_swap_optimize_out</a>(chan_bridge, chan_bridge_channel,</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;         peer_bridge, peer_bridge_channel, pvt);</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;         res = <a class="code" href="../../d0/d95/bridge_8c.html#a5991ed87aa081fe89ca273cd4c029cfa">try_merge_optimize_out</a>(chan_bridge, chan_bridge_channel,</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;            peer_bridge, peer_bridge_channel, pvt);</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 &lt; res) {</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;         res = 0;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      }</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      <span class="comment">/* Release peer locks. */</span></div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(peer_bridge);</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(peer_bridge_channel);</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;   }</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;   <span class="comment">/* Release chan locks. */</span></div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(chan_bridge);</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(chan_bridge_channel);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;}</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;</div><div class="line"><a name="l03008"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad460c5de90f3a8925c9149bbacce65f8"> 3008</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534">ast_bridge_optimization</a> <a class="code" href="../../d0/d95/bridge_8c.html#ad460c5de90f3a8925c9149bbacce65f8">ast_bridges_allow_optimization</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *chan_bridge,</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *peer_bridge)</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;{</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/ddf/structmerge__direction.html">merge_direction</a> merge;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d95/bridge_8c.html#af3b2e27d3b3da68a7a5138232ad83a41">bridge_allows_optimization</a>(chan_bridge) || !<a class="code" href="../../d0/d95/bridge_8c.html#af3b2e27d3b3da68a7a5138232ad83a41">bridge_allows_optimization</a>(peer_bridge)) {</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a19fe1f0ca6993cc12c518aa09fb79a79">AST_BRIDGE_OPTIMIZE_PROHIBITED</a>;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;   }</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d95/bridge_8c.html#ae87543d0bf935a2f28cfc8b7e8cacf9c">bridges_allow_swap_optimization</a>(chan_bridge, peer_bridge)) {</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8">SWAP_TO_CHAN_BRIDGE</a>:</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534add0740f1c8620ab74b253de5bac26ec7">AST_BRIDGE_OPTIMIZE_SWAP_TO_CHAN_BRIDGE</a>;</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396">SWAP_TO_PEER_BRIDGE</a>:</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a582d8fd99bc8f3320608f74efb142ee7">AST_BRIDGE_OPTIMIZE_SWAP_TO_PEER_BRIDGE</a>;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa11c04bbc25aef5e5c5628ef5d9ccc5c9">SWAP_PROHIBITED</a>:</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   }</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;   <span class="comment">/* Two channels will be kicked from the bridges, the unreal;1 and unreal;2 channels */</span></div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a648cca4e2d0e75ab65456c291ad1e11a">bridges_allow_merge_optimization</a>(chan_bridge, peer_bridge, 2, &amp;merge) != <a class="code" href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a3caf33d916f7fcd0541cc595538624ce">MERGE_ALLOWED</a>) {</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a19fe1f0ca6993cc12c518aa09fb79a79">AST_BRIDGE_OPTIMIZE_PROHIBITED</a>;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;   }</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;   <span class="keywordflow">if</span> (merge.<a class="code" href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">dest</a> == chan_bridge) {</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a2980a16e43b7b4f52b6c3af11bd79a56">AST_BRIDGE_OPTIMIZE_MERGE_TO_CHAN_BRIDGE</a>;</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a83a14f41557a30da243c32b7f717ed1f">AST_BRIDGE_OPTIMIZE_MERGE_TO_PEER_BRIDGE</a>;</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;   }</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;}</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="comment"> * \brief Adjust the bridge merge inhibit request count.</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment"> * \param bridge What to operate on.</span></div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="comment"> * \param request Inhibit request increment.</span></div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment"> *     (Positive to add requests.  Negative to remove requests.)</span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment"> * \note This function assumes bridge is locked.</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03052"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae1af73cc9e9cce0a151dddc8cfae3e4b"> 3052</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ae1af73cc9e9cce0a151dddc8cfae3e4b">bridge_merge_inhibit_nolock</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">int</span> <a class="code" href="../../d0/d29/chan__pjsip_8c.html#a4e2e6fb7d874f0d2deddd2ecfc8afb32">request</a>)</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;{</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;   <span class="keywordtype">int</span> new_request;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;   new_request = bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a> + <a class="code" href="../../d0/d29/chan__pjsip_8c.html#a4e2e6fb7d874f0d2deddd2ecfc8afb32">request</a>;</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0 &lt;= new_request);</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a> = new_request;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;}</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;</div><div class="line"><a name="l03061"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a6bae9b013c815c40d0414080455e3592"> 3061</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a6bae9b013c815c40d0414080455e3592">ast_bridge_merge_inhibit</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">int</span> <a class="code" href="../../d0/d29/chan__pjsip_8c.html#a4e2e6fb7d874f0d2deddd2ecfc8afb32">request</a>)</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;{</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ae1af73cc9e9cce0a151dddc8cfae3e4b">bridge_merge_inhibit_nolock</a>(bridge, request);</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;}</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;</div><div class="line"><a name="l03068"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a85bc0d4138ac2af7b207d8f1325f051a"> 3068</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a85bc0d4138ac2af7b207d8f1325f051a">ast_bridge_suspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;{</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">/* XXX ASTERISK-21271 the case of a disolved bridge while channel is suspended is not handled. */</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">/* XXX ASTERISK-21271 suspend/unsuspend needs to be rethought. The caller must block until it has successfully suspended the channel for temporary control. */</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">/* XXX ASTERISK-21271 external suspend/unsuspend needs to be eliminated. The channel may be playing a file at the time and stealing it then is not good. */</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;   <span class="keywordflow">if</span> (!(bridge_channel = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(bridge, chan))) {</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;   }</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;   <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a447f05a7615581929349765430257a75">bridge_channel_internal_suspend_nolock</a>(bridge_channel);</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;}</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;</div><div class="line"><a name="l03089"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aab4cd1153d39a6744eca6a84d5255820"> 3089</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#aab4cd1153d39a6744eca6a84d5255820">ast_bridge_unsuspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;{</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;<span class="comment">/* XXX ASTERISK-21271 the case of a disolved bridge while channel is suspended is not handled. */</span></div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;   <span class="keywordflow">if</span> (!(bridge_channel = <a class="code" href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a>(bridge, chan))) {</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;   }</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;   <a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a25adcc7a991b49286746a062291ce1e1">bridge_channel_internal_unsuspend_nolock</a>(bridge_channel);</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;}</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;</div><div class="line"><a name="l03108"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#acd557b9305cf531bd1d66acbe39d12ee"> 3108</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#acd557b9305cf531bd1d66acbe39d12ee">ast_bridge_technology_suspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *technology)</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;{</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;   technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">suspended</a> = 1;</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;}</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;</div><div class="line"><a name="l03113"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a24bb22d467a5f840fe8c954f9c7624d1"> 3113</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a24bb22d467a5f840fe8c954f9c7624d1">ast_bridge_technology_unsuspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *technology)</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;{</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;<span class="comment">    * XXX We may want the act of unsuspending a bridge technology</span></div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;<span class="comment">    * to prod all existing bridges to see if they should start</span></div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;<span class="comment">    * using it.</span></div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;   technology-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">suspended</a> = 0;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;}</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;</div><div class="line"><a name="l03123"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae364d78e48f19a0d5ceedc6d18cda52d"> 3123</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#ae364d78e48f19a0d5ceedc6d18cda52d">ast_bridge_features_register</a>(<span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> feature, <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> callback, <span class="keyword">const</span> <span class="keywordtype">char</span> *dtmf)</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;{</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>) &lt;= feature</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      || <a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[feature]) {</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;   }</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dtmf)) {</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a>[feature], dtmf, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d95/bridge_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a>[feature]));</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;   }</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[feature] = callback;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;}</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;</div><div class="line"><a name="l03139"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a395272994b2af7bd55f871b02d2d42e4"> 3139</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a395272994b2af7bd55f871b02d2d42e4">ast_bridge_features_unregister</a>(<span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> feature)</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;{</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>) &lt;= feature</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      || !<a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[feature]) {</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;   }</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[feature] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;}</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;</div><div class="line"><a name="l03151"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a5ad28c249794c7354336fc512fab8f7a"> 3151</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a5ad28c249794c7354336fc512fab8f7a">ast_bridge_features_do</a>(<span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> feature, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keywordtype">void</span> *hook_pvt)</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;{</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> callback;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>) &lt;= feature) {</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;   }</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;   callback = <a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[feature];</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;   <span class="keywordflow">if</span> (!callback) {</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   }</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;   callback(bridge_channel, hook_pvt);</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;}</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;</div><div class="line"><a name="l03168"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aad34a20efdcfd5b19f83b5add802d9f2"> 3168</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#aad34a20efdcfd5b19f83b5add802d9f2">ast_bridge_interval_register</a>(<span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960d">ast_bridge_builtin_interval</a> interval, <a class="code" href="../../dc/d7a/bridge__features_8h.html#acf985c9cba5e118bd24fdf980b59f955">ast_bridge_builtin_set_limits_fn</a> callback)</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;{</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>) &lt;= interval</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      || <a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>[interval]) {</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   }</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>[interval] = callback;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;}</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;</div><div class="line"><a name="l03180"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aca0bafd961ecfd1784bbef8ce50b8b1b"> 3180</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#aca0bafd961ecfd1784bbef8ce50b8b1b">ast_bridge_interval_unregister</a>(<span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960d">ast_bridge_builtin_interval</a> interval)</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;{</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>) &lt;= interval</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      || !<a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>[interval]) {</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;   }</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>[interval] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;}</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment"> * \brief Bridge hook destructor.</span></div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="comment"> * \param vhook Object to destroy.</span></div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03202"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a49108e57ad6d4b850b71f00185ffc366"> 3202</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a49108e57ad6d4b850b71f00185ffc366">bridge_hook_destroy</a>(<span class="keywordtype">void</span> *vhook)</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;{</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a> *hook = vhook;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;   <span class="keywordflow">if</span> (hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>) {</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>(hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>);</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   }</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;}</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment"> * \brief Allocate and setup a generic bridge hook.</span></div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment"> * \param size How big an object to allocate.</span></div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment"> * \param callback Function to execute upon activation</span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment"> * \param hook_pvt Unique data</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment"> * \param destructor Optional destructor callback for hook_pvt data</span></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment"> * \param remove_flags Dictates what situations the hook should be removed.</span></div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="comment"> * \retval hook on success.</span></div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="comment"> * \retval NULL on error.</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03225"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a6a9673fffe77cabb9e79c12852baae2f"> 3225</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a6a9673fffe77cabb9e79c12852baae2f">bridge_hook_generic</a>(<span class="keywordtype">size_t</span> size,</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;{</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a> *hook;</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;   <span class="comment">/* Allocate new hook and setup it&#39;s basic variables */</span></div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;   hook = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(size, <a class="code" href="../../d0/d95/bridge_8c.html#a49108e57ad6d4b850b71f00185ffc366">bridge_hook_destroy</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;   <span class="keywordflow">if</span> (hook) {</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;      hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a> = <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>;</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a> = <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;      hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a> = <a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>;</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>, remove_flags);</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;   }</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;   <span class="keywordflow">return</span> hook;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;}</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;</div><div class="line"><a name="l03245"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a48ebc85ae4e4a203014711dc3a492ac5"> 3245</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a48ebc85ae4e4a203014711dc3a492ac5">ast_bridge_dtmf_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *dtmf,</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;{</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html">ast_bridge_hook_dtmf</a> *hook;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;   <span class="comment">/* Allocate new hook and setup it&#39;s various variables */</span></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;   hook = (<span class="keyword">struct </span><a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html">ast_bridge_hook_dtmf</a> *) <a class="code" href="../../d0/d95/bridge_8c.html#a6a9673fffe77cabb9e79c12852baae2f">bridge_hook_generic</a>(<span class="keyword">sizeof</span>(*hook), callback,</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;      hook_pvt, destructor, remove_flags);</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;   <span class="keywordflow">if</span> (!hook) {</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;   }</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;   hook-&gt;<a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#a9b8d1356a63d1d2c5892a83ea93af921">type</a> = <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ab995ce36e6e2812a16d78cd2a890b1ef">AST_BRIDGE_HOOK_TYPE_DTMF</a>;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(hook-&gt;<a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html#a09e6a40a51d2d887563667ee42a6c1f5">dtmf</a>.<a class="code" href="../../d3/d00/structast__bridge__hook__dtmf__parms.html#a112bc20acdbae84f53c59cffc6bf3a94">code</a>, dtmf, <span class="keyword">sizeof</span>(hook-&gt;<a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html#a09e6a40a51d2d887563667ee42a6c1f5">dtmf</a>.<a class="code" href="../../d3/d00/structast__bridge__hook__dtmf__parms.html#a112bc20acdbae84f53c59cffc6bf3a94">code</a>));</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;   <span class="comment">/* Once done we put it in the container. */</span></div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;   res = <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a>, hook) ? 0 : -1;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="comment">       * Could not link the hook into the container.</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;<span class="comment">       * Remove the hook_pvt destructor call from the hook since we</span></div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;<span class="comment">       * are returning failure to install the hook.</span></div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      hook-&gt;<a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;   }</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(hook, -1);</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;}</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="comment"> * \brief Attach an other hook to a bridge features structure</span></div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;<span class="comment"> * \param features Bridge features structure</span></div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="comment"> * \param callback Function to execute upon activation</span></div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;<span class="comment"> * \param hook_pvt Unique data</span></div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;<span class="comment"> * \param destructor Optional destructor callback for hook_pvt data</span></div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="comment"> * \param remove_flags Dictates what situations the hook should be removed.</span></div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<span class="comment"> * \param type What type of hook is being attached.</span></div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;<span class="comment"> * \retval -1 on failure (The caller must cleanup any hook_pvt resources.)</span></div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03294"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378"> 3294</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378">bridge_other_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> callback,</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;   <span class="keywordtype">void</span> *hook_pvt,</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> destructor,</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> remove_flags,</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3">ast_bridge_hook_type</a> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;{</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a> *hook;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;   <span class="comment">/* Allocate new hook and setup it&#39;s various variables */</span></div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;   hook = <a class="code" href="../../d0/d95/bridge_8c.html#a6a9673fffe77cabb9e79c12852baae2f">bridge_hook_generic</a>(<span class="keyword">sizeof</span>(*hook), callback, hook_pvt, destructor,</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      remove_flags);</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;   <span class="keywordflow">if</span> (!hook) {</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;   }</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;   hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a9b8d1356a63d1d2c5892a83ea93af921">type</a> = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;   <span class="comment">/* Once done we put it in the container. */</span></div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;   res = <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>, hook) ? 0 : -1;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;<span class="comment">       * Could not link the hook into the container.</span></div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="comment">       * Remove the hook_pvt destructor call from the hook since we</span></div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;<span class="comment">       * are returning failure to install the hook.</span></div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;      hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;   }</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(hook, -1);</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;}</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;</div><div class="line"><a name="l03328"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a1b26efd7ce4e09afa9402dc0a30d5e4a"> 3328</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a1b26efd7ce4e09afa9402dc0a30d5e4a">ast_bridge_hangup_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;{</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378">bridge_other_hook</a>(features, callback, hook_pvt, destructor, remove_flags,</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3aaffe52570f582bed6f59dc12ca2a5c9e">AST_BRIDGE_HOOK_TYPE_HANGUP</a>);</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;}</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;</div><div class="line"><a name="l03338"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a5ef8af740b139874195a394ba4abee3d"> 3338</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a5ef8af740b139874195a394ba4abee3d">ast_bridge_join_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;{</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378">bridge_other_hook</a>(features, callback, hook_pvt, destructor, remove_flags,</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3a560e70ed0a87b3e30f0e332cfebec8ee">AST_BRIDGE_HOOK_TYPE_JOIN</a>);</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;}</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;</div><div class="line"><a name="l03348"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aaaf5765651d9a3697813f9752660da57"> 3348</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#aaaf5765651d9a3697813f9752660da57">ast_bridge_leave_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;{</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378">bridge_other_hook</a>(features, callback, hook_pvt, destructor, remove_flags,</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ac47686eedfc6349818302b402b72461d">AST_BRIDGE_HOOK_TYPE_LEAVE</a>);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;}</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;</div><div class="line"><a name="l03358"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a47aa4de3736ec9da5831351848e6522d"> 3358</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a47aa4de3736ec9da5831351848e6522d">ast_bridge_talk_detector_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#ad5b20a96dee3042c8cb23d45f7a93f79">ast_bridge_talking_indicate_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;{</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../d8/d4f/test__config_8c.html#a8fe0bda13f4abb5bd412745f0f9891da">hook_cb</a> = (<a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a>) callback;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378">bridge_other_hook</a>(features, hook_cb, hook_pvt, destructor, remove_flags,</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ad2f7e2bea8dd898409ef3166cb60543f">AST_BRIDGE_HOOK_TYPE_TALK</a>);</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;}</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;</div><div class="line"><a name="l03370"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a475f3511ac20e3f247e3ff3bb8060237"> 3370</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a475f3511ac20e3f247e3ff3bb8060237">ast_bridge_move_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#a0394614533c00a6ac5483fbb14bae4d5">ast_bridge_move_indicate_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;{</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../d8/d4f/test__config_8c.html#a8fe0bda13f4abb5bd412745f0f9891da">hook_cb</a> = (<a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a>) callback;</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378">bridge_other_hook</a>(features, hook_cb, hook_pvt, destructor, remove_flags,</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ab1e55b40373b3dda769e106081d9dbf1">AST_BRIDGE_HOOK_TYPE_MOVE</a>);</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;}</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;</div><div class="line"><a name="l03382"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3e9bdb7b62b531f001b7dcb5c39b3551"> 3382</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3e9bdb7b62b531f001b7dcb5c39b3551">ast_bridge_interval_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#acbd260bd0e5790d9c0f08775448f7fc0">ast_bridge_hook_timer_option</a> flags,</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> interval,</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>,</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>,</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a>,</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;{</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *hook;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;   <span class="keywordflow">if</span> (!features ||!interval || !callback) {</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;   }</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;   <span class="comment">/* Allocate new hook and setup it&#39;s various variables */</span></div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;   hook = (<span class="keyword">struct </span><a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *) <a class="code" href="../../d0/d95/bridge_8c.html#a6a9673fffe77cabb9e79c12852baae2f">bridge_hook_generic</a>(<span class="keyword">sizeof</span>(*hook), callback,</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;      hook_pvt, destructor, remove_flags);</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;   <span class="keywordflow">if</span> (!hook) {</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;   }</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;   hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#a9b8d1356a63d1d2c5892a83ea93af921">type</a> = <a class="code" href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3af46f831c14459a9ca7338c3028ca84fb">AST_BRIDGE_HOOK_TYPE_TIMER</a>;</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;   hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#a23545cd41cdc93998f5b3caeb3e29936">interval</a> = interval;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;   hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#a3546d0f5f096b6f63f437c3d24b51d47">trip_time</a> = <a class="code" href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), <a class="code" href="../../de/df7/time_8h.html#a1d774df72e3dbb623475783e06ce4f61">ast_samp2tv</a>(interval, 1000));</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;   hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#aac99560397aa1e3e12367419ed305d11">seqno</a> = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>((<span class="keywordtype">int</span> *) &amp;features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a735823cab1fbe5881c54cd1493d27e80">interval_sequence</a>, +1);</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;   hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> = flags;</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Putting interval hook %p with interval %u in the heap on features %p\n&quot;</span>,</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      hook, hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#a23545cd41cdc93998f5b3caeb3e29936">interval</a>, features);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;   <a class="code" href="../../da/ddb/heap_8h.html#ae31f8aaa8d4c6caf049e3965ec8b576a">ast_heap_wrlock</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>);</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;   res = <a class="code" href="../../da/ddb/heap_8h.html#ad181f4df20e6039b37e1b8d128884a81">ast_heap_push</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>, hook);</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;   <a class="code" href="../../da/ddb/heap_8h.html#a44306afd9b32c0eedae9b559f13a2c5b">ast_heap_unlock</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>);</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;<span class="comment">       * Could not push the hook into the heap</span></div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;<span class="comment">       * Remove the hook_pvt destructor call from the hook since we</span></div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;<span class="comment">       * are returning failure to install the hook.</span></div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;      hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">destructor</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(hook, -1);</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;   }</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;   <span class="keywordflow">return</span> res ? -1 : 0;</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;}</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;</div><div class="line"><a name="l03428"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad4452a1fe505c3785b5f72f61231ad38"> 3428</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad4452a1fe505c3785b5f72f61231ad38">ast_bridge_features_enable</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a> feature,</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *dtmf,</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;   <span class="keywordtype">void</span> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>,</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a> destructor,</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> remove_flags)</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;{</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>) &lt;= feature</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      || !<a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[feature]) {</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;   }</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   <span class="comment">/* If no alternate DTMF stream was provided use the default one */</span></div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dtmf)) {</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;      dtmf = <a class="code" href="../../d0/d95/bridge_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a>[feature];</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;      <span class="comment">/* If no DTMF is still available (ie: it has been disabled) then error out now */</span></div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dtmf)) {</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Failed to enable built in feature %u on %p, no DTMF string is available for it.\n&quot;</span>,</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;            feature, features);</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;      }</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;   }</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="comment">    * The rest is basically pretty easy.  We create another hook</span></div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="comment">    * using the built in feature&#39;s DTMF callback.  Easy as pie.</span></div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a48ebc85ae4e4a203014711dc3a492ac5">ast_bridge_dtmf_hook</a>(features, dtmf, <a class="code" href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a>[feature],</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      config, destructor, remove_flags);</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;}</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;</div><div class="line"><a name="l03459"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3d37f3df31f68efc380c63b999db43f0"> 3459</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3d37f3df31f68efc380c63b999db43f0">ast_bridge_features_limits_construct</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/da5/structast__bridge__features__limits.html">ast_bridge_features_limits</a> *<a class="code" href="../../df/dfc/structlimits.html">limits</a>)</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;{</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;   memset(limits, 0, <span class="keyword">sizeof</span>(*limits));</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(limits, 256)) {</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;   }</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;}</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;</div><div class="line"><a name="l03470"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae0b1bf34dd9aa570c5efd4dddfead1fb"> 3470</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ae0b1bf34dd9aa570c5efd4dddfead1fb">ast_bridge_features_limits_destroy</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/da5/structast__bridge__features__limits.html">ast_bridge_features_limits</a> *<a class="code" href="../../df/dfc/structlimits.html">limits</a>)</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;{</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(limits);</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;}</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;</div><div class="line"><a name="l03475"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a27662864d9f07a05ef11b683c245d032"> 3475</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a27662864d9f07a05ef11b683c245d032">ast_bridge_features_set_limits</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features,</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d7/da5/structast__bridge__features__limits.html">ast_bridge_features_limits</a> *<a class="code" href="../../df/dfc/structlimits.html">limits</a>,</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> remove_flags)</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;{</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>[<a class="code" href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960da38c5af32fcc0a209b338cf6d59650351">AST_BRIDGE_BUILTIN_INTERVAL_LIMITS</a>]) {</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#acf985c9cba5e118bd24fdf980b59f955">ast_bridge_builtin_set_limits_fn</a> callback;</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      callback = <a class="code" href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a>[<a class="code" href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960da38c5af32fcc0a209b338cf6d59650351">AST_BRIDGE_BUILTIN_INTERVAL_LIMITS</a>];</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;      <span class="keywordflow">return</span> callback(features, limits, remove_flags);</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;   }</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Attempted to set limits without an AST_BRIDGE_BUILTIN_INTERVAL_LIMITS callback registered.\n&quot;</span>);</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;}</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;</div><div class="line"><a name="l03490"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a59e2d516216983fdab32cf3036a657f2"> 3490</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a59e2d516216983fdab32cf3036a657f2">ast_bridge_features_set_flag</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a>)</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;{</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>, flag);</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a080125973deec97104866dd31867e3ce">usable</a> = 1;</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;}</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="comment"> * \brief ao2 object match hooks with appropriate remove_flags.</span></div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="comment"> * \param obj Feature hook object.</span></div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="comment"> * \param arg Removal flags</span></div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment"> * \param flags Not used</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="comment"> * \retval CMP_MATCH if hook&#39;s remove_flags match the removal flags set.</span></div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="comment"> * \retval 0 if not match.</span></div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03508"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3d742b207de320082b45a7ecb7cff970"> 3508</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3d742b207de320082b45a7ecb7cff970">hook_remove_match</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;{</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a> *hook = obj;</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> *<a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a> = arg;</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>, *remove_flags)) {</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;   }</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;}</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="comment"> * \brief Remove all hooks with appropriate remove_flags in the container.</span></div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="comment"> * \param hooks Hooks container to work on.</span></div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="comment"> * \param remove_flags Determinator for whether hook is removed</span></div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03530"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aa42051dbe23078fa667eb4215d9a768f"> 3530</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aa42051dbe23078fa667eb4215d9a768f">hooks_remove_container</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *hooks, <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;{</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(hooks, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>,</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a3d742b207de320082b45a7ecb7cff970">hook_remove_match</a>, &amp;remove_flags);</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;}</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;<span class="comment"> * \brief Remove all hooks in the heap with appropriate remove_flags set.</span></div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;<span class="comment"> * \param hooks Hooks heap to work on.</span></div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;<span class="comment"> * \param remove_flags Determinator for whether hook is removed</span></div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03546"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a252b56143e4cba04ba2fe06b0ec08da7"> 3546</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a252b56143e4cba04ba2fe06b0ec08da7">hooks_remove_heap</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/dec/structast__heap.html">ast_heap</a> *hooks, <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;{</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a> *hook;</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;   <span class="keywordtype">int</span> changed;</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;   <a class="code" href="../../da/ddb/heap_8h.html#ae31f8aaa8d4c6caf049e3965ec8b576a">ast_heap_wrlock</a>(hooks);</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      changed = 0;</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      <span class="keywordflow">for</span> (idx = <a class="code" href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a>(hooks); idx; --idx) {</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;         hook = <a class="code" href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a>(hooks, idx);</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;hook-&gt;<a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>, remove_flags)) {</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            <a class="code" href="../../da/ddb/heap_8h.html#ac68d03b30bb0adc489ccd67a11873b59">ast_heap_remove</a>(hooks, hook);</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(hook, -1);</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;            changed = 1;</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;         }</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;      }</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;   } <span class="keywordflow">while</span> (changed);</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;   <a class="code" href="../../da/ddb/heap_8h.html#a44306afd9b32c0eedae9b559f13a2c5b">ast_heap_unlock</a>(hooks);</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;}</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;</div><div class="line"><a name="l03568"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a488815ff58d7ea1d8f5e7ce0ef370df5"> 3568</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a488815ff58d7ea1d8f5e7ce0ef370df5">ast_bridge_features_remove</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features, <span class="keyword">enum</span> <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a> <a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>)</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;{</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aa42051dbe23078fa667eb4215d9a768f">hooks_remove_container</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a>, remove_flags);</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aa42051dbe23078fa667eb4215d9a768f">hooks_remove_container</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>, remove_flags);</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a252b56143e4cba04ba2fe06b0ec08da7">hooks_remove_heap</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>, remove_flags);</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;}</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;</div><div class="line"><a name="l03575"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a416007d94897495f428fdc375afc11f1"> 3575</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a416007d94897495f428fdc375afc11f1">interval_hook_time_cmp</a>(<span class="keywordtype">void</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>, <span class="keywordtype">void</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>)</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;{</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *hook_a = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>;</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *hook_b = <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>;</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;   cmp = <a class="code" href="../../de/df7/time_8h.html#a6daa33e2052acd094bb63e78aba29733">ast_tvcmp</a>(hook_b-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#a3546d0f5f096b6f63f437c3d24b51d47">trip_time</a>, hook_a-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#a3546d0f5f096b6f63f437c3d24b51d47">trip_time</a>);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;   <span class="keywordflow">if</span> (cmp) {</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;   }</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;   cmp = hook_b-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#aac99560397aa1e3e12367419ed305d11">seqno</a> - hook_a-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#aac99560397aa1e3e12367419ed305d11">seqno</a>;</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;   <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;}</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="comment"> * \brief DTMF hook container sort comparison function.</span></div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;<span class="comment"> * \param obj_left pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;<span class="comment"> * \param obj_right pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;<span class="comment"> * \param flags flags from ao2_callback()</span></div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;<span class="comment"> *   OBJ_POINTER - if set, &#39;obj_right&#39;, is an object.</span></div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;<span class="comment"> *   OBJ_KEY - if set, &#39;obj_right&#39;, is a search key item that is not an object.</span></div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;<span class="comment"> *   OBJ_PARTIAL_KEY - if set, &#39;obj_right&#39;, is a partial search key item that is not an object.</span></div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;<span class="comment"> * \retval &lt;0 if obj_left &lt; obj_right</span></div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;<span class="comment"> * \retval =0 if obj_left == obj_right</span></div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;<span class="comment"> * \retval &gt;0 if obj_left &gt; obj_right</span></div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03606"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a526176b2869c5287b65204cd06b2dfa7"> 3606</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a526176b2869c5287b65204cd06b2dfa7">bridge_dtmf_hook_sort</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj_left, <span class="keyword">const</span> <span class="keywordtype">void</span> *obj_right, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;{</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html">ast_bridge_hook_dtmf</a> *hook_left = obj_left;</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html">ast_bridge_hook_dtmf</a> *hook_right = obj_right;</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *right_key = obj_right;</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; (<a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>)) {</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>:</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;      right_key = hook_right-&gt;<a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html#a09e6a40a51d2d887563667ee42a6c1f5">dtmf</a>.<a class="code" href="../../d3/d00/structast__bridge__hook__dtmf__parms.html#a112bc20acdbae84f53c59cffc6bf3a94">code</a>;</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>:</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;      cmp = strcasecmp(hook_left-&gt;<a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html#a09e6a40a51d2d887563667ee42a6c1f5">dtmf</a>.<a class="code" href="../../d3/d00/structast__bridge__hook__dtmf__parms.html#a112bc20acdbae84f53c59cffc6bf3a94">code</a>, right_key);</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>:</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;      cmp = strncasecmp(hook_left-&gt;<a class="code" href="../../dd/d92/structast__bridge__hook__dtmf.html#a09e6a40a51d2d887563667ee42a6c1f5">dtmf</a>.<a class="code" href="../../d3/d00/structast__bridge__hook__dtmf__parms.html#a112bc20acdbae84f53c59cffc6bf3a94">code</a>, right_key, strlen(right_key));</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;   }</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;   <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;}</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;<span class="comment">/*! \brief Callback for merging hook ao2_containers */</span></div><div class="line"><a name="l03629"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a7c88a2e2a58dbf7177f34ad452904bef"> 3629</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a7c88a2e2a58dbf7177f34ad452904bef">merge_container_cb</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;{</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(data, obj);</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;}</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;<span class="comment">/*! \brief Wrapper for interval hooks that calls into the wrapped hook */</span></div><div class="line"><a name="l03636"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a9e4cc8c84fedabfffce3bf9449abc0cd"> 3636</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a9e4cc8c84fedabfffce3bf9449abc0cd">interval_wrapper_cb</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;{</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *hook = obj;</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;   <span class="keywordflow">return</span> hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a>(bridge_channel, hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>);</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;}</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<span class="comment">/*! \brief Destructor for the hook wrapper */</span></div><div class="line"><a name="l03644"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af9e2817e0750b1c972bb3b35f25ac5e1"> 3644</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#af9e2817e0750b1c972bb3b35f25ac5e1">interval_wrapper_pvt_dtor</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;{</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(obj);</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;}</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;<span class="comment">/*! \brief Wrap the provided interval hook and add it to features */</span></div><div class="line"><a name="l03650"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a948b63016c1f8deb90c43f8f94f68321"> 3650</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a948b63016c1f8deb90c43f8f94f68321">wrap_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features, <span class="keyword">struct</span> <a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *hook)</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;{</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;   <span class="comment">/* Break out of the current wrapper if it exists to avoid multiple layers */</span></div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;   <span class="keywordflow">if</span> (hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">callback</a> == <a class="code" href="../../d0/d95/bridge_8c.html#a9e4cc8c84fedabfffce3bf9449abc0cd">interval_wrapper_cb</a>) {</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      hook = hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">hook_pvt</a>;</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;   }</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a3e9bdb7b62b531f001b7dcb5c39b3551">ast_bridge_interval_hook</a>(features, hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>, hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">timer</a>.<a class="code" href="../../d1/dad/structast__bridge__hook__timer__parms.html#a23545cd41cdc93998f5b3caeb3e29936">interval</a>,</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a9e4cc8c84fedabfffce3bf9449abc0cd">interval_wrapper_cb</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(hook), <a class="code" href="../../d0/d95/bridge_8c.html#af9e2817e0750b1c972bb3b35f25ac5e1">interval_wrapper_pvt_dtor</a>,</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      hook-&gt;<a class="code" href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">generic</a>.<a class="code" href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">remove_flags</a>.<a class="code" href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>);</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;}</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;</div><div class="line"><a name="l03662"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a91794e42131b7edc3119b92d789f8268"> 3662</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a91794e42131b7edc3119b92d789f8268">ast_bridge_features_merge</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *into, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *from)</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;{</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *hook;</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;   <span class="comment">/* Merge hook containers */</span></div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a>, 0, <a class="code" href="../../d0/d95/bridge_8c.html#a7c88a2e2a58dbf7177f34ad452904bef">merge_container_cb</a>, into-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a>);</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>, 0, <a class="code" href="../../d0/d95/bridge_8c.html#a7c88a2e2a58dbf7177f34ad452904bef">merge_container_cb</a>, into-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>);</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;   <span class="comment">/* Merge hook heaps */</span></div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;   <a class="code" href="../../da/ddb/heap_8h.html#ae31f8aaa8d4c6caf049e3965ec8b576a">ast_heap_wrlock</a>(from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>);</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;   <span class="keywordflow">for</span> (idx = 1; (hook = <a class="code" href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a>(from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>, idx)); idx++) {</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a948b63016c1f8deb90c43f8f94f68321">wrap_hook</a>(into, hook);</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;   }</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;   <a class="code" href="../../da/ddb/heap_8h.html#a44306afd9b32c0eedae9b559f13a2c5b">ast_heap_unlock</a>(from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>);</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;   <span class="comment">/* Merge feature flags */</span></div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;   into-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>.<a class="code" href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> |= from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>.<a class="code" href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>;</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;   into-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a080125973deec97104866dd31867e3ce">usable</a> |= from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a080125973deec97104866dd31867e3ce">usable</a>;</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;   into-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#aa09e22acd94cd548a204c100e11fd612">mute</a> |= from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#aa09e22acd94cd548a204c100e11fd612">mute</a>;</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;   into-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a9ed40fc6a252b84f86044f975cc94283">dtmf_passthrough</a> |= from-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a9ed40fc6a252b84f86044f975cc94283">dtmf_passthrough</a>;</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;}</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="comment">/* XXX ASTERISK-21271 make ast_bridge_features_init() static when make ast_bridge_join() requires features to be allocated. */</span></div><div class="line"><a name="l03687"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3128b52009fb3dd764dce90ea377fce1"> 3687</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3128b52009fb3dd764dce90ea377fce1">ast_bridge_features_init</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features)</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;{</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;   <span class="comment">/* Zero out the structure */</span></div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;   memset(features, 0, <span class="keyword">sizeof</span>(*features));</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;   <span class="comment">/* Initialize the DTMF hooks container */</span></div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>,</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520acadb2bfd83bc54a380d86d3a9b02d99c35">AO2_CONTAINER_ALLOC_OPT_DUPS_REPLACE</a>, <a class="code" href="../../d0/d95/bridge_8c.html#a526176b2869c5287b65204cd06b2dfa7">bridge_dtmf_hook_sort</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;   <span class="keywordflow">if</span> (!features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a>) {</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;   }</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;   <span class="comment">/* Initialize the miscellaneous other hooks container */</span></div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;   <span class="keywordflow">if</span> (!features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>) {</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;   }</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;   <span class="comment">/* Initialize the interval hooks heap */</span></div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a> = <a class="code" href="../../da/ddb/heap_8h.html#a42b42e04887dbc86276e590141147f63">ast_heap_create</a>(8, <a class="code" href="../../d0/d95/bridge_8c.html#a416007d94897495f428fdc375afc11f1">interval_hook_time_cmp</a>,</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;      offsetof(<span class="keyword">struct</span> <a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a>, <a class="code" href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>.heap_index));</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;   <span class="keywordflow">if</span> (!features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>) {</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;   }</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a9ed40fc6a252b84f86044f975cc94283">dtmf_passthrough</a> = 1;</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#ad1ee5fa0669878cce5cf86ca3d3dd921">text_messaging</a> = 1;</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;}</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="comment">/* XXX ASTERISK-21271 make ast_bridge_features_cleanup() static when make ast_bridge_join() requires features to be allocated. */</span></div><div class="line"><a name="l03720"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aafc3026d777c0bf6899e93263178e102"> 3720</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features)</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;{</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a> *hook;</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;   <span class="comment">/* Destroy the interval hooks heap. */</span></div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;   <span class="keywordflow">if</span> (features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>) {</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;      <span class="keywordflow">while</span> ((hook = <a class="code" href="../../da/ddb/heap_8h.html#ad56625488a481df852f0b13d58b15a93">ast_heap_pop</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>))) {</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(hook, -1);</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;      }</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;      features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a> = <a class="code" href="../../da/ddb/heap_8h.html#a66d0a4a9d9e08e704abc44c856407bb8">ast_heap_destroy</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">interval_hooks</a>);</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;   }</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;   <span class="comment">/* Destroy the miscellaneous other hooks container. */</span></div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a>);</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">other_hooks</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;   <span class="comment">/* Destroy the DTMF hooks container. */</span></div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a>);</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;   features-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">dtmf_hooks</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;}</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;</div><div class="line"><a name="l03741"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f"> 3741</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features)</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;{</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;   <span class="keywordflow">if</span> (!features) {</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;   }</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(features);</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(features);</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;}</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div><div class="line"><a name="l03750"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#abf9e5d393615c63d27e0bd530301a1ed"> 3750</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *<a class="code" href="../../d0/d95/bridge_8c.html#abf9e5d393615c63d27e0bd530301a1ed">ast_bridge_features_new</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;{</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> *features;</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;   features = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(<span class="keyword">sizeof</span>(*features));</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;   <span class="keywordflow">if</span> (features) {</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a3128b52009fb3dd764dce90ea377fce1">ast_bridge_features_init</a>(features)) {</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a>(features);</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;         features = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;      }</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;   }</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;   <span class="keywordflow">return</span> features;</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;}</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;</div><div class="line"><a name="l03765"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a8a14f1c30f04c6d50dac556cf53e1201"> 3765</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a8a14f1c30f04c6d50dac556cf53e1201">ast_bridge_set_mixing_interval</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mixing_interval)</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;{</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae2a50ae58a79af5e12287b40bf903209">internal_mixing_interval</a> = mixing_interval;</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;}</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;</div><div class="line"><a name="l03772"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a214c6742929d7db707c94d9856908e61"> 3772</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a214c6742929d7db707c94d9856908e61">ast_bridge_set_binaural_active</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> binaural_active)</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;{</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#acc14dd5766fd17581ff869aaae42988c">binaural_active</a> = binaural_active;</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;}</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;</div><div class="line"><a name="l03779"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#af3e15bc4236a2a074953cfb1c4530cf5"> 3779</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#af3e15bc4236a2a074953cfb1c4530cf5">ast_bridge_set_internal_sample_rate</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sample_rate)</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;{</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ac4a5819e66f436d283aa19d986f04e52">internal_sample_rate</a> = sample_rate;</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;}</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;</div><div class="line"><a name="l03786"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3d4866f7184c581cd87f93ee0f2fca63"> 3786</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3d4866f7184c581cd87f93ee0f2fca63">ast_bridge_set_maximum_sample_rate</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sample_rate)</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;{</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#a20440d4454d1d575acbba1e14c39cb28">maximum_sample_rate</a> = sample_rate;</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;}</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;</div><div class="line"><a name="l03793"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1"> 3793</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1">cleanup_video_mode</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;{</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;   <span class="keywordflow">switch</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a>) {</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a51708384777e8722fae674ea8db89f54">AST_BRIDGE_VIDEO_MODE_NONE</a>:</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c">AST_BRIDGE_VIDEO_MODE_SINGLE_SRC</a>:</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>) {</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>);</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;      }</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0">AST_BRIDGE_VIDEO_MODE_TALKER_SRC</a>:</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>) {</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>);</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;      }</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>) {</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>);</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;      }</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>:</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;   }</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;   memset(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>, 0, <span class="keyword">sizeof</span>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>));</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;}</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;</div><div class="line"><a name="l03816"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a8995453900a91100f3cd936594f41435"> 3816</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a8995453900a91100f3cd936594f41435">ast_bridge_set_single_src_video_mode</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *video_src_chan)</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;{</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1">cleanup_video_mode</a>(bridge);</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a> = <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c">AST_BRIDGE_VIDEO_MODE_SINGLE_SRC</a>;</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;   <span class="keywordflow">if</span> (video_src_chan) {</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(video_src_chan);</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(5, <span class="stringliteral">&quot;Video source in bridge &#39;%s&#39; (%s) is now &#39;%s&#39; (%s)\n&quot;</span>,</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(video_src_chan),</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(video_src_chan));</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(video_src_chan, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>);</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;   }</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;   <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#aa8bd54e09b0c348a3232053e4be9bcfb">ast_bridge_publish_state</a>(bridge);</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;}</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;</div><div class="line"><a name="l03833"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a0a2e9bb75a3d3276cd8153e1f4a4a389"> 3833</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a0a2e9bb75a3d3276cd8153e1f4a4a389">ast_bridge_set_talker_src_video_mode</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;{</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1">cleanup_video_mode</a>(bridge);</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a> = <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0">AST_BRIDGE_VIDEO_MODE_TALKER_SRC</a>;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;}</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;</div><div class="line"><a name="l03841"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a34a177a8cf79f8158638ebf6ae05ac1c"> 3841</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a34a177a8cf79f8158638ebf6ae05ac1c">ast_bridge_set_sfu_video_mode</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;{</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1">cleanup_video_mode</a>(bridge);</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a> = <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>;</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;}</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;</div><div class="line"><a name="l03849"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a46b990e3c3b853c3f9d19f2924dff5d1"> 3849</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a46b990e3c3b853c3f9d19f2924dff5d1">ast_bridge_set_video_update_discard</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> video_update_discard)</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;{</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a827ffb5b7363100b4470c4cd5ec2332e">video_update_discard</a> = video_update_discard;</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;}</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;</div><div class="line"><a name="l03856"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ae7f6701ef6b78dea4da4723994d9c211"> 3856</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#ae7f6701ef6b78dea4da4723994d9c211">ast_bridge_set_remb_send_interval</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> remb_send_interval)</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;{</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a> == <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>);</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ad5d1cfaccf73f40dd103903868504a7b">sfu_data</a>.<a class="code" href="../../dd/df9/structast__bridge__video__sfu__data.html#a0a1c43a89347238ad53bdaa7f733a014">remb_send_interval</a> = remb_send_interval;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;}</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;</div><div class="line"><a name="l03865"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a5bff6bf264928e1fff47eb6968192228"> 3865</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a5bff6bf264928e1fff47eb6968192228">ast_brige_set_remb_behavior</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#a22e0b20cf0d941c2acc0710600c1c35b">ast_bridge_video_sfu_remb_behavior</a> behavior)</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;{</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a> == <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>);</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ad5d1cfaccf73f40dd103903868504a7b">sfu_data</a>.<a class="code" href="../../dd/df9/structast__bridge__video__sfu__data.html#a8f1dcf51cf06db1ac8e0ad3db16b3d39">remb_behavior</a> = behavior;</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;}</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;</div><div class="line"><a name="l03874"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a02bd31522656ae0e86ec0d4cfdace1b1"> 3874</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a02bd31522656ae0e86ec0d4cfdace1b1">ast_bridge_set_remb_estimated_bitrate</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">float</span> estimated_bitrate)</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;{</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a> == <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>);</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ad5d1cfaccf73f40dd103903868504a7b">sfu_data</a>.<a class="code" href="../../dd/df9/structast__bridge__video__sfu__data.html#a18f4bab7feee48c373dfcbea33a99e8d">estimated_bitrate</a> = estimated_bitrate;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;}</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;</div><div class="line"><a name="l03883"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#abaed4a38f4a13567c5f18b7c4e2871c7"> 3883</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#abaed4a38f4a13567c5f18b7c4e2871c7">ast_bridge_update_talker_src_video_mode</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keywordtype">int</span> talker_energy, <span class="keywordtype">int</span> is_keyframe)</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;{</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html">ast_bridge_video_talker_src_data</a> *data;</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;   <span class="comment">/* If the channel doesn&#39;t support video, we don&#39;t care about it */</span></div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d3c/format__cap_8h.html#a9b2d6490b222d436f5f6a8296d36c13f">ast_format_cap_has_type</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(chan), <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>)) {</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;   }</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;   data = &amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>;</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;   <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> == chan) {</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;      data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#ac10f96d9ddb17a9038083d909b2c7299">average_talking_energy</a> = talker_energy;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#ac10f96d9ddb17a9038083d909b2c7299">average_talking_energy</a> &lt; talker_energy) &amp;&amp; is_keyframe) {</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>) {</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;         data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a> = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>);</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      }</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      <span class="keywordflow">if</span> (data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>) {</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;         data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a> = data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>);</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;      }</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;      data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(chan);</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;      data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#ac10f96d9ddb17a9038083d909b2c7299">average_talking_energy</a> = talker_energy;</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(5, <span class="stringliteral">&quot;Video source in bridge &#39;%s&#39; (%s) is now &#39;%s&#39; (%s)\n&quot;</span>,</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>),</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>));</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#aa8bd54e09b0c348a3232053e4be9bcfb">ast_bridge_publish_state</a>(bridge);</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>);</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#ac10f96d9ddb17a9038083d909b2c7299">average_talking_energy</a> &lt; talker_energy) &amp;&amp; !is_keyframe) {</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(chan, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>);</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> &amp;&amp; is_keyframe) {</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(chan);</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;      data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#ac10f96d9ddb17a9038083d909b2c7299">average_talking_energy</a> = talker_energy;</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(5, <span class="stringliteral">&quot;Video source in bridge &#39;%s&#39; (%s) is now &#39;%s&#39; (%s)\n&quot;</span>,</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>),</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>));</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#aa8bd54e09b0c348a3232053e4be9bcfb">ast_bridge_publish_state</a>(bridge);</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(chan, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>);</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a> &amp;&amp; is_keyframe) {</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      data-&gt;<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(chan);</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(chan, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>);</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;   }</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;}</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;</div><div class="line"><a name="l03931"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a283cf43498dde27adebbc85679b2f2d5"> 3931</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a283cf43498dde27adebbc85679b2f2d5">ast_bridge_number_video_src</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;{</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;   <span class="keywordflow">switch</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a>) {</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a51708384777e8722fae674ea8db89f54">AST_BRIDGE_VIDEO_MODE_NONE</a>:</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c">AST_BRIDGE_VIDEO_MODE_SINGLE_SRC</a>:</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>) {</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;         res = 1;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      }</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0">AST_BRIDGE_VIDEO_MODE_TALKER_SRC</a>:</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>) {</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;         res++;</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      }</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>) {</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;         res++;</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;      }</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>:</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;   }</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;}</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;</div><div class="line"><a name="l03958"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#adb755c02424a98c8ec3bd636c609e120"> 3958</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#adb755c02424a98c8ec3bd636c609e120">ast_bridge_is_video_src</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;{</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;   <span class="keywordflow">switch</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a>) {</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a51708384777e8722fae674ea8db89f54">AST_BRIDGE_VIDEO_MODE_NONE</a>:</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c">AST_BRIDGE_VIDEO_MODE_SINGLE_SRC</a>:</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> == chan) {</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;         res = 1;</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;      }</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0">AST_BRIDGE_VIDEO_MODE_TALKER_SRC</a>:</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> == chan) {</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;         res = 1;</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a> == chan) {</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;         res = 2;</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      }</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>:</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;   }</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;}</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;</div><div class="line"><a name="l03984"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a98000e740561c2e40e39f9edd191c38a"> 3984</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a98000e740561c2e40e39f9edd191c38a">ast_bridge_remove_video_src</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;{</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;   <span class="keywordflow">switch</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">mode</a>) {</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a51708384777e8722fae674ea8db89f54">AST_BRIDGE_VIDEO_MODE_NONE</a>:</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c">AST_BRIDGE_VIDEO_MODE_SINGLE_SRC</a>:</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> == chan) {</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;         <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>) {</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>);</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;         }</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">single_src_data</a>.<a class="code" href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;      }</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0">AST_BRIDGE_VIDEO_MODE_TALKER_SRC</a>:</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> == chan) {</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;         <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>) {</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a>);</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;         }</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">chan_vsrc</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#ac10f96d9ddb17a9038083d909b2c7299">average_talking_energy</a> = 0;</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      }</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;      <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a> == chan) {</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;         <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>) {</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a>);</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;         }</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;         bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">video_mode</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">mode_data</a>.<a class="code" href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">talker_src_data</a>.<a class="code" href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">chan_old_vsrc</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;      }</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>:</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;   }</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;}</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;</div><div class="line"><a name="l04018"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a2a2b1e82e019faba42fa278f7a69a699"> 4018</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a2a2b1e82e019faba42fa278f7a69a699">ast_bridge_video_mode_to_string</a>(<span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906">ast_bridge_video_mode_type</a> video_mode)</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;{</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;   <span class="keywordflow">switch</span> (video_mode) {</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0">AST_BRIDGE_VIDEO_MODE_TALKER_SRC</a>:</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;talker&quot;</span>;</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c">AST_BRIDGE_VIDEO_MODE_SINGLE_SRC</a>:</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;single&quot;</span>;</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a>:</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;sfu&quot;</span>;</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a51708384777e8722fae674ea8db89f54">AST_BRIDGE_VIDEO_MODE_NONE</a>:</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;none&quot;</span>;</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;   }</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;}</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;</div><div class="line"><a name="l04033"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aaba0073c46b7c4e52f55a0f34036f43b"> 4033</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#aaba0073c46b7c4e52f55a0f34036f43b">ast_bridge_set_send_sdp_label</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> send_sdp_label)</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;{</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;   bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">softmix</a>.<a class="code" href="../../d0/d50/structast__bridge__softmix.html#a19c26f21e5b3f0f20ef838fd43db8ea9">send_sdp_label</a> = send_sdp_label;</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;}</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;</div><div class="line"><a name="l04040"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a19de8a45531b37cdac0805b0ce4354f8"> 4040</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a19de8a45531b37cdac0805b0ce4354f8">channel_hash</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;{</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = obj;</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = obj;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;   <span class="keywordtype">int</span> hash;</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; (<a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>)) {</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>:</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;      name = <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan);</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>:</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;      hash = <a class="code" href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a>(name);</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>:</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;      <span class="comment">/* Should never happen in hash callback. */</span></div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;      hash = 0;</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;   }</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;   <span class="keywordflow">return</span> hash;</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;}</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;</div><div class="line"><a name="l04063"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a49f20b53f75f33385a7254676faa0581"> 4063</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a49f20b53f75f33385a7254676faa0581">channel_cmp</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;{</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *left = obj;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *right = arg;</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *right_name = arg;</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; (<a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>)) {</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>:</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;      right_name = <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(right);</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>:</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;      cmp = strcmp(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(left), right_name);</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>:</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      cmp = strncmp(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(left), right_name, strlen(right_name));</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;   }</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;   <span class="keywordflow">return</span> cmp ? 0 : <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;}</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;</div><div class="line"><a name="l04085"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad45098162b2df09235f632efb08a9681"> 4085</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d95/bridge_8c.html#ad45098162b2df09235f632efb08a9681">ast_bridge_peers_nolock</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;{</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>;</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *iter;</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;   channels = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0,</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;      13, <a class="code" href="../../d0/d95/bridge_8c.html#a19de8a45531b37cdac0805b0ce4354f8">channel_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d0/d95/bridge_8c.html#a49f20b53f75f33385a7254676faa0581">channel_cmp</a>);</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;   <span class="keywordflow">if</span> (!channels) {</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;   }</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, iter, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(channels, iter-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;   }</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>;</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;}</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;</div><div class="line"><a name="l04103"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad953e3f044237ed0337e4e46479fbd4f"> 4103</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d95/bridge_8c.html#ad953e3f044237ed0337e4e46479fbd4f">ast_bridge_peers</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;{</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>;</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;   channels = <a class="code" href="../../d0/d95/bridge_8c.html#ad45098162b2df09235f632efb08a9681">ast_bridge_peers_nolock</a>(bridge);</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>;</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;}</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div><div class="line"><a name="l04114"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a446fdf2b4bc50dd4cf7325c6b01c075c"> 4114</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a446fdf2b4bc50dd4cf7325c6b01c075c">ast_bridge_peer_nolock</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;{</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *iter;</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;   <span class="comment">/* Asking for the peer channel only makes sense on a two-party bridge. */</span></div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a> == 2</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;      &amp;&amp; bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">technology</a>-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a></div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;         &amp; (<a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaec2d0fff3f4f8df0d9ef6b4d9be78380">AST_BRIDGE_CAPABILITY_NATIVE</a> | <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaf483c951b835fcc35da807b6a4b12509">AST_BRIDGE_CAPABILITY_1TO1MIX</a>)) {</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html#afacf05ff49bf5cd3c7170b3c51943d2e">in_bridge</a> = 0;</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, iter, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;         <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> != chan) {</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;            peer = iter-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;            in_bridge = 1;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;         }</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      }</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      <span class="keywordflow">if</span> (in_bridge &amp;&amp; peer) {</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(peer);</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;         peer = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      }</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;   }</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;   <span class="keywordflow">return</span> peer;</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;}</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;</div><div class="line"><a name="l04142"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a08a41371fb4f020d645a0e6f50434005"> 4142</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a08a41371fb4f020d645a0e6f50434005">ast_bridge_peer</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;{</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer;</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;   peer = <a class="code" href="../../d0/d95/bridge_8c.html#a446fdf2b4bc50dd4cf7325c6b01c075c">ast_bridge_peer_nolock</a>(bridge, chan);</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;   <span class="keywordflow">return</span> peer;</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;}</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;<span class="comment"> * \brief Transfer an entire bridge to a specific destination.</span></div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="comment"> * This creates a local channel to dial out and swaps the called local channel</span></div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="comment"> * with the transferer channel. By doing so, all participants in the bridge are</span></div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="comment"> * connected to the specified destination.</span></div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;<span class="comment"> * While this means of transferring would work for both two-party and multi-party</span></div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;<span class="comment"> * bridges, this method is only used for multi-party bridges since this method would</span></div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="comment"> * be less efficient for two-party bridges.</span></div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="comment"> * \param is_external Whether the transfer is externally initiated</span></div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<span class="comment"> * \param transferer The channel performing a transfer</span></div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="comment"> * \param bridge The bridge where the transfer is being performed</span></div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="comment"> * \param exten The destination extension for the blind transfer</span></div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="comment"> * \param context The destination context for the blind transfer</span></div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="comment"> * \param transferee The party being transferred if there is only one</span></div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;<span class="comment"> * \param new_channel_cb Callback to call on channel that is created to</span></div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="comment"> *        facilitate the blind transfer.</span></div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="comment"> * \param user_data_wrapper User-provided data needed in new_channel_cb</span></div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="comment"> * \param transfer_message The Stasis publication for this transfer.</span></div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;<span class="comment"> * \return The success or failure of the operation</span></div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04178"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab4a549751233836460cee187d4daea03"> 4178</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> <a class="code" href="../../d0/d95/bridge_8c.html#ab4a549751233836460cee187d4daea03">blind_transfer_bridge</a>(<span class="keywordtype">int</span> is_external,</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *transferer, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>,</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *transferee,</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a87ed18cc739a9635c4595cae783ab993">transfer_channel_cb</a> new_channel_cb,</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../da/d84/structtransfer__channel__data.html">transfer_channel_data</a> *user_data_wrapper,</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d1/dbf/structast__blind__transfer__message.html">ast_blind_transfer_message</a> *transfer_message)</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;{</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *local;</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;   <span class="keywordtype">char</span> chan_name[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a> + <a class="code" href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a> + 2];</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;   <span class="keywordtype">int</span> cause;</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;   snprintf(chan_name, <span class="keyword">sizeof</span>(chan_name), <span class="stringliteral">&quot;%s@%s&quot;</span>, exten, context);</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;   local = <a class="code" href="../../d5/d7b/channel_8h.html#a39fc055500e09810d0afd0bff87407c5">ast_request</a>(<span class="stringliteral">&quot;Local&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(transferer), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, transferer,</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;         chan_name, &amp;cause);</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;   <span class="keywordflow">if</span> (!local) {</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;   }</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a>(local, transferer);</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a6f3f42365ac84d888b55e35e1309f067">ast_channel_req_accountcodes</a>(local, transferer, <a class="code" href="../../d5/d7b/channel_8h.html#a31a465197a7766c3d0bb9f65f0a4418fac3861dd1a26771778606b7aacdfb4048">AST_CHANNEL_REQUESTOR_REPLACEMENT</a>);</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;   transfer_message-&gt;<a class="code" href="../../d1/dbf/structast__blind__transfer__message.html#a69d67589993bc38c485c20b84ce40034">replace_channel</a> = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(local));</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;   <span class="keywordflow">if</span> (!transfer_message-&gt;<a class="code" href="../../d1/dbf/structast__blind__transfer__message.html#a69d67589993bc38c485c20b84ce40034">replace_channel</a>) {</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(local);</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;   }</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(local, <a class="code" href="../../d0/d95/bridge_8c.html#a46076d7116497bc6fd9c69b57d15d18c">BLINDTRANSFER</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(transferer));</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(local);</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(transferer);</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;   <span class="keywordflow">if</span> (new_channel_cb) {</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;      new_channel_cb(local, user_data_wrapper, <a class="code" href="../../d4/d56/bridge_8h.html#a865f7ef0f91885406ab746b23eb598cdaa85cad6eafcb0edc223c975e0cf3b296">AST_BRIDGE_TRANSFER_MULTI_PARTY</a>);</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;   }</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a1b732eb4ed203140b1a3aae9e7dec2c1">ast_call</a>(local, chan_name, 0)) {</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(local);</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;   }</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a4a1f0ebb4769ef2340211b0d05a1077a">ast_bridge_impart</a>(bridge, local, transferer, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101aecfd8e6279a21b20ee4db0ab69c847e8">AST_BRIDGE_IMPART_CHAN_INDEPENDENT</a>)) {</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(local);</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;   }</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;}</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;<span class="comment"> * \brief Get the transferee channel</span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;<span class="comment"> * This is only applicable to cases where a transfer is occurring on a</span></div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;<span class="comment"> * two-party bridge. The channels container passed in is expected to only</span></div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;<span class="comment"> * contain two channels, the transferer and the transferee. The transferer</span></div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;<span class="comment"> * channel is passed in as a parameter to ensure we don&#39;t return it as</span></div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;<span class="comment"> * the transferee channel.</span></div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;<span class="comment"> * \param channels A two-channel container containing the transferer and transferee</span></div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;<span class="comment"> * \param transferer The party that is transfering the call</span></div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;<span class="comment"> * \return The party that is being transferred</span></div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04241"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ad06dce4a79c1071d41110753c9f7468b"> 4241</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d0/d95/bridge_8c.html#ad06dce4a79c1071d41110753c9f7468b">get_transferee</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *transferer)</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;{</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> channel_iter;</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *transferee;</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;   <span class="keywordflow">for</span> (channel_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(channels, 0);</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;         (transferee = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;channel_iter));</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(transferee)) {</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;      <span class="keywordflow">if</span> (transferee != transferer) {</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;      }</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;   }</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;channel_iter);</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;   <span class="keywordflow">return</span> transferee;</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;}</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;<span class="comment"> * \brief Perform an attended transfer of a bridge</span></div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;<span class="comment"> * This performs an attended transfer of an entire bridge to a target.</span></div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;<span class="comment"> * The target varies, depending on what bridges exist during the transfer</span></div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;<span class="comment"> * attempt.</span></div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;<span class="comment"> * If two bridges exist, then a local channel is created to link the two</span></div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;<span class="comment"> * bridges together.</span></div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;<span class="comment"> * If only one bridge exists, then a local channel is created with one end</span></div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;<span class="comment"> * placed into the existing bridge and the other end masquerading into</span></div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;<span class="comment"> * the unbridged channel.</span></div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;<span class="comment"> * \param chan1 Transferer channel. Guaranteed to be bridged.</span></div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;<span class="comment"> * \param chan2 Other transferer channel. May or may not be bridged.</span></div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;<span class="comment"> * \param bridge1 Bridge that chan1 is in. Guaranteed to be non-NULL.</span></div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="comment"> * \param bridge2 Bridge that chan2 is in. If NULL, then chan2 is not bridged.</span></div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;<span class="comment"> * \param publication Data to publish for a stasis attended transfer message.</span></div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;<span class="comment"> * \retval AST_BRIDGE_TRANSFER_FAIL Internal error occurred</span></div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;<span class="comment"> * \retval AST_BRIDGE_TRANSFER_SUCCESS Succesfully transferred the bridge</span></div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04280"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a4e027120313f06bfe8aebc31e5ae5cae"> 4280</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> <a class="code" href="../../d0/d95/bridge_8c.html#a4e027120313f06bfe8aebc31e5ae5cae">attended_transfer_bridge</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan1,</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan2, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge1, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge2,</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d6d/structast__attended__transfer__message.html">ast_attended_transfer_message</a> *transfer_msg)</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;{</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;<span class="preprocessor">#define BRIDGE_LOCK_ONE_OR_BOTH(b1, b2) \</span></div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="preprocessor">   do { \</span></div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="preprocessor">      if (b2) { \</span></div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;<span class="preprocessor">         ast_bridge_lock_both(b1, b2); \</span></div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;<span class="preprocessor">      } else { \</span></div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;<span class="preprocessor">         ast_bridge_lock(b1); \</span></div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;<span class="preprocessor">      } \</span></div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<span class="preprocessor">   } while (0)</span></div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *dest = <span class="stringliteral">&quot;_attended@transfer/m&quot;</span>;</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *local_chan;</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;   <span class="keywordtype">int</span> cause;</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;   local_chan = <a class="code" href="../../d5/d7b/channel_8h.html#a39fc055500e09810d0afd0bff87407c5">ast_request</a>(<span class="stringliteral">&quot;Local&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(chan1), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, chan1,</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;         dest, &amp;cause);</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;   <span class="keywordflow">if</span> (!local_chan) {</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;   }</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a>(local_chan, chan1);</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a6f3f42365ac84d888b55e35e1309f067">ast_channel_req_accountcodes</a>(local_chan, chan1, <a class="code" href="../../d5/d7b/channel_8h.html#a31a465197a7766c3d0bb9f65f0a4418fac3861dd1a26771778606b7aacdfb4048">AST_CHANNEL_REQUESTOR_REPLACEMENT</a>);</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(local_chan, <a class="code" href="../../d0/d95/bridge_8c.html#acace2c216334d2be31f0323bfc4af2ab">ATTENDEDTRANSFER</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan1));</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(local_chan);</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan1);</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;   <span class="keywordflow">if</span> (bridge2) {</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;      res = <a class="code" href="../../d5/da6/core__local_8h.html#a36ca4008cc93eb1ee59194e732ee6b8a">ast_local_setup_bridge</a>(local_chan, bridge2, chan2, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      app = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac8b850ff95f945ad6cfeb2942799800a">ast_channel_appl</a>(chan2));</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;      res = <a class="code" href="../../d5/da6/core__local_8h.html#ac2e6544ffc24e3c97e1b028c1d5a4957">ast_local_setup_masquerade</a>(local_chan, chan2);</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;   }</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(local_chan);</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;   }</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;<span class="comment">    * Since bridges need to be unlocked before entering ast_bridge_impart and</span></div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;<span class="comment">    * core_local may call into it then the bridges need to be unlocked here.</span></div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge1);</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;   <span class="keywordflow">if</span> (bridge2) {</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge2);</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;   }</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a1b732eb4ed203140b1a3aae9e7dec2c1">ast_call</a>(local_chan, dest, 0)) {</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(local_chan);</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#aa89a2daf4c905161701f1cf65fe3db40">BRIDGE_LOCK_ONE_OR_BOTH</a>(bridge1, bridge2);</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;   }</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;   <span class="comment">/* Get a ref for use later since this one is being stolen */</span></div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(local_chan, +1);</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#a4a1f0ebb4769ef2340211b0d05a1077a">ast_bridge_impart</a>(bridge1, local_chan, chan1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101aecfd8e6279a21b20ee4db0ab69c847e8">AST_BRIDGE_IMPART_CHAN_INDEPENDENT</a>)) {</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(local_chan);</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(local_chan);</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#aa89a2daf4c905161701f1cf65fe3db40">BRIDGE_LOCK_ONE_OR_BOTH</a>(bridge1, bridge2);</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;   }</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#aa89a2daf4c905161701f1cf65fe3db40">BRIDGE_LOCK_ONE_OR_BOTH</a>(bridge1, bridge2);</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;   <span class="keywordflow">if</span> (bridge2) {</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;      <span class="keywordtype">void</span> *<a class="code" href="../../df/d3c/structast__channel.html#aa8f6a3233b196d1a6b727edc83063a63">tech</a>;</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../de/d47/core__local_8c.html#aef9f33a8f0b0099c02a84d0c01d77aab">locals</a>[2];</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      <span class="comment">/* Have to lock everything just in case a hangup comes in early */</span></div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <a class="code" href="../../d5/da6/core__local_8h.html#a973a646143d042b91ec6248ea6ba00f1">ast_local_lock_all</a>(local_chan, &amp;tech, &amp;locals[0], &amp;locals[1]);</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;      <span class="keywordflow">if</span> (!locals[0] || !locals[1]) {</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Transfer failed probably due to an early hangup - &quot;</span></div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;            <span class="stringliteral">&quot;missing other half of &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(local_chan));</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;         <a class="code" href="../../d5/da6/core__local_8h.html#a2ed2a62610af1f7e8c25b89001e35963">ast_local_unlock_all</a>(tech, locals[0], locals[1]);</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(local_chan);</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      }</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;      <span class="comment">/* Make sure the peer is properly set */</span></div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;      <span class="keywordflow">if</span> (local_chan != locals[0]) {</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a>(locals[0], locals[1]);</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;      }</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#abec87c9a1f3c9607a841cdf035ae95fd">ast_attended_transfer_message_add_link</a>(transfer_msg, locals);</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      <a class="code" href="../../d5/da6/core__local_8h.html#a2ed2a62610af1f7e8c25b89001e35963">ast_local_unlock_all</a>(tech, locals[0], locals[1]);</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a3ba70be1910dd4bebfc77dec29ffc43b">ast_attended_transfer_message_add_app</a>(transfer_msg, app, local_chan);</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;   }</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(local_chan);</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;}</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;</div><div class="line"><a name="l04378"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aa9becfea3a1b74d72ec6a21f478b99bd"> 4378</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> <a class="code" href="../../d0/d95/bridge_8c.html#aa9becfea3a1b74d72ec6a21f478b99bd">try_parking</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *transferer,</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>, <a class="code" href="../../d4/d56/bridge_8h.html#a87ed18cc739a9635c4595cae783ab993">transfer_channel_cb</a> new_channel_cb,</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../da/d84/structtransfer__channel__data.html">transfer_channel_data</a> *user_data_wrapper)</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;{</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *, transferer_bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d33/parking_8h.html#ae6064ecb9b802ce85e93ddfa7719c433">ast_parking_provider_registered</a>()) {</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;   }</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(transferer);</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;   transferer_bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(transferer);</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(transferer);</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;   <span class="keywordflow">if</span> (!transferer_bridge_channel) {</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;   }</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d2/d33/parking_8h.html#a0ede734145efa668143b11b31b49c6b0">ast_parking_blind_transfer_park</a>(transferer_bridge_channel,</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;      context, exten, new_channel_cb, user_data_wrapper)) {</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;   }</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;}</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;</div><div class="line"><a name="l04404"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a010196e87eb58beb0bb5a0e531c2f1e2"> 4404</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a010196e87eb58beb0bb5a0e531c2f1e2">ast_bridge_set_transfer_variables</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, <span class="keywordtype">int</span> attended)</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;{</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;   <span class="keywordtype">char</span> *writevar;</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;   <span class="keywordtype">char</span> *erasevar;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;   <span class="keywordflow">if</span> (attended) {</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      writevar = <a class="code" href="../../d0/d95/bridge_8c.html#acace2c216334d2be31f0323bfc4af2ab">ATTENDEDTRANSFER</a>;</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;      erasevar = <a class="code" href="../../d0/d95/bridge_8c.html#a46076d7116497bc6fd9c69b57d15d18c">BLINDTRANSFER</a>;</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;      writevar = <a class="code" href="../../d0/d95/bridge_8c.html#a46076d7116497bc6fd9c69b57d15d18c">BLINDTRANSFER</a>;</div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;      erasevar = <a class="code" href="../../d0/d95/bridge_8c.html#acace2c216334d2be31f0323bfc4af2ab">ATTENDEDTRANSFER</a>;</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;   }</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, writevar, value);</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, erasevar, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;}</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;<span class="comment"> * \brief Set the transfer variable as appropriate on channels involved in the transfer</span></div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;<span class="comment"> * The transferer channel will have its variable set the same as its BRIDGEPEER</span></div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;<span class="comment"> * variable. This will account for all channels that it is bridged to. The other channels</span></div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;<span class="comment"> * involved in the transfer will have their variable set to the transferer</span></div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;<span class="comment"> * channel&#39;s name.</span></div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;<span class="comment"> * \param transferer The channel performing the transfer</span></div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;<span class="comment"> * \param channels The channels belonging to the bridge</span></div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;<span class="comment"> * \param is_attended false  set BLINDTRANSFER and unset ATTENDEDTRANSFER</span></div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;<span class="comment"> *                    true   set ATTENDEDTRANSFER and unset BLINDTRANSFER</span></div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04435"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a8e6a9f8aa899159ff355b1cc05d0a35b"> 4435</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a8e6a9f8aa899159ff355b1cc05d0a35b">set_transfer_variables_all</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *transferer, <span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, <span class="keywordtype">int</span> is_attended)</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;{</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter;</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan;</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *transferer_name;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *transferer_bridgepeer;</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(transferer);</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;   transferer_name = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(transferer));</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;   transferer_bridgepeer = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(transferer, <span class="stringliteral">&quot;BRIDGEPEER&quot;</span>), <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(transferer);</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;   <span class="keywordflow">for</span> (iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(channels, 0);</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;         (chan = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter));</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(chan)) {</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;      <span class="keywordflow">if</span> (chan == transferer) {</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#a010196e87eb58beb0bb5a0e531c2f1e2">ast_bridge_set_transfer_variables</a>(chan, transferer_bridgepeer, is_attended);</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;         <a class="code" href="../../d0/d95/bridge_8c.html#a010196e87eb58beb0bb5a0e531c2f1e2">ast_bridge_set_transfer_variables</a>(chan, transferer_name, is_attended);</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;      }</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;   }</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter);</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;}</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;</div><div class="line"><a name="l04460"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#acf7de35a81822873b105c08e1c22826f"> 4460</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#acf7de35a81822873b105c08e1c22826f">ast_bridge_transfer_acquire_bridge</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;{</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;   bridge = <a class="code" href="../../d5/d7b/channel_8h.html#a557663006d52a9cdc11f42602bf48326">ast_channel_get_bridge</a>(chan);</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;   <span class="keywordflow">if</span> (bridge &amp;&amp; <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;         (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d">AST_BRIDGE_FLAG_MASQUERADE_ONLY</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444af791f0352f324b81c3eb1adcedc31364">AST_BRIDGE_FLAG_INVISIBLE</a>))) {</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, -1);</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;      bridge = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;   }</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;}</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;</div><div class="line"><a name="l04477"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a982e0e652b9f03abf1ec584c137791a3"> 4477</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> <a class="code" href="../../d0/d95/bridge_8c.html#a982e0e652b9f03abf1ec584c137791a3">ast_bridge_transfer_blind</a>(<span class="keywordtype">int</span> is_external,</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *transferer, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>,</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a87ed18cc739a9635c4595cae783ab993">transfer_channel_cb</a> new_channel_cb, <span class="keywordtype">void</span> *user_data)</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;{</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *, <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *, bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *, <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, transferee, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a>);</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../da/d84/structtransfer__channel__data.html">transfer_channel_data</a> *, user_data_wrapper, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/dbf/structast__blind__transfer__message.html">ast_blind_transfer_message</a> *, transfer_message, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;   <span class="keywordtype">int</span> do_bridge_transfer;</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;   <span class="keywordtype">int</span> transfer_prohibited;</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> transfer_result;</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;   transfer_message = <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a20c565f2b4f6dd680b2fa04f8d74f3c4">ast_blind_transfer_message_create</a>(is_external, transferer, exten, context);</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;   <span class="keywordflow">if</span> (!transfer_message) {</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;      <span class="comment">/* Out of memory. Not even possible to publish a Stasis message about the</span></div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;<span class="comment">       * failure</span></div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to allocate memory for blind transfer publication from %s\n&quot;</span>,</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(transferer));</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;   }</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;   <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a> = <a class="code" href="../../d0/d95/bridge_8c.html#acf7de35a81822873b105c08e1c22826f">ast_bridge_transfer_acquire_bridge</a>(transferer);</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>) {</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;      transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;   }</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>);</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;   transfer_message-&gt;bridge = <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a95241898553c1d42ea46964b277433ad">ast_bridge_snapshot_create</a>(<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>);</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>);</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;   <span class="keywordflow">if</span> (!transfer_message-&gt;bridge) {</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;   }</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;   transferee = <a class="code" href="../../d0/d95/bridge_8c.html#a08a41371fb4f020d645a0e6f50434005">ast_bridge_peer</a>(<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, transferer);</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;   <span class="keywordflow">if</span> (transferee) {</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      transfer_message-&gt;transferee = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(transferee));</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;      <span class="keywordflow">if</span> (!transfer_message-&gt;transferee) {</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;         transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;      }</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;   }</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(transferer);</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;   bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(transferer);</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(transferer);</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel) {</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;      transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;   }</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;   user_data_wrapper = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*user_data_wrapper), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;   <span class="keywordflow">if</span> (!user_data_wrapper) {</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;   }</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;   user_data_wrapper-&gt;data = user_data;</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;   <span class="comment">/* Take off hold if they are on hold. */</span></div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a4be080559ea3fc87e50aa29a95af74f0">ast_bridge_channel_write_unhold</a>(bridge_channel);</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;   transfer_result = <a class="code" href="../../d0/d95/bridge_8c.html#aa9becfea3a1b74d72ec6a21f478b99bd">try_parking</a>(transferer, context, exten, new_channel_cb, user_data_wrapper);</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;   <span class="keywordflow">if</span> (transfer_result == <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>) {</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;   }</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;   <span class="comment">/* Since parking didn&#39;t take control of the user_data_wrapper, we are just going to raise the completed flag now. */</span></div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;   user_data_wrapper-&gt;completed = 1;</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;   {</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>, <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>);</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a> = <a class="code" href="../../d0/d95/bridge_8c.html#ad45098162b2df09235f632efb08a9681">ast_bridge_peers_nolock</a>(<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>);</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>) {</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;         transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;      }</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>) &lt;= 1) {</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;         transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;      }</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;      transfer_prohibited = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;            <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a7a4b299b4cb4bf7c644235d708847fc3">AST_BRIDGE_FLAG_TRANSFER_PROHIBITED</a>);</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;      do_bridge_transfer = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;            <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3">AST_BRIDGE_FLAG_TRANSFER_BRIDGE_ONLY</a>) ||</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>) &gt; 2;</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;   }</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;   <span class="keywordflow">if</span> (transfer_prohibited) {</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;      transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da">AST_BRIDGE_TRANSFER_NOT_PERMITTED</a>;</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;   }</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a8e6a9f8aa899159ff355b1cc05d0a35b">set_transfer_variables_all</a>(transferer, <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, 0);</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;   <span class="keywordflow">if</span> (do_bridge_transfer) {</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      transfer_result = <a class="code" href="../../d0/d95/bridge_8c.html#ab4a549751233836460cee187d4daea03">blind_transfer_bridge</a>(is_external, transferer, <a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>,</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;         exten, context, transferee, new_channel_cb, user_data_wrapper, transfer_message);</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;   }</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;   <span class="comment">/* Reaching this portion means that we&#39;re dealing with a two-party bridge */</span></div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;   <span class="keywordflow">if</span> (!transferee) {</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;      transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;   }</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#a63e2bee23fe653a913a13ec7290f38ae">bridge_channel_internal_queue_blind_transfer</a>(transferee, exten, context,</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;            new_channel_cb, user_data_wrapper)) {</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;      transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>;</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;   }</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a66d6a521530f4fb208eb8ee33e257b6c">ast_bridge_remove</a>(<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, transferer);</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;   transfer_result = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<a class="code" href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a>:</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;   transfer_message-&gt;result = transfer_result;</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;   <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a1a0d32d9383a2e73b8292eec6c8359e0">ast_bridge_publish_blind_transfer</a>(transfer_message);</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;   <span class="keywordflow">return</span> transfer_result;</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;}</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;<span class="comment"> * \brief Performs an attended transfer by moving a channel from one bridge to another</span></div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;<span class="comment"> * The channel that is bridged to the source_channel is moved into the dest_bridge from</span></div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;<span class="comment"> * the source_bridge_channel&#39;s bridge. The swap_channel is swapped out of the dest_bridge and placed in</span></div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;<span class="comment"> * the source_bridge_channel&#39;s bridge.</span></div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;<span class="comment"> * \note dest_bridge and source_bridge_channel&#39;s bridge MUST be locked before calling this function.</span></div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;<span class="comment"> * \param dest_bridge The final bridge for the attended transfer</span></div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;<span class="comment"> * \param source_channel Channel who is bridged to the channel that will move</span></div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;<span class="comment"> * \param swap_channel Channel to be swapped out of the dest_bridge</span></div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;<span class="comment"> * \return The success or failure of the swap attempt</span></div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04620"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a383e21bdffab172ff42a5a237920766d"> 4620</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> <a class="code" href="../../d0/d95/bridge_8c.html#a383e21bdffab172ff42a5a237920766d">bridge_swap_attended_transfer</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *dest_bridge,</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *source_bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *swap_channel)</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;{</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridged_to_source;</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;   bridged_to_source = <a class="code" href="../../de/d41/bridge__channel_8h.html#a0a9bea2845810c6891440a012a275a36">ast_bridge_channel_peer</a>(source_bridge_channel);</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;   <span class="keywordflow">if</span> (bridged_to_source</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;      &amp;&amp; bridged_to_source-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">state</a> == <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a></div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;      &amp;&amp; !<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;bridged_to_source-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>-&gt;<a class="code" href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;         <a class="code" href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a0e985ea384c79e5e35055ecc0ffb2c57">AST_BRIDGE_CHANNEL_FLAG_IMMOVABLE</a>)) {</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      bridged_to_source-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">swap</a> = swap_channel;</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d95/bridge_8c.html#ad663022ff4700bb2d53afeea24f402d4">bridge_do_move</a>(dest_bridge, bridged_to_source, 1, 0)) {</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      }</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;      <span class="comment">/* Must kick the source channel out of its bridge. */</span></div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(source_bridge_channel,</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a>, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;   }</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;}</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;<span class="comment"> * \brief Function that performs an attended transfer when both transferer channels are bridged</span></div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;<span class="comment"> * The method by which the transfer is performed is dependent on whether the bridges allow for</span></div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;<span class="comment"> * optimization to occur between them. If no optimization is permitted, then an unreal channel</span></div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;<span class="comment"> * is placed as a link between the two bridges. If optimization is permitted, then that means</span></div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;<span class="comment"> * we are free to perform move or merge operations in order to perform the transfer.</span></div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;<span class="comment"> * \note to_transferee_bridge and to_target_bridge MUST be locked before calling this function</span></div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;<span class="comment"> * \param to_transferee The channel that is bridged to the transferee</span></div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;<span class="comment"> * \param to_transferee_bridge_channel to_transferee&#39;s bridge_channel</span></div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;<span class="comment"> * \param to_transfer_target The channel that is bridged to the transfer target</span></div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;<span class="comment"> * \param to_target_bridge_channel to_transfer_target&#39;s bridge_channel</span></div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;<span class="comment"> * \param to_transferee_bridge The bridge between to_transferee and the transferee</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="comment"> * \param to_target_bridge The bridge between to_transfer_target and the transfer_target</span></div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;<span class="comment"> * \param publication Data to publish for a stasis attended transfer message</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="comment"> * \return The success or failure of the attended transfer</span></div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04663"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a1399f1aff31e752a96eb710a12bf0821"> 4663</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> <a class="code" href="../../d0/d95/bridge_8c.html#a1399f1aff31e752a96eb710a12bf0821">two_bridge_attended_transfer</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *to_transferee,</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *to_transferee_bridge_channel,</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *to_transfer_target,</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *to_target_bridge_channel,</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *to_transferee_bridge, <span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *to_target_bridge,</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d6d/structast__attended__transfer__message.html">ast_attended_transfer_message</a> *transfer_msg)</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;{</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *kick_me[] = {</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;         to_transferee_bridge_channel,</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;         to_target_bridge_channel,</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;   };</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> res;</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *final_bridge = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *, <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;   <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a> = <a class="code" href="../../d0/d95/bridge_8c.html#ad45098162b2df09235f632efb08a9681">ast_bridge_peers_nolock</a>(to_transferee_bridge);</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>) {</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;      res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;   }</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a8e6a9f8aa899159ff355b1cc05d0a35b">set_transfer_variables_all</a>(to_transferee, <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, 1);</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d95/bridge_8c.html#ad460c5de90f3a8925c9149bbacce65f8">ast_bridges_allow_optimization</a>(to_transferee_bridge, to_target_bridge)) {</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534add0740f1c8620ab74b253de5bac26ec7">AST_BRIDGE_OPTIMIZE_SWAP_TO_CHAN_BRIDGE</a>:</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;      final_bridge = to_transferee_bridge;</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;      res = <a class="code" href="../../d0/d95/bridge_8c.html#a383e21bdffab172ff42a5a237920766d">bridge_swap_attended_transfer</a>(to_transferee_bridge, to_target_bridge_channel, to_transferee);</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a582d8fd99bc8f3320608f74efb142ee7">AST_BRIDGE_OPTIMIZE_SWAP_TO_PEER_BRIDGE</a>:</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      final_bridge = to_target_bridge;</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;      res = <a class="code" href="../../d0/d95/bridge_8c.html#a383e21bdffab172ff42a5a237920766d">bridge_swap_attended_transfer</a>(to_target_bridge, to_transferee_bridge_channel, to_transfer_target);</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a2980a16e43b7b4f52b6c3af11bd79a56">AST_BRIDGE_OPTIMIZE_MERGE_TO_CHAN_BRIDGE</a>:</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      final_bridge = to_transferee_bridge;</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a33ad1b704c3dedf9fbf0bf8c2429561a">bridge_do_merge</a>(to_transferee_bridge, to_target_bridge, kick_me, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(kick_me), 0);</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;      res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a83a14f41557a30da243c32b7f717ed1f">AST_BRIDGE_OPTIMIZE_MERGE_TO_PEER_BRIDGE</a>:</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;      final_bridge = to_target_bridge;</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a33ad1b704c3dedf9fbf0bf8c2429561a">bridge_do_merge</a>(to_target_bridge, to_transferee_bridge, kick_me, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(kick_me), 0);</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a19fe1f0ca6993cc12c518aa09fb79a79">AST_BRIDGE_OPTIMIZE_PROHIBITED</a>:</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      <span class="comment">/* Just because optimization wasn&#39;t doable doesn&#39;t necessarily mean</span></div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;<span class="comment">       * that we can actually perform the transfer. Some reasons for non-optimization</span></div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;<span class="comment">       * indicate bridge invalidity, so let&#39;s check those before proceeding.</span></div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;      <span class="keywordflow">if</span> (to_transferee_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a> || to_transferee_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a> ||</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;            to_target_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">inhibit_merge</a> || to_target_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">dissolved</a>) {</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;      }</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a4e027120313f06bfe8aebc31e5ae5cae">attended_transfer_bridge</a>(to_transferee, to_transfer_target,</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;         to_transferee_bridge, to_target_bridge, transfer_msg);</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;   }</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;   <span class="keywordflow">if</span> (res == <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>) {</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#aae3000e9dc05d9b3023f5a571ffb14d7">ast_attended_transfer_message_add_merge</a>(transfer_msg, final_bridge);</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;   }</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;}</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;</div><div class="line"><a name="l04729"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aec45146e91e4d8bc2a7d2cf083c4dac0"> 4729</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> <a class="code" href="../../d0/d95/bridge_8c.html#aec45146e91e4d8bc2a7d2cf083c4dac0">ast_bridge_transfer_attended</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *to_transferee,</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *to_transfer_target)</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;{</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *, to_transferee_bridge, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *, to_target_bridge, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *, to_transferee_bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *, to_target_bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *, <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, transferee, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d6d/structast__attended__transfer__message.html">ast_attended_transfer_message</a> *, transfer_msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *the_bridge = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan_bridged;</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan_unbridged;</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;   <span class="keywordtype">int</span> transfer_prohibited;</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;   <span class="keywordtype">int</span> do_bridge_transfer;</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a> res;</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;   <span class="keywordtype">int</span> hangup_target = 0;</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;   to_transferee_bridge = <a class="code" href="../../d0/d95/bridge_8c.html#acf7de35a81822873b105c08e1c22826f">ast_bridge_transfer_acquire_bridge</a>(to_transferee);</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;   to_target_bridge = <a class="code" href="../../d0/d95/bridge_8c.html#acf7de35a81822873b105c08e1c22826f">ast_bridge_transfer_acquire_bridge</a>(to_transfer_target);</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;   transfer_msg = <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a5d80b41bade979c37596d850cfcf3e64">ast_attended_transfer_message_create</a>(1, to_transferee, to_transferee_bridge,</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;         to_transfer_target, to_target_bridge, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;   <span class="keywordflow">if</span> (!transfer_msg) {</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to create Stasis publication for attended transfer from %s\n&quot;</span>,</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(to_transferee));</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;   }</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;   <span class="comment">/* They can&#39;t both be unbridged, you silly goose! */</span></div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;   <span class="keywordflow">if</span> (!to_transferee_bridge &amp;&amp; !to_target_bridge) {</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;      res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;   }</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(to_transferee);</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;   to_transferee_bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(to_transferee);</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(to_transferee);</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(to_transfer_target);</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;   to_target_bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(to_transfer_target);</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(to_transfer_target);</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;   <span class="keywordflow">if</span> (to_transferee_bridge_channel) {</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      <span class="comment">/* Take off hold if they are on hold. */</span></div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../de/d41/bridge__channel_8h.html#a4be080559ea3fc87e50aa29a95af74f0">ast_bridge_channel_write_unhold</a>(to_transferee_bridge_channel)) {</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Transferee channel disappeared during transfer!\n&quot;</span>);</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;         res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;      }</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;   }</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;   <span class="keywordflow">if</span> (to_target_bridge_channel) {</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *target_complete_sound;</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;      <span class="comment">/* Take off hold if they are on hold. */</span></div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../de/d41/bridge__channel_8h.html#a4be080559ea3fc87e50aa29a95af74f0">ast_bridge_channel_write_unhold</a>(to_target_bridge_channel)) {</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Target channel disappeared during transfer!\n&quot;</span>);</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;         res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;      }</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;      <span class="comment">/* Is there a courtesy sound to play to the target? */</span></div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(to_transfer_target);</div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;      target_complete_sound = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(to_transfer_target,</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;         <span class="stringliteral">&quot;ATTENDED_TRANSFER_COMPLETE_SOUND&quot;</span>);</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(target_complete_sound)) {</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;         target_complete_sound = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(target_complete_sound);</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;         target_complete_sound = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;      }</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(to_transfer_target);</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;      <span class="keywordflow">if</span> (!target_complete_sound) {</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(to_transferee);</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;         target_complete_sound = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(to_transferee,</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;            <span class="stringliteral">&quot;ATTENDED_TRANSFER_COMPLETE_SOUND&quot;</span>);</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(target_complete_sound)) {</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;            target_complete_sound = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(target_complete_sound);</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;            target_complete_sound = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;         }</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(to_transferee);</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      }</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;      <span class="keywordflow">if</span> (target_complete_sound) {</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ad30f159c66c054fd95a739c087a6c5e9">ast_bridge_channel_write_playfile</a>(to_target_bridge_channel, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;            target_complete_sound, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      }</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;   }</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;   <span class="comment">/* Let&#39;s get the easy one out of the way first */</span></div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;   <span class="keywordflow">if</span> (to_transferee_bridge &amp;&amp; to_target_bridge) {</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;      <span class="keywordflow">if</span> (!to_transferee_bridge_channel || !to_target_bridge_channel) {</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;         res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      }</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a04a2852f4166568323aa33cd3d0158c7">ast_bridge_lock_both</a>(to_transferee_bridge, to_target_bridge);</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;      res = <a class="code" href="../../d0/d95/bridge_8c.html#a1399f1aff31e752a96eb710a12bf0821">two_bridge_attended_transfer</a>(to_transferee, to_transferee_bridge_channel,</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;            to_transfer_target, to_target_bridge_channel,</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;            to_transferee_bridge, to_target_bridge, transfer_msg);</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(to_transferee_bridge);</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(to_target_bridge);</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      hangup_target = 1;</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;   }</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;   the_bridge = to_transferee_bridge ?: to_target_bridge;</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;   chan_bridged = to_transferee_bridge ? to_transferee : to_transfer_target;</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;   chan_unbridged = to_transferee_bridge ? to_transfer_target : to_transferee;</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;<span class="comment">    * Race condition makes it possible for app to be NULL, so get the app prior to</span></div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;<span class="comment">    * transferring with a fallback of &quot;unknown&quot;.</span></div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;   app = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac8b850ff95f945ad6cfeb2942799800a">ast_channel_appl</a>(chan_unbridged) ?: <span class="stringliteral">&quot;unknown&quot;</span>);</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;   {</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <span class="keywordtype">int</span> chan_count;</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, the_bridge, <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>, <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>);</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;      <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a> = <a class="code" href="../../d0/d95/bridge_8c.html#ad45098162b2df09235f632efb08a9681">ast_bridge_peers_nolock</a>(the_bridge);</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>) {</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;         res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;      }</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;      chan_count = <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>);</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      <span class="keywordflow">if</span> (chan_count &lt;= 1) {</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;         res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>;</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      }</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;      transfer_prohibited = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;the_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;            <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a7a4b299b4cb4bf7c644235d708847fc3">AST_BRIDGE_FLAG_TRANSFER_PROHIBITED</a>);</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;      do_bridge_transfer = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;the_bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">feature_flags</a>,</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;            <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3">AST_BRIDGE_FLAG_TRANSFER_BRIDGE_ONLY</a>) ||</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;            chan_count &gt; 2;</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;   }</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;   <span class="keywordflow">if</span> (transfer_prohibited) {</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;      res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da">AST_BRIDGE_TRANSFER_NOT_PERMITTED</a>;</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;   }</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a8e6a9f8aa899159ff355b1cc05d0a35b">set_transfer_variables_all</a>(to_transferee, <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, 1);</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;   <span class="keywordflow">if</span> (do_bridge_transfer) {</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;<span class="comment">       * Hang up the target if it was bridged. Note, if it is not bridged</span></div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;<span class="comment">       * it is hung up during the masquerade.</span></div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      hangup_target = chan_bridged == to_transfer_target;</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(the_bridge);</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;      res = <a class="code" href="../../d0/d95/bridge_8c.html#a4e027120313f06bfe8aebc31e5ae5cae">attended_transfer_bridge</a>(chan_bridged, chan_unbridged, the_bridge, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, transfer_msg);</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(the_bridge);</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;   }</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;   transferee = <a class="code" href="../../d0/d95/bridge_8c.html#ad06dce4a79c1071d41110753c9f7468b">get_transferee</a>(<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, chan_bridged);</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;   <span class="keywordflow">if</span> (!transferee) {</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;      res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;   }</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/dfc/bridge__channel__internal_8h.html#aa6955fc24cd777947bb8c97011c55de2">bridge_channel_internal_queue_attended_transfer</a>(transferee, chan_unbridged)) {</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;      res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>;</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;   }</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a66d6a521530f4fb208eb8ee33e257b6c">ast_bridge_remove</a>(the_bridge, chan_bridged);</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;   <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a3ba70be1910dd4bebfc77dec29ffc43b">ast_attended_transfer_message_add_app</a>(transfer_msg, app, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;   res = <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>;</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;   <span class="keywordflow">if</span> ((res == <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a> &amp;&amp; hangup_target) || res == <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>) {</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ac2d6607253f7e8b272d4e845474eaa9b">ast_softhangup</a>(to_transfer_target, <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7">AST_SOFTHANGUP_DEV</a>);</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;   }</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;   transfer_msg-&gt;result = res;</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;   <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a1949ac2d3f4b2113242d981cc315b451">ast_bridge_publish_attended_transfer</a>(transfer_msg);</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;}</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;<span class="comment"> * \brief Service the bridge manager request.</span></div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;<span class="comment"> * \param bridge requesting service.</span></div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04923"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a38f4247405eaab60923cde924be8162e"> 4923</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a38f4247405eaab60923cde924be8162e">bridge_manager_service</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>)</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;{</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;   <span class="keywordflow">if</span> (bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a>) {</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a37b40349d0ef536a0f34b042f7803ab8">ast_callid_threadassoc_change</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a62f8995a6eac6c8a48205a6f3815d54b">callid</a>);</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;   }</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;</div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;   <span class="comment">/* Do any pending bridge actions. */</span></div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#ac31ac154d47208c964f68cb3f03cb997">bridge_handle_actions</a>(bridge);</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;}</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;<span class="comment"> * \brief Bridge manager service thread.</span></div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04942"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#adac11f6affbd68eb16840df7abd4c874"> 4942</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../d0/d95/bridge_8c.html#adac11f6affbd68eb16840df7abd4c874">bridge_manager_thread</a>(<span class="keywordtype">void</span> *<a class="code" href="../../df/d3c/structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>)</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;{</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d7c/structbridge__manager__controller.html">bridge_manager_controller</a> *manager = data;</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d89/structbridge__manager__request.html">bridge_manager_request</a> *<a class="code" href="../../d0/d29/chan__pjsip_8c.html#a4e2e6fb7d874f0d2deddd2ecfc8afb32">request</a>;</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(manager);</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;   <span class="keywordflow">while</span> (!manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a111277a0849f92b793ed6aa1efe54462">stop</a>) {</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;      request = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a4c0e99774fbc08689db34d6ad5104f35">service_requests</a>, <a class="code" href="../../d5/da1/structnode.html">node</a>);</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;      <span class="keywordflow">if</span> (!request) {</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a>(manager));</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;      }</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(manager);</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;      <span class="comment">/* Service the bridge. */</span></div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a38f4247405eaab60923cde924be8162e">bridge_manager_service</a>(request-&gt;<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>);</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(request-&gt;<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, -1);</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(request);</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(manager);</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;   }</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(manager);</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;}</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;<span class="comment"> * \brief Destroy the bridge manager controller.</span></div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;<span class="comment"> * \param obj Bridge manager to destroy.</span></div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04977"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a51acc84da704498a59907a46a73aa769"> 4977</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a51acc84da704498a59907a46a73aa769">bridge_manager_destroy</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;{</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d7c/structbridge__manager__controller.html">bridge_manager_controller</a> *manager = obj;</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d89/structbridge__manager__request.html">bridge_manager_request</a> *<a class="code" href="../../d0/d29/chan__pjsip_8c.html#a4e2e6fb7d874f0d2deddd2ecfc8afb32">request</a>;</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;   <span class="keywordflow">if</span> (manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a01f75a9ad916f63a94e06a27635ba278">thread</a> != <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>) {</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;      <span class="comment">/* Stop the manager thread. */</span></div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(manager);</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;      manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a111277a0849f92b793ed6aa1efe54462">stop</a> = 1;</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(manager);</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Waiting for bridge manager thread to die.\n&quot;</span>);</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;      pthread_join(manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;   }</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;   <span class="comment">/* Destroy the service request queue. */</span></div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;   <span class="keywordflow">while</span> ((request = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a4c0e99774fbc08689db34d6ad5104f35">service_requests</a>, <a class="code" href="../../d5/da1/structnode.html">node</a>))) {</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(request-&gt;<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, -1);</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(request);</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;   }</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;}</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;<span class="comment"> * \brief Create the bridge manager controller.</span></div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;<span class="comment"> * \retval manager on success.</span></div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;<span class="comment"> * \retval NULL on error.</span></div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05009"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a9ad5bc80833f85bf5a18dbac95094691"> 5009</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d7c/structbridge__manager__controller.html">bridge_manager_controller</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a9ad5bc80833f85bf5a18dbac95094691">bridge_manager_create</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;{</div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d7c/structbridge__manager__controller.html">bridge_manager_controller</a> *manager;</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;   manager = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*manager), <a class="code" href="../../d0/d95/bridge_8c.html#a51acc84da704498a59907a46a73aa769">bridge_manager_destroy</a>);</div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;   <span class="keywordflow">if</span> (!manager) {</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;      <span class="comment">/* Well. This isn&#39;t good. */</span></div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;   }</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a4c0e99774fbc08689db34d6ad5104f35">service_requests</a>);</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;   <span class="comment">/* Create the bridge manager thread. */</span></div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a4781fd54a4ca8c7f0f8a32a6cce503c0">ast_pthread_create</a>(&amp;manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d0/d95/bridge_8c.html#adac11f6affbd68eb16840df7abd4c874">bridge_manager_thread</a>, manager)) {</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;      <span class="comment">/* Well. This isn&#39;t good either. */</span></div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;      manager-&gt;<a class="code" href="../../d4/d7c/structbridge__manager__controller.html#a01f75a9ad916f63a94e06a27635ba278">thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(manager, -1);</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      manager = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;   }</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;   <span class="keywordflow">return</span> manager;</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;}</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;<span class="comment"> * \brief Bridge ao2 container sort function.</span></div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;<span class="comment"> * \param obj_left pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;<span class="comment"> * \param obj_right pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;<span class="comment"> * \param flags flags from ao2_callback()</span></div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;<span class="comment"> *   OBJ_POINTER - if set, &#39;obj_right&#39;, is an object.</span></div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;<span class="comment"> *   OBJ_KEY - if set, &#39;obj_right&#39;, is a search key item that is not an object.</span></div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;<span class="comment"> *   OBJ_PARTIAL_KEY - if set, &#39;obj_right&#39;, is a partial search key item that is not an object.</span></div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;<span class="comment"> * \retval &lt;0 if obj_left &lt; obj_right</span></div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;<span class="comment"> * \retval =0 if obj_left == obj_right</span></div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;<span class="comment"> * \retval &gt;0 if obj_left &gt; obj_right</span></div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05048"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a4c2435b74d16e617f7213dda3c25ffd7"> 5048</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a4c2435b74d16e617f7213dda3c25ffd7">bridge_sort_cmp</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj_left, <span class="keyword">const</span> <span class="keywordtype">void</span> *obj_right, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;{</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge_left = obj_left;</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge_right = obj_right;</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *right_key = obj_right;</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; (<a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>)) {</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>:</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;      right_key = bridge_right-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>;</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>:</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      cmp = strcmp(bridge_left-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, right_key);</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>:</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;      cmp = strncmp(bridge_left-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, right_key, strlen(right_key));</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;   }</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;   <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;}</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;</div><div class="line"><a name="l05070"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a69034688e4e730fca4c3e12b7ac38300"> 5070</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../d0/d95/bridge_8c.html#a69034688e4e730fca4c3e12b7ac38300">ast_bridge_find_by_id</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *bridge_id)</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;{</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(bridges, bridge_id, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;}</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;</div><div class="line"><a name="l05075"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a619ad10e73a067de53cc1ad60ccf1d99"> 5075</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a619ad10e73a067de53cc1ad60ccf1d99">complete_bridge_live_search</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;{</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a> = obj;</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a>(<a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>))) {</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;   }</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;}</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;</div><div class="line"><a name="l05086"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a0724e3f5e13ffe78fe0fa0ae8e5a5378"> 5086</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a0724e3f5e13ffe78fe0fa0ae8e5a5378">complete_bridge_live</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>)</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;{</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(bridges, <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(word) ? 0 : <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>,</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a619ad10e73a067de53cc1ad60ccf1d99">complete_bridge_live_search</a>, (<span class="keywordtype">char</span> *) word);</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;}</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;</div><div class="line"><a name="l05094"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a82fa71a3f3929e6a16bf1dd26d09c18b"> 5094</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a82fa71a3f3929e6a16bf1dd26d09c18b">handle_bridge_show_all</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;{</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;<span class="preprocessor">#define FORMAT_HDR &quot;%-36s %5s %-15s %-15s %s\n&quot;</span></div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;<span class="preprocessor">#define FORMAT_ROW &quot;%-36s %5u %-15s %-15s %s\n&quot;</span></div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter;</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;bridge show all&quot;</span>;</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;         <span class="stringliteral">&quot;Usage: bridge show all\n&quot;</span></div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;         <span class="stringliteral">&quot;       List all bridges\n&quot;</span>;</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;   }</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d0/d95/bridge_8c.html#afd2c9505e0edcb47e18669f60500acf0">FORMAT_HDR</a>, <span class="stringliteral">&quot;Bridge-ID&quot;</span>, <span class="stringliteral">&quot;Chans&quot;</span>, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Technology&quot;</span>, <span class="stringliteral">&quot;Duration&quot;</span>);</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;   iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(bridges, 0);</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;   <span class="keywordflow">for</span> (; (bridge = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, -1)) {</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__bridge__snapshot.html">ast_bridge_snapshot</a> *snapshot = <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a04efba17b1302d217a2a07a02c3eac98">ast_bridge_get_snapshot</a>(bridge);</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;      <span class="keywordtype">char</span> print_time[32];</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      <span class="keywordflow">if</span> (snapshot) {</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;         <a class="code" href="../../de/df7/time_8h.html#a6414288234db8cadefa9680e8ac0f968">ast_format_duration_hh_mm_ss</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>().tv_sec - snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a298ce3dfc9b5b8a8351e8ed103aa7e5c">creationtime</a>.tv_sec, print_time, <span class="keyword">sizeof</span>(print_time));</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d0/d95/bridge_8c.html#a4090d7655fc829efc4a37a3144759c7c">FORMAT_ROW</a>,</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;            snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;            snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a>,</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#aed90bb628ee273a4b27b778b5b0d8ec2">subclass</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#ace6976ffaf8aa0738aa7e01b0e98c04f">technology</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;            print_time);</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(snapshot, -1);</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;      }</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;   }</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter);</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="preprocessor">#undef FORMAT_HDR</span></div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="preprocessor">#undef FORMAT_ROW</span></div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;}</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;<span class="comment">/*! \brief Internal callback function for sending channels in a bridge to the CLI */</span></div><div class="line"><a name="l05140"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aedb1ba43789d8d610f180baa0596f413"> 5140</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#aedb1ba43789d8d610f180baa0596f413">bridge_show_specific_print_channel</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;{</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a> = obj;</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> = arg;</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *snapshot;</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;   snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(uniqueid);</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;   <span class="keywordflow">if</span> (!snapshot) {</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;   }</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Channel: %s\n&quot;</span>, snapshot-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(snapshot, -1);</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;}</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;</div><div class="line"><a name="l05157"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#aede8649d94e9e3a148e80d31a2e5a4e9"> 5157</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#aede8649d94e9e3a148e80d31a2e5a4e9">handle_bridge_show_specific</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;{</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__bridge__snapshot.html">ast_bridge_snapshot</a> *snapshot;</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;   <span class="keywordtype">char</span> print_time[32];</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;bridge show&quot;</span>;</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;         <span class="stringliteral">&quot;Usage: bridge show &lt;bridge-id&gt;\n&quot;</span></div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;         <span class="stringliteral">&quot;       Show information about the &lt;bridge-id&gt; bridge\n&quot;</span>;</div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 2) {</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a0724e3f5e13ffe78fe0fa0ae8e5a5378">complete_bridge_live</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;      }</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;   }</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;   }</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;   snapshot = <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#aee9af6c35b13edd9dcbd3dbabc5522ee">ast_bridge_get_snapshot_by_uniqueid</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;   <span class="keywordflow">if</span> (!snapshot) {</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Bridge &#39;%s&#39; not found\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;   }</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;   <a class="code" href="../../de/df7/time_8h.html#a6414288234db8cadefa9680e8ac0f968">ast_format_duration_hh_mm_ss</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>().tv_sec - snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a298ce3dfc9b5b8a8351e8ed103aa7e5c">creationtime</a>.tv_sec, print_time, <span class="keyword">sizeof</span>(print_time));</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Id: %s\n&quot;</span>, snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Type: %s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#aed90bb628ee273a4b27b778b5b0d8ec2">subclass</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>));</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Technology: %s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#ace6976ffaf8aa0738aa7e01b0e98c04f">technology</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>));</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Subclass: %s\n&quot;</span>, snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#aed90bb628ee273a4b27b778b5b0d8ec2">subclass</a>);</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Creator: %s\n&quot;</span>, snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a6e62c2774ca18846e6e45057fb8b7a22">creator</a>);</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Name: %s\n&quot;</span>, snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Video-Mode: %s\n&quot;</span>, <a class="code" href="../../d0/d95/bridge_8c.html#a2a2b1e82e019faba42fa278f7a69a699">ast_bridge_video_mode_to_string</a>(snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a1b93f1ad25034993f7eb103a0322562e">video_mode</a>));</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Video-Source-Id: %s\n&quot;</span>, snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a54eb8725951c786429e4b86d7159309e">video_source_id</a>);</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Num-Channels: %u\n&quot;</span>, snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a>);</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Num-Active: %u\n&quot;</span>, snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a4d514eabb35f71dee132ef1df1c6cdbb">num_active</a>);</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Duration: %s\n&quot;</span>, print_time);</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(snapshot-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#adbc20a2fd50bb1376a3c6094e96a31e3">channels</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d0/d95/bridge_8c.html#aedb1ba43789d8d610f180baa0596f413">bridge_show_specific_print_channel</a>, a);</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(snapshot, -1);</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;}</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;<span class="preprocessor">#ifdef AST_DEVMODE</span></div><div class="line"><a name="l05206"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a2a5f82dc1174da37bb753d991858ce79"> 5206</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a2a5f82dc1174da37bb753d991858ce79">handle_bridge_destroy_specific</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;{</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;bridge destroy&quot;</span>;</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;         <span class="stringliteral">&quot;Usage: bridge destroy &lt;bridge-id&gt;\n&quot;</span></div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;         <span class="stringliteral">&quot;       Destroy the &lt;bridge-id&gt; bridge\n&quot;</span>;</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 2) {</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a0724e3f5e13ffe78fe0fa0ae8e5a5378">complete_bridge_live</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;      }</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;   }</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;   }</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;   bridge = <a class="code" href="../../d0/d95/bridge_8c.html#a69034688e4e730fca4c3e12b7ac38300">ast_bridge_find_by_id</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;   <span class="keywordflow">if</span> (!bridge) {</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Bridge &#39;%s&#39; not found\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;   }</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Destroying bridge &#39;%s&#39;\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;   <a class="code" href="../../d0/d95/bridge_8c.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(bridge, 0);</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;}</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;</div><div class="line"><a name="l05241"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3a772d1ce5fd89a02a23ebd5921ab475"> 5241</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a3a772d1ce5fd89a02a23ebd5921ab475">complete_bridge_participant</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *bridge_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>)</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;{</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;   <span class="keywordtype">int</span> wordlen;</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;   bridge = <a class="code" href="../../d0/d95/bridge_8c.html#a69034688e4e730fca4c3e12b7ac38300">ast_bridge_find_by_id</a>(bridge_name);</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;   <span class="keywordflow">if</span> (!bridge) {</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;   }</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;   wordlen = strlen(word);</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;      <span class="keywordflow">if</span> (!strncasecmp(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), word, wordlen)) {</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a>(<a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)))) {</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;         }</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;      }</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;   }</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, -1);</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;}</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;</div><div class="line"><a name="l05269"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a23798c50211d265d47aaba3e71953237"> 5269</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a23798c50211d265d47aaba3e71953237">handle_bridge_kick_channel</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;{</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> completions[] = { <span class="stringliteral">&quot;all&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> };</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>;</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;bridge kick&quot;</span>;</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;         <span class="stringliteral">&quot;Usage: bridge kick &lt;bridge-id&gt; &lt;channel-name | all&gt;\n&quot;</span></div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;         <span class="stringliteral">&quot;       Kick the &lt;channel-name&gt; channel out of the &lt;bridge-id&gt; bridge\n&quot;</span></div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;         <span class="stringliteral">&quot;       If all is specified as the channel name then all channels will be\n&quot;</span></div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;         <span class="stringliteral">&quot;       kicked out of the bridge.\n&quot;</span>;</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 2) {</div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a0724e3f5e13ffe78fe0fa0ae8e5a5378">complete_bridge_live</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;      }</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 3) {</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a2a43f82ed19e84f386787154f2f22fc9">ast_cli_complete</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, completions, -1);</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3a772d1ce5fd89a02a23ebd5921ab475">complete_bridge_participant</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;      }</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;   }</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;   }</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;   bridge = <a class="code" href="../../d0/d95/bridge_8c.html#a69034688e4e730fca4c3e12b7ac38300">ast_bridge_find_by_id</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;   <span class="keywordflow">if</span> (!bridge) {</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Bridge &#39;%s&#39; not found\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;   }</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;all&quot;</span>)) {</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Kicking all channels from bridge &#39;%s&#39;\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a>(bridge);</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">channels</a>, bridge_channel, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#ad7de2a71d5af8f85035713f1f3cb69a9">ast_bridge_channel_queue_callback</a>(bridge_channel, 0, <a class="code" href="../../d0/d95/bridge_8c.html#acc33b8d4fe39d089f5987e86e0333617">kick_it</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;      }</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge);</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan;</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#a71d89dbc5107b1f851dcbf1686a0d9d9">ast_channel_get_by_name_prefix</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]));</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;      <span class="keywordflow">if</span> (!chan) {</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Channel &#39;%s&#39; not found\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, -1);</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;      }</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Kicking channel &#39;%s&#39; from bridge &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;      <a class="code" href="../../d0/d95/bridge_8c.html#a7132d0a0b71844641ce3a1035e05c67b">ast_bridge_kick</a>(bridge, chan);</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;   }</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bridge, -1);</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;}</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;<span class="comment">/*! Bridge technology capabilities to string. */</span></div><div class="line"><a name="l05335"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#abc63f551fd512b833546ed01d198057f"> 5335</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#abc63f551fd512b833546ed01d198057f">tech_capability2str</a>(uint32_t capabilities)</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;{</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;   <span class="keywordflow">if</span> (capabilities &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaff2606e446a3b7e22fb3785a06110554">AST_BRIDGE_CAPABILITY_HOLDING</a>) {</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;      type = <span class="stringliteral">&quot;Holding&quot;</span>;</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (capabilities &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfab01df717450b48e5a7ba5003df49c955">AST_BRIDGE_CAPABILITY_EARLY</a>) {</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;      type = <span class="stringliteral">&quot;Early&quot;</span>;</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (capabilities &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaec2d0fff3f4f8df0d9ef6b4d9be78380">AST_BRIDGE_CAPABILITY_NATIVE</a>) {</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;      type = <span class="stringliteral">&quot;Native&quot;</span>;</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (capabilities &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaf483c951b835fcc35da807b6a4b12509">AST_BRIDGE_CAPABILITY_1TO1MIX</a>) {</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;      type = <span class="stringliteral">&quot;1to1Mix&quot;</span>;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (capabilities &amp; <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a>) {</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;      type = <span class="stringliteral">&quot;MultiMix&quot;</span>;</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;      type = <span class="stringliteral">&quot;&lt;Unknown&gt;&quot;</span>;</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;   }</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;}</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;</div><div class="line"><a name="l05355"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ac608985a552294f9151429f01f5c9d8b"> 5355</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#ac608985a552294f9151429f01f5c9d8b">handle_bridge_technology_show</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;{</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;<span class="preprocessor">#define FORMAT_HDR &quot;%-20s %-20s %8s %s\n&quot;</span></div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;<span class="preprocessor">#define FORMAT_ROW &quot;%-20s %-20s %8u %s\n&quot;</span></div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *cur;</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;bridge technology show&quot;</span>;</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;         <span class="stringliteral">&quot;Usage: bridge technology show\n&quot;</span></div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;         <span class="stringliteral">&quot;       List registered bridge technologies\n&quot;</span>;</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;   }</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d0/d95/bridge_8c.html#afd2c9505e0edcb47e18669f60500acf0">FORMAT_HDR</a>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Priority&quot;</span>, <span class="stringliteral">&quot;Suspended&quot;</span>);</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, cur, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;      <span class="comment">/* Decode type for display */</span></div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;      type = <a class="code" href="../../d0/d95/bridge_8c.html#abc63f551fd512b833546ed01d198057f">tech_capability2str</a>(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a>);</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d0/d95/bridge_8c.html#a4090d7655fc829efc4a37a3144759c7c">FORMAT_ROW</a>, cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, type, cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a>,</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">suspended</a>));</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;   }</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;<span class="preprocessor">#undef FORMAT</span></div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;}</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;</div><div class="line"><a name="l05390"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#ab2aeba6f28c5380fefdf732ec70a9e73"> 5390</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#ab2aeba6f28c5380fefdf732ec70a9e73">complete_bridge_technology</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>)</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;{</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *cur;</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;   <span class="keywordtype">int</span> wordlen;</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;   wordlen = strlen(word);</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, cur, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;      <span class="keywordflow">if</span> (!strncasecmp(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, word, wordlen)) {</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a>(<a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>))) {</div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;         }</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;      }</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;   }</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;}</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;</div><div class="line"><a name="l05409"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a578024742467fb967f777d1325f2822a"> 5409</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d95/bridge_8c.html#a578024742467fb967f777d1325f2822a">handle_bridge_technology_suspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;{</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *cur;</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d3/d5a/ccss_8c.html#a8bd1c39b4993f80f1bf674e3a1d717dd">suspend</a>;</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;   <span class="keywordtype">int</span> successful;</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;bridge technology {suspend|unsuspend}&quot;</span>;</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;         <span class="stringliteral">&quot;Usage: bridge technology {suspend|unsuspend} &lt;technology-name&gt;\n&quot;</span></div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;         <span class="stringliteral">&quot;       Suspend or unsuspend a bridge technology.\n&quot;</span>;</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 3) {</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#ab2aeba6f28c5380fefdf732ec70a9e73">complete_bridge_technology</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;      }</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;   }</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;   }</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;   suspend = !strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], <span class="stringliteral">&quot;suspend&quot;</span>);</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;   successful = 0;</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, cur, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3])) {</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;         successful = 1;</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;         <span class="keywordflow">if</span> (suspend) {</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;            <a class="code" href="../../d0/d95/bridge_8c.html#acd557b9305cf531bd1d66acbe39d12ee">ast_bridge_technology_suspend</a>(cur);</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;            <a class="code" href="../../d0/d95/bridge_8c.html#a24bb22d467a5f840fe8c954f9c7624d1">ast_bridge_technology_unsuspend</a>(cur);</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;         }</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;      }</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;   }</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;</div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;   <span class="keywordflow">if</span> (successful) {</div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;      <span class="keywordflow">if</span> (suspend) {</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Suspended bridge technology &#39;%s&#39;\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unsuspended bridge technology &#39;%s&#39;\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;      }</div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Bridge technology &#39;%s&#39; not found\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;   }</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;}</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;</div><div class="line"><a name="l05462"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a4066f3edf4ad39950014db569528f051"> 5462</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> <a class="code" href="../../d0/d95/bridge_8c.html#a4066f3edf4ad39950014db569528f051">bridge_cli</a>[] = {</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a82fa71a3f3929e6a16bf1dd26d09c18b">handle_bridge_show_all</a>, <span class="stringliteral">&quot;List all bridges&quot;</span>),</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d0/d95/bridge_8c.html#aede8649d94e9e3a148e80d31a2e5a4e9">handle_bridge_show_specific</a>, <span class="stringliteral">&quot;Show information about a bridge&quot;</span>),</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;<span class="preprocessor">#ifdef AST_DEVMODE</span></div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a2a5f82dc1174da37bb753d991858ce79">handle_bridge_destroy_specific</a>, <span class="stringliteral">&quot;Destroy a bridge&quot;</span>),</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a23798c50211d265d47aaba3e71953237">handle_bridge_kick_channel</a>, <span class="stringliteral">&quot;Kick a channel from a bridge&quot;</span>),</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d0/d95/bridge_8c.html#ac608985a552294f9151429f01f5c9d8b">handle_bridge_technology_show</a>, <span class="stringliteral">&quot;List registered bridge technologies&quot;</span>),</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d0/d95/bridge_8c.html#a578024742467fb967f777d1325f2822a">handle_bridge_technology_suspend</a>, <span class="stringliteral">&quot;Suspend/unsuspend a bridge technology&quot;</span>),</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;};</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;</div><div class="line"><a name="l05474"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a50f3a7bc97ba57ed246801d6b6435f08"> 5474</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a50f3a7bc97ba57ed246801d6b6435f08">handle_manager_bridge_tech_suspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m, <span class="keywordtype">int</span> <a class="code" href="../../d3/d5a/ccss_8c.html#a8bd1c39b4993f80f1bf674e3a1d717dd">suspend</a>)</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;{</div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;BridgeTechnology&quot;</span>);</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *cur;</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;   <span class="keywordtype">int</span> successful = 0;</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;BridgeTechnology must be provided&quot;</span>);</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;   }</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, cur, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, name)) {</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;         successful = 1;</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;         <span class="keywordflow">if</span> (suspend) {</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;            <a class="code" href="../../d0/d95/bridge_8c.html#acd557b9305cf531bd1d66acbe39d12ee">ast_bridge_technology_suspend</a>(cur);</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;            <a class="code" href="../../d0/d95/bridge_8c.html#a24bb22d467a5f840fe8c954f9c7624d1">ast_bridge_technology_unsuspend</a>(cur);</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;         }</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;      }</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;   }</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;   <span class="keywordflow">if</span> (!successful) {</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;BridgeTechnology not found&quot;</span>);</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;   }</div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, (suspend ? <span class="stringliteral">&quot;Suspended bridge technology&quot;</span> : <span class="stringliteral">&quot;Unsuspended bridge technology&quot;</span>));</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;}</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;</div><div class="line"><a name="l05508"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a355daedbe9708a185e0439e47476635d"> 5508</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a355daedbe9708a185e0439e47476635d">manager_bridge_tech_suspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;{</div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a50f3a7bc97ba57ed246801d6b6435f08">handle_manager_bridge_tech_suspend</a>(s, m, 1);</div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;}</div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;</div><div class="line"><a name="l05513"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a3e507358824dd355399b94c389762da3"> 5513</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a3e507358824dd355399b94c389762da3">manager_bridge_tech_unsuspend</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;{</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d95/bridge_8c.html#a50f3a7bc97ba57ed246801d6b6435f08">handle_manager_bridge_tech_suspend</a>(s, m, 0);</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;}</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;</div><div class="line"><a name="l05518"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a15a9caea3551b28025d36c0d0ca885e9"> 5518</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a15a9caea3551b28025d36c0d0ca885e9">manager_bridge_tech_list</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;{</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, id_text, <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128), <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a> *cur;</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;   <span class="keywordtype">int</span> num_items = 0;</div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;</div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;   <span class="keywordflow">if</span> (!id_text) {</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Internal error&quot;</span>);</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;   }</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;id_text, 0, <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;   }</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Bridge technology listing will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;</div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>, cur, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;      type = <a class="code" href="../../d0/d95/bridge_8c.html#abc63f551fd512b833546ed01d198057f">tech_capability2str</a>(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">capabilities</a>);</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s,</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;         <span class="stringliteral">&quot;Event: BridgeTechnologyListItem\r\n&quot;</span></div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;         <span class="stringliteral">&quot;BridgeTechnology: %s\r\n&quot;</span></div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;         <span class="stringliteral">&quot;BridgeType: %s\r\n&quot;</span></div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;         <span class="stringliteral">&quot;BridgePriority: %u\r\n&quot;</span></div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;         <span class="stringliteral">&quot;BridgeSuspended: %s\r\n&quot;</span></div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;         <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;         cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, type, cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">preference</a>, <a class="code" href="../../d6/d90/strings_8h.html#ab7cad97bd640223a24b4bd60ef0e406f">AST_YESNO</a>(cur-&gt;<a class="code" href="../../d1/d04/structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">suspended</a>),</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(id_text));</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;      ++num_items;</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;   }</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../da/de0/structbridge__technologies.html">bridge_technologies</a>);</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;BridgeTechnologyListComplete&quot;</span>, num_items);</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;}</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;<span class="comment"> * \brief Print bridge object key (name).</span></div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;<span class="comment"> * \param v_obj A pointer to the object we want the key printed.</span></div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;<span class="comment"> * \param where User data needed by prnt to determine where to put output.</span></div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;<span class="comment"> * \param prnt Print output callback function to use.</span></div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05573"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a8606c6b215281e80fa17d6906801d58a"> 5573</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#a8606c6b215281e80fa17d6906801d58a">bridge_prnt_obj</a>(<span class="keywordtype">void</span> *v_obj, <span class="keywordtype">void</span> *where, <a class="code" href="../../d5/da5/astobj2_8h.html#af236ed10cd1eddcbad0579ed0cf9f4c5">ao2_prnt_fn</a> *prnt)</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;{</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a> = v_obj;</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;   <span class="keywordflow">if</span> (!bridge) {</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;   }</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;   prnt(where, <span class="stringliteral">&quot;%s %s chans:%u&quot;</span>,</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;      bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">v_table</a>-&gt;<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">num_channels</a>);</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;}</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;<span class="comment"> * \brief Shutdown the bridging system.  Stuff to do on graceful shutdown.</span></div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;<span class="comment"> * \since 13.3.0</span></div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05591"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#abe2f8f730a9efcb2fb767364fa845ff9"> 5591</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d0/d95/bridge_8c.html#abe2f8f730a9efcb2fb767364fa845ff9">bridge_cleanup</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;{</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;BridgeTechnologyList&quot;</span>);</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;BridgeTechnologySuspend&quot;</span>);</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;BridgeTechnologyUnsuspend&quot;</span>);</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(bridge_cli, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(bridge_cli));</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a4b8c1cca9dace1cf1bbadc5039f3dedf">ao2_container_unregister</a>(<span class="stringliteral">&quot;bridges&quot;</span>);</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(bridges);</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;   bridges = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(bridge_manager);</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;   bridge_manager = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;}</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;</div><div class="line"><a name="l05605"></a><span class="lineno"><a class="line" href="../../d0/d95/bridge_8c.html#a0ba7af47c666f5190ba798f4045bf041"> 5605</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d0/d95/bridge_8c.html#a0ba7af47c666f5190ba798f4045bf041">ast_bridging_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;{</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d0/d95/bridge_8c.html#abe2f8f730a9efcb2fb767364fa845ff9">bridge_cleanup</a>);</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d4e/stasis__bridges_8h.html#ae301dc233829a0e07fd9747738636a72">ast_stasis_bridging_init</a>()) {</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;   }</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;   bridge_manager = <a class="code" href="../../d0/d95/bridge_8c.html#a9ad5bc80833f85bf5a18dbac95094691">bridge_manager_create</a>();</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;   <span class="keywordflow">if</span> (!bridge_manager) {</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;   }</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;</div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;   bridges = <a class="code" href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>,</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520acadb2bfd83bc54a380d86d3a9b02d99c35">AO2_CONTAINER_ALLOC_OPT_DUPS_REPLACE</a>, <a class="code" href="../../d0/d95/bridge_8c.html#a4c2435b74d16e617f7213dda3c25ffd7">bridge_sort_cmp</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;   <span class="keywordflow">if</span> (!bridges) {</div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;   }</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a>(<span class="stringliteral">&quot;bridges&quot;</span>, bridges, <a class="code" href="../../d0/d95/bridge_8c.html#a8606c6b215281e80fa17d6906801d58a">bridge_prnt_obj</a>);</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;   <a class="code" href="../../d4/d1e/bridge__basic_8h.html#a3f1a21eacbeaae5e19048c291956799b">ast_bridging_init_basic</a>();</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(bridge_cli, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(bridge_cli));</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;</div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;BridgeTechnologyList&quot;</span>, 0, <a class="code" href="../../d0/d95/bridge_8c.html#a15a9caea3551b28025d36c0d0ca885e9">manager_bridge_tech_list</a>);</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;BridgeTechnologySuspend&quot;</span>, 0, <a class="code" href="../../d0/d95/bridge_8c.html#a355daedbe9708a185e0439e47476635d">manager_bridge_tech_suspend</a>);</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;BridgeTechnologyUnsuspend&quot;</span>, 0, <a class="code" href="../../d0/d95/bridge_8c.html#a3e507358824dd355399b94c389762da3">manager_bridge_tech_unsuspend</a>);</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;}</div><div class="ttc" id="structast__bridge__hook__timer__parms_html_aac99560397aa1e3e12367419ed305d11"><div class="ttname"><a href="../../d1/dad/structast__bridge__hook__timer__parms.html#aac99560397aa1e3e12367419ed305d11">ast_bridge_hook_timer_parms::seqno</a></div><div class="ttdeci">unsigned int seqno</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00247">bridge_features.h:247</a></div></div>
<div class="ttc" id="bridge_8c_html_afd2c9505e0edcb47e18669f60500acf0"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#afd2c9505e0edcb47e18669f60500acf0">FORMAT_HDR</a></div><div class="ttdeci">#define FORMAT_HDR</div></div>
<div class="ttc" id="channel_8h_html_ac2dc872b606534943c98304aed841b34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a></div><div class="ttdeci">struct ast_party_caller * ast_channel_caller(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00888">channel_internal_api.c:888</a></div></div>
<div class="ttc" id="structast__datastore__info_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d9/dfb/structast__datastore__info.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_datastore_info::type</a></div><div class="ttdeci">const char * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00032">datastore.h:32</a></div></div>
<div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structbridge__channel__impart__cond_html"><div class="ttname"><a href="../../d5/df4/structbridge__channel__impart__cond.html">bridge_channel_impart_cond</a></div><div class="ttdoc">Internal bridge impart wait condition and associated conditional. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01515">bridge.c:1515</a></div></div>
<div class="ttc" id="channel_8h_html_a41082b7d1c406087d152d8f40812b7a2"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a41082b7d1c406087d152d8f40812b7a2">ast_channel_internal_bridge_channel_set</a></div><div class="ttdeci">void ast_channel_internal_bridge_channel_set(struct ast_channel *chan, struct ast_bridge_channel *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01255">channel_internal_api.c:1255</a></div></div>
<div class="ttc" id="bridge_8c_html_a32767ed0f51795590f41a662523c88b0"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a32767ed0f51795590f41a662523c88b0">ast_bridge_base_new</a></div><div class="ttdeci">struct ast_bridge * ast_bridge_base_new(uint32_t capabilities, unsigned int flags, const char *creator, const char *name, const char *id)</div><div class="ttdoc">Create a new base class bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00960">bridge.c:960</a></div></div>
<div class="ttc" id="bridge_8h_html_a815c9b3e933dfd4b8f523cf55caa5bbfaec2d0fff3f4f8df0d9ef6b4d9be78380"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaec2d0fff3f4f8df0d9ef6b4d9be78380">AST_BRIDGE_CAPABILITY_NATIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00090">bridge.h:90</a></div></div>
<div class="ttc" id="bridge_8c_html_a3e9bdb7b62b531f001b7dcb5c39b3551"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3e9bdb7b62b531f001b7dcb5c39b3551">ast_bridge_interval_hook</a></div><div class="ttdeci">int ast_bridge_interval_hook(struct ast_bridge_features *features, enum ast_bridge_hook_timer_option flags, unsigned int interval, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach an interval hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03382">bridge.c:3382</a></div></div>
<div class="ttc" id="bridge_8c_html_adf0e64783980f762008ac238f2dbe715"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#adf0e64783980f762008ac238f2dbe715">bridge_alloc</a></div><div class="ttdeci">struct ast_bridge * bridge_alloc(size_t size, const struct ast_bridge_methods *v_table)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00724">bridge.c:724</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structmerge__direction_html"><div class="ttname"><a href="../../d0/ddf/structmerge__direction.html">merge_direction</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02182">bridge.c:2182</a></div></div>
<div class="ttc" id="bridge_8c_html_a64d0fdf87038032f7f5032752114e0ef"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a64d0fdf87038032f7f5032752114e0ef">bridge_move_locked</a></div><div class="ttdeci">static int bridge_move_locked(struct ast_bridge *dst_bridge, struct ast_bridge *src_bridge, struct ast_channel *chan, struct ast_channel *swap, int attempt_recovery)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02447">bridge.c:2447</a></div></div>
<div class="ttc" id="channel_8h_html_abf514b9d96a1821a33fec8c64ee4e26f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a></div><div class="ttdeci">void ast_party_connected_line_init(struct ast_party_connected_line *init)</div><div class="ttdoc">Initialize the given connected line structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02022">channel.c:2022</a></div></div>
<div class="ttc" id="bridge_8h_html_a186f44efd65f1349ca2deb11b8117534a19fe1f0ca6993cc12c518aa09fb79a79"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a19fe1f0ca6993cc12c518aa09fb79a79">AST_BRIDGE_OPTIMIZE_PROHIBITED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00901">bridge.h:901</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_adbc20a2fd50bb1376a3c6094e96a31e3"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#adbc20a2fd50bb1376a3c6094e96a31e3">ast_bridge_snapshot::channels</a></div><div class="ttdeci">struct ao2_container * channels</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00339">bridge.h:339</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="structnode_html"><div class="ttname"><a href="../../d5/da1/structnode.html">node</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2b/test__heap_8c_source.html#l00038">test_heap.c:38</a></div></div>
<div class="ttc" id="core__local_8h_html"><div class="ttname"><a href="../../d5/da6/core__local_8h.html">core_local.h</a></div><div class="ttdoc">Local proxy channel special access. </div></div>
<div class="ttc" id="musiconhold_8h_html"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html">musiconhold.h</a></div><div class="ttdoc">Music on hold handling. </div></div>
<div class="ttc" id="structast__bridge__channel_html_ab1fa9a8c0210d018531c277982b76b44"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#ab1fa9a8c0210d018531c277982b76b44">ast_bridge_channel::activity</a></div><div class="ttdeci">enum bridge_channel_thread_state activity</div><div class="ttdoc">The bridge channel thread activity. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00160">bridge_channel.h:160</a></div></div>
<div class="ttc" id="cli_8h_html_a5c4130cf8f1e93acfdd84416cebf1aef"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a></div><div class="ttdeci">#define AST_CLI_DEFINE(fn, txt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00197">cli.h:197</a></div></div>
<div class="ttc" id="bridge_8c_html_aede8649d94e9e3a148e80d31a2e5a4e9"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aede8649d94e9e3a148e80d31a2e5a4e9">handle_bridge_show_specific</a></div><div class="ttdeci">static char * handle_bridge_show_specific(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05157">bridge.c:5157</a></div></div>
<div class="ttc" id="stasis__cache__pattern_8h_html"><div class="ttname"><a href="../../d3/d8f/stasis__cache__pattern_8h.html">stasis_cache_pattern.h</a></div><div class="ttdoc">Caching pattern for Stasis Message Bus API topics. </div></div>
<div class="ttc" id="channel_8h_html_ab380c81e4514ab48ca8402f7950a354a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab380c81e4514ab48ca8402f7950a354a">ast_connected_line_build_data</a></div><div class="ttdeci">int ast_connected_line_build_data(unsigned char *data, size_t datalen, const struct ast_party_connected_line *connected, const struct ast_set_party_connected_line *update)</div><div class="ttdoc">Build the connected line information data frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08793">channel.c:8793</a></div></div>
<div class="ttc" id="bridge_8c_html_a02bd31522656ae0e86ec0d4cfdace1b1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a02bd31522656ae0e86ec0d4cfdace1b1">ast_bridge_set_remb_estimated_bitrate</a></div><div class="ttdeci">void ast_bridge_set_remb_estimated_bitrate(struct ast_bridge *bridge, float estimated_bitrate)</div><div class="ttdoc">Force the REMB report estimated bitrate to a specific max value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03874">bridge.c:3874</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a417ee8a61074ec7570971202908e2c4f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a417ee8a61074ec7570971202908e2c4f">ast_frdup</a></div><div class="ttdeci">#define ast_frdup(fr)</div><div class="ttdoc">Copies a frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00585">include/asterisk/frame.h:585</a></div></div>
<div class="ttc" id="structast__bridge__hook__timer__parms_html_a23545cd41cdc93998f5b3caeb3e29936"><div class="ttname"><a href="../../d1/dad/structast__bridge__hook__timer__parms.html#a23545cd41cdc93998f5b3caeb3e29936">ast_bridge_hook_timer_parms::interval</a></div><div class="ttdeci">unsigned int interval</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00245">bridge_features.h:245</a></div></div>
<div class="ttc" id="bridge_8c_html_a17dab193f18bf5abfd10c00735925e28"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a17dab193f18bf5abfd10c00735925e28">bridge_channel_impart_ds_head_signal</a></div><div class="ttdeci">static void bridge_channel_impart_ds_head_signal(struct bridge_channel_impart_ds_head *ds_head)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01536">bridge.c:1536</a></div></div>
<div class="ttc" id="astobj2_8h_html_abd9eeaf9633f630d7588f6a7de7b9fbe"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abd9eeaf9633f630d7588f6a7de7b9fbe">ao2_t_cleanup</a></div><div class="ttdeci">#define ao2_t_cleanup(obj, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01959">astobj2.h:1959</a></div></div>
<div class="ttc" id="structmessage_html"><div class="ttname"><a href="../../d8/d9e/structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00144">manager.h:144</a></div></div>
<div class="ttc" id="bridge_8c_html_a5a2fef16c6520d265d7f81002eb96ee7"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a5a2fef16c6520d265d7f81002eb96ee7">ast_bridge_base_v_table</a></div><div class="ttdeci">struct ast_bridge_methods ast_bridge_base_v_table</div><div class="ttdoc">Bridge base class virtual method table. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00949">bridge.c:949</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8f8162f42b84a7eba37bfb551c31743b">AST_BRIDGE_FLAG_SMART</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00041">bridge_features.h:41</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3ad2f7e2bea8dd898409ef3166cb60543f"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ad2f7e2bea8dd898409ef3166cb60543f">AST_BRIDGE_HOOK_TYPE_TALK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00196">bridge_features.h:196</a></div></div>
<div class="ttc" id="bridge_8c_html_a47aa4de3736ec9da5831351848e6522d"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a47aa4de3736ec9da5831351848e6522d">ast_bridge_talk_detector_hook</a></div><div class="ttdeci">int ast_bridge_talk_detector_hook(struct ast_bridge_features *features, ast_bridge_talking_indicate_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach a bridge channel talk detection hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03358">bridge.c:3358</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a1d2fbb74f819b904b199bc02307fed7e"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a1d2fbb74f819b904b199bc02307fed7e">ast_bridge_run_after_goto</a></div><div class="ttdeci">void ast_bridge_run_after_goto(struct ast_channel *chan)</div><div class="ttdoc">Run a PBX on any after bridge goto location. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00537">bridge_after.c:537</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a298ce3dfc9b5b8a8351e8ed103aa7e5c"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a298ce3dfc9b5b8a8351e8ed103aa7e5c">ast_bridge_snapshot::creationtime</a></div><div class="ttdeci">struct timeval creationtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00351">bridge.h:351</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html_ab6103ad1bbc12922f93c0526204573cf"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">ast_channel_snapshot::base</a></div><div class="ttdeci">struct ast_channel_snapshot_base * base</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00146">stasis_channels.h:146</a></div></div>
<div class="ttc" id="lock_8h_html"><div class="ttname"><a href="../../dd/d42/lock_8h.html">lock.h</a></div><div class="ttdoc">Asterisk locking-related definitions: </div></div>
<div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="bridge_8h_html_a04a2852f4166568323aa33cd3d0158c7"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a04a2852f4166568323aa33cd3d0158c7">ast_bridge_lock_both</a></div><div class="ttdeci">#define ast_bridge_lock_both(bridge1, bridge2)</div><div class="ttdoc">Lock two bridges. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00500">bridge.h:500</a></div></div>
<div class="ttc" id="stasis__channels_8h_html"><div class="ttname"><a href="../../d9/d4a/stasis__channels_8h.html">stasis_channels.h</a></div></div>
<div class="ttc" id="asterisk_8h_html"><div class="ttname"><a href="../../db/db2/asterisk_8h.html">asterisk.h</a></div><div class="ttdoc">Asterisk main include file. File version handling, generic pbx functions. </div></div>
<div class="ttc" id="structast__bridge_html_af15c2e8b6df8ce0bf570af18aa890deb"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#af15c2e8b6df8ce0bf570af18aa890deb">ast_bridge::feature_flags</a></div><div class="ttdeci">struct ast_flags feature_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00377">bridge.h:377</a></div></div>
<div class="ttc" id="linkedlists_8h_html_adf1959c5c03a3a706da97ad2f49617e5"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a></div><div class="ttdeci">#define AST_LIST_FIRST(head)</div><div class="ttdoc">Returns the first entry contained in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00420">linkedlists.h:420</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a20c565f2b4f6dd680b2fa04f8d74f3c4"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a20c565f2b4f6dd680b2fa04f8d74f3c4">ast_blind_transfer_message_create</a></div><div class="ttdeci">struct ast_blind_transfer_message * ast_blind_transfer_message_create(int is_external, struct ast_channel *transferer, const char *exten, const char *context)</div><div class="ttdoc">Create a blind transfer message to be published. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00929">stasis_bridges.c:929</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01121">bridge.h:1121</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html">stasis_bridges.h</a></div></div>
<div class="ttc" id="structast__bridge_html_a753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">ast_bridge::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00409">bridge.h:409</a></div></div>
<div class="ttc" id="astobj2_8h_html_a512cc40ce96c63b3d5c78040baa4c9cd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a></div><div class="ttdeci">int ao2_container_count(struct ao2_container *c)</div><div class="ttdoc">Returns the number of elements in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00034">astobj2_container.c:34</a></div></div>
<div class="ttc" id="bridge_8c_html_a34a177a8cf79f8158638ebf6ae05ac1c"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a34a177a8cf79f8158638ebf6ae05ac1c">ast_bridge_set_sfu_video_mode</a></div><div class="ttdeci">void ast_bridge_set_sfu_video_mode(struct ast_bridge *bridge)</div><div class="ttdoc">Set the bridge to be a selective forwarding unit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03841">bridge.c:3841</a></div></div>
<div class="ttc" id="structbridge__channel__impart__cond_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d5/df4/structbridge__channel__impart__cond.html#adf04f66344e3fb0a6f6a69bf39d19902">bridge_channel_impart_cond::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01518">bridge.c:1518</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a65633fdc6178dc8d9f754fda0166d16e"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">ast_bridge_channel::features</a></div><div class="ttdeci">struct ast_bridge_features * features</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00132">bridge_channel.h:132</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00045">bridge_features.h:45</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_adadb2f6b306233caecdabcf1a7440b0aad8d415b984f05d05f9295fb6cbee3004"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#adadb2f6b306233caecdabcf1a7440b0aad8d415b984f05d05f9295fb6cbee3004">BRIDGE_CHANNEL_ACTION_DEFERRED_DISSOLVING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dfc/bridge__channel__internal_8h_source.html#l00070">bridge_channel_internal.h:70</a></div></div>
<div class="ttc" id="bridge_8c_html_a0ba7af47c666f5190ba798f4045bf041"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a0ba7af47c666f5190ba798f4045bf041">ast_bridging_init</a></div><div class="ttdeci">int ast_bridging_init(void)</div><div class="ttdoc">Initialize the bridging system. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05605">bridge.c:5605</a></div></div>
<div class="ttc" id="core__unreal_8h_html_abc6dcce8e64173a023700dd4288d7c97add17eccb0c0c8596b9327fd0fad20742"><div class="ttname"><a href="../../de/dea/core__unreal_8h.html#abc6dcce8e64173a023700dd4288d7c97add17eccb0c0c8596b9327fd0fad20742">AST_UNREAL_OWNER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00050">core_unreal.h:50</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structast__bridge__hook__timer_html"><div class="ttname"><a href="../../dd/df3/structast__bridge__hook__timer.html">ast_bridge_hook_timer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00253">bridge_features.h:253</a></div></div>
<div class="ttc" id="bridge__features_8h_html_ad5b20a96dee3042c8cb23d45f7a93f79"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#ad5b20a96dee3042c8cb23d45f7a93f79">ast_bridge_talking_indicate_callback</a></div><div class="ttdeci">int(* ast_bridge_talking_indicate_callback)(struct ast_bridge_channel *bridge_channel, void *hook_pvt, int talking)</div><div class="ttdoc">Talking indicator callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00160">bridge_features.h:160</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="bridge_8h_html_ab388dac5f5c172d7f03c54487afac906"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906">ast_bridge_video_mode_type</a></div><div class="ttdeci">ast_bridge_video_mode_type</div><div class="ttdoc">Video source modes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00098">bridge.h:98</a></div></div>
<div class="ttc" id="structast__bridge_html_a4d514eabb35f71dee132ef1df1c6cdbb"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a4d514eabb35f71dee132ef1df1c6cdbb">ast_bridge::num_active</a></div><div class="ttdeci">unsigned int num_active</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00383">bridge.h:383</a></div></div>
<div class="ttc" id="structast__bridge__video__sfu__data_html_a18f4bab7feee48c373dfcbea33a99e8d"><div class="ttname"><a href="../../dd/df9/structast__bridge__video__sfu__data.html#a18f4bab7feee48c373dfcbea33a99e8d">ast_bridge_video_sfu_data::estimated_bitrate</a></div><div class="ttdeci">float estimated_bitrate</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00155">bridge.h:155</a></div></div>
<div class="ttc" id="structast__module_html"><div class="ttname"><a href="../../d9/df5/structast__module.html">ast_module</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d96/loader_8c_source.html#l00293">loader.c:293</a></div></div>
<div class="ttc" id="bridge_8c_html_ad4452a1fe505c3785b5f72f61231ad38"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad4452a1fe505c3785b5f72f61231ad38">ast_bridge_features_enable</a></div><div class="ttdeci">int ast_bridge_features_enable(struct ast_bridge_features *features, enum ast_bridge_builtin_feature feature, const char *dtmf, void *config, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Enable a built in feature on a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03428">bridge.c:3428</a></div></div>
<div class="ttc" id="bridge_8c_html_abfc1433d64d6a616081e96845af349e3"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#abfc1433d64d6a616081e96845af349e3">bridge_channel_change_bridge</a></div><div class="ttdeci">static void bridge_channel_change_bridge(struct ast_bridge_channel *bridge_channel, struct ast_bridge *new_bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02055">bridge.c:2055</a></div></div>
<div class="ttc" id="structbridge__manager__controller_html_a111277a0849f92b793ed6aa1efe54462"><div class="ttname"><a href="../../d4/d7c/structbridge__manager__controller.html#a111277a0849f92b793ed6aa1efe54462">bridge_manager_controller::stop</a></div><div class="ttdeci">unsigned int stop</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00168">bridge.c:168</a></div></div>
<div class="ttc" id="bridge_8c_html_a4090d7655fc829efc4a37a3144759c7c"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a4090d7655fc829efc4a37a3144759c7c">FORMAT_ROW</a></div><div class="ttdeci">#define FORMAT_ROW</div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_a447f05a7615581929349765430257a75"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#a447f05a7615581929349765430257a75">bridge_channel_internal_suspend_nolock</a></div><div class="ttdeci">void bridge_channel_internal_suspend_nolock(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00854">bridge_channel.c:854</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a39918fd433ac42184b152c86016ef139"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a39918fd433ac42184b152c86016ef139">AST_RWLIST_HEAD_STATIC</a></div><div class="ttdeci">#define AST_RWLIST_HEAD_STATIC(name, type)</div><div class="ttdoc">Defines a structure to be used to hold a read/write list of specified type, statically initialized...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00332">linkedlists.h:332</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a01f75a9ad916f63a94e06a27635ba278">ast_bridge_channel::thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00118">bridge_channel.h:118</a></div></div>
<div class="ttc" id="structast__bridge__hook__timer__parms_html_a3546d0f5f096b6f63f437c3d24b51d47"><div class="ttname"><a href="../../d1/dad/structast__bridge__hook__timer__parms.html#a3546d0f5f096b6f63f437c3d24b51d47">ast_bridge_hook_timer_parms::trip_time</a></div><div class="ttdeci">struct timeval trip_time</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00241">bridge_features.h:241</a></div></div>
<div class="ttc" id="bridge_8c_html_abe2f8f730a9efcb2fb767364fa845ff9"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#abe2f8f730a9efcb2fb767364fa845ff9">bridge_cleanup</a></div><div class="ttdeci">static void bridge_cleanup(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05591">bridge.c:5591</a></div></div>
<div class="ttc" id="core__unreal_8h_html_ad55f22267e8737cc26281d7d3c6f8bc2"><div class="ttname"><a href="../../de/dea/core__unreal_8h.html#ad55f22267e8737cc26281d7d3c6f8bc2">AST_UNREAL_OPTIMIZE_BEGUN</a></div><div class="ttdeci">#define AST_UNREAL_OPTIMIZE_BEGUN</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00110">core_unreal.h:110</a></div></div>
<div class="ttc" id="bridge_8c_html_acf7de35a81822873b105c08e1c22826f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#acf7de35a81822873b105c08e1c22826f">ast_bridge_transfer_acquire_bridge</a></div><div class="ttdeci">struct ast_bridge * ast_bridge_transfer_acquire_bridge(struct ast_channel *chan)</div><div class="ttdoc">Acquire the channel&amp;#39;s bridge for transfer purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04460">bridge.c:4460</a></div></div>
<div class="ttc" id="bridge_8c_html_a2a5f82dc1174da37bb753d991858ce79"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a2a5f82dc1174da37bb753d991858ce79">handle_bridge_destroy_specific</a></div><div class="ttdeci">static char * handle_bridge_destroy_specific(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05206">bridge.c:5206</a></div></div>
<div class="ttc" id="bridge_8c_html_a446fdf2b4bc50dd4cf7325c6b01c075c"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a446fdf2b4bc50dd4cf7325c6b01c075c">ast_bridge_peer_nolock</a></div><div class="ttdeci">struct ast_channel * ast_bridge_peer_nolock(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">Get the channel&amp;#39;s bridge peer only if the bridge is two-party. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04114">bridge.c:4114</a></div></div>
<div class="ttc" id="bridge_8c_html_a92647c50f3371f83be09ba7a75cceda4"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a92647c50f3371f83be09ba7a75cceda4">try_swap_optimize_out</a></div><div class="ttdeci">static int try_swap_optimize_out(struct ast_bridge *chan_bridge, struct ast_bridge_channel *chan_bridge_channel, struct ast_bridge *peer_bridge, struct ast_bridge_channel *peer_bridge_channel, struct ast_unreal_pvt *pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02793">bridge.c:2793</a></div></div>
<div class="ttc" id="bridge_8h_html_ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906ac9992c5dc76155a013d0a5804c8f2bb7">AST_BRIDGE_VIDEO_MODE_SFU</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00109">bridge.h:109</a></div></div>
<div class="ttc" id="uuid_8h_html_a127408e53d34dca0c589a099fabf1e13"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a></div><div class="ttdeci">#define AST_UUID_STR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d1d/uuid_8h_source.html#l00027">uuid.h:27</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html">ast_attended_transfer_message</a></div><div class="ttdoc">Message representing attended transfer. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00319">stasis_bridges.h:319</a></div></div>
<div class="ttc" id="bridge_8c_html_a23798c50211d265d47aaba3e71953237"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a23798c50211d265d47aaba3e71953237">handle_bridge_kick_channel</a></div><div class="ttdeci">static char * handle_bridge_kick_channel(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05269">bridge.c:5269</a></div></div>
<div class="ttc" id="bridge_8c_html_a6a9673fffe77cabb9e79c12852baae2f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a6a9673fffe77cabb9e79c12852baae2f">bridge_hook_generic</a></div><div class="ttdeci">static struct ast_bridge_hook * bridge_hook_generic(size_t size, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03225">bridge.c:3225</a></div></div>
<div class="ttc" id="bridge_8c_html_a8690315fd0d12e16671f9d22eacfa8f0"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a8690315fd0d12e16671f9d22eacfa8f0">bridge_register</a></div><div class="ttdeci">struct ast_bridge * bridge_register(struct ast_bridge *bridge)</div><div class="ttdoc">Register the new bridge with the system. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00709">bridge.c:709</a></div></div>
<div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="parking_8h_html"><div class="ttname"><a href="../../d2/d33/parking_8h.html">parking.h</a></div><div class="ttdoc">Call Parking API. </div></div>
<div class="ttc" id="bridge_8c_html_a52be65600729342154b0dae671f1030a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a52be65600729342154b0dae671f1030a">check_bridge_play_sounds</a></div><div class="ttdeci">static void check_bridge_play_sounds(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01233">bridge.c:1233</a></div></div>
<div class="ttc" id="utils_8h_html_a832647380b1f97e7ac1b4492f8816d46"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a></div><div class="ttdeci">#define ast_pthread_create_detached(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00563">utils.h:563</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ab37a1835212d045dcfe7ef7f25eb5e31"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ab37a1835212d045dcfe7ef7f25eb5e31">ast_bridge_channel_leave_bridge_nolock</a></div><div class="ttdeci">void ast_bridge_channel_leave_bridge_nolock(struct ast_bridge_channel *bridge_channel, enum bridge_channel_state new_state, int cause)</div><div class="ttdoc">Set bridge channel state to leave bridge (if not leaving already). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00292">bridge_channel.c:292</a></div></div>
<div class="ttc" id="structast__bridge__video__sfu__data_html_a0a1c43a89347238ad53bdaa7f733a014"><div class="ttname"><a href="../../dd/df9/structast__bridge__video__sfu__data.html#a0a1c43a89347238ad53bdaa7f733a014">ast_bridge_video_sfu_data::remb_send_interval</a></div><div class="ttdeci">unsigned int remb_send_interval</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00151">bridge.h:151</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a0394614533c00a6ac5483fbb14bae4d5"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a0394614533c00a6ac5483fbb14bae4d5">ast_bridge_move_indicate_callback</a></div><div class="ttdeci">int(* ast_bridge_move_indicate_callback)(struct ast_bridge_channel *bridge_channel, void *hook_pvt, struct ast_bridge *src, struct ast_bridge *dst)</div><div class="ttdoc">Move indicator callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00178">bridge_features.h:178</a></div></div>
<div class="ttc" id="bridge_8c_html_a86532569e14381b173afcbf4e5a3c4cb"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a86532569e14381b173afcbf4e5a3c4cb">bridge_channel_impart_ds_info</a></div><div class="ttdeci">static const struct ast_datastore_info bridge_channel_impart_ds_info</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01576">bridge.c:1576</a></div></div>
<div class="ttc" id="structast__bridge__features_html"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a></div><div class="ttdoc">Structure that contains features information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00263">bridge_features.h:263</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="bridge_8h_html_ac086b7d74fb40c2ede8514274585b101a99da763f0bd676f299a215ea9d1055db"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101a99da763f0bd676f299a215ea9d1055db">AST_BRIDGE_IMPART_CHAN_MASK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00600">bridge.h:600</a></div></div>
<div class="ttc" id="channel_8h_html_ab733a7825810b895a89b629e0ea89380"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a></div><div class="ttdeci">#define ast_channel_unref(c)</div><div class="ttdoc">Decrease channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02981">channel.h:2981</a></div></div>
<div class="ttc" id="bridge_8c_html_a3d37f3df31f68efc380c63b999db43f0"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3d37f3df31f68efc380c63b999db43f0">ast_bridge_features_limits_construct</a></div><div class="ttdeci">int ast_bridge_features_limits_construct(struct ast_bridge_features_limits *limits)</div><div class="ttdoc">Constructor function for ast_bridge_features_limits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03459">bridge.c:3459</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a1949ac2d3f4b2113242d981cc315b451"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a1949ac2d3f4b2113242d981cc315b451">ast_bridge_publish_attended_transfer</a></div><div class="ttdeci">void ast_bridge_publish_attended_transfer(struct ast_attended_transfer_message *transfer_msg)</div><div class="ttdoc">Publish an attended transfer. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01346">stasis_bridges.c:1346</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a7e482bb2dcffd792205f114ddfa098fb"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a7e482bb2dcffd792205f114ddfa098fb">ast_bridge_channel_kick</a></div><div class="ttdeci">void ast_bridge_channel_kick(struct ast_bridge_channel *bridge_channel, int cause)</div><div class="ttdoc">Kick the channel out of the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00605">bridge_channel.c:605</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a173b4026818e079f4ad64dcb090863b0"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a173b4026818e079f4ad64dcb090863b0">AST_BRIDGE_FLAG_SWAP_INHIBIT_TO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00049">bridge_features.h:49</a></div></div>
<div class="ttc" id="structbridge__manager__request_html_a3ed9421e7d90ae54555fbcf4bc96d2b4"><div class="ttname"><a href="../../db/d89/structbridge__manager__request.html#a3ed9421e7d90ae54555fbcf4bc96d2b4">bridge_manager_request::node</a></div><div class="ttdeci">struct bridge_manager_request::@347 node</div></div>
<div class="ttc" id="structast__blind__transfer__message_html"><div class="ttname"><a href="../../d1/dbf/structast__blind__transfer__message.html">ast_blind_transfer_message</a></div><div class="ttdoc">Message published during a blind transfer. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00249">stasis_bridges.h:249</a></div></div>
<div class="ttc" id="bridge_8c_html_a38f4247405eaab60923cde924be8162e"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a38f4247405eaab60923cde924be8162e">bridge_manager_service</a></div><div class="ttdeci">static void bridge_manager_service(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04923">bridge.c:4923</a></div></div>
<div class="ttc" id="channel_8h_html_aef2af15a597c948e97628da6c5c84f28"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a></div><div class="ttdeci">int ast_indicate(struct ast_channel *chan, int condition)</div><div class="ttdoc">Indicates condition of channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04322">channel.c:4322</a></div></div>
<div class="ttc" id="structast__bridge__hook__timer__parms_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../d1/dad/structast__bridge__hook__timer__parms.html#ac92588540e8c1d014a08cd8a45462b19">ast_bridge_hook_timer_parms::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00249">bridge_features.h:249</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="bridge__features_8h_html_adb39f3c49f940cca855ef8ae3dfc5f77a29fbd7797e61564f5f40c3361e7f4fc2"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a29fbd7797e61564f5f40c3361e7f4fc2">AST_BRIDGE_CHANNEL_FLAG_LONELY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00065">bridge_features.h:65</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="structast__unreal__pvt_html_a8e2a12ecf414fe4b30130e7d7e23708a"><div class="ttname"><a href="../../d6/df3/structast__unreal__pvt.html#a8e2a12ecf414fe4b30130e7d7e23708a">ast_unreal_pvt::callbacks</a></div><div class="ttdeci">struct ast_unreal_pvt_callbacks * callbacks</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00092">core_unreal.h:92</a></div></div>
<div class="ttc" id="bridge_8c_html_a99f699e128b44c627baa3587d99a0661"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a99f699e128b44c627baa3587d99a0661">destroy_bridge</a></div><div class="ttdeci">static void destroy_bridge(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00658">bridge.c:658</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a41510c1f43cb3401f5c7c88d9c9a8d11"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11">ast_bridge_hook_remove_flags</a></div><div class="ttdeci">ast_bridge_hook_remove_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00181">bridge_features.h:181</a></div></div>
<div class="ttc" id="heap_8h_html_a44306afd9b32c0eedae9b559f13a2c5b"><div class="ttname"><a href="../../da/ddb/heap_8h.html#a44306afd9b32c0eedae9b559f13a2c5b">ast_heap_unlock</a></div><div class="ttdeci">#define ast_heap_unlock(h)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ddb/heap_8h_source.html#l00248">heap.h:248</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a0a9bea2845810c6891440a012a275a36"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a0a9bea2845810c6891440a012a275a36">ast_bridge_channel_peer</a></div><div class="ttdeci">struct ast_bridge_channel * ast_bridge_channel_peer(struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Get the peer bridge channel of a two party bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00321">bridge_channel.c:321</a></div></div>
<div class="ttc" id="bridge_8c_html_a355daedbe9708a185e0439e47476635d"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a355daedbe9708a185e0439e47476635d">manager_bridge_tech_suspend</a></div><div class="ttdeci">static int manager_bridge_tech_suspend(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05508">bridge.c:5508</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="structast__bridge__softmix_html_ae2a50ae58a79af5e12287b40bf903209"><div class="ttname"><a href="../../d0/d50/structast__bridge__softmix.html#ae2a50ae58a79af5e12287b40bf903209">ast_bridge_softmix::internal_mixing_interval</a></div><div class="ttdeci">unsigned int internal_mixing_interval</div><div class="ttdoc">The mixing interval indicates how quickly softmix mixing should occur to mix audio. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00301">bridge.h:301</a></div></div>
<div class="ttc" id="bridge_8c_html_a5991ed87aa081fe89ca273cd4c029cfa"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a5991ed87aa081fe89ca273cd4c029cfa">try_merge_optimize_out</a></div><div class="ttdeci">static int try_merge_optimize_out(struct ast_bridge *chan_bridge, struct ast_bridge_channel *chan_bridge_channel, struct ast_bridge *peer_bridge, struct ast_bridge_channel *peer_bridge_channel, struct ast_unreal_pvt *pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02917">bridge.c:2917</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00183">bridge_features.h:183</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a3ba70be1910dd4bebfc77dec29ffc43b"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a3ba70be1910dd4bebfc77dec29ffc43b">ast_attended_transfer_message_add_app</a></div><div class="ttdeci">int ast_attended_transfer_message_add_app(struct ast_attended_transfer_message *transfer_msg, const char *app, struct ast_channel *replace_channel)</div><div class="ttdoc">Add details for an attended transfer to an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01313">stasis_bridges.c:1313</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">ast_bridge_methods::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00267">bridge.h:267</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2448088751e4d494d1981c7f4b84e8d0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a></div><div class="ttdeci">#define OBJ_POINTER</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01154">astobj2.h:1154</a></div></div>
<div class="ttc" id="bridge_8c_html_a62e8ca52375a468fe74ec88d1eceea5d"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a62e8ca52375a468fe74ec88d1eceea5d">bridge_merge_locked</a></div><div class="ttdeci">static int bridge_merge_locked(struct ast_bridge *dst_bridge, struct ast_bridge *src_bridge, int merge_best_direction, struct ast_channel **kick_me, unsigned int num_kick)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02264">bridge.c:2264</a></div></div>
<div class="ttc" id="structbridge__technologies_html"><div class="ttname"><a href="../../da/de0/structbridge__technologies.html">bridge_technologies</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00125">bridge.c:125</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_adadb2f6b306233caecdabcf1a7440b0aa00f1087c3c938aa4672d997d16930fb9"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#adadb2f6b306233caecdabcf1a7440b0aa00f1087c3c938aa4672d997d16930fb9">BRIDGE_CHANNEL_ACTION_DEFERRED_TECH_DESTROY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dfc/bridge__channel__internal_8h_source.html#l00068">bridge_channel_internal.h:68</a></div></div>
<div class="ttc" id="bridge_8c_html_a51acc84da704498a59907a46a73aa769"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a51acc84da704498a59907a46a73aa769">bridge_manager_destroy</a></div><div class="ttdeci">static void bridge_manager_destroy(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04977">bridge.c:4977</a></div></div>
<div class="ttc" id="utils_8h_html_ab5033a1f3d781d45e7ccc27598114510"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a></div><div class="ttdeci">#define ast_set_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00070">utils.h:70</a></div></div>
<div class="ttc" id="channel_8h_html_a723ac44c92b9edb6c1a731e01edacb4a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a></div><div class="ttdeci">int ast_check_hangup_locked(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00459">channel.c:459</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="structast__cli__entry_html"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a></div><div class="ttdoc">descriptor for a cli entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00171">cli.h:171</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="bridge_8c_html_a8d0d9f0c35f7276cf481a4da6439b417"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a8d0d9f0c35f7276cf481a4da6439b417">MAX_BRIDGEPEER_CHANS</a></div><div class="ttdeci">#define MAX_BRIDGEPEER_CHANS</div></div>
<div class="ttc" id="bridge_8c_html_abf9e5d393615c63d27e0bd530301a1ed"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#abf9e5d393615c63d27e0bd530301a1ed">ast_bridge_features_new</a></div><div class="ttdeci">struct ast_bridge_features * ast_bridge_features_new(void)</div><div class="ttdoc">Allocate a new bridge features struct. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03750">bridge.c:3750</a></div></div>
<div class="ttc" id="structast__bridge_html_a62f8995a6eac6c8a48205a6f3815d54b"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a62f8995a6eac6c8a48205a6f3815d54b">ast_bridge::callid</a></div><div class="ttdeci">ast_callid callid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00369">bridge.h:369</a></div></div>
<div class="ttc" id="bridge_8c_html_ab9fc36aaff74fae0efd0f683353baa7e"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab9fc36aaff74fae0efd0f683353baa7e">ast_bridges</a></div><div class="ttdeci">struct ao2_container * ast_bridges(void)</div><div class="ttdoc">Returns the global bridges container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00174">bridge.c:174</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="bridge_8c_html_a74e792941ccfcad7b6ba895ec44b2025"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a74e792941ccfcad7b6ba895ec44b2025">bridge_channel_impart_signal</a></div><div class="ttdeci">void bridge_channel_impart_signal(struct ast_channel *chan)</div><div class="ttdoc">Signal imparting threads to wake up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01626">bridge.c:1626</a></div></div>
<div class="ttc" id="bridge_8c_html_a7aecde58434c6cec68d99aae71116f87"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a7aecde58434c6cec68d99aae71116f87">builtin_features_handlers</a></div><div class="ttdeci">static ast_bridge_hook_callback builtin_features_handlers[AST_BRIDGE_BUILTIN_END]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00147">bridge.c:147</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ad52acdbb06c9299895662cf57a4323a3aae37f04db23e9c3e3d350cc34c6476ef"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ad52acdbb06c9299895662cf57a4323a3aae37f04db23e9c3e3d350cc34c6476ef">BRIDGE_CHANNEL_THREAD_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00073">bridge_channel.h:73</a></div></div>
<div class="ttc" id="bridge_8c_html_af611fd393ca26b5fd2a8071867470ffc"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af611fd393ca26b5fd2a8071867470ffc">bridge_find_channel</a></div><div class="ttdeci">struct ast_bridge_channel * bridge_find_channel(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01469">bridge.c:1469</a></div></div>
<div class="ttc" id="bridge_8h_html_a186f44efd65f1349ca2deb11b8117534a2980a16e43b7b4f52b6c3af11bd79a56"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a2980a16e43b7b4f52b6c3af11bd79a56">AST_BRIDGE_OPTIMIZE_MERGE_TO_CHAN_BRIDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00897">bridge.h:897</a></div></div>
<div class="ttc" id="bridge_8c_html_acc33b8d4fe39d089f5987e86e0333617"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#acc33b8d4fe39d089f5987e86e0333617">kick_it</a></div><div class="ttdeci">static void kick_it(struct ast_bridge_channel *bridge_channel, const void *payload, size_t payload_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02020">bridge.c:2020</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html">ast_bridge_snapshot</a></div><div class="ttdoc">Structure that contains a snapshot of information about a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00322">bridge.h:322</a></div></div>
<div class="ttc" id="structast__bridge_html_a9ea77c25c2c57ec45bc6dfdea1c1a228"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a9ea77c25c2c57ec45bc6dfdea1c1a228">ast_bridge::dissolved</a></div><div class="ttdeci">unsigned int dissolved</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00398">bridge.h:398</a></div></div>
<div class="ttc" id="core__local_8h_html_a973a646143d042b91ec6248ea6ba00f1"><div class="ttname"><a href="../../d5/da6/core__local_8h.html#a973a646143d042b91ec6248ea6ba00f1">ast_local_lock_all</a></div><div class="ttdeci">void ast_local_lock_all(struct ast_channel *chan, void **tech_pvt, struct ast_channel **base_chan, struct ast_channel **base_owner)</div><div class="ttdoc">Add a reference to the local channel&amp;#39;s private tech, lock the local channel&amp;#39;s private base...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/core__local_8c_source.html#l00241">core_local.c:241</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a6addef84db409d5d7ba250634555c4c8"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a6addef84db409d5d7ba250634555c4c8">ast_bridge_technology::start</a></div><div class="ttdeci">int(* start)(struct ast_bridge *bridge)</div><div class="ttdoc">Request a bridge technology instance start operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00088">bridge_technology.h:88</a></div></div>
<div class="ttc" id="logger_8h_html_a37b40349d0ef536a0f34b042f7803ab8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a37b40349d0ef536a0f34b042f7803ab8">ast_callid_threadassoc_change</a></div><div class="ttdeci">int ast_callid_threadassoc_change(ast_callid callid)</div><div class="ttdoc">Sets what is stored in the thread storage to the given callid if it does not match what is already th...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/logger_8c_source.html#l01971">logger.c:1971</a></div></div>
<div class="ttc" id="bridge_8c_html_a49108e57ad6d4b850b71f00185ffc366"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a49108e57ad6d4b850b71f00185ffc366">bridge_hook_destroy</a></div><div class="ttdeci">static void bridge_hook_destroy(void *vhook)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03202">bridge.c:3202</a></div></div>
<div class="ttc" id="structast__bridge_html_a41d441063234a215e985a56318a07a6f"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a41d441063234a215e985a56318a07a6f">ast_bridge::reconfigured</a></div><div class="ttdeci">unsigned int reconfigured</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00396">bridge.h:396</a></div></div>
<div class="ttc" id="structast__bridge__softmix_html_ae0ffa389d55fc0dad4678b948a822add"><div class="ttname"><a href="../../d0/d50/structast__bridge__softmix.html#ae0ffa389d55fc0dad4678b948a822add">ast_bridge_softmix::video_mode</a></div><div class="ttdeci">struct ast_bridge_video_mode video_mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00287">bridge.h:287</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3af46f831c14459a9ca7338c3028ca84fb"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3af46f831c14459a9ca7338c3028ca84fb">AST_BRIDGE_HOOK_TYPE_TIMER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00192">bridge_features.h:192</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a47e2e9503f7beb080c820edc385d0ca6"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a47e2e9503f7beb080c820edc385d0ca6">bridge_topics_init</a></div><div class="ttdeci">int bridge_topics_init(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00295">stasis_bridges.c:295</a></div></div>
<div class="ttc" id="structast__bridge_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#ace9168767fc3707cf5f0a7d049682ba3">ast_bridge::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00409">bridge.h:409</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structast__bridge__video__talker__src__data_html_a643b47a3afd64524d2baae9e6f2c7c60"><div class="ttname"><a href="../../d0/dad/structast__bridge__video__talker__src__data.html#a643b47a3afd64524d2baae9e6f2c7c60">ast_bridge_video_talker_src_data::chan_old_vsrc</a></div><div class="ttdeci">struct ast_channel * chan_old_vsrc</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00127">bridge.h:127</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a54eb8725951c786429e4b86d7159309e"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a54eb8725951c786429e4b86d7159309e">ast_bridge_snapshot::video_source_id</a></div><div class="ttdeci">const ast_string_field video_source_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00336">bridge.h:336</a></div></div>
<div class="ttc" id="structast__unreal__pvt_html_a9241175b397dfd032c4cadbc8c9c2d05"><div class="ttname"><a href="../../d6/df3/structast__unreal__pvt.html#a9241175b397dfd032c4cadbc8c9c2d05">ast_unreal_pvt::owner</a></div><div class="ttdeci">struct ast_channel * owner</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00093">core_unreal.h:93</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a8f8f80d37794cde9472343e4487ba3eb">ast_bridge_technology::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00063">bridge_technology.h:63</a></div></div>
<div class="ttc" id="structast__flags_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../dc/dac/structast__flags.html#ac92588540e8c1d014a08cd8a45462b19">ast_flags::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00200">utils.h:200</a></div></div>
<div class="ttc" id="bridge_8c_html_ae6b6b3ffbc54700752cf15b28602e2ba"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae6b6b3ffbc54700752cf15b28602e2ba">bridge_merge_determine_direction</a></div><div class="ttdeci">static struct merge_direction bridge_merge_determine_direction(struct ast_bridge *bridge1, struct ast_bridge *bridge2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02201">bridge.c:2201</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444af791f0352f324b81c3eb1adcedc31364"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444af791f0352f324b81c3eb1adcedc31364">AST_BRIDGE_FLAG_INVISIBLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00057">bridge_features.h:57</a></div></div>
<div class="ttc" id="channel_8h_html_a1b732eb4ed203140b1a3aae9e7dec2c1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1b732eb4ed203140b1a3aae9e7dec2c1">ast_call</a></div><div class="ttdeci">int ast_call(struct ast_channel *chan, const char *addr, int timeout)</div><div class="ttdoc">Make a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06553">channel.c:6553</a></div></div>
<div class="ttc" id="logger_8h_html_a2878d83e36d91850732bad997524e45e"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a></div><div class="ttdeci">#define AST_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00279">logger.h:279</a></div></div>
<div class="ttc" id="bridge_8c_html_a1399f1aff31e752a96eb710a12bf0821"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a1399f1aff31e752a96eb710a12bf0821">two_bridge_attended_transfer</a></div><div class="ttdeci">static enum ast_transfer_result two_bridge_attended_transfer(struct ast_channel *to_transferee, struct ast_bridge_channel *to_transferee_bridge_channel, struct ast_channel *to_transfer_target, struct ast_bridge_channel *to_target_bridge_channel, struct ast_bridge *to_transferee_bridge, struct ast_bridge *to_target_bridge, struct ast_attended_transfer_message *transfer_msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04663">bridge.c:4663</a></div></div>
<div class="ttc" id="bridge_8c_html_a526176b2869c5287b65204cd06b2dfa7"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a526176b2869c5287b65204cd06b2dfa7">bridge_dtmf_hook_sort</a></div><div class="ttdeci">static int bridge_dtmf_hook_sort(const void *obj_left, const void *obj_right, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03606">bridge.c:3606</a></div></div>
<div class="ttc" id="bridge_8c_html_a65e3d013d7b6a10877663ac56f3f443f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a65e3d013d7b6a10877663ac56f3f443f">bridge_channel_impart_ds_head_dtor</a></div><div class="ttdeci">static void bridge_channel_impart_ds_head_dtor(void *doomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01550">bridge.c:1550</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a></div><div class="ttdoc">Structure representing a snapshot of channel state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00145">stasis_channels.h:145</a></div></div>
<div class="ttc" id="bridge_8c_html_acace2c216334d2be31f0323bfc4af2ab"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#acace2c216334d2be31f0323bfc4af2ab">ATTENDEDTRANSFER</a></div><div class="ttdeci">#define ATTENDEDTRANSFER</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00139">bridge.c:139</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0af36653b08c00f5d824ed6046e9233ef9"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0af36653b08c00f5d824ed6046e9233ef9">AST_FRAME_BRIDGE_ACTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00127">include/asterisk/frame.h:127</a></div></div>
<div class="ttc" id="structast__bridge__video__single__src__data_html_af17523bbee86cea3e7c6959258436728"><div class="ttname"><a href="../../dd/dbe/structast__bridge__video__single__src__data.html#af17523bbee86cea3e7c6959258436728">ast_bridge_video_single_src_data::chan_vsrc</a></div><div class="ttdeci">struct ast_channel * chan_vsrc</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00116">bridge.h:116</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a871f4f1d537a1cd524ee8c28b623104f"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a871f4f1d537a1cd524ee8c28b623104f">ast_bridge_channel::state</a></div><div class="ttdeci">enum bridge_channel_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00089">bridge_channel.h:89</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a2862ffde11c780129862e5549415a6f6"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a2862ffde11c780129862e5549415a6f6">ast_bridge_channel::suspended</a></div><div class="ttdeci">unsigned int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00125">bridge_channel.h:125</a></div></div>
<div class="ttc" id="structast__bridge__hook__timer_html_a071aadb15e85b96f455641d6adbfdb71"><div class="ttname"><a href="../../dd/df3/structast__bridge__hook__timer.html#a071aadb15e85b96f455641d6adbfdb71">ast_bridge_hook_timer::generic</a></div><div class="ttdeci">struct ast_bridge_hook generic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00255">bridge_features.h:255</a></div></div>
<div class="ttc" id="bridge_8c_html_a0fa5438fc193ab54b5deb0c80a1ca76f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a0fa5438fc193ab54b5deb0c80a1ca76f">bridge_channel_complete_join</a></div><div class="ttdeci">static void bridge_channel_complete_join(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00443">bridge.c:443</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a165a875b9d5bac3aba4ad54da1861ab3">AST_BRIDGE_FLAG_TRANSFER_BRIDGE_ONLY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00055">bridge_features.h:55</a></div></div>
<div class="ttc" id="structast__bridge__video__talker__src__data_html"><div class="ttname"><a href="../../d0/dad/structast__bridge__video__talker__src__data.html">ast_bridge_video_talker_src_data</a></div><div class="ttdoc">This is used for both SINGLE_SRC_TALKER mode to set what channel should be the current single video f...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00121">bridge.h:121</a></div></div>
<div class="ttc" id="bridge_8c_html_ab0558a802b481dabb4b5c6344fb0c809a3caf33d916f7fcd0541cc595538624ce"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a3caf33d916f7fcd0541cc595538624ce">MERGE_ALLOWED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02867">bridge.c:2867</a></div></div>
<div class="ttc" id="test_8h_html"><div class="ttname"><a href="../../d2/ddc/test_8h.html">test.h</a></div><div class="ttdoc">Test Framework API. </div></div>
<div class="ttc" id="structast__heap_html"><div class="ttname"><a href="../../dc/dec/structast__heap.html">ast_heap</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00036">heap.c:36</a></div></div>
<div class="ttc" id="bridge_8c_html_aae1da0bc376b0767f72e637eca0e0d4b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aae1da0bc376b0767f72e637eca0e0d4b">set_bridge_peer_vars_multiparty</a></div><div class="ttdeci">static void set_bridge_peer_vars_multiparty(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01342">bridge.c:1342</a></div></div>
<div class="ttc" id="bridge_8c_html_adf663a62058148fc5107fceda14b59a9"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#adf663a62058148fc5107fceda14b59a9">bridge_manager_service_req</a></div><div class="ttdeci">static void bridge_manager_service_req(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00188">bridge.c:188</a></div></div>
<div class="ttc" id="bridge__features_8h_html_afcb20166cd7e9581af29556b411b960d"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960d">ast_bridge_builtin_interval</a></div><div class="ttdeci">ast_bridge_builtin_interval</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00110">bridge_features.h:110</a></div></div>
<div class="ttc" id="bridge_8c_html_a49f20b53f75f33385a7254676faa0581"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a49f20b53f75f33385a7254676faa0581">channel_cmp</a></div><div class="ttdeci">static int channel_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04063">bridge.c:4063</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="structast__bridge__features_html_a080125973deec97104866dd31867e3ce"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#a080125973deec97104866dd31867e3ce">ast_bridge_features::usable</a></div><div class="ttdeci">unsigned int usable</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00275">bridge_features.h:275</a></div></div>
<div class="ttc" id="bridge_8c_html_a8606c6b215281e80fa17d6906801d58a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a8606c6b215281e80fa17d6906801d58a">bridge_prnt_obj</a></div><div class="ttdeci">static void bridge_prnt_obj(void *v_obj, void *where, ao2_prnt_fn *prnt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05573">bridge.c:5573</a></div></div>
<div class="ttc" id="bridge_8c_html_a9e4cc8c84fedabfffce3bf9449abc0cd"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a9e4cc8c84fedabfffce3bf9449abc0cd">interval_wrapper_cb</a></div><div class="ttdeci">static int interval_wrapper_cb(struct ast_bridge_channel *bridge_channel, void *obj)</div><div class="ttdoc">Wrapper for interval hooks that calls into the wrapped hook. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03636">bridge.c:3636</a></div></div>
<div class="ttc" id="structast__datastore__info_html"><div class="ttname"><a href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a></div><div class="ttdoc">Structure for a data store type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00031">datastore.h:31</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a></div><div class="ttdeci">ast_channel_state</div><div class="ttdoc">ast_channel states </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00035">channelstate.h:35</a></div></div>
<div class="ttc" id="channel_8h_html_a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2e185ce313026e13ed90ae3a319c9cb7">AST_SOFTHANGUP_DEV</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01122">channel.h:1122</a></div></div>
<div class="ttc" id="bridge__features_8h_html_afcb20166cd7e9581af29556b411b960da38c5af32fcc0a209b338cf6d59650351"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960da38c5af32fcc0a209b338cf6d59650351">AST_BRIDGE_BUILTIN_INTERVAL_LIMITS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00112">bridge_features.h:112</a></div></div>
<div class="ttc" id="heap_8h_html_a66d0a4a9d9e08e704abc44c856407bb8"><div class="ttname"><a href="../../da/ddb/heap_8h.html#a66d0a4a9d9e08e704abc44c856407bb8">ast_heap_destroy</a></div><div class="ttdeci">struct ast_heap * ast_heap_destroy(struct ast_heap *h)</div><div class="ttdoc">Destroy a max heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00146">heap.c:146</a></div></div>
<div class="ttc" id="bridge_8c_html_a395272994b2af7bd55f871b02d2d42e4"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a395272994b2af7bd55f871b02d2d42e4">ast_bridge_features_unregister</a></div><div class="ttdeci">int ast_bridge_features_unregister(enum ast_bridge_builtin_feature feature)</div><div class="ttdoc">Unregister a handler for a built in feature. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03139">bridge.c:3139</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a71189769795dc03db956d60eca08d377"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a71189769795dc03db956d60eca08d377">ast_bridge_technology::stream_topology_changed</a></div><div class="ttdeci">void(* stream_topology_changed)(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Callback for when a stream topology changes on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00192">bridge_technology.h:192</a></div></div>
<div class="ttc" id="bridge_8c_html_a3d742b207de320082b45a7ecb7cff970"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3d742b207de320082b45a7ecb7cff970">hook_remove_match</a></div><div class="ttdeci">static int hook_remove_match(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03508">bridge.c:3508</a></div></div>
<div class="ttc" id="bridge_8c_html_a82fa71a3f3929e6a16bf1dd26d09c18b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a82fa71a3f3929e6a16bf1dd26d09c18b">handle_bridge_show_all</a></div><div class="ttdeci">static char * handle_bridge_show_all(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05094">bridge.c:5094</a></div></div>
<div class="ttc" id="structast__bridge__hook_html_a7ff1fef2556947ee55ff0d194cb0d552"><div class="ttname"><a href="../../da/d3b/structast__bridge__hook.html#a7ff1fef2556947ee55ff0d194cb0d552">ast_bridge_hook::destructor</a></div><div class="ttdeci">ast_bridge_hook_pvt_destructor destructor</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00205">bridge_features.h:205</a></div></div>
<div class="ttc" id="bridge_8c_html_a33e57ad4748df60e32e16393cfd285b4"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a33e57ad4748df60e32e16393cfd285b4">bridge_queue_action_nodup</a></div><div class="ttdeci">static void bridge_queue_action_nodup(struct ast_bridge *bridge, struct ast_frame *action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00296">bridge.c:296</a></div></div>
<div class="ttc" id="structast__bridge__features_html_a70760b613dd26b51a5667e7f0fa7fb8a"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#a70760b613dd26b51a5667e7f0fa7fb8a">ast_bridge_features::dtmf_hooks</a></div><div class="ttdeci">struct ao2_container * dtmf_hooks</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00265">bridge_features.h:265</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_a5b1a8e69c6546121e0b4dcec16be3373"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#a5b1a8e69c6546121e0b4dcec16be3373">ast_bridge_methods::dissolving</a></div><div class="ttdeci">ast_bridge_dissolving_fn dissolving</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00271">bridge.h:271</a></div></div>
<div class="ttc" id="bridge__features_8h_html_aeb8be7f6bc57379c2028c1420015abc1"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#aeb8be7f6bc57379c2028c1420015abc1">ast_bridge_hook_callback</a></div><div class="ttdeci">int(* ast_bridge_hook_callback)(struct ast_bridge_channel *bridge_channel, void *hook_pvt)</div><div class="ttdoc">Hook callback type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00136">bridge_features.h:136</a></div></div>
<div class="ttc" id="lock_8h_html_a36233c5520173c095bf732a788356aee"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a></div><div class="ttdeci">#define ast_cond_wait(cond, mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00203">lock.h:203</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01117">bridge.h:1117</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaa708398f920511beb8ea9df06bf16daac">BRIDGE_CHANNEL_STATE_END_NO_DISSOLVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00066">bridge_channel.h:66</a></div></div>
<div class="ttc" id="lock_8h_html_a69e9591803d36f5683eb9b084442be9b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a></div><div class="ttdeci">#define ast_cond_init(cond, attr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00199">lock.h:199</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="bridge_8c_html_ad6f253ce6ca83c50fd56077f98fcaaf7"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad6f253ce6ca83c50fd56077f98fcaaf7">set_bridge_peer_vars</a></div><div class="ttdeci">static void set_bridge_peer_vars(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01426">bridge.c:1426</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444aab11deff15a9ae22b58e49e9d6d53e16"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aab11deff15a9ae22b58e49e9d6d53e16">AST_BRIDGE_FLAG_DISSOLVE_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00037">bridge_features.h:37</a></div></div>
<div class="ttc" id="bridge_8c_html_af326bb3722c4cdd5413a8f4744a6e5d1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af326bb3722c4cdd5413a8f4744a6e5d1">bridge_base_notify_masquerade</a></div><div class="ttdeci">static void bridge_base_notify_masquerade(struct ast_bridge *self, struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00908">bridge.c:908</a></div></div>
<div class="ttc" id="parking_8h_html_a0ede734145efa668143b11b31b49c6b0"><div class="ttname"><a href="../../d2/d33/parking_8h.html#a0ede734145efa668143b11b31b49c6b0">ast_parking_blind_transfer_park</a></div><div class="ttdeci">int ast_parking_blind_transfer_park(struct ast_bridge_channel *parker, const char *context, const char *exten, transfer_channel_cb parked_channel_cb, struct transfer_channel_data *parked_channel_data)</div><div class="ttdoc">Perform a blind transfer to a parking extension. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2a/parking_8c_source.html#l00143">parking.c:143</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="bridge_8c_html_ae7078806f36ab599840879be881a2c59"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae7078806f36ab599840879be881a2c59">bridge_base_pull</a></div><div class="ttdeci">static void bridge_base_pull(struct ast_bridge *self, struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00891">bridge.c:891</a></div></div>
<div class="ttc" id="bridge_8c_html_a98000e740561c2e40e39f9edd191c38a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a98000e740561c2e40e39f9edd191c38a">ast_bridge_remove_video_src</a></div><div class="ttdeci">void ast_bridge_remove_video_src(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">remove a channel as a source of video for the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03984">bridge.c:3984</a></div></div>
<div class="ttc" id="channel_8h_html_a17e5eed14e9256176bb685dc7bac620a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a17e5eed14e9256176bb685dc7bac620a">ast_channel_yank</a></div><div class="ttdeci">struct ast_channel * ast_channel_yank(struct ast_channel *yankee)</div><div class="ttdoc">Gain control of a channel in the system. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10794">channel.c:10794</a></div></div>
<div class="ttc" id="bridge_8h_html_ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a1e27ac207e54a30dfdabc463bd18d43c">AST_BRIDGE_VIDEO_MODE_SINGLE_SRC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00102">bridge.h:102</a></div></div>
<div class="ttc" id="bridge_8c_html_ae364d78e48f19a0d5ceedc6d18cda52d"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae364d78e48f19a0d5ceedc6d18cda52d">ast_bridge_features_register</a></div><div class="ttdeci">int ast_bridge_features_register(enum ast_bridge_builtin_feature feature, ast_bridge_hook_callback callback, const char *dtmf)</div><div class="ttdoc">Register a handler for a built in feature. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03123">bridge.c:3123</a></div></div>
<div class="ttc" id="channel_8h_html_a2e46e4da6a025dfe7c64c4f1a480967b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2e46e4da6a025dfe7c64c4f1a480967b">ast_channel_internal_bridge</a></div><div class="ttdeci">struct ast_bridge * ast_channel_internal_bridge(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01240">channel_internal_api.c:1240</a></div></div>
<div class="ttc" id="bridge_8c_html_adcadbc8335db73d28f48f0c10473d2d5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#adcadbc8335db73d28f48f0c10473d2d5">optimize_lock_peer_stack</a></div><div class="ttdeci">static struct ast_bridge * optimize_lock_peer_stack(struct ast_channel *peer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02672">bridge.c:2672</a></div></div>
<div class="ttc" id="bridge_8c_html_a283cf43498dde27adebbc85679b2f2d5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a283cf43498dde27adebbc85679b2f2d5">ast_bridge_number_video_src</a></div><div class="ttdeci">int ast_bridge_number_video_src(struct ast_bridge *bridge)</div><div class="ttdoc">Returns the number of video sources currently active in the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03931">bridge.c:3931</a></div></div>
<div class="ttc" id="structast__bridge_html_af005cc77b3514fdc7fb7aba4ba370f50"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#af005cc77b3514fdc7fb7aba4ba370f50">ast_bridge::inhibit_merge</a></div><div class="ttdeci">unsigned int inhibit_merge</div><div class="ttdoc">Count of the active temporary requests to inhibit bridge merges. Zero if merges are allowed...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00392">bridge.h:392</a></div></div>
<div class="ttc" id="bridge_8c_html_a8eb8e30144686ae8a70116b25c777bfd"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a8eb8e30144686ae8a70116b25c777bfd">bridge_base_destroy</a></div><div class="ttdeci">static void bridge_base_destroy(struct ast_bridge *self)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00841">bridge.c:841</a></div></div>
<div class="ttc" id="structmerge__direction_html_a360a3478da682e55ea0d21fede855cf2"><div class="ttname"><a href="../../d0/ddf/structmerge__direction.html#a360a3478da682e55ea0d21fede855cf2">merge_direction::src</a></div><div class="ttdeci">struct ast_bridge * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02186">bridge.c:2186</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4a1884cde93e53bef32ca85c194a1d05"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a></div><div class="ttdeci">#define AST_LIST_EMPTY(head)</div><div class="ttdoc">Checks whether the specified list contains any entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00449">linkedlists.h:449</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga77315fa8e29950f0c88120501acda0a3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a></div><div class="ttdeci">void astman_send_ack(struct mansession *s, const struct message *m, char *msg)</div><div class="ttdoc">Send ack in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03191">manager.c:3191</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="bridge_8c_html_a2a0fb2033d63f4d58127cd3c3adb3965"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a2a0fb2033d63f4d58127cd3c3adb3965">set_bridge_peer_vars_2party</a></div><div class="ttdeci">static void set_bridge_peer_vars_2party(struct ast_channel *c0, struct ast_channel *c1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01263">bridge.c:1263</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00042">channelstate.h:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="bridge_8c_html_af0e3d51ad653134a92545dec4610b83a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af0e3d51ad653134a92545dec4610b83a">ast_bridge_move</a></div><div class="ttdeci">int ast_bridge_move(struct ast_bridge *dst_bridge, struct ast_bridge *src_bridge, struct ast_channel *chan, struct ast_channel *swap, int attempt_recovery)</div><div class="ttdoc">Move a channel from one bridge to another. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02508">bridge.c:2508</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="channel_8h_html_a40fc421536e02d30fecaa51a255b4144"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a></div><div class="ttdeci">void ast_party_connected_line_free(struct ast_party_connected_line *doomed)</div><div class="ttdoc">Destroy the connected line information contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02072">channel.c:2072</a></div></div>
<div class="ttc" id="utils_8h_html_aac9153aee4bdb92701df902e06a74eb3"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a></div><div class="ttdeci">#define SWAP(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00230">utils.h:230</a></div></div>
<div class="ttc" id="channel_8h_html_aad1e09cd7c79237d05cffb45d6cdfd7c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aad1e09cd7c79237d05cffb45d6cdfd7c">ast_channel_datastore_find</a></div><div class="ttdeci">struct ast_datastore * ast_channel_datastore_find(struct ast_channel *chan, const struct ast_datastore_info *info, const char *uid)</div><div class="ttdoc">Find a datastore on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02404">channel.c:2404</a></div></div>
<div class="ttc" id="bridge_8c_html_a078811ef622f47d248e59caeb8941ad0"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a078811ef622f47d248e59caeb8941ad0">bridge_manager</a></div><div class="ttdeci">static struct bridge_manager_controller * bridge_manager</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00172">bridge.c:172</a></div></div>
<div class="ttc" id="bridge_8c_html_ae73ffed95c5c683369117e42e864d3c4"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae73ffed95c5c683369117e42e864d3c4">bridge_dissolve_check_stolen</a></div><div class="ttdeci">static void bridge_dissolve_check_stolen(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00361">bridge.c:361</a></div></div>
<div class="ttc" id="file_8h_html"><div class="ttname"><a href="../../d2/d4d/file_8h.html">file.h</a></div><div class="ttdoc">Generic File Format Support. Should be included by clients of the file handling routines. File service providers should instead include mod_format.h. </div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_a25adcc7a991b49286746a062291ce1e1"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#a25adcc7a991b49286746a062291ce1e1">bridge_channel_internal_unsuspend_nolock</a></div><div class="ttdeci">void bridge_channel_internal_unsuspend_nolock(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00892">bridge_channel.c:892</a></div></div>
<div class="ttc" id="bridge_8c_html_a5bff6bf264928e1fff47eb6968192228"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a5bff6bf264928e1fff47eb6968192228">ast_brige_set_remb_behavior</a></div><div class="ttdeci">void ast_brige_set_remb_behavior(struct ast_bridge *bridge, enum ast_bridge_video_sfu_remb_behavior behavior)</div><div class="ttdoc">Set the REMB report generation behavior on a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03865">bridge.c:3865</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="bridge_8c_html_a2df991cc86ea9bb473f730f2af4b2649"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a2df991cc86ea9bb473f730f2af4b2649">builtin_features_dtmf</a></div><div class="ttdeci">static char builtin_features_dtmf[AST_BRIDGE_BUILTIN_END][MAXIMUM_DTMF_FEATURE_STRING]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00144">bridge.c:144</a></div></div>
<div class="ttc" id="structast__channel_html_a8f64897c7ccc5c13f276d1d07c4e7095"><div class="ttname"><a href="../../df/d3c/structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">ast_channel::data</a></div><div class="ttdeci">const char * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00083">channel_internal_api.c:83</a></div></div>
<div class="ttc" id="structmerge__direction_html_a6a6a396c5142eb174363618efdd79ad1"><div class="ttname"><a href="../../d0/ddf/structmerge__direction.html#a6a6a396c5142eb174363618efdd79ad1">merge_direction::dest</a></div><div class="ttdeci">struct ast_bridge * dest</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02184">bridge.c:2184</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="bridge_8c_html_ab0558a802b481dabb4b5c6344fb0c809ac027a2515d44ca996604448ede37c6c7"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809ac027a2515d44ca996604448ede37c6c7">MERGE_PROHIBITED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02861">bridge.c:2861</a></div></div>
<div class="ttc" id="bridge_8c_html_aa87b1ca93d9a134685bbe0127d0dd3e1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aa87b1ca93d9a134685bbe0127d0dd3e1">cleanup_video_mode</a></div><div class="ttdeci">static void cleanup_video_mode(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03793">bridge.c:3793</a></div></div>
<div class="ttc" id="manager_8h_html_a1d34461b8a3210b19e66f06bcdebfeb3"><div class="ttname"><a href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a></div><div class="ttdeci">#define ast_manager_register_xml_core(action, authority, func)</div><div class="ttdoc">Register a manager callback using XML documentation to describe the manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00197">manager.h:197</a></div></div>
<div class="ttc" id="bridge_8c_html_a3a5abc6bcc708c0455a3f0d3ad134378"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3a5abc6bcc708c0455a3f0d3ad134378">bridge_other_hook</a></div><div class="ttdeci">static int bridge_other_hook(struct ast_bridge_features *features, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags, enum ast_bridge_hook_type type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03294">bridge.c:3294</a></div></div>
<div class="ttc" id="heap_8h_html_ad56625488a481df852f0b13d58b15a93"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ad56625488a481df852f0b13d58b15a93">ast_heap_pop</a></div><div class="ttdeci">void * ast_heap_pop(struct ast_heap *h)</div><div class="ttdoc">Pop the max element off of the heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00262">heap.c:262</a></div></div>
<div class="ttc" id="bridge_8c_html_a3e507358824dd355399b94c389762da3"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3e507358824dd355399b94c389762da3">manager_bridge_tech_unsuspend</a></div><div class="ttdeci">static int manager_bridge_tech_unsuspend(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05513">bridge.c:5513</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17">ast_transfer_result</a></div><div class="ttdeci">ast_transfer_result</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01115">bridge.h:1115</a></div></div>
<div class="ttc" id="structbridge__channel__impart__ds__head_html"><div class="ttname"><a href="../../d3/d44/structbridge__channel__impart__ds__head.html">bridge_channel_impart_ds_head</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01525">bridge.c:1525</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_a47058a18972f43983eb9109737c43229"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#a47058a18972f43983eb9109737c43229">bridge_channel_settle_owed_events</a></div><div class="ttdeci">void bridge_channel_settle_owed_events(struct ast_bridge *orig_bridge, struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00792">bridge_channel.c:792</a></div></div>
<div class="ttc" id="bridge_8c_html_a619ad10e73a067de53cc1ad60ccf1d99"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a619ad10e73a067de53cc1ad60ccf1d99">complete_bridge_live_search</a></div><div class="ttdeci">static int complete_bridge_live_search(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05075">bridge.c:5075</a></div></div>
<div class="ttc" id="bridge_8h_html_a186f44efd65f1349ca2deb11b8117534a83a14f41557a30da243c32b7f717ed1f"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a83a14f41557a30da243c32b7f717ed1f">AST_BRIDGE_OPTIMIZE_MERGE_TO_PEER_BRIDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00899">bridge.h:899</a></div></div>
<div class="ttc" id="bridge_8c_html_a0075715d330c8492e03c6d3ca3f48e13"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a0075715d330c8492e03c6d3ca3f48e13">ast_bridge_depart</a></div><div class="ttdeci">int ast_bridge_depart(struct ast_channel *chan)</div><div class="ttdoc">Depart a channel from a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01952">bridge.c:1952</a></div></div>
<div class="ttc" id="bridge_8h_html_a815c9b3e933dfd4b8f523cf55caa5bbfaff2606e446a3b7e22fb3785a06110554"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaff2606e446a3b7e22fb3785a06110554">AST_BRIDGE_CAPABILITY_HOLDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00086">bridge.h:86</a></div></div>
<div class="ttc" id="bridge_8c_html_ae1af73cc9e9cce0a151dddc8cfae3e4b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae1af73cc9e9cce0a151dddc8cfae3e4b">bridge_merge_inhibit_nolock</a></div><div class="ttdeci">void bridge_merge_inhibit_nolock(struct ast_bridge *bridge, int request)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03052">bridge.c:3052</a></div></div>
<div class="ttc" id="bridge_8c_html_a2fce0d593cf609fef9c414ab71c6aa24"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a2fce0d593cf609fef9c414ab71c6aa24">UPDATE_BRIDGE_VARS_GET</a></div><div class="ttdeci">#define UPDATE_BRIDGE_VARS_GET(chan, name, pvtid)</div></div>
<div class="ttc" id="structast__unreal__pvt__callbacks_html_a54bf951daa7d73ff3854c6732d286212"><div class="ttname"><a href="../../df/d09/structast__unreal__pvt__callbacks.html#a54bf951daa7d73ff3854c6732d286212">ast_unreal_pvt_callbacks::optimization_finished</a></div><div class="ttdeci">void(*const optimization_finished)(struct ast_unreal_pvt *p, int success, unsigned int id)</div><div class="ttdoc">Called when an optimization attempt completed successfully. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00081">core_unreal.h:81</a></div></div>
<div class="ttc" id="bridge__features_8h_html_acf985c9cba5e118bd24fdf980b59f955"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#acf985c9cba5e118bd24fdf980b59f955">ast_bridge_builtin_set_limits_fn</a></div><div class="ttdeci">int(* ast_bridge_builtin_set_limits_fn)(struct ast_bridge_features *features, struct ast_bridge_features_limits *limits, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach interval hooks to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00422">bridge_features.h:422</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01123">bridge.h:1123</a></div></div>
<div class="ttc" id="musiconhold_8h_html_a52fead32f69533450f3c05b2e6960149"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a></div><div class="ttdeci">void ast_moh_stop(struct ast_channel *chan)</div><div class="ttdoc">Turn off music on hold on a given channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07876">channel.c:7876</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="bridge_8c_html_af3b2e27d3b3da68a7a5138232ad83a41"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af3b2e27d3b3da68a7a5138232ad83a41">bridge_allows_optimization</a></div><div class="ttdeci">static int bridge_allows_optimization(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02608">bridge.c:2608</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="structast__bridge_html_a1792ee6e2f718b197f668a8b7b16d357"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a1792ee6e2f718b197f668a8b7b16d357">ast_bridge::softmix</a></div><div class="ttdeci">struct ast_bridge_softmix softmix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00375">bridge.h:375</a></div></div>
<div class="ttc" id="structast__bridge__video__mode_html_a4815762cb716d9c02daf0caadd5a41db"><div class="ttname"><a href="../../dc/d4a/structast__bridge__video__mode.html#a4815762cb716d9c02daf0caadd5a41db">ast_bridge_video_mode::mode_data</a></div><div class="ttdeci">union ast_bridge_video_mode::@227 mode_data</div></div>
<div class="ttc" id="bridge_8c_html_a76ac53f956ad8bd4f1d95868dbc6b33e"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a76ac53f956ad8bd4f1d95868dbc6b33e">builtin_interval_handlers</a></div><div class="ttdeci">static ast_bridge_builtin_set_limits_fn builtin_interval_handlers[AST_BRIDGE_BUILTIN_INTERVAL_END]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00150">bridge.c:150</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structlimits_html"><div class="ttname"><a href="../../df/dfc/structlimits.html">limits</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d69/res__limit_8c_source.html#l00042">res_limit.c:42</a></div></div>
<div class="ttc" id="bridge_8c_html_a4a80435538e9bd93331f54d6aac9201b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a4a80435538e9bd93331f54d6aac9201b">ast_bridge_queue_action</a></div><div class="ttdeci">int ast_bridge_queue_action(struct ast_bridge *bridge, struct ast_frame *action)</div><div class="ttdoc">Put an action onto the specified bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00307">bridge.c:307</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="bridge_8c_html_ad663022ff4700bb2d53afeea24f402d4"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad663022ff4700bb2d53afeea24f402d4">bridge_do_move</a></div><div class="ttdeci">int bridge_do_move(struct ast_bridge *dst_bridge, struct ast_bridge_channel *bridge_channel, int attempt_recovery, unsigned int optimized)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02362">bridge.c:2362</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a6e62c2774ca18846e6e45057fb8b7a22"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a6e62c2774ca18846e6e45057fb8b7a22">ast_bridge_snapshot::creator</a></div><div class="ttdeci">const ast_string_field creator</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00336">bridge.h:336</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a10b6f3295f847d20f6706a222fe55828"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a10b6f3295f847d20f6706a222fe55828">ast_bridge_discard_after_callback</a></div><div class="ttdeci">void ast_bridge_discard_after_callback(struct ast_channel *chan, enum ast_bridge_after_cb_reason reason)</div><div class="ttdoc">Run discarding any after bridge callbacks. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00247">bridge_after.c:247</a></div></div>
<div class="ttc" id="structast__bridge__video__sfu__data_html_a8f1dcf51cf06db1ac8e0ad3db16b3d39"><div class="ttname"><a href="../../dd/df9/structast__bridge__video__sfu__data.html#a8f1dcf51cf06db1ac8e0ad3db16b3d39">ast_bridge_video_sfu_data::remb_behavior</a></div><div class="ttdeci">enum ast_bridge_video_sfu_remb_behavior remb_behavior</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00153">bridge.h:153</a></div></div>
<div class="ttc" id="bridge_8c_html_a9ad5bc80833f85bf5a18dbac95094691"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a9ad5bc80833f85bf5a18dbac95094691">bridge_manager_create</a></div><div class="ttdeci">static struct bridge_manager_controller * bridge_manager_create(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05009">bridge.c:5009</a></div></div>
<div class="ttc" id="datastore_8h_html_aee27286888b30c6448a9bce928040a14"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#aee27286888b30c6448a9bce928040a14">ast_datastore_free</a></div><div class="ttdeci">int ast_datastore_free(struct ast_datastore *datastore)</div><div class="ttdoc">Free a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00068">datastore.c:68</a></div></div>
<div class="ttc" id="structast__bridge__features_html_aa09e22acd94cd548a204c100e11fd612"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#aa09e22acd94cd548a204c100e11fd612">ast_bridge_features::mute</a></div><div class="ttdeci">unsigned int mute</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00277">bridge_features.h:277</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a1abab08d2d7b893a82348e417e361717">AST_BRIDGE_BUILTIN_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00107">bridge_features.h:107</a></div></div>
<div class="ttc" id="pbx_8h_html_a98c5425b90ec7c5e136a40f529170b1b"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a></div><div class="ttdeci">const char * pbx_builtin_getvar_helper(struct ast_channel *chan, const char *name)</div><div class="ttdoc">Return a pointer to the value of the corresponding channel variable. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01000">pbx_variables.c:1000</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a4fe7571e3c1759f3689d4453c132bdb7"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">ast_bridge_channel::bridge</a></div><div class="ttdeci">struct ast_bridge * bridge</div><div class="ttdoc">Bridge this channel is participating in. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00100">bridge_channel.h:100</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="logger_8h_html_a5b3f39ea262ffa795ce4b597968ad00b"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5b3f39ea262ffa795ce4b597968ad00b">ast_read_threadstorage_callid</a></div><div class="ttdeci">ast_callid ast_read_threadstorage_callid(void)</div><div class="ttdoc">extracts the callerid from the thread </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/logger_8c_source.html#l01962">logger.c:1962</a></div></div>
<div class="ttc" id="res__corosync_8c_html_aa4002959b64099e84d20e09e38c2e51e"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#aa4002959b64099e84d20e09e38c2e51e">publish</a></div><div class="ttdeci">unsigned char publish</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00241">res_corosync.c:241</a></div></div>
<div class="ttc" id="stringfields_8h_html"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html">stringfields.h</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab0b4e11aba1e0a898b5d75427d3b13fa"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a></div><div class="ttdeci">#define OBJ_PARTIAL_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01156">astobj2.h:1156</a></div></div>
<div class="ttc" id="utils_8h_html"><div class="ttname"><a href="../../d5/d60/utils_8h.html">utils.h</a></div><div class="ttdoc">Utility functions. </div></div>
<div class="ttc" id="channel_8h_html_a71d89dbc5107b1f851dcbf1686a0d9d9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a71d89dbc5107b1f851dcbf1686a0d9d9">ast_channel_get_by_name_prefix</a></div><div class="ttdeci">struct ast_channel * ast_channel_get_by_name_prefix(const char *name, size_t name_len)</div><div class="ttdoc">Find a channel by a name prefix. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01434">channel.c:1434</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3ab995ce36e6e2812a16d78cd2a890b1ef"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ab995ce36e6e2812a16d78cd2a890b1ef">AST_BRIDGE_HOOK_TYPE_DTMF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00191">bridge_features.h:191</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="astobj2_8h_html_af236ed10cd1eddcbad0579ed0cf9f4c5"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#af236ed10cd1eddcbad0579ed0cf9f4c5">ao2_prnt_fn</a></div><div class="ttdeci">void() ao2_prnt_fn(void *where, const char *fmt,...)</div><div class="ttdoc">Print output. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01442">astobj2.h:1442</a></div></div>
<div class="ttc" id="module_8h_html_a15896c26e51e8162df5eb9a0124c841f"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a></div><div class="ttdeci">#define ast_module_unref(mod)</div><div class="ttdoc">Release a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00469">module.h:469</a></div></div>
<div class="ttc" id="bridge__features_8h_html_adb39f3c49f940cca855ef8ae3dfc5f77a0e985ea384c79e5e35055ecc0ffb2c57"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a0e985ea384c79e5e35055ecc0ffb2c57">AST_BRIDGE_CHANNEL_FLAG_IMMOVABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00067">bridge_features.h:67</a></div></div>
<div class="ttc" id="lock_8h_html_ab134d98cdfe7de0f7a72b377c0765dc7"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab134d98cdfe7de0f7a72b377c0765dc7">ast_cond_t</a></div><div class="ttdeci">pthread_cond_t ast_cond_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00176">lock.h:176</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="bridge_8c_html_a33ad1b704c3dedf9fbf0bf8c2429561a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a33ad1b704c3dedf9fbf0bf8c2429561a">bridge_do_merge</a></div><div class="ttdeci">void bridge_do_merge(struct ast_bridge *dst_bridge, struct ast_bridge *src_bridge, struct ast_bridge_channel **kick_me, unsigned int num_kick, unsigned int optimized)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02096">bridge.c:2096</a></div></div>
<div class="ttc" id="bridge_8c_html_aaba0073c46b7c4e52f55a0f34036f43b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aaba0073c46b7c4e52f55a0f34036f43b">ast_bridge_set_send_sdp_label</a></div><div class="ttdeci">void ast_bridge_set_send_sdp_label(struct ast_bridge *bridge, unsigned int send_sdp_label)</div><div class="ttdoc">Controls whether to send a &quot;label&quot; attribute in each stream in an SDP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04033">bridge.c:4033</a></div></div>
<div class="ttc" id="channel_8h_html_a39fc055500e09810d0afd0bff87407c5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a39fc055500e09810d0afd0bff87407c5">ast_request</a></div><div class="ttdeci">struct ast_channel * ast_request(const char *type, struct ast_format_cap *request_cap, const struct ast_assigned_ids *assignedids, const struct ast_channel *requestor, const char *addr, int *cause)</div><div class="ttdoc">Requests a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06444">channel.c:6444</a></div></div>
<div class="ttc" id="bridge__features_8h_html_afcb20166cd7e9581af29556b411b960dad5e042dd402144426b46a6590485d88b"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#afcb20166cd7e9581af29556b411b960dad5e042dd402144426b46a6590485d88b">AST_BRIDGE_BUILTIN_INTERVAL_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00115">bridge_features.h:115</a></div></div>
<div class="ttc" id="structbridge__manager__controller_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="../../d4/d7c/structbridge__manager__controller.html#a01f75a9ad916f63a94e06a27635ba278">bridge_manager_controller::thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00166">bridge.c:166</a></div></div>
<div class="ttc" id="bridge_8c_html_a0724e3f5e13ffe78fe0fa0ae8e5a5378"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a0724e3f5e13ffe78fe0fa0ae8e5a5378">complete_bridge_live</a></div><div class="ttdeci">static char * complete_bridge_live(const char *word)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05086">bridge.c:5086</a></div></div>
<div class="ttc" id="cli_8h_html_a2a43f82ed19e84f386787154f2f22fc9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a2a43f82ed19e84f386787154f2f22fc9">ast_cli_complete</a></div><div class="ttdeci">char * ast_cli_complete(const char *word, const char *const choices[], int pos)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd3/main_2cli_8c_source.html#l01811">main/cli.c:1811</a></div></div>
<div class="ttc" id="bridge_8c_html_a48ebc85ae4e4a203014711dc3a492ac5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a48ebc85ae4e4a203014711dc3a492ac5">ast_bridge_dtmf_hook</a></div><div class="ttdeci">int ast_bridge_dtmf_hook(struct ast_bridge_features *features, const char *dtmf, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach a DTMF hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03245">bridge.c:3245</a></div></div>
<div class="ttc" id="bridge_8c_html_a407073589cd8fa355d5772da7f9a6529"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a407073589cd8fa355d5772da7f9a6529">find_best_technology</a></div><div class="ttdeci">static struct ast_bridge_technology * find_best_technology(uint32_t capabilities, struct ast_bridge *bridge)</div><div class="ttdoc">Helper function used to find the &quot;best&quot; bridge technology given specified capabilities. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00511">bridge.c:511</a></div></div>
<div class="ttc" id="bridge_8c_html_a4adad484788bb018b8699eeed2ddfedd"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a></div><div class="ttdeci">int ast_bridge_destroy(struct ast_bridge *bridge, int cause)</div><div class="ttdoc">Destroy a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00970">bridge.c:970</a></div></div>
<div class="ttc" id="bridge_8c_html_a91794e42131b7edc3119b92d789f8268"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a91794e42131b7edc3119b92d789f8268">ast_bridge_features_merge</a></div><div class="ttdeci">void ast_bridge_features_merge(struct ast_bridge_features *into, const struct ast_bridge_features *from)</div><div class="ttdoc">Merge one ast_bridge_features into another. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03662">bridge.c:3662</a></div></div>
<div class="ttc" id="bridge_8c_html_a0a2e9bb75a3d3276cd8153e1f4a4a389"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a0a2e9bb75a3d3276cd8153e1f4a4a389">ast_bridge_set_talker_src_video_mode</a></div><div class="ttdeci">void ast_bridge_set_talker_src_video_mode(struct ast_bridge *bridge)</div><div class="ttdoc">Set the bridge to pick the strongest talker supporting video as the single source video feed...</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03833">bridge.c:3833</a></div></div>
<div class="ttc" id="structast__channel_html_aa8f6a3233b196d1a6b727edc83063a63"><div class="ttname"><a href="../../df/d3c/structast__channel.html#aa8f6a3233b196d1a6b727edc83063a63">ast_channel::tech</a></div><div class="ttdeci">const struct ast_channel_tech * tech</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00074">channel_internal_api.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="bridge_8c_html_ad28289949f5625726a53e10379eea032"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad28289949f5625726a53e10379eea032">__ast_bridge_technology_register</a></div><div class="ttdeci">int __ast_bridge_technology_register(struct ast_bridge_technology *technology, struct ast_module *module)</div><div class="ttdoc">Register a bridge technology for use. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00214">bridge.c:214</a></div></div>
<div class="ttc" id="bridge_8c_html_a3dfc360c4ef5a43d854d75e9b94b58e1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3dfc360c4ef5a43d854d75e9b94b58e1">bridge_dissolve</a></div><div class="ttdeci">void bridge_dissolve(struct ast_bridge *bridge, int cause)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00319">bridge.c:319</a></div></div>
<div class="ttc" id="logger_8h_html_a6956becf4d7e3906c74b6e30b834ebd8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6956becf4d7e3906c74b6e30b834ebd8">ast_callid_threadassoc_add</a></div><div class="ttdeci">int ast_callid_threadassoc_add(ast_callid callid)</div><div class="ttdoc">Adds a known callid to thread storage of the calling thread. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/logger_8c_source.html#l01984">logger.c:1984</a></div></div>
<div class="ttc" id="utils_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00226">utils.h:226</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="astobj2_8h_html_a503b6c7ced96f9b56ec59c115cbeb29a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a></div><div class="ttdeci">void * ao2_object_get_lockaddr(void *obj)</div><div class="ttdoc">Return the mutex lock address of an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00476">astobj2.c:476</a></div></div>
<div class="ttc" id="bridge_8h_html_a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfabd40da8a498f3027c44dfa2e92d5f4ac">AST_BRIDGE_CAPABILITY_MULTIMIX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00094">bridge.h:94</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_ae533d4edc97a21476c3f0600a6665eb1"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#ae533d4edc97a21476c3f0600a6665eb1">bridge_topics_destroy</a></div><div class="ttdeci">void bridge_topics_destroy(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00319">stasis_bridges.c:319</a></div></div>
<div class="ttc" id="structast__bridge_html_aabb60a181a9e98fb31f8666fb4f5d0b8"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#aabb60a181a9e98fb31f8666fb4f5d0b8">ast_bridge::technology</a></div><div class="ttdeci">struct ast_bridge_technology * technology</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00363">bridge.h:363</a></div></div>
<div class="ttc" id="logger_8h_html_ad6810d73cb786e5e74c55c8bd8688e05"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a></div><div class="ttdeci">#define AST_LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00268">logger.h:268</a></div></div>
<div class="ttc" id="bridge_8c_html_a7c88a2e2a58dbf7177f34ad452904bef"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a7c88a2e2a58dbf7177f34ad452904bef">merge_container_cb</a></div><div class="ttdeci">static int merge_container_cb(void *obj, void *data, int flags)</div><div class="ttdoc">Callback for merging hook ao2_containers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03629">bridge.c:3629</a></div></div>
<div class="ttc" id="structast__bridge__features_html_af15c2e8b6df8ce0bf570af18aa890deb"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#af15c2e8b6df8ce0bf570af18aa890deb">ast_bridge_features::feature_flags</a></div><div class="ttdeci">struct ast_flags feature_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00271">bridge_features.h:271</a></div></div>
<div class="ttc" id="bridge_8c_html_a252b56143e4cba04ba2fe06b0ec08da7"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a252b56143e4cba04ba2fe06b0ec08da7">hooks_remove_heap</a></div><div class="ttdeci">static void hooks_remove_heap(struct ast_heap *hooks, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03546">bridge.c:3546</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="astobj2_8h_html_a4b8c1cca9dace1cf1bbadc5039f3dedf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a4b8c1cca9dace1cf1bbadc5039f3dedf">ao2_container_unregister</a></div><div class="ttdeci">void ao2_container_unregister(const char *name)</div><div class="ttdoc">Unregister a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00985">astobj2_container.c:985</a></div></div>
<div class="ttc" id="bridge__features_8h_html_adb39f3c49f940cca855ef8ae3dfc5f77a88f541f13934e4f8ad5d88e31f694e2b"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#adb39f3c49f940cca855ef8ae3dfc5f77a88f541f13934e4f8ad5d88e31f694e2b">AST_BRIDGE_CHANNEL_FLAG_DISSOLVE_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00063">bridge_features.h:63</a></div></div>
<div class="ttc" id="structast__bridge__features_html_ad1ee5fa0669878cce5cf86ca3d3dd921"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#ad1ee5fa0669878cce5cf86ca3d3dd921">ast_bridge_features::text_messaging</a></div><div class="ttdeci">unsigned int text_messaging</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00283">bridge_features.h:283</a></div></div>
<div class="ttc" id="channel_8h_html_ad89ab3133d87a496f63da917148d02be"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ad89ab3133d87a496f63da917148d02be">ast_channel_readq</a></div><div class="ttdeci">struct ast_readq_list * ast_channel_readq(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00876">channel_internal_api.c:876</a></div></div>
<div class="ttc" id="bridge_8h_html_ac086b7d74fb40c2ede8514274585b101a9d897e78dc2fcd2447531e2ee0310933"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101a9d897e78dc2fcd2447531e2ee0310933">AST_BRIDGE_IMPART_INHIBIT_JOIN_COLP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00606">bridge.h:606</a></div></div>
<div class="ttc" id="structast__bridge__hook__dtmf_html"><div class="ttname"><a href="../../dd/d92/structast__bridge__hook__dtmf.html">ast_bridge_hook_dtmf</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00226">bridge_features.h:226</a></div></div>
<div class="ttc" id="bridge_8c_html_a2a2b1e82e019faba42fa278f7a69a699"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a2a2b1e82e019faba42fa278f7a69a699">ast_bridge_video_mode_to_string</a></div><div class="ttdeci">const char * ast_bridge_video_mode_to_string(enum ast_bridge_video_mode_type video_mode)</div><div class="ttdoc">Converts an enum representation of a bridge video mode to string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04018">bridge.c:4018</a></div></div>
<div class="ttc" id="bridge_8c_html_a76352d8441d067d8758630bf07d1b8fc"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a76352d8441d067d8758630bf07d1b8fc">bridge_base_get_merge_priority</a></div><div class="ttdeci">static int bridge_base_get_merge_priority(struct ast_bridge *self)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00924">bridge.c:924</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_adece183191b0e700e039e59101e06105"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">ast_frame_subclass::integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00152">include/asterisk/frame.h:152</a></div></div>
<div class="ttc" id="astobj2_8h_html_abdb952d2373503555d96f02f130c5770"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a></div><div class="ttdeci">int ao2_container_register(const char *name, struct ao2_container *self, ao2_prnt_obj_fn *prnt_obj)</div><div class="ttdoc">Register a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00958">astobj2_container.c:958</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="heap_8h_html"><div class="ttname"><a href="../../da/ddb/heap_8h.html">heap.h</a></div><div class="ttdoc">Max Heap data structure. </div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_afe176c25906bf1cd867d59baeb920dc7"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#afe176c25906bf1cd867d59baeb920dc7">ast_bridge_technology::leave</a></div><div class="ttdeci">void(* leave)(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Remove a channel from a bridging technology instance for a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00127">bridge_technology.h:127</a></div></div>
<div class="ttc" id="channel_8h_html_a557663006d52a9cdc11f42602bf48326"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a557663006d52a9cdc11f42602bf48326">ast_channel_get_bridge</a></div><div class="ttdeci">struct ast_bridge * ast_channel_get_bridge(const struct ast_channel *chan)</div><div class="ttdoc">Get the bridge associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10735">channel.c:10735</a></div></div>
<div class="ttc" id="bridge_8c_html_a6bae9b013c815c40d0414080455e3592"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a6bae9b013c815c40d0414080455e3592">ast_bridge_merge_inhibit</a></div><div class="ttdeci">void ast_bridge_merge_inhibit(struct ast_bridge *bridge, int request)</div><div class="ttdoc">Adjust the bridge merge inhibit request count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03061">bridge.c:3061</a></div></div>
<div class="ttc" id="bridge_8c_html_ab2aeba6f28c5380fefdf732ec70a9e73"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab2aeba6f28c5380fefdf732ec70a9e73">complete_bridge_technology</a></div><div class="ttdeci">static char * complete_bridge_technology(const char *word)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05390">bridge.c:5390</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_ae301dc233829a0e07fd9747738636a72"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#ae301dc233829a0e07fd9747738636a72">ast_stasis_bridging_init</a></div><div class="ttdeci">int ast_stasis_bridging_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01407">stasis_bridges.c:1407</a></div></div>
<div class="ttc" id="heap_8h_html_ad181f4df20e6039b37e1b8d128884a81"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ad181f4df20e6039b37e1b8d128884a81">ast_heap_push</a></div><div class="ttdeci">#define ast_heap_push(h, elm)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ddb/heap_8h_source.html#l00126">heap.h:126</a></div></div>
<div class="ttc" id="bridge_8c_html_a1b26efd7ce4e09afa9402dc0a30d5e4a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a1b26efd7ce4e09afa9402dc0a30d5e4a">ast_bridge_hangup_hook</a></div><div class="ttdeci">int ast_bridge_hangup_hook(struct ast_bridge_features *features, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach a hangup hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03328">bridge.c:3328</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_ab941919d17b5a06038e085389ec32572"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#ab941919d17b5a06038e085389ec32572">ast_bridge_technology::compatible</a></div><div class="ttdeci">int(* compatible)(struct ast_bridge *bridge)</div><div class="ttdoc">Check if a bridge is compatible with the bridging technology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00149">bridge_technology.h:149</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_ace6976ffaf8aa0738aa7e01b0e98c04f"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#ace6976ffaf8aa0738aa7e01b0e98c04f">ast_bridge_snapshot::technology</a></div><div class="ttdeci">const ast_string_field technology</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00336">bridge.h:336</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_aa467e25606c2a21df25c61f139007782"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#aa467e25606c2a21df25c61f139007782">ast_bridge_channel_lock</a></div><div class="ttdeci">#define ast_bridge_channel_lock(bridge_channel)</div><div class="ttdoc">Lock the bridge_channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00231">bridge_channel.h:231</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ad52acdbb06c9299895662cf57a4323a3aeaf381ba8ae8b2716b0dff5e77d539f4"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ad52acdbb06c9299895662cf57a4323a3aeaf381ba8ae8b2716b0dff5e77d539f4">BRIDGE_CHANNEL_THREAD_IDLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00071">bridge_channel.h:71</a></div></div>
<div class="ttc" id="bridge_8c_html_a69034688e4e730fca4c3e12b7ac38300"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a69034688e4e730fca4c3e12b7ac38300">ast_bridge_find_by_id</a></div><div class="ttdeci">struct ast_bridge * ast_bridge_find_by_id(const char *bridge_id)</div><div class="ttdoc">Find bridge by id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05070">bridge.c:5070</a></div></div>
<div class="ttc" id="bridge_8c_html_ad953e3f044237ed0337e4e46479fbd4f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad953e3f044237ed0337e4e46479fbd4f">ast_bridge_peers</a></div><div class="ttdeci">struct ao2_container * ast_bridge_peers(struct ast_bridge *bridge)</div><div class="ttdoc">Get a container of all channels in the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04103">bridge.c:4103</a></div></div>
<div class="ttc" id="structast__bridge__hook_html_a9b8d1356a63d1d2c5892a83ea93af921"><div class="ttname"><a href="../../da/d3b/structast__bridge__hook.html#a9b8d1356a63d1d2c5892a83ea93af921">ast_bridge_hook::type</a></div><div class="ttdeci">enum ast_bridge_hook_type type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00211">bridge_features.h:211</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_aeefa5121d4fde67d827c3daa2ef778d3"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#aeefa5121d4fde67d827c3daa2ef778d3">bridge_channel_queue_deferred_frames</a></div><div class="ttdeci">void bridge_channel_queue_deferred_frames(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00830">bridge_channel.c:830</a></div></div>
<div class="ttc" id="bridge_8c_html_a8e6a9f8aa899159ff355b1cc05d0a35b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a8e6a9f8aa899159ff355b1cc05d0a35b">set_transfer_variables_all</a></div><div class="ttdeci">static void set_transfer_variables_all(struct ast_channel *transferer, struct ao2_container *channels, int is_attended)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04435">bridge.c:4435</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_ab72b2fb844367bda53a258a6059f6290"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#ab72b2fb844367bda53a258a6059f6290">ast_bridge_methods::notify_masquerade</a></div><div class="ttdeci">ast_bridge_notify_masquerade_fn notify_masquerade</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00277">bridge.h:277</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a04efba17b1302d217a2a07a02c3eac98"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a04efba17b1302d217a2a07a02c3eac98">ast_bridge_get_snapshot</a></div><div class="ttdeci">struct ast_bridge_snapshot * ast_bridge_get_snapshot(struct ast_bridge *bridge)</div><div class="ttdoc">Returns the current snapshot for the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01378">stasis_bridges.c:1378</a></div></div>
<div class="ttc" id="channel_8h_html"><div class="ttname"><a href="../../d5/d7b/channel_8h.html">channel.h</a></div><div class="ttdoc">General Asterisk PBX channel definitions. </div></div>
<div class="ttc" id="bridge_8c_html_a383e21bdffab172ff42a5a237920766d"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a383e21bdffab172ff42a5a237920766d">bridge_swap_attended_transfer</a></div><div class="ttdeci">static enum ast_transfer_result bridge_swap_attended_transfer(struct ast_bridge *dest_bridge, struct ast_bridge_channel *source_bridge_channel, struct ast_channel *swap_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04620">bridge.c:4620</a></div></div>
<div class="ttc" id="bridge_8c_html_a8995453900a91100f3cd936594f41435"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a8995453900a91100f3cd936594f41435">ast_bridge_set_single_src_video_mode</a></div><div class="ttdeci">void ast_bridge_set_single_src_video_mode(struct ast_bridge *bridge, struct ast_channel *video_src_chan)</div><div class="ttdoc">Set a bridge to feed a single video source to all participants. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03816">bridge.c:3816</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3">ast_bridge_hook_type</a></div><div class="ttdeci">ast_bridge_hook_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00188">bridge_features.h:188</a></div></div>
<div class="ttc" id="bridge_8h_html_a815c9b3e933dfd4b8f523cf55caa5bbfaf483c951b835fcc35da807b6a4b12509"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaf483c951b835fcc35da807b6a4b12509">AST_BRIDGE_CAPABILITY_1TO1MIX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00092">bridge.h:92</a></div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="structast__unreal__pvt__callbacks_html_a3c5890f67bf431d002c55d3ed27adfa0"><div class="ttname"><a href="../../df/d09/structast__unreal__pvt__callbacks.html#a3c5890f67bf431d002c55d3ed27adfa0">ast_unreal_pvt_callbacks::optimization_started</a></div><div class="ttdeci">void(*const optimization_started)(struct ast_unreal_pvt *p, struct ast_channel *source, enum ast_unreal_channel_indicator dest, unsigned int id)</div><div class="ttdoc">Called when an optimization attempt has started. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00069">core_unreal.h:69</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_aa08031dd21d51319a38015ed87e74687"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#aa08031dd21d51319a38015ed87e74687">bridge_channel_internal_allows_optimization</a></div><div class="ttdeci">int bridge_channel_internal_allows_optimization(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l03110">bridge_channel.c:3110</a></div></div>
<div class="ttc" id="structast__bridge_html_a641f383bfa9823e61aad41ba854dbe26"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a641f383bfa9823e61aad41ba854dbe26">ast_bridge::action_queue</a></div><div class="ttdeci">struct ast_bridge::@228 action_queue</div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="channel_8h_html_a9860b7152c790e2c80244deb5c67ce5d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9860b7152c790e2c80244deb5c67ce5d">ast_channel_internal_bridge_set</a></div><div class="ttdeci">void ast_channel_internal_bridge_set(struct ast_channel *chan, struct ast_bridge *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01244">channel_internal_api.c:1244</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a81567dc49b2915ad81d9cb89dbbfbc70"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a81567dc49b2915ad81d9cb89dbbfbc70">ast_bridge_technology::write</a></div><div class="ttdeci">int(* write)(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel, struct ast_frame *frame)</div><div class="ttdoc">Write a frame into the bridging technology instance for a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00163">bridge_technology.h:163</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a1b15a371c654cfe77de053afe0994b9ca41c2a3c2740424d3c072de1fa0dceb3d"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9ca41c2a3c2740424d3c072de1fa0dceb3d">AST_BRIDGE_AFTER_CB_REASON_DEPART</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d85/bridge__after_8h_source.html#l00045">bridge_after.h:45</a></div></div>
<div class="ttc" id="bridge_8c_html_a9e067daed125a4ea2ad369790c093cfa"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfa">bridge_allow_swap</a></div><div class="ttdeci">bridge_allow_swap</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02720">bridge.c:2720</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga920b9d3e484257c7e593452a8e36d8d4"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga920b9d3e484257c7e593452a8e36d8d4">ast_channel_stage_snapshot_done</a></div><div class="ttdeci">void ast_channel_stage_snapshot_done(struct ast_channel *chan)</div><div class="ttdoc">Clear flag to indicate channel snapshot is being staged, and publish snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l01043">stasis_channels.c:1043</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00043">bridge_features.h:43</a></div></div>
<div class="ttc" id="lock_8h_html_a6009440c7a72f8e2e3b1ec97641ad160"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a></div><div class="ttdeci">#define AST_PTHREADT_NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00066">lock.h:66</a></div></div>
<div class="ttc" id="bridge_8c_html_aa6c59e682620f50fc028a30c822e083c"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aa6c59e682620f50fc028a30c822e083c">bridge_reconfigured_connected_line_update</a></div><div class="ttdeci">static void bridge_reconfigured_connected_line_update(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00393">bridge.c:393</a></div></div>
<div class="ttc" id="channel_8h_html_a488b7d6f7488bedc53be45d4ef4471c9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a488b7d6f7488bedc53be45d4ef4471c9">ast_channel_pbx</a></div><div class="ttdeci">struct ast_pbx * ast_channel_pbx(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00721">channel_internal_api.c:721</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_aae3000e9dc05d9b3023f5a571ffb14d7"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#aae3000e9dc05d9b3023f5a571ffb14d7">ast_attended_transfer_message_add_merge</a></div><div class="ttdeci">int ast_attended_transfer_message_add_merge(struct ast_attended_transfer_message *transfer_msg, struct ast_bridge *final_bridge)</div><div class="ttdoc">Add details for a bridge merge to an attended transfer message. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01283">stasis_bridges.c:1283</a></div></div>
<div class="ttc" id="astobj2_8h_html"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html">astobj2.h</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="bridge_8c_html_a5ef8af740b139874195a394ba4abee3d"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a5ef8af740b139874195a394ba4abee3d">ast_bridge_join_hook</a></div><div class="ttdeci">int ast_bridge_join_hook(struct ast_bridge_features *features, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Unregisters a handler for a built in interval feature. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03338">bridge.c:3338</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_afd6ff339b48e5945cea37601655f2e35"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#afd6ff339b48e5945cea37601655f2e35">ast_bridge_technology::preference</a></div><div class="ttdeci">enum ast_bridge_preference preference</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00068">bridge_technology.h:68</a></div></div>
<div class="ttc" id="bridge__technology_8h_html"><div class="ttname"><a href="../../d0/d3b/bridge__technology_8h.html">bridge_technology.h</a></div><div class="ttdoc">Channel Bridging API. </div></div>
<div class="ttc" id="bridge_8c_html_a59e2d516216983fdab32cf3036a657f2"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a59e2d516216983fdab32cf3036a657f2">ast_bridge_features_set_flag</a></div><div class="ttdeci">void ast_bridge_features_set_flag(struct ast_bridge_features *features, unsigned int flag)</div><div class="ttdoc">Set a flag on a bridge channel features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03490">bridge.c:3490</a></div></div>
<div class="ttc" id="app__meetme_8c_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01090">app_meetme.c:1090</a></div></div>
<div class="ttc" id="channel_8h_html_af4e59494f74ad9e0c50170d9e276ad31"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a></div><div class="ttdeci">#define AST_MAX_EXTENSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00135">channel.h:135</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="causes_8h_html_af2235eb1c27925e4020ce286255d165f"><div class="ttname"><a href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a></div><div class="ttdeci">#define AST_CAUSE_NORMAL_CLEARING</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00105">causes.h:105</a></div></div>
<div class="ttc" id="bridge_8c_html_a6c03492ca8c37dd73d47e07d6459bdb1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a6c03492ca8c37dd73d47e07d6459bdb1">fill_bridgepeer_buf</a></div><div class="ttdeci">static void fill_bridgepeer_buf(char *buf, unsigned int cur_idx, const char *names[], unsigned int num_names)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01303">bridge.c:1303</a></div></div>
<div class="ttc" id="bridge_8c_html_ac74018e91ff4fc7374f6137dd76c40f5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ac74018e91ff4fc7374f6137dd76c40f5">ast_bridge_technology_unregister</a></div><div class="ttdeci">int ast_bridge_technology_unregister(struct ast_bridge_technology *technology)</div><div class="ttdoc">Unregister a bridge technology from use. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00265">bridge.c:265</a></div></div>
<div class="ttc" id="structast__bridge__video__mode_html_a7325622e00e4be7c0370401933bb75e5"><div class="ttname"><a href="../../dc/d4a/structast__bridge__video__mode.html#a7325622e00e4be7c0370401933bb75e5">ast_bridge_video_mode::talker_src_data</a></div><div class="ttdeci">struct ast_bridge_video_talker_src_data talker_src_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00164">bridge.h:164</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="channel_8h_html_ae93ebb3372a2d9495ae3c5417dd95cd5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a></div><div class="ttdeci">#define ast_channel_cleanup(c)</div><div class="ttdoc">Cleanup a channel reference. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02992">channel.h:2992</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="bridge_8c_html_aa88f0cbb002c6f26133bb5d277d4dc49"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aa88f0cbb002c6f26133bb5d277d4dc49">ast_bridge_merge</a></div><div class="ttdeci">int ast_bridge_merge(struct ast_bridge *dst_bridge, struct ast_bridge *src_bridge, int merge_best_direction, struct ast_channel **kick_me, unsigned int num_kick)</div><div class="ttdoc">Merge two bridges together. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02348">bridge.c:2348</a></div></div>
<div class="ttc" id="channel_8h_html_ac2d6607253f7e8b272d4e845474eaa9b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2d6607253f7e8b272d4e845474eaa9b">ast_softhangup</a></div><div class="ttdeci">int ast_softhangup(struct ast_channel *chan, int reason)</div><div class="ttdoc">Softly hangup up a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02476">channel.c:2476</a></div></div>
<div class="ttc" id="bridge_8c_html_ab0558a802b481dabb4b5c6344fb0c809"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809">bridge_allow_merge</a></div><div class="ttdeci">bridge_allow_merge</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02859">bridge.c:2859</a></div></div>
<div class="ttc" id="structmansession_html"><div class="ttname"><a href="../../d2/d8a/structmansession.html">mansession</a></div><div class="ttdoc">In case you didn&amp;#39;t read that giant block of text above the mansession_session struct, the struct mansession is named this solely to keep the API the same in Asterisk. This structure really represents data that is different from Manager action to Manager action. The mansession_session pointer contained within points to session-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01625">manager.c:1625</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444aa4c16c3a1a317253eace111e15f40e6d">AST_BRIDGE_FLAG_MASQUERADE_ONLY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00051">bridge_features.h:51</a></div></div>
<div class="ttc" id="bridge_8c_html_ae87543d0bf935a2f28cfc8b7e8cacf9c"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae87543d0bf935a2f28cfc8b7e8cacf9c">bridges_allow_swap_optimization</a></div><div class="ttdeci">static enum bridge_allow_swap bridges_allow_swap_optimization(struct ast_bridge *chan_bridge, struct ast_bridge *peer_bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02737">bridge.c:2737</a></div></div>
<div class="ttc" id="bridge_8c_html_a475f3511ac20e3f247e3ff3bb8060237"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a475f3511ac20e3f247e3ff3bb8060237">ast_bridge_move_hook</a></div><div class="ttdeci">int ast_bridge_move_hook(struct ast_bridge_features *features, ast_bridge_move_indicate_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach a bridge channel move detection hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03370">bridge.c:3370</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="time_8h_html_a1d774df72e3dbb623475783e06ce4f61"><div class="ttname"><a href="../../de/df7/time_8h.html#a1d774df72e3dbb623475783e06ce4f61">ast_samp2tv</a></div><div class="ttdeci">struct timeval ast_samp2tv(unsigned int _nsamp, unsigned int _rate)</div><div class="ttdoc">Returns a timeval corresponding to the duration of n samples at rate r. Useful to convert samples to ...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00238">time.h:238</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html">bridge_channel_internal.h</a></div><div class="ttdoc">Private Bridging Channel API. </div></div>
<div class="ttc" id="structast__bridge__hook__dtmf_html_a09e6a40a51d2d887563667ee42a6c1f5"><div class="ttname"><a href="../../dd/d92/structast__bridge__hook__dtmf.html#a09e6a40a51d2d887563667ee42a6c1f5">ast_bridge_hook_dtmf::dtmf</a></div><div class="ttdeci">struct ast_bridge_hook_dtmf_parms dtmf</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00230">bridge_features.h:230</a></div></div>
<div class="ttc" id="bridge_8c_html_adb755c02424a98c8ec3bd636c609e120"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#adb755c02424a98c8ec3bd636c609e120">ast_bridge_is_video_src</a></div><div class="ttdeci">int ast_bridge_is_video_src(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">Determine if a channel is a video src for the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03958">bridge.c:3958</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a02212548652c9eb0f3db38dc4e4bd285"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00569">linkedlists.h:569</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a7a4b299b4cb4bf7c644235d708847fc3"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a7a4b299b4cb4bf7c644235d708847fc3">AST_BRIDGE_FLAG_TRANSFER_PROHIBITED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00053">bridge_features.h:53</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="bridge_8h_html_ac086b7d74fb40c2ede8514274585b101a01be425a6fb9fefd36905b542e903087"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101a01be425a6fb9fefd36905b542e903087">AST_BRIDGE_IMPART_CHAN_DEPARTABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00602">bridge.h:602</a></div></div>
<div class="ttc" id="structbridge__channel__impart__cond_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d5/df4/structbridge__channel__impart__cond.html#a1c7181c39f99ee801943a0d0aa9872b9">bridge_channel_impart_cond::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01520">bridge.c:1520</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_aa8bd54e09b0c348a3232053e4be9bcfb"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#aa8bd54e09b0c348a3232053e4be9bcfb">ast_bridge_publish_state</a></div><div class="ttdeci">void ast_bridge_publish_state(struct ast_bridge *bridge)</div><div class="ttdoc">Publish the state of a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00350">stasis_bridges.c:350</a></div></div>
<div class="ttc" id="bridge_8c_html_aab4cd1153d39a6744eca6a84d5255820"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aab4cd1153d39a6744eca6a84d5255820">ast_bridge_unsuspend</a></div><div class="ttdeci">int ast_bridge_unsuspend(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">Unsuspend a channel from a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03089">bridge.c:3089</a></div></div>
<div class="ttc" id="channel_8h_html_a5e41daaa81df59fc1e8eea2796029c31"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5e41daaa81df59fc1e8eea2796029c31">ast_channel_internal_bridge_channel</a></div><div class="ttdeci">struct ast_bridge_channel * ast_channel_internal_bridge_channel(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01251">channel_internal_api.c:1251</a></div></div>
<div class="ttc" id="bridge_8c_html_a5ad28c249794c7354336fc512fab8f7a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a5ad28c249794c7354336fc512fab8f7a">ast_bridge_features_do</a></div><div class="ttdeci">int ast_bridge_features_do(enum ast_bridge_builtin_feature feature, struct ast_bridge_channel *bridge_channel, void *hook_pvt)</div><div class="ttdoc">Invoke a built in feature hook now. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03151">bridge.c:3151</a></div></div>
<div class="ttc" id="lock_8h_html_a8b9d9f2f2c41ecf3c70587c2510dddfc"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8b9d9f2f2c41ecf3c70587c2510dddfc">SCOPED_LOCK</a></div><div class="ttdeci">#define SCOPED_LOCK(varname, lock, lockfunc, unlockfunc)</div><div class="ttdoc">Scoped Locks. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00581">lock.h:581</a></div></div>
<div class="ttc" id="linkedlists_8h_html"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html">linkedlists.h</a></div><div class="ttdoc">A set of macros to manage forward-linked lists. </div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a8f882f130b89dd63d656d176884095a1"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a8f882f130b89dd63d656d176884095a1">MAXIMUM_DTMF_FEATURE_STRING</a></div><div class="ttdeci">#define MAXIMUM_DTMF_FEATURE_STRING</div><div class="ttdoc">Maximum length of a DTMF feature string. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00217">bridge_features.h:217</a></div></div>
<div class="ttc" id="structtech__deferred__destroy_html_afd481155c858ef52f7b0c4c5906f0ef5"><div class="ttname"><a href="../../d0/df8/structtech__deferred__destroy.html#afd481155c858ef52f7b0c4c5906f0ef5">tech_deferred_destroy::tech</a></div><div class="ttdeci">struct ast_bridge_technology * tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00558">bridge.c:558</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a7e45f2d09f551ef40a26ae0d8c3f410f"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a7e45f2d09f551ef40a26ae0d8c3f410f">ast_bridge_discard_after_goto</a></div><div class="ttdeci">void ast_bridge_discard_after_goto(struct ast_channel *chan)</div><div class="ttdoc">Discard channel after bridge goto location. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00396">bridge_after.c:396</a></div></div>
<div class="ttc" id="structbridge__channel__impart__cond_html_a5992b274cfdcacdbc1fa8347fd01ebde"><div class="ttname"><a href="../../d5/df4/structbridge__channel__impart__cond.html#a5992b274cfdcacdbc1fa8347fd01ebde">bridge_channel_impart_cond::done</a></div><div class="ttdeci">int done</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01522">bridge.c:1522</a></div></div>
<div class="ttc" id="codec__dahdi_8c_html_aea0622703055b62259903cdab213319b"><div class="ttname"><a href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a></div><div class="ttdeci">static struct channel_usage channels</div></div>
<div class="ttc" id="linkedlists_8h_html_acf8253a64f9a4e2170454f4bf0559e33"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#acf8253a64f9a4e2170454f4bf0559e33">AST_RWLIST_INSERT_BEFORE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_BEFORE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00609">linkedlists.h:609</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="structast__bridge__video__mode_html_a3d1942099e12eaade08dc9ac3fee6c23"><div class="ttname"><a href="../../dc/d4a/structast__bridge__video__mode.html#a3d1942099e12eaade08dc9ac3fee6c23">ast_bridge_video_mode::single_src_data</a></div><div class="ttdeci">struct ast_bridge_video_single_src_data single_src_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00163">bridge.h:163</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="reqresp__parser_8h_html_a7e4aa55331b8292eff94249de72b807d"><div class="ttname"><a href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a></div><div class="ttdeci">AST_LIST_HEAD_NOLOCK(contactliststruct, contact)</div></div>
<div class="ttc" id="bridge_8c_html_a400a0c9203d666b2a6d75944a4edaba4"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a400a0c9203d666b2a6d75944a4edaba4">bridge_channel_impart_wait</a></div><div class="ttdeci">static void bridge_channel_impart_wait(struct bridge_channel_impart_cond *cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01647">bridge.c:1647</a></div></div>
<div class="ttc" id="bridge_8c_html_aa42051dbe23078fa667eb4215d9a768f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aa42051dbe23078fa667eb4215d9a768f">hooks_remove_container</a></div><div class="ttdeci">static void hooks_remove_container(struct ao2_container *hooks, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03530">bridge.c:3530</a></div></div>
<div class="ttc" id="bridge__features_8h_html_af04bebd5565286e746a028e7705ca073"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#af04bebd5565286e746a028e7705ca073">ast_bridge_hook_pvt_destructor</a></div><div class="ttdeci">void(* ast_bridge_hook_pvt_destructor)(void *hook_pvt)</div><div class="ttdoc">Hook pvt destructor callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00143">bridge_features.h:143</a></div></div>
<div class="ttc" id="channel_8h_html_a6f3f42365ac84d888b55e35e1309f067"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6f3f42365ac84d888b55e35e1309f067">ast_channel_req_accountcodes</a></div><div class="ttdeci">void ast_channel_req_accountcodes(struct ast_channel *chan, const struct ast_channel *requestor, enum ast_channel_requestor_relationship relationship)</div><div class="ttdoc">Setup new channel accountcodes from the requestor channel after ast_request(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06526">channel.c:6526</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a82df0e78742524f455a24e874ba28f49"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a82df0e78742524f455a24e874ba28f49">ast_bridge_channel::just_joined</a></div><div class="ttdeci">unsigned int just_joined</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00123">bridge_channel.h:123</a></div></div>
<div class="ttc" id="pbx_8h_html"><div class="ttname"><a href="../../db/de0/pbx_8h.html">pbx.h</a></div><div class="ttdoc">Core PBX routines and definitions. </div></div>
<div class="ttc" id="bridge_8c_html_aca0bafd961ecfd1784bbef8ce50b8b1b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aca0bafd961ecfd1784bbef8ce50b8b1b">ast_bridge_interval_unregister</a></div><div class="ttdeci">int ast_bridge_interval_unregister(enum ast_bridge_builtin_interval interval)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03180">bridge.c:3180</a></div></div>
<div class="ttc" id="structbridge__manager__controller_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d4/d7c/structbridge__manager__controller.html#a1c7181c39f99ee801943a0d0aa9872b9">bridge_manager_controller::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00162">bridge.c:162</a></div></div>
<div class="ttc" id="structast__bridge__features_html_acf866276f9e32cb984c935b02d749e6f"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#acf866276f9e32cb984c935b02d749e6f">ast_bridge_features::interval_hooks</a></div><div class="ttdeci">struct ast_heap * interval_hooks</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00269">bridge_features.h:269</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="bridge_8c_html_a19de8a45531b37cdac0805b0ce4354f8"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a19de8a45531b37cdac0805b0ce4354f8">channel_hash</a></div><div class="ttdeci">static int channel_hash(const void *obj, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04040">bridge.c:4040</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="structframe__list_html"><div class="ttname"><a href="../../d9/d42/structframe__list.html">frame_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00590">res_rtp_asterisk.c:590</a></div></div>
<div class="ttc" id="bridge_8c_html_a4e027120313f06bfe8aebc31e5ae5cae"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a4e027120313f06bfe8aebc31e5ae5cae">attended_transfer_bridge</a></div><div class="ttdeci">static enum ast_transfer_result attended_transfer_bridge(struct ast_channel *chan1, struct ast_channel *chan2, struct ast_bridge *bridge1, struct ast_bridge *bridge2, struct ast_attended_transfer_message *transfer_msg)</div><div class="ttdoc">Perform an attended transfer of a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04280">bridge.c:4280</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a483cd10a0ddcca5814298bdb4f153878"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a></div><div class="ttdeci">#define ast_bridge_channel_unlock(bridge_channel)</div><div class="ttdoc">Unlock the bridge_channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00244">bridge_channel.h:244</a></div></div>
<div class="ttc" id="structast__bridge_html_a2f11ecc852af02fffecf1411013f0873"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a2f11ecc852af02fffecf1411013f0873">ast_bridge::v_table</a></div><div class="ttdeci">const struct ast_bridge_methods * v_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00359">bridge.h:359</a></div></div>
<div class="ttc" id="bridge_8c_html_add13b23d954c41a17ba991217857c953"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#add13b23d954c41a17ba991217857c953">bridge_channel_moving</a></div><div class="ttdeci">static void bridge_channel_moving(struct ast_bridge_channel *bridge_channel, struct ast_bridge *src, struct ast_bridge *dst)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02070">bridge.c:2070</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a2862ffde11c780129862e5549415a6f6"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a2862ffde11c780129862e5549415a6f6">ast_bridge_technology::suspended</a></div><div class="ttdeci">unsigned int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00194">bridge_technology.h:194</a></div></div>
<div class="ttc" id="bridge_8h_html_a186f44efd65f1349ca2deb11b8117534add0740f1c8620ab74b253de5bac26ec7"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534add0740f1c8620ab74b253de5bac26ec7">AST_BRIDGE_OPTIMIZE_SWAP_TO_CHAN_BRIDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00893">bridge.h:893</a></div></div>
<div class="ttc" id="structast__bridge__features_html_a9ed40fc6a252b84f86044f975cc94283"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#a9ed40fc6a252b84f86044f975cc94283">ast_bridge_features::dtmf_passthrough</a></div><div class="ttdeci">unsigned int dtmf_passthrough</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00279">bridge_features.h:279</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gafadf012f66a9fd7ecf985ec5b9dee101"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a></div><div class="ttdeci">int ast_manager_unregister(const char *action)</div><div class="ttdoc">Unregister a registered manager command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07258">manager.c:7258</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf195fcf1686408b5e52ad76996653cea"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf195fcf1686408b5e52ad76996653cea">ast_channel_stage_snapshot</a></div><div class="ttdeci">void ast_channel_stage_snapshot(struct ast_channel *chan)</div><div class="ttdoc">Set flag to indicate channel snapshot is being staged. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l01038">stasis_channels.c:1038</a></div></div>
<div class="ttc" id="bridge_8c_html_ae07278f47ac7c857c97175b0995fc6ca"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae07278f47ac7c857c97175b0995fc6ca">bridge_channel_ind_thread</a></div><div class="ttdeci">static void * bridge_channel_ind_thread(void *data)</div><div class="ttdoc">Thread responsible for independent imparted bridged channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01788">bridge.c:1788</a></div></div>
<div class="ttc" id="structast__bridge_html_a7dbe1cd4b391636e49491eafab9095e0"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a7dbe1cd4b391636e49491eafab9095e0">ast_bridge::current_snapshot</a></div><div class="ttdeci">struct ast_bridge_snapshot * current_snapshot</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00414">bridge.h:414</a></div></div>
<div class="ttc" id="structast__bridge_html"><div class="ttname"><a href="../../d4/d84/structast__bridge.html">ast_bridge</a></div><div class="ttdoc">Structure that contains information about a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00357">bridge.h:357</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a5e3829ec44bca8cdbb274a6bb478b07f"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a5e3829ec44bca8cdbb274a6bb478b07f">ast_bridge_technology::destroy</a></div><div class="ttdeci">void(* destroy)(struct ast_bridge *bridge)</div><div class="ttdoc">Destroy a bridging technology instance for a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00100">bridge_technology.h:100</a></div></div>
<div class="ttc" id="bridge_8c_html_affd07213438991c65c87eaaed9b71cc9"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#affd07213438991c65c87eaaed9b71cc9">set_bridge_peer_vars_holding</a></div><div class="ttdeci">static void set_bridge_peer_vars_holding(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01404">bridge.c:1404</a></div></div>
<div class="ttc" id="structbridge__manager__request_html"><div class="ttname"><a href="../../db/d89/structbridge__manager__request.html">bridge_manager_request</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00153">bridge.c:153</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="time_8h_html_a6daa33e2052acd094bb63e78aba29733"><div class="ttname"><a href="../../de/df7/time_8h.html#a6daa33e2052acd094bb63e78aba29733">ast_tvcmp</a></div><div class="ttdeci">int ast_tvcmp(struct timeval _a, struct timeval _b)</div><div class="ttdoc">Compres two struct timeval instances returning -1, 0, 1 if the first arg is smaller, equal or greater to the second. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00128">time.h:128</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00064">bridge_channel.h:64</a></div></div>
<div class="ttc" id="structbridge__manager__request_html_a4fe7571e3c1759f3689d4453c132bdb7"><div class="ttname"><a href="../../db/d89/structbridge__manager__request.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge_manager_request::bridge</a></div><div class="ttdeci">struct ast_bridge * bridge</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00157">bridge.c:157</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#ace9168767fc3707cf5f0a7d049682ba3">ast_bridge_snapshot::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00336">bridge.h:336</a></div></div>
<div class="ttc" id="bridge_8c_html_a3d4866f7184c581cd87f93ee0f2fca63"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3d4866f7184c581cd87f93ee0f2fca63">ast_bridge_set_maximum_sample_rate</a></div><div class="ttdeci">void ast_bridge_set_maximum_sample_rate(struct ast_bridge *bridge, unsigned int sample_rate)</div><div class="ttdoc">Adjust the maximum mixing sample rate of a bridge used during multimix mode. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03786">bridge.c:3786</a></div></div>
<div class="ttc" id="bridge_8c_html_a4a1f0ebb4769ef2340211b0d05a1077a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a4a1f0ebb4769ef2340211b0d05a1077a">ast_bridge_impart</a></div><div class="ttdeci">int ast_bridge_impart(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_channel *swap, struct ast_bridge_features *features, enum ast_bridge_impart_flags flags)</div><div class="ttdoc">Impart a channel to a bridge (non-blocking) </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01924">bridge.c:1924</a></div></div>
<div class="ttc" id="structast__bridge_html_adaedd59efa9e3a1bf9ef24db6771e0a2"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#adaedd59efa9e3a1bf9ef24db6771e0a2">ast_bridge::num_lonely</a></div><div class="ttdeci">unsigned int num_lonely</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00385">bridge.h:385</a></div></div>
<div class="ttc" id="structast__bridge__video__mode_html_ad5d1cfaccf73f40dd103903868504a7b"><div class="ttname"><a href="../../dc/d4a/structast__bridge__video__mode.html#ad5d1cfaccf73f40dd103903868504a7b">ast_bridge_video_mode::sfu_data</a></div><div class="ttdeci">struct ast_bridge_video_sfu_data sfu_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00165">bridge.h:165</a></div></div>
<div class="ttc" id="structast__bridge__features__limits_html"><div class="ttname"><a href="../../d7/da5/structast__bridge__features__limits.html">ast_bridge_features_limits</a></div><div class="ttdoc">Structure that contains configuration information for the limits feature. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00332">bridge_features.h:332</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="bridge_8c_html_a416007d94897495f428fdc375afc11f1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a416007d94897495f428fdc375afc11f1">interval_hook_time_cmp</a></div><div class="ttdeci">static int interval_hook_time_cmp(void *a, void *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03575">bridge.c:3575</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_a63e2bee23fe653a913a13ec7290f38ae"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#a63e2bee23fe653a913a13ec7290f38ae">bridge_channel_internal_queue_blind_transfer</a></div><div class="ttdeci">int bridge_channel_internal_queue_blind_transfer(struct ast_channel *transferee, const char *exten, const char *context, transfer_channel_cb new_channel_cb, void *user_data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l03062">bridge_channel.c:3062</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="bridge_8c_html_a715f970eeab295c92ecc511b2a2d1c0e"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a715f970eeab295c92ecc511b2a2d1c0e">smart_bridge_operation</a></div><div class="ttdeci">static int smart_bridge_operation(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00998">bridge.c:998</a></div></div>
<div class="ttc" id="bridge_8c_html_aa9becfea3a1b74d72ec6a21f478b99bd"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aa9becfea3a1b74d72ec6a21f478b99bd">try_parking</a></div><div class="ttdeci">static enum ast_transfer_result try_parking(struct ast_channel *transferer, const char *context, const char *exten, transfer_channel_cb new_channel_cb, struct transfer_channel_data *user_data_wrapper)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04378">bridge.c:4378</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00299">include/asterisk/frame.h:299</a></div></div>
<div class="ttc" id="bridge__channel_8h_html"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html">bridge_channel.h</a></div></div>
<div class="ttc" id="bridge_8c_html_a116a27b8e1e111729ee1828d4fab6b5a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a116a27b8e1e111729ee1828d4fab6b5a">ast_bridge_join</a></div><div class="ttdeci">int ast_bridge_join(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_channel *swap, struct ast_bridge_features *features, struct ast_bridge_tech_optimizations *tech_args, enum ast_bridge_join_flags flags)</div><div class="ttdoc">Join a channel to a bridge (blocking) </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01667">bridge.c:1667</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ad30f159c66c054fd95a739c087a6c5e9"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ad30f159c66c054fd95a739c087a6c5e9">ast_bridge_channel_write_playfile</a></div><div class="ttdeci">int ast_bridge_channel_write_playfile(struct ast_bridge_channel *bridge_channel, ast_bridge_custom_play_fn custom_play, const char *playfile, const char *moh_class)</div><div class="ttdoc">Write a bridge action play file frame into the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01398">bridge_channel.c:1398</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_a5c5538e7375dc6d55c8c0efff87a21f8"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#a5c5538e7375dc6d55c8c0efff87a21f8">bridge_channel_internal_push_full</a></div><div class="ttdeci">int bridge_channel_internal_push_full(struct ast_bridge_channel *bridge_channel, int optimized)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l02235">bridge_channel.c:2235</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a1b93f1ad25034993f7eb103a0322562e"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a1b93f1ad25034993f7eb103a0322562e">ast_bridge_snapshot::video_mode</a></div><div class="ttdeci">enum ast_bridge_video_mode_type video_mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00349">bridge.h:349</a></div></div>
<div class="ttc" id="bridge_8h_html_ac086b7d74fb40c2ede8514274585b101aecfd8e6279a21b20ee4db0ab69c847e8"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101aecfd8e6279a21b20ee4db0ab69c847e8">AST_BRIDGE_IMPART_CHAN_INDEPENDENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00604">bridge.h:604</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_acfc2cc36cba9e208c9d45e39d7cff506"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#acfc2cc36cba9e208c9d45e39d7cff506">ast_bridge_channel::tech_args</a></div><div class="ttdeci">struct ast_bridge_tech_optimizations tech_args</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00135">bridge_channel.h:135</a></div></div>
<div class="ttc" id="structast__bridge__hook_html_aff642471ebace1228460a3b47653fc35"><div class="ttname"><a href="../../da/d3b/structast__bridge__hook.html#aff642471ebace1228460a3b47653fc35">ast_bridge_hook::callback</a></div><div class="ttdeci">ast_bridge_hook_callback callback</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00203">bridge_features.h:203</a></div></div>
<div class="ttc" id="bridge_8c_html_a3a772d1ce5fd89a02a23ebd5921ab475"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3a772d1ce5fd89a02a23ebd5921ab475">complete_bridge_participant</a></div><div class="ttdeci">static char * complete_bridge_participant(const char *bridge_name, const char *word)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05241">bridge.c:5241</a></div></div>
<div class="ttc" id="channel_8h_html_a82f2c6e4d47f62f6b65c5887eb096fd5a7aeded1dc9df91dee01bb7af719880c1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a7aeded1dc9df91dee01bb7af719880c1">AST_FLAG_EMULATE_DTMF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01005">channel.h:1005</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="bridge_8c_html_ab0558a802b481dabb4b5c6344fb0c809a6331216e8bbd887cfd1ef11b5e73b0ff"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a6331216e8bbd887cfd1ef11b5e73b0ff">MERGE_NO_MULTIMIX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02865">bridge.c:2865</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a782aff512368932b8d71b3633f88cb04"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a782aff512368932b8d71b3633f88cb04">ast_bridge_technology::mod</a></div><div class="ttdeci">struct ast_module * mod</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00196">bridge_technology.h:196</a></div></div>
<div class="ttc" id="time_8h_html_a97e1bb8fbd7a103212789e87e7ed6073"><div class="ttname"><a href="../../de/df7/time_8h.html#a97e1bb8fbd7a103212789e87e7ed6073">ast_tvadd</a></div><div class="ttdeci">struct timeval ast_tvadd(struct timeval a, struct timeval b)</div><div class="ttdoc">Returns the sum of two timevals a + b. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02283">extconf.c:2283</a></div></div>
<div class="ttc" id="structast__party__connected__line_html"><div class="ttname"><a href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a></div><div class="ttdoc">Connected Line/Party information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00457">channel.h:457</a></div></div>
<div class="ttc" id="structast__unreal__pvt_html"><div class="ttname"><a href="../../d6/df3/structast__unreal__pvt.html">ast_unreal_pvt</a></div><div class="ttdoc">The base pvt structure for local channel derivatives. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00091">core_unreal.h:91</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3ac47686eedfc6349818302b402b72461d"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ac47686eedfc6349818302b402b72461d">AST_BRIDGE_HOOK_TYPE_LEAVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00195">bridge_features.h:195</a></div></div>
<div class="ttc" id="bridge_8c_html_ab4a549751233836460cee187d4daea03"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab4a549751233836460cee187d4daea03">blind_transfer_bridge</a></div><div class="ttdeci">static enum ast_transfer_result blind_transfer_bridge(int is_external, struct ast_channel *transferer, struct ast_bridge *bridge, const char *exten, const char *context, struct ast_channel *transferee, transfer_channel_cb new_channel_cb, struct transfer_channel_data *user_data_wrapper, struct ast_blind_transfer_message *transfer_message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04178">bridge.c:4178</a></div></div>
<div class="ttc" id="bridge_8c_html_ae0b1bf34dd9aa570c5efd4dddfead1fb"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae0b1bf34dd9aa570c5efd4dddfead1fb">ast_bridge_features_limits_destroy</a></div><div class="ttdeci">void ast_bridge_features_limits_destroy(struct ast_bridge_features_limits *limits)</div><div class="ttdoc">Destructor function for ast_bridge_features_limits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03470">bridge.c:3470</a></div></div>
<div class="ttc" id="structast__bridge__hook_html_ad6640f8898b13ff6d292522ee3d4973f"><div class="ttname"><a href="../../da/d3b/structast__bridge__hook.html#ad6640f8898b13ff6d292522ee3d4973f">ast_bridge_hook::hook_pvt</a></div><div class="ttdeci">void * hook_pvt</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00207">bridge_features.h:207</a></div></div>
<div class="ttc" id="bridge_8c_html_a6f66125893195db451bca7e9d71bd0a5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a6f66125893195db451bca7e9d71bd0a5">bridge_reconfigured</a></div><div class="ttdeci">void bridge_reconfigured(struct ast_bridge *bridge, unsigned int colp_update)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01443">bridge.c:1443</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="lock_8h_html_a1ea2f4040a736cddbecea48b30ffedfd"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a></div><div class="ttdeci">#define ast_cond_destroy(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00200">lock.h:200</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a95241898553c1d42ea46964b277433ad"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a95241898553c1d42ea46964b277433ad">ast_bridge_snapshot_create</a></div><div class="ttdeci">struct ast_bridge_snapshot * ast_bridge_snapshot_create(struct ast_bridge *bridge)</div><div class="ttdoc">Generate a snapshot of the bridge state. This is an ao2 object, so ao2_cleanup() to deallocate...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00202">stasis_bridges.c:202</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a1e37109bb72d95999821eb45f28c261c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a1e37109bb72d95999821eb45f28c261c">AST_LIST_LAST</a></div><div class="ttdeci">#define AST_LIST_LAST(head)</div><div class="ttdoc">Returns the last entry contained in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00428">linkedlists.h:428</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ad58d921ec1c5a6f12be8f94327dd98c0"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a></div><div class="ttdeci">void ast_bridge_channel_leave_bridge(struct ast_bridge_channel *bridge_channel, enum bridge_channel_state new_state, int cause)</div><div class="ttdoc">Set bridge channel state to leave bridge (if not leaving already). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00314">bridge_channel.c:314</a></div></div>
<div class="ttc" id="bridge_8c_html_a08a41371fb4f020d645a0e6f50434005"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a08a41371fb4f020d645a0e6f50434005">ast_bridge_peer</a></div><div class="ttdeci">struct ast_channel * ast_bridge_peer(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">Get the channel&amp;#39;s bridge peer only if the bridge is two-party. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04142">bridge.c:4142</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ad7de2a71d5af8f85035713f1f3cb69a9"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ad7de2a71d5af8f85035713f1f3cb69a9">ast_bridge_channel_queue_callback</a></div><div class="ttdeci">int ast_bridge_channel_queue_callback(struct ast_bridge_channel *bridge_channel, enum ast_bridge_channel_custom_callback_option flags, ast_bridge_custom_callback_fn callback, const void *payload, size_t payload_size)</div><div class="ttdoc">Queue a bridge action custom callback frame onto the bridge channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01492">bridge_channel.c:1492</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a62f8995a6eac6c8a48205a6f3815d54b"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a62f8995a6eac6c8a48205a6f3815d54b">ast_bridge_channel::callid</a></div><div class="ttdeci">ast_callid callid</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00141">bridge_channel.h:141</a></div></div>
<div class="ttc" id="channel_8h_html_ac8b850ff95f945ad6cfeb2942799800a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac8b850ff95f945ad6cfeb2942799800a">ast_channel_appl</a></div><div class="ttdeci">const char * ast_channel_appl(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00317">channel_internal_api.c:317</a></div></div>
<div class="ttc" id="channel_8h_html_ae90da1877e143b996d202d4c88a9c862"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae90da1877e143b996d202d4c88a9c862">ast_softhangup_nolock</a></div><div class="ttdeci">int ast_softhangup_nolock(struct ast_channel *chan, int reason)</div><div class="ttdoc">Softly hangup up a channel (no channel lock) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02463">channel.c:2463</a></div></div>
<div class="ttc" id="bridge_8c_html_aaaf5765651d9a3697813f9752660da57"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aaaf5765651d9a3697813f9752660da57">ast_bridge_leave_hook</a></div><div class="ttdeci">int ast_bridge_leave_hook(struct ast_bridge_features *features, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach a bridge channel leave hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03348">bridge.c:3348</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_ae1d135c1fb07550e5f23ef965b58ce35"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#ae1d135c1fb07550e5f23ef965b58ce35">ast_bridge_technology::join</a></div><div class="ttdeci">int(* join)(struct ast_bridge *bridge, struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Add a channel to a bridging technology instance for a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00117">bridge_technology.h:117</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="bridge_8c_html_aaa64e0df7082a1a31b65d0c956bc2534"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aaa64e0df7082a1a31b65d0c956bc2534">bridges</a></div><div class="ttdeci">static struct ao2_container * bridges</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00123">bridge.c:123</a></div></div>
<div class="ttc" id="bridge_8c_html_af3e15bc4236a2a074953cfb1c4530cf5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af3e15bc4236a2a074953cfb1c4530cf5">ast_bridge_set_internal_sample_rate</a></div><div class="ttdeci">void ast_bridge_set_internal_sample_rate(struct ast_bridge *bridge, unsigned int sample_rate)</div><div class="ttdoc">Adjust the internal mixing sample rate of a bridge used during multimix mode. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03779">bridge.c:3779</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a67508a613c8f337732e35d9367b43ae7"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a></div><div class="ttdeci">#define AST_LIST_ENTRY(type)</div><div class="ttdoc">Declare a forward link structure inside a list entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00409">linkedlists.h:409</a></div></div>
<div class="ttc" id="f2c_8h_html_abf5d144da384425ae6cb542ce6eec8d3"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a></div><div class="ttdeci">long int flag</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00083">f2c.h:83</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_afacf05ff49bf5cd3c7170b3c51943d2e"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#afacf05ff49bf5cd3c7170b3c51943d2e">ast_bridge_channel::in_bridge</a></div><div class="ttdeci">unsigned int in_bridge</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00121">bridge_channel.h:121</a></div></div>
<div class="ttc" id="bridge_8c_html_a010196e87eb58beb0bb5a0e531c2f1e2"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a010196e87eb58beb0bb5a0e531c2f1e2">ast_bridge_set_transfer_variables</a></div><div class="ttdeci">void ast_bridge_set_transfer_variables(struct ast_channel *chan, const char *value, int attended)</div><div class="ttdoc">Set the relevant transfer variables for a single channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04404">bridge.c:4404</a></div></div>
<div class="ttc" id="parking_8h_html_ae6064ecb9b802ce85e93ddfa7719c433"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ae6064ecb9b802ce85e93ddfa7719c433">ast_parking_provider_registered</a></div><div class="ttdeci">int ast_parking_provider_registered(void)</div><div class="ttdoc">Check whether a parking provider is registered. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2a/parking_8c_source.html#l00241">parking.c:241</a></div></div>
<div class="ttc" id="bridge_8h_html_ad52005264bec898a8f825bd47d91cf93a3ebef74566687cfbc25d174725fc6d56"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93a3ebef74566687cfbc25d174725fc6d56">AST_BRIDGE_JOIN_INHIBIT_JOIN_COLP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00551">bridge.h:551</a></div></div>
<div class="ttc" id="bridge_8c_html_a3128b52009fb3dd764dce90ea377fce1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3128b52009fb3dd764dce90ea377fce1">ast_bridge_features_init</a></div><div class="ttdeci">int ast_bridge_features_init(struct ast_bridge_features *features)</div><div class="ttdoc">Initialize bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03687">bridge.c:3687</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a59c3a69424e1d3c627ece7aeb5f0bdb3"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3">ast_bridge_builtin_feature</a></div><div class="ttdeci">ast_bridge_builtin_feature</div><div class="ttdoc">Built in DTMF features. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00071">bridge_features.h:71</a></div></div>
<div class="ttc" id="structast__bridge__methods_html"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html">ast_bridge_methods</a></div><div class="ttdoc">Bridge virtual methods table definition. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00265">bridge.h:265</a></div></div>
<div class="ttc" id="bridge_8c_html_adac11f6affbd68eb16840df7abd4c874"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#adac11f6affbd68eb16840df7abd4c874">bridge_manager_thread</a></div><div class="ttdeci">static void * bridge_manager_thread(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04942">bridge.c:4942</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="bridge_8h_html_a0fb66f4741ca8d106af1917a2f1aab6e"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a></div><div class="ttdeci">#define ast_bridge_unlock(bridge)</div><div class="ttdoc">Unlock the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00493">bridge.h:493</a></div></div>
<div class="ttc" id="channel_8h_html_abb5f5ff5988e039726f2c0d982342378"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abb5f5ff5988e039726f2c0d982342378">ast_cause2str</a></div><div class="ttdeci">const char * ast_cause2str(int state) attribute_pure</div><div class="ttdoc">Gives the string form of a given cause code. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00612">channel.c:612</a></div></div>
<div class="ttc" id="channel_8h_html_abcf1aea85b924e9cd605040b86241e2a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a></div><div class="ttdeci">#define AST_MAX_CONTEXT</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00136">channel.h:136</a></div></div>
<div class="ttc" id="bridge_8c_html_acd557b9305cf531bd1d66acbe39d12ee"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#acd557b9305cf531bd1d66acbe39d12ee">ast_bridge_technology_suspend</a></div><div class="ttdeci">void ast_bridge_technology_suspend(struct ast_bridge_technology *technology)</div><div class="ttdoc">Suspend a bridge technology from consideration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03108">bridge.c:3108</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="utils_8h_html_a4781fd54a4ca8c7f0f8a32a6cce503c0"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4781fd54a4ca8c7f0f8a32a6cce503c0">ast_pthread_create</a></div><div class="ttdeci">#define ast_pthread_create(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00559">utils.h:559</a></div></div>
<div class="ttc" id="bridge_8c_html_ad3debd15062b4b9463e5703724dd9a1f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad3debd15062b4b9463e5703724dd9a1f">ast_bridge_features_destroy</a></div><div class="ttdeci">void ast_bridge_features_destroy(struct ast_bridge_features *features)</div><div class="ttdoc">Destroy an allocated bridge features struct. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03741">bridge.c:3741</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a7c547699abaa46137bafc0940e6ff694"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a7c547699abaa46137bafc0940e6ff694">ast_bridge_run_after_callback</a></div><div class="ttdeci">void ast_bridge_run_after_callback(struct ast_channel *chan)</div><div class="ttdoc">Run any after bridge callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00220">bridge_after.c:220</a></div></div>
<div class="ttc" id="bridge_8c_html_a578024742467fb967f777d1325f2822a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a578024742467fb967f777d1325f2822a">handle_bridge_technology_suspend</a></div><div class="ttdeci">static char * handle_bridge_technology_suspend(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05409">bridge.c:5409</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_aa30fb781e59e7c7b6449914dd9ad08d2"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#aa30fb781e59e7c7b6449914dd9ad08d2">ast_bridge_channel::inhibit_colp</a></div><div class="ttdeci">unsigned int inhibit_colp</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00127">bridge_channel.h:127</a></div></div>
<div class="ttc" id="bridge_8c_html_a27662864d9f07a05ef11b683c245d032"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a27662864d9f07a05ef11b683c245d032">ast_bridge_features_set_limits</a></div><div class="ttdeci">int ast_bridge_features_set_limits(struct ast_bridge_features *features, struct ast_bridge_features_limits *limits, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Limit the amount of time a channel may stay in the bridge and optionally play warning messages as tim...</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03475">bridge.c:3475</a></div></div>
<div class="ttc" id="channel_8h_html_a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d">AST_FLAG_ZOMBIE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00988">channel.h:988</a></div></div>
<div class="ttc" id="bridge_8c_html_ad460c5de90f3a8925c9149bbacce65f8"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad460c5de90f3a8925c9149bbacce65f8">ast_bridges_allow_optimization</a></div><div class="ttdeci">enum ast_bridge_optimization ast_bridges_allow_optimization(struct ast_bridge *chan_bridge, struct ast_bridge *peer_bridge)</div><div class="ttdoc">Determine if bridges allow for optimization to occur betweem them. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03008">bridge.c:3008</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a1a0d32d9383a2e73b8292eec6c8359e0"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a1a0d32d9383a2e73b8292eec6c8359e0">ast_bridge_publish_blind_transfer</a></div><div class="ttdeci">void ast_bridge_publish_blind_transfer(struct ast_blind_transfer_message *transfer_message)</div><div class="ttdoc">Publish a blind transfer event. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00953">stasis_bridges.c:953</a></div></div>
<div class="ttc" id="bridge_8c_html_ae7f6701ef6b78dea4da4723994d9c211"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ae7f6701ef6b78dea4da4723994d9c211">ast_bridge_set_remb_send_interval</a></div><div class="ttdeci">void ast_bridge_set_remb_send_interval(struct ast_bridge *bridge, unsigned int remb_send_interval)</div><div class="ttdoc">Set the interval at which a combined REMB frame will be sent to video sources. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03856">bridge.c:3856</a></div></div>
<div class="ttc" id="structast__bridge__hook__timer_html_a27144173d29f9be2ef3642b7c2c29191"><div class="ttname"><a href="../../dd/df3/structast__bridge__hook__timer.html#a27144173d29f9be2ef3642b7c2c29191">ast_bridge_hook_timer::timer</a></div><div class="ttdeci">struct ast_bridge_hook_timer_parms timer</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00257">bridge_features.h:257</a></div></div>
<div class="ttc" id="bridge_8c_html_af896b3004eea94ee58a6b027ac4aed7a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af896b3004eea94ee58a6b027ac4aed7a">optimize_lock_chan_stack</a></div><div class="ttdeci">static struct ast_bridge * optimize_lock_chan_stack(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02627">bridge.c:2627</a></div></div>
<div class="ttc" id="channel_8h_html_a29557c4823f5e9c02519a01daf6a289c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a></div><div class="ttdeci">void ast_hangup(struct ast_channel *chan)</div><div class="ttdoc">Hang up a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02548">channel.c:2548</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_ad74029594a0d1e6b9863ce3f02c82d25"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#ad74029594a0d1e6b9863ce3f02c82d25">ast_bridge_methods::get_merge_priority</a></div><div class="ttdeci">ast_bridge_merge_priority_fn get_merge_priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00279">bridge.h:279</a></div></div>
<div class="ttc" id="bridge__basic_8h_html_a3f1a21eacbeaae5e19048c291956799b"><div class="ttname"><a href="../../d4/d1e/bridge__basic_8h.html#a3f1a21eacbeaae5e19048c291956799b">ast_bridging_init_basic</a></div><div class="ttdeci">void ast_bridging_init_basic(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/bridge__basic_8c_source.html#l03639">bridge_basic.c:3639</a></div></div>
<div class="ttc" id="uuid_8h_html_abe6d0b550cd9a54964e7891960d1e5bc"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a></div><div class="ttdeci">char * ast_uuid_generate_str(char *buf, size_t size)</div><div class="ttdoc">Generate a UUID string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/uuid_8c_source.html#l00143">uuid.c:143</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_aaa58823cb0b78a23c0b9e869d2ccfe7f"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#aaa58823cb0b78a23c0b9e869d2ccfe7f">ast_bridge_channel_trylock</a></div><div class="ttdeci">#define ast_bridge_channel_trylock(bridge_channel)</div><div class="ttdoc">Try locking the bridge_channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00218">bridge_channel.h:218</a></div></div>
<div class="ttc" id="ccss_8c_html_a8bd1c39b4993f80f1bf674e3a1d717dd"><div class="ttname"><a href="../../d3/d5a/ccss_8c.html#a8bd1c39b4993f80f1bf674e3a1d717dd">suspend</a></div><div class="ttdeci">static void suspend(struct cc_core_instance *core_instance)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5a/ccss_8c_source.html#l03193">ccss.c:3193</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="structast__bridge__video__mode_html_a827ffb5b7363100b4470c4cd5ec2332e"><div class="ttname"><a href="../../dc/d4a/structast__bridge__video__mode.html#a827ffb5b7363100b4470c4cd5ec2332e">ast_bridge_video_mode::video_update_discard</a></div><div class="ttdeci">unsigned int video_update_discard</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00168">bridge.h:168</a></div></div>
<div class="ttc" id="bridge_8c_html_a948b63016c1f8deb90c43f8f94f68321"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a948b63016c1f8deb90c43f8f94f68321">wrap_hook</a></div><div class="ttdeci">static void wrap_hook(struct ast_bridge_features *features, struct ast_bridge_hook_timer *hook)</div><div class="ttdoc">Wrap the provided interval hook and add it to features. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03650">bridge.c:3650</a></div></div>
<div class="ttc" id="__private_8h_html"><div class="ttname"><a href="../../d4/d78/__private_8h.html">_private.h</a></div><div class="ttdoc">Prototypes for public functions only of internal interest,. </div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">ast_bridge_snapshot::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00336">bridge.h:336</a></div></div>
<div class="ttc" id="chan__pjsip_8c_html_a4e2e6fb7d874f0d2deddd2ecfc8afb32"><div class="ttname"><a href="../../d0/d29/chan__pjsip_8c.html#a4e2e6fb7d874f0d2deddd2ecfc8afb32">request</a></div><div class="ttdeci">static int request(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/chan__pjsip_8c_source.html#l02559">chan_pjsip.c:2559</a></div></div>
<div class="ttc" id="bridge_8c_html_a46076d7116497bc6fd9c69b57d15d18c"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a46076d7116497bc6fd9c69b57d15d18c">BLINDTRANSFER</a></div><div class="ttdeci">#define BLINDTRANSFER</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00136">bridge.c:136</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a3bf3c4e34892d0033814ab5fec0e006f"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a3bf3c4e34892d0033814ab5fec0e006f">ast_bridge_channel::swap</a></div><div class="ttdeci">struct ast_channel * swap</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00093">bridge_channel.h:93</a></div></div>
<div class="ttc" id="bridge__basic_8h_html"><div class="ttname"><a href="../../d4/d1e/bridge__basic_8h.html">bridge_basic.h</a></div><div class="ttdoc">Basic bridge subclass API. </div></div>
<div class="ttc" id="bridge_8c_html_a7132d0a0b71844641ce3a1035e05c67b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a7132d0a0b71844641ce3a1035e05c67b">ast_bridge_kick</a></div><div class="ttdeci">int ast_bridge_kick(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">Kick a channel from a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02025">bridge.c:2025</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a97e3bedeadf444995deb6fab68f57e21"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a97e3bedeadf444995deb6fab68f57e21">ast_bridge_snapshot::num_channels</a></div><div class="ttdeci">unsigned int num_channels</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00345">bridge.h:345</a></div></div>
<div class="ttc" id="bridge_8c_html_aafc3026d777c0bf6899e93263178e102"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a></div><div class="ttdeci">void ast_bridge_features_cleanup(struct ast_bridge_features *features)</div><div class="ttdoc">Clean up the contents of a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03720">bridge.c:3720</a></div></div>
<div class="ttc" id="bridge_8c_html_af9e2817e0750b1c972bb3b35f25ac5e1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af9e2817e0750b1c972bb3b35f25ac5e1">interval_wrapper_pvt_dtor</a></div><div class="ttdeci">static void interval_wrapper_pvt_dtor(void *obj)</div><div class="ttdoc">Destructor for the hook wrapper. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03644">bridge.c:3644</a></div></div>
<div class="ttc" id="bridge_8c_html_ad45098162b2df09235f632efb08a9681"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad45098162b2df09235f632efb08a9681">ast_bridge_peers_nolock</a></div><div class="ttdeci">struct ao2_container * ast_bridge_peers_nolock(struct ast_bridge *bridge)</div><div class="ttdoc">Get a container of all channels in the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04085">bridge.c:4085</a></div></div>
<div class="ttc" id="structast__bridge__hook__dtmf_html_a071aadb15e85b96f455641d6adbfdb71"><div class="ttname"><a href="../../dd/d92/structast__bridge__hook__dtmf.html#a071aadb15e85b96f455641d6adbfdb71">ast_bridge_hook_dtmf::generic</a></div><div class="ttdeci">struct ast_bridge_hook generic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00228">bridge_features.h:228</a></div></div>
<div class="ttc" id="structast__bridge_html_aa4d0ccb9d0904892652f2f258c5ad225"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#aa4d0ccb9d0904892652f2f258c5ad225">ast_bridge::cause</a></div><div class="ttdeci">int cause</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00394">bridge.h:394</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00047">bridge_features.h:47</a></div></div>
<div class="ttc" id="logger_8h_html"><div class="ttname"><a href="../../d1/d8c/logger_8h.html">logger.h</a></div><div class="ttdoc">Support for logging to various files, console and syslog Configuration in file logger.conf. </div></div>
<div class="ttc" id="bridge__after_8h_html_a1b15a371c654cfe77de053afe0994b9ca2a6093cf7896d7224f478d6b8883bed2"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9ca2a6093cf7896d7224f478d6b8883bed2">AST_BRIDGE_AFTER_CB_REASON_IMPART_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d85/bridge__after_8h_source.html#l00049">bridge_after.h:49</a></div></div>
<div class="ttc" id="heap_8h_html_a42b42e04887dbc86276e590141147f63"><div class="ttname"><a href="../../da/ddb/heap_8h.html#a42b42e04887dbc86276e590141147f63">ast_heap_create</a></div><div class="ttdeci">#define ast_heap_create(init_height, cmp_fn, index_offset)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ddb/heap_8h_source.html#l00102">heap.h:102</a></div></div>
<div class="ttc" id="channel_8h_html_a9b6409c38af733c46eead884d86dd284"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a></div><div class="ttdeci">struct ast_bridge_channel * ast_channel_get_bridge_channel(struct ast_channel *chan)</div><div class="ttdoc">Get a reference to the channel&amp;#39;s bridge pointer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10783">channel.c:10783</a></div></div>
<div class="ttc" id="bridge_8c_html_aec45146e91e4d8bc2a7d2cf083c4dac0"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aec45146e91e4d8bc2a7d2cf083c4dac0">ast_bridge_transfer_attended</a></div><div class="ttdeci">enum ast_transfer_result ast_bridge_transfer_attended(struct ast_channel *to_transferee, struct ast_channel *to_transfer_target)</div><div class="ttdoc">Attended transfer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04729">bridge.c:4729</a></div></div>
<div class="ttc" id="structtech__deferred__destroy_html_a19aa04db5508cf9496602e694dc69e2f"><div class="ttname"><a href="../../d0/df8/structtech__deferred__destroy.html#a19aa04db5508cf9496602e694dc69e2f">tech_deferred_destroy::tech_pvt</a></div><div class="ttdeci">void * tech_pvt</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00559">bridge.c:559</a></div></div>
<div class="ttc" id="bridge_8c_html_a648cca4e2d0e75ab65456c291ad1e11a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a648cca4e2d0e75ab65456c291ad1e11a">bridges_allow_merge_optimization</a></div><div class="ttdeci">static enum bridge_allow_merge bridges_allow_merge_optimization(struct ast_bridge *chan_bridge, struct ast_bridge *peer_bridge, int num_kick_channels, struct merge_direction *merge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02883">bridge.c:2883</a></div></div>
<div class="ttc" id="bridge_8h_html_ad52005264bec898a8f825bd47d91cf93"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93">ast_bridge_join_flags</a></div><div class="ttdeci">ast_bridge_join_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00547">bridge.h:547</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="channel_8h_html_a4a5bc2ea394aace55ea3809e53365ea9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a></div><div class="ttdeci">struct ast_format_cap * ast_channel_nativeformats(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00637">channel_internal_api.c:637</a></div></div>
<div class="ttc" id="bridge_8c_html_a85bc0d4138ac2af7b207d8f1325f051a"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a85bc0d4138ac2af7b207d8f1325f051a">ast_bridge_suspend</a></div><div class="ttdeci">int ast_bridge_suspend(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">Suspend a channel temporarily from a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03068">bridge.c:3068</a></div></div>
<div class="ttc" id="structast__bridge__softmix_html_a19c26f21e5b3f0f20ef838fd43db8ea9"><div class="ttname"><a href="../../d0/d50/structast__bridge__softmix.html#a19c26f21e5b3f0f20ef838fd43db8ea9">ast_bridge_softmix::send_sdp_label</a></div><div class="ttdeci">unsigned int send_sdp_label</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00308">bridge.h:308</a></div></div>
<div class="ttc" id="pbx_8h_html_a6e5b90edb84d216267148dddcffe9b9a"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a></div><div class="ttdeci">int pbx_builtin_setvar_helper(struct ast_channel *chan, const char *name, const char *value)</div><div class="ttdoc">Add a variable to the channel variable stack, removing the most recently set value for the same name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01071">pbx_variables.c:1071</a></div></div>
<div class="ttc" id="bridge_8c_html_ad820f44d2f7988332045260d21a41b50"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad820f44d2f7988332045260d21a41b50">bridge_channel_impart_add</a></div><div class="ttdeci">static int bridge_channel_impart_add(struct ast_channel *chan, struct bridge_channel_impart_cond *cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01593">bridge.c:1593</a></div></div>
<div class="ttc" id="channel_8h_html_a9e9505a91a84992d04ba4e85217fb4e4a085c0c603de12dc2474a17a92e1cb5a4"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a085c0c603de12dc2474a17a92e1cb5a4">AST_SOFTHANGUP_ASYNCGOTO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01127">channel.h:1127</a></div></div>
<div class="ttc" id="bridge_8c_html_a214c6742929d7db707c94d9856908e61"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a214c6742929d7db707c94d9856908e61">ast_bridge_set_binaural_active</a></div><div class="ttdeci">void ast_bridge_set_binaural_active(struct ast_bridge *bridge, unsigned int binaural_active)</div><div class="ttdoc">Activates the use of binaural signals in a conference bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03772">bridge.c:3772</a></div></div>
<div class="ttc" id="module_8h_html_ad2dd3dce05926913c40b883cc7cff0a8"><div class="ttname"><a href="../../d5/d16/module_8h.html#ad2dd3dce05926913c40b883cc7cff0a8">ast_module_running_ref</a></div><div class="ttdeci">#define ast_module_running_ref(mod)</div><div class="ttdoc">Hold a reference to the module if it is running. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00455">module.h:455</a></div></div>
<div class="ttc" id="bridge_8h_html_ab8ee807d2c3a21d19e16fedf35c90de8"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ab8ee807d2c3a21d19e16fedf35c90de8">ast_bridge_lock</a></div><div class="ttdeci">#define ast_bridge_lock(bridge)</div><div class="ttdoc">Lock the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00480">bridge.h:480</a></div></div>
<div class="ttc" id="structast__bridge__video__talker__src__data_html_ac10f96d9ddb17a9038083d909b2c7299"><div class="ttname"><a href="../../d0/dad/structast__bridge__video__talker__src__data.html#ac10f96d9ddb17a9038083d909b2c7299">ast_bridge_video_talker_src_data::average_talking_energy</a></div><div class="ttdeci">int average_talking_energy</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00124">bridge.h:124</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaff8d563ccbab36b41b093709681de2a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaff8d563ccbab36b41b093709681de2a">ao2_t_bump</a></div><div class="ttdeci">#define ao2_t_bump(obj, tag)</div><div class="ttdoc">Bump refcount on an AO2 object by one, returning the object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00483">astobj2.h:483</a></div></div>
<div class="ttc" id="channel_8h_html_a695e5b4fcf983db6451b583fbd647424"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a></div><div class="ttdeci">#define ast_channel_lock_both(chan1, chan2)</div><div class="ttdoc">Lock two channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02952">channel.h:2952</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a4d514eabb35f71dee132ef1df1c6cdbb"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a4d514eabb35f71dee132ef1df1c6cdbb">ast_bridge_snapshot::num_active</a></div><div class="ttdeci">unsigned int num_active</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00347">bridge.h:347</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_a9798f7ecff1382a175d9dfcf1e8334e6"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#a9798f7ecff1382a175d9dfcf1e8334e6">bridge_channel_internal_push</a></div><div class="ttdeci">int bridge_channel_internal_push(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l02315">bridge_channel.c:2315</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3aaffe52570f582bed6f59dc12ca2a5c9e"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3aaffe52570f582bed6f59dc12ca2a5c9e">AST_BRIDGE_HOOK_TYPE_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00193">bridge_features.h:193</a></div></div>
<div class="ttc" id="strings_8h_html_ab7cad97bd640223a24b4bd60ef0e406f"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ab7cad97bd640223a24b4bd60ef0e406f">AST_YESNO</a></div><div class="ttdeci">#define AST_YESNO(x)</div><div class="ttdoc">return Yes or No depending on the argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00139">strings.h:139</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00295">include/asterisk/frame.h:295</a></div></div>
<div class="ttc" id="bridge_8c_html_a7522973439e934a28037444ca5f56599"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a7522973439e934a28037444ca5f56599">bridge_base_push</a></div><div class="ttdeci">static int bridge_base_push(struct ast_bridge *self, struct ast_bridge_channel *bridge_channel, struct ast_bridge_channel *swap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00874">bridge.c:874</a></div></div>
<div class="ttc" id="structbridge__manager__controller_html_a4c0e99774fbc08689db34d6ad5104f35"><div class="ttname"><a href="../../d4/d7c/structbridge__manager__controller.html#a4c0e99774fbc08689db34d6ad5104f35">bridge_manager_controller::service_requests</a></div><div class="ttdeci">struct bridge_manager_controller::@348 service_requests</div></div>
<div class="ttc" id="channel_8h_html_adac99999f1e55833e7f903979d67b48b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#adac99999f1e55833e7f903979d67b48b">ast_channel_softhangup_internal_flag</a></div><div class="ttdeci">int ast_channel_softhangup_internal_flag(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00997">channel_internal_api.c:997</a></div></div>
<div class="ttc" id="structast__bridge_html_a77542a877d8ed62331c5b3b6aa3e87a7"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a77542a877d8ed62331c5b3b6aa3e87a7">ast_bridge::channels</a></div><div class="ttdeci">struct ast_bridge_channels_list channels</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00371">bridge.h:371</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="structast__datastore_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">ast_datastore::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00070">datastore.h:70</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadda916488b2d151af4426e2f06ad332"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_TAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00740">linkedlists.h:740</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="bridge_8c_html_a4c2435b74d16e617f7213dda3c25ffd7"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a4c2435b74d16e617f7213dda3c25ffd7">bridge_sort_cmp</a></div><div class="ttdeci">static int bridge_sort_cmp(const void *obj_left, const void *obj_right, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05048">bridge.c:5048</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0d1f922e093ac18824a7863fe3f5fa27"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT_NOLOCK(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00680">linkedlists.h:680</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">ast_bridge_channel::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00091">bridge_channel.h:91</a></div></div>
<div class="ttc" id="heap_8h_html_ac68d03b30bb0adc489ccd67a11873b59"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ac68d03b30bb0adc489ccd67a11873b59">ast_heap_remove</a></div><div class="ttdeci">void * ast_heap_remove(struct ast_heap *h, void *elm)</div><div class="ttdoc">Remove a specific element from a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00251">heap.c:251</a></div></div>
<div class="ttc" id="astobj2_8h_html_afe7a6b368052cb171d371d873b7520acadb2bfd83bc54a380d86d3a9b02d99c35"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520acadb2bfd83bc54a380d86d3a9b02d99c35">AO2_CONTAINER_ALLOC_OPT_DUPS_REPLACE</a></div><div class="ttdoc">Replace objects with duplicate keys in container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01215">astobj2.h:1215</a></div></div>
<div class="ttc" id="structast__bridge__channel_html"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a></div><div class="ttdoc">Structure that contains information regarding a channel in a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00084">bridge_channel.h:84</a></div></div>
<div class="ttc" id="bridge__after_8h_html"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html">bridge_after.h</a></div><div class="ttdoc">After Bridge Execution API. </div></div>
<div class="ttc" id="channel_8h_html_a6801c703e767d6f760c54c8b86a30024"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a></div><div class="ttdeci">#define ast_channel_ref(c)</div><div class="ttdoc">Increase channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02970">channel.h:2970</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_aeab2ad12e267a1bc7bfd840f1514f664"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#aeab2ad12e267a1bc7bfd840f1514f664">ast_bridge_methods::push_peek</a></div><div class="ttdeci">ast_bridge_push_channel_fn push_peek</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00281">bridge.h:281</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga68c55b443ba97dc157b493aafd05c876"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_get_latest(const char *uniqueid)</div><div class="ttdoc">Obtain the latest ast_channel_snapshot from the Stasis Message Bus API cache. This is an ao2 object...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00903">stasis_channels.c:903</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="bridge_8h_html_ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a48458f43dd7ef0372614e5848f9226e0">AST_BRIDGE_VIDEO_MODE_TALKER_SRC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00105">bridge.h:105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="cli_8h_html"><div class="ttname"><a href="../../dc/db0/cli_8h.html">cli.h</a></div><div class="ttdoc">Standard Command Line Interface. </div></div>
<div class="ttc" id="logger_8h_html_ac7388257651bb6a92d3208512fab0ba6"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac7388257651bb6a92d3208512fab0ba6">SCOPE_TRACE</a></div><div class="ttdeci">#define SCOPE_TRACE(level,...)</div><div class="ttdoc">Print a trace message with details when a scope is entered or existed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00749">logger.h:749</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a7d01ff5caf025a97796d2dbb78f5f02c"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a7d01ff5caf025a97796d2dbb78f5f02c">ast_bridge_channel_lock_bridge</a></div><div class="ttdeci">void ast_bridge_channel_lock_bridge(struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Lock the bridge associated with the bridge channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00222">bridge_channel.c:222</a></div></div>
<div class="ttc" id="bridge_8c_html_a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa4487981b551c70b49ec99c61e70a1396">SWAP_TO_PEER_BRIDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02726">bridge.c:2726</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="channel_8h_html_accf4e9753bd5d7316f4988e74486552b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a></div><div class="ttdeci">void ast_connected_line_copy_from_caller(struct ast_party_connected_line *dest, const struct ast_party_caller *src)</div><div class="ttdoc">Copy the caller information to the connected line information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08389">channel.c:8389</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="structast__bridge__features_html_a2918c32314a019cebcc4259e324a2745"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#a2918c32314a019cebcc4259e324a2745">ast_bridge_features::other_hooks</a></div><div class="ttdeci">struct ao2_container * other_hooks</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00267">bridge_features.h:267</a></div></div>
<div class="ttc" id="heap_8h_html_abb3efaa08e2b1e9423bbbd5e3d9d2acc"><div class="ttname"><a href="../../da/ddb/heap_8h.html#abb3efaa08e2b1e9423bbbd5e3d9d2acc">ast_heap_size</a></div><div class="ttdeci">size_t ast_heap_size(struct ast_heap *h)</div><div class="ttdoc">Get the current size of a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00276">heap.c:276</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_a46acfb8805bd7c339b2c8300a154e9e8"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#a46acfb8805bd7c339b2c8300a154e9e8">bridge_channel_internal_alloc</a></div><div class="ttdeci">struct ast_bridge_channel * bridge_channel_internal_alloc(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l03151">bridge_channel.c:3151</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="core__local_8h_html_a2ed2a62610af1f7e8c25b89001e35963"><div class="ttname"><a href="../../d5/da6/core__local_8h.html#a2ed2a62610af1f7e8c25b89001e35963">ast_local_unlock_all</a></div><div class="ttdeci">void ast_local_unlock_all(void *tech_pvt, struct ast_channel *base_chan, struct ast_channel *base_owner)</div><div class="ttdoc">Remove a reference to the given local channel&amp;#39;s private tech, unlock the given local channel&amp;#39;s privat...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/core__local_8c_source.html#l00256">core_local.c:256</a></div></div>
<div class="ttc" id="bridge_8c_html_a24bb22d467a5f840fe8c954f9c7624d1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a24bb22d467a5f840fe8c954f9c7624d1">ast_bridge_technology_unsuspend</a></div><div class="ttdeci">void ast_bridge_technology_unsuspend(struct ast_bridge_technology *technology)</div><div class="ttdoc">Unsuspend a bridge technology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03113">bridge.c:3113</a></div></div>
<div class="ttc" id="structast__cli__args_html_a4b911d12699acbbb5a8b62355b35bae8"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">ast_cli_args::pos</a></div><div class="ttdeci">const int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00164">cli.h:164</a></div></div>
<div class="ttc" id="bridge_8h_html_a22e0b20cf0d941c2acc0710600c1c35b"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a22e0b20cf0d941c2acc0710600c1c35b">ast_bridge_video_sfu_remb_behavior</a></div><div class="ttdeci">ast_bridge_video_sfu_remb_behavior</div><div class="ttdoc">REMB report behaviors. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00131">bridge.h:131</a></div></div>
<div class="ttc" id="structast__bridge__technology_html"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html">ast_bridge_technology</a></div><div class="ttdoc">Structure that is the essence of a bridge technology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00061">bridge_technology.h:61</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ac352fd6d6188d7431155f34ae2a38799"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ac352fd6d6188d7431155f34ae2a38799">ast_bridge_channel_queue_playfile</a></div><div class="ttdeci">int ast_bridge_channel_queue_playfile(struct ast_bridge_channel *bridge_channel, ast_bridge_custom_play_fn custom_play, const char *playfile, const char *moh_class)</div><div class="ttdoc">Queue a bridge action play file frame onto the bridge channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01404">bridge_channel.c:1404</a></div></div>
<div class="ttc" id="bridge_8c_html_a488815ff58d7ea1d8f5e7ce0ef370df5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a488815ff58d7ea1d8f5e7ce0ef370df5">ast_bridge_features_remove</a></div><div class="ttdeci">void ast_bridge_features_remove(struct ast_bridge_features *features, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Remove marked bridge channel feature hooks. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03568">bridge.c:3568</a></div></div>
<div class="ttc" id="structast__bridge__video__talker__src__data_html_af17523bbee86cea3e7c6959258436728"><div class="ttname"><a href="../../d0/dad/structast__bridge__video__talker__src__data.html#af17523bbee86cea3e7c6959258436728">ast_bridge_video_talker_src_data::chan_vsrc</a></div><div class="ttdeci">struct ast_channel * chan_vsrc</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00123">bridge.h:123</a></div></div>
<div class="ttc" id="bridge_8c_html_a9e067daed125a4ea2ad369790c093cfaa11c04bbc25aef5e5c5628ef5d9ccc5c9"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaa11c04bbc25aef5e5c5628ef5d9ccc5c9">SWAP_PROHIBITED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02722">bridge.c:2722</a></div></div>
<div class="ttc" id="bridge_8c_html_ad06dce4a79c1071d41110753c9f7468b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad06dce4a79c1071d41110753c9f7468b">get_transferee</a></div><div class="ttdeci">static struct ast_channel * get_transferee(struct ao2_container *channels, struct ast_channel *transferer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04241">bridge.c:4241</a></div></div>
<div class="ttc" id="bridge_8h_html_a815c9b3e933dfd4b8f523cf55caa5bbfab01df717450b48e5a7ba5003df49c955"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfab01df717450b48e5a7ba5003df49c955">AST_BRIDGE_CAPABILITY_EARLY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00088">bridge.h:88</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="channel_8h_html_aec583a3e25358ee552a4f3df53914cd0"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aec583a3e25358ee552a4f3df53914cd0">ast_answer</a></div><div class="ttdeci">int ast_answer(struct ast_channel *chan)</div><div class="ttdoc">Answer a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02814">channel.c:2814</a></div></div>
<div class="ttc" id="bridge_8c_html_aeb11f378e45f0beb05de964b3af9a6bc"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aeb11f378e45f0beb05de964b3af9a6bc">ast_bridge_notify_masquerade</a></div><div class="ttdeci">void ast_bridge_notify_masquerade(struct ast_channel *chan)</div><div class="ttdoc">Notify bridging that this channel was just masqueraded. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01482">bridge.c:1482</a></div></div>
<div class="ttc" id="structast__bridge_html_a19fea4d448628d518b0043b2b17037dd"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a19fea4d448628d518b0043b2b17037dd">ast_bridge::media_types</a></div><div class="ttdeci">struct ast_vector_int media_types</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00412">bridge.h:412</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_aa6955fc24cd777947bb8c97011c55de2"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#aa6955fc24cd777947bb8c97011c55de2">bridge_channel_internal_queue_attended_transfer</a></div><div class="ttdeci">int bridge_channel_internal_queue_attended_transfer(struct ast_channel *transferee, struct ast_channel *unbridged_chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l03088">bridge_channel.c:3088</a></div></div>
<div class="ttc" id="structtransfer__channel__data_html"><div class="ttname"><a href="../../da/d84/structtransfer__channel__data.html">transfer_channel_data</a></div><div class="ttdoc">AO2 object that wraps data for transfer_channel_cb. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01136">bridge.h:1136</a></div></div>
<div class="ttc" id="bridge_8c_html_aad34a20efdcfd5b19f83b5add802d9f2"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aad34a20efdcfd5b19f83b5add802d9f2">ast_bridge_interval_register</a></div><div class="ttdeci">int ast_bridge_interval_register(enum ast_bridge_builtin_interval interval, ast_bridge_builtin_set_limits_fn callback)</div><div class="ttdoc">Register a handler for a built in interval feature. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03168">bridge.c:3168</a></div></div>
<div class="ttc" id="heap_8h_html_aaa326b988236a0841d41cf2af8ec9b7e"><div class="ttname"><a href="../../da/ddb/heap_8h.html#aaa326b988236a0841d41cf2af8ec9b7e">ast_heap_peek</a></div><div class="ttdeci">void * ast_heap_peek(struct ast_heap *h, unsigned int index)</div><div class="ttdoc">Peek at an element on a heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d29/heap_8c_source.html#l00267">heap.c:267</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_aa464f1acd378d6a297a514007cec8d18"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#aa464f1acd378d6a297a514007cec8d18">ast_bridge_channel_stream_map</a></div><div class="ttdeci">void ast_bridge_channel_stream_map(struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Maps a channel&amp;#39;s stream topology to and from the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l03174">bridge_channel.c:3174</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="bridge_8h_html_ab388dac5f5c172d7f03c54487afac906a51708384777e8722fae674ea8db89f54"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ab388dac5f5c172d7f03c54487afac906a51708384777e8722fae674ea8db89f54">AST_BRIDGE_VIDEO_MODE_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00100">bridge.h:100</a></div></div>
<div class="ttc" id="causes_8h_html"><div class="ttname"><a href="../../d4/da3/causes_8h.html">causes.h</a></div><div class="ttdoc">Internal Asterisk hangup causes. </div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_acd65272991204985a1c6ca5a30769472"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#acd65272991204985a1c6ca5a30769472">bridge_channel_internal_join</a></div><div class="ttdeci">int bridge_channel_internal_join(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l02902">bridge_channel.c:2902</a></div></div>
<div class="ttc" id="structtech__deferred__destroy_html"><div class="ttname"><a href="../../d0/df8/structtech__deferred__destroy.html">tech_deferred_destroy</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00557">bridge.c:557</a></div></div>
<div class="ttc" id="structast__bridge__hook_html_a63f1cef589bcc7abe6bef918ff5372de"><div class="ttname"><a href="../../da/d3b/structast__bridge__hook.html#a63f1cef589bcc7abe6bef918ff5372de">ast_bridge_hook::remove_flags</a></div><div class="ttdeci">struct ast_flags remove_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00209">bridge_features.h:209</a></div></div>
<div class="ttc" id="structast__cli__args_html"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html">ast_cli_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00158">cli.h:158</a></div></div>
<div class="ttc" id="options_8h_html"><div class="ttname"><a href="../../d7/d5b/options_8h.html">options.h</a></div><div class="ttdoc">Options provided by main asterisk program. </div></div>
<div class="ttc" id="structast__bridge_html_a19aa04db5508cf9496602e694dc69e2f"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a19aa04db5508cf9496602e694dc69e2f">ast_bridge::tech_pvt</a></div><div class="ttdeci">void * tech_pvt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00365">bridge.h:365</a></div></div>
<div class="ttc" id="bridge_8c_html_a46b990e3c3b853c3f9d19f2924dff5d1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a46b990e3c3b853c3f9d19f2924dff5d1">ast_bridge_set_video_update_discard</a></div><div class="ttdeci">void ast_bridge_set_video_update_discard(struct ast_bridge *bridge, unsigned int video_update_discard)</div><div class="ttdoc">Set the amount of time to discard subsequent video updates after a video update has been sent...</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03849">bridge.c:3849</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a025ede890af287961d3a98d0e634a62b"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a></div><div class="ttdeci">static struct test_val b</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">test_linkedlists.c:47</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="bridge_8h_html_a87ed18cc739a9635c4595cae783ab993"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a87ed18cc739a9635c4595cae783ab993">transfer_channel_cb</a></div><div class="ttdeci">void(* transfer_channel_cb)(struct ast_channel *chan, struct transfer_channel_data *user_data, enum ast_transfer_type transfer_type)</div><div class="ttdoc">Callback function type called during blind transfers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01160">bridge.h:1160</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_adcfc7ef2b1ee5305158a584970ddea65"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#adcfc7ef2b1ee5305158a584970ddea65">ast_bridge_methods::pull</a></div><div class="ttdeci">ast_bridge_pull_channel_fn pull</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00275">bridge.h:275</a></div></div>
<div class="ttc" id="bridge_8c_html_ab01c130ded2ec421cf217cc1d5d98816"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab01c130ded2ec421cf217cc1d5d98816">bridge_action_bridge</a></div><div class="ttdeci">static void bridge_action_bridge(struct ast_bridge *bridge, struct ast_frame *action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00604">bridge.c:604</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9657c4f40f012fc1d426c3c94b3d32c0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a></div><div class="ttdeci">#define ao2_container_alloc_rbtree(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01358">astobj2.h:1358</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_abc0302bab9fb2f318db695fe1f9047d8"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#abc0302bab9fb2f318db695fe1f9047d8">ast_bridge_channel_queue_control_data</a></div><div class="ttdeci">int ast_bridge_channel_queue_control_data(struct ast_bridge_channel *bridge_channel, enum ast_control_frame_type control, const void *data, size_t datalen)</div><div class="ttdoc">Queue a control frame onto the bridge channel with data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01143">bridge_channel.c:1143</a></div></div>
<div class="ttc" id="app__confbridge_8c_html_ac43e427fd7bbe26987bbeed52777898d"><div class="ttname"><a href="../../d0/dcf/app__confbridge_8c.html#ac43e427fd7bbe26987bbeed52777898d">play_file</a></div><div class="ttdeci">static int play_file(struct ast_bridge_channel *bridge_channel, struct ast_channel *channel, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dcf/app__confbridge_8c_source.html#l00928">app_confbridge.c:928</a></div></div>
<div class="ttc" id="bridge_8h_html_ac086b7d74fb40c2ede8514274585b101"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ac086b7d74fb40c2ede8514274585b101">ast_bridge_impart_flags</a></div><div class="ttdeci">ast_bridge_impart_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00598">bridge.h:598</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_abf4c4f9d73d43950e5e1882db332f00b"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#abf4c4f9d73d43950e5e1882db332f00b">ast_bridge_methods::destroy</a></div><div class="ttdeci">ast_bridge_destructor_fn destroy</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00269">bridge.h:269</a></div></div>
<div class="ttc" id="datastore_8h_html_a666afb07fd77d50782cc10f83e029159"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc</a></div><div class="ttdeci">#define ast_datastore_alloc(info, uid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00089">datastore.h:89</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_a60b76bf280f288b3ef3f1facf873b104"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#a60b76bf280f288b3ef3f1facf873b104">ast_bridge_methods::push</a></div><div class="ttdeci">ast_bridge_push_channel_fn push</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00273">bridge.h:273</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structast__bridge__features_html_a735823cab1fbe5881c54cd1493d27e80"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html#a735823cab1fbe5881c54cd1493d27e80">ast_bridge_features::interval_sequence</a></div><div class="ttdeci">unsigned int interval_sequence</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00273">bridge_features.h:273</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="bridge_8c_html_ad5496403d428bccf4dfffed404bb927e"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ad5496403d428bccf4dfffed404bb927e">check_bridge_play_sound</a></div><div class="ttdeci">static void check_bridge_play_sound(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01203">bridge.c:1203</a></div></div>
<div class="ttc" id="structbridge__manager__controller_html"><div class="ttname"><a href="../../d4/d7c/structbridge__manager__controller.html">bridge_manager_controller</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00160">bridge.c:160</a></div></div>
<div class="ttc" id="bridge__internal_8h_html"><div class="ttname"><a href="../../d5/dde/bridge__internal_8h.html">bridge_internal.h</a></div><div class="ttdoc">Private Bridging API. </div></div>
<div class="ttc" id="bridge_8c_html_a11e10081e2a144749472fbecb120bdb1"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a11e10081e2a144749472fbecb120bdb1">bridge_base_push_peek</a></div><div class="ttdeci">static int bridge_base_push_peek(struct ast_bridge *self, struct ast_bridge_channel *bridge_channel, struct ast_bridge_channel *swap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00944">bridge.c:944</a></div></div>
<div class="ttc" id="lock_8h_html_a76e8ed6bb354be6c6dd9e51acc1d7a1b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a></div><div class="ttdeci">#define ast_mutex_init(pmutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00184">lock.h:184</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3ab1e55b40373b3dda769e106081d9dbf1"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3ab1e55b40373b3dda769e106081d9dbf1">AST_BRIDGE_HOOK_TYPE_MOVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00197">bridge_features.h:197</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="cli_8h_html_a29e703082f8137e165097c41f249e6d1"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a></div><div class="ttdeci">#define AST_CLI_YESNO(x)</div><div class="ttdoc">Return Yes or No depending on the argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00071">cli.h:71</a></div></div>
<div class="ttc" id="channel_8h_html_a7dc0d696d897c864c6f41a3a1795c82e"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7dc0d696d897c864c6f41a3a1795c82e">ast_channel_trylock</a></div><div class="ttdeci">#define ast_channel_trylock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02947">channel.h:2947</a></div></div>
<div class="ttc" id="bridge_8c_html_af1a0d3e827043d45b8326ae30f23a116"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#af1a0d3e827043d45b8326ae30f23a116">bridge_tech_deferred_destroy</a></div><div class="ttdeci">static void bridge_tech_deferred_destroy(struct ast_bridge *bridge, struct ast_frame *action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00574">bridge.c:574</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_aad730dbfaf13dfa770055ce31d0a45e4"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#aad730dbfaf13dfa770055ce31d0a45e4">ast_bridge_channel::depart_wait</a></div><div class="ttdeci">unsigned int depart_wait</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00129">bridge_channel.h:129</a></div></div>
<div class="ttc" id="time_8h_html_a6414288234db8cadefa9680e8ac0f968"><div class="ttname"><a href="../../de/df7/time_8h.html#a6414288234db8cadefa9680e8ac0f968">ast_format_duration_hh_mm_ss</a></div><div class="ttdeci">void ast_format_duration_hh_mm_ss(int duration, char *buf, size_t length)</div><div class="ttdoc">Formats a duration into HH:MM:SS. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02049">main/utils.c:2049</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a7bdfd8273bb885f7a65f6f5d8188c915"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a7bdfd8273bb885f7a65f6f5d8188c915">ast_bridge_topic</a></div><div class="ttdeci">struct stasis_topic * ast_bridge_topic(struct ast_bridge *bridge)</div><div class="ttdoc">A topic which publishes the events for a particular bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00184">stasis_bridges.c:184</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="features_8h_html"><div class="ttname"><a href="../../de/d47/features_8h.html">features.h</a></div><div class="ttdoc">Call Parking and Pickup API Includes code and algorithms from the Zapata library. ...</div></div>
<div class="ttc" id="channel_8h_html_a91de92158876186d28ba1773877f2732"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a></div><div class="ttdeci">struct ast_flags * ast_channel_flags(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01260">channel_internal_api.c:1260</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_af2e29d0c7f999e958eb80500c411b374"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#af2e29d0c7f999e958eb80500c411b374">ast_bridge_technology::create</a></div><div class="ttdeci">int(* create)(struct ast_bridge *bridge)</div><div class="ttdoc">Create a bridge technology instance for a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00078">bridge_technology.h:78</a></div></div>
<div class="ttc" id="lock_8h_html_ab8977a71822daa556f19f30ba6eec765"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a></div><div class="ttdeci">#define ast_mutex_destroy(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00186">lock.h:186</a></div></div>
<div class="ttc" id="bridge_8c_html_ac608985a552294f9151429f01f5c9d8b"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ac608985a552294f9151429f01f5c9d8b">handle_bridge_technology_show</a></div><div class="ttdeci">static char * handle_bridge_technology_show(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05355">bridge.c:5355</a></div></div>
<div class="ttc" id="bridge_8c_html_a15a9caea3551b28025d36c0d0ca885e9"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a15a9caea3551b28025d36c0d0ca885e9">manager_bridge_tech_list</a></div><div class="ttdeci">static int manager_bridge_tech_list(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05518">bridge.c:5518</a></div></div>
<div class="ttc" id="core__local_8c_html_aef9f33a8f0b0099c02a84d0c01d77aab"><div class="ttname"><a href="../../de/d47/core__local_8c.html#aef9f33a8f0b0099c02a84d0c01d77aab">locals</a></div><div class="ttdeci">static struct ao2_container * locals</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/core__local_8c_source.html#l00138">core_local.c:138</a></div></div>
<div class="ttc" id="bridge_8c_html_a66d6a521530f4fb208eb8ee33e257b6c"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a66d6a521530f4fb208eb8ee33e257b6c">ast_bridge_remove</a></div><div class="ttdeci">int ast_bridge_remove(struct ast_bridge *bridge, struct ast_channel *chan)</div><div class="ttdoc">Remove a channel from a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01997">bridge.c:1997</a></div></div>
<div class="ttc" id="structast__bridge_html_a6e62c2774ca18846e6e45057fb8b7a22"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a6e62c2774ca18846e6e45057fb8b7a22">ast_bridge::creator</a></div><div class="ttdeci">const ast_string_field creator</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00409">bridge.h:409</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00036">codec.h:36</a></div></div>
<div class="ttc" id="bridge_8c_html_acbc344c8fa0a95134e759c71b87af890"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#acbc344c8fa0a95134e759c71b87af890">ast_bridge_unreal_optimize_out</a></div><div class="ttdeci">int ast_bridge_unreal_optimize_out(struct ast_channel *chan, struct ast_channel *peer, struct ast_unreal_pvt *pvt)</div><div class="ttdoc">Check and optimize out the unreal channels between bridges. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02968">bridge.c:2968</a></div></div>
<div class="ttc" id="cli_8h_html_a6f5f6c330757d980065d3f887c62237f"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a></div><div class="ttdeci">int ast_cli_completion_add(char *value)</div><div class="ttdoc">Add a result to a request for completion options. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd3/main_2cli_8c_source.html#l02726">main/cli.c:2726</a></div></div>
<div class="ttc" id="bridge_8c_html_ac31ac154d47208c964f68cb3f03cb997"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ac31ac154d47208c964f68cb3f03cb997">bridge_handle_actions</a></div><div class="ttdeci">static void bridge_handle_actions(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00640">bridge.c:640</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_abec87c9a1f3c9607a841cdf035ae95fd"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#abec87c9a1f3c9607a841cdf035ae95fd">ast_attended_transfer_message_add_link</a></div><div class="ttdeci">int ast_attended_transfer_message_add_link(struct ast_attended_transfer_message *transfer_msg, struct ast_channel *locals[2])</div><div class="ttdoc">Add details for an attended transfer that has a link between bridges. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01330">stasis_bridges.c:1330</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a4be080559ea3fc87e50aa29a95af74f0"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a4be080559ea3fc87e50aa29a95af74f0">ast_bridge_channel_write_unhold</a></div><div class="ttdeci">int ast_bridge_channel_write_unhold(struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Write an unhold frame into the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01193">bridge_channel.c:1193</a></div></div>
<div class="ttc" id="say_8h_html"><div class="ttname"><a href="../../db/dce/say_8h.html">say.h</a></div><div class="ttdoc">Say numbers and dates (maybe words one day too) </div></div>
<div class="ttc" id="stasis__bridges_8h_html_a5d80b41bade979c37596d850cfcf3e64"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a5d80b41bade979c37596d850cfcf3e64">ast_attended_transfer_message_create</a></div><div class="ttdeci">struct ast_attended_transfer_message * ast_attended_transfer_message_create(int is_external, struct ast_channel *to_transferee, struct ast_bridge *transferee_bridge, struct ast_channel *to_transfer_target, struct ast_bridge *target_bridge, struct ast_channel *transferee, struct ast_channel *transfer_target)</div><div class="ttdoc">Create an Attended transfer message to be published. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01226">stasis_bridges.c:1226</a></div></div>
<div class="ttc" id="bridge_8h_html_ad52005264bec898a8f825bd47d91cf93a9106169928c6eeccad5b5ebcf762ac9d"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93a9106169928c6eeccad5b5ebcf762ac9d">AST_BRIDGE_JOIN_PASS_REFERENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00549">bridge.h:549</a></div></div>
<div class="ttc" id="bridge_8c_html_a8a14f1c30f04c6d50dac556cf53e1201"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a8a14f1c30f04c6d50dac556cf53e1201">ast_bridge_set_mixing_interval</a></div><div class="ttdeci">void ast_bridge_set_mixing_interval(struct ast_bridge *bridge, unsigned int mixing_interval)</div><div class="ttdoc">Adjust the internal mixing interval of a bridge used during multimix mode. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03765">bridge.c:3765</a></div></div>
<div class="ttc" id="bridge_8h_html"><div class="ttname"><a href="../../d4/d56/bridge_8h.html">bridge.h</a></div><div class="ttdoc">Bridging API. </div></div>
<div class="ttc" id="app__mysql_8c_html_a1d9b1eccfc259a14525ce817482a3f88"><div class="ttname"><a href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a></div><div class="ttdeci">static const char app[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db6/app__mysql_8c_source.html#l00062">app_mysql.c:62</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_a9aed6490b63794e6c9c00af4533f255f"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a></div><div class="ttdeci">static struct ast_timer * timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l00360">chan_iax2.c:360</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaad84ac14921aab9ebb49fdf063ee22853">BRIDGE_CHANNEL_STATE_WAIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00062">bridge_channel.h:62</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_ac53486d83b1e8c097744f32d269a3ff3"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#ac53486d83b1e8c097744f32d269a3ff3">ast_bridge_technology::stop</a></div><div class="ttdeci">void(* stop)(struct ast_bridge *bridge)</div><div class="ttdoc">Request a bridge technology instance stop in preparation for being destroyed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00094">bridge_technology.h:94</a></div></div>
<div class="ttc" id="test__config_8c_html_a8fe0bda13f4abb5bd412745f0f9891da"><div class="ttname"><a href="../../d8/d4f/test__config_8c.html#a8fe0bda13f4abb5bd412745f0f9891da">hook_cb</a></div><div class="ttdeci">static int hook_cb(struct ast_config *cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/test__config_8c_source.html#l00875">test_config.c:875</a></div></div>
<div class="ttc" id="bridge_8c_html_a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a9e067daed125a4ea2ad369790c093cfaafc15e1858037cbeb19e5cb5187e6eeb8">SWAP_TO_CHAN_BRIDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02724">bridge.c:2724</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="module_8h_html"><div class="ttname"><a href="../../d5/d16/module_8h.html">module.h</a></div><div class="ttdoc">Asterisk module definitions. </div></div>
<div class="ttc" id="bridge_8c_html_ac529e02d743fa8b819a18cf73c5ffa87"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ac529e02d743fa8b819a18cf73c5ffa87">bridge_impart_internal</a></div><div class="ttdeci">static int bridge_impart_internal(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_channel *swap, struct ast_bridge_features *features, enum ast_bridge_impart_flags flags, struct bridge_channel_impart_cond *cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01823">bridge.c:1823</a></div></div>
<div class="ttc" id="bridge_8c_html_aa89a2daf4c905161701f1cf65fe3db40"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aa89a2daf4c905161701f1cf65fe3db40">BRIDGE_LOCK_ONE_OR_BOTH</a></div><div class="ttdeci">#define BRIDGE_LOCK_ONE_OR_BOTH(b1, b2)</div></div>
<div class="ttc" id="structast__bridge__snapshot_html_aed90bb628ee273a4b27b778b5b0d8ec2"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#aed90bb628ee273a4b27b778b5b0d8ec2">ast_bridge_snapshot::subclass</a></div><div class="ttdeci">const ast_string_field subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00336">bridge.h:336</a></div></div>
<div class="ttc" id="structast__bridge__softmix_html_ac4a5819e66f436d283aa19d986f04e52"><div class="ttname"><a href="../../d0/d50/structast__bridge__softmix.html#ac4a5819e66f436d283aa19d986f04e52">ast_bridge_softmix::internal_sample_rate</a></div><div class="ttdeci">unsigned int internal_sample_rate</div><div class="ttdoc">The internal sample rate softmix uses to mix channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00293">bridge.h:293</a></div></div>
<div class="ttc" id="bridge_8h_html_a186f44efd65f1349ca2deb11b8117534"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534">ast_bridge_optimization</a></div><div class="ttdeci">ast_bridge_optimization</div><div class="ttdoc">Tells, if optimization is allowed, how the optimization would be performed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00891">bridge.h:891</a></div></div>
<div class="ttc" id="bridge_8c_html_a982e0e652b9f03abf1ec584c137791a3"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a982e0e652b9f03abf1ec584c137791a3">ast_bridge_transfer_blind</a></div><div class="ttdeci">enum ast_transfer_result ast_bridge_transfer_blind(int is_external, struct ast_channel *transferer, const char *exten, const char *context, transfer_channel_cb new_channel_cb, void *user_data)</div><div class="ttdoc">Blind transfer target to the extension and context provided. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04477">bridge.c:4477</a></div></div>
<div class="ttc" id="bridge_8c_html_a4066f3edf4ad39950014db569528f051"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a4066f3edf4ad39950014db569528f051">bridge_cli</a></div><div class="ttdeci">static struct ast_cli_entry bridge_cli[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05462">bridge.c:5462</a></div></div>
<div class="ttc" id="bridge_8c_html_a2e2014a0a213113e3fbc31077aea31a5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a2e2014a0a213113e3fbc31077aea31a5">bridge_channel_impart_ds_head_fixup</a></div><div class="ttdeci">static void bridge_channel_impart_ds_head_fixup(void *data, struct ast_channel *old_chan, struct ast_channel *new_chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01567">bridge.c:1567</a></div></div>
<div class="ttc" id="core__unreal_8h_html_abc6dcce8e64173a023700dd4288d7c97a73803b5d3e3bb9524f6d741e854f201e"><div class="ttname"><a href="../../de/dea/core__unreal_8h.html#abc6dcce8e64173a023700dd4288d7c97a73803b5d3e3bb9524f6d741e854f201e">AST_UNREAL_CHAN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dea/core__unreal_8h_source.html#l00051">core_unreal.h:51</a></div></div>
<div class="ttc" id="channel_8h_html_a1ed3e98d33d5587948a0e2ef67a81f52"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1ed3e98d33d5587948a0e2ef67a81f52">ast_channel_datastore_add</a></div><div class="ttdeci">int ast_channel_datastore_add(struct ast_channel *chan, struct ast_datastore *datastore)</div><div class="ttdoc">Add a datastore to a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02390">channel.c:2390</a></div></div>
<div class="ttc" id="structast__bridge__tech__optimizations_html"><div class="ttname"><a href="../../d6/d97/structast__bridge__tech__optimizations.html">ast_bridge_tech_optimizations</a></div><div class="ttdoc">Structure specific to bridge technologies capable of performing talking optimizations. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00048">bridge_technology.h:48</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
<div class="ttc" id="core__local_8h_html_ac2e6544ffc24e3c97e1b028c1d5a4957"><div class="ttname"><a href="../../d5/da6/core__local_8h.html#ac2e6544ffc24e3c97e1b028c1d5a4957">ast_local_setup_masquerade</a></div><div class="ttdeci">int ast_local_setup_masquerade(struct ast_channel *ast, struct ast_channel *masq)</div><div class="ttdoc">Setup the outgoing local channel to masquerade into a channel on ast_call(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/core__local_8c_source.html#l00641">core_local.c:641</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html">app.h</a></div><div class="ttdoc">Application convenience functions, designed to give consistent look and feel to Asterisk apps...</div></div>
<div class="ttc" id="channel_8h_html_affc167c91eb29d524a3dda826715a695"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#affc167c91eb29d524a3dda826715a695">ast_channel_has_audio_frame_or_monitor</a></div><div class="ttdeci">int ast_channel_has_audio_frame_or_monitor(struct ast_channel *chan)</div><div class="ttdoc">Check if the channel has active audiohooks, active framehooks, or a monitor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02523">channel.c:2523</a></div></div>
<div class="ttc" id="structast__bridge__technology_html_a04532f57b1eebac73f24b2a02dab161f"><div class="ttname"><a href="../../d1/d04/structast__bridge__technology.html#a04532f57b1eebac73f24b2a02dab161f">ast_bridge_technology::capabilities</a></div><div class="ttdeci">uint32_t capabilities</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3b/bridge__technology_8h_source.html#l00066">bridge_technology.h:66</a></div></div>
<div class="ttc" id="bridge__channel__internal_8h_html_abbcf6b683169c58f6441e3956257c827"><div class="ttname"><a href="../../d9/dfc/bridge__channel__internal_8h.html#abbcf6b683169c58f6441e3956257c827">bridge_channel_internal_pull</a></div><div class="ttdeci">void bridge_channel_internal_pull(struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l02178">bridge_channel.c:2178</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a075388377d67766550e9e53761404b99"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a075388377d67766550e9e53761404b99">ast_bridge_publish_merge</a></div><div class="ttdeci">void ast_bridge_publish_merge(struct ast_bridge *to, struct ast_bridge *from)</div><div class="ttdoc">Publish a bridge merge. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00460">stasis_bridges.c:460</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="structast__bridge__hook__dtmf__parms_html_a112bc20acdbae84f53c59cffc6bf3a94"><div class="ttname"><a href="../../d3/d00/structast__bridge__hook__dtmf__parms.html#a112bc20acdbae84f53c59cffc6bf3a94">ast_bridge_hook_dtmf_parms::code</a></div><div class="ttdeci">char code[MAXIMUM_DTMF_FEATURE_STRING]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00222">bridge_features.h:222</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a122c52bc5dec74974f3d4cf3870e7da3a560e70ed0a87b3e30f0e332cfebec8ee"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a122c52bc5dec74974f3d4cf3870e7da3a560e70ed0a87b3e30f0e332cfebec8ee">AST_BRIDGE_HOOK_TYPE_JOIN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00194">bridge_features.h:194</a></div></div>
<div class="ttc" id="structast__bridge_html_afe58250d4d4352ae4f0da4012ed4e9fa"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#afe58250d4d4352ae4f0da4012ed4e9fa">ast_bridge::allowed_capabilities</a></div><div class="ttdeci">uint32_t allowed_capabilities</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00379">bridge.h:379</a></div></div>
<div class="ttc" id="structast__bridge__softmix_html_a20440d4454d1d575acbba1e14c39cb28"><div class="ttname"><a href="../../d0/d50/structast__bridge__softmix.html#a20440d4454d1d575acbba1e14c39cb28">ast_bridge_softmix::maximum_sample_rate</a></div><div class="ttdeci">unsigned int maximum_sample_rate</div><div class="ttdoc">The maximum sample rate softmix uses to mix channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00314">bridge.h:314</a></div></div>
<div class="ttc" id="structast__bridge__hook_html"><div class="ttname"><a href="../../da/d3b/structast__bridge__hook.html">ast_bridge_hook</a></div><div class="ttdoc">Structure that is the essence of a feature hook. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00201">bridge_features.h:201</a></div></div>
<div class="ttc" id="bridge_8c_html_a3cc48dec5fd6f558ac127f3a4fe50fe8"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3cc48dec5fd6f558ac127f3a4fe50fe8">bridge_base_dissolving</a></div><div class="ttdeci">static void bridge_base_dissolving(struct ast_bridge *self)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00854">bridge.c:854</a></div></div>
<div class="ttc" id="structast__bridge_html_a97e3bedeadf444995deb6fab68f57e21"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a97e3bedeadf444995deb6fab68f57e21">ast_bridge::num_channels</a></div><div class="ttdeci">unsigned int num_channels</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00381">bridge.h:381</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a6231027722f2bdd4093d15defa0d7b94"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a6231027722f2bdd4093d15defa0d7b94">ast_bridge_setup_after_goto</a></div><div class="ttdeci">int ast_bridge_setup_after_goto(struct ast_channel *chan)</div><div class="ttdoc">Setup any after bridge goto location to begin execution. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00447">bridge_after.c:447</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
<div class="ttc" id="bridge_8c_html_aabeca6aae7e5db0dfe25ab88c1a40b07"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aabeca6aae7e5db0dfe25ab88c1a40b07">ast_bridge_add_channel</a></div><div class="ttdeci">int ast_bridge_add_channel(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_bridge_features *features, int play_tone, const char *xfersound)</div><div class="ttdoc">Add an arbitrary channel to a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02519">bridge.c:2519</a></div></div>
<div class="ttc" id="structast__bridge__video__mode_html_ac651801cf270dd2ba5cb81ec5c786308"><div class="ttname"><a href="../../dc/d4a/structast__bridge__video__mode.html#ac651801cf270dd2ba5cb81ec5c786308">ast_bridge_video_mode::mode</a></div><div class="ttdeci">enum ast_bridge_video_mode_type mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00160">bridge.h:160</a></div></div>
<div class="ttc" id="timing_8h_html"><div class="ttname"><a href="../../db/d41/timing_8h.html">timing.h</a></div><div class="ttdoc">Timing source management. </div></div>
<div class="ttc" id="bridge__features_8h_html_acbd260bd0e5790d9c0f08775448f7fc0"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#acbd260bd0e5790d9c0f08775448f7fc0">ast_bridge_hook_timer_option</a></div><div class="ttdeci">ast_bridge_hook_timer_option</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00233">bridge_features.h:233</a></div></div>
<div class="ttc" id="heap_8h_html_ae31f8aaa8d4c6caf049e3965ec8b576a"><div class="ttname"><a href="../../da/ddb/heap_8h.html#ae31f8aaa8d4c6caf049e3965ec8b576a">ast_heap_wrlock</a></div><div class="ttdeci">#define ast_heap_wrlock(h)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/ddb/heap_8h_source.html#l00246">heap.h:246</a></div></div>
<div class="ttc" id="bridge_8c_html_abc63f551fd512b833546ed01d198057f"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#abc63f551fd512b833546ed01d198057f">tech_capability2str</a></div><div class="ttdeci">static const char * tech_capability2str(uint32_t capabilities)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05335">bridge.c:5335</a></div></div>
<div class="ttc" id="format__cap_8h_html_a9b2d6490b222d436f5f6a8296d36c13f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a9b2d6490b222d436f5f6a8296d36c13f">ast_format_cap_has_type</a></div><div class="ttdeci">int ast_format_cap_has_type(const struct ast_format_cap *cap, enum ast_media_type type)</div><div class="ttdoc">Find out if the capabilities structure has any formats of a specific type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00615">format_cap.c:615</a></div></div>
<div class="ttc" id="bridge_8c_html_a50f3a7bc97ba57ed246801d6b6435f08"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a50f3a7bc97ba57ed246801d6b6435f08">handle_manager_bridge_tech_suspend</a></div><div class="ttdeci">static int handle_manager_bridge_tech_suspend(struct mansession *s, const struct message *m, int suspend)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05474">bridge.c:5474</a></div></div>
<div class="ttc" id="structast__mutex__info_html"><div class="ttname"><a href="../../d8/dc5/structast__mutex__info.html">ast_mutex_info</a></div><div class="ttdoc">Structure for mutex and tracking information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00135">lock.h:135</a></div></div>
<div class="ttc" id="bridge__features_8h_html"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html">bridge_features.h</a></div><div class="ttdoc">Channel Bridging API. </div></div>
<div class="ttc" id="bridge_8c_html_a3a4e6edefaf27f09e1bc4957eebd7b03"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a3a4e6edefaf27f09e1bc4957eebd7b03">optimization_id</a></div><div class="ttdeci">static unsigned int optimization_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00127">bridge.c:127</a></div></div>
<div class="ttc" id="bridge_8c_html_aedb1ba43789d8d610f180baa0596f413"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aedb1ba43789d8d610f180baa0596f413">bridge_show_specific_print_channel</a></div><div class="ttdeci">static int bridge_show_specific_print_channel(void *obj, void *arg, int flags)</div><div class="ttdoc">Internal callback function for sending channels in a bridge to the CLI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l05140">bridge.c:5140</a></div></div>
<div class="ttc" id="bridge_8c_html_a38c501242153bbe13d0eda31220637b8"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a38c501242153bbe13d0eda31220637b8">bridge_base_init</a></div><div class="ttdeci">struct ast_bridge * bridge_base_init(struct ast_bridge *self, uint32_t capabilities, unsigned int flags, const char *creator, const char *name, const char *id)</div><div class="ttdoc">Initialize the base class of the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00760">bridge.c:760</a></div></div>
<div class="ttc" id="bridge_8c_html_a67a0030855111322bb27b3502345adc6"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a67a0030855111322bb27b3502345adc6">ast_bridge_vars_set</a></div><div class="ttdeci">void ast_bridge_vars_set(struct ast_channel *chan, const char *name, const char *pvtid)</div><div class="ttdoc">Sets BRIDGECHANNEL and BRIDGEPVTCALLID for a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01242">bridge.c:1242</a></div></div>
<div class="ttc" id="bridge_8c_html_ab0558a802b481dabb4b5c6344fb0c809a47b44b85339b2afeaece06fe40406320"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ab0558a802b481dabb4b5c6344fb0c809a47b44b85339b2afeaece06fe40406320">MERGE_NOT_ENOUGH_CHANNELS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02863">bridge.c:2863</a></div></div>
<div class="ttc" id="structast__channel__snapshot__base_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">ast_channel_snapshot_base::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00112">stasis_channels.h:112</a></div></div>
<div class="ttc" id="bridge_8c_html_a77ab17853d64d147b9decab33c4e6ac5"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#a77ab17853d64d147b9decab33c4e6ac5">bridge_channel_depart_thread</a></div><div class="ttdeci">static void * bridge_channel_depart_thread(void *data)</div><div class="ttdoc">Thread responsible for imparted bridged channels to be departed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01757">bridge.c:1757</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_aee9af6c35b13edd9dcbd3dbabc5522ee"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#aee9af6c35b13edd9dcbd3dbabc5522ee">ast_bridge_get_snapshot_by_uniqueid</a></div><div class="ttdeci">struct ast_bridge_snapshot * ast_bridge_get_snapshot_by_uniqueid(const char *bridge_id)</div><div class="ttdoc">Returns the current snapshot for the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l01359">stasis_bridges.c:1359</a></div></div>
<div class="ttc" id="structast__blind__transfer__message_html_a69d67589993bc38c485c20b84ce40034"><div class="ttname"><a href="../../d1/dbf/structast__blind__transfer__message.html#a69d67589993bc38c485c20b84ce40034">ast_blind_transfer_message::replace_channel</a></div><div class="ttdeci">struct ast_channel_snapshot * replace_channel</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00265">stasis_bridges.h:265</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="codecs_2gsm_2inc_2private_8h_html_a0b023cbb2bf7d034c2269d58d7455ac8"><div class="ttname"><a href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a></div><div class="ttdeci">short word</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da0/codecs_2gsm_2inc_2private_8h_source.html#l00012">codecs/gsm/inc/private.h:12</a></div></div>
<div class="ttc" id="bridge_8h_html_a2739c3a2cbad57dc988580e02082295c"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a2739c3a2cbad57dc988580e02082295c">ast_bridge_trylock</a></div><div class="ttdeci">#define ast_bridge_trylock(bridge)</div><div class="ttdoc">Try locking the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00467">bridge.h:467</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
<div class="ttc" id="structast__bridge_html_abc1d460759585bcaddb392327e9cc9ea"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#abc1d460759585bcaddb392327e9cc9ea">ast_bridge::construction_completed</a></div><div class="ttdeci">unsigned int construction_completed</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00400">bridge.h:400</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da">AST_BRIDGE_TRANSFER_NOT_PERMITTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01119">bridge.h:1119</a></div></div>
<div class="ttc" id="strings_8h_html_a33ab7fa091d5513d8507d3bd33ef5b55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_hash(const char *str)</div><div class="ttdoc">Compute a hash value on a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01206">strings.h:1206</a></div></div>
<div class="ttc" id="bridge_8c_html_abaed4a38f4a13567c5f18b7c4e2871c7"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#abaed4a38f4a13567c5f18b7c4e2871c7">ast_bridge_update_talker_src_video_mode</a></div><div class="ttdeci">void ast_bridge_update_talker_src_video_mode(struct ast_bridge *bridge, struct ast_channel *chan, int talker_energy, int is_keyframe)</div><div class="ttdoc">Update information about talker energy for talker src video mode. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03883">bridge.c:3883</a></div></div>
<div class="ttc" id="bridge__holding_8c_html_adf38df86af98cfdb636531a8426af096"><div class="ttname"><a href="../../d8/d66/bridge__holding_8c.html#adf38df86af98cfdb636531a8426af096">deferred_action</a></div><div class="ttdeci">static void deferred_action(struct ast_bridge_channel *bridge_channel, const void *payload, size_t payload_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d66/bridge__holding_8c_source.html#l00416">bridge_holding.c:416</a></div></div>
<div class="ttc" id="bridge_8h_html_a186f44efd65f1349ca2deb11b8117534a582d8fd99bc8f3320608f74efb142ee7"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a186f44efd65f1349ca2deb11b8117534a582d8fd99bc8f3320608f74efb142ee7">AST_BRIDGE_OPTIMIZE_SWAP_TO_PEER_BRIDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00895">bridge.h:895</a></div></div>
<div class="ttc" id="core__local_8h_html_a36ca4008cc93eb1ee59194e732ee6b8a"><div class="ttname"><a href="../../d5/da6/core__local_8h.html#a36ca4008cc93eb1ee59194e732ee6b8a">ast_local_setup_bridge</a></div><div class="ttdeci">int ast_local_setup_bridge(struct ast_channel *ast, struct ast_bridge *bridge, struct ast_channel *swap, struct ast_bridge_features *features)</div><div class="ttdoc">Setup the outgoing local channel to join a bridge on ast_call(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/core__local_8c_source.html#l00599">core_local.c:599</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
<div class="ttc" id="bridge_8c_html_ac776f2eff5f02e48a3c6492a6dccd444"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#ac776f2eff5f02e48a3c6492a6dccd444">bridge_complete_join</a></div><div class="ttdeci">static void bridge_complete_join(struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00486">bridge.c:486</a></div></div>
<div class="ttc" id="structast__bridge__softmix_html_acc14dd5766fd17581ff869aaae42988c"><div class="ttname"><a href="../../d0/d50/structast__bridge__softmix.html#acc14dd5766fd17581ff869aaae42988c">ast_bridge_softmix::binaural_active</a></div><div class="ttdeci">unsigned int binaural_active</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00303">bridge.h:303</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
<div class="ttc" id="bridge_8h_html_a865f7ef0f91885406ab746b23eb598cdaa85cad6eafcb0edc223c975e0cf3b296"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a865f7ef0f91885406ab746b23eb598cdaa85cad6eafcb0edc223c975e0cf3b296">AST_BRIDGE_TRANSFER_MULTI_PARTY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01130">bridge.h:1130</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
<div class="ttc" id="core__unreal_8h_html"><div class="ttname"><a href="../../de/dea/core__unreal_8h.html">core_unreal.h</a></div><div class="ttdoc">Unreal channel derivative framework. </div></div>
<div class="ttc" id="channel_8h_html_a31a465197a7766c3d0bb9f65f0a4418fac3861dd1a26771778606b7aacdfb4048"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a31a465197a7766c3d0bb9f65f0a4418fac3861dd1a26771778606b7aacdfb4048">AST_CHANNEL_REQUESTOR_REPLACEMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01481">channel.h:1481</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:43:08 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
