<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: stasis_cache.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stasis_cache.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Stasis Message API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/da0/hashtab_8h_source.html">asterisk/hashtab.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d90/stasis__internal_8h_source.html">asterisk/stasis_internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d79/stasis_8h_source.html">asterisk/stasis.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d68/vector_8h_source.html">asterisk/vector.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stasis_cache.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d04/stasis__cache_8c__incl.png" border="0" usemap="#stasis__cache_8c" alt=""/></div>
<map name="stasis__cache_8c" id="stasis__cache_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="107,229,191,256"/>
<area shape="rect" id="node22" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1487,155,1621,181"/>
<area shape="rect" id="node32" href="../../d6/da0/hashtab_8h.html" title="Generic (perhaps overly so) hashtable implementation Hash Table support in Asterisk. " alt="" coords="1671,155,1811,181"/>
<area shape="rect" id="node33" href="../../de/d90/stasis__internal_8h.html" title="Internal Stasis APIs. " alt="" coords="1897,80,2077,107"/>
<area shape="rect" id="node34" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1925,155,2050,181"/>
<area shape="rect" id="node37" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="2263,229,2378,256"/>
<area shape="rect" id="node39" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="2107,80,2233,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="795,453,950,480"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="899,304,1036,331"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="5,304,140,331"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="799,528,946,555"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1560,379,1703,405"/>
<area shape="rect" id="node23" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1772,304,1885,331"/>
<area shape="rect" id="node26" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1667,453,1814,480"/>
<area shape="rect" id="node31" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1479,229,1629,256"/>
<area shape="rect" id="node25" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="2299,379,2361,405"/>
<area shape="rect" id="node29" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="2124,379,2275,405"/>
<area shape="rect" id="node30" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="2385,379,2512,405"/>
<area shape="rect" id="node35" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="2074,229,2189,256"/>
<area shape="rect" id="node36" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="1756,229,1901,256"/>
<area shape="rect" id="node38" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="1925,229,2049,256"/>
</map>
</div>
</div>
<p><a href="../../d0/da9/stasis__cache_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db4/structcache__entry__key.html">cache_entry_key</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The key for an entry in the cache.  <a href="../../df/db4/structcache__entry__key.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d5d/structcache__put__snapshots.html">cache_put_snapshots</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa2c7ce70c25f706f8eafad4001c28daa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#aa2c7ce70c25f706f8eafad4001c28daa">NUM_CACHE_BUCKETS</a>&#160;&#160;&#160;563</td></tr>
<tr class="separator:aa2c7ce70c25f706f8eafad4001c28daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad08f197928151ebfd2bc4dc40d43cc7d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#ad08f197928151ebfd2bc4dc40d43cc7d">cache_dtor</a> (void *obj)</td></tr>
<tr class="separator:ad08f197928151ebfd2bc4dc40d43cc7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af687f0328d2e3cd667cb5a4a881031d4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#af687f0328d2e3cd667cb5a4a881031d4">cache_dump_all_cb</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:af687f0328d2e3cd667cb5a4a881031d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a364ec06116503a4aa2ebededab145a8b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a364ec06116503a4aa2ebededab145a8b">cache_dump_by_eid_cb</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:a364ec06116503a4aa2ebededab145a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecac4fb3b7fba43cc0fae0c20a91cbd"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a4ecac4fb3b7fba43cc0fae0c20a91cbd">cache_entry_by_eid</a> (const struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="separator:a4ecac4fb3b7fba43cc0fae0c20a91cbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6ae2aeb60c09e62d465d9e4f64afc8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#abb6ae2aeb60c09e62d465d9e4f64afc8">cache_entry_cmp</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:abb6ae2aeb60c09e62d465d9e4f64afc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da3b6689fc6f98b634527fbd5f4c203"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a4da3b6689fc6f98b634527fbd5f4c203">cache_entry_compute_hash</a> (struct <a class="el" href="../../df/db4/structcache__entry__key.html">cache_entry_key</a> *key)</td></tr>
<tr class="separator:a4da3b6689fc6f98b634527fbd5f4c203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a977864320d44b4bc95986045f6bd23f0"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a977864320d44b4bc95986045f6bd23f0">cache_entry_create</a> (struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *snapshot)</td></tr>
<tr class="separator:a977864320d44b4bc95986045f6bd23f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef5db6d440ca6c9a51218ce706ecf55"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a2ef5db6d440ca6c9a51218ce706ecf55">cache_entry_dtor</a> (void *obj)</td></tr>
<tr class="separator:a2ef5db6d440ca6c9a51218ce706ecf55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ba570c6048d965f9848d65ca75f7a42"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a4ba570c6048d965f9848d65ca75f7a42">cache_entry_dump</a> (struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *snapshots, const struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>)</td></tr>
<tr class="separator:a4ba570c6048d965f9848d65ca75f7a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b8388a1d7ada8d25bee76503157c7b3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a8b8388a1d7ada8d25bee76503157c7b3">cache_entry_hash</a> (const void *obj, int flags)</td></tr>
<tr class="separator:a8b8388a1d7ada8d25bee76503157c7b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0723b9228855b55f0e1a0be21cf819ae"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a> (struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *entries, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="separator:a0723b9228855b55f0e1a0be21cf819ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a788fc8fd4acd0452077963c7b8293c0e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d5d/structcache__put__snapshots.html">cache_put_snapshots</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a788fc8fd4acd0452077963c7b8293c0e">cache_put</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *new_snapshot)</td></tr>
<tr class="separator:a788fc8fd4acd0452077963c7b8293c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5bab9b5999ec5803b79ffe580bfc2a"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a5b5bab9b5999ec5803b79ffe580bfc2a">cache_remove</a> (struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *entries, struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_entry, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="separator:a5b5bab9b5999ec5803b79ffe580bfc2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe81e49fc899cba4730fc1c845990312"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#afe81e49fc899cba4730fc1c845990312">cache_udpate</a> (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_entry, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *new_snapshot)</td></tr>
<tr class="separator:afe81e49fc899cba4730fc1c845990312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf91e29b6ef63f34910f4163e71fb93"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a6bf91e29b6ef63f34910f4163e71fb93">caching_topic_exec</a> (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="separator:a6bf91e29b6ef63f34910f4163e71fb93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e50c4d5c0fdf83ab6d1e7ed3facbb3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a21e50c4d5c0fdf83ab6d1e7ed3facbb3">print_cache_entry</a> (void *v_obj, void *where, <a class="el" href="../../d5/da5/astobj2_8h.html#af236ed10cd1eddcbad0579ed0cf9f4c5">ao2_prnt_fn</a> *prnt)</td></tr>
<tr class="separator:a21e50c4d5c0fdf83ab6d1e7ed3facbb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a8871098ef8b0f1afa6103fd2774ddb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a0a8871098ef8b0f1afa6103fd2774ddb">stasis_cache_cleanup</a> (void)</td></tr>
<tr class="separator:a0a8871098ef8b0f1afa6103fd2774ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230d10716f17841b4baed442a6fd2225"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a230d10716f17841b4baed442a6fd2225">stasis_cache_clear_create</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *id_message)</td></tr>
<tr class="memdesc:a230d10716f17841b4baed442a6fd2225"><td class="mdescLeft">&#160;</td><td class="mdescRight">A message which instructs the caching topic to remove an entry from its cache.  <a href="#a230d10716f17841b4baed442a6fd2225">More...</a><br /></td></tr>
<tr class="separator:a230d10716f17841b4baed442a6fd2225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64035c0f7317db2590817a173d268ff1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a64035c0f7317db2590817a173d268ff1">stasis_cache_create</a> (<a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a> id_fn)</td></tr>
<tr class="memdesc:a64035c0f7317db2590817a173d268ff1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a cache.  <a href="#a64035c0f7317db2590817a173d268ff1">More...</a><br /></td></tr>
<tr class="separator:a64035c0f7317db2590817a173d268ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb417e66895425f128678fe3ed589010"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#adb417e66895425f128678fe3ed589010">stasis_cache_create_full</a> (<a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a> id_fn, <a class="el" href="../../dd/d79/stasis_8h.html#aa4a7b629d3125dc329b43715f5f5663b">cache_aggregate_calc_fn</a> aggregate_calc_fn, <a class="el" href="../../dd/d79/stasis_8h.html#a9a0eb1c6ec2920123af41e05b5592a7c">cache_aggregate_publish_fn</a> aggregate_publish_fn)</td></tr>
<tr class="memdesc:adb417e66895425f128678fe3ed589010"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a cache.  <a href="#adb417e66895425f128678fe3ed589010">More...</a><br /></td></tr>
<tr class="separator:adb417e66895425f128678fe3ed589010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5612920b22beb93b5e8acbdae40078"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:a8c5612920b22beb93b5e8acbdae40078"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump cached items to a subscription for the ast_eid_default entity.  <a href="#a8c5612920b22beb93b5e8acbdae40078">More...</a><br /></td></tr>
<tr class="separator:a8c5612920b22beb93b5e8acbdae40078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab54f6037e019ae477c15e90e52904d09"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#ab54f6037e019ae477c15e90e52904d09">stasis_cache_dump_all</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:ab54f6037e019ae477c15e90e52904d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump all entity items from the cache to a subscription.  <a href="#ab54f6037e019ae477c15e90e52904d09">More...</a><br /></td></tr>
<tr class="separator:ab54f6037e019ae477c15e90e52904d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4de0928d2b230b1c3184ba506ecf26"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a9a4de0928d2b230b1c3184ba506ecf26">stasis_cache_dump_by_eid</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="memdesc:a9a4de0928d2b230b1c3184ba506ecf26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump cached items to a subscription for a specific entity.  <a href="#a9a4de0928d2b230b1c3184ba506ecf26">More...</a><br /></td></tr>
<tr class="separator:a9a4de0928d2b230b1c3184ba506ecf26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103ead88f88b74cb33bee4a843c4a162"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a103ead88f88b74cb33bee4a843c4a162">stasis_cache_entry_get_aggregate</a> (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>)</td></tr>
<tr class="memdesc:a103ead88f88b74cb33bee4a843c4a162"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the aggregate cache entry snapshot.  <a href="#a103ead88f88b74cb33bee4a843c4a162">More...</a><br /></td></tr>
<tr class="separator:a103ead88f88b74cb33bee4a843c4a162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55563a8b16be69f6f7cae05e5b4e65fc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a55563a8b16be69f6f7cae05e5b4e65fc">stasis_cache_entry_get_local</a> (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>)</td></tr>
<tr class="memdesc:a55563a8b16be69f6f7cae05e5b4e65fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the local entity's cache entry snapshot.  <a href="#a55563a8b16be69f6f7cae05e5b4e65fc">More...</a><br /></td></tr>
<tr class="separator:a55563a8b16be69f6f7cae05e5b4e65fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ffccea6541acbcf4ab9d6913f2e757"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#ab0ffccea6541acbcf4ab9d6913f2e757">stasis_cache_entry_get_remote</a> (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>, int idx)</td></tr>
<tr class="memdesc:ab0ffccea6541acbcf4ab9d6913f2e757"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a remote entity's cache entry snapshot by index.  <a href="#ab0ffccea6541acbcf4ab9d6913f2e757">More...</a><br /></td></tr>
<tr class="separator:ab0ffccea6541acbcf4ab9d6913f2e757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3da17290725793258020b83f56e4df6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#ab3da17290725793258020b83f56e4df6">stasis_cache_get</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:ab3da17290725793258020b83f56e4df6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve an item from the cache for the ast_eid_default entity.  <a href="#ab3da17290725793258020b83f56e4df6">More...</a><br /></td></tr>
<tr class="separator:ab3da17290725793258020b83f56e4df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886f222d38f8a07dee5a595d5c19a3fb"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a886f222d38f8a07dee5a595d5c19a3fb">stasis_cache_get_all</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:a886f222d38f8a07dee5a595d5c19a3fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve all matching entity items from the cache.  <a href="#a886f222d38f8a07dee5a595d5c19a3fb">More...</a><br /></td></tr>
<tr class="separator:a886f222d38f8a07dee5a595d5c19a3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d22721748b1bfd63ab13d92f19dfd02"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a1d22721748b1bfd63ab13d92f19dfd02">stasis_cache_get_by_eid</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="memdesc:a1d22721748b1bfd63ab13d92f19dfd02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve an item from the cache for a specific entity.  <a href="#a1d22721748b1bfd63ab13d92f19dfd02">More...</a><br /></td></tr>
<tr class="separator:a1d22721748b1bfd63ab13d92f19dfd02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81215cb37a9287389855d0529332b1b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a81215cb37a9287389855d0529332b1b7">stasis_cache_init</a> (void)</td></tr>
<tr class="separator:a81215cb37a9287389855d0529332b1b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20eaab4d0789f4b0662b08688127b971"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a20eaab4d0789f4b0662b08688127b971">stasis_cache_update_dtor</a> (void *obj)</td></tr>
<tr class="separator:a20eaab4d0789f4b0662b08688127b971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd235b443f5fffb17c7bc98b6d48ddd2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#afd235b443f5fffb17c7bc98b6d48ddd2">stasis_caching_accept_message_type</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:afd235b443f5fffb17c7bc98b6d48ddd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate to a caching topic that we are interested in a message type.  <a href="#afd235b443f5fffb17c7bc98b6d48ddd2">More...</a><br /></td></tr>
<tr class="separator:afd235b443f5fffb17c7bc98b6d48ddd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b3b41b59f3894b40f5630524347d62"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a60b3b41b59f3894b40f5630524347d62">stasis_caching_get_topic</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic)</td></tr>
<tr class="memdesc:a60b3b41b59f3894b40f5630524347d62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the topic of cached events from a caching topics.  <a href="#a60b3b41b59f3894b40f5630524347d62">More...</a><br /></td></tr>
<tr class="separator:a60b3b41b59f3894b40f5630524347d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5db3f77a72f6a07c86a00f638daff07a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a5db3f77a72f6a07c86a00f638daff07a">stasis_caching_set_filter</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic, enum <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a> <a class="el" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a>)</td></tr>
<tr class="memdesc:a5db3f77a72f6a07c86a00f638daff07a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the message type filtering level on a cache.  <a href="#a5db3f77a72f6a07c86a00f638daff07a">More...</a><br /></td></tr>
<tr class="separator:a5db3f77a72f6a07c86a00f638daff07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4290101180caea800a0461017a167120"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a4290101180caea800a0461017a167120">stasis_caching_topic_create</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *original_topic, struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>)</td></tr>
<tr class="memdesc:a4290101180caea800a0461017a167120"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a topic which monitors and caches messages from another topic.  <a href="#a4290101180caea800a0461017a167120">More...</a><br /></td></tr>
<tr class="separator:a4290101180caea800a0461017a167120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8fb198af71133995bf7a55be029eed"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a5a8fb198af71133995bf7a55be029eed">stasis_caching_topic_dtor</a> (void *obj)</td></tr>
<tr class="separator:a5a8fb198af71133995bf7a55be029eed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc3370e3a15daaa00179f2f72ab8c9d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#afdc3370e3a15daaa00179f2f72ab8c9d">stasis_caching_unsubscribe</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic)</td></tr>
<tr class="memdesc:afdc3370e3a15daaa00179f2f72ab8c9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes a caching topic from its upstream topic.  <a href="#afdc3370e3a15daaa00179f2f72ab8c9d">More...</a><br /></td></tr>
<tr class="separator:afdc3370e3a15daaa00179f2f72ab8c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab211ac23afbd0560f08539021888db57"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#ab211ac23afbd0560f08539021888db57">stasis_caching_unsubscribe_and_join</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic)</td></tr>
<tr class="memdesc:ab211ac23afbd0560f08539021888db57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes a caching topic from its upstream topic, blocking until all messages have been forwarded.  <a href="#ab211ac23afbd0560f08539021888db57">More...</a><br /></td></tr>
<tr class="separator:ab211ac23afbd0560f08539021888db57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96256b49165db103875323bce1540653"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a96256b49165db103875323bce1540653">STASIS_MESSAGE_TYPE_DEFN</a> (<a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>)</td></tr>
<tr class="separator:a96256b49165db103875323bce1540653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cde63de5019f4c569c9660abfb016fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a5cde63de5019f4c569c9660abfb016fe">STASIS_MESSAGE_TYPE_DEFN</a> (<a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>)</td></tr>
<tr class="separator:a5cde63de5019f4c569c9660abfb016fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a596d33ddb71259f058643581d2f12d9d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/da9/stasis__cache_8c.html#a596d33ddb71259f058643581d2f12d9d">update_create</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *old_snapshot, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *new_snapshot)</td></tr>
<tr class="separator:a596d33ddb71259f058643581d2f12d9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Stasis Message API. </p>
<dl class="section author"><dt>Author</dt><dd>David M. Lee, II <a href="#" onclick="location.href='mai'+'lto:'+'dle'+'e@'+'dig'+'iu'+'m.c'+'om'; return false;">dlee@<span style="display: none;">.nosp@m.</span>digi<span style="display: none;">.nosp@m.</span>um.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa2c7ce70c25f706f8eafad4001c28daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c7ce70c25f706f8eafad4001c28daa">&#9670;&nbsp;</a></span>NUM_CACHE_BUCKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_CACHE_BUCKETS&#160;&#160;&#160;563</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00042">42</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache_create_full()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad08f197928151ebfd2bc4dc40d43cc7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad08f197928151ebfd2bc4dc40d43cc7d">&#9670;&nbsp;</a></span>cache_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void cache_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00326">326</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">cache</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache_create_full()</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a> = obj;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structstasis__cache_html"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html">stasis_cache</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00046">stasis_cache.c:46</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_aefe318d32c8bb7a9e2025eb146d47781"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a></div><div class="ttdeci">struct ao2_container * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">pbx_realtime.c:77</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af687f0328d2e3cd667cb5a4a881031d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af687f0328d2e3cd667cb5a4a881031d4">&#9670;&nbsp;</a></span>cache_dump_all_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cache_dump_all_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00741">741</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00563">cache_entry_dump()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01032">CMP_STOP</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00692">cache_dump_data::container</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache_entry::key</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00693">cache_dump_data::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00757">stasis_cache_dump_all()</a>.</p>
<div class="fragment"><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;{</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a> *cache_dump = arg;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a> = obj;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <span class="keywordflow">if</span> (!cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> || entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> == cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/da9/stasis__cache_8c.html#a4ba570c6048d965f9848d65ca75f7a42">cache_entry_dump</a>(cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">container</a>, entry)) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">container</a>);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;         cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">container</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;}</div><div class="ttc" id="structstasis__cache__entry_html_abdd8bbe2aaddbc1db09275d91cdad6ed"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">stasis_cache_entry::key</a></div><div class="ttdeci">struct cache_entry_key key</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache.c:174</a></div></div>
<div class="ttc" id="structcache__dump__data_html_a7ea220e4d14b05876af4430e9832ce47"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">cache_dump_data::container</a></div><div class="ttdeci">struct ao2_container * container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00692">stasis_cache.c:692</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structcache__dump__data_html"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00691">stasis_cache.c:691</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structcache__dump__data_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_dump_data::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00693">stasis_cache.c:693</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4ba570c6048d965f9848d65ca75f7a42"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4ba570c6048d965f9848d65ca75f7a42">cache_entry_dump</a></div><div class="ttdeci">static int cache_entry_dump(struct ao2_container *snapshots, const struct stasis_cache_entry *entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00563">stasis_cache.c:563</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a364ec06116503a4aa2ebededab145a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a364ec06116503a4aa2ebededab145a8b">&#9670;&nbsp;</a></span>cache_dump_by_eid_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cache_dump_by_eid_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00697">697</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00631">cache_entry_by_eid()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01032">CMP_STOP</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00692">cache_dump_data::container</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00694">cache_dump_data::eid</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache_entry::key</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00693">cache_dump_data::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00718">stasis_cache_dump_by_eid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;{</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a> *cache_dump = arg;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a> = obj;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <span class="keywordflow">if</span> (!cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> || entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> == cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>) {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *snapshot;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      snapshot = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a4ecac4fb3b7fba43cc0fae0c20a91cbd">cache_entry_by_eid</a>(entry, cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a39d1b63955a48c72508fa9f884d05762">eid</a>);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">if</span> (snapshot) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">container</a>, snapshot)) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">container</a>);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            cache_dump-&gt;<a class="code" href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">container</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div><div class="ttc" id="structstasis__cache__entry_html_abdd8bbe2aaddbc1db09275d91cdad6ed"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">stasis_cache_entry::key</a></div><div class="ttdeci">struct cache_entry_key key</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache.c:174</a></div></div>
<div class="ttc" id="structcache__dump__data_html_a7ea220e4d14b05876af4430e9832ce47"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html#a7ea220e4d14b05876af4430e9832ce47">cache_dump_data::container</a></div><div class="ttdeci">struct ao2_container * container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00692">stasis_cache.c:692</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structcache__dump__data_html_a39d1b63955a48c72508fa9f884d05762"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html#a39d1b63955a48c72508fa9f884d05762">cache_dump_data::eid</a></div><div class="ttdeci">const struct ast_eid * eid</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00694">stasis_cache.c:694</a></div></div>
<div class="ttc" id="structcache__dump__data_html"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00691">stasis_cache.c:691</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structcache__dump__data_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_dump_data::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00693">stasis_cache.c:693</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4ecac4fb3b7fba43cc0fae0c20a91cbd"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4ecac4fb3b7fba43cc0fae0c20a91cbd">cache_entry_by_eid</a></div><div class="ttdeci">static struct stasis_message * cache_entry_by_eid(const struct stasis_cache_entry *entry, const struct ast_eid *eid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00631">stasis_cache.c:631</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ecac4fb3b7fba43cc0fae0c20a91cbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ecac4fb3b7fba43cc0fae0c20a91cbd">&#9670;&nbsp;</a></span>cache_entry_by_eid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* cache_entry_by_eid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00631">631</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache_entry::aggregate</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message_eid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00697">cache_dump_by_eid_cb()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00659">stasis_cache_get_by_eid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <span class="keywordtype">int</span> is_remote;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <span class="keywordflow">if</span> (!eid) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="comment">/* Get aggregate. */</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordflow">return</span> entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">aggregate</a>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="comment">/* Get snapshot with specific eid. */</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   is_remote = <a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(eid, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="keywordflow">if</span> (!is_remote) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">return</span> entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;entry-&gt;remote); ++idx) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *cur;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      cur = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;entry-&gt;remote, idx);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(eid, <a class="code" href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a>(cur))) {</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;         <span class="keywordflow">return</span> cur;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div><div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="stasis_8h_html_ae5dc2372860d977cc3e2a8e9af24aeaf"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a></div><div class="ttdeci">const struct ast_eid * stasis_message_eid(const struct stasis_message *msg)</div><div class="ttdoc">Get the entity id for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message.c:179</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_af11d58f16b29e3f5149a1ea04f83d5a4"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">stasis_cache_entry::aggregate</a></div><div class="ttdeci">struct stasis_message * aggregate</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache.c:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb6ae2aeb60c09e62d465d9e4f64afc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6ae2aeb60c09e62d465d9e4f64afc8">&#9670;&nbsp;</a></span>cache_entry_cmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cache_entry_cmp </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00288">288</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01031">CMP_MATCH</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00168">cache_entry_key::id</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache_entry::key</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01076">OBJ_SEARCH_MASK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01091">OBJ_SEARCH_OBJECT</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01120">OBJ_SEARCH_PARTIAL_KEY</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache_create_full()</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *object_left = obj;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *object_right = arg;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/db4/structcache__entry__key.html">cache_entry_key</a> *right_key = arg;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a>) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a>:</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      right_key = &amp;object_right-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>:</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      cmp = object_left-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> != right_key-&gt;<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;         || strcmp(object_left-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, right_key-&gt;<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20">OBJ_SEARCH_PARTIAL_KEY</a>:</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">/* Not supported by container */</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      cmp = -1;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">       * What arg points to is specific to this traversal callback</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">       * and has no special meaning to astobj2.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      cmp = 0;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordflow">if</span> (cmp) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">    * At this point the traversal callback is identical to a sorted</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">    * container.</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="ttc" id="structstasis__cache__entry_html_abdd8bbe2aaddbc1db09275d91cdad6ed"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">stasis_cache_entry::key</a></div><div class="ttdeci">struct cache_entry_key key</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache.c:174</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structcache__entry__key_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">cache_entry_key::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00168">stasis_cache.c:168</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20">OBJ_SEARCH_PARTIAL_KEY</a></div><div class="ttdoc">The arg parameter is a partial search key similar to OBJ_SEARCH_KEY. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01120">astobj2.h:1120</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="structcache__entry__key_html"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html">cache_entry_key</a></div><div class="ttdoc">The key for an entry in the cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00164">stasis_cache.c:164</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a></div><div class="ttdoc">The arg parameter is an object of the same type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01091">astobj2.h:1091</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a></div><div class="ttdoc">Search option field mask. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01076">astobj2.h:1076</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4da3b6689fc6f98b634527fbd5f4c203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da3b6689fc6f98b634527fbd5f4c203">&#9670;&nbsp;</a></span>cache_entry_compute_hash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void cache_entry_compute_hash </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/db4/structcache__entry__key.html">cache_entry_key</a> *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00206">206</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d35/hashtab_8c_source.html#l00153">ast_hashtab_hash_string()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00170">cache_entry_key::hash</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00168">cache_entry_key::id</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00104">stasis_message_type_hash()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00212">cache_entry_create()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   key-&gt;<a class="code" href="../../df/db4/structcache__entry__key.html#a09f9a9ce240560b1d191b42ed56af642">hash</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a1996f291ef2df28b75c279d4790c2258">stasis_message_type_hash</a>(key-&gt;<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   key-&gt;<a class="code" href="../../df/db4/structcache__entry__key.html#a09f9a9ce240560b1d191b42ed56af642">hash</a> += <a class="code" href="../../d6/da0/hashtab_8h.html#af8904cce564fd39de28b566bb8c261eb">ast_hashtab_hash_string</a>(key-&gt;<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div><div class="ttc" id="structcache__entry__key_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">cache_entry_key::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00168">stasis_cache.c:168</a></div></div>
<div class="ttc" id="stasis_8h_html_a1996f291ef2df28b75c279d4790c2258"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a1996f291ef2df28b75c279d4790c2258">stasis_message_type_hash</a></div><div class="ttdeci">unsigned int stasis_message_type_hash(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the hash of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00104">stasis_message.c:104</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a09f9a9ce240560b1d191b42ed56af642"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a09f9a9ce240560b1d191b42ed56af642">cache_entry_key::hash</a></div><div class="ttdeci">unsigned int hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00170">stasis_cache.c:170</a></div></div>
<div class="ttc" id="hashtab_8h_html_af8904cce564fd39de28b566bb8c261eb"><div class="ttname"><a href="../../d6/da0/hashtab_8h.html#af8904cce564fd39de28b566bb8c261eb">ast_hashtab_hash_string</a></div><div class="ttdeci">unsigned int ast_hashtab_hash_string(const void *obj)</div><div class="ttdoc">Hashes a string to a number. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d35/hashtab_8c_source.html#l00153">hashtab.c:153</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a977864320d44b4bc95986045f6bd23f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a977864320d44b4bc95986045f6bd23f0">&#9670;&nbsp;</a></span>cache_entry_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a>* cache_entry_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>snapshot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00212">212</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00206">cache_entry_compute_hash()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00183">cache_entry_dtor()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00168">cache_entry_key::id</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache_entry::key</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message_eid()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00505">cache_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordtype">int</span> is_remote;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<span class="keywordtype">id</span> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(snapshot != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   entry = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*entry), <a class="code" href="../../d0/da9/stasis__cache_8c.html#a2ef5db6d440ca6c9a51218ce706ecf55">cache_entry_dtor</a>,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keywordflow">if</span> (!entry) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="keywordtype">id</span>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="keywordflow">if</span> (!entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a>) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(entry);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    * Normal ao2 ref counting rules says we should increment the message</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    * type ref here and decrement it in cache_entry_dtor().  However, the</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">    * stasis message snapshot is cached here, will always have the same type</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    * as the cache entry, and can legitimately cause the type ref count to</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">    * hit the excessive ref count assertion.  Since the cache entry will</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">    * always have a snapshot we can get away with not holding a ref here.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(type == <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(snapshot));</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <a class="code" href="../../d0/da9/stasis__cache_8c.html#a4da3b6689fc6f98b634527fbd5f4c203">cache_entry_compute_hash</a>(&amp;entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   is_remote = <a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(&amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>, <a class="code" href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a>(snapshot)) ? 1 : 0;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;entry-&gt;remote, is_remote)) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(entry);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordflow">if</span> (is_remote) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;entry-&gt;remote, snapshot)) {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(entry);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a> = snapshot;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(snapshot);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <span class="keywordflow">return</span> entry;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_abdd8bbe2aaddbc1db09275d91cdad6ed"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">stasis_cache_entry::key</a></div><div class="ttdeci">struct cache_entry_key key</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache.c:174</a></div></div>
<div class="ttc" id="structcache__entry__key_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">cache_entry_key::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00168">stasis_cache.c:168</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4da3b6689fc6f98b634527fbd5f4c203"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4da3b6689fc6f98b634527fbd5f4c203">cache_entry_compute_hash</a></div><div class="ttdeci">static void cache_entry_compute_hash(struct cache_entry_key *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00206">stasis_cache.c:206</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="stasis_8h_html_ae5dc2372860d977cc3e2a8e9af24aeaf"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a></div><div class="ttdeci">const struct ast_eid * stasis_message_eid(const struct stasis_message *msg)</div><div class="ttdoc">Get the entity id for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message.c:179</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a2ef5db6d440ca6c9a51218ce706ecf55"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a2ef5db6d440ca6c9a51218ce706ecf55">cache_entry_dtor</a></div><div class="ttdeci">static void cache_entry_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00183">stasis_cache.c:183</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ef5db6d440ca6c9a51218ce706ecf55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ef5db6d440ca6c9a51218ce706ecf55">&#9670;&nbsp;</a></span>cache_entry_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void cache_entry_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00183">183</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache_entry::aggregate</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00168">cache_entry_key::id</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache_entry::key</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00212">cache_entry_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a> = obj;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordtype">size_t</span> idx;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">char</span> *) entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">aggregate</a>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">aggregate</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;entry-&gt;remote); ++idx) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *remote;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      remote = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;entry-&gt;remote, idx);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(remote);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;entry-&gt;remote);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_abdd8bbe2aaddbc1db09275d91cdad6ed"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">stasis_cache_entry::key</a></div><div class="ttdeci">struct cache_entry_key key</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache.c:174</a></div></div>
<div class="ttc" id="structcache__entry__key_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">cache_entry_key::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00168">stasis_cache.c:168</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_af11d58f16b29e3f5149a1ea04f83d5a4"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">stasis_cache_entry::aggregate</a></div><div class="ttdeci">struct stasis_message * aggregate</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache.c:176</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ba570c6048d965f9848d65ca75f7a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ba570c6048d965f9848d65ca75f7a42">&#9670;&nbsp;</a></span>cache_entry_dump()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cache_entry_dump </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td>
          <td class="paramname"><em>snapshots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00563">563</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00741">cache_dump_all_cb()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00587">stasis_cache_get_all()</a>.</p>
<div class="fragment"><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;{</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <span class="keywordtype">int</span> err = 0;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(snapshots != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(entry != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="comment">/* The aggregate snapshot is not a snapshot from an entity. */</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="keywordflow">if</span> (entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>) {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      err |= !<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(snapshots, entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordflow">for</span> (idx = 0; !err &amp;&amp; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;entry-&gt;remote); ++idx) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *snapshot;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      snapshot = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;entry-&gt;remote, idx);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      err |= !<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(snapshots, snapshot);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <span class="keywordflow">return</span> err;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;}</div><div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8b8388a1d7ada8d25bee76503157c7b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b8388a1d7ada8d25bee76503157c7b3">&#9670;&nbsp;</a></span>cache_entry_hash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cache_entry_hash </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00266">266</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00170">cache_entry_key::hash</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01076">OBJ_SEARCH_MASK</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01091">OBJ_SEARCH_OBJECT</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache_create_full()</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *object;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/db4/structcache__entry__key.html">cache_entry_key</a> *key;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a>) {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>:</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      key = obj;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a>:</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordtype">object</span> = obj;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      key = &amp;<span class="keywordtype">object</span>-&gt;key;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">/* Hash can only work on something with a full key. */</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)key-&gt;<a class="code" href="../../df/db4/structcache__entry__key.html#a09f9a9ce240560b1d191b42ed56af642">hash</a>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structcache__entry__key_html"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html">cache_entry_key</a></div><div class="ttdoc">The key for an entry in the cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00164">stasis_cache.c:164</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a09f9a9ce240560b1d191b42ed56af642"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a09f9a9ce240560b1d191b42ed56af642">cache_entry_key::hash</a></div><div class="ttdeci">unsigned int hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00170">stasis_cache.c:170</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a></div><div class="ttdoc">The arg parameter is an object of the same type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01091">astobj2.h:1091</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a></div><div class="ttdoc">Search option field mask. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01076">astobj2.h:1076</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0723b9228855b55f0e1a0be21cf819ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0723b9228855b55f0e1a0be21cf819ae">&#9670;&nbsp;</a></span>cache_find()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a>* cache_find </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">396</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00206">cache_entry_compute_hash()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00168">cache_entry_key::id</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01507">id</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache_entry::key</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message_type_name()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00505">cache_put()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00587">stasis_cache_get_all()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00659">stasis_cache_get_by_eid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db4/structcache__entry__key.html">cache_entry_key</a> search_key;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   search_key.type = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   search_key.id = <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <a class="code" href="../../d0/da9/stasis__cache_8c.html#a4da3b6689fc6f98b634527fbd5f4c203">cache_entry_compute_hash</a>(&amp;search_key);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   entry = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(entries, &amp;search_key, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="comment">/* Ensure that what we looked for is what we found. */</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!entry</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      || (!strcmp(<a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>),</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;         <a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(type)) &amp;&amp; !strcmp(entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, <span class="keywordtype">id</span>)));</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordflow">return</span> entry;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="stasis_8h_html_aefd78086150c89477f5851f2836e0478"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a></div><div class="ttdeci">const char * stasis_message_type_name(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the name of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message.c:99</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_abdd8bbe2aaddbc1db09275d91cdad6ed"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">stasis_cache_entry::key</a></div><div class="ttdeci">struct cache_entry_key key</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache.c:174</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structcache__entry__key_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">cache_entry_key::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00168">stasis_cache.c:168</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4da3b6689fc6f98b634527fbd5f4c203"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4da3b6689fc6f98b634527fbd5f4c203">cache_entry_compute_hash</a></div><div class="ttdeci">static void cache_entry_compute_hash(struct cache_entry_key *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00206">stasis_cache.c:206</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structcache__entry__key_html"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html">cache_entry_key</a></div><div class="ttdoc">The key for an entry in the cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00164">stasis_cache.c:164</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a788fc8fd4acd0452077963c7b8293c0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a788fc8fd4acd0452077963c7b8293c0e">&#9670;&nbsp;</a></span>cache_put()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d8/d5d/structcache__put__snapshots.html">cache_put_snapshots</a> cache_put </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>new_snapshot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00505">505</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache_entry::aggregate</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00502">cache_put_snapshots::aggregate_new</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00500">cache_put_snapshots::aggregate_old</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00720">ao2_wrlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00212">cache_entry_create()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00425">cache_remove()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00466">cache_udpate()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00498">cache_put_snapshots::old</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;{</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_entry;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d5d/structcache__put__snapshots.html">cache_put_snapshots</a> snapshots;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(eid != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);<span class="comment">/* Aggregate snapshots not allowed to be put directly. */</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(new_snapshot == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      type == <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(new_snapshot));</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   memset(&amp;snapshots, 0, <span class="keyword">sizeof</span>(snapshots));</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   cached_entry = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, type, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="comment">/* Update the eid snapshot. */</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keywordflow">if</span> (!new_snapshot) {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="comment">/* Remove snapshot from cache */</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">if</span> (cached_entry) {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         snapshots.old = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a5b5bab9b5999ec5803b79ffe580bfc2a">cache_remove</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, cached_entry, eid);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cached_entry) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="comment">/* Update snapshot in cache */</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      snapshots.old = <a class="code" href="../../d0/da9/stasis__cache_8c.html#afe81e49fc899cba4730fc1c845990312">cache_udpate</a>(cached_entry, eid, new_snapshot);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="comment">/* Insert into the cache */</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      cached_entry = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a977864320d44b4bc95986045f6bd23f0">cache_entry_create</a>(type, <span class="keywordtype">id</span>, new_snapshot);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">if</span> (cached_entry) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, cached_entry, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="comment">/* Update the aggregate snapshot. */</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <span class="keywordflow">if</span> (cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">aggregate_calc_fn</a> &amp;&amp; cached_entry) {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      snapshots.aggregate_new = cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">aggregate_calc_fn</a>(cached_entry, new_snapshot);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      snapshots.aggregate_old = cached_entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">aggregate</a>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      cached_entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">aggregate</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(snapshots.aggregate_new);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cached_entry);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="keywordflow">return</span> snapshots;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;}</div><div class="ttc" id="structstasis__cache_html_a369970f3c5eed960424f218cd62c7767"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">stasis_cache::aggregate_calc_fn</a></div><div class="ttdeci">cache_aggregate_calc_fn aggregate_calc_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00049">stasis_cache.c:49</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a977864320d44b4bc95986045f6bd23f0"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a977864320d44b4bc95986045f6bd23f0">cache_entry_create</a></div><div class="ttdeci">static struct stasis_cache_entry * cache_entry_create(struct stasis_message_type *type, const char *id, struct stasis_message *snapshot)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00212">stasis_cache.c:212</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3498e30d6154a052e7b64b7a96da8b4b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a></div><div class="ttdeci">#define ao2_wrlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00720">astobj2.h:720</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a5b5bab9b5999ec5803b79ffe580bfc2a"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a5b5bab9b5999ec5803b79ffe580bfc2a">cache_remove</a></div><div class="ttdeci">static struct stasis_message * cache_remove(struct ao2_container *entries, struct stasis_cache_entry *cached_entry, const struct ast_eid *eid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00425">stasis_cache.c:425</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a0723b9228855b55f0e1a0be21cf819ae"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a></div><div class="ttdeci">static struct stasis_cache_entry * cache_find(struct ao2_container *entries, struct stasis_message_type *type, const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00396">stasis_cache.c:396</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structcache__put__snapshots_html"><div class="ttname"><a href="../../d8/d5d/structcache__put__snapshots.html">cache_put_snapshots</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00496">stasis_cache.c:496</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_afe81e49fc899cba4730fc1c845990312"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#afe81e49fc899cba4730fc1c845990312">cache_udpate</a></div><div class="ttdeci">static struct stasis_message * cache_udpate(struct stasis_cache_entry *cached_entry, const struct ast_eid *eid, struct stasis_message *new_snapshot)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00466">stasis_cache.c:466</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_af11d58f16b29e3f5149a1ea04f83d5a4"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">stasis_cache_entry::aggregate</a></div><div class="ttdeci">struct stasis_message * aggregate</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache.c:176</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b5bab9b5999ec5803b79ffe580bfc2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b5bab9b5999ec5803b79ffe580bfc2a">&#9670;&nbsp;</a></span>cache_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* cache_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td>
          <td class="paramname"><em>entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>cached_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00425">425</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01622">ao2_unlink_flags</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00438">AST_VECTOR_REMOVE_UNORDERED</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message_eid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00505">cache_put()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *old_snapshot;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordtype">int</span> is_remote;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   is_remote = <a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(eid, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">if</span> (!is_remote) {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      old_snapshot = cached_entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      cached_entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      old_snapshot = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;cached_entry-&gt;remote); ++idx) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *cur;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         cur = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;cached_entry-&gt;remote, idx);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(eid, <a class="code" href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a>(cur))) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            old_snapshot = <a class="code" href="../../d6/d68/vector_8h.html#a88927df275257d9c9431252e016503ec">AST_VECTOR_REMOVE_UNORDERED</a>(&amp;cached_entry-&gt;remote, idx);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">if</span> (!cached_entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a> &amp;&amp; !<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;cached_entry-&gt;remote)) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a>(entries, cached_entry, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="keywordflow">return</span> old_snapshot;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="vector_8h_html_a88927df275257d9c9431252e016503ec"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a88927df275257d9c9431252e016503ec">AST_VECTOR_REMOVE_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_UNORDERED(vec, idx)</div><div class="ttdoc">Remove an element from an unordered vector by index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00438">vector.h:438</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="stasis_8h_html_ae5dc2372860d977cc3e2a8e9af24aeaf"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a></div><div class="ttdeci">const struct ast_eid * stasis_message_eid(const struct stasis_message *msg)</div><div class="ttdoc">Get the entity id for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message.c:179</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
<div class="ttc" id="astobj2_8h_html_a77df7775a2a8b6cbef307e211dbf045c"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a77df7775a2a8b6cbef307e211dbf045c">ao2_unlink_flags</a></div><div class="ttdeci">#define ao2_unlink_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01622">astobj2.h:1622</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe81e49fc899cba4730fc1c845990312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe81e49fc899cba4730fc1c845990312">&#9670;&nbsp;</a></span>cache_udpate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* cache_udpate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>cached_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>new_snapshot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00466">466</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00438">AST_VECTOR_REMOVE_UNORDERED</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message_eid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00505">cache_put()</a>.</p>
<div class="fragment"><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;{</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *old_snapshot;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <span class="keywordtype">int</span> is_remote;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   is_remote = <a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(eid, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="keywordflow">if</span> (!is_remote) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      old_snapshot = cached_entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      cached_entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(new_snapshot);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">return</span> old_snapshot;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   old_snapshot = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;cached_entry-&gt;remote); ++idx) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *cur;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      cur = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;cached_entry-&gt;remote, idx);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(eid, <a class="code" href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a>(cur))) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;         old_snapshot = <a class="code" href="../../d6/d68/vector_8h.html#a88927df275257d9c9431252e016503ec">AST_VECTOR_REMOVE_UNORDERED</a>(&amp;cached_entry-&gt;remote, idx);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;cached_entry-&gt;remote, new_snapshot)) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(new_snapshot);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keywordflow">return</span> old_snapshot;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div><div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="vector_8h_html_a88927df275257d9c9431252e016503ec"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a88927df275257d9c9431252e016503ec">AST_VECTOR_REMOVE_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_UNORDERED(vec, idx)</div><div class="ttdoc">Remove an element from an unordered vector by index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00438">vector.h:438</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="stasis_8h_html_ae5dc2372860d977cc3e2a8e9af24aeaf"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a></div><div class="ttdeci">const struct ast_eid * stasis_message_eid(const struct stasis_message *msg)</div><div class="ttdoc">Get the entity id for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message.c:179</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6bf91e29b6ef63f34910f4163e71fb93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bf91e29b6ef63f34910f4163e71fb93">&#9670;&nbsp;</a></span>caching_topic_exec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void caching_topic_exec </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">833</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00050">stasis_cache::aggregate_publish_fn</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00720">ao2_wrlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_caching_topic::cache</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00505">cache_put()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00425">cache_remove()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00895">stasis_subscription_change::description</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00048">stasis_cache::id_fn</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_caching_topic::original_topic</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message_eid()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message_type_name()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01176">stasis_subscription_final_message()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00644">stasis_topic_subscribers()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_caching_topic::topic</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00894">stasis_subscription_change::uniqueid</a>, <a class="el" href="../../d0/d89/codec__g726_8c_source.html#l00367">update()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00795">update_create()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00948">stasis_caching_topic_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;{</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic_needs_unref;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic = data;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg_put;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *msg_type;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d0/d86/structast__eid.html">ast_eid</a> *msg_eid;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *msg_id;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(caching_topic != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">id_fn</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a>(sub, message)) {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      caching_topic_needs_unref = caching_topic;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      caching_topic_needs_unref = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;   }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   msg_type = <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(message);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>() == msg_type) {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/d43/structstasis__subscription__change.html">stasis_subscription_change</a> *change = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">       * If this change type is an unsubscribe, we need to find the original</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">       * subscribe and remove it from the cache otherwise the cache will</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">       * continue to grow unabated.</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">if</span> (strcmp(change-&gt;<a class="code" href="../../d5/d43/structstasis__subscription__change.html#a148e968cb2e6176288982274dab428c3">description</a>, <span class="stringliteral">&quot;Unsubscribe&quot;</span>) == 0) {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_sub;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;         cached_sub = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>(), change-&gt;<a class="code" href="../../d5/d43/structstasis__subscription__change.html#ace8710cd56677f85900cab7dca29b82c">uniqueid</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;         <span class="keywordflow">if</span> (cached_sub) {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../d0/da9/stasis__cache_8c.html#a5b5bab9b5999ec5803b79ffe580bfc2a">cache_remove</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, cached_sub, <a class="code" href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a>(message)));</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cached_sub);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;         }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic_needs_unref);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      msg_put = message;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      msg = message;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>() == msg_type) {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="comment">/* Cache clear event. */</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      msg_put = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      msg = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      msg_type = <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(msg);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="comment">/* Normal cache update event. */</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      msg_put = message;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      msg = message;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(msg_type != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   msg_eid = <a class="code" href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a>(msg);<span class="comment">/* msg_eid is NULL for aggregate message. */</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   msg_id = caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">id_fn</a>(msg);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;   <span class="keywordflow">if</span> (msg_id &amp;&amp; msg_eid) {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d8/d5d/structcache__put__snapshots.html">cache_put_snapshots</a> snapshots;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="comment">/* Update the cache */</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      snapshots = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a788fc8fd4acd0452077963c7b8293c0e">cache_put</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>, msg_type, msg_id, msg_eid, msg_put);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="keywordflow">if</span> (snapshots.old || msg_put) {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a461ec3c31a2f54d7c001b0ead6c7313d">stasis_topic_subscribers</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>)) {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            update = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a596d33ddb71259f058643581d2f12d9d">update_create</a>(snapshots.old, msg_put);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <span class="keywordflow">if</span> (update) {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;               <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, update);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(update, -1);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;         }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="stringliteral">&quot;Attempting to remove an item from the %s cache that isn&#39;t there: %s %s\n&quot;</span>,</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>),</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(msg_type), msg_id);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">if</span> (snapshots.aggregate_old != snapshots.aggregate_new) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;         <span class="keywordflow">if</span> (snapshots.aggregate_new &amp;&amp; caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">aggregate_publish_fn</a>) {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">aggregate_publish_fn</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">original_topic</a>,</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;               snapshots.aggregate_new);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;         }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a461ec3c31a2f54d7c001b0ead6c7313d">stasis_topic_subscribers</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>)) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            update = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a596d33ddb71259f058643581d2f12d9d">update_create</a>(snapshots.aggregate_old, snapshots.aggregate_new);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordflow">if</span> (update) {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;               <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, update);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(update, -1);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;         }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(snapshots.old);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(snapshots.aggregate_old);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(snapshots.aggregate_new);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   }</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic_needs_unref);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;}</div><div class="ttc" id="stasis_8h_html_aefd78086150c89477f5851f2836e0478"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a></div><div class="ttdeci">const char * stasis_message_type_name(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the name of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message.c:99</a></div></div>
<div class="ttc" id="codec__g726_8c_html_a8c58a1d1fd9436ff5145385d3ef7a430"><div class="ttname"><a href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a></div><div class="ttdeci">static void update(int code_size, int y, int wi, int fi, int dq, int sr, int dqsez, struct g726_state *state_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d89/codec__g726_8c_source.html#l00367">codec_g726.c:367</a></div></div>
<div class="ttc" id="stasis_8h_html_a461ec3c31a2f54d7c001b0ead6c7313d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a461ec3c31a2f54d7c001b0ead6c7313d">stasis_topic_subscribers</a></div><div class="ttdeci">size_t stasis_topic_subscribers(const struct stasis_topic *topic)</div><div class="ttdoc">Return the number of subscribers of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00644">stasis.c:644</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a6f8938d63002ad38415453cf70c27a14"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">stasis_caching_topic::cache</a></div><div class="ttdeci">struct stasis_cache * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_cache.c:56</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_ad00691c9d41a2baefe2a3bc108bb7ad3"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">stasis_caching_topic::original_topic</a></div><div class="ttdeci">struct stasis_topic * original_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_cache.c:58</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3498e30d6154a052e7b64b7a96da8b4b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3498e30d6154a052e7b64b7a96da8b4b">ao2_wrlock</a></div><div class="ttdeci">#define ao2_wrlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00720">astobj2.h:720</a></div></div>
<div class="ttc" id="structast__eid_html"><div class="ttname"><a href="../../d0/d86/structast__eid.html">ast_eid</a></div><div class="ttdoc">An Entity ID is essentially a MAC address, brief and unique. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00786">utils.h:786</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structstasis__subscription__change_html_ace8710cd56677f85900cab7dca29b82c"><div class="ttname"><a href="../../d5/d43/structstasis__subscription__change.html#ace8710cd56677f85900cab7dca29b82c">stasis_subscription_change::uniqueid</a></div><div class="ttdeci">char * uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00894">stasis.h:894</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="stasis_8h_html_ae5dc2372860d977cc3e2a8e9af24aeaf"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a></div><div class="ttdeci">const struct ast_eid * stasis_message_eid(const struct stasis_message *msg)</div><div class="ttdoc">Get the entity id for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00179">stasis_message.c:179</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a5b5bab9b5999ec5803b79ffe580bfc2a"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a5b5bab9b5999ec5803b79ffe580bfc2a">cache_remove</a></div><div class="ttdeci">static struct stasis_message * cache_remove(struct ao2_container *entries, struct stasis_cache_entry *cached_entry, const struct ast_eid *eid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00425">stasis_cache.c:425</a></div></div>
<div class="ttc" id="structstasis__message__type_html"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00038">stasis_message.c:38</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a0723b9228855b55f0e1a0be21cf819ae"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a></div><div class="ttdeci">static struct stasis_cache_entry * cache_find(struct ao2_container *entries, struct stasis_message_type *type, const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00396">stasis_cache.c:396</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a788fc8fd4acd0452077963c7b8293c0e"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a788fc8fd4acd0452077963c7b8293c0e">cache_put</a></div><div class="ttdeci">static struct cache_put_snapshots cache_put(struct stasis_cache *cache, struct stasis_message_type *type, const char *id, const struct ast_eid *eid, struct stasis_message *new_snapshot)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00505">stasis_cache.c:505</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">stasis_caching_topic::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_cache.c:57</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a596d33ddb71259f058643581d2f12d9d"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a596d33ddb71259f058643581d2f12d9d">update_create</a></div><div class="ttdeci">static struct stasis_message * update_create(struct stasis_message *old_snapshot, struct stasis_message *new_snapshot)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00795">stasis_cache.c:795</a></div></div>
<div class="ttc" id="stasis_8h_html_a839350445aaa51cedf31f6daec933ee0"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a></div><div class="ttdeci">int stasis_subscription_final_message(struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Determine whether a message is the final message to be received on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01176">stasis.c:1176</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="structstasis__subscription__change_html"><div class="ttname"><a href="../../d5/d43/structstasis__subscription__change.html">stasis_subscription_change</a></div><div class="ttdoc">Holds details about changes to subscriptions for the specified topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00892">stasis.h:892</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__subscription__change_html_a148e968cb2e6176288982274dab428c3"><div class="ttname"><a href="../../d5/d43/structstasis__subscription__change.html#a148e968cb2e6176288982274dab428c3">stasis_subscription_change::description</a></div><div class="ttdeci">char description[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00895">stasis.h:895</a></div></div>
<div class="ttc" id="structstasis__cache_html_aeda10c064fed74e2c7297ccd112dbd37"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">stasis_cache::id_fn</a></div><div class="ttdeci">snapshot_get_id id_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00048">stasis_cache.c:48</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00055">stasis_cache.c:55</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
<div class="ttc" id="structstasis__cache_html_af22227dc9b043f62966da1f9f8556137"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">stasis_cache::aggregate_publish_fn</a></div><div class="ttdeci">cache_aggregate_publish_fn aggregate_publish_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00050">stasis_cache.c:50</a></div></div>
<div class="ttc" id="structcache__put__snapshots_html"><div class="ttname"><a href="../../d8/d5d/structcache__put__snapshots.html">cache_put_snapshots</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00496">stasis_cache.c:496</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a21e50c4d5c0fdf83ab6d1e7ed3facbb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e50c4d5c0fdf83ab6d1e7ed3facbb3">&#9670;&nbsp;</a></span>print_cache_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void print_cache_entry </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>v_obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>where</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/da5/astobj2_8h.html#af236ed10cd1eddcbad0579ed0cf9f4c5">ao2_prnt_fn</a> *&#160;</td>
          <td class="paramname"><em>prnt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00937">937</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00170">cache_entry_key::hash</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00168">cache_entry_key::id</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache_entry::key</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message_type_name()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00166">cache_entry_key::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00948">stasis_caching_topic_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a> = v_obj;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   <span class="keywordflow">if</span> (!entry) {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   prnt(where, <span class="stringliteral">&quot;Type: %s  ID: %s  Hash: %u&quot;</span>, <a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>),</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">key</a>.<a class="code" href="../../df/db4/structcache__entry__key.html#a09f9a9ce240560b1d191b42ed56af642">hash</a>);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div><div class="ttc" id="stasis_8h_html_aefd78086150c89477f5851f2836e0478"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a></div><div class="ttdeci">const char * stasis_message_type_name(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the name of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message.c:99</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html_abdd8bbe2aaddbc1db09275d91cdad6ed"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#abdd8bbe2aaddbc1db09275d91cdad6ed">stasis_cache_entry::key</a></div><div class="ttdeci">struct cache_entry_key key</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00174">stasis_cache.c:174</a></div></div>
<div class="ttc" id="structcache__entry__key_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#aeffa2f0815ce90fecbda9aac199143db">cache_entry_key::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00168">stasis_cache.c:168</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a09f9a9ce240560b1d191b42ed56af642"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a09f9a9ce240560b1d191b42ed56af642">cache_entry_key::hash</a></div><div class="ttdeci">unsigned int hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00170">stasis_cache.c:170</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="structcache__entry__key_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../df/db4/structcache__entry__key.html#a39694abd1b80d3c9ef0619acf9d493aa">cache_entry_key::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00166">stasis_cache.c:166</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a8871098ef8b0f1afa6103fd2774ddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a8871098ef8b0f1afa6103fd2774ddb">&#9670;&nbsp;</a></span>stasis_cache_cleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void stasis_cache_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01002">1002</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l01523">STASIS_MESSAGE_TYPE_CLEANUP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01008">stasis_cache_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;{</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a31197e193b1dfd6c122ff6d7c7f6b3fa"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_CLEANUP(name)</div><div class="ttdoc">Boiler-plate messaging macro for cleaning up message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01523">stasis.h:1523</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab5d1a876f8f0cd0562fb5d5f94c06717"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_update_type(void)</div><div class="ttdoc">Message type for cache update messages. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a230d10716f17841b4baed442a6fd2225"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a230d10716f17841b4baed442a6fd2225">&#9670;&nbsp;</a></span>stasis_cache_clear_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_clear_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A message which instructs the caching topic to remove an entry from its cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>Message representative of the cache entry that should be cleared. This will become the data held in the stasis_cache_clear message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Message which, when sent to a <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>, will clear the item from the cache. </dd>
<dd>
<code>NULL</code> on error. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00778">778</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00399">ast_delete_mwi_state_full()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00688">ast_device_state_clear_cache()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00350">ast_endpoint_shutdown()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01033">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00623">clear_node_cache()</a>, and <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00479">remove_device_states_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;{</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>(), id_message);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div><div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64035c0f7317db2590817a173d268ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64035c0f7317db2590817a173d268ff1">&#9670;&nbsp;</a></span>stasis_cache_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a>* stasis_cache_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a>&#160;</td>
          <td class="paramname"><em>id_fn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a cache. </p>
<p>This is the backend store for a <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>. The cache is thread safe, allowing concurrent reads and writes.</p>
<p>The returned object is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id_fn</td><td>Callback to extract the id from a snapshot message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">New</td><td>cache indexed by <em>id_fn</em>. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00360">360</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache_create_full()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00502">mwi_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00065">stasis_cp_all_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/da9/stasis__cache_8c.html#adb417e66895425f128678fe3ed589010">stasis_cache_create_full</a>(id_fn, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_adb417e66895425f128678fe3ed589010"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#adb417e66895425f128678fe3ed589010">stasis_cache_create_full</a></div><div class="ttdeci">struct stasis_cache * stasis_cache_create_full(snapshot_get_id id_fn, cache_aggregate_calc_fn aggregate_calc_fn, cache_aggregate_publish_fn aggregate_publish_fn)</div><div class="ttdoc">Create a cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache.c:334</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb417e66895425f128678fe3ed589010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb417e66895425f128678fe3ed589010">&#9670;&nbsp;</a></span>stasis_cache_create_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a>* stasis_cache_create_full </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a>&#160;</td>
          <td class="paramname"><em>id_fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#aa4a7b629d3125dc329b43715f5f5663b">cache_aggregate_calc_fn</a>&#160;</td>
          <td class="paramname"><em>aggregate_calc_fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a9a0eb1c6ec2920123af41e05b5592a7c">cache_aggregate_publish_fn</a>&#160;</td>
          <td class="paramname"><em>aggregate_publish_fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a cache. </p>
<p>This is the backend store for a <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>. The cache is thread safe, allowing concurrent reads and writes.</p>
<p>The returned object is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id_fn</td><td>Callback to extract the id from a snapshot message. </td></tr>
    <tr><td class="paramname">aggregate_calc_fn</td><td>Callback to calculate the aggregate cache entry. </td></tr>
    <tr><td class="paramname">aggregate_publish_fn</td><td>Callback to publish the aggregate cache entry.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">New</td><td>cache indexed by <em>id_fn</em>. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">334</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00049">stasis_cache::aggregate_calc_fn</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00050">stasis_cache::aggregate_publish_fn</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00367">AO2_ALLOC_OPT_LOCK_RWLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">cache</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00326">cache_dtor()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00288">cache_entry_cmp()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00266">cache_entry_hash()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00048">stasis_cache::id_fn</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00042">NUM_CACHE_BUCKETS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00360">stasis_cache_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   cache = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*cache), <a class="code" href="../../d0/da9/stasis__cache_8c.html#ad08f197928151ebfd2bc4dc40d43cc7d">cache_dtor</a>,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">if</span> (!cache) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488">AO2_ALLOC_OPT_LOCK_RWLOCK</a>, 0,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <a class="code" href="../../d0/da9/stasis__cache_8c.html#aa2c7ce70c25f706f8eafad4001c28daa">NUM_CACHE_BUCKETS</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a8b8388a1d7ada8d25bee76503157c7b3">cache_entry_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#abb6ae2aeb60c09e62d465d9e4f64afc8">cache_entry_cmp</a>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cache);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">id_fn</a> = <a class="code" href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">id_fn</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">aggregate_calc_fn</a> = <a class="code" href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">aggregate_calc_fn</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">aggregate_publish_fn</a> = <a class="code" href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">aggregate_publish_fn</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div><div class="ttc" id="structstasis__cache_html_a369970f3c5eed960424f218cd62c7767"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">stasis_cache::aggregate_calc_fn</a></div><div class="ttdeci">cache_aggregate_calc_fn aggregate_calc_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00049">stasis_cache.c:49</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_abb6ae2aeb60c09e62d465d9e4f64afc8"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#abb6ae2aeb60c09e62d465d9e4f64afc8">cache_entry_cmp</a></div><div class="ttdeci">static int cache_entry_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00288">stasis_cache.c:288</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structstasis__cache_html"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html">stasis_cache</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00046">stasis_cache.c:46</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488">AO2_ALLOC_OPT_LOCK_RWLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00367">astobj2.h:367</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_aefe318d32c8bb7a9e2025eb146d47781"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a></div><div class="ttdeci">struct ao2_container * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">pbx_realtime.c:77</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__cache_html_aeda10c064fed74e2c7297ccd112dbd37"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">stasis_cache::id_fn</a></div><div class="ttdeci">snapshot_get_id id_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00048">stasis_cache.c:48</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_aa2c7ce70c25f706f8eafad4001c28daa"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#aa2c7ce70c25f706f8eafad4001c28daa">NUM_CACHE_BUCKETS</a></div><div class="ttdeci">#define NUM_CACHE_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00042">stasis_cache.c:42</a></div></div>
<div class="ttc" id="structstasis__cache_html_af22227dc9b043f62966da1f9f8556137"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">stasis_cache::aggregate_publish_fn</a></div><div class="ttdeci">cache_aggregate_publish_fn aggregate_publish_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00050">stasis_cache.c:50</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a8b8388a1d7ada8d25bee76503157c7b3"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a8b8388a1d7ada8d25bee76503157c7b3">cache_entry_hash</a></div><div class="ttdeci">static int cache_entry_hash(const void *obj, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00266">stasis_cache.c:266</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_ad08f197928151ebfd2bc4dc40d43cc7d"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#ad08f197928151ebfd2bc4dc40d43cc7d">cache_dtor</a></div><div class="ttdeci">static void cache_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00326">stasis_cache.c:326</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c5612920b22beb93b5e8acbdae40078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c5612920b22beb93b5e8acbdae40078">&#9670;&nbsp;</a></span>stasis_cache_dump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_dump </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump cached items to a subscription for the ast_eid_default entity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to dump (any type if <code>NULL</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d2/da9/structao2__container.html" title="Generic container type. ">ao2_container</a></td><td>containing all matches (must be unreffed by caller) </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">736</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00718">stasis_cache_dump_by_eid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d2d/res__manager__presencestate_8c_source.html#l00073">action_presencestatelist()</a>, <a class="el" href="../../d1/d5a/resource__endpoints_8c_source.html#l00037">ast_ari_endpoints_list()</a>, <a class="el" href="../../d1/d5a/resource__endpoints_8c_source.html#l00085">ast_ari_endpoints_list_by_tech()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01132">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00559">asterisk_publication_devicestate_refresh()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00650">asterisk_publication_mwi_refresh()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>, <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00097">endpoints_scrape_cb()</a>, <a class="el" href="../../d6/d6a/res__endpoint__stats_8c_source.html#l00115">load_module()</a>, <a class="el" href="../../d6/d6a/res__endpoint__stats_8c_source.html#l00134">unload_module()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01588">xmpp_init_event_distribution()</a>.</p>
<div class="fragment"><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;{</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/da9/stasis__cache_8c.html#a9a4de0928d2b230b1c3184ba506ecf26">stasis_cache_dump_by_eid</a>(cache, type, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div><div class="ttc" id="stasis__cache_8c_html_a9a4de0928d2b230b1c3184ba506ecf26"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a9a4de0928d2b230b1c3184ba506ecf26">stasis_cache_dump_by_eid</a></div><div class="ttdeci">struct ao2_container * stasis_cache_dump_by_eid(struct stasis_cache *cache, struct stasis_message_type *type, const struct ast_eid *eid)</div><div class="ttdoc">Dump cached items to a subscription for a specific entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00718">stasis_cache.c:718</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab54f6037e019ae477c15e90e52904d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab54f6037e019ae477c15e90e52904d09">&#9670;&nbsp;</a></span>stasis_cache_dump_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_dump_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump all entity items from the cache to a subscription. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to dump (any type if <code>NULL</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d2/da9/structao2__container.html" title="Generic container type. ">ao2_container</a></td><td>containing all matches (must be unreffed by caller) </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00757">757</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01335">ao2_container_alloc_list</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00741">cache_dump_all_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00692">cache_dump_data::container</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00694">cache_dump_data::eid</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01053">OBJ_MULTIPLE</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c.html#a96256b49165db103875323bce1540653">STASIS_MESSAGE_TYPE_DEFN()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00693">cache_dump_data::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00498">cache_cleanup()</a>, and <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01249">cleanup_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a> cache_dump;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   cache_dump.eid = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   cache_dump.type = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   cache_dump.container = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keywordflow">if</span> (!cache_dump.container) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#af687f0328d2e3cd667cb5a4a881031d4">cache_dump_all_cb</a>, &amp;cache_dump);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="keywordflow">return</span> cache_dump.container;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_af687f0328d2e3cd667cb5a4a881031d4"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#af687f0328d2e3cd667cb5a4a881031d4">cache_dump_all_cb</a></div><div class="ttdeci">static int cache_dump_all_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00741">stasis_cache.c:741</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structcache__dump__data_html"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00691">stasis_cache.c:691</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a4de0928d2b230b1c3184ba506ecf26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4de0928d2b230b1c3184ba506ecf26">&#9670;&nbsp;</a></span>stasis_cache_dump_by_eid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_dump_by_eid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump cached items to a subscription for a specific entity. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to dump (any type if <code>NULL</code>). </td></tr>
    <tr><td class="paramname">eid</td><td>Specific entity id to retrieve. NULL for aggregate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d2/da9/structao2__container.html" title="Generic container type. ">ao2_container</a></td><td>containing all matches (must be unreffed by caller) </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00718">718</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01335">ao2_container_alloc_list</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00697">cache_dump_by_eid_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00692">cache_dump_data::container</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00694">cache_dump_data::eid</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01053">OBJ_MULTIPLE</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00693">cache_dump_data::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d1d/res__manager__devicestate_8c_source.html#l00073">action_devicestatelist()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00647">cpg_confchg_cb()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache_dump()</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a> cache_dump;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   cache_dump.eid = <a class="code" href="../../dc/dea/structcache__dump__data.html#a39d1b63955a48c72508fa9f884d05762">eid</a>;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   cache_dump.type = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   cache_dump.container = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="keywordflow">if</span> (!cache_dump.container) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a364ec06116503a4aa2ebededab145a8b">cache_dump_by_eid_cb</a>, &amp;cache_dump);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="keywordflow">return</span> cache_dump.container;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structcache__dump__data_html_a39d1b63955a48c72508fa9f884d05762"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html#a39d1b63955a48c72508fa9f884d05762">cache_dump_data::eid</a></div><div class="ttdeci">const struct ast_eid * eid</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00694">stasis_cache.c:694</a></div></div>
<div class="ttc" id="structcache__dump__data_html"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00691">stasis_cache.c:691</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a364ec06116503a4aa2ebededab145a8b"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a364ec06116503a4aa2ebededab145a8b">cache_dump_by_eid_cb</a></div><div class="ttdeci">static int cache_dump_by_eid_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00697">stasis_cache.c:697</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a103ead88f88b74cb33bee4a843c4a162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a103ead88f88b74cb33bee4a843c4a162">&#9670;&nbsp;</a></span>stasis_cache_entry_get_aggregate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_entry_get_aggregate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the aggregate cache entry snapshot. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>Cache entry to get the aggregate snapshot.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A reference is not given to the returned pointer so don't unref it.</dd>
<dd>
An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Aggregate-snapshot</td><td>in cache. </td></tr>
    <tr><td class="paramname">NULL</td><td>if not present. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00365">365</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache_entry::aggregate</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, and <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordflow">return</span> entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">aggregate</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div><div class="ttc" id="structstasis__cache__entry_html_af11d58f16b29e3f5149a1ea04f83d5a4"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">stasis_cache_entry::aggregate</a></div><div class="ttdeci">struct stasis_message * aggregate</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache.c:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55563a8b16be69f6f7cae05e5b4e65fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55563a8b16be69f6f7cae05e5b4e65fc">&#9670;&nbsp;</a></span>stasis_cache_entry_get_local()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_entry_get_local </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the local entity's cache entry snapshot. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>Cache entry to get the local entity's snapshot.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A reference is not given to the returned pointer so don't unref it.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Internal-snapshot</td><td>in cache. </td></tr>
    <tr><td class="paramname">NULL</td><td>if not present. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00370">370</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, and <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="keywordflow">return</span> entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0ffccea6541acbcf4ab9d6913f2e757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ffccea6541acbcf4ab9d6913f2e757">&#9670;&nbsp;</a></span>stasis_cache_entry_get_remote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_entry_get_remote </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a remote entity's cache entry snapshot by index. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>Cache entry to get a remote entity's snapshot. </td></tr>
    <tr><td class="paramname">idx</td><td>Which remote entity's snapshot to get.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A reference is not given to the returned pointer so don't unref it.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Remote-entity-snapshot</td><td>in cache. </td></tr>
    <tr><td class="paramname">NULL</td><td>if not present. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00375">375</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, and <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keywordflow">if</span> (idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;entry-&gt;remote)) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;entry-&gt;remote, idx);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3da17290725793258020b83f56e4df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3da17290725793258020b83f56e4df6">&#9670;&nbsp;</a></span>stasis_cache_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve an item from the cache for the ast_eid_default entity. </p>
<p>The returned item is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done with it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to retrieve. </td></tr>
    <tr><td class="paramname">id</td><td>Identity of the snapshot to retrieve.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Message</td><td>from the cache. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00686">686</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00659">stasis_cache_get_by_eid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00341">ast_endpoint_latest_snapshot()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01033">AST_TEST_DEFINE()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l29726">get_cached_mwi()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l05033">has_voicemail()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00125">presence_state_cached()</a>, <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l05675">unistim_send_mwi_to_peer()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l09002">update_registry()</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/da9/stasis__cache_8c.html#a1d22721748b1bfd63ab13d92f19dfd02">stasis_cache_get_by_eid</a>(cache, type, <span class="keywordtype">id</span>, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div><div class="ttc" id="stasis__cache_8c_html_a1d22721748b1bfd63ab13d92f19dfd02"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a1d22721748b1bfd63ab13d92f19dfd02">stasis_cache_get_by_eid</a></div><div class="ttdeci">struct stasis_message * stasis_cache_get_by_eid(struct stasis_cache *cache, struct stasis_message_type *type, const char *id, const struct ast_eid *eid)</div><div class="ttdoc">Retrieve an item from the cache for a specific entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00659">stasis_cache.c:659</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a886f222d38f8a07dee5a595d5c19a3fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886f222d38f8a07dee5a595d5c19a3fb">&#9670;&nbsp;</a></span>stasis_cache_get_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_get_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve all matching entity items from the cache. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to retrieve. </td></tr>
    <tr><td class="paramname">id</td><td>Identity of the snapshot to retrieve.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Container</td><td>of matching items found. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00587">587</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01335">ao2_container_alloc_list</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00719">ao2_rdlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00563">cache_entry_dump()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_entry;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *found;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<span class="keywordtype">id</span> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   found = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   cached_entry = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, type, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <span class="keywordflow">if</span> (cached_entry &amp;&amp; <a class="code" href="../../d0/da9/stasis__cache_8c.html#a4ba570c6048d965f9848d65ca75f7a42">cache_entry_dump</a>(found, cached_entry)) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(found);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      found = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cached_entry);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordflow">return</span> found;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a0723b9228855b55f0e1a0be21cf819ae"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a></div><div class="ttdeci">static struct stasis_cache_entry * cache_find(struct ao2_container *entries, struct stasis_message_type *type, const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00396">stasis_cache.c:396</a></div></div>
<div class="ttc" id="astobj2_8h_html_a24c1bf4b1202c996cf8a793fa6669bc2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a></div><div class="ttdeci">#define ao2_rdlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00719">astobj2.h:719</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4ba570c6048d965f9848d65ca75f7a42"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4ba570c6048d965f9848d65ca75f7a42">cache_entry_dump</a></div><div class="ttdeci">static int cache_entry_dump(struct ao2_container *snapshots, const struct stasis_cache_entry *entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00563">stasis_cache.c:563</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d22721748b1bfd63ab13d92f19dfd02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d22721748b1bfd63ab13d92f19dfd02">&#9670;&nbsp;</a></span>stasis_cache_get_by_eid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_get_by_eid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve an item from the cache for a specific entity. </p>
<p>The returned item is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done with it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to retrieve. </td></tr>
    <tr><td class="paramname">id</td><td>Identity of the snapshot to retrieve. </td></tr>
    <tr><td class="paramname">eid</td><td>Specific entity id to retrieve. NULL for aggregate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Message</td><td>from the cache. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00659">659</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00719">ao2_rdlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00631">cache_entry_by_eid()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00399">ast_delete_mwi_state_full()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00688">ast_device_state_clear_cache()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00511">AST_TEST_DEFINE()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00970">check_cache_aggregate()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00309">devstate_cached()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00686">stasis_cache_get()</a>.</p>
<div class="fragment"><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_entry;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *snapshot = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<span class="keywordtype">id</span> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   cached_entry = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, type, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keywordflow">if</span> (cached_entry) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      snapshot = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a4ecac4fb3b7fba43cc0fae0c20a91cbd">cache_entry_by_eid</a>(cached_entry, eid);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(snapshot);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cached_entry);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordflow">return</span> snapshot;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div><div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a0723b9228855b55f0e1a0be21cf819ae"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a></div><div class="ttdeci">static struct stasis_cache_entry * cache_find(struct ao2_container *entries, struct stasis_message_type *type, const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00396">stasis_cache.c:396</a></div></div>
<div class="ttc" id="astobj2_8h_html_a24c1bf4b1202c996cf8a793fa6669bc2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a></div><div class="ttdeci">#define ao2_rdlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00719">astobj2.h:719</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4ecac4fb3b7fba43cc0fae0c20a91cbd"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4ecac4fb3b7fba43cc0fae0c20a91cbd">cache_entry_by_eid</a></div><div class="ttdeci">static struct stasis_message * cache_entry_by_eid(const struct stasis_cache_entry *entry, const struct ast_eid *eid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00631">stasis_cache.c:631</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81215cb37a9287389855d0529332b1b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81215cb37a9287389855d0529332b1b7">&#9670;&nbsp;</a></span>stasis_cache_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_cache_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01008">1008</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00019">ast_register_cleanup()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01002">stasis_cache_cleanup()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l01501">STASIS_MESSAGE_TYPE_INIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/df4/stasis_8c_source.html#l03061">stasis_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;{</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d0/da9/stasis__cache_8c.html#a0a8871098ef8b0f1afa6103fd2774ddb">stasis_cache_cleanup</a>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>) != 0) {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>) != 0) {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab5d1a876f8f0cd0562fb5d5f94c06717"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_update_type(void)</div><div class="ttdoc">Message type for cache update messages. </div></div>
<div class="ttc" id="stasis__cache_8c_html_a0a8871098ef8b0f1afa6103fd2774ddb"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0a8871098ef8b0f1afa6103fd2774ddb">stasis_cache_cleanup</a></div><div class="ttdeci">static void stasis_cache_cleanup(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l01002">stasis_cache.c:1002</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a20eaab4d0789f4b0662b08688127b971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20eaab4d0789f4b0662b08688127b971">&#9670;&nbsp;</a></span>stasis_cache_update_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void stasis_cache_update_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00783">783</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00973">stasis_cache_update::new_snapshot</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00971">stasis_cache_update::old_snapshot</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00969">stasis_cache_update::type</a>, and <a class="el" href="../../d0/d89/codec__g726_8c_source.html#l00367">update()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00795">update_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;{</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a> *<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a> = obj;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#aa17fe414b5d7ef44223761c25a8047d4">old_snapshot</a>);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#aa17fe414b5d7ef44223761c25a8047d4">old_snapshot</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#aae78adb4af9a7dedb7a77fc0d393076e">new_snapshot</a>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#aae78adb4af9a7dedb7a77fc0d393076e">new_snapshot</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div><div class="ttc" id="structstasis__cache__update_html_aa17fe414b5d7ef44223761c25a8047d4"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html#aa17fe414b5d7ef44223761c25a8047d4">stasis_cache_update::old_snapshot</a></div><div class="ttdeci">struct stasis_message * old_snapshot</div><div class="ttdoc">Old value from the cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00971">stasis.h:971</a></div></div>
<div class="ttc" id="codec__g726_8c_html_a8c58a1d1fd9436ff5145385d3ef7a430"><div class="ttname"><a href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a></div><div class="ttdeci">static void update(int code_size, int y, int wi, int fi, int dq, int sr, int dqsez, struct g726_state *state_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d89/codec__g726_8c_source.html#l00367">codec_g726.c:367</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache__update_html"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a></div><div class="ttdoc">Cache update message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00967">stasis.h:967</a></div></div>
<div class="ttc" id="structstasis__cache__update_html_aae78adb4af9a7dedb7a77fc0d393076e"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html#aae78adb4af9a7dedb7a77fc0d393076e">stasis_cache_update::new_snapshot</a></div><div class="ttdeci">struct stasis_message * new_snapshot</div><div class="ttdoc">New value. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00973">stasis.h:973</a></div></div>
<div class="ttc" id="structstasis__cache__update_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">stasis_cache_update::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdoc">Convenience reference to snapshot type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00969">stasis.h:969</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd235b443f5fffb17c7bc98b6d48ddd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd235b443f5fffb17c7bc98b6d48ddd2">&#9670;&nbsp;</a></span>stasis_caching_accept_message_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_caching_accept_message_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate to a caching topic that we are interested in a message type. </p>
<p>This will cause the caching topic to receive messages of the given message type. This enables internal filtering in the stasis message bus to reduce messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>The caching topic. </td></tr>
    <tr><td class="paramname">type</td><td>The message type we wish to receive. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00090">90</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00222">stasis_cp_single_accept_message_type()</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="comment">/* We wait to accept the stasis specific message types until now so that by default everything</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    * will flow to us.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   res = <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>());</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   res |= <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>());</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   res |= <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, type);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60b3b41b59f3894b40f5630524347d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60b3b41b59f3894b40f5630524347d62">&#9670;&nbsp;</a></span>stasis_caching_get_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_caching_get_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the topic of cached events from a caching topics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>The caching topic. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The topic that publishes cache update events, along with passthrough events from the underlying topic. </dd>
<dd>
<code>NULL</code> if <em>caching_topic</em> is <code>NULL</code>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00085">85</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_caching_topic::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00678">ast_device_state_topic_cached()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00095">ast_mwi_topic_cached()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00375">ast_presence_state_topic_cached()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00139">stasis_cp_single_create()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00213">stasis_cp_single_topic_cached()</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="keywordflow">return</span> caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div><div class="ttc" id="structstasis__caching__topic_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">stasis_caching_topic::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_cache.c:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5db3f77a72f6a07c86a00f638daff07a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5db3f77a72f6a07c86a00f638daff07a">&#9670;&nbsp;</a></span>stasis_caching_set_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_caching_set_filter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a>&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the message type filtering level on a cache. </p>
<p>This will cause the underlying subscription to filter messages according to the provided filter level. For example if selective is used then only messages matching those provided to <a class="el" href="../../d0/df4/stasis_8c.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a> will be raised to the subscription callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>The caching topic. </td></tr>
    <tr><td class="paramname">filter</td><td>What filter to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00109">109</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00231">stasis_cp_single_set_filter()</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, <a class="code" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="func__strings_8c_html_af2deb3c7b0d3bdd442bb9ada5fda3d17"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a></div><div class="ttdeci">static int filter(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00709">func_strings.c:709</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4290101180caea800a0461017a167120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4290101180caea800a0461017a167120">&#9670;&nbsp;</a></span>stasis_caching_topic_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>* stasis_caching_topic_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>original_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a topic which monitors and caches messages from another topic. </p>
<p>The idea is that some topics publish 'snapshots' of some other object's state that should be cached. When these snapshot messages are received, the cache is updated, and a <a class="el" href="../../de/dfa/structstasis__cache__update.html" title="Cache update message. ">stasis_cache_update()</a> message is forwarded, which has both the original snapshot message and the new message.</p>
<p>The returned object is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when done with it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_topic</td><td>Topic publishing snapshot messages. </td></tr>
    <tr><td class="paramname">cache</td><td>Backend cache in which to keep snapshots. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New topic which changes snapshot messages to <a class="el" href="../../de/dfa/structstasis__cache__update.html" title="Cache update message. ">stasis_cache_update()</a> messages, and forwards all other messages from the original topic. </dd>
<dd>
<code>NULL</code> on error </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00948">948</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00958">ao2_container_register()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_caching_topic::cache</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">cache</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_caching_topic::original_topic</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00937">print_cache_entry()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00051">stasis_cache::registered</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00062">stasis_caching_topic_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_caching_topic::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00502">mwi_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00162">stasis_cp_sink_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;{</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   <span class="keyword">static</span> <span class="keywordtype">int</span> caching_id;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <span class="keywordtype">char</span> *new_name;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;new_name, <span class="stringliteral">&quot;cache:%d/%s&quot;</span>, <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;caching_id, +1), <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(original_topic));</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="keywordflow">if</span> (ret &lt; 0) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   caching_topic = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*caching_topic),</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <a class="code" href="../../d0/da9/stasis__cache_8c.html#a5a8fb198af71133995bf7a55be029eed">stasis_caching_topic_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   <span class="keywordflow">if</span> (caching_topic == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(new_name);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a> = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(new_name);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="keywordflow">if</span> (caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, -1);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(new_name);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cache, +1);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a> = <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a>) {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a>(new_name, cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a21e50c4d5c0fdf83ab6d1e7ed3facbb3">print_cache_entry</a>)) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Stasis cache container &#39;%p&#39; for &#39;%s&#39; did not register\n&quot;</span>,</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, new_name);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;         cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a> = 1;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(new_name);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a> = <a class="code" href="../../de/d90/stasis__internal_8h.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a>(original_topic, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a6bf91e29b6ef63f34910f4163e71fb93">caching_topic_exec</a>, caching_topic, 0, 0, __FILE__, __LINE__, __PRETTY_FUNCTION__);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   <span class="keywordflow">if</span> (caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, -1);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(original_topic, +1);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">original_topic</a> = <a class="code" href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">original_topic</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="comment">/* The subscription holds the reference, so no additional ref bump. */</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   <span class="keywordflow">return</span> caching_topic;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a6f8938d63002ad38415453cf70c27a14"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">stasis_caching_topic::cache</a></div><div class="ttdeci">struct stasis_cache * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_cache.c:56</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_ad00691c9d41a2baefe2a3bc108bb7ad3"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">stasis_caching_topic::original_topic</a></div><div class="ttdeci">struct stasis_topic * original_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_cache.c:58</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a6bf91e29b6ef63f34910f4163e71fb93"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a6bf91e29b6ef63f34910f4163e71fb93">caching_topic_exec</a></div><div class="ttdeci">static void caching_topic_exec(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00833">stasis_cache.c:833</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="stasis__internal_8h_html_ab7d9bff23ceccb19080696e3b48506aa"><div class="ttname"><a href="../../de/d90/stasis__internal_8h.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a></div><div class="ttdeci">struct stasis_subscription * internal_stasis_subscribe(struct stasis_topic *topic, stasis_subscription_cb callback, void *data, int needs_mailbox, int use_thread_pool, const char *file, int lineno, const char *func)</div><div class="ttdoc">Create a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00858">stasis.c:858</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="astobj2_8h_html_abdb952d2373503555d96f02f130c5770"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a></div><div class="ttdeci">int ao2_container_register(const char *name, struct ao2_container *self, ao2_prnt_obj_fn *prnt_obj)</div><div class="ttdoc">Register a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00958">astobj2_container.c:958</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__cache_html_a995fb73070b544ea93cbc8b4552a44b0"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a995fb73070b544ea93cbc8b4552a44b0">stasis_cache::registered</a></div><div class="ttdeci">int registered</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00051">stasis_cache.c:51</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">stasis_caching_topic::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_cache.c:57</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_aefe318d32c8bb7a9e2025eb146d47781"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a></div><div class="ttdeci">struct ao2_container * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">pbx_realtime.c:77</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a5a8fb198af71133995bf7a55be029eed"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a5a8fb198af71133995bf7a55be029eed">stasis_caching_topic_dtor</a></div><div class="ttdeci">static void stasis_caching_topic_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00062">stasis_cache.c:62</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00055">stasis_cache.c:55</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a21e50c4d5c0fdf83ab6d1e7ed3facbb3"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a21e50c4d5c0fdf83ab6d1e7ed3facbb3">print_cache_entry</a></div><div class="ttdeci">static void print_cache_entry(void *v_obj, void *where, ao2_prnt_fn *prnt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00937">stasis_cache.c:937</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a8fb198af71133995bf7a55be029eed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a8fb198af71133995bf7a55be029eed">&#9670;&nbsp;</a></span>stasis_caching_topic_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void stasis_caching_topic_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00062">62</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00985">ao2_container_unregister()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_caching_topic::cache</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_caching_topic::original_topic</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01120">stasis_subscription_is_done()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01152">stasis_subscription_is_subscribed()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_caching_topic::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00948">stasis_caching_topic_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;{</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic = obj;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="comment">/* Caching topics contain subscriptions, and must be manually</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    * unsubscribed. */</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!<a class="code" href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>));</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="comment">/* If there are any messages in flight to this subscription; that would</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">    * be bad. */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../dd/d79/stasis_8h.html#a04c69c471e1b836539f280b80b0000de">stasis_subscription_is_done</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>));</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a4b8c1cca9dace1cf1bbadc5039f3dedf">ao2_container_unregister</a>(<a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>));</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">original_topic</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">original_topic</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div><div class="ttc" id="stasis_8h_html_acd5bedbb2212956dac77be47dceef510"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a></div><div class="ttdeci">int stasis_subscription_is_subscribed(const struct stasis_subscription *sub)</div><div class="ttdoc">Returns whether a subscription is currently subscribed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01152">stasis.c:1152</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a6f8938d63002ad38415453cf70c27a14"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">stasis_caching_topic::cache</a></div><div class="ttdeci">struct stasis_cache * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_cache.c:56</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_ad00691c9d41a2baefe2a3bc108bb7ad3"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">stasis_caching_topic::original_topic</a></div><div class="ttdeci">struct stasis_topic * original_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_cache.c:58</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="astobj2_8h_html_a4b8c1cca9dace1cf1bbadc5039f3dedf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a4b8c1cca9dace1cf1bbadc5039f3dedf">ao2_container_unregister</a></div><div class="ttdeci">void ao2_container_unregister(const char *name)</div><div class="ttdoc">Unregister a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00985">astobj2_container.c:985</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">stasis_caching_topic::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_cache.c:57</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="stasis_8h_html_a04c69c471e1b836539f280b80b0000de"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a04c69c471e1b836539f280b80b0000de">stasis_subscription_is_done</a></div><div class="ttdeci">int stasis_subscription_is_done(struct stasis_subscription *subscription)</div><div class="ttdoc">Returns whether subscription has received its final message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01120">stasis.c:1120</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00055">stasis_cache.c:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afdc3370e3a15daaa00179f2f72ab8c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdc3370e3a15daaa00179f2f72ab8c9d">&#9670;&nbsp;</a></span>stasis_caching_unsubscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>* stasis_caching_unsubscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribes a caching topic from its upstream topic. </p>
<p>This function returns immediately, so be sure to cleanup when <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a> is received.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>Caching topic to unsubscribe </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> for convenience </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00119">119</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01152">stasis_subscription_is_subscribed()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">stasis_unsubscribe()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00146">stasis_caching_unsubscribe_and_join()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00189">stasis_cp_single_unsubscribe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">    * The subscription may hold the last reference to this caching</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">    * topic, but we want to make sure the unsubscribe finishes</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">    * before kicking of the caching topic&#39;s dtor.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, +1);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>)) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">       * Increment the reference to hold on to it past the</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">       * unsubscribe. Will be cleaned up in dtor.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, +1);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;stasis_caching_topic unsubscribed multiple times\n&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="ttc" id="stasis_8h_html_acd5bedbb2212956dac77be47dceef510"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a></div><div class="ttdeci">int stasis_subscription_is_subscribed(const struct stasis_subscription *sub)</div><div class="ttdoc">Returns whether a subscription is currently subscribed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01152">stasis.c:1152</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stasis_8h_html_a3498301077e2005383f0d261c471388b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00973">stasis.c:973</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab211ac23afbd0560f08539021888db57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab211ac23afbd0560f08539021888db57">&#9670;&nbsp;</a></span>stasis_caching_unsubscribe_and_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>* stasis_caching_unsubscribe_and_join </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribes a caching topic from its upstream topic, blocking until all messages have been forwarded. </p>
<p>See stasis_unsubscriben_and_join() for more info on when to use this as opposed to <a class="el" href="../../dd/d79/stasis_8h.html#afdc3370e3a15daaa00179f2f72ab8c9d" title="Unsubscribes a caching topic from its upstream topic. ">stasis_caching_unsubscribe()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>Caching topic to unsubscribe </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> for convenience </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00146">146</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00119">stasis_caching_unsubscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01107">stasis_subscription_join()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01710">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00881">devstate_cleanup()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00491">mwi_cleanup()</a>, and <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00484">presence_state_engine_cleanup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="comment">/* Hold a ref past the unsubscribe */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, +1);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <a class="code" href="../../d0/da9/stasis__cache_8c.html#afdc3370e3a15daaa00179f2f72ab8c9d">stasis_caching_unsubscribe</a>(caching_topic);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a68a963557189666f5d733bfb9a826e41">stasis_subscription_join</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8h_html_a68a963557189666f5d733bfb9a826e41"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a68a963557189666f5d733bfb9a826e41">stasis_subscription_join</a></div><div class="ttdeci">void stasis_subscription_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Block until the last message is processed on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01107">stasis.c:1107</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_afdc3370e3a15daaa00179f2f72ab8c9d"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#afdc3370e3a15daaa00179f2f72ab8c9d">stasis_caching_unsubscribe</a></div><div class="ttdeci">struct stasis_caching_topic * stasis_caching_unsubscribe(struct stasis_caching_topic *caching_topic)</div><div class="ttdoc">Unsubscribes a caching topic from its upstream topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00119">stasis_cache.c:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96256b49165db103875323bce1540653"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96256b49165db103875323bce1540653">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_DEFN() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STASIS_MESSAGE_TYPE_DEFN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00757">stasis_cache_dump_all()</a>.</p>

</div>
</div>
<a id="a5cde63de5019f4c569c9660abfb016fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cde63de5019f4c569c9660abfb016fe">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_DEFN() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STASIS_MESSAGE_TYPE_DEFN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a596d33ddb71259f058643581d2f12d9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a596d33ddb71259f058643581d2f12d9d">&#9670;&nbsp;</a></span>update_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* update_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>old_snapshot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>new_snapshot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00795">795</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00973">stasis_cache_update::new_snapshot</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00971">stasis_cache_update::old_snapshot</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00783">stasis_cache_update_dtor()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00969">stasis_cache_update::type</a>, and <a class="el" href="../../d0/d89/codec__g726_8c_source.html#l00367">update()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;{</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a> *<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(old_snapshot != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || new_snapshot != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>()) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   update = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*update), <a class="code" href="../../d0/da9/stasis__cache_8c.html#a20eaab4d0789f4b0662b08688127b971">stasis_cache_update_dtor</a>,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   <span class="keywordflow">if</span> (!update) {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   <span class="keywordflow">if</span> (old_snapshot) {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(old_snapshot, +1);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#aa17fe414b5d7ef44223761c25a8047d4">old_snapshot</a> = old_snapshot;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">if</span> (!new_snapshot) {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(old_snapshot), +1);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;         update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(old_snapshot);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <span class="keywordflow">if</span> (new_snapshot) {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(new_snapshot, +1);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#aae78adb4af9a7dedb7a77fc0d393076e">new_snapshot</a> = new_snapshot;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(new_snapshot), +1);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(new_snapshot);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   }</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>(), update);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(update);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <span class="keywordflow">return</span> msg;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}</div><div class="ttc" id="structstasis__cache__update_html_aa17fe414b5d7ef44223761c25a8047d4"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html#aa17fe414b5d7ef44223761c25a8047d4">stasis_cache_update::old_snapshot</a></div><div class="ttdeci">struct stasis_message * old_snapshot</div><div class="ttdoc">Old value from the cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00971">stasis.h:971</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="codec__g726_8c_html_a8c58a1d1fd9436ff5145385d3ef7a430"><div class="ttname"><a href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a></div><div class="ttdeci">static void update(int code_size, int y, int wi, int fi, int dq, int sr, int dqsez, struct g726_state *state_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d89/codec__g726_8c_source.html#l00367">codec_g726.c:367</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a20eaab4d0789f4b0662b08688127b971"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a20eaab4d0789f4b0662b08688127b971">stasis_cache_update_dtor</a></div><div class="ttdeci">static void stasis_cache_update_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00783">stasis_cache.c:783</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab5d1a876f8f0cd0562fb5d5f94c06717"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_update_type(void)</div><div class="ttdoc">Message type for cache update messages. </div></div>
<div class="ttc" id="structstasis__cache__update_html"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a></div><div class="ttdoc">Cache update message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00967">stasis.h:967</a></div></div>
<div class="ttc" id="structstasis__cache__update_html_aae78adb4af9a7dedb7a77fc0d393076e"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html#aae78adb4af9a7dedb7a77fc0d393076e">stasis_cache_update::new_snapshot</a></div><div class="ttdeci">struct stasis_message * new_snapshot</div><div class="ttdoc">New value. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00973">stasis.h:973</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="structstasis__cache__update_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">stasis_cache_update::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdoc">Convenience reference to snapshot type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00969">stasis.h:969</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:50 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
