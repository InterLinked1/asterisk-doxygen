<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: parking_manager.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li><li class="navelem"><a class="el" href="../../dir_d2f3489fa5a5f753d9a5f9cd50bb6a1c.html">parking</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">parking_manager.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Call Parking Manager Actions and Events.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d38/res__parking_8h_source.html">res_parking.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html">asterisk/config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/dfe/config__options_8h_source.html">asterisk/config_options.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/db0/cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d47/features_8h_source.html">asterisk/features.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d45/manager_8h_source.html">asterisk/manager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d56/bridge_8h_source.html">asterisk/bridge.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for parking_manager.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/d8a/parking__manager_8c__incl.png" border="0" usemap="#parking__manager_8c" alt=""/></div>
<map name="parking__manager_8c" id="parking__manager_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="445,80,529,107"/>
<area shape="rect" id="node22" href="../../d3/d38/res__parking_8h.html" title="Call Parking Resource Internal API. " alt="" coords="1417,80,1525,107"/>
<area shape="rect" id="node25" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="901,752,1036,779"/>
<area shape="rect" id="node28" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="873,528,1000,555"/>
<area shape="rect" id="node29" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1295,603,1410,629"/>
<area shape="rect" id="node37" href="../../d4/d56/bridge_8h.html" title="Bridging API. " alt="" coords="1414,229,1542,256"/>
<area shape="rect" id="node45" href="../../db/dfe/config__options_8h.html" title="Configuration option&#45;handling. " alt="" coords="724,453,904,480"/>
<area shape="rect" id="node47" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1883,229,2019,256"/>
<area shape="rect" id="node48" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="2265,603,2366,629"/>
<area shape="rect" id="node49" href="../../de/d47/features_8h.html" title="Call Parking and Pickup API Includes code and algorithms from the Zapata library. ..." alt="" coords="1661,155,1802,181"/>
<area shape="rect" id="node50" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="1965,80,2111,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="494,155,649,181"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="641,827,779,853"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="335,155,469,181"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="498,229,645,256"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="855,901,997,928"/>
<area shape="rect" id="node23" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="1623,379,1733,405"/>
<area shape="rect" id="node43" href="../../d2/d33/parking_8h.html" title="Call Parking API. " alt="" coords="1299,155,1433,181"/>
<area shape="rect" id="node44" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1075,379,1265,405"/>
<area shape="rect" id="node24" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1177,453,1315,480"/>
<area shape="rect" id="node27" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="1891,528,2038,555"/>
<area shape="rect" id="node30" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1054,677,1211,704"/>
<area shape="rect" id="node32" href="../../d7/d00/sched_8h.html" title="Scheduler Routines (derived from cheops) " alt="" coords="1441,453,1568,480"/>
<area shape="rect" id="node33" href="../../da/da2/devicestate_8h.html" title="Device state management. " alt="" coords="1390,528,1553,555"/>
<area shape="rect" id="node34" href="../../d6/dd7/presencestate_8h.html" title="Presence state management. " alt="" coords="1592,453,1772,480"/>
<area shape="rect" id="node35" href="../../d6/da0/hashtab_8h.html" title="Generic (perhaps overly so) hashtable implementation Hash Table support in Asterisk. " alt="" coords="1796,453,1936,480"/>
<area shape="rect" id="node36" href="../../d1/d99/xmldoc_8h.html" title="Asterisk XML Documentation API. " alt="" coords="1559,603,1693,629"/>
<area shape="rect" id="node26" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1961,827,2112,853"/>
<area shape="rect" id="node31" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1390,677,1521,704"/>
<area shape="rect" id="node38" href="../../dc/d7a/bridge__features_8h.html" title="Channel Bridging API. " alt="" coords="1289,379,1477,405"/>
<area shape="rect" id="node39" href="../../de/d41/bridge__channel_8h.html" title="asterisk/bridge_channel.h" alt="" coords="1076,304,1261,331"/>
<area shape="rect" id="node40" href="../../dd/dff/bridge__roles_8h.html" title="Channel Bridging Roles API. " alt="" coords="2017,752,2184,779"/>
<area shape="rect" id="node41" href="../../d3/d08/dsp_8h.html" title="Convenient Signal Processing routines. " alt="" coords="1285,304,1396,331"/>
<area shape="rect" id="node42" href="../../dd/d1d/uuid_8h.html" title="Universally unique identifier support. " alt="" coords="1421,304,1535,331"/>
</map>
</div>
</div>
<p><a href="../../d0/d39/parking__manager_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d80/structpark__list__data.html">park_list_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a594607491000d02dc9209b638d4ce3ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a594607491000d02dc9209b638d4ce3ae">load_parking_manager</a> (void)</td></tr>
<tr class="memdesc:a594607491000d02dc9209b638d4ce3ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register manager actions and setup subscriptions for stasis events.  <a href="#a594607491000d02dc9209b638d4ce3ae">More...</a><br /></td></tr>
<tr class="separator:a594607491000d02dc9209b638d4ce3ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af351002e0c33ec76ddbf9559facee5aa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#af351002e0c33ec76ddbf9559facee5aa">manager_append_event_parking_lot_data_cb</a> (void *obj, void *arg, void *data, int flags)</td></tr>
<tr class="separator:af351002e0c33ec76ddbf9559facee5aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3502a9b7c2079348bd49a03ad445fb2d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a3502a9b7c2079348bd49a03ad445fb2d">manager_build_parked_call_string</a> (const struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *payload)</td></tr>
<tr class="memdesc:a3502a9b7c2079348bd49a03ad445fb2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds a manager string based on the contents of a parked call payload.  <a href="#a3502a9b7c2079348bd49a03ad445fb2d">More...</a><br /></td></tr>
<tr class="separator:a3502a9b7c2079348bd49a03ad445fb2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ea8c1f888844f3ba5aade3be0bbeba"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a81ea8c1f888844f3ba5aade3be0bbeba">manager_park</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m)</td></tr>
<tr class="separator:a81ea8c1f888844f3ba5aade3be0bbeba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a4f96bcd1eeaac09b20a3fcd61ab89e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a3a4f96bcd1eeaac09b20a3fcd61ab89e">manager_park_bridged</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m, struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *parker_chan, const char *<a class="el" href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a>, int timeout_override)</td></tr>
<tr class="separator:a3a4f96bcd1eeaac09b20a3fcd61ab89e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1e9ca35fa9bf9498feb51c8201baa5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a7a1e9ca35fa9bf9498feb51c8201baa5">manager_park_unbridged</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m, struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *<a class="el" href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a>, int timeout_override)</td></tr>
<tr class="separator:a7a1e9ca35fa9bf9498feb51c8201baa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afab1b826fb258ee4ede950e72697083d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#afab1b826fb258ee4ede950e72697083d">manager_parking_lot_list</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m)</td></tr>
<tr class="separator:afab1b826fb258ee4ede950e72697083d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae173627ea061ac13a887ad640feac171"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#ae173627ea061ac13a887ad640feac171">manager_parking_status</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m)</td></tr>
<tr class="separator:ae173627ea061ac13a887ad640feac171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac105be72a6118941cf5dab1993e1ee0d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#ac105be72a6118941cf5dab1993e1ee0d">manager_parking_status_all_lots</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m, const char *id_text)</td></tr>
<tr class="separator:ac105be72a6118941cf5dab1993e1ee0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab65b7fae0211302e012fc8332ab4de03"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#ab65b7fae0211302e012fc8332ab4de03">manager_parking_status_single_lot</a> (struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *s, const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *m, const char *id_text, const char *lot_name)</td></tr>
<tr class="separator:ab65b7fae0211302e012fc8332ab4de03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac28e6c803a8102bef591b0cb0f6c1ed8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#ac28e6c803a8102bef591b0cb0f6c1ed8">parked_call_message_response</a> (struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *parked_call)</td></tr>
<tr class="separator:ac28e6c803a8102bef591b0cb0f6c1ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b0e39c17bda9dd3eb6776978475393"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a57b0e39c17bda9dd3eb6776978475393">parked_call_payload_from_failure</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</td></tr>
<tr class="separator:a57b0e39c17bda9dd3eb6776978475393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5016e0fa17fee9590d4e40707afed401"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a5016e0fa17fee9590d4e40707afed401">parked_call_payload_from_parked_user</a> (struct <a class="el" href="../../dd/d7e/structparked__user.html">parked_user</a> *pu, enum <a class="el" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485">ast_parked_call_event_type</a> event_type)</td></tr>
<tr class="separator:a5016e0fa17fee9590d4e40707afed401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb18054457e868f6deb00a67d7aecc2f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#aeb18054457e868f6deb00a67d7aecc2f">parking_event_cb</a> (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="separator:aeb18054457e868f6deb00a67d7aecc2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab468a120043b7eb0dcc7531f95c3e095"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#ab468a120043b7eb0dcc7531f95c3e095">parking_manager_disable_stasis</a> (void)</td></tr>
<tr class="separator:ab468a120043b7eb0dcc7531f95c3e095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1298379c9c74696c24029e1f6b7fa76"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#ad1298379c9c74696c24029e1f6b7fa76">parking_manager_enable_stasis</a> (void)</td></tr>
<tr class="separator:ad1298379c9c74696c24029e1f6b7fa76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaecb2e8b6ae6629620589e258c7053bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#aaecb2e8b6ae6629620589e258c7053bf">publish_parked_call</a> (struct <a class="el" href="../../dd/d7e/structparked__user.html">parked_user</a> *pu, enum <a class="el" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485">ast_parked_call_event_type</a> event_type)</td></tr>
<tr class="memdesc:aaecb2e8b6ae6629620589e258c7053bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish a stasis parked call message for a given parked user.  <a href="#aaecb2e8b6ae6629620589e258c7053bf">More...</a><br /></td></tr>
<tr class="separator:aaecb2e8b6ae6629620589e258c7053bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af185e93906eea4f215d95c8ae4552dd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#af185e93906eea4f215d95c8ae4552dd8">publish_parked_call_failure</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *parkee)</td></tr>
<tr class="memdesc:af185e93906eea4f215d95c8ae4552dd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish a stasis parked call message for the channel indicating failure to park.  <a href="#af185e93906eea4f215d95c8ae4552dd8">More...</a><br /></td></tr>
<tr class="separator:af185e93906eea4f215d95c8ae4552dd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6492a673c693917c90981ab183a24339"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a6492a673c693917c90981ab183a24339">unload_parking_manager</a> (void)</td></tr>
<tr class="memdesc:a6492a673c693917c90981ab183a24339"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister manager actions and remove subscriptions for stasis events.  <a href="#a6492a673c693917c90981ab183a24339">More...</a><br /></td></tr>
<tr class="separator:a6492a673c693917c90981ab183a24339"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a65b6e7c22f424324508be5258afb63cd"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a></td></tr>
<tr class="memdesc:a65b6e7c22f424324508be5258afb63cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">subscription to the parking lot topic  <a href="#a65b6e7c22f424324508be5258afb63cd">More...</a><br /></td></tr>
<tr class="separator:a65b6e7c22f424324508be5258afb63cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Call Parking Manager Actions and Events. </p>
<dl class="section author"><dt>Author</dt><dd>Jonathan Rose <a href="#" onclick="location.href='mai'+'lto:'+'jro'+'se'+'@di'+'gi'+'um.'+'co'+'m'; return false;">jrose<span style="display: none;">.nosp@m.</span>@dig<span style="display: none;">.nosp@m.</span>ium.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a594607491000d02dc9209b638d4ce3ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a594607491000d02dc9209b638d4ce3ae">&#9670;&nbsp;</a></span>load_parking_manager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int load_parking_manager </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register manager actions and setup subscriptions for stasis events. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00694">694</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d45/manager_8h_source.html#l00186">ast_manager_register_xml</a>, <a class="el" href="../../db/d45/manager_8h_source.html#l00072">EVENT_FLAG_CALL</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00519">manager_park()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00420">manager_parking_lot_list()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00372">manager_parking_status()</a>, and <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00685">parking_manager_enable_stasis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d45/res__parking_8c_source.html#l01207">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   res = <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;Parkinglots&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../d0/d39/parking__manager_8c.html#afab1b826fb258ee4ede950e72697083d">manager_parking_lot_list</a>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   res |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;ParkedCalls&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../d0/d39/parking__manager_8c.html#ae173627ea061ac13a887ad640feac171">manager_parking_status</a>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   res |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;Park&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../d0/d39/parking__manager_8c.html#a81ea8c1f888844f3ba5aade3be0bbeba">manager_park</a>);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <a class="code" href="../../d0/d39/parking__manager_8c.html#ad1298379c9c74696c24029e1f6b7fa76">parking_manager_enable_stasis</a>();</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <span class="keywordflow">return</span> res ? -1 : 0;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div><div class="ttc" id="parking__manager_8c_html_a81ea8c1f888844f3ba5aade3be0bbeba"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a81ea8c1f888844f3ba5aade3be0bbeba">manager_park</a></div><div class="ttdeci">static int manager_park(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00519">parking_manager.c:519</a></div></div>
<div class="ttc" id="parking__manager_8c_html_ad1298379c9c74696c24029e1f6b7fa76"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#ad1298379c9c74696c24029e1f6b7fa76">parking_manager_enable_stasis</a></div><div class="ttdeci">static void parking_manager_enable_stasis(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00685">parking_manager.c:685</a></div></div>
<div class="ttc" id="parking__manager_8c_html_ae173627ea061ac13a887ad640feac171"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#ae173627ea061ac13a887ad640feac171">manager_parking_status</a></div><div class="ttdeci">static int manager_parking_status(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00372">parking_manager.c:372</a></div></div>
<div class="ttc" id="parking__manager_8c_html_afab1b826fb258ee4ede950e72697083d"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#afab1b826fb258ee4ede950e72697083d">manager_parking_lot_list</a></div><div class="ttdeci">static int manager_parking_lot_list(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00420">parking_manager.c:420</a></div></div>
<div class="ttc" id="manager_8h_html_ab5db3cc603d7e798d61cb4cd94fbb4e2"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a></div><div class="ttdeci">#define EVENT_FLAG_CALL</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00072">manager.h:72</a></div></div>
<div class="ttc" id="manager_8h_html_a5b63b8a8faede2d852e071e1f7b31c11"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a></div><div class="ttdeci">#define ast_manager_register_xml(action, authority, func)</div><div class="ttdoc">Register a manager callback using XML documentation to describe the manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00186">manager.h:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af351002e0c33ec76ddbf9559facee5aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af351002e0c33ec76ddbf9559facee5aa">&#9670;&nbsp;</a></span>manager_append_event_parking_lot_data_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int manager_append_event_parking_lot_data_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00397">397</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d10/manager_8c_source.html#l03080">astman_append()</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00096">parking_lot::cfg</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00394">park_list_data::count</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00393">park_list_data::id_text</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00100">parking_lot::name</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00066">parking_lot_cfg::parking_start</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00067">parking_lot_cfg::parking_stop</a>, and <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00069">parking_lot_cfg::parkingtime</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00420">manager_parking_lot_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;{</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/de7/structparking__lot.html">parking_lot</a> *curlot = obj;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s = arg;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d80/structpark__list__data.html">park_list_data</a> *list_data = data;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: Parkinglot\r\n&quot;</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* The Action ID */</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="stringliteral">&quot;Name: %s\r\n&quot;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="stringliteral">&quot;StartSpace: %d\r\n&quot;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="stringliteral">&quot;StopSpace: %d\r\n&quot;</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="stringliteral">&quot;Timeout: %u\r\n&quot;</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      list_data-&gt;<a class="code" href="../../d5/d80/structpark__list__data.html#aeb4210345df3e51602c9db26a43f3fa7">id_text</a>,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      curlot-&gt;<a class="code" href="../../d4/de7/structparking__lot.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      curlot-&gt;<a class="code" href="../../d4/de7/structparking__lot.html#abc61ea46020e75f93d5d46df84b91fcc">cfg</a>-&gt;<a class="code" href="../../d3/d86/structparking__lot__cfg.html#a22b6d3f18ce27630b9f7220cd3639e48">parking_start</a>,</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      curlot-&gt;<a class="code" href="../../d4/de7/structparking__lot.html#abc61ea46020e75f93d5d46df84b91fcc">cfg</a>-&gt;<a class="code" href="../../d3/d86/structparking__lot__cfg.html#ac6c6bea761c82a98ef22c655cfbf5a56">parking_stop</a>,</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      curlot-&gt;<a class="code" href="../../d4/de7/structparking__lot.html#abc61ea46020e75f93d5d46df84b91fcc">cfg</a>-&gt;<a class="code" href="../../d3/d86/structparking__lot__cfg.html#a4d7f89ef76168c2917fca7fca974538e">parkingtime</a>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   ++list_data-&gt;<a class="code" href="../../d5/d80/structpark__list__data.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div><div class="ttc" id="structpark__list__data_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d5/d80/structpark__list__data.html#ad43c3812e6d13e0518d9f8b8f463ffcf">park_list_data::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00394">parking_manager.c:394</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="structpark__list__data_html_aeb4210345df3e51602c9db26a43f3fa7"><div class="ttname"><a href="../../d5/d80/structpark__list__data.html#aeb4210345df3e51602c9db26a43f3fa7">park_list_data::id_text</a></div><div class="ttdeci">const char * id_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00393">parking_manager.c:393</a></div></div>
<div class="ttc" id="structparking__lot__cfg_html_a4d7f89ef76168c2917fca7fca974538e"><div class="ttname"><a href="../../d3/d86/structparking__lot__cfg.html#a4d7f89ef76168c2917fca7fca974538e">parking_lot_cfg::parkingtime</a></div><div class="ttdeci">unsigned int parkingtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00069">res_parking.h:69</a></div></div>
<div class="ttc" id="structpark__list__data_html"><div class="ttname"><a href="../../d5/d80/structpark__list__data.html">park_list_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00392">parking_manager.c:392</a></div></div>
<div class="ttc" id="structparking__lot__cfg_html_a22b6d3f18ce27630b9f7220cd3639e48"><div class="ttname"><a href="../../d3/d86/structparking__lot__cfg.html#a22b6d3f18ce27630b9f7220cd3639e48">parking_lot_cfg::parking_start</a></div><div class="ttdeci">int parking_start</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00066">res_parking.h:66</a></div></div>
<div class="ttc" id="structmansession_html"><div class="ttname"><a href="../../d2/d8a/structmansession.html">mansession</a></div><div class="ttdoc">In case you didn&amp;#39;t read that giant block of text above the mansession_session struct, the struct mansession is named this solely to keep the API the same in Asterisk. This structure really represents data that is different from Manager action to Manager action. The mansession_session pointer contained within points to session-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01625">manager.c:1625</a></div></div>
<div class="ttc" id="structparking__lot__cfg_html_ac6c6bea761c82a98ef22c655cfbf5a56"><div class="ttname"><a href="../../d3/d86/structparking__lot__cfg.html#ac6c6bea761c82a98ef22c655cfbf5a56">parking_lot_cfg::parking_stop</a></div><div class="ttdeci">int parking_stop</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00067">res_parking.h:67</a></div></div>
<div class="ttc" id="structparking__lot_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../d4/de7/structparking__lot.html#ace9168767fc3707cf5f0a7d049682ba3">parking_lot::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00100">res_parking.h:100</a></div></div>
<div class="ttc" id="structparking__lot_html"><div class="ttname"><a href="../../d4/de7/structparking__lot.html">parking_lot</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00092">res_parking.h:92</a></div></div>
<div class="ttc" id="structparking__lot_html_abc61ea46020e75f93d5d46df84b91fcc"><div class="ttname"><a href="../../d4/de7/structparking__lot.html#abc61ea46020e75f93d5d46df84b91fcc">parking_lot::cfg</a></div><div class="ttdeci">struct parking_lot_cfg * cfg</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00096">res_parking.h:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3502a9b7c2079348bd49a03ad445fb2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3502a9b7c2079348bd49a03ad445fb2d">&#9670;&nbsp;</a></span>manager_build_parked_call_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a>* manager_build_parked_call_string </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *&#160;</td>
          <td class="paramname"><em>payload</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Builds a manager string based on the contents of a parked call payload. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00215">215</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00487">ast_manager_build_channel_state_string_prefix()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01065">ast_str_set()</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00064">ast_parked_call_payload::duration</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d47/utils_2frame_8c_source.html#l00033">out</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00060">ast_parked_call_payload::parkee</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00069">ast_parked_call_payload::parker_dial_string</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00069">ast_parked_call_payload::parkinglot</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00065">ast_parked_call_payload::parkingspace</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00061">ast_parked_call_payload::retriever</a>, and <a class="el" href="../../d2/d33/parking_8h_source.html#l00063">ast_parked_call_payload::timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00309">manager_parking_status_all_lots()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00259">manager_parking_status_single_lot()</a>, and <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00639">parked_call_message_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(1024);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, parkee_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, retriever_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="keywordflow">if</span> (!out) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   parkee_string = <a class="code" href="../../db/d45/manager_8h.html#ab71472ea55b4114f460a4459e3dcd18b">ast_manager_build_channel_state_string_prefix</a>(payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#abf322ebc13d3689cf5a5e81e4569c602">parkee</a>, <span class="stringliteral">&quot;Parkee&quot;</span>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keywordflow">if</span> (!parkee_string) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(out);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#ab202e6af66537b13bb4af19a9c32596f">retriever</a>) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      retriever_string = <a class="code" href="../../db/d45/manager_8h.html#ab71472ea55b4114f460a4459e3dcd18b">ast_manager_build_channel_state_string_prefix</a>(payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#ab202e6af66537b13bb4af19a9c32596f">retriever</a>, <span class="stringliteral">&quot;Retriever&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">if</span> (!retriever_string) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(out);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* parkee channel state */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* retriever channel state (when available) */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="stringliteral">&quot;ParkerDialString: %s\r\n&quot;</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="stringliteral">&quot;Parkinglot: %s\r\n&quot;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="stringliteral">&quot;ParkingSpace: %u\r\n&quot;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="stringliteral">&quot;ParkingTimeout: %lu\r\n&quot;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="stringliteral">&quot;ParkingDuration: %lu\r\n&quot;</span>,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(parkee_string),</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      retriever_string ? <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(retriever_string) : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#af6f4ae90f0018cf7a33233d1456b0342">parker_dial_string</a>,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#a85f78688c172cdbdfe2c3af48c470b35">parkinglot</a>,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#a3c927af64370b9380770ec2ea0ed9a89">parkingspace</a>,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#ab44713242547dd52264a0ab8f9edb501">timeout</a>,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      payload-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#a4621d03fc50ff90da2c6034c3ebef0bd">duration</a>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="manager_8h_html_ab71472ea55b4114f460a4459e3dcd18b"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab71472ea55b4114f460a4459e3dcd18b">ast_manager_build_channel_state_string_prefix</a></div><div class="ttdeci">struct ast_str * ast_manager_build_channel_state_string_prefix(const struct ast_channel_snapshot *snapshot, const char *prefix)</div><div class="ttdoc">Generate the AMI message body from a channel snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1c/manager__channels_8c_source.html#l00487">manager_channels.c:487</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_a4621d03fc50ff90da2c6034c3ebef0bd"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#a4621d03fc50ff90da2c6034c3ebef0bd">ast_parked_call_payload::duration</a></div><div class="ttdeci">long unsigned int duration</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00064">parking.h:64</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_abf322ebc13d3689cf5a5e81e4569c602"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#abf322ebc13d3689cf5a5e81e4569c602">ast_parked_call_payload::parkee</a></div><div class="ttdeci">struct ast_channel_snapshot * parkee</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00060">parking.h:60</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_a3c927af64370b9380770ec2ea0ed9a89"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#a3c927af64370b9380770ec2ea0ed9a89">ast_parked_call_payload::parkingspace</a></div><div class="ttdeci">unsigned int parkingspace</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00065">parking.h:65</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_ab44713242547dd52264a0ab8f9edb501"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#ab44713242547dd52264a0ab8f9edb501">ast_parked_call_payload::timeout</a></div><div class="ttdeci">long unsigned int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00063">parking.h:63</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_a85f78688c172cdbdfe2c3af48c470b35"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#a85f78688c172cdbdfe2c3af48c470b35">ast_parked_call_payload::parkinglot</a></div><div class="ttdeci">const ast_string_field parkinglot</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00069">parking.h:69</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a48bc11919b2752df9d14ce89557cfb25"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00033">utils/frame.c:33</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_af6f4ae90f0018cf7a33233d1456b0342"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#af6f4ae90f0018cf7a33233d1456b0342">ast_parked_call_payload::parker_dial_string</a></div><div class="ttdeci">const ast_string_field parker_dial_string</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00069">parking.h:69</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_ab202e6af66537b13bb4af19a9c32596f"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#ab202e6af66537b13bb4af19a9c32596f">ast_parked_call_payload::retriever</a></div><div class="ttdeci">struct ast_channel_snapshot * retriever</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00061">parking.h:61</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81ea8c1f888844f3ba5aade3be0bbeba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81ea8c1f888844f3ba5aade3be0bbeba">&#9670;&nbsp;</a></span>manager_park()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int manager_park </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00519">519</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d0/d95/bridge_8c_source.html#l04404">ast_bridge_set_transfer_variables()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l10765">ast_channel_bridge_peer()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02992">ast_channel_cleanup</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01454">ast_channel_get_by_name()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00305">ast_channel_uniqueid()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l02820">astman_get_header()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03159">astman_send_error()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../de/d41/bridge__channel_8h_source.html#l00091">ast_bridge_channel::chan</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00233">create_parked_subscription()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00473">manager_park_bridged()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00452">manager_park_unbridged()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00228">MAX</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l00163">parkinglot</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, and <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00086">timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00694">load_parking_manager()</a>.</p>
<div class="fragment"><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;{</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d84/structchannel.html">channel</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *timeout_channel = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;TimeoutChannel&quot;</span>), <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel2&quot;</span>));</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *announce_channel = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;AnnounceChannel&quot;</span>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Timeout&quot;</span>);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Parkinglot&quot;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[BUFSIZ];</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="keywordtype">int</span> timeout_override = -1;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, parker_chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(channel)) {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Channel not specified&quot;</span>);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(timeout)) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (sscanf(timeout, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;timeout_override) != 1 || timeout_override &lt; 0) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid Timeout value.&quot;</span>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">if</span> (timeout_override) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;         <span class="comment">/* If greater than zero, convert to seconds for internal use. Must be &gt;= 1 second. */</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;         timeout_override = <a class="code" href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(1, timeout_override / 1000);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordflow">if</span> (!(chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(channel))) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;Channel does not exist: %s&quot;</span>, channel);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, buf);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   }</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(timeout_channel)) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a8878fc7451a873f155aba20b0b31abbb">ast_bridge_set_transfer_variables</a>(chan, timeout_channel, 0);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   parker_chan = <a class="code" href="../../d5/d7b/channel_8h.html#af9e27ecd92ff5aa897c9e058dfbd6510">ast_channel_bridge_peer</a>(chan);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="keywordflow">if</span> (!parker_chan || strcmp(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(parker_chan), timeout_channel)) {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(announce_channel)) {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *announce_chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(announce_channel);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         <span class="keywordflow">if</span> (!announce_channel) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;AnnounceChannel does not exist&quot;</span>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;         }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;         <a class="code" href="../../d1/db7/parking__bridge__features_8c.html#a88326c901ae53e5ce78f1cfd9a57bab8">create_parked_subscription</a>(announce_chan, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), 0);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a>(announce_chan);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <a class="code" href="../../d0/d39/parking__manager_8c.html#a7a1e9ca35fa9bf9498feb51c8201baa5">manager_park_unbridged</a>(s, m, chan, parkinglot, timeout_override);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(announce_channel) &amp;&amp; strcmp(announce_channel, timeout_channel)) {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="comment">/* When using an announce_channel in bridge mode, only add the announce channel if it isn&#39;t</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">       * the same as the timeout channel (which will play announcements anyway) */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *announce_chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(announce_channel);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordflow">if</span> (!announce_channel) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;AnnounceChannel does not exist&quot;</span>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <a class="code" href="../../d1/db7/parking__bridge__features_8c.html#a88326c901ae53e5ce78f1cfd9a57bab8">create_parked_subscription</a>(announce_chan, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), 0);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a>(announce_chan);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <a class="code" href="../../d0/d39/parking__manager_8c.html#a3a4f96bcd1eeaac09b20a3fcd61ab89e">manager_park_bridged</a>(s, m, chan, parker_chan, parkinglot, timeout_override);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div><div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a6b31bfcc769a5b5c31e13aa6d8a9a286"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a></div><div class="ttdeci">static char parkinglot[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00163">chan_mgcp.c:163</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="structchannel_html"><div class="ttname"><a href="../../d4/d84/structchannel.html">channel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8a/muted_8c_source.html#l00095">muted.c:95</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="utils_8h_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00228">utils.h:228</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="channel_8h_html_ae93ebb3372a2d9495ae3c5417dd95cd5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a></div><div class="ttdeci">#define ast_channel_cleanup(c)</div><div class="ttdoc">Cleanup a channel reference. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02992">channel.h:2992</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a3a4f96bcd1eeaac09b20a3fcd61ab89e"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a3a4f96bcd1eeaac09b20a3fcd61ab89e">manager_park_bridged</a></div><div class="ttdeci">static void manager_park_bridged(struct mansession *s, const struct message *m, struct ast_channel *chan, struct ast_channel *parker_chan, const char *parkinglot, int timeout_override)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00473">parking_manager.c:473</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a7a1e9ca35fa9bf9498feb51c8201baa5"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a7a1e9ca35fa9bf9498feb51c8201baa5">manager_park_unbridged</a></div><div class="ttdeci">static void manager_park_unbridged(struct mansession *s, const struct message *m, struct ast_channel *chan, const char *parkinglot, int timeout_override)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00452">parking_manager.c:452</a></div></div>
<div class="ttc" id="bridge_8h_html_a8878fc7451a873f155aba20b0b31abbb"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a8878fc7451a873f155aba20b0b31abbb">ast_bridge_set_transfer_variables</a></div><div class="ttdeci">void ast_bridge_set_transfer_variables(struct ast_channel *chan, const char *value, int is_attended)</div><div class="ttdoc">Set the relevant transfer variables for a single channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04404">bridge.c:4404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="channel_8h_html_af9e27ecd92ff5aa897c9e058dfbd6510"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af9e27ecd92ff5aa897c9e058dfbd6510">ast_channel_bridge_peer</a></div><div class="ttdeci">struct ast_channel * ast_channel_bridge_peer(struct ast_channel *chan)</div><div class="ttdoc">Get the channel&amp;#39;s bridge peer only if the bridge is two-party. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10765">channel.c:10765</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="channel_8h_html_ac7e42045272530c8678418993e75fd56"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a></div><div class="ttdeci">struct ast_channel * ast_channel_get_by_name(const char *name)</div><div class="ttdoc">Find a channel by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01454">channel.c:1454</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="parking__bridge__features_8c_html_a88326c901ae53e5ce78f1cfd9a57bab8"><div class="ttname"><a href="../../d1/db7/parking__bridge__features_8c.html#a88326c901ae53e5ce78f1cfd9a57bab8">create_parked_subscription</a></div><div class="ttdeci">int create_parked_subscription(struct ast_channel *chan, const char *parkee_uuid, int hangup_after)</div><div class="ttdoc">Create a parking announcement subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db7/parking__bridge__features_8c_source.html#l00233">parking_bridge_features.c:233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a4f96bcd1eeaac09b20a3fcd61ab89e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a4f96bcd1eeaac09b20a3fcd61ab89e">&#9670;&nbsp;</a></span>manager_park_bridged()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void manager_park_bridged </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>parker_chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>parkinglot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout_override</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00473">473</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../d3/d32/bridge__channel_8c_source.html#l01555">ast_bridge_channel_write_park()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l10783">ast_channel_get_bridge_channel()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00305">ast_channel_uniqueid()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03191">astman_send_ack()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03159">astman_send_error()</a>, and <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00233">create_parked_subscription()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00519">manager_park()</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../da/d37/structapp__data.html">app_data</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="keywordflow">if</span> (timeout_override != -1) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;app_data, <span class="stringliteral">&quot;%s,t(%d)&quot;</span>, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a>, timeout_override) == -1) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Park action failed\n&quot;</span>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;app_data, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a>) == -1) {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Park action failed\n&quot;</span>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(parker_chan);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   bridge_channel = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(parker_chan);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(parker_chan);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keywordflow">if</span> (!bridge_channel) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(app_data);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Park action failed\n&quot;</span>);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="comment">/* Subscribe to park messages for the channel being parked */</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/db7/parking__bridge__features_8c.html#a88326c901ae53e5ce78f1cfd9a57bab8">create_parked_subscription</a>(parker_chan, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), 1)) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(app_data);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Park action failed\n&quot;</span>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(bridge_channel);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#af9a368f3ce4811e8ca53ef51d6cd69f9">ast_bridge_channel_write_park</a>(bridge_channel, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan),</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(parker_chan), app_data);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(app_data);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Park successful\n&quot;</span>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(bridge_channel);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div><div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a6b31bfcc769a5b5c31e13aa6d8a9a286"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a></div><div class="ttdeci">static char parkinglot[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00163">chan_mgcp.c:163</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_af9a368f3ce4811e8ca53ef51d6cd69f9"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#af9a368f3ce4811e8ca53ef51d6cd69f9">ast_bridge_channel_write_park</a></div><div class="ttdeci">int ast_bridge_channel_write_park(struct ast_bridge_channel *bridge_channel, const char *parkee_uuid, const char *parker_uuid, const char *app_data)</div><div class="ttdoc">Have a bridge channel park a channel in the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01555">bridge_channel.c:1555</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga77315fa8e29950f0c88120501acda0a3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a></div><div class="ttdeci">void astman_send_ack(struct mansession *s, const struct message *m, char *msg)</div><div class="ttdoc">Send ack in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03191">manager.c:3191</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structapp__data_html"><div class="ttname"><a href="../../da/d37/structapp__data.html">app_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d77/test__res__stasis_8c_source.html#l00062">test_res_stasis.c:62</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="channel_8h_html_a9b6409c38af733c46eead884d86dd284"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a></div><div class="ttdeci">struct ast_bridge_channel * ast_channel_get_bridge_channel(struct ast_channel *chan)</div><div class="ttdoc">Get a reference to the channel&amp;#39;s bridge pointer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10783">channel.c:10783</a></div></div>
<div class="ttc" id="structast__bridge__channel_html"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a></div><div class="ttdoc">Structure that contains information regarding a channel in a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00084">bridge_channel.h:84</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="parking__bridge__features_8c_html_a88326c901ae53e5ce78f1cfd9a57bab8"><div class="ttname"><a href="../../d1/db7/parking__bridge__features_8c.html#a88326c901ae53e5ce78f1cfd9a57bab8">create_parked_subscription</a></div><div class="ttdeci">int create_parked_subscription(struct ast_channel *chan, const char *parkee_uuid, int hangup_after)</div><div class="ttdoc">Create a parking announcement subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db7/parking__bridge__features_8c_source.html#l00233">parking_bridge_features.c:233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a1e9ca35fa9bf9498feb51c8201baa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a1e9ca35fa9bf9498feb51c8201baa5">&#9670;&nbsp;</a></span>manager_park_unbridged()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void manager_park_unbridged </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>parkinglot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout_override</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00452">452</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d0/d95/bridge_8c_source.html#l02519">ast_bridge_add_channel()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03191">astman_send_ack()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03159">astman_send_error()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00484">park_common_setup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00519">manager_park()</a>.</p>
<div class="fragment"><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;{</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *parking_bridge = <a class="code" href="../../da/ded/parking__applications_8c.html#a4c6489dc74f9057e099fc6018723af4a">park_common_setup</a>(chan,</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      chan, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, timeout_override, 1);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keywordflow">if</span> (!parking_bridge) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Park action failed\n&quot;</span>);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d47/features_8h.html#aabeca6aae7e5db0dfe25ab88c1a40b07">ast_bridge_add_channel</a>(parking_bridge, chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Park action failed\n&quot;</span>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(parking_bridge);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Park successful\n&quot;</span>);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(parking_bridge);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div><div class="ttc" id="chan__mgcp_8c_html_a6b31bfcc769a5b5c31e13aa6d8a9a286"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b31bfcc769a5b5c31e13aa6d8a9a286">parkinglot</a></div><div class="ttdeci">static char parkinglot[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00163">chan_mgcp.c:163</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga77315fa8e29950f0c88120501acda0a3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a></div><div class="ttdeci">void astman_send_ack(struct mansession *s, const struct message *m, char *msg)</div><div class="ttdoc">Send ack in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03191">manager.c:3191</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__bridge_html"><div class="ttname"><a href="../../d4/d84/structast__bridge.html">ast_bridge</a></div><div class="ttdoc">Structure that contains information about a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00357">bridge.h:357</a></div></div>
<div class="ttc" id="features_8h_html_aabeca6aae7e5db0dfe25ab88c1a40b07"><div class="ttname"><a href="../../de/d47/features_8h.html#aabeca6aae7e5db0dfe25ab88c1a40b07">ast_bridge_add_channel</a></div><div class="ttdeci">int ast_bridge_add_channel(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_bridge_features *features, int play_tone, const char *xfersound)</div><div class="ttdoc">Add an arbitrary channel to a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02519">bridge.c:2519</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="parking__applications_8c_html_a4c6489dc74f9057e099fc6018723af4a"><div class="ttname"><a href="../../da/ded/parking__applications_8c.html#a4c6489dc74f9057e099fc6018723af4a">park_common_setup</a></div><div class="ttdeci">struct ast_bridge * park_common_setup(struct ast_channel *parkee, struct ast_channel *parker, const char *lot_name, const char *comeback_override, int use_ringing, int randomize, int time_limit, int silence_announcements)</div><div class="ttdoc">Setup a parked call on a parking bridge without needing to parse appdata. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/ded/parking__applications_8c_source.html#l00484">parking_applications.c:484</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afab1b826fb258ee4ede950e72697083d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afab1b826fb258ee4ede950e72697083d">&#9670;&nbsp;</a></span>manager_parking_lot_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int manager_parking_lot_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00420">420</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01743">ao2_callback_data</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l02820">astman_get_header()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03159">astman_send_error()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03245">astman_send_list_complete_end()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03237">astman_send_list_complete_start()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03201">astman_send_listack()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00394">park_list_data::count</a>, <a class="el" href="../../d7/d45/res__parking_8c_source.html#l00596">get_parking_lot_container()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00393">park_list_data::id_text</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00397">manager_append_event_parking_lot_data_cb()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01053">OBJ_MULTIPLE</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00694">load_parking_manager()</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;{</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *lot_container;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keywordtype">char</span> id_text[256];</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d80/structpark__list__data.html">park_list_data</a> list_data;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   id_text[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      snprintf(id_text, <span class="keyword">sizeof</span>(id_text), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   lot_container = <a class="code" href="../../d3/d38/res__parking_8h.html#a58b53672752610716a514d4da2f89bec">get_parking_lot_container</a>();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">if</span> (!lot_container) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to obtain parking lot list. Action canceled.\n&quot;</span>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Could not create parking lot list&quot;</span>);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Parking lots will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   list_data.id_text = <a class="code" href="../../d5/d80/structpark__list__data.html#aeb4210345df3e51602c9db26a43f3fa7">id_text</a>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   list_data.count = 0;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(lot_container, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <a class="code" href="../../d0/d39/parking__manager_8c.html#af351002e0c33ec76ddbf9559facee5aa">manager_append_event_parking_lot_data_cb</a>, s, &amp;list_data);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;ParkinglotsComplete&quot;</span>, list_data.count);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="structpark__list__data_html_aeb4210345df3e51602c9db26a43f3fa7"><div class="ttname"><a href="../../d5/d80/structpark__list__data.html#aeb4210345df3e51602c9db26a43f3fa7">park_list_data::id_text</a></div><div class="ttdeci">const char * id_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00393">parking_manager.c:393</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="structpark__list__data_html"><div class="ttname"><a href="../../d5/d80/structpark__list__data.html">park_list_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00392">parking_manager.c:392</a></div></div>
<div class="ttc" id="res__parking_8h_html_a58b53672752610716a514d4da2f89bec"><div class="ttname"><a href="../../d3/d38/res__parking_8h.html#a58b53672752610716a514d4da2f89bec">get_parking_lot_container</a></div><div class="ttdeci">struct ao2_container * get_parking_lot_container(void)</div><div class="ttdoc">Get a pointer to the parking lot container for purposes such as iteration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d45/res__parking_8c_source.html#l00596">res_parking.c:596</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="parking__manager_8c_html_af351002e0c33ec76ddbf9559facee5aa"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#af351002e0c33ec76ddbf9559facee5aa">manager_append_event_parking_lot_data_cb</a></div><div class="ttdeci">static int manager_append_event_parking_lot_data_cb(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00397">parking_manager.c:397</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_a63fd831fe48aed32d3ef992ad8e45293"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a></div><div class="ttdeci">#define ao2_callback_data(container, flags, cb_fn, arg, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01743">astobj2.h:1743</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae173627ea061ac13a887ad640feac171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae173627ea061ac13a887ad640feac171">&#9670;&nbsp;</a></span>manager_parking_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int manager_parking_status </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00372">372</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l02820">astman_get_header()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00309">manager_parking_status_all_lots()</a>, and <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00259">manager_parking_status_single_lot()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00694">load_parking_manager()</a>.</p>
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;{</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *lot_name = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ParkingLot&quot;</span>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d5/d80/structpark__list__data.html#aeb4210345df3e51602c9db26a43f3fa7">id_text</a>[256];</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   id_text[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      snprintf(id_text, <span class="keyword">sizeof</span>(id_text), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(lot_name)) {</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="../../d0/d39/parking__manager_8c.html#ab65b7fae0211302e012fc8332ab4de03">manager_parking_status_single_lot</a>(s, m, id_text, lot_name);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="../../d0/d39/parking__manager_8c.html#ac105be72a6118941cf5dab1993e1ee0d">manager_parking_status_all_lots</a>(s, m, id_text);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;}</div><div class="ttc" id="structpark__list__data_html_aeb4210345df3e51602c9db26a43f3fa7"><div class="ttname"><a href="../../d5/d80/structpark__list__data.html#aeb4210345df3e51602c9db26a43f3fa7">park_list_data::id_text</a></div><div class="ttdeci">const char * id_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00393">parking_manager.c:393</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="parking__manager_8c_html_ab65b7fae0211302e012fc8332ab4de03"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#ab65b7fae0211302e012fc8332ab4de03">manager_parking_status_single_lot</a></div><div class="ttdeci">static void manager_parking_status_single_lot(struct mansession *s, const struct message *m, const char *id_text, const char *lot_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00259">parking_manager.c:259</a></div></div>
<div class="ttc" id="parking__manager_8c_html_ac105be72a6118941cf5dab1993e1ee0d"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#ac105be72a6118941cf5dab1993e1ee0d">manager_parking_status_all_lots</a></div><div class="ttdeci">static void manager_parking_status_all_lots(struct mansession *s, const struct message *m, const char *id_text)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00309">parking_manager.c:309</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac105be72a6118941cf5dab1993e1ee0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac105be72a6118941cf5dab1993e1ee0d">&#9670;&nbsp;</a></span>manager_parking_status_all_lots()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void manager_parking_status_all_lots </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00309">309</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00534">ao2_iterator_destroy()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00485">ao2_iterator_init()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01933">ao2_iterator_next</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03080">astman_append()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03159">astman_send_error()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03245">astman_send_list_complete_end()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03237">astman_send_list_complete_start()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03201">astman_send_listack()</a>, <a class="el" href="../../d7/d45/res__parking_8c_source.html#l00596">get_parking_lot_container()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00215">manager_build_parked_call_string()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00047">PARKED_CALL</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00192">parked_call_payload_from_parked_user()</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00095">parking_lot::parked_users</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../dd/d27/res__adsi_8c_source.html#l00968">total</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00372">manager_parking_status()</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d7e/structparked__user.html">parked_user</a> *curuser;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *lot_container;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter_lots;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter_users;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/de7/structparking__lot.html">parking_lot</a> *curlot;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a> = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   lot_container = <a class="code" href="../../d3/d38/res__parking_8h.html#a58b53672752610716a514d4da2f89bec">get_parking_lot_container</a>();</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="keywordflow">if</span> (!lot_container) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to obtain parking lot list. Action canceled.\n&quot;</span>);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Could not create parking lot list&quot;</span>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Parked calls will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   iter_lots = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(lot_container, 0);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keywordflow">while</span> ((curlot = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter_lots))) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      iter_users = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(curlot-&gt;<a class="code" href="../../d4/de7/structparking__lot.html#aea5a92769425a243bac168470b7f6a2f">parked_users</a>, 0);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">while</span> ((curuser = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter_users))) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, parked_call_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         payload = <a class="code" href="../../d0/d39/parking__manager_8c.html#a5016e0fa17fee9590d4e40707afed401">parked_call_payload_from_parked_user</a>(curuser, <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7">PARKED_CALL</a>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;         <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curuser, -1);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter_users);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curlot, -1);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">goto</span> abort_list;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         parked_call_string = <a class="code" href="../../d0/d39/parking__manager_8c.html#a3502a9b7c2079348bd49a03ad445fb2d">manager_build_parked_call_string</a>(payload);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         <span class="keywordflow">if</span> (!parked_call_string) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curuser, -1);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter_users);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curlot, -1);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">goto</span> abort_list;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;         total++;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: ParkedCall\r\n&quot;</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* The parked call string */</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* The action ID */</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(parked_call_string),</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            id_text);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curuser, -1);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter_users);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curlot, -1);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;abort_list:</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter_lots);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;ParkedCallsComplete&quot;</span>, total);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Total: %d\r\n&quot;</span>, total);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div><div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="structparking__lot_html_aea5a92769425a243bac168470b7f6a2f"><div class="ttname"><a href="../../d4/de7/structparking__lot.html#aea5a92769425a243bac168470b7f6a2f">parking_lot::parked_users</a></div><div class="ttdeci">struct ao2_container * parked_users</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00095">res_parking.h:95</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a></div><div class="ttdoc">A parked call message payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00059">parking.h:59</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__parking_8h_html_a58b53672752610716a514d4da2f89bec"><div class="ttname"><a href="../../d3/d38/res__parking_8h.html#a58b53672752610716a514d4da2f89bec">get_parking_lot_container</a></div><div class="ttdeci">struct ao2_container * get_parking_lot_container(void)</div><div class="ttdoc">Get a pointer to the parking lot container for purposes such as iteration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d45/res__parking_8c_source.html#l00596">res_parking.c:596</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structparked__user_html"><div class="ttname"><a href="../../dd/d7e/structparked__user.html">parked_user</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00103">res_parking.h:103</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a3502a9b7c2079348bd49a03ad445fb2d"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a3502a9b7c2079348bd49a03ad445fb2d">manager_build_parked_call_string</a></div><div class="ttdeci">static struct ast_str * manager_build_parked_call_string(const struct ast_parked_call_payload *payload)</div><div class="ttdoc">Builds a manager string based on the contents of a parked call payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00215">parking_manager.c:215</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a5016e0fa17fee9590d4e40707afed401"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a5016e0fa17fee9590d4e40707afed401">parked_call_payload_from_parked_user</a></div><div class="ttdeci">static struct ast_parked_call_payload * parked_call_payload_from_parked_user(struct parked_user *pu, enum ast_parked_call_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00192">parking_manager.c:192</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structparking__lot_html"><div class="ttname"><a href="../../d4/de7/structparking__lot.html">parking_lot</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00092">res_parking.h:92</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7">PARKED_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00047">parking.h:47</a></div></div>
<div class="ttc" id="res__adsi_8c_html_ac7af894858cf396a219d632f40afdc8d"><div class="ttname"><a href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a></div><div class="ttdeci">static int total</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d27/res__adsi_8c_source.html#l00968">res_adsi.c:968</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab65b7fae0211302e012fc8332ab4de03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab65b7fae0211302e012fc8332ab4de03">&#9670;&nbsp;</a></span>manager_parking_status_single_lot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void manager_parking_status_single_lot </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d8a/structmansession.html">mansession</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d8/d9e/structmessage.html">message</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id_text</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>lot_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00259">259</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00534">ao2_iterator_destroy()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00485">ao2_iterator_init()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01933">ao2_iterator_next</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03080">astman_append()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03159">astman_send_error()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03245">astman_send_list_complete_end()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03237">astman_send_list_complete_start()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03201">astman_send_listack()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00215">manager_build_parked_call_string()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00047">PARKED_CALL</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00192">parked_call_payload_from_parked_user()</a>, <a class="el" href="../../d7/d45/res__parking_8c_source.html#l00601">parking_lot_find_by_name()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../dd/d27/res__adsi_8c_source.html#l00968">total</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00372">manager_parking_status()</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/de7/structparking__lot.html">parking_lot</a> *, curlot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d7e/structparked__user.html">parked_user</a> *curuser;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter_users;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a> = 0;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   curlot = <a class="code" href="../../d3/d38/res__parking_8h.html#a229bf0f37506c31420fe0b6a9d8594b6">parking_lot_find_by_name</a>(lot_name);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keywordflow">if</span> (!curlot) {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Requested parking lot could not be found.&quot;</span>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Parked calls will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   iter_users = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(curlot-&gt;parked_users, 0);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keywordflow">while</span> ((curuser = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter_users))) {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, parked_call_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      payload = <a class="code" href="../../d0/d39/parking__manager_8c.html#a5016e0fa17fee9590d4e40707afed401">parked_call_payload_from_parked_user</a>(curuser, <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7">PARKED_CALL</a>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curuser, -1);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      parked_call_string = <a class="code" href="../../d0/d39/parking__manager_8c.html#a3502a9b7c2079348bd49a03ad445fb2d">manager_build_parked_call_string</a>(payload);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> (!parked_call_string) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curuser, -1);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      total++;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: ParkedCall\r\n&quot;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* The parked call string */</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span> <span class="comment">/* The action ID */</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;         <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(parked_call_string),</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         id_text);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(curuser, -1);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter_users);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;ParkedCallsComplete&quot;</span>, total);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Total: %d\r\n&quot;</span>, total);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div><div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a></div><div class="ttdoc">A parked call message payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00059">parking.h:59</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structparked__user_html"><div class="ttname"><a href="../../dd/d7e/structparked__user.html">parked_user</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00103">res_parking.h:103</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a3502a9b7c2079348bd49a03ad445fb2d"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a3502a9b7c2079348bd49a03ad445fb2d">manager_build_parked_call_string</a></div><div class="ttdeci">static struct ast_str * manager_build_parked_call_string(const struct ast_parked_call_payload *payload)</div><div class="ttdoc">Builds a manager string based on the contents of a parked call payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00215">parking_manager.c:215</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a5016e0fa17fee9590d4e40707afed401"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a5016e0fa17fee9590d4e40707afed401">parked_call_payload_from_parked_user</a></div><div class="ttdeci">static struct ast_parked_call_payload * parked_call_payload_from_parked_user(struct parked_user *pu, enum ast_parked_call_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00192">parking_manager.c:192</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structparking__lot_html"><div class="ttname"><a href="../../d4/de7/structparking__lot.html">parking_lot</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00092">res_parking.h:92</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7">PARKED_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00047">parking.h:47</a></div></div>
<div class="ttc" id="res__adsi_8c_html_ac7af894858cf396a219d632f40afdc8d"><div class="ttname"><a href="../../dd/d27/res__adsi_8c.html#ac7af894858cf396a219d632f40afdc8d">total</a></div><div class="ttdeci">static int total</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d27/res__adsi_8c_source.html#l00968">res_adsi.c:968</a></div></div>
<div class="ttc" id="res__parking_8h_html_a229bf0f37506c31420fe0b6a9d8594b6"><div class="ttname"><a href="../../d3/d38/res__parking_8h.html#a229bf0f37506c31420fe0b6a9d8594b6">parking_lot_find_by_name</a></div><div class="ttdeci">struct parking_lot * parking_lot_find_by_name(const char *lot_name)</div><div class="ttdoc">Find a parking lot based on its name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d45/res__parking_8c_source.html#l00601">res_parking.c:601</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac28e6c803a8102bef591b0cb0f6c1ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac28e6c803a8102bef591b0cb0f6c1ed8">&#9670;&nbsp;</a></span>parked_call_message_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parked_call_message_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *&#160;</td>
          <td class="paramname"><em>parked_call</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00639">639</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../db/d45/manager_8h_source.html#l00072">EVENT_FLAG_CALL</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00062">ast_parked_call_payload::event_type</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00215">manager_build_parked_call_string()</a>, <a class="el" href="../../db/d45/manager_8h_source.html#l00248">manager_event</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00047">PARKED_CALL</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00051">PARKED_CALL_FAILED</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00049">PARKED_CALL_GIVEUP</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00052">PARKED_CALL_SWAP</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00048">PARKED_CALL_TIMEOUT</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00050">PARKED_CALL_UNPARKED</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00677">parking_event_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;{</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="keywordtype">char</span> *event_type = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, parked_call_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <span class="keywordflow">switch</span> (parked_call-&gt;<a class="code" href="../../d0/d47/structast__parked__call__payload.html#ac9e5e351c10879edca8ea8210075f082">event_type</a>) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7">PARKED_CALL</a>:</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      event_type = <span class="stringliteral">&quot;ParkedCall&quot;</span>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a73e7e3e65e01e3ea4c1116e8efa5cc23">PARKED_CALL_TIMEOUT</a>:</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      event_type = <span class="stringliteral">&quot;ParkedCallTimeOut&quot;</span>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485ae8ffa02d5be3b01de416d7a9a1a80891">PARKED_CALL_GIVEUP</a>:</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      event_type = <span class="stringliteral">&quot;ParkedCallGiveUp&quot;</span>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485aa58446461d1547ee27a5a7051a4b07f4">PARKED_CALL_UNPARKED</a>:</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      event_type = <span class="stringliteral">&quot;UnParkedCall&quot;</span>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485afdf76235a3d229795bcb332c52e0be2f">PARKED_CALL_SWAP</a>:</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      event_type = <span class="stringliteral">&quot;ParkedCallSwap&quot;</span>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485acadf914c610b448ad9bca355439e28fa">PARKED_CALL_FAILED</a>:</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="comment">/* PARKED_CALL_FAILED doesn&#39;t currently get a message and is used exclusively for bridging */</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   parked_call_string = <a class="code" href="../../d0/d39/parking__manager_8c.html#a3502a9b7c2079348bd49a03ad445fb2d">manager_build_parked_call_string</a>(parked_call);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   <span class="keywordflow">if</span> (!parked_call_string) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to issue an AMI event of &#39;%s&#39; in response to a stasis message.\n&quot;</span>, event_type);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a>(<a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, event_type,</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span>,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(parked_call_string)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      );</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485a73e7e3e65e01e3ea4c1116e8efa5cc23"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a73e7e3e65e01e3ea4c1116e8efa5cc23">PARKED_CALL_TIMEOUT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00048">parking.h:48</a></div></div>
<div class="ttc" id="manager_8h_html_ab5db3cc603d7e798d61cb4cd94fbb4e2"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a></div><div class="ttdeci">#define EVENT_FLAG_CALL</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00072">manager.h:72</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485afdf76235a3d229795bcb332c52e0be2f"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485afdf76235a3d229795bcb332c52e0be2f">PARKED_CALL_SWAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00052">parking.h:52</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_ac9e5e351c10879edca8ea8210075f082"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#ac9e5e351c10879edca8ea8210075f082">ast_parked_call_payload::event_type</a></div><div class="ttdeci">enum ast_parked_call_event_type event_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00062">parking.h:62</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485ae8ffa02d5be3b01de416d7a9a1a80891"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485ae8ffa02d5be3b01de416d7a9a1a80891">PARKED_CALL_GIVEUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00049">parking.h:49</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a3502a9b7c2079348bd49a03ad445fb2d"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a3502a9b7c2079348bd49a03ad445fb2d">manager_build_parked_call_string</a></div><div class="ttdeci">static struct ast_str * manager_build_parked_call_string(const struct ast_parked_call_payload *payload)</div><div class="ttdoc">Builds a manager string based on the contents of a parked call payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00215">parking_manager.c:215</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485acadf914c610b448ad9bca355439e28fa"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485acadf914c610b448ad9bca355439e28fa">PARKED_CALL_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00051">parking.h:51</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485a56203dcf9e281e78d8fde96105f83ea7">PARKED_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00047">parking.h:47</a></div></div>
<div class="ttc" id="manager_8h_html_a1ef0ee0044dbbeb4c3a5abc6c046b208"><div class="ttname"><a href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a></div><div class="ttdeci">#define manager_event(category, event, contents,...)</div><div class="ttdoc">External routines may send asterisk manager events this way. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00248">manager.h:248</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485aa58446461d1547ee27a5a7051a4b07f4"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485aa58446461d1547ee27a5a7051a4b07f4">PARKED_CALL_UNPARKED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00050">parking.h:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57b0e39c17bda9dd3eb6776978475393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57b0e39c17bda9dd3eb6776978475393">&#9670;&nbsp;</a></span>parked_call_payload_from_failure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a>* parked_call_payload_from_failure </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00178">178</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00451">ast_channel_snapshot_create()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00082">ast_parked_call_payload_create()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00051">PARKED_CALL_FAILED</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00595">publish_parked_call_failure()</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, parkee_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   parkee_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a>(chan);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="keywordflow">if</span> (!parkee_snapshot) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d33/parking_8h.html#af0f0053a532a991e5963797d8a66f1c0">ast_parked_call_payload_create</a>(<a class="code" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485acadf914c610b448ad9bca355439e28fa">PARKED_CALL_FAILED</a>, parkee_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0, 0);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div><div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="parking_8h_html_af0f0053a532a991e5963797d8a66f1c0"><div class="ttname"><a href="../../d2/d33/parking_8h.html#af0f0053a532a991e5963797d8a66f1c0">ast_parked_call_payload_create</a></div><div class="ttdeci">struct ast_parked_call_payload * ast_parked_call_payload_create(enum ast_parked_call_event_type event_type, struct ast_channel_snapshot *parkee_snapshot, const char *parker_dial_string, struct ast_channel_snapshot *retriever_snapshot, const char *parkinglot, unsigned int parkingspace, unsigned long int timeout, unsigned long int duration)</div><div class="ttdoc">Constructor for parked_call_payload objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2a/parking_8c_source.html#l00082">parking.c:82</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a></div><div class="ttdoc">Structure representing a snapshot of channel state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00145">stasis_channels.h:145</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7f4919ce97dcdee0a98979ca4de29242"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_create(struct ast_channel *chan)</div><div class="ttdoc">Generate a snapshot of the channel state. This is an ao2 object, so ao2_cleanup() to deallocate...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00451">stasis_channels.c:451</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="parking_8h_html_ad7f2cff41c0b5c4e0aa1e2de3ee71485acadf914c610b448ad9bca355439e28fa"><div class="ttname"><a href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485acadf914c610b448ad9bca355439e28fa">PARKED_CALL_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00051">parking.h:51</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5016e0fa17fee9590d4e40707afed401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5016e0fa17fee9590d4e40707afed401">&#9670;&nbsp;</a></span>parked_call_payload_from_parked_user()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a>* parked_call_payload_from_parked_user </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d7e/structparked__user.html">parked_user</a> *&#160;</td>
          <td class="paramname"><em>pu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485">ast_parked_call_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00192">192</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00451">ast_channel_snapshot_create()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00082">ast_parked_call_payload_create()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00104">parked_user::chan</a>, <a class="el" href="../../d2/d33/parking_8h_source.html#l00064">ast_parked_call_payload::duration</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00111">parked_user::lot</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00100">parking_lot::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00109">parked_user::parker_dial_string</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00107">parked_user::parking_space</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00105">parked_user::retriever</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00106">parked_user::start</a>, <a class="el" href="../../d3/d38/res__parking_8h_source.html#l00110">parked_user::time_limit</a>, and <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00086">timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00309">manager_parking_status_all_lots()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00259">manager_parking_status_single_lot()</a>, and <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00617">publish_parked_call()</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, parkee_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">int</span> duration;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *lot_name = pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#aab047b714dfa66df6e8b937df22b0a6c">lot</a>-&gt;<a class="code" href="../../d4/de7/structparking__lot.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   parkee_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a>(pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="keywordflow">if</span> (!parkee_snapshot) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   timeout = pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#ad80305b5e16da9c2675d5f057bd69386">start</a>.tv_sec + (long) pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#a5cab8de37f0062c1a7c1511409e23319">time_limit</a> - now.tv_sec;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   duration = now.tv_sec - pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#ad80305b5e16da9c2675d5f057bd69386">start</a>.tv_sec;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d33/parking_8h.html#af0f0053a532a991e5963797d8a66f1c0">ast_parked_call_payload_create</a>(event_type, parkee_snapshot, pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#a05dc49917dafb37112f18d6e5d021a98">parker_dial_string</a>, pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#ab202e6af66537b13bb4af19a9c32596f">retriever</a>, lot_name, pu-&gt;<a class="code" href="../../dd/d7e/structparked__user.html#a7ae57549bf83cfe4727db8951ca8b74b">parking_space</a>, timeout, duration);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="parking_8h_html_af0f0053a532a991e5963797d8a66f1c0"><div class="ttname"><a href="../../d2/d33/parking_8h.html#af0f0053a532a991e5963797d8a66f1c0">ast_parked_call_payload_create</a></div><div class="ttdeci">struct ast_parked_call_payload * ast_parked_call_payload_create(enum ast_parked_call_event_type event_type, struct ast_channel_snapshot *parkee_snapshot, const char *parker_dial_string, struct ast_channel_snapshot *retriever_snapshot, const char *parkinglot, unsigned int parkingspace, unsigned long int timeout, unsigned long int duration)</div><div class="ttdoc">Constructor for parked_call_payload objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2a/parking_8c_source.html#l00082">parking.c:82</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a></div><div class="ttdoc">Structure representing a snapshot of channel state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00145">stasis_channels.h:145</a></div></div>
<div class="ttc" id="structparked__user_html_a5cab8de37f0062c1a7c1511409e23319"><div class="ttname"><a href="../../dd/d7e/structparked__user.html#a5cab8de37f0062c1a7c1511409e23319">parked_user::time_limit</a></div><div class="ttdeci">unsigned int time_limit</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00110">res_parking.h:110</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structparked__user_html_aab047b714dfa66df6e8b937df22b0a6c"><div class="ttname"><a href="../../dd/d7e/structparked__user.html#aab047b714dfa66df6e8b937df22b0a6c">parked_user::lot</a></div><div class="ttdeci">struct parking_lot * lot</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00111">res_parking.h:111</a></div></div>
<div class="ttc" id="structparked__user_html_ad80305b5e16da9c2675d5f057bd69386"><div class="ttname"><a href="../../dd/d7e/structparked__user.html#ad80305b5e16da9c2675d5f057bd69386">parked_user::start</a></div><div class="ttdeci">struct timeval start</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00106">res_parking.h:106</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7f4919ce97dcdee0a98979ca4de29242"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_create(struct ast_channel *chan)</div><div class="ttdoc">Generate a snapshot of the channel state. This is an ao2 object, so ao2_cleanup() to deallocate...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00451">stasis_channels.c:451</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structparked__user_html_a05dc49917dafb37112f18d6e5d021a98"><div class="ttname"><a href="../../dd/d7e/structparked__user.html#a05dc49917dafb37112f18d6e5d021a98">parked_user::parker_dial_string</a></div><div class="ttdeci">char * parker_dial_string</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00109">res_parking.h:109</a></div></div>
<div class="ttc" id="structparked__user_html_a7ae57549bf83cfe4727db8951ca8b74b"><div class="ttname"><a href="../../dd/d7e/structparked__user.html#a7ae57549bf83cfe4727db8951ca8b74b">parked_user::parking_space</a></div><div class="ttdeci">int parking_space</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00107">res_parking.h:107</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="structparking__lot_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../d4/de7/structparking__lot.html#ace9168767fc3707cf5f0a7d049682ba3">parking_lot::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00100">res_parking.h:100</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structparked__user_html_ab202e6af66537b13bb4af19a9c32596f"><div class="ttname"><a href="../../dd/d7e/structparked__user.html#ab202e6af66537b13bb4af19a9c32596f">parked_user::retriever</a></div><div class="ttdeci">struct ast_channel_snapshot * retriever</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00105">res_parking.h:105</a></div></div>
<div class="ttc" id="structparked__user_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../dd/d7e/structparked__user.html#a84d1435c5b8d387806714ea7079304b7">parked_user::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d38/res__parking_8h_source.html#l00104">res_parking.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb18054457e868f6deb00a67d7aecc2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb18054457e868f6deb00a67d7aecc2f">&#9670;&nbsp;</a></span>parking_event_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parking_event_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00677">677</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00639">parked_call_message_response()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00685">parking_manager_enable_stasis()</a>.</p>
<div class="fragment"><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;{</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(message) == <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a>()) {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *parked_call_message = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <a class="code" href="../../d0/d39/parking__manager_8c.html#ac28e6c803a8102bef591b0cb0f6c1ed8">parked_call_message_response</a>(parked_call_message);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   }</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div><div class="ttc" id="group__StasisTopicsAndMessages_html_ga00e84a145ef736ce4134fee75e530113"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a></div><div class="ttdeci">struct stasis_message_type * ast_parked_call_type(void)</div><div class="ttdoc">accessor for the parked call stasis message type </div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a></div><div class="ttdoc">A parked call message payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00059">parking.h:59</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="parking__manager_8c_html_ac28e6c803a8102bef591b0cb0f6c1ed8"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#ac28e6c803a8102bef591b0cb0f6c1ed8">parked_call_message_response</a></div><div class="ttdeci">static void parked_call_message_response(struct ast_parked_call_payload *parked_call)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00639">parking_manager.c:639</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab468a120043b7eb0dcc7531f95c3e095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab468a120043b7eb0dcc7531f95c3e095">&#9670;&nbsp;</a></span>parking_manager_disable_stasis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parking_manager_disable_stasis </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00705">705</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">stasis_unsubscribe_and_join()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00710">unload_parking_manager()</a>.</p>
<div class="fragment"><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;{</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <a class="code" href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(<a class="code" href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a>);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a65b6e7c22f424324508be5258afb63cd"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a></div><div class="ttdeci">static struct stasis_subscription * parking_sub</div><div class="ttdoc">subscription to the parking lot topic </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00176">parking_manager.c:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1298379c9c74696c24029e1f6b7fa76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1298379c9c74696c24029e1f6b7fa76">&#9670;&nbsp;</a></span>parking_manager_enable_stasis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parking_manager_enable_stasis </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00685">685</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type()</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00067">ast_parking_topic()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00677">parking_event_cb()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00652">stasis_subscribe</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00300">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00694">load_parking_manager()</a>.</p>
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;{</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a>) {</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <a class="code" href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a> = <a class="code" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab4e08da228493c3f9bfc6a2aed507cb4">ast_parking_topic</a>(), <a class="code" href="../../d0/d39/parking__manager_8c.html#aeb18054457e868f6deb00a67d7aecc2f">parking_event_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(<a class="code" href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a>());</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(<a class="code" href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;}</div><div class="ttc" id="group__StasisTopicsAndMessages_html_ga00e84a145ef736ce4134fee75e530113"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a></div><div class="ttdeci">struct stasis_message_type * ast_parked_call_type(void)</div><div class="ttdoc">accessor for the parked call stasis message type </div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8h_html_ae3fe7fe099389094244002113814ec23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a></div><div class="ttdeci">#define stasis_subscribe(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00652">stasis.h:652</a></div></div>
<div class="ttc" id="parking__manager_8c_html_aeb18054457e868f6deb00a67d7aecc2f"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#aeb18054457e868f6deb00a67d7aecc2f">parking_event_cb</a></div><div class="ttdeci">static void parking_event_cb(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00677">parking_manager.c:677</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a65b6e7c22f424324508be5258afb63cd"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a65b6e7c22f424324508be5258afb63cd">parking_sub</a></div><div class="ttdeci">static struct stasis_subscription * parking_sub</div><div class="ttdoc">subscription to the parking lot topic </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00176">parking_manager.c:176</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab4e08da228493c3f9bfc6a2aed507cb4"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab4e08da228493c3f9bfc6a2aed507cb4">ast_parking_topic</a></div><div class="ttdeci">struct stasis_topic * ast_parking_topic(void)</div><div class="ttdoc">accessor for the parking stasis topic </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2a/parking_8c_source.html#l00067">parking.c:67</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaecb2e8b6ae6629620589e258c7053bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaecb2e8b6ae6629620589e258c7053bf">&#9670;&nbsp;</a></span>publish_parked_call()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void publish_parked_call </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d7e/structparked__user.html">parked_user</a> *&#160;</td>
          <td class="paramname"><em>pu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d2/d33/parking_8h.html#ad7f2cff41c0b5c4e0aa1e2de3ee71485">ast_parked_call_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish a stasis parked call message for a given parked user. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pu</td><td>pointer to a <a class="el" href="../../dd/d7e/structparked__user.html">parked_user</a> that we are generating the message for </td></tr>
    <tr><td class="paramname">event_type</td><td>What parked call event type is provoking this message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00617">617</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type()</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00067">ast_parking_topic()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00192">parked_call_payload_from_parked_user()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dc5/parking__bridge_8c_source.html#l00342">bridge_parking_pull()</a>, and <a class="el" href="../../d9/dc5/parking__bridge_8c_source.html#l00206">bridge_parking_push()</a>.</p>
<div class="fragment"><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a>()) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   payload = <a class="code" href="../../d0/d39/parking__manager_8c.html#a5016e0fa17fee9590d4e40707afed401">parked_call_payload_from_parked_user</a>(pu, <a class="code" href="../../d0/d47/structast__parked__call__payload.html#ac9e5e351c10879edca8ea8210075f082">event_type</a>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a>(), payload);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab4e08da228493c3f9bfc6a2aed507cb4">ast_parking_topic</a>(), msg);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div><div class="ttc" id="group__StasisTopicsAndMessages_html_ga00e84a145ef736ce4134fee75e530113"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a></div><div class="ttdeci">struct stasis_message_type * ast_parked_call_type(void)</div><div class="ttdoc">accessor for the parked call stasis message type </div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a></div><div class="ttdoc">A parked call message payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00059">parking.h:59</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html_ac9e5e351c10879edca8ea8210075f082"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html#ac9e5e351c10879edca8ea8210075f082">ast_parked_call_payload::event_type</a></div><div class="ttdeci">enum ast_parked_call_event_type event_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00062">parking.h:62</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="parking__manager_8c_html_a5016e0fa17fee9590d4e40707afed401"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a5016e0fa17fee9590d4e40707afed401">parked_call_payload_from_parked_user</a></div><div class="ttdeci">static struct ast_parked_call_payload * parked_call_payload_from_parked_user(struct parked_user *pu, enum ast_parked_call_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00192">parking_manager.c:192</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab4e08da228493c3f9bfc6a2aed507cb4"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab4e08da228493c3f9bfc6a2aed507cb4">ast_parking_topic</a></div><div class="ttdeci">struct stasis_topic * ast_parking_topic(void)</div><div class="ttdoc">accessor for the parking stasis topic </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2a/parking_8c_source.html#l00067">parking.c:67</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af185e93906eea4f215d95c8ae4552dd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af185e93906eea4f215d95c8ae4552dd8">&#9670;&nbsp;</a></span>publish_parked_call_failure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void publish_parked_call_failure </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>parkee</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish a stasis parked call message for the channel indicating failure to park. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parkee</td><td>channel belonging to the failed parkee </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00595">595</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type()</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00067">ast_parking_topic()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00178">parked_call_payload_from_failure()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/dc5/parking__bridge_8c_source.html#l00206">bridge_parking_push()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00545">park_app_exec()</a>, and <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00434">parking_park_bridge_channel()</a>.</p>
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a>()) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   payload = <a class="code" href="../../d0/d39/parking__manager_8c.html#a57b0e39c17bda9dd3eb6776978475393">parked_call_payload_from_failure</a>(parkee);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a>(), payload);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab4e08da228493c3f9bfc6a2aed507cb4">ast_parking_topic</a>(), msg);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div><div class="ttc" id="parking__manager_8c_html_a57b0e39c17bda9dd3eb6776978475393"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#a57b0e39c17bda9dd3eb6776978475393">parked_call_payload_from_failure</a></div><div class="ttdeci">static struct ast_parked_call_payload * parked_call_payload_from_failure(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00178">parking_manager.c:178</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga00e84a145ef736ce4134fee75e530113"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga00e84a145ef736ce4134fee75e530113">ast_parked_call_type</a></div><div class="ttdeci">struct stasis_message_type * ast_parked_call_type(void)</div><div class="ttdoc">accessor for the parked call stasis message type </div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="structast__parked__call__payload_html"><div class="ttname"><a href="../../d0/d47/structast__parked__call__payload.html">ast_parked_call_payload</a></div><div class="ttdoc">A parked call message payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/parking_8h_source.html#l00059">parking.h:59</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab4e08da228493c3f9bfc6a2aed507cb4"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab4e08da228493c3f9bfc6a2aed507cb4">ast_parking_topic</a></div><div class="ttdeci">struct stasis_topic * ast_parking_topic(void)</div><div class="ttdoc">accessor for the parking stasis topic </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2a/parking_8c_source.html#l00067">parking.c:67</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6492a673c693917c90981ab183a24339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6492a673c693917c90981ab183a24339">&#9670;&nbsp;</a></span>unload_parking_manager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unload_parking_manager </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister manager actions and remove subscriptions for stasis events. </p>
<dl class="section since"><dt>Since</dt><dd>12.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00710">710</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d10/manager_8c_source.html#l07258">ast_manager_unregister()</a>, and <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00705">parking_manager_disable_stasis()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d45/res__parking_8c_source.html#l01190">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;{</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Parkinglots&quot;</span>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;ParkedCalls&quot;</span>);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Park&quot;</span>);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <a class="code" href="../../d0/d39/parking__manager_8c.html#ab468a120043b7eb0dcc7531f95c3e095">parking_manager_disable_stasis</a>();</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div><div class="ttc" id="group__Group__AMI_html_gafadf012f66a9fd7ecf985ec5b9dee101"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a></div><div class="ttdeci">int ast_manager_unregister(const char *action)</div><div class="ttdoc">Unregister a registered manager command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07258">manager.c:7258</a></div></div>
<div class="ttc" id="parking__manager_8c_html_ab468a120043b7eb0dcc7531f95c3e095"><div class="ttname"><a href="../../d0/d39/parking__manager_8c.html#ab468a120043b7eb0dcc7531f95c3e095">parking_manager_disable_stasis</a></div><div class="ttdeci">static void parking_manager_disable_stasis(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/parking__manager_8c_source.html#l00705">parking_manager.c:705</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a65b6e7c22f424324508be5258afb63cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65b6e7c22f424324508be5258afb63cd">&#9670;&nbsp;</a></span>parking_sub</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a>* parking_sub</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>subscription to the parking lot topic </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00176">176</a> of file <a class="el" href="../../d0/d39/parking__manager_8c_source.html">parking_manager.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:09 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
