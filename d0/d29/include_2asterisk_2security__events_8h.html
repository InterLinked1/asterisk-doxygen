<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: security_events.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_6d4b1cdb59e2db6ad82005b337288fef.html">asterisk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">include/asterisk/security_events.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Security Event Reporting API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../dd/d20/event_8h_source.html">asterisk/event.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/dc2/security__events__defs_8h_source.html">asterisk/security_events_defs.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for include/asterisk/security_events.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d11/include_2asterisk_2security__events_8h__incl.png" border="0" usemap="#security__events_8h" alt=""/></div>
<map name="security__events_8h" id="security__events_8h">
<area shape="rect" id="node2" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="307,87,431,114"/>
<area shape="rect" id="node4" href="../../d7/dc2/security__events__defs_8h.html" title="Security Event Reporting Data Structures. " alt="" coords="455,80,631,121"/>
<area shape="rect" id="node3" href="../../d6/d37/event__defs_8h.html" title="Generic event system. " alt="" coords="289,169,448,196"/>
<area shape="rect" id="node5" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="473,169,611,196"/>
<area shape="rect" id="node15" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="863,169,1010,196"/>
<area shape="rect" id="node16" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1069,244,1196,271"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d0/d56/include_2asterisk_2security__events_8h__dep__incl.png" border="0" usemap="#security__events_8hdep" alt=""/></div>
<map name="security__events_8hdep" id="security__events_8hdep">
<area shape="rect" id="node2" href="../../d5/dff/chan__iax2_8c.html" title="Implementation of Inter&#45;Asterisk eXchange Version 2 as specified in RFC 5456. " alt="" coords="361,80,459,107"/>
<area shape="rect" id="node3" href="../../d1/d94/sip_8h.html" title="chan_sip header file " alt="" coords="483,80,535,107"/>
<area shape="rect" id="node15" href="../../d5/d03/asterisk_8c.html" title="Top level source file for Asterisk &#45; the Open Source PBX. Implementation of PBX core functions and CL..." alt="" coords="559,80,642,107"/>
<area shape="rect" id="node16" href="../../d4/d10/manager_8c.html" title="The Asterisk Management Interface &#45; AMI. " alt="" coords="666,80,757,107"/>
<area shape="rect" id="node17" href="../../da/ddd/named__acl_8c.html" title="Named Access Control Lists. " alt="" coords="781,80,884,107"/>
<area shape="rect" id="node18" href="../../d8/d30/main_2security__events_8c.html" title="Security Event Reporting Helpers. " alt="" coords="909,80,1042,107"/>
<area shape="rect" id="node19" href="../../dc/df6/pjsip__configuration_8c.html" title="pjsip_configuration.c" alt="" coords="1066,80,1218,107"/>
<area shape="rect" id="node20" href="../../d2/d63/res_2res__pjsip_2security__events_8c.html" title="Generate security events in the PJSIP channel. " alt="" coords="1242,80,1375,107"/>
<area shape="rect" id="node21" href="../../d5/d5e/res__pjsip__acl_8c.html" title="res_pjsip_acl.c" alt="" coords="1399,80,1514,107"/>
<area shape="rect" id="node22" href="../../d9/d21/res__rtp__asterisk_8c.html" title="Supports RTP and RTCP with Symmetric RTP support for NAT traversal. " alt="" coords="1539,80,1673,107"/>
<area shape="rect" id="node23" href="../../dd/d1e/res__security__log_8c.html" title="Security Event Logging. " alt="" coords="1698,80,1834,107"/>
<area shape="rect" id="node24" href="../../d3/d70/test__security__events_8c.html" title="Test security event generation. " alt="" coords="1858,80,2023,107"/>
<area shape="rect" id="node4" href="../../d5/dfe/chan__sip_8c.html" title="Implementation of Session Initiation Protocol. " alt="" coords="295,229,384,256"/>
<area shape="rect" id="node5" href="../../d5/d87/globals_8h.html" title="sip global declaration header file " alt="" coords="25,155,104,181"/>
<area shape="rect" id="node6" href="../../d8/d06/sip_2dialplan__functions_8c.html" title="sip channel dialplan functions and unit tests " alt="" coords="37,229,183,256"/>
<area shape="rect" id="node7" href="../../d1/d2b/config__parser_8h.html" title="sip.conf parser header file " alt="" coords="449,155,568,181"/>
<area shape="rect" id="node8" href="../../d8/d9c/config__parser_8c.html" title="sip config parsing functions and unit tests " alt="" coords="475,229,593,256"/>
<area shape="rect" id="node9" href="../../d1/dc9/dialog_8h.html" title="sip dialog management header file " alt="" coords="129,155,201,181"/>
<area shape="rect" id="node10" href="../../d4/dd3/sip_2include_2dialplan__functions_8h.html" title="SIP dialplan functions header file. " alt="" coords="225,155,373,181"/>
<area shape="rect" id="node11" href="../../d2/d1d/channels_2sip_2include_2security__events_8h.html" title="Generate security events in the SIP channel. " alt="" coords="644,155,779,181"/>
<area shape="rect" id="node12" href="../../d4/dea/channels_2sip_2security__events_8c.html" title="Generate security events in the SIP channel. " alt="" coords="697,229,830,256"/>
<area shape="rect" id="node13" href="../../d5/d85/reqresp__parser_8c.html" title="sip request parsing functions and unit tests " alt="" coords="855,155,984,181"/>
<area shape="rect" id="node14" href="../../d1/dba/channels_2sip_2utils_8c.html" title="Utility functions for chan_sip. " alt="" coords="1009,155,1067,181"/>
</map>
</div>
</div>
<p><a href="../../d0/d29/include_2asterisk_2security__events_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab3449f999d03b45fc61e5f59f3cb40cb"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type)</td></tr>
<tr class="memdesc:ab3449f999d03b45fc61e5f59f3cb40cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the name of a security event sub-type.  <a href="#ab3449f999d03b45fc61e5f59f3cb40cb">More...</a><br /></td></tr>
<tr class="separator:ab3449f999d03b45fc61e5f59f3cb40cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bea01160811d84a487584cd400f27c3"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a0bea01160811d84a487584cd400f27c3">ast_security_event_get_optional_ies</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type)</td></tr>
<tr class="memdesc:a0bea01160811d84a487584cd400f27c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the list of optional IEs for a given security event sub-type.  <a href="#a0bea01160811d84a487584cd400f27c3">More...</a><br /></td></tr>
<tr class="separator:a0bea01160811d84a487584cd400f27c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd7b4c2b7d86562bf6204c636bed9d53"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#afd7b4c2b7d86562bf6204c636bed9d53">ast_security_event_get_required_ies</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> event_type)</td></tr>
<tr class="memdesc:afd7b4c2b7d86562bf6204c636bed9d53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the list of required IEs for a given security event sub-type.  <a href="#afd7b4c2b7d86562bf6204c636bed9d53">More...</a><br /></td></tr>
<tr class="separator:afd7b4c2b7d86562bf6204c636bed9d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae13dc3d123710d7519588d54c51f8170"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a> (const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *sec)</td></tr>
<tr class="memdesc:ae13dc3d123710d7519588d54c51f8170"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report a security event.  <a href="#ae13dc3d123710d7519588d54c51f8170">More...</a><br /></td></tr>
<tr class="separator:ae13dc3d123710d7519588d54c51f8170"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a947bbf6fbc82e52e2a5f9231dcd786d9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a947bbf6fbc82e52e2a5f9231dcd786d9">ast_security_event_severity_get_name</a> (const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0">ast_security_event_severity</a> <a class="el" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a>)</td></tr>
<tr class="memdesc:a947bbf6fbc82e52e2a5f9231dcd786d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the name of a security event severity.  <a href="#a947bbf6fbc82e52e2a5f9231dcd786d9">More...</a><br /></td></tr>
<tr class="separator:a947bbf6fbc82e52e2a5f9231dcd786d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d718027e6e4abe11dcfe17bd267377"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a88d718027e6e4abe11dcfe17bd267377">ast_security_event_type</a> (void)</td></tr>
<tr class="memdesc:a88d718027e6e4abe11dcfe17bd267377"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> for security events.  <a href="#a88d718027e6e4abe11dcfe17bd267377">More...</a><br /></td></tr>
<tr class="separator:a88d718027e6e4abe11dcfe17bd267377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bfccbad0896b673d8eb936aa3c2caeb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a2bfccbad0896b673d8eb936aa3c2caeb">ast_security_stasis_init</a> (void)</td></tr>
<tr class="memdesc:a2bfccbad0896b673d8eb936aa3c2caeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes stasis topic/event types for <a class="el" href="../../d8/d30/main_2security__events_8c.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a> and <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a88d718027e6e4abe11dcfe17bd267377">ast_security_event_type</a>  <a href="#a2bfccbad0896b673d8eb936aa3c2caeb">More...</a><br /></td></tr>
<tr class="separator:a2bfccbad0896b673d8eb936aa3c2caeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db46f92449a8f63b954d776ebead63a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a> (void)</td></tr>
<tr class="memdesc:a0db46f92449a8f63b954d776ebead63a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> which publishes messages for security related issues.  <a href="#a0db46f92449a8f63b954d776ebead63a">More...</a><br /></td></tr>
<tr class="separator:a0db46f92449a8f63b954d776ebead63a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Security Event Reporting API. </p>
<dl class="section author"><dt>Author</dt><dd>Russell Bryant <a href="#" onclick="location.href='mai'+'lto:'+'rus'+'se'+'ll@'+'di'+'giu'+'m.'+'com'; return false;">russe<span style="display: none;">.nosp@m.</span>ll@d<span style="display: none;">.nosp@m.</span>igium<span style="display: none;">.nosp@m.</span>.com</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h_source.html">include/asterisk/security_events.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab3449f999d03b45fc61e5f59f3cb40cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3449f999d03b45fc61e5f59f3cb40cb">&#9670;&nbsp;</a></span>ast_security_event_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_security_event_get_name </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the name of a security event sub-type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_type</td><td>security event sub-type</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if event_type is invalid </td></tr>
    <tr><td class="paramname">non-NULL</td><td>the name of the security event type</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">895</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00885">check_event_type()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00942">add_json_object()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01171">ast_security_event_report()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00644">gen_events()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00090">security_event_stasis_cb()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;{</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a>(event_type)) {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[event_type].name;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a5ba1021cb8a3d9192cc1c43bf3cad5b7"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a></div><div class="ttdeci">static int check_event_type(const enum ast_security_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00885">main/security_events.c:885</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bea01160811d84a487584cd400f27c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bea01160811d84a487584cd400f27c3">&#9670;&nbsp;</a></span>ast_security_event_get_optional_ies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a>* ast_security_event_get_optional_ies </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the list of optional IEs for a given security event sub-type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_type</td><td>security event sub-type</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>invalid event_type </td></tr>
    <tr><td class="paramname">non-NULL</td><td>An array terminated with the value AST_EVENT_IE_END</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00914">914</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00885">check_event_type()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00090">security_event_stasis_cb()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;{</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a>(event_type)) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[event_type].optional_ies;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a5ba1021cb8a3d9192cc1c43bf3cad5b7"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a></div><div class="ttdeci">static int check_event_type(const enum ast_security_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00885">main/security_events.c:885</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd7b4c2b7d86562bf6204c636bed9d53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd7b4c2b7d86562bf6204c636bed9d53">&#9670;&nbsp;</a></span>ast_security_event_get_required_ies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d4/d1e/structast__security__event__ie__type.html">ast_security_event_ie_type</a>* ast_security_event_get_required_ies </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>&#160;</td>
          <td class="paramname"><em>event_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the list of required IEs for a given security event sub-type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">event_type</td><td>security event sub-type</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>invalid event_type </td></tr>
    <tr><td class="paramname">non-NULL</td><td>An array terminated with the value AST_EVENT_IE_END</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00904">904</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00885">check_event_type()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00090">security_event_stasis_cb()</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00420">security_event_to_ami_blob()</a>.</p>
<div class="fragment"><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;{</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a>(event_type)) {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   }</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[event_type].required_ies;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a5ba1021cb8a3d9192cc1c43bf3cad5b7"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a5ba1021cb8a3d9192cc1c43bf3cad5b7">check_event_type</a></div><div class="ttdeci">static int check_event_type(const enum ast_security_event_type event_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00885">main/security_events.c:885</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae13dc3d123710d7519588d54c51f8170"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae13dc3d123710d7519588d54c51f8170">&#9670;&nbsp;</a></span>ast_security_event_report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_security_event_report </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../dd/d40/structast__security__event__common.html">ast_security_event_common</a> *&#160;</td>
          <td class="paramname"><em>sec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Report a security event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sec</td><td>security event data. Callers of this function should never declare an instance of <a class="el" href="../../dd/d40/structast__security__event__common.html" title="Common structure elements. ">ast_security_event_common</a> directly. The argument should be an instance of a specific security event descriptor which has <a class="el" href="../../dd/d40/structast__security__event__common.html" title="Common structure elements. ">ast_security_event_common</a> at the very beginning.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">non-zero</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01171">1171</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00895">ast_security_event_get_name()</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00121">AST_SECURITY_EVENT_NUM_TYPES</a>, <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00158">ast_security_event_common::event_type</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>, and <a class="el" href="../../d7/dc2/security__events__defs_8h_source.html#l00160">ast_security_event_common::version</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00197">ast_sip_report_auth_challenge_sent()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00130">ast_sip_report_auth_failed_challenge_response()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00168">ast_sip_report_auth_success()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00102">ast_sip_report_failed_acl()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00075">ast_sip_report_invalid_endpoint()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00259">ast_sip_report_mem_limit()</a>, <a class="el" href="../../d2/d63/res_2res__pjsip_2security__events_8c_source.html#l00230">ast_sip_report_req_no_support()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00333">evt_gen_auth_method_not_allowed()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00491">evt_gen_chal_resp_failed()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00570">evt_gen_chal_sent()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00074">evt_gen_failed_acl()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00112">evt_gen_inval_acct_id()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00531">evt_gen_inval_password()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00607">evt_gen_inval_transport()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00220">evt_gen_load_avg()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00184">evt_gen_mem_limit()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00371">evt_gen_req_bad_format()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00256">evt_gen_req_no_support()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00294">evt_gen_req_not_allowed()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00148">evt_gen_session_limit()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00410">evt_gen_successful_auth()</a>, <a class="el" href="../../d3/d70/test__security__events_8c_source.html#l00446">evt_gen_unexpected_addr()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03360">report_auth_success()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03310">report_failed_acl()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03443">report_failed_challenge_response()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03335">report_inval_password()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03285">report_invalid_user()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03414">report_req_bad_format()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03385">report_req_not_allowed()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03473">report_session_limit()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00123">sip_report_auth_success()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00210">sip_report_chal_sent()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00068">sip_report_failed_acl()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00174">sip_report_failed_challenge_response()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00094">sip_report_inval_password()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00244">sip_report_inval_transport()</a>, <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00043">sip_report_invalid_peer()</a>, and <a class="el" href="../../d4/dea/channels_2sip_2security__events_8c_source.html#l00149">sip_report_session_limit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;{</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> &gt;= <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a>) {</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid security event type\n&quot;</span>);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>].name) {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Security event type %u not handled\n&quot;</span>,</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;   }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;   <span class="keywordflow">if</span> (sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#acd99bb05ca015e7d74448acb1deba7ca">version</a> != <a class="code" href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a>[sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>].version) {</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Security event %u version mismatch\n&quot;</span>,</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;   }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#af34b009cd52c662e28242426ec40a5da">handle_security_event</a>(sec)) {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to issue security event of type %s.\n&quot;</span>,</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <a class="code" href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a>(sec-&gt;<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a>));</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   }</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;}</div><div class="ttc" id="structast__security__event__common_html_ab6aa0eb589925a75d104087ce946a0ad"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">ast_security_event_common::event_type</a></div><div class="ttdeci">enum ast_security_event_type event_type</div><div class="ttdoc">The security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00158">security_events_defs.h:158</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a63a523f56955f20e85d90620dee621ca"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a63a523f56955f20e85d90620dee621ca">sec_events</a></div><div class="ttdeci">static const struct @418 sec_events[AST_SECURITY_EVENT_NUM_TYPES]</div></div>
<div class="ttc" id="structast__security__event__common_html_acd99bb05ca015e7d74448acb1deba7ca"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#acd99bb05ca015e7d74448acb1deba7ca">ast_security_event_common::version</a></div><div class="ttdeci">uint32_t version</div><div class="ttdoc">security event version </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00160">security_events_defs.h:160</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_af34b009cd52c662e28242426ec40a5da"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#af34b009cd52c662e28242426ec40a5da">handle_security_event</a></div><div class="ttdeci">static int handle_security_event(const struct ast_security_event_common *sec)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l01118">main/security_events.c:1118</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca60c72c3856132cde97ddd031e0a4e183">AST_SECURITY_EVENT_NUM_TYPES</a></div><div class="ttdoc">This must stay at the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00121">security_events_defs.h:121</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_ab3449f999d03b45fc61e5f59f3cb40cb"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#ab3449f999d03b45fc61e5f59f3cb40cb">ast_security_event_get_name</a></div><div class="ttdeci">const char * ast_security_event_get_name(const enum ast_security_event_type event_type)</div><div class="ttdoc">Get the name of a security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00895">main/security_events.c:895</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a947bbf6fbc82e52e2a5f9231dcd786d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947bbf6fbc82e52e2a5f9231dcd786d9">&#9670;&nbsp;</a></span>ast_security_event_severity_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_security_event_severity_get_name </td>
          <td>(</td>
          <td class="paramtype">const enum <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac24fb5f02b28cd5ad484be72c47a57d0">ast_security_event_severity</a>&#160;</td>
          <td class="paramname"><em>severity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the name of a security event severity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">severity</td><td>security event severity</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if severity is invalid </td></tr>
    <tr><td class="paramname">non-NULL</td><td>the name of the security event severity</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>1.8 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00871">871</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01067">alloc_security_event_json_object()</a>.</p>
<div class="fragment"><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;{</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>); i++) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>[i].<a class="code" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a> == <a class="code" href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a>) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a>[i].str;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      }</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_adef9a4cc441833acc08cf8ac335d305a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#adef9a4cc441833acc08cf8ac335d305a">severity</a></div><div class="ttdeci">enum ast_security_event_severity severity</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00503">main/security_events.c:503</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a458cfcebc5862c24cebeadf96bd292f8"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a458cfcebc5862c24cebeadf96bd292f8">severities</a></div><div class="ttdeci">static const struct @419 severities[]</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a88d718027e6e4abe11dcfe17bd267377"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d718027e6e4abe11dcfe17bd267377">&#9670;&nbsp;</a></span>ast_security_event_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a>* <a class="el" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> for security events. </p>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on error </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2bfccbad0896b673d8eb936aa3c2caeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bfccbad0896b673d8eb936aa3c2caeb">&#9670;&nbsp;</a></span>ast_security_stasis_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_security_stasis_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes stasis topic/event types for <a class="el" href="../../d8/d30/main_2security__events_8c.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a> and <a class="el" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a88d718027e6e4abe11dcfe17bd267377">ast_security_event_type</a> </p>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00483">483</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00019">ast_register_cleanup()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00475">security_stasis_cleanup()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l01501">STASIS_MESSAGE_TYPE_INIT</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d03/asterisk_8c_source.html#l03947">asterisk_daemon()</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d8/d30/main_2security__events_8c.html#a90b87e2db58f030de91b0ab1beea6a23">security_stasis_cleanup</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a> = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(<span class="stringliteral">&quot;security:all&quot;</span>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a>) {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a>)) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div><div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372c"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372c">ast_security_event_type</a></div><div class="ttdeci">ast_security_event_type</div><div class="ttdoc">Security event types. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00040">security_events_defs.h:40</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a063b8a49db9862da0d66dd336416fc5a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a></div><div class="ttdeci">static struct stasis_topic * security_topic</div><div class="ttdoc">Security Topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00378">main/security_events.c:378</a></div></div>
<div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="main_2security__events_8c_html_a90b87e2db58f030de91b0ab1beea6a23"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a90b87e2db58f030de91b0ab1beea6a23">security_stasis_cleanup</a></div><div class="ttdeci">static void security_stasis_cleanup(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00475">main/security_events.c:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0db46f92449a8f63b954d776ebead63a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0db46f92449a8f63b954d776ebead63a">&#9670;&nbsp;</a></span>ast_security_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* ast_security_topic </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> which publishes messages for security related issues. </p>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00380">380</a> of file <a class="el" href="../../d8/d30/main_2security__events_8c_source.html">main/security_events.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00378">security_topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01470">acl_change_stasis_subscribe()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01973">ast_res_pjsip_initialize_configuration()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../d5/d5e/res__pjsip__acl_8c_source.html#l00297">load_module()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l09053">manager_subscriptions_init()</a>, <a class="el" href="../../da/ddd/named__acl_8c_source.html#l00371">publish_acl_change()</a>, and <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l09346">rtp_reload()</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="ttc" id="main_2security__events_8c_html_a063b8a49db9862da0d66dd336416fc5a"><div class="ttname"><a href="../../d8/d30/main_2security__events_8c.html#a063b8a49db9862da0d66dd336416fc5a">security_topic</a></div><div class="ttdeci">static struct stasis_topic * security_topic</div><div class="ttdoc">Security Topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00378">main/security_events.c:378</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:46 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
