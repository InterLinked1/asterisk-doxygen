<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: app_queue.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_9654b8d08f4bba4e84b362c5fd320bee.html">apps</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">app_queue.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/dfb/app__queue_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Asterisk -- An open source telephony toolkit.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (C) 1999 - 2018, Digium, Inc.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Mark Spencer &lt;markster@digium.com&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * See http://www.asterisk.org for more information about</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Asterisk project. Please do not directly contact</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * any of the maintainers of this project for assistance;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * the project provides a web site, mailing lists and IRC</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * channels for your use.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * This program is free software, distributed under the terms of</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * at the top of the source tree.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/*! \file</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * \brief True call queues with optional send URL on answer</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * \author Mark Spencer &lt;markster@digium.com&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * \par Development notes</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * \note 2004-11-25: Persistent Dynamic Members added by:</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> *             NetNation Communications (www.netnation.com)</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *             Kevin Lindsay &lt;kevinl@netnation.com&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> *             Each dynamic agent in each queue is now stored in the astdb.</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *             When asterisk is restarted, each agent will be automatically</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *             readded into their recorded queues. This feature can be</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> *             configured with the &#39;persistent_members=&lt;1|0&gt;&#39; setting in the</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> *             &#39;[general]&#39; category in queues.conf. The default is on.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * \note 2004-06-04: Priorities in queues added by inAccess Networks (work funded by Hellas On Line (HOL) www.hol.gr).</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * \note These features added by David C. Troy &lt;dave@toad.net&gt;:</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> *    - Per-queue holdtime calculation</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> *    - Estimated holdtime announcement</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> *    - Position announcement</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> *    - Abandoned/completed call counters</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> *    - Failout timer passed as optional app parameter</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> *    - Optional monitoring of calls, started when call is answered</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * Patch Version 1.07 2003-12-24 01</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * Added servicelevel statistic by Michiel Betel &lt;michiel@betel.nl&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * Added Priority jumping code for adding and removing queue members by Jonathan Stanton &lt;asterisk@doilooklikeicare.com&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * Fixed to work with CVS as of 2004-02-25 and released as 1.07a</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> * by Matthew Enger &lt;m.enger@xi.com.au&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * \ingroup applications</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/*! \li \ref app_queues.c uses configuration file \ref queues.conf</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> * \addtogroup configuration_file</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">/*! \page queues.conf queues.conf</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * \verbinclude queues.conf.sample</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/*** MODULEINFO</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">   &lt;use type=&quot;module&quot;&gt;res_monitor&lt;/use&gt;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">   &lt;support_level&gt;core&lt;/support_level&gt;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db2/asterisk_8h.html">asterisk.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &lt;sys/time.h&gt;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d42/lock_8h.html">asterisk/lock.h</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4d/file_8h.html">asterisk/file.h</a>&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7b/channel_8h.html">asterisk/channel.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de0/pbx_8h.html">asterisk/pbx.h</a>&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html">asterisk/app.h</a>&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d90/linkedlists_8h.html">asterisk/linkedlists.h</a>&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d16/module_8h.html">asterisk/module.h</a>&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d39/translate_8h.html">asterisk/translate.h</a>&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dce/say_8h.html">asterisk/say.h</a>&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/features_8h.html">asterisk/features.h</a>&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d07/musiconhold_8h.html">asterisk/musiconhold.h</a>&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db0/cli_8h.html">asterisk/cli.h</a>&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d45/manager_8h.html">asterisk/manager.h</a>&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html">asterisk/config.h</a>&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d60/monitor_8h.html">asterisk/monitor.h</a>&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d60/utils_8h.html">asterisk/utils.h</a>&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/da3/causes_8h.html">asterisk/causes.h</a>&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d4a/astdb_8h.html">asterisk/astdb.h</a>&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/da2/devicestate_8h.html">asterisk/devicestate.h</a>&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d0f/stringfields_8h.html">asterisk/stringfields.h</a>&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da5/astobj2_8h.html">asterisk/astobj2.h</a>&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d90/strings_8h.html">asterisk/strings.h</a>&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d1e/taskprocessor_8h.html">asterisk/taskprocessor.h</a>&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/db3/aoc_8h.html">asterisk/aoc.h</a>&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/callerid_8h.html">asterisk/callerid.h</a>&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d45/term_8h.html">asterisk/term.h</a>&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/dcf/dial_8h.html">asterisk/dial.h</a>&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d4a/stasis__channels_8h.html">asterisk/stasis_channels.h</a>&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d25/stasis__message__router_8h.html">asterisk/stasis_message_router.h</a>&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d85/bridge__after_8h.html">asterisk/bridge_after.h</a>&quot;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d4e/stasis__bridges_8h.html">asterisk/stasis_bridges.h</a>&quot;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da6/core__local_8h.html">asterisk/core_local.h</a>&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d40/mixmonitor_8h.html">asterisk/mixmonitor.h</a>&quot;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d1e/bridge__basic_8h.html">asterisk/bridge_basic.h</a>&quot;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d93/max__forwards_8h.html">asterisk/max_forwards.h</a>&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> * \par Please read before modifying this file.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> * There are three locks which are regularly used</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> * throughout this file, the queue list lock, the lock</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> * for each individual queue, and the interface list lock.</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> * Please be extra careful to always lock in the following order</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> * 1) queue list lock</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> * 2) individual queue lock</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> * 3) interface list lock</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> * This order has sort of &quot;evolved&quot; over the lifetime of this</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> * application, but it is now in place this way, so please adhere</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> * to this order!</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">/*** DOCUMENTATION</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">   &lt;application name=&quot;Queue&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">         Queue a call for a call queue.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">         &lt;parameter name=&quot;options&quot;&gt;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">            &lt;optionlist&gt;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">               &lt;option name=&quot;b&quot; argsep=&quot;^&quot;&gt;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">                  &lt;para&gt;Before initiating an outgoing call, &lt;literal&gt;Gosub&lt;/literal&gt; to the specified</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">                  location using the newly created channel.  The &lt;literal&gt;Gosub&lt;/literal&gt; will be</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">                  executed for each destination channel.&lt;/para&gt;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">                  &lt;argument name=&quot;context&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">                  &lt;argument name=&quot;exten&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">                  &lt;argument name=&quot;priority&quot; required=&quot;true&quot; hasparams=&quot;optional&quot; argsep=&quot;^&quot;&gt;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">                     &lt;argument name=&quot;arg1&quot; multiple=&quot;true&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">                     &lt;argument name=&quot;argN&quot; /&gt;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">                  &lt;/argument&gt;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">               &lt;option name=&quot;B&quot; argsep=&quot;^&quot;&gt;</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">                  &lt;para&gt;Before initiating the outgoing call(s), &lt;literal&gt;Gosub&lt;/literal&gt; to the</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">                  specified location using the current channel.&lt;/para&gt;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">                  &lt;argument name=&quot;context&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">                  &lt;argument name=&quot;exten&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">                  &lt;argument name=&quot;priority&quot; required=&quot;true&quot; hasparams=&quot;optional&quot; argsep=&quot;^&quot;&gt;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">                     &lt;argument name=&quot;arg1&quot; multiple=&quot;true&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">                     &lt;argument name=&quot;argN&quot; /&gt;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">                  &lt;/argument&gt;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">               &lt;option name=&quot;C&quot;&gt;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">                  &lt;para&gt;Mark all calls as &quot;answered elsewhere&quot; when cancelled.&lt;/para&gt;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">               &lt;option name=&quot;c&quot;&gt;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">                  &lt;para&gt;Continue in the dialplan if the callee hangs up.&lt;/para&gt;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">               &lt;option name=&quot;d&quot;&gt;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">                  &lt;para&gt;data-quality (modem) call (minimum delay).&lt;/para&gt;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">               &lt;option name=&quot;F&quot; argsep=&quot;^&quot;&gt;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">                  &lt;argument name=&quot;context&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">                  &lt;argument name=&quot;exten&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">                  &lt;argument name=&quot;priority&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">                  &lt;para&gt;When the caller hangs up, transfer the &lt;emphasis&gt;called member&lt;/emphasis&gt;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">                  to the specified destination and &lt;emphasis&gt;start&lt;/emphasis&gt; execution at that location.&lt;/para&gt;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">                  &lt;para&gt;NOTE: Any channel variables you want the called channel to inherit from the caller channel must be</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">                  prefixed with one or two underbars (&#39;_&#39;).&lt;/para&gt;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">               &lt;option name=&quot;F&quot;&gt;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">                  &lt;para&gt;When the caller hangs up, transfer the &lt;emphasis&gt;called member&lt;/emphasis&gt; to the next priority of</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">                  the current extension and &lt;emphasis&gt;start&lt;/emphasis&gt; execution at that location.&lt;/para&gt;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">                  &lt;para&gt;NOTE: Any channel variables you want the called channel to inherit from the caller channel must be</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">                  prefixed with one or two underbars (&#39;_&#39;).&lt;/para&gt;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">                  &lt;para&gt;NOTE: Using this option from a Macro() or GoSub() might not make sense as there would be no return points.&lt;/para&gt;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">               &lt;option name=&quot;h&quot;&gt;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">                  &lt;para&gt;Allow &lt;emphasis&gt;callee&lt;/emphasis&gt; to hang up by pressing &lt;literal&gt;*&lt;/literal&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">               &lt;option name=&quot;H&quot;&gt;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">                  &lt;para&gt;Allow &lt;emphasis&gt;caller&lt;/emphasis&gt; to hang up by pressing &lt;literal&gt;*&lt;/literal&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">               &lt;option name=&quot;n&quot;&gt;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">                  &lt;para&gt;No retries on the timeout; will exit this application and</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">                  go to the next step.&lt;/para&gt;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">               &lt;option name=&quot;i&quot;&gt;</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">                  &lt;para&gt;Ignore call forward requests from queue members and do nothing</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">                  when they are requested.&lt;/para&gt;</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">               &lt;option name=&quot;I&quot;&gt;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">                  &lt;para&gt;Asterisk will ignore any connected line update requests or any redirecting party</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">                  update requests it may receive on this dial attempt.&lt;/para&gt;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">               &lt;option name=&quot;r&quot;&gt;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">                  &lt;para&gt;Ring instead of playing MOH. Periodic Announcements are still made, if applicable.&lt;/para&gt;</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">               &lt;option name=&quot;R&quot;&gt;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">                  &lt;para&gt;Ring instead of playing MOH when a member channel is actually ringing.&lt;/para&gt;</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">               &lt;option name=&quot;t&quot;&gt;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;called&lt;/emphasis&gt; user to transfer the calling user.&lt;/para&gt;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">               &lt;option name=&quot;T&quot;&gt;</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;calling&lt;/emphasis&gt; user to transfer the call.&lt;/para&gt;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">               &lt;option name=&quot;w&quot;&gt;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;called&lt;/emphasis&gt; user to write the conversation to</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">                  disk via Monitor.&lt;/para&gt;</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">               &lt;option name=&quot;W&quot;&gt;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;calling&lt;/emphasis&gt; user to write the conversation to</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">                  disk via Monitor.&lt;/para&gt;</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">               &lt;option name=&quot;k&quot;&gt;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;called&lt;/emphasis&gt; party to enable parking of the call by sending</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">                  the DTMF sequence defined for call parking in &lt;filename&gt;features.conf&lt;/filename&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">               &lt;option name=&quot;K&quot;&gt;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;calling&lt;/emphasis&gt; party to enable parking of the call by sending</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">                  the DTMF sequence defined for call parking in &lt;filename&gt;features.conf&lt;/filename&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">               &lt;option name=&quot;x&quot;&gt;</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;called&lt;/emphasis&gt; user to write the conversation</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">                  to disk via MixMonitor.&lt;/para&gt;</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">               &lt;option name=&quot;X&quot;&gt;</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">                  &lt;para&gt;Allow the &lt;emphasis&gt;calling&lt;/emphasis&gt; user to write the conversation to</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">                  disk via MixMonitor.&lt;/para&gt;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">            &lt;/optionlist&gt;</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">         &lt;parameter name=&quot;URL&quot;&gt;</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">            &lt;para&gt;&lt;replaceable&gt;URL&lt;/replaceable&gt; will be sent to the called party if the channel supports it.&lt;/para&gt;</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">         &lt;parameter name=&quot;announceoverride&quot; /&gt;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">         &lt;parameter name=&quot;timeout&quot;&gt;</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">            &lt;para&gt;Will cause the queue to fail out after a specified number of</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">            seconds, checked between each &lt;filename&gt;queues.conf&lt;/filename&gt; &lt;replaceable&gt;timeout&lt;/replaceable&gt; and</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">            &lt;replaceable&gt;retry&lt;/replaceable&gt; cycle.&lt;/para&gt;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">         &lt;parameter name=&quot;AGI&quot;&gt;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">            &lt;para&gt;Will setup an AGI script to be executed on the calling party&#39;s channel once they are</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">            connected to a queue member.&lt;/para&gt;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">         &lt;parameter name=&quot;macro&quot;&gt;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">            &lt;para&gt;Will run a macro on the called party&#39;s channel (the queue member) once the parties are connected.&lt;/para&gt;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">            &lt;para&gt;NOTE: Macros are deprecated, GoSub should be used instead.&lt;/para&gt;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">         &lt;parameter name=&quot;gosub&quot;&gt;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">            &lt;para&gt;Will run a gosub on the called party&#39;s channel (the queue member)</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">            once the parties are connected.  The subroutine execution starts in the</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">            named context at the s exten and priority 1.&lt;/para&gt;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">         &lt;parameter name=&quot;rule&quot;&gt;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">            &lt;para&gt;Will cause the queue&#39;s defaultrule to be overridden by the rule specified.&lt;/para&gt;</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">         &lt;parameter name=&quot;position&quot;&gt;</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">            &lt;para&gt;Attempt to enter the caller into the queue at the numerical position specified. &lt;literal&gt;1&lt;/literal&gt;</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">            would attempt to enter the caller at the head of the queue, and &lt;literal&gt;3&lt;/literal&gt; would attempt to place</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">            the caller third in the queue.&lt;/para&gt;</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">         &lt;para&gt;In addition to transferring the call, a call may be parked and then picked</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">         up by another user.&lt;/para&gt;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">         &lt;para&gt;This application will return to the dialplan if the queue does not exist, or</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">         any of the join options cause the caller to not enter the queue.&lt;/para&gt;</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">         &lt;para&gt;This application does not automatically answer and should be preceeded</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">         by an application such as Answer(), Progress(), or Ringing().&lt;/para&gt;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">         &lt;para&gt;This application sets the following channel variables upon completion:&lt;/para&gt;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">         &lt;variablelist&gt;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">            &lt;variable name=&quot;QUEUESTATUS&quot;&gt;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">               &lt;para&gt;The status of the call as a text string.&lt;/para&gt;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">               &lt;value name=&quot;TIMEOUT&quot; /&gt;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">               &lt;value name=&quot;FULL&quot; /&gt;</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">               &lt;value name=&quot;JOINEMPTY&quot; /&gt;</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">               &lt;value name=&quot;LEAVEEMPTY&quot; /&gt;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">               &lt;value name=&quot;JOINUNAVAIL&quot; /&gt;</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">               &lt;value name=&quot;LEAVEUNAVAIL&quot; /&gt;</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">               &lt;value name=&quot;CONTINUE&quot; /&gt;</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">            &lt;/variable&gt;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">            &lt;variable name=&quot;ABANDONED&quot;&gt;</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">               &lt;para&gt;If the call was not answered by an agent this variable will be TRUE.&lt;/para&gt;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">               &lt;value name=&quot;TRUE&quot; /&gt;</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">            &lt;/variable&gt;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">         &lt;/variablelist&gt;</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">   &lt;application name=&quot;AddQueueMember&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">         Dynamically adds queue members.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">         &lt;parameter name=&quot;interface&quot; /&gt;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">         &lt;parameter name=&quot;penalty&quot; /&gt;</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">         &lt;parameter name=&quot;options&quot; /&gt;</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">         &lt;parameter name=&quot;membername&quot; /&gt;</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">         &lt;parameter name=&quot;stateinterface&quot; /&gt;</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">         &lt;parameter name=&quot;wrapuptime&quot; /&gt;</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">         &lt;para&gt;Dynamically adds interface to an existing queue. If the interface is</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">         already in the queue it will return an error.&lt;/para&gt;</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">         &lt;para&gt;This application sets the following channel variable upon completion:&lt;/para&gt;</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">         &lt;variablelist&gt;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">            &lt;variable name=&quot;AQMSTATUS&quot;&gt;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">               &lt;para&gt;The status of the attempt to add a queue member as a text string.&lt;/para&gt;</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">               &lt;value name=&quot;ADDED&quot; /&gt;</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">               &lt;value name=&quot;MEMBERALREADY&quot; /&gt;</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">               &lt;value name=&quot;NOSUCHQUEUE&quot; /&gt;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">            &lt;/variable&gt;</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">         &lt;/variablelist&gt;</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">   &lt;application name=&quot;RemoveQueueMember&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">         Dynamically removes queue members.</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">         &lt;parameter name=&quot;interface&quot; /&gt;</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">         &lt;para&gt;If the interface is &lt;emphasis&gt;NOT&lt;/emphasis&gt; in the queue it will return an error.&lt;/para&gt;</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">         &lt;para&gt;This application sets the following channel variable upon completion:&lt;/para&gt;</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">         &lt;variablelist&gt;</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">            &lt;variable name=&quot;RQMSTATUS&quot;&gt;</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">               &lt;value name=&quot;REMOVED&quot; /&gt;</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">               &lt;value name=&quot;NOTINQUEUE&quot; /&gt;</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">               &lt;value name=&quot;NOSUCHQUEUE&quot; /&gt;</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">               &lt;value name=&quot;NOTDYNAMIC&quot; /&gt;</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">            &lt;/variable&gt;</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">         &lt;/variablelist&gt;</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">         &lt;para&gt;Example: RemoveQueueMember(techsupport,SIP/3000)&lt;/para&gt;</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">   &lt;application name=&quot;PauseQueueMember&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">         Pauses a queue member.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; /&gt;</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">         &lt;parameter name=&quot;interface&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">         &lt;parameter name=&quot;options&quot; /&gt;</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">         &lt;parameter name=&quot;reason&quot;&gt;</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">            &lt;para&gt;Is used to add extra information to the appropriate queue_log entries and manager events.&lt;/para&gt;</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">         &lt;para&gt;Pauses (blocks calls for) a queue member. The given interface will be paused in the given queue.</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">         This prevents any calls from being sent from the queue to the interface until it is</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">         unpaused with UnpauseQueueMember or the manager interface.  If no queuename is given,</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">         the interface is paused in every queue it is a member of. The application will fail if the</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">         interface is not found.&lt;/para&gt;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">         &lt;para&gt;This application sets the following channel variable upon completion:&lt;/para&gt;</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">         &lt;variablelist&gt;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">            &lt;variable name=&quot;PQMSTATUS&quot;&gt;</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">               &lt;para&gt;The status of the attempt to pause a queue member as a text string.&lt;/para&gt;</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">               &lt;value name=&quot;PAUSED&quot; /&gt;</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">               &lt;value name=&quot;NOTFOUND&quot; /&gt;</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">            &lt;/variable&gt;</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">         &lt;/variablelist&gt;</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">         &lt;para&gt;Example: PauseQueueMember(,SIP/3000)&lt;/para&gt;</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">   &lt;application name=&quot;UnpauseQueueMember&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">         Unpauses a queue member.</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; /&gt;</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">         &lt;parameter name=&quot;interface&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">         &lt;parameter name=&quot;options&quot; /&gt;</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">         &lt;parameter name=&quot;reason&quot;&gt;</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">            &lt;para&gt;Is used to add extra information to the appropriate queue_log entries and manager events.&lt;/para&gt;</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">         &lt;para&gt;Unpauses (resumes calls to) a queue member. This is the counterpart to &lt;literal&gt;PauseQueueMember()&lt;/literal&gt;</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">         and operates exactly the same way, except it unpauses instead of pausing the given interface.&lt;/para&gt;</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">         &lt;para&gt;This application sets the following channel variable upon completion:&lt;/para&gt;</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">         &lt;variablelist&gt;</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">            &lt;variable name=&quot;UPQMSTATUS&quot;&gt;</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">               &lt;para&gt;The status of the attempt to unpause a queue member as a text string.&lt;/para&gt;</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">               &lt;value name=&quot;UNPAUSED&quot; /&gt;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">               &lt;value name=&quot;NOTFOUND&quot; /&gt;</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">            &lt;/variable&gt;</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">         &lt;/variablelist&gt;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">         &lt;para&gt;Example: UnpauseQueueMember(,SIP/3000)&lt;/para&gt;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">   &lt;application name=&quot;QueueLog&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">         Writes to the queue_log file.</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">         &lt;parameter name=&quot;uniqueid&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">         &lt;parameter name=&quot;agent&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">         &lt;parameter name=&quot;event&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">         &lt;parameter name=&quot;additionalinfo&quot; /&gt;</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">         &lt;para&gt;Allows you to write your own events into the queue log.&lt;/para&gt;</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">         &lt;para&gt;Example: QueueLog(101,${UNIQUEID},${AGENT},WENTONBREAK,600)&lt;/para&gt;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">   &lt;application name=&quot;QueueUpdate&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">         Writes to the queue_log file for OutBound calls and updates Realtime Data.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">         Is used at h extension to be able to have all the parameters.</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">         &lt;parameter name=&quot;uniqueid&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">         &lt;parameter name=&quot;agent&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">         &lt;parameter name=&quot;status&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">         &lt;parameter name=&quot;talktime&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">         &lt;parameter name=&quot;params&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">         &lt;para&gt;Allows you to write Outbound events into the queue log.&lt;/para&gt;</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">         &lt;para&gt;Example: exten =&gt; h,1,QueueUpdate(${QUEUE}, ${UNIQUEID}, ${AGENT}, ${DIALSTATUS}, ${ANSWEREDTIME}, ${DIALEDTIME} | ${DIALEDNUMBER})&lt;/para&gt;</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_VARIABLES&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">         Return Queue information in variables.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUEMAX&quot;&gt;</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">                  &lt;para&gt;Maxmimum number of calls allowed.&lt;/para&gt;</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUESTRATEGY&quot;&gt;</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">                  &lt;para&gt;The strategy of the queue.&lt;/para&gt;</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUECALLS&quot;&gt;</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">                  &lt;para&gt;Number of calls currently in the queue.&lt;/para&gt;</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUEHOLDTIME&quot;&gt;</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">                  &lt;para&gt;Current average hold time.&lt;/para&gt;</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUECOMPLETED&quot;&gt;</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">                  &lt;para&gt;Number of completed calls for the queue.&lt;/para&gt;</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUEABANDONED&quot;&gt;</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">                  &lt;para&gt;Number of abandoned calls.&lt;/para&gt;</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUESRVLEVEL&quot;&gt;</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">                  &lt;para&gt;Queue service level.&lt;/para&gt;</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">               &lt;enum name=&quot;QUEUESRVLEVELPERF&quot;&gt;</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">                  &lt;para&gt;Current service level performance.&lt;/para&gt;</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">         &lt;para&gt;Makes the following queue variables available.&lt;/para&gt;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">         &lt;para&gt;Returns &lt;literal&gt;0&lt;/literal&gt; if queue is found and setqueuevar is defined, &lt;literal&gt;-1&lt;/literal&gt; otherwise.&lt;/para&gt;</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_MEMBER&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">         Provides a count of queue members based on the provided criteria, or updates a</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">         queue member&#39;s settings.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">         &lt;parameter name=&quot;option&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">               &lt;enum name=&quot;logged&quot;&gt;</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">                  &lt;para&gt;Returns the number of logged-in members for the specified queue.&lt;/para&gt;</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">               &lt;enum name=&quot;free&quot;&gt;</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">                  &lt;para&gt;Returns the number of logged-in members for the specified queue that either can take calls or are currently wrapping up after a previous call.&lt;/para&gt;</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">               &lt;enum name=&quot;ready&quot;&gt;</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">                  &lt;para&gt;Returns the number of logged-in members for the specified queue that are immediately available to answer a call.&lt;/para&gt;</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">               &lt;enum name=&quot;count&quot;&gt;</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">                  &lt;para&gt;Returns the total number of members for the specified queue.&lt;/para&gt;</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">               &lt;enum name=&quot;penalty&quot;&gt;</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">                  &lt;para&gt;Gets or sets queue member penalty.  If</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">                  &lt;replaceable&gt;queuename&lt;/replaceable&gt; is not specified</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">                  when setting the penalty then the penalty is set in all queues</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">                  the interface is a member.&lt;/para&gt;</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">               &lt;enum name=&quot;paused&quot;&gt;</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">                  &lt;para&gt;Gets or sets queue member paused status.  If</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">                  &lt;replaceable&gt;queuename&lt;/replaceable&gt; is not specified</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">                  when setting the paused status then the paused status is set</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">                  in all queues the interface is a member.&lt;/para&gt;</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">               &lt;enum name=&quot;ringinuse&quot;&gt;</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">                  &lt;para&gt;Gets or sets queue member ringinuse.  If</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">                  &lt;replaceable&gt;queuename&lt;/replaceable&gt; is not specified</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">                  when setting ringinuse then ringinuse is set</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">                  in all queues the interface is a member.&lt;/para&gt;</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">         &lt;parameter name=&quot;interface&quot; required=&quot;false&quot; /&gt;</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">         &lt;para&gt;Allows access to queue counts [R] and member information [R/W].&lt;/para&gt;</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">         &lt;para&gt;&lt;replaceable&gt;queuename&lt;/replaceable&gt; is required for all read operations.&lt;/para&gt;</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">         &lt;para&gt;&lt;replaceable&gt;interface&lt;/replaceable&gt; is required for all member operations.&lt;/para&gt;</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_MEMBER_COUNT&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">         Count number of members answering a queue.</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">         &lt;para&gt;Returns the number of members currently associated with the specified &lt;replaceable&gt;queuename&lt;/replaceable&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">         &lt;warning&gt;&lt;para&gt;This function has been deprecated in favor of the &lt;literal&gt;QUEUE_MEMBER()&lt;/literal&gt; function&lt;/para&gt;&lt;/warning&gt;</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_EXISTS&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">         Check if a named queue exists on this server</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; /&gt;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">         &lt;para&gt;Returns 1 if the specified queue exists, 0 if it does not&lt;/para&gt;</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_GET_CHANNEL&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">         Return caller at the specified position in a queue.</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">         &lt;parameter name=&quot;position&quot; /&gt;</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">         &lt;para&gt;Returns the caller channel at &lt;replaceable&gt;position&lt;/replaceable&gt; in the specified &lt;replaceable&gt;queuename&lt;/replaceable&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">         &lt;para&gt;If &lt;replaceable&gt;position&lt;/replaceable&gt; is unspecified the first channel is returned.&lt;/para&gt;</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_WAITING_COUNT&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">         Count number of calls currently waiting in a queue.</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; /&gt;</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">         &lt;para&gt;Returns the number of callers currently waiting in the specified &lt;replaceable&gt;queuename&lt;/replaceable&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_MEMBER_LIST&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">         Returns a list of interfaces on a queue.</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">         &lt;para&gt;Returns a comma-separated list of members associated with the specified &lt;replaceable&gt;queuename&lt;/replaceable&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">   &lt;function name=&quot;QUEUE_MEMBER_PENALTY&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">         Gets or sets queue members penalty.</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">         &lt;parameter name=&quot;queuename&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">         &lt;parameter name=&quot;interface&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">         &lt;para&gt;Gets or sets queue members penalty.&lt;/para&gt;</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">         &lt;warning&gt;&lt;para&gt;This function has been deprecated in favor of the &lt;literal&gt;QUEUE_MEMBER()&lt;/literal&gt; function&lt;/para&gt;&lt;/warning&gt;</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;QueueLog&lt;/ref&gt;</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_VARIABLES&lt;/ref&gt;</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_EXISTS&lt;/ref&gt;</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_GET_CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_WAITING_COUNT&lt;/ref&gt;</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_LIST&lt;/ref&gt;</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER_PENALTY&lt;/ref&gt;</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueStatus&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">         Show queue status.</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot;&gt;</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">            &lt;para&gt;Limit the response to the status of the specified queue.&lt;/para&gt;</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">         &lt;parameter name=&quot;Member&quot;&gt;</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">            &lt;para&gt;Limit the response to the status of the specified member.&lt;/para&gt;</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">         &lt;para&gt;Check the status of one or more queues.&lt;/para&gt;</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueSummary&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">         Show queue summary.</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot;&gt;</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">            &lt;para&gt;Queue for which the summary is requested.&lt;/para&gt;</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">         &lt;para&gt;Request the manager to send a QueueSummary event.&lt;/para&gt;</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueAdd&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">         Add interface to queue.</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">            &lt;para&gt;Queue&#39;s name.&lt;/para&gt;</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">         &lt;parameter name=&quot;Interface&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">            &lt;para&gt;The name of the interface (tech/name) to add to the queue.&lt;/para&gt;</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">         &lt;parameter name=&quot;Penalty&quot;&gt;</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">            &lt;para&gt;A penalty (number) to apply to this member. Asterisk will distribute calls to members with higher penalties only after attempting to distribute calls to those with lower penalty.&lt;/para&gt;</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">         &lt;parameter name=&quot;Paused&quot;&gt;</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">            &lt;para&gt;To pause or not the member initially (true/false or 1/0).&lt;/para&gt;</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">         &lt;parameter name=&quot;MemberName&quot;&gt;</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">            &lt;para&gt;Text alias for the interface.&lt;/para&gt;</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">         &lt;parameter name=&quot;StateInterface&quot; /&gt;</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueRemove&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">         Remove interface from queue.</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">            &lt;para&gt;The name of the queue to take action on.&lt;/para&gt;</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">         &lt;parameter name=&quot;Interface&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">            &lt;para&gt;The interface (tech/name) to remove from queue.&lt;/para&gt;</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">   &lt;manager name=&quot;QueuePause&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">         Makes a queue member temporarily unavailable.</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">         &lt;parameter name=&quot;Interface&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">            &lt;para&gt;The name of the interface (tech/name) to pause or unpause.&lt;/para&gt;</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">         &lt;parameter name=&quot;Paused&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">            &lt;para&gt;Pause or unpause the interface. Set to &#39;true&#39; to pause the member or &#39;false&#39; to unpause.&lt;/para&gt;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot;&gt;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">            &lt;para&gt;The name of the queue in which to pause or unpause this member. If not specified, the member will be paused or unpaused in all the queues it is a member of.&lt;/para&gt;</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">         &lt;parameter name=&quot;Reason&quot;&gt;</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">            &lt;para&gt;Text description, returned in the event QueueMemberPaused.&lt;/para&gt;</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">         &lt;para&gt;Pause or unpause a member in a queue.&lt;/para&gt;</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueLog&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">         Adds custom entry in queue_log.</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">         &lt;parameter name=&quot;Event&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">         &lt;parameter name=&quot;Uniqueid&quot; /&gt;</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">         &lt;parameter name=&quot;Interface&quot; /&gt;</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">         &lt;parameter name=&quot;Message&quot; /&gt;</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">   &lt;manager name=&quot;QueuePenalty&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">         Set the penalty for a queue member.</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">         &lt;parameter name=&quot;Interface&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">            &lt;para&gt;The interface (tech/name) of the member whose penalty to change.&lt;/para&gt;</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">         &lt;parameter name=&quot;Penalty&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">            &lt;para&gt;The new penalty (number) for the member. Must be nonnegative.&lt;/para&gt;</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot;&gt;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">            &lt;para&gt;If specified, only set the penalty for the member of this queue. Otherwise, set the penalty for the member in all queues to which the member belongs.&lt;/para&gt;</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">         &lt;para&gt;Change the penalty of a queue member&lt;/para&gt;</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueMemberRingInUse&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">         Set the ringinuse value for a queue member.</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">         &lt;parameter name=&quot;Interface&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">         &lt;parameter name=&quot;RingInUse&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot; /&gt;</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueRule&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">         Queue Rules.</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">         &lt;parameter name=&quot;Rule&quot;&gt;</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">            &lt;para&gt;The name of the rule in queuerules.conf whose contents to list.&lt;/para&gt;</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">         &lt;para&gt;List queue rules defined in queuerules.conf&lt;/para&gt;</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueReload&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">         Reload a queue, queues, or any sub-section of a queue or queues.</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot;&gt;</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">            &lt;para&gt;The name of the queue to take action on. If no queue name is specified, then all queues are affected.&lt;/para&gt;</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">         &lt;parameter name=&quot;Members&quot;&gt;</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">            &lt;para&gt;Whether to reload the queue&#39;s members.&lt;/para&gt;</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">               &lt;enum name=&quot;yes&quot; /&gt;</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">               &lt;enum name=&quot;no&quot; /&gt;</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">         &lt;parameter name=&quot;Rules&quot;&gt;</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">            &lt;para&gt;Whether to reload queuerules.conf&lt;/para&gt;</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">               &lt;enum name=&quot;yes&quot; /&gt;</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">               &lt;enum name=&quot;no&quot; /&gt;</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">         &lt;parameter name=&quot;Parameters&quot;&gt;</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">            &lt;para&gt;Whether to reload the other queue options.&lt;/para&gt;</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">               &lt;enum name=&quot;yes&quot; /&gt;</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">               &lt;enum name=&quot;no&quot; /&gt;</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueReset&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">         Reset queue statistics.</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot;&gt;</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">            &lt;para&gt;The name of the queue on which to reset statistics.&lt;/para&gt;</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">         &lt;para&gt;Reset the statistics for a queue.&lt;/para&gt;</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">   &lt;manager name=&quot;QueueChangePriorityCaller&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">         Change priority of a caller on queue.</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">         &lt;parameter name=&quot;Queue&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">            &lt;para&gt;The name of the queue to take action on.&lt;/para&gt;</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">         &lt;parameter name=&quot;Caller&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">            &lt;para&gt;The caller (channel) to change priority on queue.&lt;/para&gt;</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">         &lt;parameter name=&quot;Priority&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">            &lt;para&gt;Priority value for change for caller on queue.&lt;/para&gt;</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueMemberStatus&quot;&gt;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a Queue member&#39;s status has changed.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">            &lt;parameter name=&quot;Queue&quot;&gt;</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">               &lt;para&gt;The name of the queue.&lt;/para&gt;</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">            &lt;parameter name=&quot;MemberName&quot;&gt;</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">               &lt;para&gt;The name of the queue member.&lt;/para&gt;</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">            &lt;parameter name=&quot;Interface&quot;&gt;</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">               &lt;para&gt;The queue member&#39;s channel technology or location.&lt;/para&gt;</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">            &lt;parameter name=&quot;StateInterface&quot;&gt;</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">               &lt;para&gt;Channel technology or location from which to read device state changes.&lt;/para&gt;</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">            &lt;parameter name=&quot;Membership&quot;&gt;</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">                  &lt;enum name=&quot;dynamic&quot;/&gt;</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">                  &lt;enum name=&quot;realtime&quot;/&gt;</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">                  &lt;enum name=&quot;static&quot;/&gt;</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">            &lt;parameter name=&quot;Penalty&quot;&gt;</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">               &lt;para&gt;The penalty associated with the queue member.&lt;/para&gt;</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">            &lt;parameter name=&quot;CallsTaken&quot;&gt;</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">               &lt;para&gt;The number of calls this queue member has serviced.&lt;/para&gt;</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">            &lt;parameter name=&quot;LastCall&quot;&gt;</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">               &lt;para&gt;The time this member last took a call, expressed in seconds since 00:00, Jan 1, 1970 UTC.&lt;/para&gt;</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">            &lt;parameter name=&quot;LastPause&quot;&gt;</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">               &lt;para&gt;The time when started last paused the queue member.&lt;/para&gt;</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">            &lt;parameter name=&quot;InCall&quot;&gt;</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">               &lt;para&gt;Set to 1 if member is in call. Set to 0 after LastCall time is updated.&lt;/para&gt;</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">                  &lt;enum name=&quot;0&quot;/&gt;</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">                  &lt;enum name=&quot;1&quot;/&gt;</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">            &lt;parameter name=&quot;Status&quot;&gt;</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">               &lt;para&gt;The numeric device state status of the queue member.&lt;/para&gt;</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">                  &lt;enum name=&quot;0&quot;&gt;&lt;para&gt;AST_DEVICE_UNKNOWN&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">                  &lt;enum name=&quot;1&quot;&gt;&lt;para&gt;AST_DEVICE_NOT_INUSE&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">                  &lt;enum name=&quot;2&quot;&gt;&lt;para&gt;AST_DEVICE_INUSE&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">                  &lt;enum name=&quot;3&quot;&gt;&lt;para&gt;AST_DEVICE_BUSY&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">                  &lt;enum name=&quot;4&quot;&gt;&lt;para&gt;AST_DEVICE_INVALID&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">                  &lt;enum name=&quot;5&quot;&gt;&lt;para&gt;AST_DEVICE_UNAVAILABLE&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">                  &lt;enum name=&quot;6&quot;&gt;&lt;para&gt;AST_DEVICE_RINGING&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">                  &lt;enum name=&quot;7&quot;&gt;&lt;para&gt;AST_DEVICE_RINGINUSE&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">                  &lt;enum name=&quot;8&quot;&gt;&lt;para&gt;AST_DEVICE_ONHOLD&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">            &lt;parameter name=&quot;Paused&quot;&gt;</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">                  &lt;enum name=&quot;0&quot;/&gt;</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">                  &lt;enum name=&quot;1&quot;/&gt;</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">            &lt;parameter name=&quot;PausedReason&quot;&gt;</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">               &lt;para&gt;If set when paused, the reason the queue member was paused.&lt;/para&gt;</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">            &lt;parameter name=&quot;Ringinuse&quot;&gt;</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">                  &lt;enum name=&quot;0&quot;/&gt;</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">                  &lt;enum name=&quot;1&quot;/&gt;</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">            &lt;parameter name=&quot;Wrapuptime&quot;&gt;</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">               &lt;para&gt;The Wrapup Time of the queue member. If this value is set will override the wrapup time of queue.&lt;/para&gt;</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueMemberAdded&quot;&gt;</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a member is added to the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter)&quot; /&gt;</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;QueueMemberRemoved&lt;/ref&gt;</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">            &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueMemberRemoved&quot;&gt;</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a member is removed from the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter)&quot; /&gt;</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;QueueMemberAdded&lt;/ref&gt;</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">            &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueMemberPause&quot;&gt;</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a member is paused/unpaused in the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter)&quot; /&gt;</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">            &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">            &lt;ref type=&quot;application&quot;&gt;UnPauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueMemberPenalty&quot;&gt;</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a member&#39;s penalty is changed.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter)&quot; /&gt;</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">            &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueMemberRinginuse&quot;&gt;</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a member&#39;s ringinuse setting is changed.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter)&quot; /&gt;</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">            &lt;ref type=&quot;function&quot;&gt;QUEUE_MEMBER&lt;/ref&gt;</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueCallerJoin&quot;&gt;</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a caller joins a Queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">            &lt;parameter name=&quot;Position&quot;&gt;</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">               &lt;para&gt;This channel&#39;s current position in the queue.&lt;/para&gt;</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">            &lt;parameter name=&quot;Count&quot;&gt;</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">               &lt;para&gt;The total number of channels in the queue.&lt;/para&gt;</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;QueueCallerLeave&lt;/ref&gt;</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">            &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueCallerLeave&quot;&gt;</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a caller leaves a Queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueCallerJoin&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Count&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueCallerJoin&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Position&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;QueueCallerJoin&lt;/ref&gt;</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;QueueCallerAbandon&quot;&gt;</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a caller abandons the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueCallerJoin&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Position&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">            &lt;parameter name=&quot;OriginalPosition&quot;&gt;</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">               &lt;para&gt;The channel&#39;s original position in the queue.&lt;/para&gt;</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">            &lt;parameter name=&quot;HoldTime&quot;&gt;</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">               &lt;para&gt;The time the channel was in the queue, expressed in seconds since 00:00, Jan 1, 1970 UTC.&lt;/para&gt;</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;AgentCalled&quot;&gt;</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when an queue member is notified of a caller in the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">            &lt;channel_snapshot prefix=&quot;Dest&quot;/&gt;</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;MemberName&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Interface&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentRingNoAnswer&lt;/ref&gt;</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentComplete&lt;/ref&gt;</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentConnect&lt;/ref&gt;</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;AgentRingNoAnswer&quot;&gt;</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a queue member is notified of a caller in the queue and fails to answer.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">            &lt;channel_snapshot prefix=&quot;Dest&quot;/&gt;</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;MemberName&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Interface&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">            &lt;parameter name=&quot;RingTime&quot;&gt;</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">               &lt;para&gt;The time the queue member was rung, expressed in seconds since 00:00, Jan 1, 1970 UTC.&lt;/para&gt;</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentCalled&lt;/ref&gt;</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;AgentComplete&quot;&gt;</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a queue member has finished servicing a caller in the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">            &lt;channel_snapshot prefix=&quot;Dest&quot;/&gt;</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;MemberName&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Interface&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueCallerAbandon&#39;]/managerEventInstance/syntax/parameter[@name=&#39;HoldTime&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">            &lt;parameter name=&quot;TalkTime&quot;&gt;</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">               &lt;para&gt;The time the queue member talked with the caller in the queue, expressed in seconds since 00:00, Jan 1, 1970 UTC.&lt;/para&gt;</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">            &lt;parameter name=&quot;Reason&quot;&gt;</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">                  &lt;enum name=&quot;caller&quot;/&gt;</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">                  &lt;enum name=&quot;agent&quot;/&gt;</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">                  &lt;enum name=&quot;transfer&quot;/&gt;</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentCalled&lt;/ref&gt;</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentConnect&lt;/ref&gt;</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;AgentDump&quot;&gt;</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a queue member hangs up on a caller in the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">            &lt;channel_snapshot prefix=&quot;Dest&quot;/&gt;</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;MemberName&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Interface&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentCalled&lt;/ref&gt;</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentConnect&lt;/ref&gt;</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;AgentConnect&quot;&gt;</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a queue member answers and is bridged to a caller in the queue.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">            &lt;channel_snapshot prefix=&quot;Dest&quot;/&gt;</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Queue&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;MemberName&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueMemberStatus&#39;]/managerEventInstance/syntax/parameter[@name=&#39;Interface&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;AgentRingNoAnswer&#39;]/managerEventInstance/syntax/parameter[@name=&#39;RingTime&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;QueueCallerAbandon&#39;]/managerEventInstance/syntax/parameter[@name=&#39;HoldTime&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentCalled&lt;/ref&gt;</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentComplete&lt;/ref&gt;</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;AgentDump&lt;/ref&gt;</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="keyword">enum</span> {</div><div class="line"><a name="l01326"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a7c4515f386fff57ac14217a7a5a6c388"> 1326</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a7c4515f386fff57ac14217a7a5a6c388">OPT_MARK_AS_ANSWERED</a> =       (1 &lt;&lt; 0),</div><div class="line"><a name="l01327"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a5745afa61052d9e54f177910f53da159"> 1327</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a5745afa61052d9e54f177910f53da159">OPT_GO_ON</a> =                  (1 &lt;&lt; 1),</div><div class="line"><a name="l01328"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9d07e60d74a39d3012cf728a0e75d91e"> 1328</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9d07e60d74a39d3012cf728a0e75d91e">OPT_DATA_QUALITY</a> =           (1 &lt;&lt; 2),</div><div class="line"><a name="l01329"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a78690a8e97e0eac7d0982b81d5cadac8"> 1329</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a78690a8e97e0eac7d0982b81d5cadac8">OPT_CALLEE_GO_ON</a> =           (1 &lt;&lt; 3),</div><div class="line"><a name="l01330"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab0eb8a377bf253cf368bf70f0b59fc31"> 1330</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab0eb8a377bf253cf368bf70f0b59fc31">OPT_CALLEE_HANGUP</a> =          (1 &lt;&lt; 4),</div><div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9f03cca4e2ee93778ae8ed2db279587d"> 1331</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9f03cca4e2ee93778ae8ed2db279587d">OPT_CALLER_HANGUP</a> =          (1 &lt;&lt; 5),</div><div class="line"><a name="l01332"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a8235d5ff2f8003fdb1d20c6876425ebf"> 1332</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a8235d5ff2f8003fdb1d20c6876425ebf">OPT_IGNORE_CALL_FW</a> =         (1 &lt;&lt; 6),</div><div class="line"><a name="l01333"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6ab17f35d26d691c590098350b231988"> 1333</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6ab17f35d26d691c590098350b231988">OPT_IGNORE_CONNECTEDLINE</a> =   (1 &lt;&lt; 7),</div><div class="line"><a name="l01334"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a35080c34427591a22d34370e0a8ebab4"> 1334</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a35080c34427591a22d34370e0a8ebab4">OPT_CALLEE_PARK</a> =            (1 &lt;&lt; 8),</div><div class="line"><a name="l01335"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a82c1e40f3b210bce47d00d44dec0b8fd"> 1335</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a82c1e40f3b210bce47d00d44dec0b8fd">OPT_CALLER_PARK</a> =            (1 &lt;&lt; 9),</div><div class="line"><a name="l01336"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9343294711278062e3bcf5b51417ccb4"> 1336</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9343294711278062e3bcf5b51417ccb4">OPT_NO_RETRY</a> =               (1 &lt;&lt; 10),</div><div class="line"><a name="l01337"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ad4edc18ee0c5ce6e2af1ed26a64f39ad"> 1337</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ad4edc18ee0c5ce6e2af1ed26a64f39ad">OPT_RINGING</a> =                (1 &lt;&lt; 11),</div><div class="line"><a name="l01338"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae363b1e6b1f2fcb5536719a640aa9dd9"> 1338</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae363b1e6b1f2fcb5536719a640aa9dd9">OPT_RING_WHEN_RINGING</a> =      (1 &lt;&lt; 12),</div><div class="line"><a name="l01339"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6faa363811a3b467116d290d52d967da"> 1339</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6faa363811a3b467116d290d52d967da">OPT_CALLEE_TRANSFER</a> =        (1 &lt;&lt; 13),</div><div class="line"><a name="l01340"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3adb3ae0c7823e3bd3f4a45db3d03f33cb"> 1340</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3adb3ae0c7823e3bd3f4a45db3d03f33cb">OPT_CALLER_TRANSFER</a> =        (1 &lt;&lt; 14),</div><div class="line"><a name="l01341"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3aa465a2ae8739e3b612225fe15f19c0ad"> 1341</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3aa465a2ae8739e3b612225fe15f19c0ad">OPT_CALLEE_AUTOMIXMON</a> =      (1 &lt;&lt; 15),</div><div class="line"><a name="l01342"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab61ce333627051f88077d9b6d7fb2e06"> 1342</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab61ce333627051f88077d9b6d7fb2e06">OPT_CALLER_AUTOMIXMON</a> =      (1 &lt;&lt; 16),</div><div class="line"><a name="l01343"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6cda8c882997c543030f3dde846f9df3"> 1343</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6cda8c882997c543030f3dde846f9df3">OPT_CALLEE_AUTOMON</a> =         (1 &lt;&lt; 17),</div><div class="line"><a name="l01344"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a0c9c1b291152109321095a6734256794"> 1344</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a0c9c1b291152109321095a6734256794">OPT_CALLER_AUTOMON</a> =         (1 &lt;&lt; 18),</div><div class="line"><a name="l01345"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae014616d0271c5671a6d8c24c46dc6b2"> 1345</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae014616d0271c5671a6d8c24c46dc6b2">OPT_PREDIAL_CALLEE</a> =         (1 &lt;&lt; 19),</div><div class="line"><a name="l01346"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a54b4e68636084106abe671c5dcb10b22"> 1346</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a54b4e68636084106abe671c5dcb10b22">OPT_PREDIAL_CALLER</a> =         (1 &lt;&lt; 20),</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;};</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="keyword">enum</span> {</div><div class="line"><a name="l01350"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a1d0a4362e89e71be70b2ca0d47616c99"> 1350</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a1d0a4362e89e71be70b2ca0d47616c99">OPT_ARG_CALLEE_GO_ON</a> = 0,</div><div class="line"><a name="l01351"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a2896cd262bf3d0d9dc2c33f3e5a48ac0"> 1351</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a2896cd262bf3d0d9dc2c33f3e5a48ac0">OPT_ARG_PREDIAL_CALLEE</a>,</div><div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493ae98734a2a20c3c7367ba5d8835378f60"> 1352</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493ae98734a2a20c3c7367ba5d8835378f60">OPT_ARG_PREDIAL_CALLER</a>,</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;   <span class="comment">/* note: this entry _MUST_ be the last one in the enum */</span></div><div class="line"><a name="l01354"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493aec7326f60e7edad15d96ff935e5616d6"> 1354</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493aec7326f60e7edad15d96ff935e5616d6">OPT_ARG_ARRAY_SIZE</a></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;};</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a520a3c6b7d57903d9a616051da1a019d">AST_APP_OPTIONS</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a8e71a98f661c0f497104849cd61261ae">queue_exec_options</a>, <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ab451a4653176c211d131b899e1f91bde">BEGIN_OPTIONS</a></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a7549377df87038be737e8cae73acaa9d">AST_APP_OPTION_ARG</a>(<span class="charliteral">&#39;b&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae014616d0271c5671a6d8c24c46dc6b2">OPT_PREDIAL_CALLEE</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a2896cd262bf3d0d9dc2c33f3e5a48ac0">OPT_ARG_PREDIAL_CALLEE</a>),</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a7549377df87038be737e8cae73acaa9d">AST_APP_OPTION_ARG</a>(<span class="charliteral">&#39;B&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a54b4e68636084106abe671c5dcb10b22">OPT_PREDIAL_CALLER</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493ae98734a2a20c3c7367ba5d8835378f60">OPT_ARG_PREDIAL_CALLER</a>),</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;C&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a7c4515f386fff57ac14217a7a5a6c388">OPT_MARK_AS_ANSWERED</a>),</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;c&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a5745afa61052d9e54f177910f53da159">OPT_GO_ON</a>),</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;d&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9d07e60d74a39d3012cf728a0e75d91e">OPT_DATA_QUALITY</a>),</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a7549377df87038be737e8cae73acaa9d">AST_APP_OPTION_ARG</a>(<span class="charliteral">&#39;F&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a78690a8e97e0eac7d0982b81d5cadac8">OPT_CALLEE_GO_ON</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a1d0a4362e89e71be70b2ca0d47616c99">OPT_ARG_CALLEE_GO_ON</a>),</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;h&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab0eb8a377bf253cf368bf70f0b59fc31">OPT_CALLEE_HANGUP</a>),</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;H&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9f03cca4e2ee93778ae8ed2db279587d">OPT_CALLER_HANGUP</a>),</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;i&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a8235d5ff2f8003fdb1d20c6876425ebf">OPT_IGNORE_CALL_FW</a>),</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;I&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6ab17f35d26d691c590098350b231988">OPT_IGNORE_CONNECTEDLINE</a>),</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;k&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a35080c34427591a22d34370e0a8ebab4">OPT_CALLEE_PARK</a>),</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;K&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a82c1e40f3b210bce47d00d44dec0b8fd">OPT_CALLER_PARK</a>),</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;n&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9343294711278062e3bcf5b51417ccb4">OPT_NO_RETRY</a>),</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;r&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ad4edc18ee0c5ce6e2af1ed26a64f39ad">OPT_RINGING</a>),</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;R&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae363b1e6b1f2fcb5536719a640aa9dd9">OPT_RING_WHEN_RINGING</a>),</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;t&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6faa363811a3b467116d290d52d967da">OPT_CALLEE_TRANSFER</a>),</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;T&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3adb3ae0c7823e3bd3f4a45db3d03f33cb">OPT_CALLER_TRANSFER</a>),</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;x&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3aa465a2ae8739e3b612225fe15f19c0ad">OPT_CALLEE_AUTOMIXMON</a>),</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;X&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab61ce333627051f88077d9b6d7fb2e06">OPT_CALLER_AUTOMIXMON</a>),</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;w&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6cda8c882997c543030f3dde846f9df3">OPT_CALLEE_AUTOMON</a>),</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;W&#39;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a0c9c1b291152109321095a6734256794">OPT_CALLER_AUTOMON</a>),</div><div class="line"><a name="l01379"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8e71a98f661c0f497104849cd61261ae"> 1379</a></span>&#160;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a2a1890787b3e55318c417c0a3e1432c7">END_OPTIONS</a>);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="keyword">enum</span> {</div><div class="line"><a name="l01382"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396"> 1382</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a> = 0,</div><div class="line"><a name="l01383"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a5ecd46d3615498a0c1f620952b919855"> 1383</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a5ecd46d3615498a0c1f620952b919855">QUEUE_STRATEGY_LEASTRECENT</a>,</div><div class="line"><a name="l01384"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a9b9caf74d13b75b846264a89d5aea9a4"> 1384</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a9b9caf74d13b75b846264a89d5aea9a4">QUEUE_STRATEGY_FEWESTCALLS</a>,</div><div class="line"><a name="l01385"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a89db95f6e97c58cd5915abddc140df70"> 1385</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a89db95f6e97c58cd5915abddc140df70">QUEUE_STRATEGY_RANDOM</a>,</div><div class="line"><a name="l01386"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a"> 1386</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a">QUEUE_STRATEGY_RRMEMORY</a>,</div><div class="line"><a name="l01387"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09"> 1387</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a>,</div><div class="line"><a name="l01388"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67aee8588c59bd53b91d0cebce5faca7a06"> 1388</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67aee8588c59bd53b91d0cebce5faca7a06">QUEUE_STRATEGY_WRANDOM</a>,</div><div class="line"><a name="l01389"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f"> 1389</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f">QUEUE_STRATEGY_RRORDERED</a>,</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;};</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="keyword">enum</span> {</div><div class="line"><a name="l01393"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0"> 1393</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0">QUEUE_AUTOPAUSE_OFF</a> = 0,</div><div class="line"><a name="l01394"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62a92b2b0d4b3b19ef4bd9b02a302f2026b"> 1394</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62a92b2b0d4b3b19ef4bd9b02a302f2026b">QUEUE_AUTOPAUSE_ON</a>,</div><div class="line"><a name="l01395"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62ac02f08ed9358bc830b66ced5c7cda8cd"> 1395</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62ac02f08ed9358bc830b66ced5c7cda8cd">QUEUE_AUTOPAUSE_ALL</a></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;};</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398"> 1398</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398">queue_reload_mask</a> {</div><div class="line"><a name="l01399"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44"> 1399</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44">QUEUE_RELOAD_PARAMETERS</a> = (1 &lt;&lt; 0),</div><div class="line"><a name="l01400"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f"> 1400</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f">QUEUE_RELOAD_MEMBER</a> = (1 &lt;&lt; 1),</div><div class="line"><a name="l01401"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a04da28a6a506fbc6dfce3f3da3569acc"> 1401</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a04da28a6a506fbc6dfce3f3da3569acc">QUEUE_RELOAD_RULES</a> = (1 &lt;&lt; 2),</div><div class="line"><a name="l01402"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c"> 1402</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c">QUEUE_RESET_STATS</a> = (1 &lt;&lt; 3),</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;};</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"><a class="line" href="../../d8/d51/structstrategy.html"> 1405</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d8/d51/structstrategy.html">strategy</a> {</div><div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="../../d8/d51/structstrategy.html#acc89aafdc65ecd15f010b7c6fc295522"> 1406</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d8/d51/structstrategy.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>;</div><div class="line"><a name="l01407"></a><span class="lineno"><a class="line" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb"> 1407</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;} <a class="code" href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a>[] = {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>, <span class="stringliteral">&quot;ringall&quot;</span> },</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a5ecd46d3615498a0c1f620952b919855">QUEUE_STRATEGY_LEASTRECENT</a>, <span class="stringliteral">&quot;leastrecent&quot;</span> },</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a9b9caf74d13b75b846264a89d5aea9a4">QUEUE_STRATEGY_FEWESTCALLS</a>, <span class="stringliteral">&quot;fewestcalls&quot;</span> },</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a89db95f6e97c58cd5915abddc140df70">QUEUE_STRATEGY_RANDOM</a>, <span class="stringliteral">&quot;random&quot;</span> },</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a">QUEUE_STRATEGY_RRMEMORY</a>, <span class="stringliteral">&quot;rrmemory&quot;</span> },</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a">QUEUE_STRATEGY_RRMEMORY</a>, <span class="stringliteral">&quot;roundrobin&quot;</span> },</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a>, <span class="stringliteral">&quot;linear&quot;</span> },</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67aee8588c59bd53b91d0cebce5faca7a06">QUEUE_STRATEGY_WRANDOM</a>, <span class="stringliteral">&quot;wrandom&quot;</span>},</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f">QUEUE_STRATEGY_RRORDERED</a>, <span class="stringliteral">&quot;rrordered&quot;</span>},</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;};</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div><div class="line"><a name="l01420"></a><span class="lineno"><a class="line" href="../../df/dd2/structautopause.html"> 1420</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/dd2/structautopause.html">autopause</a> {</div><div class="line"><a name="l01421"></a><span class="lineno"><a class="line" href="../../df/dd2/structautopause.html#a4092d0238a0a8aa7aeaf503a7f0e6380"> 1421</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/dd2/structautopause.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause</a>;</div><div class="line"><a name="l01422"></a><span class="lineno"><a class="line" href="../../df/dd2/structautopause.html#a8f8f80d37794cde9472343e4487ba3eb"> 1422</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/dd2/structautopause.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;} <a class="code" href="../../da/dfb/app__queue_8c.html#ad7bfd042e07ab221f05374233ec2dcf6">autopausesmodes</a> [] = {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0">QUEUE_AUTOPAUSE_OFF</a>,<span class="stringliteral">&quot;no&quot;</span> },</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62a92b2b0d4b3b19ef4bd9b02a302f2026b">QUEUE_AUTOPAUSE_ON</a>, <span class="stringliteral">&quot;yes&quot;</span> },</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62ac02f08ed9358bc830b66ced5c7cda8cd">QUEUE_AUTOPAUSE_ALL</a>,<span class="stringliteral">&quot;all&quot;</span> },</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;};</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3f1683ed5a30b46922e3f88b7c716e04"> 1429</a></span>&#160;<span class="preprocessor">#define DEFAULT_RETRY      5</span></div><div class="line"><a name="l01430"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aad2dd72565852b91c809cd4685833b17"> 1430</a></span>&#160;<span class="preprocessor">#define DEFAULT_TIMEOUT    15</span></div><div class="line"><a name="l01431"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac483b545204943907eab26ae059e65dd"> 1431</a></span>&#160;<span class="preprocessor">#define RECHECK         1     </span><span class="comment">/*!&lt; Recheck every second to see we we&#39;re at the top yet */</span><span class="preprocessor"></span></div><div class="line"><a name="l01432"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2f5d1f6fb6cd3af5e8b07d19e4ab273a"> 1432</a></span>&#160;<span class="preprocessor">#define MAX_PERIODIC_ANNOUNCEMENTS 10           </span><span class="comment">/*!&lt; The maximum periodic announcements we can have */</span><span class="preprocessor"></span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment"> * \brief The minimum number of seconds between position announcements.</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment"> * \note The default value of 15 provides backwards compatibility.</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01437"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a679ea032e9e26f6e6e569769fb528722"> 1437</a></span>&#160;<span class="preprocessor">#define DEFAULT_MIN_ANNOUNCE_FREQUENCY 15</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a318c21ecadbe981df2771149df1ed361"> 1439</a></span>&#160;<span class="preprocessor">#define MAX_QUEUE_BUCKETS 53</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e"> 1441</a></span>&#160;<span class="preprocessor">#define  RES_OKAY 0     </span><span class="comment">/*!&lt; Action completed */</span><span class="preprocessor"></span></div><div class="line"><a name="l01442"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae"> 1442</a></span>&#160;<span class="preprocessor">#define  RES_EXISTS  (-1)     </span><span class="comment">/*!&lt; Entry already exists */</span><span class="preprocessor"></span></div><div class="line"><a name="l01443"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64"> 1443</a></span>&#160;<span class="preprocessor">#define  RES_OUTOFMEMORY   (-2)     </span><span class="comment">/*!&lt; Out of memory */</span><span class="preprocessor"></span></div><div class="line"><a name="l01444"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81"> 1444</a></span>&#160;<span class="preprocessor">#define  RES_NOSUCHQUEUE   (-3)     </span><span class="comment">/*!&lt; No such queue */</span><span class="preprocessor"></span></div><div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a447a632daaf1a56114da95816c12b8a5"> 1445</a></span>&#160;<span class="preprocessor">#define RES_NOT_DYNAMIC (-4)     </span><span class="comment">/*!&lt; Member is not dynamic */</span><span class="preprocessor"></span></div><div class="line"><a name="l01446"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a1802f66ae1666498af70e9a4ff2e616b"> 1446</a></span>&#160;<span class="preprocessor">#define RES_NOT_CALLER  (-5)     </span><span class="comment">/*!&lt; Caller not found */</span><span class="preprocessor"></span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a"> 1448</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a> = <span class="stringliteral">&quot;Queue&quot;</span>;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae30d56b03bf5537faee32eec7856a2bf"> 1450</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#ae30d56b03bf5537faee32eec7856a2bf">app_aqm</a> = <span class="stringliteral">&quot;AddQueueMember&quot;</span> ;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5a66ec06a1a699e1b7827695ee7fa784"> 1452</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5a66ec06a1a699e1b7827695ee7fa784">app_rqm</a> = <span class="stringliteral">&quot;RemoveQueueMember&quot;</span> ;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a280cd035294778a19581ae7941fd5d09"> 1454</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a280cd035294778a19581ae7941fd5d09">app_pqm</a> = <span class="stringliteral">&quot;PauseQueueMember&quot;</span> ;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a96a36b017bb210c4a0ee72163d7d6baa"> 1456</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a96a36b017bb210c4a0ee72163d7d6baa">app_upqm</a> = <span class="stringliteral">&quot;UnpauseQueueMember&quot;</span> ;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div><div class="line"><a name="l01458"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a499685f064d4f862700499819b42bb0a"> 1458</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a499685f064d4f862700499819b42bb0a">app_ql</a> = <span class="stringliteral">&quot;QueueLog&quot;</span> ;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8e0726d1faabee57a4b66622bd716588"> 1460</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a8e0726d1faabee57a4b66622bd716588">app_qupd</a> = <span class="stringliteral">&quot;QueueUpdate&quot;</span>;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">/*! \brief Persistent Members astdb family */</span></div><div class="line"><a name="l01463"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa03e5b6c636bd0625a52c367067ec906"> 1463</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa03e5b6c636bd0625a52c367067ec906">pm_family</a> = <span class="stringliteral">&quot;Queue/PersistentMembers&quot;</span>;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">/*! \brief queues.conf [general] option */</span></div><div class="line"><a name="l01466"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a24b4217999f5510710cabfc8a8bc8c07"> 1466</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a24b4217999f5510710cabfc8a8bc8c07">queue_persistent_members</a>;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="comment">/*! \brief Records that one or more queues use weight */</span></div><div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ade12aebf511dcd9862a12c4b25dc2216"> 1469</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ade12aebf511dcd9862a12c4b25dc2216">use_weight</a>;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">/*! \brief queues.conf [general] option */</span></div><div class="line"><a name="l01472"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab20962f473e6a8976a3e4e23b90049cc"> 1472</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab20962f473e6a8976a3e4e23b90049cc">autofill_default</a>;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">/*! \brief queues.conf [general] option */</span></div><div class="line"><a name="l01475"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a255e617ba389793f7425d398afe9d557"> 1475</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a255e617ba389793f7425d398afe9d557">montype_default</a>;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">/*! \brief queues.conf [general] option */</span></div><div class="line"><a name="l01478"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8f2df6113ce7f6858cc4e533d6f0f4bf"> 1478</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8f2df6113ce7f6858cc4e533d6f0f4bf">shared_lastcall</a>;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">/*! \brief queuesrules.conf [general] option */</span></div><div class="line"><a name="l01481"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a703a108712f8f7b20303de08a0c4f5ac"> 1481</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a703a108712f8f7b20303de08a0c4f5ac">realtime_rules</a>;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">/*! \brief Subscription to device state change messages */</span></div><div class="line"><a name="l01484"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ace475b3c63f137d8ff9af0e10d4f5e97"> 1484</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ace475b3c63f137d8ff9af0e10d4f5e97">device_state_sub</a>;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">/*! \brief queues.conf [general] option */</span></div><div class="line"><a name="l01487"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a60c2c6eafb4f5d6b7abf2ef596191843"> 1487</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a60c2c6eafb4f5d6b7abf2ef596191843">negative_penalty_invalid</a>;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">/*! \brief queues.conf [general] option */</span></div><div class="line"><a name="l01490"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa1cb8ea53e09c5d7d32b81c3e7a88b7c"> 1490</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa1cb8ea53e09c5d7d32b81c3e7a88b7c">log_membername_as_agent</a>;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">/*! \brief name of the ringinuse field in the realtime database */</span></div><div class="line"><a name="l01493"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2cd3616d2484da0e9bc9442ebfba0d7e"> 1493</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a2cd3616d2484da0e9bc9442ebfba0d7e">realtime_ringinuse_field</a>;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div><div class="line"><a name="l01495"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2"> 1495</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2">queue_result</a> {</div><div class="line"><a name="l01496"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c"> 1496</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c">QUEUE_UNKNOWN</a> = 0,</div><div class="line"><a name="l01497"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d"> 1497</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a> = 1,</div><div class="line"><a name="l01498"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aed848300d343eb61491e3ddc2e562b9e"> 1498</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aed848300d343eb61491e3ddc2e562b9e">QUEUE_JOINEMPTY</a> = 2,</div><div class="line"><a name="l01499"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101"> 1499</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101">QUEUE_LEAVEEMPTY</a> = 3,</div><div class="line"><a name="l01500"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2adcb9aca3157b3a850bae64788f6593cd"> 1500</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2adcb9aca3157b3a850bae64788f6593cd">QUEUE_JOINUNAVAIL</a> = 4,</div><div class="line"><a name="l01501"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aa4eb95a01ce1882ef6fe8fc0b7626e2b"> 1501</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aa4eb95a01ce1882ef6fe8fc0b7626e2b">QUEUE_LEAVEUNAVAIL</a> = 5,</div><div class="line"><a name="l01502"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a131d9c4fe1d72d7b5f8532708ae18285"> 1502</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a131d9c4fe1d72d7b5f8532708ae18285">QUEUE_FULL</a> = 6,</div><div class="line"><a name="l01503"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a7d363853794316b276622be186ead6f0"> 1503</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a7d363853794316b276622be186ead6f0">QUEUE_CONTINUE</a> = 7,</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;};</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l01507"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1"> 1507</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2">queue_result</a> <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l01508"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b"> 1508</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;} <a class="code" href="../../da/dfb/app__queue_8c.html#a541a1e91d9ec3ef9f489b63a57413c3e">queue_results</a>[] = {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c">QUEUE_UNKNOWN</a>, <span class="stringliteral">&quot;UNKNOWN&quot;</span> },</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>, <span class="stringliteral">&quot;TIMEOUT&quot;</span> },</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aed848300d343eb61491e3ddc2e562b9e">QUEUE_JOINEMPTY</a>,<span class="stringliteral">&quot;JOINEMPTY&quot;</span> },</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101">QUEUE_LEAVEEMPTY</a>, <span class="stringliteral">&quot;LEAVEEMPTY&quot;</span> },</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2adcb9aca3157b3a850bae64788f6593cd">QUEUE_JOINUNAVAIL</a>, <span class="stringliteral">&quot;JOINUNAVAIL&quot;</span> },</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aa4eb95a01ce1882ef6fe8fc0b7626e2b">QUEUE_LEAVEUNAVAIL</a>, <span class="stringliteral">&quot;LEAVEUNAVAIL&quot;</span> },</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a131d9c4fe1d72d7b5f8532708ae18285">QUEUE_FULL</a>, <span class="stringliteral">&quot;FULL&quot;</span> },</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;   { <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a7d363853794316b276622be186ead6f0">QUEUE_CONTINUE</a>, <span class="stringliteral">&quot;CONTINUE&quot;</span> },</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;};</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844"> 1520</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844">queue_timeout_priority</a> {</div><div class="line"><a name="l01521"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844aabaf51de14755cf9b47a42c3cc460a87"> 1521</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844aabaf51de14755cf9b47a42c3cc460a87">TIMEOUT_PRIORITY_APP</a>,</div><div class="line"><a name="l01522"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844a94a7510a93b7241883228503227335af"> 1522</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844a94a7510a93b7241883228503227335af">TIMEOUT_PRIORITY_CONF</a>,</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;};</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">/*! \brief We define a custom &quot;local user&quot; structure because we</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment"> *  use it not only for keeping track of what is in use but</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment"> *  also for keeping track of who we&#39;re dialing.</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment"> *  There are two &quot;links&quot; defined in this structure, q_next and call_next.</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment"> *  q_next links ALL defined callattempt structures into a linked list. call_next is</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment"> *  a link which allows for a subset of the callattempts to be traversed. This subset</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment"> *  is used in wait_for_answer so that irrelevant callattempts are not traversed. This</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment"> *  also is helpful so that queue logs are always accurate in the case where a call to</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment"> *  a member times out, especially if using the ringall strategy.</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html"> 1537</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> {</div><div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326"> 1538</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>;</div><div class="line"><a name="l01539"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b"> 1539</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">call_next</a>;</div><div class="line"><a name="l01540"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7"> 1540</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69"> 1541</a></span>&#160;   <span class="keywordtype">char</span> interface[256];       <span class="comment">/*!&lt; An Asterisk dial string (not a channel name) */</span></div><div class="line"><a name="l01542"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8"> 1542</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a>;</div><div class="line"><a name="l01543"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4"> 1543</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>;<span class="comment"></span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">   /*! Saved connected party info from an AST_CONTROL_CONNECTED_LINE. */</span></div><div class="line"><a name="l01545"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566"> 1545</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a414b69d7583bb4cfc6daf5276aac6d14">connected</a>;<span class="comment"></span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">   /*! TRUE if an AST_CONTROL_CONNECTED_LINE update was saved to the connected element. */</span></div><div class="line"><a name="l01547"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2"> 1547</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2">pending_connected_update</a>:1;<span class="comment"></span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">   /*! TRUE if the connected line update is blocked. */</span></div><div class="line"><a name="l01549"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f"> 1549</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>:1;<span class="comment"></span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">   /*! TRUE if caller id is not available for connected line */</span></div><div class="line"><a name="l01551"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642"> 1551</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642">dial_callerid_absent</a>:1;<span class="comment"></span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">   /*! TRUE if the call is still active */</span></div><div class="line"><a name="l01553"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37"> 1553</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a>:1;</div><div class="line"><a name="l01554"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd"> 1554</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dca/structast__aoc__decoded.html">ast_aoc_decoded</a> *<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a>;<span class="comment"></span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">   /*! Original channel name.  Must be freed.  Could be NULL if allocation failed. */</span></div><div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41"> 1556</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a>;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;};</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html"> 1560</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> {</div><div class="line"><a name="l01561"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab"> 1561</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>;             <span class="comment">/*!&lt; What queue is our parent */</span></div><div class="line"><a name="l01562"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542"> 1562</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../df/db5/structcall__queue.html#a6c0ebcc78965d8817651856e7914631d">moh</a>[<a class="code" href="../../d5/d7b/channel_8h.html#afb2ae2e53d6676f3ca44a98aa3f92a2c">MAX_MUSICCLASS</a>];              <span class="comment">/*!&lt; Name of musiconhold to be used */</span></div><div class="line"><a name="l01563"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#aa774cd5d9be3c23ac43ab1798f437339"> 1563</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../df/db5/structcall__queue.html#aed4d53167e5f2010bf8eca8f645c3745">announce</a>[<a class="code" href="../../db/db2/asterisk_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];               <span class="comment">/*!&lt; Announcement to play for member when call is answered */</span></div><div class="line"><a name="l01564"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ac25ea00ee3f082df06e0cf468cbde240"> 1564</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>[<a class="code" href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a>];         <span class="comment">/*!&lt; Context when user exits queue */</span></div><div class="line"><a name="l01565"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca"> 1565</a></span>&#160;   <span class="keywordtype">char</span> digits[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];        <span class="comment">/*!&lt; Digits entered while in queue */</span></div><div class="line"><a name="l01566"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f"> 1566</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a>;            <span class="comment">/*!&lt; Gosub app arguments for outgoing calls.  NULL if not supplied. */</span></div><div class="line"><a name="l01567"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a12851de4518c71edbf5c5adb40976629"> 1567</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a12851de4518c71edbf5c5adb40976629">valid_digits</a>;                      <span class="comment">/*!&lt; Digits entered correspond to valid extension. Exited */</span></div><div class="line"><a name="l01568"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823"> 1568</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>;                               <span class="comment">/*!&lt; Where we are in the queue */</span></div><div class="line"><a name="l01569"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659"> 1569</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a>;                              <span class="comment">/*!&lt; Our priority */</span></div><div class="line"><a name="l01570"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ac019537a959f6147cecffb126bb04381"> 1570</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#ac019537a959f6147cecffb126bb04381">last_pos_said</a>;                     <span class="comment">/*!&lt; Last position we told the user */</span></div><div class="line"><a name="l01571"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a93d5d1c5d8bf62627163cd9e53ed5048"> 1571</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a93d5d1c5d8bf62627163cd9e53ed5048">ring_when_ringing</a>;                 <span class="comment">/*!&lt; Should we only use ring indication when a channel is ringing? */</span></div><div class="line"><a name="l01572"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a26f62e545090b51f4c7e8efbf2db8d6b"> 1572</a></span>&#160;   time_t <a class="code" href="../../dc/d79/structqueue__ent.html#a26f62e545090b51f4c7e8efbf2db8d6b">last_periodic_announce_time</a>;    <span class="comment">/*!&lt; The last time we played a periodic announcement */</span></div><div class="line"><a name="l01573"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b"> 1573</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a>;      <span class="comment">/*!&lt; The last periodic announcement we made */</span></div><div class="line"><a name="l01574"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6"> 1574</a></span>&#160;   time_t <a class="code" href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6">last_pos</a>;                       <span class="comment">/*!&lt; Last time we told the user their position */</span></div><div class="line"><a name="l01575"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c"> 1575</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>;                              <span class="comment">/*!&lt; Where we started in the queue */</span></div><div class="line"><a name="l01576"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ab234be20f2e48f4f08d2d2c071b8ff55"> 1576</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#ab234be20f2e48f4f08d2d2c071b8ff55">handled</a>;                           <span class="comment">/*!&lt; Whether our call was handled */</span></div><div class="line"><a name="l01577"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a79ec26d453dcd29aec17f5536233e849"> 1577</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a79ec26d453dcd29aec17f5536233e849">pending</a>;                           <span class="comment">/*!&lt; Non-zero if we are attempting to call a member */</span></div><div class="line"><a name="l01578"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc"> 1578</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>;                       <span class="comment">/*!&lt; Limit the members that can take this call to this penalty or lower */</span></div><div class="line"><a name="l01579"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125"> 1579</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>;                       <span class="comment">/*!&lt; Limit the members that can take this call to this penalty or higher */</span></div><div class="line"><a name="l01580"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53"> 1580</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>;                     <span class="comment">/*!&lt; Float lower penalty mambers to a minimum penalty */</span></div><div class="line"><a name="l01581"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930"> 1581</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930">linpos</a>;                            <span class="comment">/*!&lt; If using linear strategy, what position are we at? */</span></div><div class="line"><a name="l01582"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ab552667d2252975f206fb8a8af49888a"> 1582</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#ab552667d2252975f206fb8a8af49888a">linwrapped</a>;                        <span class="comment">/*!&lt; Is the linpos wrapped? */</span></div><div class="line"><a name="l01583"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee"> 1583</a></span>&#160;   time_t <a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>;                          <span class="comment">/*!&lt; When we started holding */</span></div><div class="line"><a name="l01584"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e"> 1584</a></span>&#160;   time_t <a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>;                         <span class="comment">/*!&lt; When this entry should expire (time out of queue) */</span></div><div class="line"><a name="l01585"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517"> 1585</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517">cancel_answered_elsewhere</a>;         <span class="comment">/*!&lt; Whether we should force the CAE flag on this call (C) option*/</span></div><div class="line"><a name="l01586"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7"> 1586</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;              <span class="comment">/*!&lt; Our channel */</span></div><div class="line"><a name="l01587"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a1cb2482eab55003bdab45c5969730757"> 1587</a></span>&#160;   <a class="code" href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a>(,<a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a>) qe_rules; <span class="comment">/*!&lt; Local copy of the queue&#39;s penalty rules */</span></div><div class="line"><a name="l01588"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9"> 1588</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>;               <span class="comment">/*!&lt; Pointer to the next penalty rule to implement */</span></div><div class="line"><a name="l01589"></a><span class="lineno"><a class="line" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7"> 1589</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>;                <span class="comment">/*!&lt; The next queue entry */</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;};</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html"> 1592</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> {</div><div class="line"><a name="l01593"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89"> 1593</a></span>&#160;   <span class="keywordtype">char</span> interface[<a class="code" href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a>];    <span class="comment">/*!&lt; Technology/Location to dial to reach this member*/</span></div><div class="line"><a name="l01594"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd"> 1594</a></span>&#160;   <span class="keywordtype">char</span> state_exten[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>]; <span class="comment">/*!&lt; Extension to get state from (if using hint) */</span></div><div class="line"><a name="l01595"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#aa99dee44b85aa7057ed5bea20fa2bb52"> 1595</a></span>&#160;   <span class="keywordtype">char</span> state_context[<a class="code" href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a>]; <span class="comment">/*!&lt; Context to use when getting state (if using hint) */</span></div><div class="line"><a name="l01596"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de"> 1596</a></span>&#160;   <span class="keywordtype">char</span> state_interface[<a class="code" href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a>]; <span class="comment">/*!&lt; Technology/Location from which to read devicestate changes */</span></div><div class="line"><a name="l01597"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#ab755590c3f680079c572a5176366c8fe"> 1597</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#ab755590c3f680079c572a5176366c8fe">state_id</a>;                        <span class="comment">/*!&lt; Extension state callback id (if using hint) */</span></div><div class="line"><a name="l01598"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15"> 1598</a></span>&#160;   <span class="keywordtype">char</span> membername[80];                 <span class="comment">/*!&lt; Member name to use in queue logs */</span></div><div class="line"><a name="l01599"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640"> 1599</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;                         <span class="comment">/*!&lt; Are we a last resort? */</span></div><div class="line"><a name="l01600"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab"> 1600</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>;                           <span class="comment">/*!&lt; Number of calls serviced by this member */</span></div><div class="line"><a name="l01601"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d"> 1601</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a>;                         <span class="comment">/*!&lt; Are we dynamically added? */</span></div><div class="line"><a name="l01602"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1"> 1602</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>;                        <span class="comment">/*!&lt; Is this member realtime? */</span></div><div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00"> 1603</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>;                          <span class="comment">/*!&lt; Status of queue member */</span></div><div class="line"><a name="l01604"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175"> 1604</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>;                          <span class="comment">/*!&lt; Are we paused (not accepting calls)? */</span></div><div class="line"><a name="l01605"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679"> 1605</a></span>&#160;   <span class="keywordtype">char</span> reason_paused[80];              <span class="comment">/*!&lt; Reason of paused if member is paused */</span></div><div class="line"><a name="l01606"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c"> 1606</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a>;                        <span class="comment">/*!&lt; In what order (pertains to certain strategies) should this member be called? */</span></div><div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab"> 1607</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>;               <span class="comment">/*!&lt; Whether the current call was completed within service level */</span></div><div class="line"><a name="l01608"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6"> 1608</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;                      <span class="comment">/*!&lt; Wrapup Time */</span></div><div class="line"><a name="l01609"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8"> 1609</a></span>&#160;   time_t <a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>;                    <span class="comment">/*!&lt; The time at which the member answered the current caller. */</span></div><div class="line"><a name="l01610"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d"> 1610</a></span>&#160;   time_t <a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>;                     <span class="comment">/*!&lt; When last successful call was hungup */</span></div><div class="line"><a name="l01611"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5"> 1611</a></span>&#160;   time_t <a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a>;                    <span class="comment">/*!&lt; When started the last pause */</span></div><div class="line"><a name="l01612"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4"> 1612</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a>;        <span class="comment">/*!&lt; Last queue we received a call */</span></div><div class="line"><a name="l01613"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6"> 1613</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>:1;                 <span class="comment">/*!&lt; Used to detect members deleted in realtime */</span></div><div class="line"><a name="l01614"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a22ed1f20028b26f7ece35aeec695293f"> 1614</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a22ed1f20028b26f7ece35aeec695293f">delme</a>:1;                <span class="comment">/*!&lt; Flag to delete entry on reload */</span></div><div class="line"><a name="l01615"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23"> 1615</a></span>&#160;   <span class="keywordtype">char</span> rt_uniqueid[80];                <span class="comment">/*!&lt; Unique id of realtime member entry */</span></div><div class="line"><a name="l01616"></a><span class="lineno"><a class="line" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298"> 1616</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>:1;            <span class="comment">/*!&lt; Flag to ring queue members even if their status is &#39;inuse&#39; */</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;};</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6"> 1619</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6">empty_conditions</a> {</div><div class="line"><a name="l01620"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4"> 1620</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4">QUEUE_EMPTY_PENALTY</a> = (1 &lt;&lt; 0),</div><div class="line"><a name="l01621"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c"> 1621</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c">QUEUE_EMPTY_PAUSED</a> = (1 &lt;&lt; 1),</div><div class="line"><a name="l01622"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a85b9e406efa42c21f44d6f5b3ae9b332"> 1622</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a85b9e406efa42c21f44d6f5b3ae9b332">QUEUE_EMPTY_INUSE</a> = (1 &lt;&lt; 2),</div><div class="line"><a name="l01623"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a6dd24d66d8fcdf0a3444d28ec9c82ba2"> 1623</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a6dd24d66d8fcdf0a3444d28ec9c82ba2">QUEUE_EMPTY_RINGING</a> = (1 &lt;&lt; 3),</div><div class="line"><a name="l01624"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6adfcf6310d20a8088a392ea40fa381e09"> 1624</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6adfcf6310d20a8088a392ea40fa381e09">QUEUE_EMPTY_UNAVAILABLE</a> = (1 &lt;&lt; 4),</div><div class="line"><a name="l01625"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af"> 1625</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af">QUEUE_EMPTY_INVALID</a> = (1 &lt;&lt; 5),</div><div class="line"><a name="l01626"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1532fb860aed655673cca9f18f44a7d1"> 1626</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1532fb860aed655673cca9f18f44a7d1">QUEUE_EMPTY_UNKNOWN</a> = (1 &lt;&lt; 6),</div><div class="line"><a name="l01627"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6aec193cf33d944aed4807b36eefdbc1d1"> 1627</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6aec193cf33d944aed4807b36eefdbc1d1">QUEUE_EMPTY_WRAPUP</a> = (1 &lt;&lt; 7),</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;};</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7"> 1630</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7">member_properties</a> {</div><div class="line"><a name="l01631"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3"> 1631</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a> = 0,</div><div class="line"><a name="l01632"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b"> 1632</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b">MEMBER_RINGINUSE</a> = 1,</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;};</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">/* values used in multi-bit flags in call_queue */</span></div><div class="line"><a name="l01636"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8e57e0916b189a3a78e018cc14e8cb1b"> 1636</a></span>&#160;<span class="preprocessor">#define ANNOUNCEHOLDTIME_ALWAYS 1</span></div><div class="line"><a name="l01637"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab37e1a4dafc93b1ded1edabe9927cf26"> 1637</a></span>&#160;<span class="preprocessor">#define ANNOUNCEHOLDTIME_ONCE 2</span></div><div class="line"><a name="l01638"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a533ee4344c442cf6da3e610598ecca75"> 1638</a></span>&#160;<span class="preprocessor">#define QUEUE_EVENT_VARIABLES 3</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div><div class="line"><a name="l01640"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html"> 1640</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> {</div><div class="line"><a name="l01641"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670"> 1641</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>;                           <span class="comment">/*!&lt; Number of seconds that need to pass before applying this rule */</span></div><div class="line"><a name="l01642"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84"> 1642</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a>;                      <span class="comment">/*!&lt; The amount specified in the penalty rule for max penalty */</span></div><div class="line"><a name="l01643"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666"> 1643</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a>;                      <span class="comment">/*!&lt; The amount specified in the penalty rule for min penalty */</span></div><div class="line"><a name="l01644"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da"> 1644</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a>;                      <span class="comment">/*!&lt; The amount specified in the penalty rule for min penalty */</span></div><div class="line"><a name="l01645"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb"> 1645</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a>;                   <span class="comment">/*!&lt; Is the max adjustment relative? 1 for relative, 0 for absolute */</span></div><div class="line"><a name="l01646"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4"> 1646</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a>;                   <span class="comment">/*!&lt; Is the min adjustment relative? 1 for relative, 0 for absolute */</span></div><div class="line"><a name="l01647"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204"> 1647</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a>;                   <span class="comment">/*!&lt; Is the min adjustment relative? 1 for relative, 0 for absolute */</span></div><div class="line"><a name="l01648"></a><span class="lineno"><a class="line" href="../../d5/dd5/structpenalty__rule.html#ab141d56d128f1e47ea21b938bf14297a"> 1648</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a>) list;  <span class="comment">/*!&lt; Next penalty_rule */</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;};</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div><div class="line"><a name="l01651"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae19c02c3c0ba9ca01d7ede746f736c45"> 1651</a></span>&#160;<span class="preprocessor">#define ANNOUNCEPOSITION_YES 1 </span><span class="comment">/*!&lt; We announce position */</span><span class="preprocessor"></span></div><div class="line"><a name="l01652"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a52464c2ddf292a0a9c91cfc7481b0178"> 1652</a></span>&#160;<span class="preprocessor">#define ANNOUNCEPOSITION_NO 2 </span><span class="comment">/*!&lt; We don&#39;t announce position */</span><span class="preprocessor"></span></div><div class="line"><a name="l01653"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a183dcea5fd32422d981d4705cd770b15"> 1653</a></span>&#160;<span class="preprocessor">#define ANNOUNCEPOSITION_MORE_THAN 3 </span><span class="comment">/*!&lt; We say &quot;Currently there are more than &lt;limit&gt;&quot; */</span><span class="preprocessor"></span></div><div class="line"><a name="l01654"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a967650811eabe6b6373dddc731a286eb"> 1654</a></span>&#160;<span class="preprocessor">#define ANNOUNCEPOSITION_LIMIT 4 </span><span class="comment">/*!&lt; We not announce position more than &lt;limit&gt; */</span><span class="preprocessor"></span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div><div class="line"><a name="l01656"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html"> 1656</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> {</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a>(<span class="comment"></span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">      /*! Queue name */</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);<span class="comment"></span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">      /*! Music on Hold class */</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(moh);<span class="comment"></span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">      /*! Announcement to play when call is answered */</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(announce);<span class="comment"></span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">      /*! Exit context */</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>);<span class="comment"></span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">      /*! Macro to run upon member connection */</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(membermacro);<span class="comment"></span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">      /*! Gosub to run upon member connection */</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(membergosub);<span class="comment"></span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment">      /*! Default rule to use if none specified in call to Queue() */</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(defaultrule);<span class="comment"></span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="comment">      /*! Sound file: &quot;Your call is now first in line&quot; (def. queue-youarenext) */</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_next);<span class="comment"></span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="comment">      /*! Sound file: &quot;There are currently&quot; (def. queue-thereare) */</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_thereare);<span class="comment"></span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">      /*! Sound file: &quot;calls waiting to speak to a representative.&quot; (def. queue-callswaiting) */</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_calls);<span class="comment"></span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">      /*! Sound file: &quot;Currently there are more than&quot; (def. queue-quantity1) */</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(queue_quantity1);<span class="comment"></span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">      /*! Sound file: &quot;callers waiting to speak with a representative&quot; (def. queue-quantity2) */</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(queue_quantity2);<span class="comment"></span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">      /*! Sound file: &quot;The current estimated total holdtime is&quot; (def. queue-holdtime) */</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_holdtime);<span class="comment"></span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">      /*! Sound file: &quot;minutes.&quot; (def. queue-minutes) */</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_minutes);<span class="comment"></span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="comment">      /*! Sound file: &quot;minute.&quot; (def. queue-minute) */</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_minute);<span class="comment"></span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="comment">      /*! Sound file: &quot;seconds.&quot; (def. queue-seconds) */</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_seconds);<span class="comment"></span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">      /*! Sound file: &quot;Thank you for your patience.&quot; (def. queue-thankyou) */</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_thanks);<span class="comment"></span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">      /*! Sound file: Custom announce for caller, no default */</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_callerannounce);<span class="comment"></span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">      /*! Sound file: &quot;Hold time&quot; (def. queue-reporthold) */</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(sound_reporthold);</div><div class="line"><a name="l01696"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a0869cb7961f7e245b3b7f8ece1457d5f"> 1696</a></span>&#160;   );<span class="comment"></span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">   /*! Sound files: Custom announce, no default */</span></div><div class="line"><a name="l01698"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953"> 1698</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *sound_periodicannounce[<a class="code" href="../../da/dfb/app__queue_8c.html#a2f5d1f6fb6cd3af5e8b07d19e4ab273a">MAX_PERIODIC_ANNOUNCEMENTS</a>];</div><div class="line"><a name="l01699"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6"> 1699</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>:1;</div><div class="line"><a name="l01700"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298"> 1700</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>:1;</div><div class="line"><a name="l01701"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a34c5860043ef96a75828b7107fcffb17"> 1701</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a34c5860043ef96a75828b7107fcffb17">announce_to_first_user</a>:1; <span class="comment">/*!&lt; Whether or not we announce to the first user in a queue */</span></div><div class="line"><a name="l01702"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a0c5bcd98bca1c3085183ba1fc80195ed"> 1702</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a0c5bcd98bca1c3085183ba1fc80195ed">setinterfacevar</a>:1;</div><div class="line"><a name="l01703"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a32794c302b9a60821d519f6d4d1e7885"> 1703</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a32794c302b9a60821d519f6d4d1e7885">setqueuevar</a>:1;</div><div class="line"><a name="l01704"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a23486e86a21295aa734885d335ae9c2f"> 1704</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a23486e86a21295aa734885d335ae9c2f">setqueueentryvar</a>:1;</div><div class="line"><a name="l01705"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a20ba21c586c791a31ef97102b4811a8f"> 1705</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a20ba21c586c791a31ef97102b4811a8f">reportholdtime</a>:1;</div><div class="line"><a name="l01706"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#ac3419e9b31cb1aebe3666439449bcecc"> 1706</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#ac3419e9b31cb1aebe3666439449bcecc">wrapped</a>:1;</div><div class="line"><a name="l01707"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb"> 1707</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb">timeoutrestart</a>:1;</div><div class="line"><a name="l01708"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33"> 1708</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a>:2;</div><div class="line"><a name="l01709"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c"> 1709</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a>:3;</div><div class="line"><a name="l01710"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a2e7cadcc5625b17fdd07051a07a3773c"> 1710</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a2e7cadcc5625b17fdd07051a07a3773c">announceposition_only_up</a>:1; <span class="comment">/*!&lt; Only announce position if it has improved */</span></div><div class="line"><a name="l01711"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522"> 1711</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>:4;</div><div class="line"><a name="l01712"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4"> 1712</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a>:1;</div><div class="line"><a name="l01713"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706"> 1713</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a>:1;</div><div class="line"><a name="l01714"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#afca2abcaa89f99883d526c469268bcf4"> 1714</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#afca2abcaa89f99883d526c469268bcf4">relativeperiodicannounce</a>:1;</div><div class="line"><a name="l01715"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#ae71026599525356a453ca8f5b2fd9bb0"> 1715</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#ae71026599525356a453ca8f5b2fd9bb0">autopausebusy</a>:1;</div><div class="line"><a name="l01716"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a02a24815c7591a8655446b75e8dbaadd"> 1716</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a02a24815c7591a8655446b75e8dbaadd">autopauseunavail</a>:1;</div><div class="line"><a name="l01717"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#ab95f2fa73d00493b2fa1fc26eb37dc24"> 1717</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6">empty_conditions</a> joinempty;</div><div class="line"><a name="l01718"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016"> 1718</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6">empty_conditions</a> leavewhenempty;</div><div class="line"><a name="l01719"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6"> 1719</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6">announcepositionlimit</a>;          <span class="comment">/*!&lt; How many positions we announce? */</span></div><div class="line"><a name="l01720"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb"> 1720</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb">announcefrequency</a>;              <span class="comment">/*!&lt; How often to announce their position */</span></div><div class="line"><a name="l01721"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a7724cd5a7395de6d0cbc7f0a02b0c20a"> 1721</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a7724cd5a7395de6d0cbc7f0a02b0c20a">minannouncefrequency</a>;           <span class="comment">/*!&lt; The minimum number of seconds between position announcements (def. 15) */</span></div><div class="line"><a name="l01722"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132"> 1722</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132">periodicannouncefrequency</a>;      <span class="comment">/*!&lt; How often to play periodic announcement */</span></div><div class="line"><a name="l01723"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681"> 1723</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">numperiodicannounce</a>;            <span class="comment">/*!&lt; The number of periodic announcements configured */</span></div><div class="line"><a name="l01724"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a3991228a9e7540246c6cc4cf42c0794d"> 1724</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a3991228a9e7540246c6cc4cf42c0794d">randomperiodicannounce</a>;         <span class="comment">/*!&lt; Are periodic announcments randomly chosen */</span></div><div class="line"><a name="l01725"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302"> 1725</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a>;                <span class="comment">/*!&lt; How many seconds do we round to? */</span></div><div class="line"><a name="l01726"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1"> 1726</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a>;                       <span class="comment">/*!&lt; Current avg holdtime, based on an exponential average */</span></div><div class="line"><a name="l01727"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c"> 1727</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>;                       <span class="comment">/*!&lt; Current avg talktime, based on the same exponential average */</span></div><div class="line"><a name="l01728"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53"> 1728</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>;                 <span class="comment">/*!&lt; Number of queue calls completed */</span></div><div class="line"><a name="l01729"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f"> 1729</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>;                 <span class="comment">/*!&lt; Number of queue calls abandoned */</span></div><div class="line"><a name="l01730"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a9d7f2e93f4bdd39ea6aa5eeaa02f0066"> 1730</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a9d7f2e93f4bdd39ea6aa5eeaa02f0066">callsabandonedinsl</a>;             <span class="comment">/*!&lt; Number of queue calls abandoned in servicelevel */</span></div><div class="line"><a name="l01731"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856"> 1731</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>;                   <span class="comment">/*!&lt; seconds setting for servicelevel*/</span></div><div class="line"><a name="l01732"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8"> 1732</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a>;             <span class="comment">/*!&lt; Number of calls answered with servicelevel*/</span></div><div class="line"><a name="l01733"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e"> 1733</a></span>&#160;   <span class="keywordtype">char</span> monfmt[8];                     <span class="comment">/*!&lt; Format to use when recording calls */</span></div><div class="line"><a name="l01734"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a7ccaa047c703f95f5eaf0dd0a10670b5"> 1734</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a7ccaa047c703f95f5eaf0dd0a10670b5">montype</a>;                        <span class="comment">/*!&lt; Monitor type  Monitor vs. MixMonitor */</span></div><div class="line"><a name="l01735"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf"> 1735</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;                          <span class="comment">/*!&lt; How many entries */</span></div><div class="line"><a name="l01736"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb"> 1736</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a>;                         <span class="comment">/*!&lt; Max number of entries */</span></div><div class="line"><a name="l01737"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a9298f7c0bf15cf275f4664d6959a6da6"> 1737</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;                     <span class="comment">/*!&lt; Wrapup Time */</span></div><div class="line"><a name="l01738"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039"> 1738</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039">penaltymemberslimit</a>;            <span class="comment">/*!&lt; Disregard penalty when queue has fewer than this many members */</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b"> 1740</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b">retry</a>;                          <span class="comment">/*!&lt; Retry calling everyone after this amount of time */</span></div><div class="line"><a name="l01741"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82"> 1741</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;                        <span class="comment">/*!&lt; How long to wait for an answer */</span></div><div class="line"><a name="l01742"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c"> 1742</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a>;                         <span class="comment">/*!&lt; Respective weight */</span></div><div class="line"><a name="l01743"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a4092d0238a0a8aa7aeaf503a7f0e6380"> 1743</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause</a>;                      <span class="comment">/*!&lt; Auto pause queue members if they fail to answer */</span></div><div class="line"><a name="l01744"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#aef5bac7c1f7fa063b8707596001536dd"> 1744</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#aef5bac7c1f7fa063b8707596001536dd">autopausedelay</a>;                 <span class="comment">/*!&lt; Delay auto pause for autopausedelay seconds since last call */</span></div><div class="line"><a name="l01745"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#af983858a2192f96c9a30e44467b87f61"> 1745</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#af983858a2192f96c9a30e44467b87f61">timeoutpriority</a>;                <span class="comment">/*!&lt; Do we allow a fraction of the timeout to occur for a ring? */</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   <span class="comment">/* Queue strategy things */</span></div><div class="line"><a name="l01748"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b"> 1748</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a>;                          <span class="comment">/*!&lt; Round Robin - position */</span></div><div class="line"><a name="l01749"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e"> 1749</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">memberdelay</a>;                    <span class="comment">/*!&lt; Seconds to delay connecting member to caller */</span></div><div class="line"><a name="l01750"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a76e20f3c9df399ad87bb4e45c7419e99"> 1750</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a76e20f3c9df399ad87bb4e45c7419e99">autofill</a>;                       <span class="comment">/*!&lt; Ignore the head call status and ring an available agent */</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div><div class="line"><a name="l01752"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16"> 1752</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>;      <span class="comment">/*!&lt; Head of the list of members */</span></div><div class="line"><a name="l01753"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed"> 1753</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>;             <span class="comment">/*!&lt; Head of the list of callers */</span></div><div class="line"><a name="l01754"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#aa74471edef1a5a911400616c7c5959c0"> 1754</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../df/db5/structcall__queue.html">call_queue</a>) list;    <span class="comment">/*!&lt; Next call queue */</span></div><div class="line"><a name="l01755"></a><span class="lineno"><a class="line" href="../../df/db5/structcall__queue.html#a1cb2482eab55003bdab45c5969730757"> 1755</a></span>&#160;   <a class="code" href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a>(, <a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a>) rules; <span class="comment">/*!&lt; The list of penalty rules to invoke */</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;};</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"><a class="line" href="../../d8/de5/structrule__list.html"> 1758</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> {</div><div class="line"><a name="l01759"></a><span class="lineno"><a class="line" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149"> 1759</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>[80];</div><div class="line"><a name="l01760"></a><span class="lineno"><a class="line" href="../../d8/de5/structrule__list.html#a1cb2482eab55003bdab45c5969730757"> 1760</a></span>&#160;   <a class="code" href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a>(,<a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a>) rules;</div><div class="line"><a name="l01761"></a><span class="lineno"><a class="line" href="../../d8/de5/structrule__list.html#ae406b6937b6a022cac612da429019b4f"> 1761</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../d8/de5/structrule__list.html">rule_list</a>) list;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;};</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"><a class="line" href="../../dd/d61/structrule__lists.html#adf04f66344e3fb0a6f6a69bf39d19902"> 1764</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d90/linkedlists_8h.html#a10f9ed9242a397abf76de1ed1fa33c3b">AST_LIST_HEAD_STATIC</a>(<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, <a class="code" href="../../d8/de5/structrule__list.html">rule_list</a>);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div><div class="line"><a name="l01766"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a60c18ff0a82f2460a253a69179aa9534"> 1766</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a60c18ff0a82f2460a253a69179aa9534">queues</a>;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad4d94a7a9e04ddf7984d69a8737221f9">update_realtime_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q);</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *reason, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3">update_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>, time_t <a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>);</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#aa9439de0855115f7361b2ca30ce71af1">find_member_by_queuename_and_interface</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);<span class="comment"></span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">/*! \brief sets the QUEUESTATUS channel variable */</span></div><div class="line"><a name="l01775"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a30fd2efd3517fe2537656bdd18a09c6f"> 1775</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a30fd2efd3517fe2537656bdd18a09c6f">set_queue_result</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2">queue_result</a> res)</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;{</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a541a1e91d9ec3ef9f489b63a57413c3e">queue_results</a>); i++) {</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a541a1e91d9ec3ef9f489b63a57413c3e">queue_results</a>[i].<span class="keywordtype">id</span> == res) {</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;QUEUESTATUS&quot;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a541a1e91d9ec3ef9f489b63a57413c3e">queue_results</a>[i].<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>);</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      }</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;   }</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;}</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div><div class="line"><a name="l01787"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a792b5d8a5231db2f05b08bd73d318ea5"> 1787</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a792b5d8a5231db2f05b08bd73d318ea5">int2strat</a>(<span class="keywordtype">int</span> <a class="code" href="../../d8/d51/structstrategy.html">strategy</a>)</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;{</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a>); x++) {</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordflow">if</span> (strategy == <a class="code" href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a>[x].strategy) {</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a>[x].<a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      }</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;   }</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;   <span class="keywordflow">return</span> <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;}</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aeee3b4385050286dedc0e20f247d428c"> 1800</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aeee3b4385050286dedc0e20f247d428c">strat2int</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/d51/structstrategy.html">strategy</a>)</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;{</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a>); x++) {</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(strategy, <a class="code" href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a>[x].<a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)) {</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a>[x].<a class="code" href="../../d8/d51/structstrategy.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;      }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;   }</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;}</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af90b6bfe64cf7ef0df349ef23852ece3"> 1813</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af90b6bfe64cf7ef0df349ef23852ece3">autopause2int</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/dd2/structautopause.html">autopause</a>)</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;{</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   <span class="comment">/*This &#39;double check&#39; that default value is OFF */</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(autopause)) {</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0">QUEUE_AUTOPAUSE_OFF</a>;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;   }</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;   <span class="comment">/*This &#39;double check&#39; is to ensure old values works */</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(autopause)) {</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62a92b2b0d4b3b19ef4bd9b02a302f2026b">QUEUE_AUTOPAUSE_ON</a>;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;   }</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#ad7bfd042e07ab221f05374233ec2dcf6">autopausesmodes</a>); x++) {</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(autopause, <a class="code" href="../../da/dfb/app__queue_8c.html#ad7bfd042e07ab221f05374233ec2dcf6">autopausesmodes</a>[x].<a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)) {</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad7bfd042e07ab221f05374233ec2dcf6">autopausesmodes</a>[x].<a class="code" href="../../df/dd2/structautopause.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause</a>;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;      }</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;   }</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   <span class="comment">/*This &#39;double check&#39; that default value is OFF */</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0">QUEUE_AUTOPAUSE_OFF</a>;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;}</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div><div class="line"><a name="l01836"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9f81db529b7d97134601164c43a945f2"> 1836</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9f81db529b7d97134601164c43a945f2">queue_hash_cb</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;{</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = obj;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#ab08f8db2a7258e538a0da7417f58db58">ast_str_case_hash</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;}</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div><div class="line"><a name="l01843"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9a488aa902d38d97f26bbfbb59a22e2b"> 1843</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9a488aa902d38d97f26bbfbb59a22e2b">queue_cmp_cb</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;{</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = obj, *q2 = arg;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;   <span class="keywordflow">return</span> !strcasecmp(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, q2-&gt;name) ? <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a> : 0;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;}</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment"> * \brief Return wrapuptime</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment"> * This function checks if wrapuptime in member is set and return this value.</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment"> * Otherwise return value the wrapuptime in the queue configuration</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment"> * \return integer value</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01856"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd"> 1856</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>)</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;{</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;   <span class="keywordflow">if</span> (member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>) {</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="keywordflow">return</span> member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;   }</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   <span class="keywordflow">return</span> q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;}</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">/*! \internal</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment"> * \brief ao2_callback, Decreases queuepos of all followers with a queuepos greater than arg.</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment"> * \param obj the member being acted on</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment"> * \param arg pointer to an integer containing the position value that was removed and requires reduction for anything above</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01869"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae878f92553205372e178f586fb3b4505"> 1869</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae878f92553205372e178f586fb3b4505">queue_member_decrement_followers</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> <a class="code" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a>)</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;{</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = obj;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;   <span class="keywordtype">int</span> *decrement_followers_after = arg;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;   <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a> &gt; *decrement_followers_after) {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a>--;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   }</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;}</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment">/*! \internal</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment"> * \brief ao2_callback, finds members in a queue marked for deletion and in a cascading fashion runs queue_member_decrement_followers</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment"> *        on them. This callback should always be ran before performing mass unlinking of delmarked members from queues.</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment"> * \param obj member being acted on</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment"> * \param arg pointer to the queue members are being removed from</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01887"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab56591994d9db2eb3cf3eb8404c881f4"> 1887</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab56591994d9db2eb3cf3eb8404c881f4">queue_delme_members_decrement_followers</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> <a class="code" href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a>)</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;{</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = obj;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *queue = arg;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a> = mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a>;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;   <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a22ed1f20028b26f7ece35aeec695293f">delme</a>) {</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#ae878f92553205372e178f586fb3b4505">queue_member_decrement_followers</a>, &amp;rrpos);</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;   }</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;}</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">/*! \internal</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment"> * \brief Use this to decrement followers during removal of a member</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment"> * \param queue which queue the member is being removed from</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment"> * \param mem which member is being removed from the queue</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01905"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abed8e0f3934b58e838f035e19ebb05c3"> 1905</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#abed8e0f3934b58e838f035e19ebb05c3">queue_member_follower_removal</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *queue, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem)</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;{</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;   <span class="keywordtype">int</span> pos = mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a>;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <span class="comment">/* If the position being removed is less than the current place in the queue, reduce the queue position by one so that we don&#39;t skip the member</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">    * who would have been next otherwise. */</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   <span class="keywordflow">if</span> (pos &lt; queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a>) {</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a>--;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   }</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#ae878f92553205372e178f586fb3b4505">queue_member_decrement_followers</a>, &amp;pos);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;}</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa08344a84581d62ffa83c87eea5da4ba"> 1918</a></span>&#160;<span class="preprocessor">#define queue_ref(q)          ao2_bump(q)</span></div><div class="line"><a name="l01919"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab"> 1919</a></span>&#160;<span class="preprocessor">#define queue_unref(q)           ({ ao2_cleanup(q); NULL; })</span></div><div class="line"><a name="l01920"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a92781796b10a269001fffa4646ac1a1f"> 1920</a></span>&#160;<span class="preprocessor">#define queue_t_ref(q, tag)         ao2_t_bump(q, tag)</span></div><div class="line"><a name="l01921"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061"> 1921</a></span>&#160;<span class="preprocessor">#define queue_t_unref(q, tag)    ({ ao2_t_cleanup(q, tag); NULL; })</span></div><div class="line"><a name="l01922"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6d56dcc1f330ae7fe1b5a1ee832077c1"> 1922</a></span>&#160;<span class="preprocessor">#define queues_t_link(c, q, tag) ao2_t_link(c, q, tag)</span></div><div class="line"><a name="l01923"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a677f1c4c1a61e9e02d180803d8b8a008"> 1923</a></span>&#160;<span class="preprocessor">#define queues_t_unlink(c, q, tag)  ao2_t_unlink(c, q, tag)</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">/*! \brief Set variables of queue */</span></div><div class="line"><a name="l01926"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138"> 1926</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138">set_queue_variables</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;{</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;   <span class="keywordtype">char</span> interfacevar[256]=<span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   <span class="keywordtype">float</span> sl = 0;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a32794c302b9a60821d519f6d4d1e7885">setqueuevar</a>) {</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      sl = 0;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> &gt; 0) {</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;         sl = 100 * ((float) q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a> / (<span class="keywordtype">float</span>) q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      }</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      snprintf(interfacevar, <span class="keyword">sizeof</span>(interfacevar),</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;         <span class="stringliteral">&quot;QUEUENAME=%s,QUEUEMAX=%d,QUEUESTRATEGY=%s,QUEUECALLS=%d,QUEUEHOLDTIME=%d,QUEUETALKTIME=%d,QUEUECOMPLETED=%d,QUEUEABANDONED=%d,QUEUESRVLEVEL=%d,QUEUESRVLEVELPERF=%2.1f&quot;</span>,</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a792b5d8a5231db2f05b08bd73d318ea5">int2strat</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>), q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>,  q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>, sl);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a7527f4b7b64622b458a3999ba51af07e">pbx_builtin_setvar_multiple</a>(chan, interfacevar);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;   }</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;}</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment">/*! \brief Insert the &#39;new&#39; entry after the &#39;prev&#39; entry of queue &#39;q&#39; */</span></div><div class="line"><a name="l01952"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab2d834859be2c32442d2817935a0e3c7"> 1952</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab2d834859be2c32442d2817935a0e3c7">insert_entry</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *prev, <span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *<span class="keyword">new</span>, <span class="keywordtype">int</span> *pos)</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;{</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *cur;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;   <span class="keywordflow">if</span> (!q || !<span class="keyword">new</span>)</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;   <span class="keywordflow">if</span> (prev) {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      cur = prev-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      prev-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a> = <span class="keyword">new</span>;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      cur = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a> = <span class="keyword">new</span>;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;   }</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;   <span class="keyword">new</span>-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a> = cur;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;   <span class="comment">/* every queue_ent must have a reference to it&#39;s parent call_queue, this</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">    * reference does not go away until the end of the queue_ent&#39;s life, meaning</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">    * that even when the queue_ent leaves the call_queue this ref must remain. */</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#aa08344a84581d62ffa83c87eea5da4ba">queue_ref</a>(q);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;   <span class="keyword">new</span>-&gt;parent = q;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;   <span class="keyword">new</span>-&gt;pos = ++(*pos);</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   <span class="keyword">new</span>-&gt;opos = *<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;}</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a0518452f134d22e471d5501d4c02102d"> 1976</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a0518452f134d22e471d5501d4c02102d">queue_channel_to_ami</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;{</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df0/structast__channel__blob.html">ast_channel_blob</a> *obj = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, channel_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, event_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;   channel_string = <a class="code" href="../../db/d45/manager_8h.html#a777cde87d12b331902f862ec44641688">ast_manager_build_channel_state_string</a>(obj-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>);</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   event_string = <a class="code" href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027">ast_manager_str_from_json_object</a>(obj-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#ad2b8e22df32b99651f727cd9a8dcb9f3">blob</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   <span class="keywordflow">if</span> (!channel_string || !event_string) {</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   }</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d45/manager_8h.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a>(<a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, type,</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>,</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(channel_string),</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(event_string));</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;}</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div><div class="line"><a name="l01995"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6ea5b09a3e18d9f5d2131cb884f09186"> 1995</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a6ea5b09a3e18d9f5d2131cb884f09186">queue_caller_join_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;{</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a0518452f134d22e471d5501d4c02102d">queue_channel_to_ami</a>(<span class="stringliteral">&quot;QueueCallerJoin&quot;</span>, message);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;}</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div><div class="line"><a name="l02000"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aded397e4a6aabaef4c22702edf92e87f"> 2000</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#aded397e4a6aabaef4c22702edf92e87f">queue_caller_leave_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;{</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a0518452f134d22e471d5501d4c02102d">queue_channel_to_ami</a>(<span class="stringliteral">&quot;QueueCallerLeave&quot;</span>, message);</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;}</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div><div class="line"><a name="l02005"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac9c899c7c5a12d97016687c8745a6de6"> 2005</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ac9c899c7c5a12d97016687c8745a6de6">queue_caller_abandon_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;{</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a0518452f134d22e471d5501d4c02102d">queue_channel_to_ami</a>(<span class="stringliteral">&quot;QueueCallerAbandon&quot;</span>, message);</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;}</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_caller_join_type,</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a6ea5b09a3e18d9f5d2131cb884f09186">queue_caller_join_to_ami</a>,</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;   );</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_caller_leave_type,</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#aded397e4a6aabaef4c22702edf92e87f">queue_caller_leave_to_ami</a>,</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;   );</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_caller_abandon_type,</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ac9c899c7c5a12d97016687c8745a6de6">queue_caller_abandon_to_ami</a>,</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;   );</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div><div class="line"><a name="l02020"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d"> 2020</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;{</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *payload = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, event_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;   event_string = <a class="code" href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027">ast_manager_str_from_json_object</a>(payload-&gt;<a class="code" href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">json</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;   <span class="keywordflow">if</span> (!event_string) {</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   }</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d45/manager_8h.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a>(<a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, type,</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>,</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(event_string));</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;}</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5dc9ad9f36c4de3a6588baf8fa466131"> 2035</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5dc9ad9f36c4de3a6588baf8fa466131">queue_member_status_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;{</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a>(<span class="stringliteral">&quot;QueueMemberStatus&quot;</span>, message);</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;}</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab9c47b132cfd5583a8814e9e817baa5e"> 2040</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ab9c47b132cfd5583a8814e9e817baa5e">queue_member_added_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;{</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a>(<span class="stringliteral">&quot;QueueMemberAdded&quot;</span>, message);</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;}</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div><div class="line"><a name="l02045"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab47b5d2f3bd776ba10789dba63ee6ade"> 2045</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ab47b5d2f3bd776ba10789dba63ee6ade">queue_member_removed_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;{</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a>(<span class="stringliteral">&quot;QueueMemberRemoved&quot;</span>, message);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;}</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9db8c10e0e5c60a4733e7f62ac7c567a"> 2050</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a9db8c10e0e5c60a4733e7f62ac7c567a">queue_member_pause_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;{</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a>(<span class="stringliteral">&quot;QueueMemberPause&quot;</span>, message);</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;}</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div><div class="line"><a name="l02055"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9bdd4e15bb6c07cf8751f72a26bc62bd"> 2055</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a9bdd4e15bb6c07cf8751f72a26bc62bd">queue_member_penalty_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;{</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a>(<span class="stringliteral">&quot;QueueMemberPenalty&quot;</span>, message);</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;}</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div><div class="line"><a name="l02060"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac00e45bc47eeabbfb3437ca2de3eea8a"> 2060</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ac00e45bc47eeabbfb3437ca2de3eea8a">queue_member_ringinuse_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;{</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a>(<span class="stringliteral">&quot;QueueMemberRinginuse&quot;</span>, message);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;}</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_member_status_type,</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a5dc9ad9f36c4de3a6588baf8fa466131">queue_member_status_to_ami</a>,</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   );</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_member_added_type,</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ab9c47b132cfd5583a8814e9e817baa5e">queue_member_added_to_ami</a>,</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;   );</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_member_removed_type,</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ab47b5d2f3bd776ba10789dba63ee6ade">queue_member_removed_to_ami</a>,</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   );</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_member_pause_type,</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a9db8c10e0e5c60a4733e7f62ac7c567a">queue_member_pause_to_ami</a>,</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   );</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_member_penalty_type,</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a9bdd4e15bb6c07cf8751f72a26bc62bd">queue_member_penalty_to_ami</a>,</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;   );</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_member_ringinuse_type,</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ac00e45bc47eeabbfb3437ca2de3eea8a">queue_member_ringinuse_to_ami</a>,</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;   );</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;</div><div class="line"><a name="l02084"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba"> 2084</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba">queue_multi_channel_to_ami</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;{</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dcb/structast__multi__channel__blob.html">ast_multi_channel_blob</a> *obj = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ae7248b764758e655df26036dd6b8f4d7">caller</a>;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *agent;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, caller_event_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, agent_event_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, event_string, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;   caller = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a>(obj, <span class="stringliteral">&quot;caller&quot;</span>);</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;   <span class="keywordflow">if</span> (caller) {</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      caller_event_string = <a class="code" href="../../db/d45/manager_8h.html#a777cde87d12b331902f862ec44641688">ast_manager_build_channel_state_string</a>(caller);</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <span class="keywordflow">if</span> (!caller_event_string) {</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;No caller event string, bailing\n&quot;</span>);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      }</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;   }</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;   agent = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a>(obj, <span class="stringliteral">&quot;agent&quot;</span>);</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;   <span class="keywordflow">if</span> (agent) {</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      agent_event_string = <a class="code" href="../../db/d45/manager_8h.html#ab71472ea55b4114f460a4459e3dcd18b">ast_manager_build_channel_state_string_prefix</a>(agent, <span class="stringliteral">&quot;Dest&quot;</span>);</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      <span class="keywordflow">if</span> (!agent_event_string) {</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;No agent event string, bailing\n&quot;</span>);</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;      }</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;   }</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;   event_string = <a class="code" href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027">ast_manager_str_from_json_object</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga54c9b2b1131c872d25a1395882333ae3">ast_multi_channel_blob_get_json</a>(obj), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;   <span class="keywordflow">if</span> (!event_string) {</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   }</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d45/manager_8h.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a>(<a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, type,</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>,</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      caller_event_string ? <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(caller_event_string) : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      agent_event_string ? <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(agent_event_string) : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(event_string));</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;}</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div><div class="line"><a name="l02125"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a0809b6a4ede89226ed013ac442992872"> 2125</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a0809b6a4ede89226ed013ac442992872">queue_agent_called_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;{</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba">queue_multi_channel_to_ami</a>(<span class="stringliteral">&quot;AgentCalled&quot;</span>, message);</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;}</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div><div class="line"><a name="l02130"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a58c9d0c9d53acc38bcb44fc1426d853f"> 2130</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a58c9d0c9d53acc38bcb44fc1426d853f">queue_agent_connect_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;{</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba">queue_multi_channel_to_ami</a>(<span class="stringliteral">&quot;AgentConnect&quot;</span>, message);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;}</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div><div class="line"><a name="l02135"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a177ca78dcb7d3e97d83c7c0273f70189"> 2135</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a177ca78dcb7d3e97d83c7c0273f70189">queue_agent_complete_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;{</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba">queue_multi_channel_to_ami</a>(<span class="stringliteral">&quot;AgentComplete&quot;</span>, message);</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;}</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div><div class="line"><a name="l02140"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a628bb0f021d9643fbe96ddb7fd3fa77c"> 2140</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a628bb0f021d9643fbe96ddb7fd3fa77c">queue_agent_dump_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;{</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba">queue_multi_channel_to_ami</a>(<span class="stringliteral">&quot;AgentDump&quot;</span>, message);</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;}</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#acb77c72db33e25dc53672af1b85526a4"> 2145</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#acb77c72db33e25dc53672af1b85526a4">queue_agent_ringnoanswer_to_ami</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>)</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;{</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba">queue_multi_channel_to_ami</a>(<span class="stringliteral">&quot;AgentRingNoAnswer&quot;</span>, message);</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;}</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_agent_called_type,</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a0809b6a4ede89226ed013ac442992872">queue_agent_called_to_ami</a>,</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;   );</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_agent_connect_type,</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a58c9d0c9d53acc38bcb44fc1426d853f">queue_agent_connect_to_ami</a>,</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;   );</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_agent_complete_type,</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a177ca78dcb7d3e97d83c7c0273f70189">queue_agent_complete_to_ami</a>,</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;   );</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_agent_dump_type,</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a628bb0f021d9643fbe96ddb7fd3fa77c">queue_agent_dump_to_ami</a>,</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;   );</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(queue_agent_ringnoanswer_type,</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#acb77c72db33e25dc53672af1b85526a4">queue_agent_ringnoanswer_to_ami</a>,</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;   );</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;</div><div class="line"><a name="l02166"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad5d008a8d00288be0065438ae331071f"> 2166</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad5d008a8d00288be0065438ae331071f">queue_publish_multi_channel_snapshot_blob</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic,</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *caller_snapshot,</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *agent_snapshot,</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *blob)</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;{</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dcb/structast__multi__channel__blob.html">ast_multi_channel_blob</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;   }</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   payload = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafe90e356833a3ec8ba6020a39d0689b9">ast_multi_channel_blob_create</a>(blob);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;   <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;   }</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;   <span class="keywordflow">if</span> (caller_snapshot) {</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga9a3ff91f86f5f2e7e60571246c8e5873">ast_multi_channel_blob_add_channel</a>(payload, <span class="stringliteral">&quot;caller&quot;</span>, caller_snapshot);</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Empty caller_snapshot; sending incomplete event\n&quot;</span>);</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;   }</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   <span class="keywordflow">if</span> (agent_snapshot) {</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga9a3ff91f86f5f2e7e60571246c8e5873">ast_multi_channel_blob_add_channel</a>(payload, <span class="stringliteral">&quot;agent&quot;</span>, agent_snapshot);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;   }</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(type, payload);</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;   }</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(topic, msg);</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;}</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;</div><div class="line"><a name="l02201"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8e96a6fc0050e0b3a0b79783d337aa3a"> 2201</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8e96a6fc0050e0b3a0b79783d337aa3a">queue_publish_multi_channel_blob</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *caller, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *agent,</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *blob)</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;{</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, caller_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, agent_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(caller);</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;   caller_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a>(caller);</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(caller);</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(agent);</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;   agent_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a>(agent);</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(agent);</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;   <span class="keywordflow">if</span> (!caller_snapshot || !agent_snapshot) {</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;   }</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#ad5d008a8d00288be0065438ae331071f">queue_publish_multi_channel_snapshot_blob</a>(<a class="code" href="../../d5/d7b/channel_8h.html#afdeaf9abb1aecc715313a4f62c1cf9c9">ast_channel_topic</a>(caller), caller_snapshot,</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;         agent_snapshot, type, blob);</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;}</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment"> * \brief Publish the member blob.</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment"> * \param type Stasis message type to publish.</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment"> * \param blob The information being published.</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment"> * \note The json blob reference is passed to this function.</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02234"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0"> 2234</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *blob)</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;{</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;   <span class="keywordflow">if</span> (!blob || !type) {</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(blob);</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;   }</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;   payload = <a class="code" href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a>(blob);</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(blob);</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;   <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;   }</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(type, payload);</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;   }</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a>(), msg);</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;}</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;</div><div class="line"><a name="l02258"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9"> 2258</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem)</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;{</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: s, s: s, s: s, s: s, s: i, s: i, s: i, s: i, s: i, s: i, s: i, s: s, s: i, s: i}&quot;</span>,</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      <span class="stringliteral">&quot;Queue&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <span class="stringliteral">&quot;MemberName&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>,</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="stringliteral">&quot;Interface&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>,</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="stringliteral">&quot;StateInterface&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>,</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      <span class="stringliteral">&quot;Membership&quot;</span>, (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a> ? <span class="stringliteral">&quot;dynamic&quot;</span> : (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a> ? <span class="stringliteral">&quot;realtime&quot;</span> : <span class="stringliteral">&quot;static&quot;</span>)),</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="stringliteral">&quot;Penalty&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>,</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;      <span class="stringliteral">&quot;CallsTaken&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>,</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      <span class="stringliteral">&quot;LastCall&quot;</span>, (<span class="keywordtype">int</span>)mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>,</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;      <span class="stringliteral">&quot;LastPause&quot;</span>, (<span class="keywordtype">int</span>)mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a>,</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      <span class="stringliteral">&quot;InCall&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> ? 1 : 0,</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="stringliteral">&quot;Status&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>,</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <span class="stringliteral">&quot;Paused&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>,</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      <span class="stringliteral">&quot;PausedReason&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>,</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;      <span class="stringliteral">&quot;Ringinuse&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>,</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="stringliteral">&quot;Wrapuptime&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;}</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">/*! \brief Check if members are available</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment"> * This function checks to see if members are available to be called. If any member</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment"> * is available, the function immediately returns 0. If no members are available,</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment"> * then -1 is returned.</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02284"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2cfafe91008492ba14ad4a0f8e11ea63"> 2284</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2cfafe91008492ba14ad4a0f8e11ea63">get_member_status</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keywordtype">int</span> max_penalty, <span class="keywordtype">int</span> min_penalty, <span class="keywordtype">int</span> raise_penalty, <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6">empty_conditions</a> conditions, <span class="keywordtype">int</span> devstate)</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;{</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;   <span class="keywordflow">for</span> (; (member = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, -1)) {</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="keywordtype">int</span> penalty = member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="keywordflow">if</span> (raise_penalty != INT_MAX &amp;&amp; penalty &lt; raise_penalty) {</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is having his penalty raised up from %d to %d\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, penalty, raise_penalty);</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;         penalty = raise_penalty;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;      }</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      <span class="keywordflow">if</span> ((max_penalty != INT_MAX &amp;&amp; penalty &gt; max_penalty) || (min_penalty != INT_MAX &amp;&amp; penalty &lt; min_penalty)) {</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;         <span class="keywordflow">if</span> (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4">QUEUE_EMPTY_PENALTY</a>) {</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because his penalty is not between %d and %d\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, min_penalty, max_penalty);</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;         }</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      }</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <span class="keywordflow">switch</span> (devstate ? <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eee">ast_device_state</a>(member-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>) : member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>) {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a>:</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;         <span class="keywordflow">if</span> (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af">QUEUE_EMPTY_INVALID</a>) {</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because his device state is &#39;invalid&#39;\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;         }</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;         <span class="keywordflow">goto</span> default_case;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>:</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;         <span class="keywordflow">if</span> (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6adfcf6310d20a8088a392ea40fa381e09">QUEUE_EMPTY_UNAVAILABLE</a>) {</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because his device state is &#39;unavailable&#39;\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;         }</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;         <span class="keywordflow">goto</span> default_case;</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>:</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;         <span class="keywordflow">if</span> (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a85b9e406efa42c21f44d6f5b3ae9b332">QUEUE_EMPTY_INUSE</a>) {</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because his device state is &#39;inuse&#39;\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;         }</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;         <span class="keywordflow">goto</span> default_case;</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea76d91d5d654cfa3edafb2afbe3e09b46">AST_DEVICE_RINGING</a>:</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;         <span class="keywordflow">if</span> (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a6dd24d66d8fcdf0a3444d28ec9c82ba2">QUEUE_EMPTY_RINGING</a>) {</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because his device state is &#39;ringing&#39;\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;         }</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;         <span class="keywordflow">goto</span> default_case;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a">AST_DEVICE_UNKNOWN</a>:</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;         <span class="keywordflow">if</span> (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1532fb860aed655673cca9f18f44a7d1">QUEUE_EMPTY_UNKNOWN</a>) {</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because his device state is &#39;unknown&#39;\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;         }</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;         <span class="comment">/* Fall-through */</span></div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      default_case:</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;         <span class="keywordflow">if</span> (member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> &amp;&amp; (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c">QUEUE_EMPTY_PAUSED</a>)) {</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because he is paused&#39;\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6aec193cf33d944aed4807b36eefdbc1d1">QUEUE_EMPTY_WRAPUP</a>)</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            &amp;&amp; member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            &amp;&amp; <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(q, member)</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(q, member) &lt; member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>)) {</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is unavailable because it has only been %d seconds since his last call (wrapup time is %d)\n&quot;</span>,</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;               member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, (<span class="keywordtype">int</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>), <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(q, member));</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, -1);</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s is available.\n&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;         }</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      }</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;   }</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;   <span class="keywordflow">if</span> (!devstate &amp;&amp; (conditions &amp; <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a6dd24d66d8fcdf0a3444d28ec9c82ba2">QUEUE_EMPTY_RINGING</a>)) {</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      <span class="comment">/* member state still may be RINGING due to lag in event message - check again with device state */</span></div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2cfafe91008492ba14ad4a0f8e11ea63">get_member_status</a>(q, max_penalty, min_penalty, raise_penalty, conditions, 1);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;   }</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;}</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment"> * A &quot;pool&quot; of member objects that calls are currently pending on. If an</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment"> * agent is a member of multiple queues it&#39;s possible for that agent to be</span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment"> * called by each of the queues at the same time. This happens because device</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment"> * state is slow to notify the queue app of one of it&#39;s member&#39;s being rung.</span></div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment"> * This &quot;pool&quot; allows us to track which members are currently being rung while</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment"> * we wait on the device state change.</span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02375"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa7d1afea6dfbecdafb8db467ff324d5a"> 2375</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#aa7d1afea6dfbecdafb8db467ff324d5a">pending_members</a>;</div><div class="line"><a name="l02376"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a563ce4840e1461a302bd2af34d404f38"> 2376</a></span>&#160;<span class="preprocessor">#define MAX_CALL_ATTEMPT_BUCKETS 353</span></div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab1e47d681926f94694873b3ce842dfbe"> 2378</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab1e47d681926f94694873b3ce842dfbe">pending_members_hash</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;{</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *object;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *key;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a>) {</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>:</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      key = obj;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a>:</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      <span class="keywordtype">object</span> = obj;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      key = <span class="keywordtype">object</span>-&gt;interface;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;   }</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#ab08f8db2a7258e538a0da7417f58db58">ast_str_case_hash</a>(key);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;}</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div><div class="line"><a name="l02398"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a1d03e640ed40f48f1cec61cac6d569ab"> 2398</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a1d03e640ed40f48f1cec61cac6d569ab">pending_members_cmp</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;{</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *object_left = obj;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *object_right = arg;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *right_key = arg;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a>) {</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a>:</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      right_key = object_right-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>:</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      cmp = strcasecmp(object_left-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, right_key);</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20">OBJ_SEARCH_PARTIAL_KEY</a>:</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      <span class="comment">/* Not supported by container. */</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      cmp = 0;</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;   }</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;   <span class="keywordflow">if</span> (cmp) {</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;   }</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;}</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;</div><div class="line"><a name="l02426"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98"> 2426</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem)</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;{</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Removed %s from pending_members\n&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(pending_members, mem, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a>);</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;}</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">/*! \brief set a member&#39;s status based on device state of that member&#39;s state_interface.</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment"> * Lock interface list find sc, iterate through each queues queue_member list for member to</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment"> * update state inside queues</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l02437"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8dc9d913ab9bf3c318b9ad1f679e4447"> 2437</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8dc9d913ab9bf3c318b9ad1f679e4447">update_status</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *m, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;{</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   <span class="keywordflow">if</span> (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != status) {</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      <span class="comment">/* If this member has transitioned to being available then update their queue</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment">       * information. If they are currently in a call then the leg to the agent will be</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment">       * considered done and the call finished.</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;      <span class="keywordflow">if</span> (status == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>) {</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3">update_queue</a>(q, m, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>);</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      }</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> = <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="comment">/* Remove the member from the pending members pool only when the status changes.</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">       * This is not done unconditionally because we can occasionally see multiple</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">       * device state notifications of not in use after a previous call has ended,</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">       * including after we have initiated a new call. This is more likely to</span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">       * happen when there is latency in the connection to the member.</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(m);</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a>(queue_member_status_type(), <a class="code" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a>(q, m));</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   }</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;}</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment"> * \brief Determine if a queue member is available</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment"> * \retval 1 if the member is available</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment"> * \retval 0 if the member is not available</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02468"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a4fe68b376a679a230a33d09423e76b15"> 2468</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a4fe68b376a679a230a33d09423e76b15">is_member_available</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem)</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;{</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d1/d97/chan__dahdi_8c.html#a4ee142675554d362c585267c1290d5b3">available</a> = 0;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;   <span class="keywordflow">switch</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>) {</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a>:</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>:</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>:</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeab43afabf5bcd4ad1f531ad78c48ccb6f">AST_DEVICE_BUSY</a>:</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea76d91d5d654cfa3edafb2afbe3e09b46">AST_DEVICE_RINGING</a>:</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea17b87dfa3f4de5909b401017e229091d">AST_DEVICE_RINGINUSE</a>:</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea6b7416bea92d3bc5ee8e36f0a484cdc1">AST_DEVICE_ONHOLD</a>:</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;         <span class="keywordflow">if</span> (!mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>) {</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;         }</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;         <span class="comment">/* else fall through */</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>:</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a">AST_DEVICE_UNKNOWN</a>:</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;         <span class="keywordflow">if</span> (!mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>) {</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            available = 1;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;         }</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;   }</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;   <span class="comment">/* Let wrapuptimes override device state availability */</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;   wrapuptime = <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(q, mem);</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;   <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a> &amp;&amp; wrapuptime &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - wrapuptime &lt; mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>)) {</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      available = 0;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;   }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/d97/chan__dahdi_8c.html#a4ee142675554d362c585267c1290d5b3">available</a>;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;}</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="comment">/*! \brief set a member&#39;s status based on device state of that member&#39;s interface*/</span></div><div class="line"><a name="l02503"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac1dd446fcf3d75d5da9228faf2dce1d3"> 2503</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ac1dd446fcf3d75d5da9228faf2dce1d3">device_state_cb</a>(<span class="keywordtype">void</span> *unused, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;{</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> miter, qiter;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d92/structast__device__state__message.html">ast_device_state_message</a> *dev_state;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   <span class="keywordtype">char</span> interface[80], *slash_pos;</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a> = 0;       <span class="comment">/* Found this member in any queue */</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;   <span class="keywordtype">int</span> found_member;    <span class="comment">/* Found this member in this queue */</span></div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   <span class="keywordtype">int</span> avail = 0;       <span class="comment">/* Found an available member in this queue */</span></div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type</a>() != <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(msg)) {</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;   }</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;   dev_state = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;   <span class="keywordflow">if</span> (dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a39d1b63955a48c72508fa9f884d05762">eid</a>) {</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="comment">/* ignore non-aggregate states */</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   }</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   qiter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;qiter, <span class="stringliteral">&quot;Iterate over queues&quot;</span>))) {</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      avail = 0;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      found_member = 0;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      miter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="keywordflow">for</span> (; (m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;miter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1)) {</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;         <span class="keywordflow">if</span> (!found_member) {</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(interface, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, <span class="keyword">sizeof</span>(interface));</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;            <span class="keywordflow">if</span> ((slash_pos = strchr(interface, <span class="charliteral">&#39;/&#39;</span>))) {</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;               <span class="keywordflow">if</span> (!strncasecmp(interface, <span class="stringliteral">&quot;Local/&quot;</span>, 6) &amp;&amp; (slash_pos = strchr(slash_pos + 1, <span class="charliteral">&#39;/&#39;</span>))) {</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                  *slash_pos = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;               }</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            }</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(interface, dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a8059c3b19eb356cf729e5d25b139647e">device</a>)) {</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;               found_member = 1;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;               <a class="code" href="../../da/dfb/app__queue_8c.html#a8dc9d913ab9bf3c318b9ad1f679e4447">update_status</a>(q, m, dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">state</a>);</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            }</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;         }</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;         <span class="comment">/* check every member until we find one NOT_INUSE */</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;         <span class="keywordflow">if</span> (!avail) {</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;            avail = <a class="code" href="../../da/dfb/app__queue_8c.html#a4fe68b376a679a230a33d09423e76b15">is_member_available</a>(q, m);</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;         }</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;         <span class="keywordflow">if</span> (avail &amp;&amp; found_member) {</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            <span class="comment">/* early exit as we&#39;ve found an available member and the member of interest */</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;         }</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      }</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="keywordflow">if</span> (found_member) {</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;         found = 1;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;         <span class="keywordflow">if</span> (avail) {</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_avail&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_avail&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;         }</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      }</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;miter);</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;   }</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;qiter);</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;   <span class="keywordflow">if</span> (found) {</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Device &#39;%s&#39; changed to state &#39;%u&#39; (%s)\n&quot;</span>,</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;         dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a8059c3b19eb356cf729e5d25b139647e">device</a>,</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;         dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">state</a>,</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;         <a class="code" href="../../da/da2/devicestate_8h.html#ac3a57910a6eb04d12d793fe3df796b8e">ast_devstate2str</a>(dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">state</a>));</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Device &#39;%s&#39; changed to state &#39;%u&#39; (%s) but we don&#39;t care because they&#39;re not a member of any queue.\n&quot;</span>,</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;         dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a8059c3b19eb356cf729e5d25b139647e">device</a>,</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;         dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">state</a>,</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;         <a class="code" href="../../da/da2/devicestate_8h.html#ac3a57910a6eb04d12d793fe3df796b8e">ast_devstate2str</a>(dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">state</a>));</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;   }</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;}</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment">/*! \brief Helper function which converts from extension state to device state values */</span></div><div class="line"><a name="l02590"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6c96c5a03e8b94a8b55feb294012943f"> 2590</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6c96c5a03e8b94a8b55feb294012943f">extensionstate2devicestate</a>(<span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;{</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;   <span class="keywordflow">switch</span> (state) {</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa435abb1e907b1cee83ec44d2d77866e6">AST_EXTENSION_NOT_INUSE</a>:</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa47e9214860b5f9b887945f7cd1baec1a">AST_EXTENSION_INUSE</a>:</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fad62d357f0ccde2a718c374a0a4af2b98">AST_EXTENSION_BUSY</a>:</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeab43afabf5bcd4ad1f531ad78c48ccb6f">AST_DEVICE_BUSY</a>;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa4063bf4e94e14df04126be6f08cc7bfc">AST_EXTENSION_RINGING</a>:</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea76d91d5d654cfa3edafb2afbe3e09b46">AST_DEVICE_RINGING</a>;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa47e9214860b5f9b887945f7cd1baec1a">AST_EXTENSION_INUSE</a> | <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa4063bf4e94e14df04126be6f08cc7bfc">AST_EXTENSION_RINGING</a>:</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea17b87dfa3f4de5909b401017e229091d">AST_DEVICE_RINGINUSE</a>;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa83180bb058ded006c01229431fc887f9">AST_EXTENSION_ONHOLD</a>:</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea6b7416bea92d3bc5ee8e36f0a484cdc1">AST_DEVICE_ONHOLD</a>;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa47e9214860b5f9b887945f7cd1baec1a">AST_EXTENSION_INUSE</a> | <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa83180bb058ded006c01229431fc887f9">AST_EXTENSION_ONHOLD</a>:</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa5820eb407f3a3dbc5046c97ad43ee1f3">AST_EXTENSION_UNAVAILABLE</a>:</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>;</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa3e2a2f5572580f74e94b6d5e80261ea7">AST_EXTENSION_REMOVED</a>:</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625faf53cb090b99fb8e952c8151990bd4192">AST_EXTENSION_DEACTIVATED</a>:</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a>;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;   }</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;}</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;</div><div class="line"><a name="l02627"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6e99f5e0e3c3fa175e9fafe3af76c25e"> 2627</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6e99f5e0e3c3fa175e9fafe3af76c25e">extension_state_cb</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d4c/structast__state__cb__info.html">ast_state_cb_info</a> *<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>, <span class="keywordtype">void</span> *data)</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;{</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> miter, qiter;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a> = info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#a6f3d8aa9a90b701e81dad4cc4a56be67">exten_state</a>;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a> = 0, device_state = <a class="code" href="../../da/dfb/app__queue_8c.html#a6c96c5a03e8b94a8b55feb294012943f">extensionstate2devicestate</a>(state);</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;   <span class="comment">/* only interested in extension state updates involving device states */</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;   <span class="keywordflow">if</span> (info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#a3a7a902ef9b30b78b595eeee1485090f">reason</a> != <a class="code" href="../../db/de0/pbx_8h.html#ab077da615e93c9e88ce539bef23f82e6a2e89bd60b1752d920f58a70164607189">AST_HINT_UPDATE_DEVICE</a>) {</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;   }</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;   qiter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;qiter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      miter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <span class="keywordflow">for</span> (; (m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;miter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1)) {</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;         <span class="keywordflow">if</span> (!strcmp(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#aa99dee44b85aa7057ed5bea20fa2bb52">state_context</a>, context) &amp;&amp; !strcmp(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd">state_exten</a>, exten)) {</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a8dc9d913ab9bf3c318b9ad1f679e4447">update_status</a>(q, m, device_state);</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            found = 1;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;         }</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      }</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;miter);</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;   }</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;qiter);</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="keywordflow">if</span> (found) {</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Extension &#39;%s@%s&#39; changed to state &#39;%d&#39; (%s)\n&quot;</span>, exten, context, device_state, <a class="code" href="../../da/da2/devicestate_8h.html#ac3a57910a6eb04d12d793fe3df796b8e">ast_devstate2str</a>(device_state));</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Extension &#39;%s@%s&#39; changed to state &#39;%d&#39; (%s) but we don&#39;t care because they&#39;re not a member of any queue.\n&quot;</span>,</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;           exten, context, device_state, <a class="code" href="../../da/da2/devicestate_8h.html#ac3a57910a6eb04d12d793fe3df796b8e">ast_devstate2str</a>(device_state));</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;   }</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;}</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment">/*! \brief Return the current state of a member */</span></div><div class="line"><a name="l02671"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#acfa0c49ab441d6095ecaaf9bcdf72c04"> 2671</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#acfa0c49ab441d6095ecaaf9bcdf72c04">get_queue_member_status</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *cur)</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;{</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd">state_exten</a>) ? <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eee">ast_device_state</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>) : <a class="code" href="../../da/dfb/app__queue_8c.html#a6c96c5a03e8b94a8b55feb294012943f">extensionstate2devicestate</a>(<a class="code" href="../../db/de0/pbx_8h.html#aed6cfe76441ef995ab80609020a9990c">ast_extension_state</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#aa99dee44b85aa7057ed5bea20fa2bb52">state_context</a>, cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd">state_exten</a>));</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;}</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;</div><div class="line"><a name="l02676"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa707168bdf0595df609e91bd8ec2dd71"> 2676</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa707168bdf0595df609e91bd8ec2dd71">destroy_queue_member_cb</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;{</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = obj;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;   <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ab755590c3f680079c572a5176366c8fe">state_id</a> != -1) {</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#aa992580d26443e3306f7f08cf5908e7c">ast_extension_state_del</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ab755590c3f680079c572a5176366c8fe">state_id</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a6e99f5e0e3c3fa175e9fafe3af76c25e">extension_state_cb</a>);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;   }</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;}</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment">/*! \brief allocate space for new queue member and set fields based on parameters passed */</span></div><div class="line"><a name="l02686"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a066e0020d2b8551be747bd42d26ab94a"> 2686</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a066e0020d2b8551be747bd42d26ab94a">create_queue_member</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>)</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;{</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *cur;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;   <span class="keywordflow">if</span> ((cur = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*cur), <a class="code" href="../../da/dfb/app__queue_8c.html#aa707168bdf0595df609e91bd8ec2dd71">destroy_queue_member_cb</a>))) {</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> = <a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a> = <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> = <a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a> = <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keywordflow">if</span> (paused) {</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;         time(&amp;cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a>); <span class="comment">/* Update time of last pause */</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      }</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, interface, <span class="keyword">sizeof</span>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>));</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(state_interface)) {</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, state_interface, <span class="keyword">sizeof</span>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>));</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, interface, <span class="keyword">sizeof</span>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>));</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      }</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(membername)) {</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, membername, <span class="keyword">sizeof</span>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>));</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, interface, <span class="keyword">sizeof</span>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>));</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      }</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      <span class="keywordflow">if</span> (!strchr(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="charliteral">&#39;/&#39;</span>)) {</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No location at interface &#39;%s&#39;\n&quot;</span>, interface);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      }</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      <span class="keywordflow">if</span> (!strncmp(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, <span class="stringliteral">&quot;hint:&quot;</span>, 5)) {</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;         <span class="keywordtype">char</span> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>), *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;         <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a> = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="stringliteral">&quot;@&quot;</span>) + 5;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd">state_exten</a>, exten, <span class="keyword">sizeof</span>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd">state_exten</a>));</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#aa99dee44b85aa7057ed5bea20fa2bb52">state_context</a>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="stringliteral">&quot;default&quot;</span>), <span class="keyword">sizeof</span>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#aa99dee44b85aa7057ed5bea20fa2bb52">state_context</a>));</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;         cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#ab755590c3f680079c572a5176366c8fe">state_id</a> = <a class="code" href="../../db/de0/pbx_8h.html#ab1d88f370509aae87302134e6f70628a">ast_extension_state_add</a>(cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#aa99dee44b85aa7057ed5bea20fa2bb52">state_context</a>, cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd">state_exten</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a6e99f5e0e3c3fa175e9fafe3af76c25e">extension_state_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;         cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#ab755590c3f680079c572a5176366c8fe">state_id</a> = -1;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      }</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#acfa0c49ab441d6095ecaaf9bcdf72c04">get_queue_member_status</a>(cur);</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;   }</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;   <span class="keywordflow">return</span> cur;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;}</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div><div class="line"><a name="l02730"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#afadb8ba08300e1949f925ea3da91d443"> 2730</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#afadb8ba08300e1949f925ea3da91d443">compress_char</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>)</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;{</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;   <span class="keywordflow">if</span> (c &lt; 32) {</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c &gt; 96) {</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      <span class="keywordflow">return</span> c - 64;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;   }</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;   <span class="keywordflow">return</span> c - 32;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;}</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div><div class="line"><a name="l02740"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a663a7b1ad590cc3041706eb246d91ba7"> 2740</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a663a7b1ad590cc3041706eb246d91ba7">member_hash_fn</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj, <span class="keyword">const</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;{</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = obj;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">interface </span>= (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>) ? obj : mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *chname = strchr(interface, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   <span class="keywordtype">int</span> ret = 0, i;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;   <span class="keywordflow">if</span> (!chname) {</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      chname = interface;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;   }</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; 5 &amp;&amp; chname[i]; i++) {</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      ret += <a class="code" href="../../da/dfb/app__queue_8c.html#afadb8ba08300e1949f925ea3da91d443">compress_char</a>(chname[i]) &lt;&lt; (i * 6);</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;   }</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;}</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;</div><div class="line"><a name="l02756"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6659861a3baff7381bdfe00d7b36c19a"> 2756</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6659861a3baff7381bdfe00d7b36c19a">member_cmp_fn</a>(<span class="keywordtype">void</span> *obj1, <span class="keywordtype">void</span> *obj2, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;{</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem1 = obj1;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem2 = obj2;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">interface </span>= (flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>) ? obj2 : mem2-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;   <span class="keywordflow">return</span> strcasecmp(mem1-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, interface) ? 0 : <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;}</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment"> * \brief Initialize Queue default values.</span></div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment"> * \note the queue&#39;s lock  must be held before executing this function</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l02769"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa76378a6ff09ce40268e214fdae6a61d"> 2769</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa76378a6ff09ce40268e214fdae6a61d">init_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q)</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;{</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *pr_iter;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 0;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b">retry</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a3f1683ed5a30b46922e3f88b7c716e04">DEFAULT_RETRY</a>;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#aad2dd72565852b91c809cd4685833b17">DEFAULT_TIMEOUT</a>;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a> = 0;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb">announcefrequency</a> = 0;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7724cd5a7395de6d0cbc7f0a02b0c20a">minannouncefrequency</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a679ea032e9e26f6e6e569769fb528722">DEFAULT_MIN_ANNOUNCE_FREQUENCY</a>;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> = 1;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2e7cadcc5625b17fdd07051a07a3773c">announceposition_only_up</a> = 0;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6">announcepositionlimit</a> = 10; <span class="comment">/* Default 10 positions */</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ae19c02c3c0ba9ca01d7ede746f736c45">ANNOUNCEPOSITION_YES</a>; <span class="comment">/* Default yes */</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> = 0; <span class="comment">/* Default - don&#39;t announce seconds */</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a> = 0;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> = 1;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a34c5860043ef96a75828b7107fcffb17">announce_to_first_user</a> = 0;</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0c5bcd98bca1c3085183ba1fc80195ed">setinterfacevar</a> = 0;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a32794c302b9a60821d519f6d4d1e7885">setqueuevar</a> = 0;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a23486e86a21295aa734885d335ae9c2f">setqueueentryvar</a> = 0;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a76e20f3c9df399ad87bb4e45c7419e99">autofill</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ab20962f473e6a8976a3e4e23b90049cc">autofill_default</a>;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7ccaa047c703f95f5eaf0dd0a10670b5">montype</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a255e617ba389793f7425d398afe9d557">montype_default</a>;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a20ba21c586c791a31ef97102b4811a8f">reportholdtime</a> = 0;</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a> = 0;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039">penaltymemberslimit</a> = 0;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab95f2fa73d00493b2fa1fc26eb37dc24">joinempty</a> = 0;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016">leavewhenempty</a> = 0;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">memberdelay</a> = 0;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> = 0;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb">timeoutrestart</a> = 0;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132">periodicannouncefrequency</a> = 0;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a3991228a9e7540246c6cc4cf42c0794d">randomperiodicannounce</a> = 0;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">numperiodicannounce</a> = 0;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0">QUEUE_AUTOPAUSE_OFF</a>;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#af983858a2192f96c9a30e44467b87f61">timeoutpriority</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844aabaf51de14755cf9b47a42c3cc460a87">TIMEOUT_PRIORITY_APP</a>;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aef5bac7c1f7fa063b8707596001536dd">autopausedelay</a> = 0;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;   <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>) {</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a> || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f">QUEUE_STRATEGY_RRORDERED</a>) {</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;         <span class="comment">/* linear strategy depends on order, so we have to place all members in a list */</span></div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a6659861a3baff7381bdfe00d7b36c19a">member_cmp_fn</a>);</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, 37,</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a663a7b1ad590cc3041706eb246d91ba7">member_hash_fn</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a6659861a3baff7381bdfe00d7b36c19a">member_cmp_fn</a>);</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      }</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;   }</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a> = 1;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, moh, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_next, <span class="stringliteral">&quot;queue-youarenext&quot;</span>);</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_thereare, <span class="stringliteral">&quot;queue-thereare&quot;</span>);</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_calls, <span class="stringliteral">&quot;queue-callswaiting&quot;</span>);</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, queue_quantity1, <span class="stringliteral">&quot;queue-quantity1&quot;</span>);</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, queue_quantity2, <span class="stringliteral">&quot;queue-quantity2&quot;</span>);</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_holdtime, <span class="stringliteral">&quot;queue-holdtime&quot;</span>);</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_minutes, <span class="stringliteral">&quot;queue-minutes&quot;</span>);</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_minute, <span class="stringliteral">&quot;queue-minute&quot;</span>);</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_seconds, <span class="stringliteral">&quot;queue-seconds&quot;</span>);</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_thanks, <span class="stringliteral">&quot;queue-thankyou&quot;</span>);</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_reporthold, <span class="stringliteral">&quot;queue-reporthold&quot;</span>);</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;   <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[0]) {</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[0] = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(32);</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;   }</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[0]) {</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[0], 0, <span class="stringliteral">&quot;queue-periodic-announce&quot;</span>);</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;   }</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;   <span class="keywordflow">for</span> (i = 1; i &lt; <a class="code" href="../../da/dfb/app__queue_8c.html#a2f5d1f6fb6cd3af5e8b07d19e4ab273a">MAX_PERIODIC_ANNOUNCEMENTS</a>; i++) {</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[i]) {</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[i], 0, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      }</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;   }</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;   <span class="keywordflow">while</span> ((pr_iter = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aad8539031f4bacde568540c592b07945">rules</a>,<a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>))) {</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(pr_iter);</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;   }</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;   <span class="comment">/* On restart assume no members are available.</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="comment">    * The queue_avail hint is a boolean state to indicate whether a member is available or not.</span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="comment">    * This seems counter intuitive, but is required to light a BLF</span></div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment">    * AST_DEVICE_INUSE indicates no members are available.</span></div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment">    * AST_DEVICE_NOT_INUSE indicates a member is available.</span></div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;   <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_avail&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;}</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;</div><div class="line"><a name="l02863"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3f75910c35a627fb9d15d0024fe0c36b"> 2863</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3f75910c35a627fb9d15d0024fe0c36b">clear_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q)</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;{</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a> = 0;</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> = 0;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a> = 0;</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a> = 0;</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a9d7f2e93f4bdd39ea6aa5eeaa02f0066">callsabandonedinsl</a> = 0;</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a> = 0;</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>) {</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      <span class="keywordflow">while</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;         mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a> = 0;</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;         mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a> = 0;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;         mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a> = 0;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;         mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> = 0;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      }</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;   }</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;}</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment"> * \brief Change queue penalty by adding rule.</span></div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment"> * Check rule for errors with time or fomatting, see if rule is relative to rest</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="comment"> * of queue, iterate list of rules to find correct insertion point, insert and return.</span></div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="comment"> * \retval -1 on failure</span></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="comment"> * \note Call this with the rule_lists locked</span></div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l02895"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab7086bc4304099aec95794ea6ed63260"> 2895</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab7086bc4304099aec95794ea6ed63260">insert_penaltychange</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *list_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *content, <span class="keyword">const</span> <span class="keywordtype">int</span> linenum)</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;{</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;   <span class="keywordtype">char</span> *timestr, *maxstr, *minstr, *raisestr, *contentdup;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *<a class="code" href="../../d3/d61/structrule.html">rule</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *rule_iter;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> *rl_iter;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;   <span class="keywordtype">int</span> penaltychangetime, inserted = 0;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;   <span class="keywordflow">if</span> (!(rule = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*rule)))) {</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;   }</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;   contentdup = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(content);</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;   <span class="keywordflow">if</span> (!(maxstr = strchr(contentdup, <span class="charliteral">&#39;,&#39;</span>))) {</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Improperly formatted penaltychange rule at line %d. Ignoring.\n&quot;</span>, linenum);</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(rule);</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;   }</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;   *maxstr++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;   <span class="keywordflow">if</span> ((minstr = strchr(maxstr,<span class="charliteral">&#39;,&#39;</span>))) {</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      *minstr++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      <span class="keywordflow">if</span> ((raisestr = strchr(minstr,<span class="charliteral">&#39;,&#39;</span>))) {</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;         *raisestr++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      }</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      raisestr = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;   }</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;   timestr = contentdup;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;   <span class="keywordflow">if</span> ((penaltychangetime = atoi(timestr)) &lt; 0) {</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Improper time parameter specified for penaltychange rule at line %d. Ignoring.\n&quot;</span>, linenum);</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(rule);</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   }</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;   rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a> = penaltychangetime;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;   <span class="comment">/* The last check will evaluate true if either no penalty change is indicated for a given rule</span></div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">    * OR if a min penalty change is indicated but no max penalty change is */</span></div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;   <span class="keywordflow">if</span> (*maxstr == <span class="charliteral">&#39;+&#39;</span> || *maxstr == <span class="charliteral">&#39;-&#39;</span> || *maxstr == <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> = 1;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;   }</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;   rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a> = atoi(maxstr);</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(minstr)) {</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;      <span class="keywordflow">if</span> (*minstr == <span class="charliteral">&#39;+&#39;</span> || *minstr == <span class="charliteral">&#39;-&#39;</span>) {</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;         rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a> = 1;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      }</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a> = atoi(minstr);</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;   } <span class="keywordflow">else</span> { <span class="comment">/*there was no minimum specified, so assume this means no change*/</span></div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a> = 1;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;   }</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(raisestr)) {</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      <span class="keywordflow">if</span> (*raisestr == <span class="charliteral">&#39;+&#39;</span> || *raisestr == <span class="charliteral">&#39;-&#39;</span>) {</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;         rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> = 1;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;      }</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a> = atoi(raisestr);</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;   } <span class="keywordflow">else</span> { <span class="comment">/*there was no raise specified, so assume this means no change*/</span></div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> = 1;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;   }</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;   <span class="comment">/*We have the rule made, now we need to insert it where it belongs*/</span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, rl_iter, <a class="code" href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">list</a>){</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      <span class="keywordflow">if</span> (strcasecmp(rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, list_name)) {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      }</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, rule_iter, <a class="code" href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">list</a>) {</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;         <span class="keywordflow">if</span> (rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a> &lt; rule_iter-&gt;time) {</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a83227c4f8c836f0452b607507c55752f">AST_LIST_INSERT_BEFORE_CURRENT</a>(rule, <a class="code" href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">list</a>);</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            inserted = 1;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;         }</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;      }</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      <span class="keywordflow">if</span> (!inserted) {</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, rule, <a class="code" href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">list</a>);</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;         inserted = 1;</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      }</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   }</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   <span class="keywordflow">if</span> (!inserted) {</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown rule list name %s; ignoring.\n&quot;</span>, list_name);</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(rule);</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;   }</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;}</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;<span class="comment"> * \brief Load queue rules from realtime.</span></div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;<span class="comment"> * Check rule for errors with time or fomatting, see if rule is relative to rest</span></div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;<span class="comment"> * of queue, iterate list of rules to find correct insertion point, insert and return.</span></div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="comment"> * \retval -1 on failure</span></div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="comment"> * \note Call this with the rule_lists locked</span></div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l02999"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a61e1b2c0b46092bc326d39def24be4f8"> 2999</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a61e1b2c0b46092bc326d39def24be4f8">load_realtime_rules</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;{</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> *rl_iter, *new_rl;</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *pr_iter;</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        <span class="keywordtype">char</span> *rulecat = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a910f835a41772603d33e200c956549ff">ast_check_realtime</a>(<span class="stringliteral">&quot;queue_rules&quot;</span>)) {</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Missing \&quot;queue_rules\&quot; in extconfig.conf\n&quot;</span>);</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;   }</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;   <span class="keywordflow">if</span> (!(cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a29ff8cd717c0c0bac60abbd827fec409">ast_load_realtime_multientry</a>(<span class="stringliteral">&quot;queue_rules&quot;</span>, <span class="stringliteral">&quot;rule_name LIKE&quot;</span>, <span class="stringliteral">&quot;%&quot;</span>, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>))) {</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to load queue rules from realtime\n&quot;</span>);</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;   }</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;   <span class="keywordflow">while</span> ((rulecat = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(cfg, rulecat))) {</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *timestr, *maxstr, *minstr, *raisestr, *rule_name;</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      <span class="keywordtype">int</span> penaltychangetime, rule_exists = 0, inserted = 0;</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <span class="keywordtype">int</span> max_penalty = 0, min_penalty = 0, raise_penalty = 0;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a> = 0, <a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> = 0, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> = 0;</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *new_penalty_rule = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      rule_name = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, rulecat, <span class="stringliteral">&quot;rule_name&quot;</span>);</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(rule_name)) {</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      }</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, rl_iter, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>) {</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;         <span class="keywordflow">if</span> (!(strcasecmp(rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, rule_name))) {</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;            rule_exists = 1;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;            new_rl = rl_iter;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;         }</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      }</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      <span class="keywordflow">if</span> (!rule_exists) {</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;         <span class="keywordflow">if</span> (!(new_rl = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*new_rl)))) {</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;         }</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(new_rl-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, rule_name, <span class="keyword">sizeof</span>(new_rl-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>));</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, new_rl, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      }</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      timestr = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, rulecat, <span class="stringliteral">&quot;time&quot;</span>);</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      <span class="keywordflow">if</span> (!(timestr) || sscanf(timestr, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;penaltychangetime) != 1) {</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Failed to parse time (%s) for one of the %s rules, skipping it\n&quot;</span>,</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(timestr) ? <span class="stringliteral">&quot;invalid value&quot;</span> : timestr), rule_name);</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;      }</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      <span class="keywordflow">if</span> (!(new_penalty_rule = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*new_penalty_rule)))) {</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;         <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;      }</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;      <span class="keywordflow">if</span> (!(maxstr = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, rulecat, <span class="stringliteral">&quot;max_penalty&quot;</span>)) ||</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(maxstr) || sscanf(maxstr, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;max_penalty) != 1) {</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;         max_penalty = 0;</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;         <a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> = 1;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;         <span class="keywordflow">if</span> (*maxstr == <span class="charliteral">&#39;+&#39;</span> || *maxstr == <span class="charliteral">&#39;-&#39;</span>) {</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;            <a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> = 1;</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;         }</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      }</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <span class="keywordflow">if</span> (!(minstr = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, rulecat, <span class="stringliteral">&quot;min_penalty&quot;</span>)) ||</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(minstr) || sscanf(minstr, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;min_penalty) != 1) {</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;         min_penalty = 0;</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;         min_relative = 1;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;         <span class="keywordflow">if</span> (*minstr == <span class="charliteral">&#39;+&#39;</span> || *minstr == <span class="charliteral">&#39;-&#39;</span>) {</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            min_relative = 1;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;         }</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;      }</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      <span class="keywordflow">if</span> (!(raisestr = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, rulecat, <span class="stringliteral">&quot;raise_penalty&quot;</span>)) ||</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(raisestr) || sscanf(raisestr, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;raise_penalty) != 1) {</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;         raise_penalty = 0;</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;         <a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> = 1;</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;         <span class="keywordflow">if</span> (*raisestr == <span class="charliteral">&#39;+&#39;</span> || *raisestr == <span class="charliteral">&#39;-&#39;</span>) {</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            <a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> = 1;</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;         }</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      }</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a> = penaltychangetime;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> = <a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a>;</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a> = max_penalty;</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a> = <a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a>;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;      new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a> = min_penalty;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;      new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> = <a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a>;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;      new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a> = raise_penalty;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;new_rl-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, pr_iter, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>) {</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;         <span class="keywordflow">if</span> (new_penalty_rule-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a> &lt; pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>) {</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a83227c4f8c836f0452b607507c55752f">AST_LIST_INSERT_BEFORE_CURRENT</a>(new_penalty_rule, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>);</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;            inserted = 1;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;         }</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      }</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      <span class="keywordflow">if</span> (!inserted) {</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;new_rl-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, new_penalty_rule, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>);</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      }</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;   }</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;}</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;</div><div class="line"><a name="l03101"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2faf444ec9b83e1847ac166c994ba3a8"> 3101</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2faf444ec9b83e1847ac166c994ba3a8">parse_empty_options</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6">empty_conditions</a> *empty, <span class="keywordtype">int</span> joinempty)</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;{</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;   <span class="keywordtype">char</span> *value_copy = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(value);</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;   <span class="keywordtype">char</span> *option = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;   <span class="keywordflow">while</span> ((option = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;value_copy, <span class="stringliteral">&quot;,&quot;</span>))) {</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;paused&quot;</span>)) {</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c">QUEUE_EMPTY_PAUSED</a>;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;penalty&quot;</span>)) {</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4">QUEUE_EMPTY_PENALTY</a>;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;inuse&quot;</span>)) {</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a85b9e406efa42c21f44d6f5b3ae9b332">QUEUE_EMPTY_INUSE</a>;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;ringing&quot;</span>)) {</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a6dd24d66d8fcdf0a3444d28ec9c82ba2">QUEUE_EMPTY_RINGING</a>;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;invalid&quot;</span>)) {</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af">QUEUE_EMPTY_INVALID</a>;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;wrapup&quot;</span>)) {</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6aec193cf33d944aed4807b36eefdbc1d1">QUEUE_EMPTY_WRAPUP</a>;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;unavailable&quot;</span>)) {</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6adfcf6310d20a8088a392ea40fa381e09">QUEUE_EMPTY_UNAVAILABLE</a>;</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;unknown&quot;</span>)) {</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;         *empty |= <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1532fb860aed655673cca9f18f44a7d1">QUEUE_EMPTY_UNKNOWN</a>;</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;loose&quot;</span>)) {</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;         *empty = (<a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4">QUEUE_EMPTY_PENALTY</a> | <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af">QUEUE_EMPTY_INVALID</a>);</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(option, <span class="stringliteral">&quot;strict&quot;</span>)) {</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;         *empty = (<a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4">QUEUE_EMPTY_PENALTY</a> | <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af">QUEUE_EMPTY_INVALID</a> | <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c">QUEUE_EMPTY_PAUSED</a> | <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6adfcf6310d20a8088a392ea40fa381e09">QUEUE_EMPTY_UNAVAILABLE</a>);</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(option) &amp;&amp; joinempty) || (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(option) &amp;&amp; !joinempty)) {</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;         *empty = (<a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4">QUEUE_EMPTY_PENALTY</a> | <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af">QUEUE_EMPTY_INVALID</a> | <a class="code" href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c">QUEUE_EMPTY_PAUSED</a>);</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(option) &amp;&amp; !joinempty) || (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(option) &amp;&amp; joinempty)) {</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;         *empty = 0;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown option %s for &#39;%s&#39;\n&quot;</span>, option, joinempty ? <span class="stringliteral">&quot;joinempty&quot;</span> : <span class="stringliteral">&quot;leavewhenempty&quot;</span>);</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      }</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;   }</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;}</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;<span class="comment">/*! \brief Configure a queue parameter.</span></div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;<span class="comment"> * The failunknown flag is set for config files (and static realtime) to show</span></div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;<span class="comment"> * errors for unknown parameters. It is cleared for dynamic realtime to allow</span></div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="comment"> *  extra fields in the tables.</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="comment"> * \note For error reporting, line number is passed for .conf static configuration,</span></div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="comment"> * for Realtime queues, linenum is -1.</span></div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l03144"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a94baaee180e6f6ae082418dc78e7c7cf"> 3144</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a94baaee180e6f6ae082418dc78e7c7cf">queue_set_param</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">const</span> <span class="keywordtype">char</span> *param, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d85/structval.html">val</a>, <span class="keywordtype">int</span> linenum, <span class="keywordtype">int</span> failunknown)</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;{</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;musicclass&quot;</span>) ||</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      !strcasecmp(param, <span class="stringliteral">&quot;music&quot;</span>) || !strcasecmp(param, <span class="stringliteral">&quot;musiconhold&quot;</span>)) {</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, moh, val);</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce&quot;</span>)) {</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, announce, val);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;context&quot;</span>)) {</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, val);</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;timeout&quot;</span>)) {</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = atoi(val);</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> &lt; 0) {</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#aad2dd72565852b91c809cd4685833b17">DEFAULT_TIMEOUT</a>;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;      }</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;ringinuse&quot;</span>)) {</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;setinterfacevar&quot;</span>)) {</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0c5bcd98bca1c3085183ba1fc80195ed">setinterfacevar</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;setqueuevar&quot;</span>)) {</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a32794c302b9a60821d519f6d4d1e7885">setqueuevar</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;setqueueentryvar&quot;</span>)) {</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a23486e86a21295aa734885d335ae9c2f">setqueueentryvar</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;monitor-format&quot;</span>)) {</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>, val, <span class="keyword">sizeof</span>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>));</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;membermacro&quot;</span>)) {</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, membermacro, val);</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;membergosub&quot;</span>)) {</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, membergosub, val);</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-youarenext&quot;</span>)) {</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_next, val);</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-thereare&quot;</span>)) {</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_thereare, val);</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-callswaiting&quot;</span>)) {</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_calls, val);</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-quantity1&quot;</span>)) {</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, queue_quantity1, val);</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-quantity2&quot;</span>)) {</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, queue_quantity2, val);</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-holdtime&quot;</span>)) {</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_holdtime, val);</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-minutes&quot;</span>)) {</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_minutes, val);</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-minute&quot;</span>)) {</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_minute, val);</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-seconds&quot;</span>)) {</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_seconds, val);</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-thankyou&quot;</span>)) {</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_thanks, val);</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-callerannounce&quot;</span>)) {</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_callerannounce, val);</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;queue-reporthold&quot;</span>)) {</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, sound_reporthold, val);</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce-frequency&quot;</span>)) {</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb">announcefrequency</a> = atoi(val);</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce-to-first-user&quot;</span>)) {</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a34c5860043ef96a75828b7107fcffb17">announce_to_first_user</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;min-announce-frequency&quot;</span>)) {</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7724cd5a7395de6d0cbc7f0a02b0c20a">minannouncefrequency</a> = atoi(val);</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s=%s for queue &#39;%s&#39;\n&quot;</span>, param, val, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce-round-seconds&quot;</span>)) {</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> = atoi(val);</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <span class="comment">/* Rounding to any other values just doesn&#39;t make sense... */</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      <span class="keywordflow">if</span> (!(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> == 0 || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> == 5 || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> == 10</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;         || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> == 15 || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> == 20 || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a> == 30)) {</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;         <span class="keywordflow">if</span> (linenum &gt;= 0) {</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;&#39;%s&#39; isn&#39;t a valid value for %s &quot;</span></div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;               <span class="stringliteral">&quot;using 0 instead for queue &#39;%s&#39; at line %d of queues.conf\n&quot;</span>,</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;               val, param, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, linenum);</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;&#39;%s&#39; isn&#39;t a valid value for %s &quot;</span></div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;               <span class="stringliteral">&quot;using 0 instead for queue &#39;%s&#39;\n&quot;</span>, val, param, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;         }</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a>=0;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      }</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce-holdtime&quot;</span>)) {</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(val, <span class="stringliteral">&quot;once&quot;</span>)) {</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ab37e1a4dafc93b1ded1edabe9927cf26">ANNOUNCEHOLDTIME_ONCE</a>;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val)) {</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a8e57e0916b189a3a78e018cc14e8cb1b">ANNOUNCEHOLDTIME_ALWAYS</a>;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> = 0;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      }</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce-position&quot;</span>)) {</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(val, <span class="stringliteral">&quot;limit&quot;</span>)) {</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a967650811eabe6b6373dddc731a286eb">ANNOUNCEPOSITION_LIMIT</a>;</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(val, <span class="stringliteral">&quot;more&quot;</span>)) {</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a183dcea5fd32422d981d4705cd770b15">ANNOUNCEPOSITION_MORE_THAN</a>;</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val)) {</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ae19c02c3c0ba9ca01d7ede746f736c45">ANNOUNCEPOSITION_YES</a>;</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a52464c2ddf292a0a9c91cfc7481b0178">ANNOUNCEPOSITION_NO</a>;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      }</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce-position-only-up&quot;</span>)) {</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2e7cadcc5625b17fdd07051a07a3773c">announceposition_only_up</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;announce-position-limit&quot;</span>)) {</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6">announcepositionlimit</a> = atoi(val);</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;periodic-announce&quot;</span>)) {</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <span class="keywordflow">if</span> (strchr(val, <span class="charliteral">&#39;,&#39;</span>)) {</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;         <span class="keywordtype">char</span> *s, *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(val);</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;         <span class="keywordflow">while</span> ((s = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;buf, <span class="stringliteral">&quot;,|&quot;</span>))) {</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;            <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[i]) {</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;               q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[i] = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(16);</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;            }</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[i], 0, <span class="stringliteral">&quot;%s&quot;</span>, s);</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;            i++;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;            <span class="keywordflow">if</span> (i == <a class="code" href="../../da/dfb/app__queue_8c.html#a2f5d1f6fb6cd3af5e8b07d19e4ab273a">MAX_PERIODIC_ANNOUNCEMENTS</a>) {</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;            }</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;         }</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">numperiodicannounce</a> = i;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[0], 0, <span class="stringliteral">&quot;%s&quot;</span>, val);</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">numperiodicannounce</a> = 1;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      }</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;periodic-announce-frequency&quot;</span>)) {</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132">periodicannouncefrequency</a> = atoi(val);</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;relative-periodic-announce&quot;</span>)) {</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#afca2abcaa89f99883d526c469268bcf4">relativeperiodicannounce</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;random-periodic-announce&quot;</span>)) {</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a3991228a9e7540246c6cc4cf42c0794d">randomperiodicannounce</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;retry&quot;</span>)) {</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b">retry</a> = atoi(val);</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b">retry</a> &lt;= 0) {</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b">retry</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a3f1683ed5a30b46922e3f88b7c716e04">DEFAULT_RETRY</a>;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;      }</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;wrapuptime&quot;</span>)) {</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a> = atoi(val);</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;penaltymemberslimit&quot;</span>)) {</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      <span class="keywordflow">if</span> ((sscanf(val, <span class="stringliteral">&quot;%10d&quot;</span>, &amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039">penaltymemberslimit</a>) != 1)) {</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039">penaltymemberslimit</a> = 0;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;      }</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;autofill&quot;</span>)) {</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a76e20f3c9df399ad87bb4e45c7419e99">autofill</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;monitor-type&quot;</span>)) {</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(val, <span class="stringliteral">&quot;mixmonitor&quot;</span>)) {</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7ccaa047c703f95f5eaf0dd0a10670b5">montype</a> = 1;</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;      }</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;autopause&quot;</span>)) {</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#af90b6bfe64cf7ef0df349ef23852ece3">autopause2int</a>(val);</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;autopausedelay&quot;</span>)) {</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aef5bac7c1f7fa063b8707596001536dd">autopausedelay</a> = atoi(val);</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;autopausebusy&quot;</span>)) {</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ae71026599525356a453ca8f5b2fd9bb0">autopausebusy</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;autopauseunavail&quot;</span>)) {</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a02a24815c7591a8655446b75e8dbaadd">autopauseunavail</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;maxlen&quot;</span>)) {</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a> = atoi(val);</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a> &lt; 0) {</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a> = 0;</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;      }</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;servicelevel&quot;</span>)) {</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>= atoi(val);</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;strategy&quot;</span>)) {</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../d8/d51/structstrategy.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>;</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      <span class="comment">/* We are a static queue and already have set this, no need to do it again */</span></div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      <span class="keywordflow">if</span> (failunknown) {</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      }</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      strategy = <a class="code" href="../../da/dfb/app__queue_8c.html#aeee3b4385050286dedc0e20f247d428c">strat2int</a>(val);</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;      <span class="keywordflow">if</span> (strategy &lt; 0) {</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;&#39;%s&#39; isn&#39;t a valid strategy for queue &#39;%s&#39;, using ringall instead\n&quot;</span>,</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;            val, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      }</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      <span class="keywordflow">if</span> (strategy == q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>) {</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;      }</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;      <span class="keywordflow">if</span> (strategy == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a>) {</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Changing to the linear strategy currently requires asterisk to be restarted.\n&quot;</span>);</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      }</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../d8/d51/structstrategy.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;joinempty&quot;</span>)) {</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a2faf444ec9b83e1847ac166c994ba3a8">parse_empty_options</a>(val, &amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab95f2fa73d00493b2fa1fc26eb37dc24">joinempty</a>, 1);</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;leavewhenempty&quot;</span>)) {</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a2faf444ec9b83e1847ac166c994ba3a8">parse_empty_options</a>(val, &amp;q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016">leavewhenempty</a>, 0);</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;reportholdtime&quot;</span>)) {</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a20ba21c586c791a31ef97102b4811a8f">reportholdtime</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;memberdelay&quot;</span>)) {</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">memberdelay</a> = atoi(val);</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;weight&quot;</span>)) {</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> = atoi(val);</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;timeoutrestart&quot;</span>)) {</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb">timeoutrestart</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;defaultrule&quot;</span>)) {</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, defaultrule, val);</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(param, <span class="stringliteral">&quot;timeoutpriority&quot;</span>)) {</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(val, <span class="stringliteral">&quot;conf&quot;</span>)) {</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#af983858a2192f96c9a30e44467b87f61">timeoutpriority</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844a94a7510a93b7241883228503227335af">TIMEOUT_PRIORITY_CONF</a>;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#af983858a2192f96c9a30e44467b87f61">timeoutpriority</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844aabaf51de14755cf9b47a42c3cc460a87">TIMEOUT_PRIORITY_APP</a>;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      }</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (failunknown) {</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      <span class="keywordflow">if</span> (linenum &gt;= 0) {</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown keyword in queue &#39;%s&#39;: %s at line %d of queues.conf\n&quot;</span>,</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, param, linenum);</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown keyword in queue &#39;%s&#39;: %s\n&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, param);</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;      }</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;   }</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;}</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;</div><div class="line"><a name="l03350"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5186e735a8b6b1d630a236fce8db0fd7"> 3350</a></span>&#160;<span class="preprocessor">#define QUEUE_PAUSED_DEVSTATE AST_DEVICE_INUSE</span></div><div class="line"><a name="l03351"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a232b6e5850a21fb799fdec8a3072bd45"> 3351</a></span>&#160;<span class="preprocessor">#define QUEUE_UNPAUSED_DEVSTATE AST_DEVICE_NOT_INUSE</span></div><div class="line"><a name="l03352"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad1b4e6774a06546a16f8870ab8618753"> 3352</a></span>&#160;<span class="preprocessor">#define QUEUE_UNKNOWN_PAUSED_DEVSTATE AST_DEVICE_NOT_INUSE</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="comment">/*! \internal</span></div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="comment"> * \brief If adding a single new member to a queue, use this function instead of ao2_linking.</span></div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;<span class="comment"> *        This adds round robin queue position data for a fresh member as well as links it.</span></div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;<span class="comment"> * \param queue Which queue the member is being added to</span></div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="comment"> * \param mem Which member is being added to the queue</span></div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03360"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac3cd051d456ef70c6b88a3c2c6056432"> 3360</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ac3cd051d456ef70c6b88a3c2c6056432">member_add_to_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *queue, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem)</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;{</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;   mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, mem);</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;   <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> ? <a class="code" href="../../da/dfb/app__queue_8c.html#a5186e735a8b6b1d630a236fce8db0fd7">QUEUE_PAUSED_DEVSTATE</a> : <a class="code" href="../../da/dfb/app__queue_8c.html#a232b6e5850a21fb799fdec8a3072bd45">QUEUE_UNPAUSED_DEVSTATE</a>,</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;      <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_pause_%s&quot;</span>, queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;}</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="comment">/*! \internal</span></div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="comment"> * \brief If removing a single member from a queue, use this function instead of ao2_unlinking.</span></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="comment"> *        This will perform round robin queue position reordering for the remaining members.</span></div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="comment"> * \param queue Which queue the member is being removed from</span></div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;<span class="comment"> * \param member Which member is being removed from the queue</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03376"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a"> 3376</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a">member_remove_from_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *queue, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem)</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;{</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(mem);</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;   <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#ad1b4e6774a06546a16f8870ab8618753">QUEUE_UNKNOWN_PAUSED_DEVSTATE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_pause_%s&quot;</span>, queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#abed8e0f3934b58e838f035e19ebb05c3">queue_member_follower_removal</a>(queue, mem);</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, mem);</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;}</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;<span class="comment"> * \brief Find rt member record to update otherwise create one.</span></div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;<span class="comment"> * Search for member in queue, if found update penalty/paused state,</span></div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;<span class="comment"> * if no member exists create one flag it as a RT member and add to queue member list.</span></div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l03392"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a102046cd40dd055e01a8b22491c89ce4"> 3392</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a102046cd40dd055e01a8b22491c89ce4">rt_handle_member_record</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keywordtype">char</span> *category, <span class="keyword">struct</span> <a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *member_config)</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;{</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;   <span class="keywordtype">int</span> penalty = 0;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;   <span class="keywordtype">int</span> paused  = 0;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;   <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;   <span class="keywordtype">int</span> wrapuptime = 0;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;   <span class="keywordtype">int</span> ringinuse = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *config_val;</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">interface </span>= <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, &quot;interface&quot;);</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *rt_uniqueid = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, <span class="stringliteral">&quot;uniqueid&quot;</span>);</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *membername = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, <span class="stringliteral">&quot;membername&quot;</span>), interface);</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *state_interface = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, <span class="stringliteral">&quot;state_interface&quot;</span>), interface);</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *penalty_str = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, <span class="stringliteral">&quot;penalty&quot;</span>);</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *paused_str = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, <span class="stringliteral">&quot;paused&quot;</span>);</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *wrapuptime_str = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, <span class="stringliteral">&quot;wrapuptime&quot;</span>);</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(rt_uniqueid)) {</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Realtime field &#39;uniqueid&#39; is empty for member %s\n&quot;</span>,</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(membername, <span class="stringliteral">&quot;NULL&quot;</span>));</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;   }</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(interface)) {</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Realtime field &#39;interface&#39; is empty for member %s\n&quot;</span>,</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(membername, <span class="stringliteral">&quot;NULL&quot;</span>));</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;   }</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;   <span class="keywordflow">if</span> (penalty_str) {</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      penalty = atoi(penalty_str);</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      <span class="keywordflow">if</span> ((penalty &lt; 0) &amp;&amp; negative_penalty_invalid) {</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (penalty &lt; 0) {</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;         penalty = 0;</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;      }</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;   }</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;   <span class="keywordflow">if</span> (paused_str) {</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;      paused = atoi(paused_str);</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      <span class="keywordflow">if</span> (paused &lt; 0) {</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;         paused = 0;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      }</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;   }</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;   <span class="keywordflow">if</span> (wrapuptime_str) {</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;      wrapuptime = atoi(wrapuptime_str);</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;      <span class="keywordflow">if</span> (wrapuptime &lt; 0) {</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;         wrapuptime = 0;</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;      }</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;   }</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;   <span class="keywordflow">if</span> ((config_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, category, realtime_ringinuse_field))) {</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(config_val)) {</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;         ringinuse = 1;</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(config_val)) {</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;         ringinuse = 0;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid value of &#39;%s&#39; field for %s in queue &#39;%s&#39;\n&quot;</span>, realtime_ringinuse_field, interface, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;      }</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;   }</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;   <span class="comment">/* Find member by realtime uniqueid and update */</span></div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;   <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>, rt_uniqueid)) {</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 0;   <span class="comment">/* Do not delete this one. */</span></div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>, rt_uniqueid, <span class="keyword">sizeof</span>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>));</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;         <span class="keywordflow">if</span> (paused_str) {</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;            m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> = paused;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;            <span class="keywordflow">if</span> (paused &amp;&amp; m-&gt;<a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a> == 0) {</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;               time(&amp;m-&gt;<a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a>); <span class="comment">/* XXX: Should this come from realtime? */</span></div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;            }</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> ? <a class="code" href="../../da/dfb/app__queue_8c.html#a5186e735a8b6b1d630a236fce8db0fd7">QUEUE_PAUSED_DEVSTATE</a> : <a class="code" href="../../da/dfb/app__queue_8c.html#a232b6e5850a21fb799fdec8a3072bd45">QUEUE_UNPAUSED_DEVSTATE</a>,</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;               <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_pause_%s&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;         }</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;         <span class="keywordflow">if</span> (strcasecmp(state_interface, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>)) {</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, state_interface, <span class="keyword">sizeof</span>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>));</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;         }</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a> = penalty;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> = ringinuse;</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a> = wrapuptime;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;         found = 1;</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      }</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;   }</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;   <span class="comment">/* Create a new member */</span></div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;   <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      <span class="keywordflow">if</span> ((m = <a class="code" href="../../da/dfb/app__queue_8c.html#a066e0020d2b8551be747bd42d26ab94a">create_queue_member</a>(interface, membername, penalty, paused, state_interface, ringinuse, wrapuptime))) {</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 0;</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a> = 1;</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>, rt_uniqueid, <span class="keyword">sizeof</span>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>));</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;         <span class="keywordflow">if</span> (!log_membername_as_agent) {</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;REALTIME&quot;</span>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, paused ? <span class="stringliteral">&quot;PAUSED&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;REALTIME&quot;</span>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, paused ? <span class="stringliteral">&quot;PAUSED&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;         }</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ac3cd051d456ef70c6b88a3c2c6056432">member_add_to_queue</a>(q, m);</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;         m = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      }</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;   }</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;}</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="comment">/*! \brief Iterate through queue&#39;s member list and delete them */</span></div><div class="line"><a name="l03503"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8821eb9b47e097bb4696445a321d5e4a"> 3503</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8821eb9b47e097bb4696445a321d5e4a">free_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keywordtype">int</span> all)</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;{</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;   <span class="comment">/* Free non-dynamic members */</span></div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *cur;</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;   <span class="keywordflow">while</span> ((cur = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;      <span class="keywordflow">if</span> (all || !cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a>) {</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a">member_remove_from_queue</a>(q, cur);</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;      }</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cur, -1);</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;   }</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;}</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;<span class="comment">/*! \brief Free queue&#39;s member list then its string fields */</span></div><div class="line"><a name="l03519"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae3a7c6d80cb3aad8b62a77b6b9a3946a"> 3519</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae3a7c6d80cb3aad8b62a77b6b9a3946a">destroy_queue</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;{</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = obj;</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8821eb9b47e097bb4696445a321d5e4a">free_members</a>(q, 1);</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(q);</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../da/dfb/app__queue_8c.html#a2f5d1f6fb6cd3af5e8b07d19e4ab273a">MAX_PERIODIC_ANNOUNCEMENTS</a>; i++) {</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[i]) {</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[i]);</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;      }</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;   }</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, -1);</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;}</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;</div><div class="line"><a name="l03534"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a73f936847e6ad20cb842d03593dc47c4"> 3534</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a73f936847e6ad20cb842d03593dc47c4">alloc_queue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename)</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;{</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a>(<span class="keyword">sizeof</span>(*q), <a class="code" href="../../da/dfb/app__queue_8c.html#ae3a7c6d80cb3aad8b62a77b6b9a3946a">destroy_queue</a>, <span class="stringliteral">&quot;Allocate queue&quot;</span>))) {</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(q, 64)) {</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;String field allocation failed&quot;</span>);</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;      }</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(q, <a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, queuename);</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;   }</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;   <span class="keywordflow">return</span> q;</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;}</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;<span class="comment"> * \brief Reload a single queue via realtime.</span></div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;<span class="comment"> * Check for statically defined queue first, check if deleted RT queue,</span></div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="comment"> * check for new RT queue, if queue vars are not defined init them with defaults.</span></div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;<span class="comment"> * reload RT queue vars, set RT queue members dead and reload them, return finished queue.</span></div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;<span class="comment"> * \retval the queue,</span></div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;<span class="comment"> * \retval NULL if it doesn&#39;t exist.</span></div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;<span class="comment"> * \note Should be called with the &quot;queues&quot; container locked.</span></div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l03558"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad3dd27f57e607377bad90d16cde6693b"> 3558</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ad3dd27f57e607377bad90d16cde6693b">find_queue_by_name_rt</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *queue_vars, <span class="keyword">struct</span> <a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *member_config)</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;{</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, tmpq = {</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;      .<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> = queuename,</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;   };</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;   <span class="keywordtype">char</span> *category = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp_name;</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;   <span class="keywordtype">char</span> tmpbuf[64];  <span class="comment">/* Must be longer than the longest queue param name. */</span></div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;   <span class="comment">/* Static queues override realtime. */</span></div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a>(queues, &amp;tmpq, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>, <span class="stringliteral">&quot;Check if static queue exists&quot;</span>))) {</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a>) {</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;         <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>) {</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Queue is dead; can&#39;t return it&quot;</span>);</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;         }</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Static queue &#39;%s&#39; already exists. Not loading from realtime\n&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;         <span class="keywordflow">return</span> q;</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;      }</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!member_config) {</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;      <span class="comment">/* Not found in the list, and it&#39;s not realtime ... */</span></div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;   }</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;   <span class="comment">/* Check if queue is defined in realtime. */</span></div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;   <span class="keywordflow">if</span> (!queue_vars) {</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      <span class="comment">/* Delete queue from in-core list if it has been deleted in realtime. */</span></div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      <span class="keywordflow">if</span> (q) {<span class="comment"></span></div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="comment">         /*! \note Hmm, can&#39;t seem to distinguish a DB failure from a not</span></div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;<span class="comment">            found condition... So we might delete an in-core queue</span></div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;<span class="comment">            in case of DB failure. */</span></div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Queue %s not found in realtime.\n&quot;</span>, queuename);</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 1;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;         <span class="comment">/* Delete if unused (else will be deleted when last caller leaves). */</span></div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a677f1c4c1a61e9e02d180803d8b8a008">queues_t_unlink</a>(queues, q, <span class="stringliteral">&quot;Unused; removing from container&quot;</span>);</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Queue is dead; can&#39;t return it&quot;</span>);</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;      }</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;   }</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;   <span class="comment">/* Create a new queue if an in-core entry does not exist yet. */</span></div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;   <span class="keywordflow">if</span> (!q) {</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *tmpvar = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;      <span class="keywordflow">if</span> (!(q = <a class="code" href="../../da/dfb/app__queue_8c.html#a73f936847e6ad20cb842d03593dc47c4">alloc_queue</a>(queuename))) {</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;      }</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a3f75910c35a627fb9d15d0024fe0c36b">clear_queue</a>(q);</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a> = 1;</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;      <span class="comment">/*Before we initialize the queue, we need to set the strategy, so that linear strategy</span></div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="comment">       * will allocate the members properly</span></div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;      <span class="keywordflow">for</span> (tmpvar = queue_vars; tmpvar; tmpvar = tmpvar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(tmpvar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;strategy&quot;</span>)) {</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#aeee3b4385050286dedc0e20f247d428c">strat2int</a>(tmpvar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;            <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> &lt; 0) {</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;&#39;%s&#39; isn&#39;t a valid strategy for queue &#39;%s&#39;, using ringall instead\n&quot;</span>,</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;               tmpvar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;               q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>;</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;            }</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;         }</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      }</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;      <span class="comment">/* We traversed all variables and didn&#39;t find a strategy */</span></div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;      <span class="keywordflow">if</span> (!tmpvar) {</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>;</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;      }</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a6d56dcc1f330ae7fe1b5a1ee832077c1">queues_t_link</a>(queues, q, <span class="stringliteral">&quot;Add queue to container&quot;</span>);</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;   }</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#aa76378a6ff09ce40268e214fdae6a61d">init_queue</a>(q);    <span class="comment">/* Ensure defaults for all parameters not set explicitly. */</span></div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;   memset(tmpbuf, 0, <span class="keyword">sizeof</span>(tmpbuf));</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;   <span class="keywordflow">for</span> (v = queue_vars; v; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;      <span class="comment">/* Convert to dashes `-&#39; from underscores `_&#39; as the latter are more SQL friendly. */</span></div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;      <span class="keywordflow">if</span> (strchr(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="charliteral">&#39;_&#39;</span>)) {</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmpbuf, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="keyword">sizeof</span>(tmpbuf));</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;         tmp_name = tmpbuf;</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;         tmp = tmpbuf;</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;         <span class="keywordflow">while</span> ((tmp = strchr(tmp, <span class="charliteral">&#39;_&#39;</span>))) {</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;            *tmp++ = <span class="charliteral">&#39;-&#39;</span>;</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;         }</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;         tmp_name = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>;</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      }</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      <span class="comment">/* NULL values don&#39;t get returned from realtime; blank values should</span></div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;<span class="comment">       * still get set.  If someone doesn&#39;t want a value to be set, they</span></div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="comment">       * should set the realtime column to NULL, not blank. */</span></div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a94baaee180e6f6ae082418dc78e7c7cf">queue_set_param</a>(q, tmp_name, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, -1, 0);</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;   }</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;   <span class="comment">/* Temporarily set realtime members dead so we can detect deleted ones. */</span></div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;   <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>) {</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 1;</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      }</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;   }</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;   <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(member_config, category))) {</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a102046cd40dd055e01a8b22491c89ce4">rt_handle_member_record</a>(q, category, member_config);</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;   }</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;   <span class="comment">/* Delete all realtime members that have been deleted in DB. */</span></div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;   <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>) {</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>) || !log_membername_as_agent) {</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;REALTIME&quot;</span>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;REALTIME&quot;</span>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;         }</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a">member_remove_from_queue</a>(q, m);</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;      }</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;   }</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;   <span class="keywordflow">return</span> q;</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;}</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;<span class="comment"> * note  */</span></div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;<span class="comment"> * \brief Returns reference to the named queue. If the queue is realtime, it will load the queue as well.</span></div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;<span class="comment"> * \param queuename - name of the desired queue</span></div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;<span class="comment"> * \retval the queue</span></div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;<span class="comment"> * \retval NULL if it doesn&#39;t exist</span></div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03702"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c"> 3702</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename)</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;{</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *queue_vars;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *member_config = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, tmpq = {</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      .name = queuename,</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;   };</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;   <span class="keywordtype">int</span> prev_weight = 0;</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;   <span class="comment">/* Find the queue in the in-core list first. */</span></div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;   q = <a class="code" href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a>(queues, &amp;tmpq, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>, <span class="stringliteral">&quot;Look for queue in memory first&quot;</span>);</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;   <span class="keywordflow">if</span> (!q || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a>) {<span class="comment"></span></div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;<span class="comment">      /*! \note Load from realtime before taking the &quot;queues&quot; container lock, to avoid blocking all</span></div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;<span class="comment">         queue operations while waiting for the DB.</span></div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;<span class="comment">         This will be two separate database transactions, so we might</span></div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="comment">         see queue parameters as they were before another process</span></div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;<span class="comment">         changed the queue and member list as it was after the change.</span></div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;<span class="comment">         Thus we might see an empty member list when a queue is</span></div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;<span class="comment">         deleted. In practise, this is unlikely to cause a problem. */</span></div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;      queue_vars = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1a03993603e2bc2463153857836645bb">ast_load_realtime</a>(<span class="stringliteral">&quot;queues&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>, queuename, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;      <span class="keywordflow">if</span> (queue_vars) {</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;         member_config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a29ff8cd717c0c0bac60abbd827fec409">ast_load_realtime_multientry</a>(<span class="stringliteral">&quot;queue_members&quot;</span>, <span class="stringliteral">&quot;interface LIKE&quot;</span>, <span class="stringliteral">&quot;%&quot;</span>, <span class="stringliteral">&quot;queue_name&quot;</span>, queuename, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;         <span class="keywordflow">if</span> (!member_config) {</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;No queue_members defined in config extconfig.conf\n&quot;</span>);</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            member_config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a3aac6b809a257df6ea7c3d2a9d22b9f5">ast_config_new</a>();</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;         }</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;      }</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      <span class="keywordflow">if</span> (q) {</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;         prev_weight = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> ? 1 : 0;</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Need to find realtime queue&quot;</span>);</div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;      }</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;      q = <a class="code" href="../../da/dfb/app__queue_8c.html#ad3dd27f57e607377bad90d16cde6693b">find_queue_by_name_rt</a>(queuename, queue_vars, member_config);</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(member_config);</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(queue_vars);</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      <span class="comment">/* update the use_weight value if the queue&#39;s has gained or lost a weight */</span></div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;      <span class="keywordflow">if</span> (q) {</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;         <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> &amp;&amp; prev_weight) {</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;use_weight, -1);</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;         }</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;         <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> &amp;&amp; !prev_weight) {</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;            <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;use_weight, +1);</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;         }</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;      }</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;      <span class="comment">/* Other cases will end up with the proper value for use_weight */</span></div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad4d94a7a9e04ddf7984d69a8737221f9">update_realtime_members</a>(q);</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;   }</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;   <span class="keywordflow">return</span> q;</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;}</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;</div><div class="line"><a name="l03757"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abc63b07b1a30653be5a5f722ce7ee39c"> 3757</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#abc63b07b1a30653be5a5f722ce7ee39c">update_realtime_member_field</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem, <span class="keyword">const</span> <span class="keywordtype">char</span> *queue_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *field, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>)</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;{</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;   <span class="keywordtype">int</span> ret = -1;</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>)) {</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;   }</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ab845019b2f1bb324ff57e14192d62c39">ast_update_realtime</a>(<span class="stringliteral">&quot;queue_members&quot;</span>, <span class="stringliteral">&quot;uniqueid&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>, field, value, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>)) &gt; 0) {</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;      ret = 0;</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;   }</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;}</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;</div><div class="line"><a name="l03773"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad4d94a7a9e04ddf7984d69a8737221f9"> 3773</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad4d94a7a9e04ddf7984d69a8737221f9">update_realtime_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q)</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;{</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *member_config = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;   <span class="keywordtype">char</span> *category = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;   <span class="keywordflow">if</span> (!(member_config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a29ff8cd717c0c0bac60abbd827fec409">ast_load_realtime_multientry</a>(<span class="stringliteral">&quot;queue_members&quot;</span>, <span class="stringliteral">&quot;interface LIKE&quot;</span>, <span class="stringliteral">&quot;%&quot;</span>, <span class="stringliteral">&quot;queue_name&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> , <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>))) {</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;      <span class="comment">/* This queue doesn&#39;t have realtime members. If the queue still has any realtime</span></div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment">       * members in memory, they need to be removed.</span></div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;      <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;         <span class="keywordflow">if</span> (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>) {</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a">member_remove_from_queue</a>(q, m);</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;         }</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;      }</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Queue %s has no realtime members defined. No need for update\n&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;   }</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;   <span class="comment">/* Temporarily set realtime  members dead so we can detect deleted ones.*/</span></div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;   <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>) {</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;         m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 1;</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      }</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;   }</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;   <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(member_config, category))) {</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a102046cd40dd055e01a8b22491c89ce4">rt_handle_member_record</a>(q, category, member_config);</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;   }</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;   <span class="comment">/* Delete all realtime members that have been deleted in DB. */</span></div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;   <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;      <span class="keywordflow">if</span> (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>) {</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>) || !log_membername_as_agent) {</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;REALTIME&quot;</span>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;REALTIME&quot;</span>, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;         }</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a">member_remove_from_queue</a>(q, m);</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      }</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;   }</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(member_config);</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;}</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;</div><div class="line"><a name="l03832"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa4bb418a30af8cf4e1be6aa3fea01016"> 3832</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa4bb418a30af8cf4e1be6aa3fea01016">join_queue</a>(<span class="keywordtype">char</span> *queuename, <span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2">queue_result</a> *reason, <span class="keywordtype">int</span> position)</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;{</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *cur, *prev = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = 0;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;   <span class="keywordtype">int</span> inserted = 0;</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;   <span class="keywordflow">if</span> (!(q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queuename))) {</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;   }</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;   <span class="comment">/* This is our one */</span></div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab95f2fa73d00493b2fa1fc26eb37dc24">joinempty</a>) {</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = 0;</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;      <span class="keywordflow">if</span> ((status = <a class="code" href="../../da/dfb/app__queue_8c.html#a2cfafe91008492ba14ad4a0f8e11ea63">get_member_status</a>(q, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab95f2fa73d00493b2fa1fc26eb37dc24">joinempty</a>, 0))) {</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;         *reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aed848300d343eb61491e3ddc2e562b9e">QUEUE_JOINEMPTY</a>;</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with realtime queue&quot;</span>);</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;         <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      }</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;   }</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;   <span class="keywordflow">if</span> (*reason == <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c">QUEUE_UNKNOWN</a> &amp;&amp; q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a> &amp;&amp; (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> &gt;= q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a>)) {</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      *reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a131d9c4fe1d72d7b5f8532708ae18285">QUEUE_FULL</a>;</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*reason == <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c">QUEUE_UNKNOWN</a>) {</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;      <span class="comment">/* There&#39;s space for us, put us at the right position inside</span></div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;<span class="comment">       * the queue.</span></div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;<span class="comment">       * Take into account the priority of the calling user */</span></div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      inserted = 0;</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      prev = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      cur = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>;</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;      <span class="keywordflow">while</span> (cur) {</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;         <span class="comment">/* We have higher priority than the current user, enter</span></div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;<span class="comment">          * before him, after all the other users with priority</span></div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="comment">          * higher or equal to our priority. */</span></div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;         <span class="keywordflow">if</span> ((!inserted) &amp;&amp; (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a> &gt; cur-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a>)) {</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#ab2d834859be2c32442d2817935a0e3c7">insert_entry</a>(q, prev, qe, &amp;pos);</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;            inserted = 1;</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;         }</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;         <span class="comment">/* &lt;= is necessary for the position comparison because it may not be possible to enter</span></div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;<span class="comment">          * at our desired position since higher-priority callers may have taken the position we want</span></div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;         <span class="keywordflow">if</span> (!inserted &amp;&amp; (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a> &gt;= cur-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a>) &amp;&amp; position &amp;&amp; (position &lt;= pos + 1)) {</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#ab2d834859be2c32442d2817935a0e3c7">insert_entry</a>(q, prev, qe, &amp;pos);</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;            inserted = 1;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;            <span class="comment">/*pos is incremented inside insert_entry, so don&#39;t need to add 1 here*/</span></div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;            <span class="keywordflow">if</span> (position &lt; pos) {</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Asked to be inserted at position %d but forced into position %d due to higher priority callers\n&quot;</span>, position, pos);</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;            }</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;         }</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;         cur-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = ++<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>;</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;         prev = cur;</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;         cur = cur-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>;</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;      }</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      <span class="comment">/* No luck, join at the end of the queue */</span></div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      <span class="keywordflow">if</span> (!inserted) {</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ab2d834859be2c32442d2817935a0e3c7">insert_entry</a>(q, prev, qe, &amp;pos);</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;      }</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542">moh</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6c0ebcc78965d8817651856e7914631d">moh</a>, <span class="keyword">sizeof</span>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542">moh</a>));</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#aa774cd5d9be3c23ac43ab1798f437339">announce</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aed4d53167e5f2010bf8eca8f645c3745">announce</a>, <span class="keyword">sizeof</span>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#aa774cd5d9be3c23ac43ab1798f437339">announce</a>));</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7faec841658b88ad0cfbc684853acad3">context</a>, <span class="keyword">sizeof</span>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>));</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>++;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> == 1) {</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;         <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea76d91d5d654cfa3edafb2afbe3e09b46">AST_DEVICE_RINGING</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;      }</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      res = 0;</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;      blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: i, s: i}&quot;</span>,</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;                 <span class="stringliteral">&quot;Queue&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;                 <span class="stringliteral">&quot;Position&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>,</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;                 <span class="stringliteral">&quot;Count&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga565fc39c360b014dd5d4054fa72bbae8">ast_channel_publish_cached_blob</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, queue_caller_join_type(), blob);</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Queue &#39;%s&#39; Join, Channel &#39;%s&#39;, Position &#39;%d&#39;\n&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> );</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;   }</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with realtime queue&quot;</span>);</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;}</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;</div><div class="line"><a name="l03916"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b"> 3916</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *filename)</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;{</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(filename)) {</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;   }</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/file_8h.html#ab9b8ab8e5ee34c9b4da25779255cafde">ast_fileexists</a>(filename, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(chan))) {</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;   }</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;   <a class="code" href="../../d2/d4d/file_8h.html#a3092bf11d4bba66f646562759608b1bc">ast_stopstream</a>(chan);</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;   res = <a class="code" href="../../d2/d4d/file_8h.html#a67c7e271b4ca70aca6d48fd48d121857">ast_streamfile</a>(chan, filename, <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(chan));</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      res = <a class="code" href="../../d2/d4d/file_8h.html#affc21cb57c6bf72a2cb7ec8a379b2137">ast_waitstream</a>(chan, <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>);</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;   }</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;   <a class="code" href="../../d2/d4d/file_8h.html#a3092bf11d4bba66f646562759608b1bc">ast_stopstream</a>(chan);</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;}</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="comment"> * \brief Check for valid exit from queue via goto</span></div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<span class="comment"> * \retval 0 if failure</span></div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="comment"> * \retval 1 if successful</span></div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l03945"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456"> 3945</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456">valid_exit</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>)</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;{</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;   <span class="keywordtype">int</span> digitlen = strlen(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>);</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;   <span class="comment">/* Prevent possible buffer overflow */</span></div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;   <span class="keywordflow">if</span> (digitlen &lt; <span class="keyword">sizeof</span>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>) - 2) {</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>[digitlen] = <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>[digitlen + 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;   }</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;   <span class="comment">/* If there&#39;s no context to goto, short-circuit */</span></div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>)) {</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;   }</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;   <span class="comment">/* If the extension is bad, then reset the digits to blank */</span></div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../db/de0/pbx_8h.html#a93f9868530c1e8a9d9d367d1ead8782e">ast_canmatch_extension</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>, 1,</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;   }</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;   <span class="comment">/* We have an exact match */</span></div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../db/de0/pbx_8h.html#a8f7166f50cb9642179c9b321b8143f55">ast_goto_if_exists</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>, 1)) {</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a12851de4518c71edbf5c5adb40976629">valid_digits</a> = 1;</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      <span class="comment">/* Return 1 on a successful goto */</span></div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;   }</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;}</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;</div><div class="line"><a name="l03980"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad395c86c08af4a1c22518966e9ead32f"> 3980</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad395c86c08af4a1c22518966e9ead32f">say_position</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keywordtype">int</span> <a class="code" href="../../d7/d9b/bridge__basic_8c.html#a6ab6e51f783d7cea98857990908996d3">ringing</a>)</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;{</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;   <span class="keywordtype">int</span> res = 0, announceposition = 0;</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;   <span class="keywordtype">long</span> avgholdmins, avgholdsecs;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;   <span class="keywordtype">int</span> say_thanks = 1;</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;   time_t now;</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;   <span class="comment">/* Let minannouncefrequency seconds pass between the start of each position announcement */</span></div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;   time(&amp;now);</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;   <span class="keywordflow">if</span> ((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6">last_pos</a>) &lt; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7724cd5a7395de6d0cbc7f0a02b0c20a">minannouncefrequency</a>) {</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;   }</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;   <span class="comment">/* If either our position has changed, or we are over the freq timer, say position */</span></div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;   <span class="keywordflow">if</span> ((qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac019537a959f6147cecffb126bb04381">last_pos_said</a> == qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>) &amp;&amp; ((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6">last_pos</a>) &lt; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb">announcefrequency</a>)) {</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;   }</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;   <span class="comment">/* Only announce if the caller&#39;s queue position has improved since last time */</span></div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2e7cadcc5625b17fdd07051a07a3773c">announceposition_only_up</a> &amp;&amp; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac019537a959f6147cecffb126bb04381">last_pos_said</a> &lt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>) {</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;   }</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;   <span class="keywordflow">if</span> (ringing) {</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,-1);</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;      <a class="code" href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;   }</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#ae19c02c3c0ba9ca01d7ede746f736c45">ANNOUNCEPOSITION_YES</a> ||</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a183dcea5fd32422d981d4705cd770b15">ANNOUNCEPOSITION_MORE_THAN</a> ||</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;      (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a967650811eabe6b6373dddc731a286eb">ANNOUNCEPOSITION_LIMIT</a> &amp;&amp;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> &lt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6">announcepositionlimit</a>)) {</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;         announceposition = 1;</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;   }</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;   <span class="keywordflow">if</span> (announceposition == 1) {</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      <span class="comment">/* Say we&#39;re next, if we are */</span></div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> == 1) {</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;         res = <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ae434b23b0508e678bde4b0ffc48dcab9">sound_next</a>);</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;         <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;            <span class="keywordflow">goto</span> posout;</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;         }</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      <span class="comment">/* Say there are more than N callers */</span></div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a183dcea5fd32422d981d4705cd770b15">ANNOUNCEPOSITION_MORE_THAN</a> &amp;&amp; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> &gt; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6">announcepositionlimit</a>) {</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;         res = (</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aad352c7fad0be66a9c20e717239b488d">queue_quantity1</a>) ||</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;            <a class="code" href="../../db/dce/say_8h.html#a899e1f86b2d65a32eeb6e17aabfa1f12">ast_say_number</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6">announcepositionlimit</a>, <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>,</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || <span class="comment">/* Needs gender */</span></div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a5b3b0db7403d11c5b32be0a53f4e4809">queue_quantity2</a>));</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;      <span class="comment">/* Say there are currently N callers waiting */</span></div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;         res = (</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0869cb7961f7e245b3b7f8ece1457d5f">sound_thereare</a>) ||</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;            <a class="code" href="../../db/dce/say_8h.html#a899e1f86b2d65a32eeb6e17aabfa1f12">ast_say_number</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>,</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || <span class="comment">/* Needs gender */</span></div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a85d956ea75a2f9be8f6a4d0f8c09268a">sound_calls</a>));</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;      }</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;         <span class="keywordflow">goto</span> playout;</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      }</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;   }</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;   <span class="comment">/* Round hold time to nearest minute */</span></div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;   avgholdmins = labs(((qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a> + 30) - (now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>)) / 60);</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;   <span class="comment">/* If they have specified a rounding then round the seconds as well */</span></div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a>) {</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;      avgholdsecs = (labs(((qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a> + 30) - (now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>))) - 60 * avgholdmins) / qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a>;</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;      avgholdsecs *= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">roundingseconds</a>;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;      avgholdsecs = 0;</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;   }</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Hold time for %s is %ld minute(s) %ld seconds\n&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, avgholdmins, avgholdsecs);</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;   <span class="comment">/* If the hold time is &gt;1 min, if it&#39;s enabled, and if it&#39;s not</span></div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;<span class="comment">      supposed to be only once and we have already said it, say it */</span></div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;   <span class="keywordflow">if</span> ((avgholdmins+avgholdsecs) &gt; 0 &amp;&amp; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> &amp;&amp;</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;      ((qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#ab37e1a4dafc93b1ded1edabe9927cf26">ANNOUNCEHOLDTIME_ONCE</a> &amp;&amp; !qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6">last_pos</a>) ||</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;      !(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#ab37e1a4dafc93b1ded1edabe9927cf26">ANNOUNCEHOLDTIME_ONCE</a>))) {</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;      res = <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1c463871b9383c36385eb3250e3f9e70">sound_holdtime</a>);</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;         <span class="keywordflow">goto</span> playout;</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;      }</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;      <span class="keywordflow">if</span> (avgholdmins &gt;= 1) {</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;         res = <a class="code" href="../../db/dce/say_8h.html#a899e1f86b2d65a32eeb6e17aabfa1f12">ast_say_number</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, avgholdmins, <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;         <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;            <span class="keywordflow">goto</span> playout;</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;         }</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;         <span class="keywordflow">if</span> (avgholdmins == 1) {</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;            res = <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a958d0897e16b3262a0579075e3999187">sound_minute</a>);</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;            <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;               <span class="keywordflow">goto</span> playout;</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;            }</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;            res = <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5a589c9dea9c88d7fea000ed1b8fc15">sound_minutes</a>);</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;            <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;               <span class="keywordflow">goto</span> playout;</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;            }</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;         }</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      }</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;      <span class="keywordflow">if</span> (avgholdsecs &gt;= 1) {</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;         res = <a class="code" href="../../db/dce/say_8h.html#a899e1f86b2d65a32eeb6e17aabfa1f12">ast_say_number</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, avgholdsecs, <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;         <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;            <span class="keywordflow">goto</span> playout;</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;         }</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;         res = <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a239514696fb2a3869913aee8fe9b83c7">sound_seconds</a>);</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;         <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;            <span class="keywordflow">goto</span> playout;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;         }</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      }</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">announceholdtime</a> &amp;&amp; !qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a>) {</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;      say_thanks = 0;</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;   }</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;posout:</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">announceposition</a>) {</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Told %s in %s their queue position (which was %d)\n&quot;</span>,</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>);</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;   }</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;   <span class="keywordflow">if</span> (say_thanks) {</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;      res = <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2ae7c9e1d1b6942f11170fac6fd73127">sound_thanks</a>);</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;   }</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;playout:</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;   <span class="keywordflow">if</span> ((res &gt; 0 &amp;&amp; !<a class="code" href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456">valid_exit</a>(qe, res))) {</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;      res = 0;</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;   }</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;   <span class="comment">/* Set our last_pos indicators */</span></div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;   qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6">last_pos</a> = now;</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;   qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac019537a959f6147cecffb126bb04381">last_pos_said</a> = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>;</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;   <span class="comment">/* Don&#39;t restart music on hold if we&#39;re about to exit the caller from the queue */</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;      <span class="keywordflow">if</span> (ringing) {</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;         <a class="code" href="../../dc/d07/musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7">ast_moh_start</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542">moh</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;      }</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;   }</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;}</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;</div><div class="line"><a name="l04128"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a43d6ec3224724bd43cc280902fe22991"> 4128</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a43d6ec3224724bd43cc280902fe22991">recalc_holdtime</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keywordtype">int</span> newholdtime)</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;{</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;   <span class="keywordtype">int</span> oldvalue;</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;   <span class="comment">/* Calculate holdtime using an exponential average */</span></div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;   <span class="comment">/* Thanks to SRT for this contribution */</span></div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;   <span class="comment">/* 2^2 (4) is the filter coefficient; a higher exponent would give old entries more weight */</span></div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;   <span class="keywordflow">if</span> ((qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> + qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>) == 0) {</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a> = newholdtime;</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      oldvalue = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a>;</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a> = (((oldvalue &lt;&lt; 2) - oldvalue) + newholdtime) &gt;&gt; 2;</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;   }</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;}</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;<span class="comment">/*! \brief Caller leaving queue.</span></div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;<span class="comment"> * Search the queue to find the leaving client, if found remove from queue</span></div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="comment"> * create manager event, move others up the queue.</span></div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l04151"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3135d5c6b468bef49c1e3fc5d7394f30"> 4151</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3135d5c6b468bef49c1e3fc5d7394f30">leave_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe)</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;{</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *current, *prev = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *pr_iter;</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;   <span class="keywordtype">int</span> pos = 0;</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;   <span class="keywordflow">if</span> (!(q = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>)) {</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;   }</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a92781796b10a269001fffa4646ac1a1f">queue_t_ref</a>(q, <span class="stringliteral">&quot;Copy queue pointer from queue entry&quot;</span>);</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;   prev = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;   <span class="keywordflow">for</span> (current = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>; current; current = current-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>) {</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;      <span class="keywordflow">if</span> (current == qe) {</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;         <span class="keywordtype">char</span> posstr[20];</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>--;</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;         <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>) {</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;         }</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;         blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: i, s: i}&quot;</span>,</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                    <span class="stringliteral">&quot;Queue&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                    <span class="stringliteral">&quot;Position&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>,</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                    <span class="stringliteral">&quot;Count&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;         <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga565fc39c360b014dd5d4054fa72bbae8">ast_channel_publish_cached_blob</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, queue_caller_leave_type(), blob);</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Queue &#39;%s&#39; Leave, Channel &#39;%s&#39;\n&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;         <span class="comment">/* Take us out of the queue */</span></div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;         <span class="keywordflow">if</span> (prev) {</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;            prev-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a> = current-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a> = current-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>;</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;         }</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;         <span class="comment">/* Free penalty rules */</span></div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;         <span class="keywordflow">while</span> ((pr_iter = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae75d4fd9822187bfe2bfe55a75b7c6ef">qe_rules</a>, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>))) {</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(pr_iter);</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;         }</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;         snprintf(posstr, <span class="keyword">sizeof</span>(posstr), <span class="stringliteral">&quot;%d&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>);</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;QUEUEPOSITION&quot;</span>, posstr);</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;         <span class="comment">/* Renumber the people after us in the queue based on a new count */</span></div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;         current-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = ++pos;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;         prev = current;</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;      }</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;   }</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;   <span class="comment">/*If the queue is a realtime queue, check to see if it&#39;s still defined in real time*/</span></div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a>) {</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;      <span class="keywordflow">if</span> (!(var = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1a03993603e2bc2463153857836645bb">ast_load_realtime</a>(<span class="stringliteral">&quot;queues&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>))) {</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 1;</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;         <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(var);</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;      }</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;   }</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>) {</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      <span class="comment">/* It&#39;s dead and nobody is in it, so kill it */</span></div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a677f1c4c1a61e9e02d180803d8b8a008">queues_t_unlink</a>(queues, q, <span class="stringliteral">&quot;Queue is now dead; remove it from the container&quot;</span>);</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;   }</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;   <span class="comment">/* unref the explicit ref earlier in the function */</span></div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Expire copied reference&quot;</span>);</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;}</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;<span class="comment"> * \brief Destroy the given callattempt structure and free it.</span></div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;<span class="comment"> * \since 1.8</span></div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="comment"> * \param doomed callattempt structure to destroy.</span></div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04228"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a88cbf36725c411333529927a28f37915"> 4228</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88cbf36725c411333529927a28f37915">callattempt_free</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *doomed)</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;{</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;   <span class="keywordflow">if</span> (doomed-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>) {</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(doomed-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>, -1);</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;   }</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;doomed-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>);</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(doomed-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a>);</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(doomed);</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;}</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;</div><div class="line"><a name="l04238"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad207b1688e9f5af13048c10a3ed4850d"> 4238</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad207b1688e9f5af13048c10a3ed4850d">publish_dial_end_event</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *exception, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;{</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *cur;</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;   <span class="keywordflow">for</span> (cur = outgoing; cur; cur = cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>) {</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;      <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> &amp;&amp; cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> != exception) {</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;         <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(in, cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, status);</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;      }</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;   }</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;}</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;<span class="comment">/*! \brief Hang up a list of outgoing calls */</span></div><div class="line"><a name="l04250"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a683847486195523a31706eeada8b4237"> 4250</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a683847486195523a31706eeada8b4237">hangupcalls</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *exception, <span class="keywordtype">int</span> cancel_answered_elsewhere)</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;{</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *oo;</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;   <span class="keywordflow">while</span> (outgoing) {</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;      <span class="comment">/* If someone else answered the call we should indicate this in the CANCEL */</span></div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;      <span class="comment">/* Hangup any existing lines we have open */</span></div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      <span class="keywordflow">if</span> (outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> &amp;&amp; (outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> != exception)) {</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;         <span class="keywordflow">if</span> (exception || cancel_answered_elsewhere) {</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d4/da3/causes_8h.html#aa71419a0c598e31312477c5a644e7440">AST_CAUSE_ANSWERED_ELSEWHERE</a>);</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;         }</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;         <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, <span class="stringliteral">&quot;CANCEL&quot;</span>);</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;         <span class="comment">/* When dialing channels it is possible that they may not ever</span></div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;<span class="comment">          * leave the not in use state (Local channels in particular) by</span></div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;<span class="comment">          * the time we cancel them. If this occurs but we know they were</span></div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;<span class="comment">          * dialed we explicitly remove them from the pending members</span></div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;<span class="comment">          * container so that subsequent call attempts occur.</span></div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;         <span class="keywordflow">if</span> (outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>) {</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>);</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;         }</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;      }</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      oo = outgoing;</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;      outgoing = outgoing-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>;</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      <a class="code" href="../../d6/db3/aoc_8h.html#a33b761090d3debbfd4cdb0c800a13bb2">ast_aoc_destroy_decoded</a>(oo-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a>);</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a88cbf36725c411333529927a28f37915">callattempt_free</a>(oo);</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;   }</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;}</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<span class="comment"> * \brief Get the number of members available to accept a call.</span></div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="comment"> * \note The queue passed in should be locked prior to this function call</span></div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;<span class="comment"> * \param[in] q The queue for which we are couting the number of available members</span></div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;<span class="comment"> * \return Return the number of available members in queue q</span></div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04290"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab9873b95b03723c7f06d85b044b9e96c"> 4290</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab9873b95b03723c7f06d85b044b9e96c">num_available_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q)</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;{</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;   <span class="keywordtype">int</span> avl = 0;</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;   <span class="keywordflow">while</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;      avl += <a class="code" href="../../da/dfb/app__queue_8c.html#a4fe68b376a679a230a33d09423e76b15">is_member_available</a>(q, mem);</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      <span class="comment">/* If autofill is not enabled or if the queue&#39;s strategy is ringall, then</span></div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;<span class="comment">       * we really don&#39;t care about the number of available members so much as we</span></div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;<span class="comment">       * do that there is at least one available.</span></div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;<span class="comment">       * In fact, we purposely will return from this function stating that only</span></div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;<span class="comment">       * one member is available if either of those conditions hold. That way,</span></div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;<span class="comment">       * functions which determine what action to take based on the number of available</span></div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;<span class="comment">       * members will operate properly. The reasoning is that even if multiple</span></div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;<span class="comment">       * members are available, only the head caller can actually be serviced.</span></div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;      <span class="keywordflow">if</span> ((!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a76e20f3c9df399ad87bb4e45c7419e99">autofill</a> || q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) &amp;&amp; avl) {</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      }</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;   }</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;   <span class="keywordflow">return</span> avl;</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;}</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;<span class="comment">/* traverse all defined queues which have calls waiting and contain this member</span></div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="comment">   return 0 if no other queue has precedence (higher weight) or 1 if found  */</span></div><div class="line"><a name="l04323"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a449c2a013ceb381a8f619d51fb609711"> 4323</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a449c2a013ceb381a8f619d51fb609711">compare_weight</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *rq, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>)</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;{</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;   <span class="keyword">struct </span>member *mem;</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;   <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      <span class="keywordflow">if</span> (q == rq) { <span class="comment">/* don&#39;t check myself, could deadlock */</span></div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;      }</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> &amp;&amp; q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>) {</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;         <span class="keywordflow">if</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, member, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>))) {</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Found matching member %s in queue &#39;%s&#39;\n&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;            <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> &gt; rq-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> &amp;&amp; q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> &gt;= <a class="code" href="../../da/dfb/app__queue_8c.html#ab9873b95b03723c7f06d85b044b9e96c">num_available_members</a>(q)) {</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Queue &#39;%s&#39; (weight %d, calls %d) is preferred over &#39;%s&#39; (weight %d, calls %d)\n&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, rq-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, rq-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a>, rq-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;               found = 1;</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;            }</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;         }</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      }</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;      <span class="keywordflow">if</span> (found) {</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      }</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;   }</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;   <span class="keywordflow">return</span> found;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;}</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="comment">/*! \brief common hangup actions */</span></div><div class="line"><a name="l04358"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33"> 4358</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *o)</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;{</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;   o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> = 0;</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>);</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;   o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;}</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;<span class="comment"> * \brief Check if the member status is available.</span></div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;<span class="comment"> * \param status Member status to check if available.</span></div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;<span class="comment"> * \retval non-zero if the member status is available.</span></div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04374"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae803d04a5ce0edaf0c49e2be684d9436"> 4374</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae803d04a5ce0edaf0c49e2be684d9436">member_status_available</a>(<span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;{</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;   <span class="keywordflow">return</span> status == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a> || status == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a">AST_DEVICE_UNKNOWN</a>;</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;}</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;<span class="comment"> * \brief Determine if can ring a queue entry.</span></div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;<span class="comment"> * \param qe Queue entry to check.</span></div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;<span class="comment"> * \param call Member call attempt.</span></div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;<span class="comment"> * \retval non-zero if an entry can be called.</span></div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04388"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a86b9ff2f0b12ba29cd6b78477ea012c3"> 4388</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a86b9ff2f0b12ba29cd6b78477ea012c3">can_ring_entry</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../d0/d29/chan__pjsip_8c.html#acc941e909d1ca6a0997028d9562d78da">call</a>)</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;{</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *memberp = call-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>;</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;   <span class="keywordflow">if</span> (memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>) {</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s paused, can&#39;t receive call\n&quot;</span>, call-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;   }</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;   <span class="keywordflow">if</span> (!memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> &amp;&amp; !<a class="code" href="../../da/dfb/app__queue_8c.html#ae803d04a5ce0edaf0c49e2be684d9436">member_status_available</a>(memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>)) {</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s not available, can&#39;t receive call\n&quot;</span>, call-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;   }</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;   <span class="keywordflow">if</span> (memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a>) {</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      wrapuptime = <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a>, memberp);</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;      wrapuptime = <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, memberp);</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;   }</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;   <span class="keywordflow">if</span> (wrapuptime &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>) &lt; wrapuptime) {</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Wrapuptime not yet expired on queue %s for %s\n&quot;</span>,</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;         (memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a> ? memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> : qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>),</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;         call-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;   }</div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;   <span class="keywordflow">if</span> (use_weight &amp;&amp; <a class="code" href="../../da/dfb/app__queue_8c.html#a449c2a013ceb381a8f619d51fb609711">compare_weight</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, memberp)) {</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Priority queue delaying call to %s:%s\n&quot;</span>,</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, call-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;   }</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;   <span class="keywordflow">if</span> (!memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>) {</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(pending_members);</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;      mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(pending_members, memberp,</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;              <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;      <span class="keywordflow">if</span> (mem) {</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;<span class="comment">          * If found that means this member is currently being attempted</span></div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;<span class="comment">          * from another calling thread, so stop trying from this thread</span></div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s has another call trying, can&#39;t receive call\n&quot;</span>,</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;              call-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(pending_members);</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;      }</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;<span class="comment">       * If not found add it to the container so another queue</span></div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;<span class="comment">       * won&#39;t attempt to call this member at the same time.</span></div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Add %s to pending_members\n&quot;</span>, memberp-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(pending_members, memberp);</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(pending_members);</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="comment">       * The queue member is available.  Get current status to be sure</span></div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="comment">       * because the device state and extension state callbacks may</span></div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="comment">       * not have updated the status yet.</span></div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#ae803d04a5ce0edaf0c49e2be684d9436">member_status_available</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#acfa0c49ab441d6095ecaaf9bcdf72c04">get_queue_member_status</a>(memberp))) {</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s actually not available, can&#39;t receive call\n&quot;</span>,</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;            call-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(memberp);</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      }</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;   }</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;}</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;<span class="comment"> * \brief Part 2 of ring_one</span></div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;<span class="comment"> * Does error checking before attempting to request a channel and call a member.</span></div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;<span class="comment"> * This function is only called from ring_one().</span></div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;<span class="comment"> * Failure can occur if:</span></div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;<span class="comment"> * - Agent on call</span></div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;<span class="comment"> * - Agent is paused</span></div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;<span class="comment"> * - Wrapup time not expired</span></div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;<span class="comment"> * - Priority by another queue</span></div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;<span class="comment"> * \retval 1 on success to reach a free agent</span></div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;<span class="comment"> * \retval 0 on failure to get agent.</span></div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04478"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac53cea8ee06b85c53f586133109f6ad7"> 4478</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ac53cea8ee06b85c53f586133109f6ad7">ring_entry</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>, <span class="keywordtype">int</span> *busies)</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;{</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;   <span class="keywordtype">char</span> tech[256];</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;   <span class="keywordtype">char</span> *location;</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *macrocontext, *macroexten;</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *nativeformats;</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;   <span class="comment">/* on entry here, we know that tmp-&gt;chan == NULL */</span></div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a86b9ff2f0b12ba29cd6b78477ea012c3">can_ring_entry</a>(qe, tmp)) {</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> = 0;</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      ++*busies;</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;   }</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tech, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, <span class="keyword">sizeof</span>(tech));</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;   <span class="keywordflow">if</span> ((location = strchr(tech, <span class="charliteral">&#39;/&#39;</span>))) {</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;      *location++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;      location = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;   }</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;   nativeformats = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;   <span class="comment">/* Request the peer */</span></div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;   tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a39fc055500e09810d0afd0bff87407c5">ast_request</a>(tech, nativeformats, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, location, &amp;status);</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(nativeformats);</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;   <span class="keywordflow">if</span> (!tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {       <span class="comment">/* If we can&#39;t, just go on to the next call */</span></div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a>++;</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930">linpos</a>++;</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>);</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad207b1688e9f5af13048c10a3ed4850d">publish_dial_end_event</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, tmp, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;BUSY&quot;</span>);</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> = 0;</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;      ++*busies;</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;   }</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ad1107e82de7494c8a10f19179e75b1fb">ast_channel_req_accountcodes_precious</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a31a465197a7766c3d0bb9f65f0a4418fa0e613bbe5c524be8c225eff98782e3a8">AST_CHANNEL_REQUESTOR_BRIDGE_PEER</a>);</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517">cancel_answered_elsewhere</a>) {</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d4/da3/causes_8h.html#aa71419a0c598e31312477c5a644e7440">AST_CAUSE_ANSWERED_ELSEWHERE</a>);</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;   }</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a14af45a19bb70a19d44cc965e88e0a3b">ast_channel_appl_set</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;AppQueue&quot;</span>);</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a4d7d602ffd3240a3deed5f01343ccd31">ast_channel_data_set</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;(Outgoing Line)&quot;</span>);</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;   memset(<a class="code" href="../../d5/d7b/channel_8h.html#ae616309e9eba6a1b009a0466bada50cc">ast_channel_whentohangup</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), 0, <span class="keyword">sizeof</span>(*<a class="code" href="../../d5/d7b/channel_8h.html#ae616309e9eba6a1b009a0466bada50cc">ast_channel_whentohangup</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)));</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;   <span class="comment">/* If the new channel has no callerid, try to guess what it should be */</span></div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>) {</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>) {</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d77/structast__party__caller.html">ast_party_caller</a> caller;</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a84a85d871e634a86b2421ac9354b50c6">ast_party_caller_set_init</a>(&amp;caller, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;         caller.<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>;</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;         caller.<a class="code" href="../../d4/d77/structast__party__caller.html#aeeb8c05290fd113bd0d1a3129898fd49">ani</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#aeeb8c05290fd113bd0d1a3129898fd49">ani</a>;</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a46837c158733334d2bb155bbd827ddb8">ast_channel_set_caller_event</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, &amp;caller, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d1/dd1/structast__party__dialed.html#a436a3700bd4ae24751d7fad4538466aa">number</a>.<a class="code" href="../../d1/dd1/structast__party__dialed.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>)) {</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a88d833a56ea7de33e230281c5c12b75d">ast_set_callerid</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d1/dd1/structast__party__dialed.html#a436a3700bd4ae24751d7fad4538466aa">number</a>.<a class="code" href="../../d1/dd1/structast__party__dialed.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac967e3cfb7640aa743eb1c4811d46be0">ast_channel_macroexten</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d5/d7b/channel_8h.html#aa8b52fbc8168e939bc5553502367d46a">ast_channel_exten</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)))) {</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a88d833a56ea7de33e230281c5c12b75d">ast_set_callerid</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac967e3cfb7640aa743eb1c4811d46be0">ast_channel_macroexten</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d5/d7b/channel_8h.html#aa8b52fbc8168e939bc5553502367d46a">ast_channel_exten</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;      }</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642">dial_callerid_absent</a> = 1;</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;   }</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af6f0b2102f29f86914e10a7787f0d536">ast_party_redirecting_copy</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d1/dd1/structast__party__dialed.html#af1107092b9e5d7570605297a465ec766">transit_network_select</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d1/dd1/structast__party__dialed.html#af1107092b9e5d7570605297a465ec766">transit_network_select</a>;</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;   <span class="comment">/* Inherit specially named variables from parent channel */</span></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a892b6550a4f90b70ad92198c9d05cedc">ast_channel_inherit_variables</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a6ce892974f59537bda03a71319b452e2">ast_channel_datastore_inherit</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;   <a class="code" href="../../d3/d93/max__forwards_8h.html#a63b977e0cb5f350171fed9dffd4fabe5">ast_max_forwards_decrement</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;   <span class="comment">/* Presense of ADSI CPE on outgoing channel follows ours */</span></div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aed40a28831fcb5791cd63c1b8761d659">ast_channel_adsicpe_set</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a828f537544a2ad2352c56c078390a0bd">ast_channel_adsicpe</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;   <span class="comment">/* Inherit context and extension */</span></div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;   macrocontext = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;MACRO_CONTEXT&quot;</span>);</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;   ast_channel_dialcontext_set(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(macrocontext) ? <a class="code" href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) : macrocontext);</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;   macroexten = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;MACRO_EXTEN&quot;</span>);</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(macroexten)) {</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a018b7a29cef2d62074dc46e9aaad0d1a">ast_channel_exten_set</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, macroexten);</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a018b7a29cef2d62074dc46e9aaad0d1a">ast_channel_exten_set</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d5/d7b/channel_8h.html#aa8b52fbc8168e939bc5553502367d46a">ast_channel_exten</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;   }</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;   <span class="comment">/* Save the original channel name to detect call pickup masquerading in. */</span></div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;   tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;   <span class="comment">/* PREDIAL: Run gosub on the callee&#39;s channel */</span></div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a>) {</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ad75b575faec0b9bac758d6a373ee762f">ast_pre_call</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a>);</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;   }</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;   <span class="comment">/* Place the call, but don&#39;t wait on the answer */</span></div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;   <span class="keywordflow">if</span> ((res = <a class="code" href="../../d5/d7b/channel_8h.html#a1b732eb4ed203140b1a3aae9e7dec2c1">ast_call</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, location, 0))) {</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;      <span class="comment">/* Again, keep going even if there&#39;s an error */</span></div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Couldn&#39;t call %s\n&quot;</span>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a>(tmp);</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;      ++*busies;</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;   }</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: s, s: s}&quot;</span>,</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;              <span class="stringliteral">&quot;Queue&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;              <span class="stringliteral">&quot;Interface&quot;</span>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>,</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;              <span class="stringliteral">&quot;MemberName&quot;</span>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8e96a6fc0050e0b3a0b79783d337aa3a">queue_publish_multi_channel_blob</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, queue_agent_called_type(), blob);</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Called %s\n&quot;</span>, tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>);</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;}</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;<span class="comment">/*! \brief find the entry with the best metric, or NULL */</span></div><div class="line"><a name="l04614"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab389b8ba466d7d05808b044592b05710"> 4614</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ab389b8ba466d7d05808b044592b05710">find_best</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a>)</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;{</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *best = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *cur;</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;   <span class="keywordflow">for</span> (cur = outgoing; cur; cur = cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>) {</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;      <span class="keywordflow">if</span> (cur-&gt;stillgoing &amp;&amp;              <span class="comment">/* Not already done */</span></div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;         !cur-&gt;chan &amp;&amp;              <span class="comment">/* Isn&#39;t already going */</span></div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;         (!best || cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> &lt; best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a>)) {     <span class="comment">/* We haven&#39;t found one yet, or it&#39;s better */</span></div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;         best = cur;</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;      }</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;   }</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;   <span class="keywordflow">return</span> best;</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;}</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;<span class="comment"> * \brief Place a call to a queue member.</span></div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;<span class="comment"> * Once metrics have been calculated for each member, this function is used</span></div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="comment"> * to place a call to the appropriate member (or members). The low-level</span></div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="comment"> * channel-handling and error detection is handled in ring_entry</span></div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;<span class="comment"> * \retval 1 if a member was called successfully</span></div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;<span class="comment"> * \retval 0 otherwise</span></div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04639"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31"> 4639</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31">ring_one</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a>, <span class="keywordtype">int</span> *busies)</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;{</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;   <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *cur;</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a>) {</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7a8f6a50f3db42cb40cad7cfbd1d54f9">ast_autoservice_start</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;      <span class="keywordflow">for</span> (cur = outgoing; cur; cur = cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>) {</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;         <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> &amp;&amp; cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7a8f6a50f3db42cb40cad7cfbd1d54f9">ast_autoservice_start</a>(cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;         }</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;      }</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;   }</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;   <span class="keywordflow">while</span> (ret == 0) {</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *best = <a class="code" href="../../da/dfb/app__queue_8c.html#ab389b8ba466d7d05808b044592b05710">find_best</a>(outgoing);</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;      <span class="keywordflow">if</span> (!best) {</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Nobody left to try ringing in queue\n&quot;</span>);</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;      }</div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) {</div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;         <span class="comment">/* Ring everyone who shares this best metric (for ringall) */</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;         <span class="keywordflow">for</span> (cur = outgoing; cur; cur = cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>) {</div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;            <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> &amp;&amp; !cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> &amp;&amp; cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> &lt;= best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a>) {</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;(Parallel) Trying &#39;%s&#39; with metric %d\n&quot;</span>, cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a>);</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;               ret |= <a class="code" href="../../da/dfb/app__queue_8c.html#ac53cea8ee06b85c53f586133109f6ad7">ring_entry</a>(qe, cur, busies);</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;               <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a> &amp;&amp; cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a7a8f6a50f3db42cb40cad7cfbd1d54f9">ast_autoservice_start</a>(cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;               }</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;            }</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;         }</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;         <span class="comment">/* Ring just the best channel */</span></div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Trying &#39;%s&#39; with metric %d\n&quot;</span>, best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a>);</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;         ret = <a class="code" href="../../da/dfb/app__queue_8c.html#ac53cea8ee06b85c53f586133109f6ad7">ring_entry</a>(qe, best, busies);</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;         <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a> &amp;&amp; best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7a8f6a50f3db42cb40cad7cfbd1d54f9">ast_autoservice_start</a>(best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;         }</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;      }</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;      <span class="comment">/* If we have timed out, break out */</span></div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Queue timed out while ringing members.\n&quot;</span>);</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;         ret = 0;</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;      }</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;   }</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a>) {</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;      <span class="keywordflow">for</span> (cur = outgoing; cur; cur = cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>) {</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;         <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> &amp;&amp; cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a08bde7d8cf72457fc8c519a4443b413b">ast_autoservice_stop</a>(cur-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;         }</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;      }</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a08bde7d8cf72457fc8c519a4443b413b">ast_autoservice_stop</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;   }</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;}</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;<span class="comment">/*! \brief Search for best metric and add to Round Robbin queue */</span></div><div class="line"><a name="l04699"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abdcc4a1bb61f226f36c2026ec3d65a35"> 4699</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#abdcc4a1bb61f226f36c2026ec3d65a35">store_next_rr</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a>)</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;{</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *best = <a class="code" href="../../da/dfb/app__queue_8c.html#ab389b8ba466d7d05808b044592b05710">find_best</a>(outgoing);</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;   <span class="keywordflow">if</span> (best) {</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      <span class="comment">/* Ring just the best channel */</span></div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Next is &#39;%s&#39; with metric %d\n&quot;</span>, best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a>);</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a> = best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> % 1000;</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      <span class="comment">/* Just increment rrpos */</span></div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ac3419e9b31cb1aebe3666439449bcecc">wrapped</a>) {</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;         <span class="comment">/* No more channels, start over */</span></div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a> = 0;</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;         <span class="comment">/* Prioritize next entry */</span></div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a>++;</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;      }</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;   }</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;   qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ac3419e9b31cb1aebe3666439449bcecc">wrapped</a> = 0;</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;}</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;<span class="comment">/*! \brief Search for best metric and add to Linear queue */</span></div><div class="line"><a name="l04723"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8a12ebde49cdd091865dc355f41a3cb9"> 4723</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8a12ebde49cdd091865dc355f41a3cb9">store_next_lin</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a>)</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;{</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *best = <a class="code" href="../../da/dfb/app__queue_8c.html#ab389b8ba466d7d05808b044592b05710">find_best</a>(outgoing);</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;   <span class="keywordflow">if</span> (best) {</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;      <span class="comment">/* Ring just the best channel */</span></div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Next is &#39;%s&#39; with metric %d\n&quot;</span>, best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a>);</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930">linpos</a> = best-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> % 1000;</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;      <span class="comment">/* Just increment rrpos */</span></div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab552667d2252975f206fb8a8af49888a">linwrapped</a>) {</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;         <span class="comment">/* No more channels, start over */</span></div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930">linpos</a> = 0;</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;         <span class="comment">/* Prioritize next entry */</span></div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930">linpos</a>++;</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      }</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;   }</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;   qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab552667d2252975f206fb8a8af49888a">linwrapped</a> = 0;</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;}</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;<span class="comment">/*! \brief Playback announcement to queued members if period has elapsed */</span></div><div class="line"><a name="l04747"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3d3fbc78100b994e44f9f270af21c451"> 4747</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3d3fbc78100b994e44f9f270af21c451">say_periodic_announcement</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keywordtype">int</span> <a class="code" href="../../d7/d9b/bridge__basic_8c.html#a6ab6e51f783d7cea98857990908996d3">ringing</a>)</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;{</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;   time_t now;</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;   <span class="comment">/* Get the current time */</span></div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;   time(&amp;now);</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;   <span class="comment">/* Check to see if it is time to announce */</span></div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;   <span class="keywordflow">if</span> ((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a26f62e545090b51f4c7e8efbf2db8d6b">last_periodic_announce_time</a>) &lt; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132">periodicannouncefrequency</a>) {</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;   }</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;   <span class="comment">/* Stop the music on hold so we can play our own file */</span></div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;   <span class="keywordflow">if</span> (ringing) {</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,-1);</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;      <a class="code" href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;   }</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Playing periodic announcement\n&quot;</span>);</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a3991228a9e7540246c6cc4cf42c0794d">randomperiodicannounce</a> &amp;&amp; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">numperiodicannounce</a>) {</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a> = ((<span class="keywordtype">unsigned</span> long) <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>()) % qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">numperiodicannounce</a>;</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a> &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">numperiodicannounce</a> ||</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a>]) == 0) {</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a> = 0;</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;   }</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;   <span class="comment">/* play the announcement */</span></div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;   res = <a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">sound_periodicannounce</a>[qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a>]));</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;   <span class="keywordflow">if</span> (res &gt; 0 &amp;&amp; !<a class="code" href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456">valid_exit</a>(qe, res)) {</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;      res = 0;</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;   }</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;   <span class="comment">/* Resume Music on Hold if the caller is going to stay in the queue */</span></div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;      <span class="keywordflow">if</span> (ringing) {</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;         <a class="code" href="../../dc/d07/musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7">ast_moh_start</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542">moh</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;      }</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;   }</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;   <span class="comment">/* update last_periodic_announce_time */</span></div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#afca2abcaa89f99883d526c469268bcf4">relativeperiodicannounce</a>) {</div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;      time(&amp;qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a26f62e545090b51f4c7e8efbf2db8d6b">last_periodic_announce_time</a>);</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a26f62e545090b51f4c7e8efbf2db8d6b">last_periodic_announce_time</a> = now;</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;   }</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;   <span class="comment">/* Update the current periodic announcement to the next announcement */</span></div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;   <span class="keywordflow">if</span> (!qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a3991228a9e7540246c6cc4cf42c0794d">randomperiodicannounce</a>) {</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a>++;</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;   }</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;}</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="comment">/*! \brief Record that a caller gave up on waiting in queue */</span></div><div class="line"><a name="l04808"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8"> 4808</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe)</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;{</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;   <span class="keywordtype">int</span> callabandonedinsl = 0;</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;   time_t now;</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;ABANDONED&quot;</span>, <span class="stringliteral">&quot;TRUE&quot;</span>);</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138">set_queue_variables</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: i, s: i, s: i}&quot;</span>,</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;              <span class="stringliteral">&quot;Queue&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;              <span class="stringliteral">&quot;Position&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>,</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;              <span class="stringliteral">&quot;OriginalPosition&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>,</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;              <span class="stringliteral">&quot;HoldTime&quot;</span>, (<span class="keywordtype">int</span>)(time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;   time(&amp;now);</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;   callabandonedinsl = ((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) &lt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>);</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;   <span class="keywordflow">if</span> (callabandonedinsl) {</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a9d7f2e93f4bdd39ea6aa5eeaa02f0066">callsabandonedinsl</a>++;</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;   }</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;   qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>++;</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga565fc39c360b014dd5d4054fa72bbae8">ast_channel_publish_cached_blob</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, queue_caller_abandon_type(), blob);</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;}</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;<span class="comment">/*! \brief RNA == Ring No Answer. Common code that is executed when we try a queue member and they don&#39;t answer. */</span></div><div class="line"><a name="l04839"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa559870517303cbc5a5e4964eec56033"> 4839</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa559870517303cbc5a5e4964eec56033">rna</a>(<span class="keywordtype">int</span> rnatime, <span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer, <span class="keywordtype">char</span> *<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, <span class="keywordtype">char</span> *membername, <span class="keywordtype">int</span> <a class="code" href="../../df/dd2/structautopause.html">autopause</a>)</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;{</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Nobody picked up in %d ms\n&quot;</span>, rnatime);</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;   <span class="comment">/* Stop ringing, and resume MOH if specified */</span></div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a93d5d1c5d8bf62627163cd9e53ed5048">ring_when_ringing</a>) {</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, -1);</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;      <a class="code" href="../../dc/d07/musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7">ast_moh_start</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542">moh</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;   }</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: s, s: s, s: i}&quot;</span>,</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;              <span class="stringliteral">&quot;Queue&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;              <span class="stringliteral">&quot;Interface&quot;</span>, interface,</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;              <span class="stringliteral">&quot;MemberName&quot;</span>, membername,</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;              <span class="stringliteral">&quot;RingTime&quot;</span>, rnatime);</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8e96a6fc0050e0b3a0b79783d337aa3a">queue_publish_multi_channel_blob</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, queue_agent_ringnoanswer_type(), blob);</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), membername, <span class="stringliteral">&quot;RINGNOANSWER&quot;</span>, <span class="stringliteral">&quot;%d&quot;</span>, rnatime);</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause</a> != <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0">QUEUE_AUTOPAUSE_OFF</a> &amp;&amp; autopause) {</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aef5bac7c1f7fa063b8707596001536dd">autopausedelay</a> &gt; 0) {</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;         <span class="keywordflow">if</span> ((mem = <a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, interface))) {</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;            time_t idletime = time(&amp;idletime)-mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>;</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;            <span class="keywordflow">if</span> ((mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a> != 0) &amp;&amp; (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aef5bac7c1f7fa063b8707596001536dd">autopausedelay</a> &gt; idletime)) {</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;               <span class="keywordflow">return</span>;</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;            }</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;         }</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;      }</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62a92b2b0d4b3b19ef4bd9b02a302f2026b">QUEUE_AUTOPAUSE_ON</a>) {</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, interface, <span class="stringliteral">&quot;Auto-Pause&quot;</span>, 1)) {</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Auto-Pausing Queue Member %s in queue %s since they failed to answer.\n&quot;</span>,</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;               interface, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Failed to pause Queue Member %s in queue %s!\n&quot;</span>, interface, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;         }</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;         <span class="comment">/* If queue autopause is mode all, just don&#39;t send any queue to stop.</span></div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;<span class="comment">         * the function will stop in all queues */</span></div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(<span class="stringliteral">&quot;&quot;</span>, interface, <span class="stringliteral">&quot;Auto-Pause&quot;</span>, 1)) {</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Auto-Pausing Queue Member %s in all queues since they failed to answer on queue %s.\n&quot;</span>,</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;                  interface, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Failed to pause Queue Member %s in all queues!\n&quot;</span>, interface);</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;         }</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;      }</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;   }</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;}</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;<span class="comment"> * \brief Update connected line on chan from peer.</span></div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;<span class="comment"> * \since 13.6.0</span></div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;<span class="comment"> * \param chan Channel to get connected line updated.</span></div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;<span class="comment"> * \param peer Channel providing connected line information.</span></div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;<span class="comment"> * \param is_caller Non-zero if chan is the calling channel.</span></div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04906"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa21a70b7d5a3490c980bd54a3f8ed5e3"> 4906</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa21a70b7d5a3490c980bd54a3f8ed5e3">update_connected_line_from_peer</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer, <span class="keywordtype">int</span> is_caller)</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;{</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> connected_caller;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a>(&amp;connected_caller);</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(peer);</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a>(&amp;connected_caller, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer));</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(peer);</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;   connected_caller.<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a07a87b2e6ed927503e2f95f119c9fc23">source</a> = <a class="code" href="../../de/d47/callerid_8h.html#a5cdbc47cd18e7f41d450e9caea186b1bac0f31b03872d178b92b054fb07358495">AST_CONNECTED_LINE_UPDATE_SOURCE_ANSWER</a>;</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a2661f0a9305c7a9ab779f55f4e57c1ad">ast_channel_connected_line_sub</a>(peer, chan, &amp;connected_caller, 0)</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;      &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#aa9958d9d3c90bdc9a37fff1243b4709b">ast_channel_connected_line_macro</a>(peer, chan, &amp;connected_caller, is_caller, 0)) {</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7ee3ff7bf7773329e9e20143f0ba2f69">ast_channel_update_connected_line</a>(chan, &amp;connected_caller, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;   }</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;connected_caller);</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;}</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;</div><div class="line"><a name="l04923"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a618d839aac1e2aa80050a5d54598a33d"> 4923</a></span>&#160;<span class="preprocessor">#define AST_MAX_WATCHERS 256</span></div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;<span class="comment"> * \brief Wait for a member to answer the call</span></div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;<span class="comment"> * \param[in] qe the queue_ent corresponding to the caller in the queue</span></div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;<span class="comment"> * \param[in] outgoing the list of callattempts. Relevant ones will have their chan and stillgoing parameters non-zero</span></div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;<span class="comment"> * \param[in] to the amount of time (in milliseconds) to wait for a response</span></div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;<span class="comment"> * \param[out] digit if a user presses a digit to exit the queue, this is the digit the caller pressed</span></div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;<span class="comment"> * \param[in] prebusies number of busy members calculated prior to calling wait_for_answer</span></div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;<span class="comment"> * \param[in] caller_disconnect if the &#39;H&#39; option is used when calling Queue(), this is used to detect if the caller pressed * to disconnect the call</span></div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;<span class="comment"> * \param[in] forwardsallowed used to detect if we should allow call forwarding, based on the &#39;i&#39; option to Queue()</span></div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;<span class="comment"> * \todo eventually all call forward logic should be intergerated into and replaced by ast_call_forward()</span></div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04937"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a0034e8c905ec7f5d1222f3ac4947efa8"> 4937</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a0034e8c905ec7f5d1222f3ac4947efa8">wait_for_answer</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a>, <span class="keywordtype">int</span> *to, <span class="keywordtype">char</span> *<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>, <span class="keywordtype">int</span> prebusies, <span class="keywordtype">int</span> caller_disconnect, <span class="keywordtype">int</span> forwardsallowed)</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;{</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queue = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>;</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *o, *start = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *prev = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;   <span class="keywordtype">int</span> numbusies = prebusies;</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;   <span class="keywordtype">int</span> numnochan = 0;</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> = 0;</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;   <span class="keywordtype">int</span> orig = *to;</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *f;</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *peer = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *winner;</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a> = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;   <span class="keywordtype">char</span> on[80] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;   <span class="keywordtype">char</span> membername[80] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;   <span class="keywordtype">long</span> starttime = 0;</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;   <span class="keywordtype">long</span> endtime = 0;</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;   <span class="keywordtype">char</span> *inchan_name;</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;   <span class="keyword">struct </span>timeval start_time_tv = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;   <span class="keywordtype">int</span> canceled_by_caller = 0; <span class="comment">/* 1 when caller hangs up or press digit or press * */</span></div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;   inchan_name = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;   starttime = (long) time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;   <span class="keywordflow">while</span> ((*to = <a class="code" href="../../de/df7/time_8h.html#a904a6933b710e14c7fa2029a0f0cc91a">ast_remaining_ms</a>(start_time_tv, orig)) &amp;&amp; !peer) {</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;      <span class="keywordtype">int</span> numlines, retry, pos = 1;</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *watchers[<a class="code" href="../../da/dfb/app__queue_8c.html#a618d839aac1e2aa80050a5d54598a33d">AST_MAX_WATCHERS</a>];</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;      watchers[0] = <a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>;</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;      start = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;      <span class="keywordflow">for</span> (retry = 0; retry &lt; 2; retry++) {</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;         numlines = 0;</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;         <span class="keywordflow">for</span> (o = outgoing; o; o = o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a>) { <span class="comment">/* Keep track of important channels */</span></div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;            <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a>) { <span class="comment">/* Keep track of important channels */</span></div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;               stillgoing = 1;</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;               <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;                  <span class="keywordflow">if</span> (pos &lt; <a class="code" href="../../da/dfb/app__queue_8c.html#a618d839aac1e2aa80050a5d54598a33d">AST_MAX_WATCHERS</a>) {</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;                     watchers[pos++] = o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;                  }</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;                  <span class="keywordflow">if</span> (!start) {</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;                     start = o;</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;                     prev-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">call_next</a> = o;</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;                  }</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                  prev = o;</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;               }</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prev) {</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;               prev-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">call_next</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;            }</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;            numlines++;</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;         }</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;         <span class="keywordflow">if</span> (pos &gt; 1 <span class="comment">/* found */</span> || !stillgoing <span class="comment">/* nobody listening */</span> ||</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;            (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> != <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) <span class="comment">/* ring would not be delivered */</span>) {</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;         }</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;         <span class="comment">/* On &quot;ringall&quot; strategy we only move to the next penalty level</span></div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;<span class="comment">            when *all* ringing phones are done in the current penalty level */</span></div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31">ring_one</a>(qe, outgoing, &amp;numbusies);</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;         <span class="comment">/* and retry... */</span></div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      }</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;      <span class="keywordflow">if</span> (pos == 1 <span class="comment">/* not found */</span>) {</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;         <span class="keywordflow">if</span> (numlines == (numbusies + numnochan)) {</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Everyone is busy at this time\n&quot;</span>);</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;No one is answering queue &#39;%s&#39; (%d numlines / %d busies / %d failed channels)\n&quot;</span>, queue, numlines, numbusies, numnochan);</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;         }</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;         *to = 0;</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;      }</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;      <span class="comment">/* Poll for events from both the incoming channel as well as any outgoing channels */</span></div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;      winner = <a class="code" href="../../d5/d7b/channel_8h.html#aec8ce59b78afbd3651f3de011f13290a">ast_waitfor_n</a>(watchers, pos, to);</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      <span class="comment">/* Service all of the outgoing channels */</span></div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      <span class="keywordflow">for</span> (o = start; o; o = o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">call_next</a>) {</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;         <span class="comment">/* We go with a fixed buffer here instead of using ast_strdupa. Using</span></div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;<span class="comment">          * ast_strdupa in a loop like this one can cause a stack overflow</span></div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;         <span class="keywordtype">char</span> ochan_name[<a class="code" href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a>];</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;         <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(ochan_name, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <span class="keyword">sizeof</span>(ochan_name));</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;         }</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;         <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> &amp;&amp; (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) &amp;&amp;  (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) == <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>)) {</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;            <span class="keywordflow">if</span> (!peer) {</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%s answered %s\n&quot;</span>, ochan_name, inchan_name);</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;               <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a></div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;                  &amp;&amp; strcmp(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a>, ochan_name)) {</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;                  <span class="comment">/*</span></div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;<span class="comment">                   * The channel name changed so we must generate COLP update.</span></div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;<span class="comment">                   * Likely because a call pickup channel masqueraded in.</span></div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;                  <a class="code" href="../../da/dfb/app__queue_8c.html#aa21a70b7d5a3490c980bd54a3f8ed5e3">update_connected_line_from_peer</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, 1);</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>) {</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;                  <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2">pending_connected_update</a>) {</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a2661f0a9305c7a9ab779f55f4e57c1ad">ast_channel_connected_line_sub</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, &amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, 0) &amp;&amp;</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#aa9958d9d3c90bdc9a37fff1243b4709b">ast_channel_connected_line_macro</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, &amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, 1, 0)) {</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#a7ee3ff7bf7773329e9e20143f0ba2f69">ast_channel_update_connected_line</a>(in, &amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;                     }</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642">dial_callerid_absent</a>) {</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;                     <a class="code" href="../../da/dfb/app__queue_8c.html#aa21a70b7d5a3490c980bd54a3f8ed5e3">update_connected_line_from_peer</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, 1);</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;                  }</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;               }</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;               <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a>) {</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;                  <span class="keywordtype">size_t</span> encoded_size;</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;                  <span class="keyword">struct </span><a class="code" href="../../d8/d72/structast__aoc__encoded.html">ast_aoc_encoded</a> *encoded;</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;                  <span class="keywordflow">if</span> ((encoded = <a class="code" href="../../d6/db3/aoc_8h.html#abbf1344a7eae88ea2cef85c1b0b6c24d">ast_aoc_encode</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a>, &amp;encoded_size, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>))) {</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(in, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a>, encoded, encoded_size);</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;                     <a class="code" href="../../d6/db3/aoc_8h.html#a8f66f98f015246c294b10dc2c9350612">ast_aoc_destroy_encoded</a>(encoded);</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;                  }</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;               }</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;               peer = o;</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;            }</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> &amp;&amp; (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> == winner)) {</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(on, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keyword">sizeof</span>(on));</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(membername, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="keyword">sizeof</span>(membername));</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;            <span class="comment">/* Before processing channel, go ahead and check for forwarding */</span></div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)) &amp;&amp; !forwardsallowed) {</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Forwarding %s to &#39;%s&#39; prevented.\n&quot;</span>, inchan_name, <a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;               <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf83a1fec8f09a2acf1dc6912207af41a">ast_channel_publish_dial_forward</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;                  <span class="stringliteral">&quot;CANCEL&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;               numnochan++;</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;               <a class="code" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a>(o);</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;               winner = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>))) {</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;               <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *original = o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;               <span class="keywordtype">char</span> forwarder[<a class="code" href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a>];</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;               <span class="keywordtype">char</span> tmpchan[256];</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;               <span class="keywordtype">char</span> *stuff;</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;               <span class="keywordtype">char</span> *<a class="code" href="../../df/d3c/structast__channel.html#aa8f6a3233b196d1a6b727edc83063a63">tech</a>;</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;               <span class="keywordtype">int</span> failed = 0;</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmpchan, <a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <span class="keyword">sizeof</span>(tmpchan));</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(forwarder, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <span class="keyword">sizeof</span>(forwarder));</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;               <span class="keywordflow">if</span> ((stuff = strchr(tmpchan, <span class="charliteral">&#39;/&#39;</span>))) {</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;                  *stuff++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;                  tech = tmpchan;</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *forward_context;</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;                  forward_context = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;FORWARD_CONTEXT&quot;</span>);</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;                  snprintf(tmpchan, <span class="keyword">sizeof</span>(tmpchan), <span class="stringliteral">&quot;%s@%s&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), forward_context ? forward_context : <a class="code" href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;                  stuff = tmpchan;</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;                  tech = <span class="stringliteral">&quot;Local&quot;</span>;</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;               }</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;               <span class="keywordflow">if</span> (!strcasecmp(tech, <span class="stringliteral">&quot;Local&quot;</span>)) {</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;                  <span class="comment">/*</span></div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;<span class="comment">                   * Drop the connected line update block for local channels since</span></div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;<span class="comment">                   * this is going to run dialplan and the user can change his</span></div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;<span class="comment">                   * mind about what connected line information he wants to send.</span></div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;                  o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a> = 0;</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;               }</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Now forwarding %s to &#39;%s/%s&#39; (thanks to %s)\n&quot;</span>, inchan_name, tech, stuff, ochan_name);</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;               <span class="comment">/* Setup parameters */</span></div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;               o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a39fc055500e09810d0afd0bff87407c5">ast_request</a>(tech, <a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(in), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, in, stuff, &amp;status);</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;               <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;                     <span class="stringliteral">&quot;Forwarding failed to create channel to dial &#39;%s/%s&#39;\n&quot;</span>,</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;                     tech, stuff);</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;                  o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> = 0;</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;                  numnochan++;</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, original);</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#af6f0b2102f29f86914e10a7787f0d536">ast_party_redirecting_copy</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(original));</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(original);</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in);</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a892b6550a4f90b70ad92198c9d05cedc">ast_channel_inherit_variables</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a6ce892974f59537bda03a71319b452e2">ast_channel_datastore_inherit</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                  <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;FORWARDERNAME&quot;</span>, forwarder);</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;                  <a class="code" href="../../d3/d93/max__forwards_8h.html#a63b977e0cb5f350171fed9dffd4fabe5">ast_max_forwards_decrement</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;                  <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2">pending_connected_update</a>) {</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                     <span class="comment">/*</span></div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;<span class="comment">                      * Re-seed the callattempt&#39;s connected line information with</span></div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;<span class="comment">                      * previously acquired connected line info from the queued</span></div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;<span class="comment">                      * channel.  The previously acquired connected line info could</span></div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;<span class="comment">                      * have been set through the CONNECTED_LINE dialplan function.</span></div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;<span class="comment">                      */</span></div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;                     o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2">pending_connected_update</a> = 0;</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#a5d3c15fe1dffda82e6dc03ca7b26526a">ast_party_connected_line_copy</a>(&amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(in));</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;                  }</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a>);</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;                  o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a6f3f42365ac84d888b55e35e1309f067">ast_channel_req_accountcodes</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, <a class="code" href="../../d5/d7b/channel_8h.html#a31a465197a7766c3d0bb9f65f0a4418fa0e613bbe5c524be8c225eff98782e3a8">AST_CHANNEL_REQUESTOR_BRIDGE_PEER</a>);</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                  <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a></div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                     || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>)) {</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;                     <span class="comment">/*</span></div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;<span class="comment">                      * The call was not previously redirected so it is</span></div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;<span class="comment">                      * now redirected from this number.</span></div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;<span class="comment">                      */</span></div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#abc7ac58271a860c92fee033afb031e8d">ast_party_number_free</a>(&amp;<a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>);</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#a27c4f1a52c8a53bc9e7122dc04e81344">ast_party_number_init</a>(&amp;<a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>);</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> = 1;</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">from</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a> =</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;                        <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac967e3cfb7640aa743eb1c4811d46be0">ast_channel_macroexten</a>(in), <a class="code" href="../../d5/d7b/channel_8h.html#aa8b52fbc8168e939bc5553502367d46a">ast_channel_exten</a>(in)));</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;                  }</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d1/dd1/structast__party__dialed.html#af1107092b9e5d7570605297a465ec766">transit_network_select</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a>(in)-&gt;<a class="code" href="../../d1/dd1/structast__party__dialed.html#af1107092b9e5d7570605297a465ec766">transit_network_select</a>;</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;                  o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642">dial_callerid_absent</a> = !<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a></div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;                     || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>);</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(in));</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(in);</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;                  <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> != <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a></div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;                     &amp;&amp; !o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>) {</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;                     <span class="keyword">struct </span><a class="code" href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a> redirecting;</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;                     <span class="comment">/*</span></div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;<span class="comment">                      * Redirecting updates to the caller make sense only on single</span></div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;<span class="comment">                      * call at a time strategies.</span></div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;<span class="comment">                      *</span></div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;<span class="comment">                      * We must unlock o-&gt;chan before calling</span></div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<span class="comment">                      * ast_channel_redirecting_macro, because we put o-&gt;chan into</span></div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;<span class="comment">                      * autoservice there.  That is pretty much a guaranteed</span></div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;<span class="comment">                      * deadlock.  This is why the handling of o-&gt;chan&#39;s lock may</span></div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;<span class="comment">                      * seem a bit unusual here.</span></div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;<span class="comment">                      */</span></div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#a1a5760823cd16fd0343e489efd9c8f89">ast_party_redirecting_init</a>(&amp;redirecting);</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#af6f0b2102f29f86914e10a7787f0d536">ast_party_redirecting_copy</a>(&amp;redirecting, <a class="code" href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a88fe9ad417e869049cb359030f06cab4">ast_channel_redirecting_sub</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, &amp;redirecting, 0) &amp;&amp;</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#a7176c4ba1352462039ef63412f425b00">ast_channel_redirecting_macro</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, &amp;redirecting, 1, 0)) {</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#ab025bba87d1757aa28e1a837596b1ead">ast_channel_update_redirecting</a>(in, &amp;redirecting, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;                     }</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#ac8bce0bf79829c59a7671c4eff83a31f">ast_party_redirecting_free</a>(&amp;redirecting);</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                  }</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a1b732eb4ed203140b1a3aae9e7dec2c1">ast_call</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, stuff, 0)) {</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                     <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Forwarding failed to dial &#39;%s/%s&#39;\n&quot;</span>,</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                        tech, stuff);</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;                     failed = 1;</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                  }</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;               }</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;               <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf83a1fec8f09a2acf1dc6912207af41a">ast_channel_publish_dial_forward</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, original, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                  <span class="stringliteral">&quot;CANCEL&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a>(original));</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;               <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;                  <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, stuff, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;               }</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;               <span class="keywordflow">if</span> (failed) {</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;                  <a class="code" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a>(o);</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;                  numnochan++;</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;               }</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;               <span class="comment">/* Hangup the original channel now, in case we needed it */</span></div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(winner);</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;            }</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;            f = <a class="code" href="../../d5/d7b/channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1">ast_read</a>(winner);</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;            <span class="keywordflow">if</span> (f) {</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;               <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>) {</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;                  <span class="keywordflow">switch</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>) {</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>:</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;                     <span class="comment">/* This is our guy if someone answered. */</span></div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;                     <span class="keywordflow">if</span> (!peer) {</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;                        <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%s answered %s\n&quot;</span>, ochan_name, inchan_name);</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;                        <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, <span class="stringliteral">&quot;ANSWER&quot;</span>);</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;                        <a class="code" href="../../da/dfb/app__queue_8c.html#ad207b1688e9f5af13048c10a3ed4850d">publish_dial_end_event</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, outgoing, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;CANCEL&quot;</span>);</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;                        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a></div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                           &amp;&amp; strcmp(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">orig_chan_name</a>, ochan_name)) {</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;                           <span class="comment">/*</span></div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;<span class="comment">                            * The channel name changed so we must generate COLP update.</span></div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;<span class="comment">                            * Likely because a call pickup channel masqueraded in.</span></div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;<span class="comment">                            */</span></div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;                           <a class="code" href="../../da/dfb/app__queue_8c.html#aa21a70b7d5a3490c980bd54a3f8ed5e3">update_connected_line_from_peer</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, 1);</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>) {</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;                           <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2">pending_connected_update</a>) {</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;                              <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a2661f0a9305c7a9ab779f55f4e57c1ad">ast_channel_connected_line_sub</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, &amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, 0) &amp;&amp;</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;                                 <a class="code" href="../../d5/d7b/channel_8h.html#aa9958d9d3c90bdc9a37fff1243b4709b">ast_channel_connected_line_macro</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, &amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, 1, 0)) {</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;                                 <a class="code" href="../../d5/d7b/channel_8h.html#a7ee3ff7bf7773329e9e20143f0ba2f69">ast_channel_update_connected_line</a>(in, &amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;                              }</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;                           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642">dial_callerid_absent</a>) {</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;                              <a class="code" href="../../da/dfb/app__queue_8c.html#aa21a70b7d5a3490c980bd54a3f8ed5e3">update_connected_line_from_peer</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, 1);</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;                           }</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;                        }</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;                        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a>) {</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;                           <span class="keywordtype">size_t</span> encoded_size;</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;                           <span class="keyword">struct </span><a class="code" href="../../d8/d72/structast__aoc__encoded.html">ast_aoc_encoded</a> *encoded;</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;                           <span class="keywordflow">if</span> ((encoded = <a class="code" href="../../d6/db3/aoc_8h.html#abbf1344a7eae88ea2cef85c1b0b6c24d">ast_aoc_encode</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a>, &amp;encoded_size, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>))) {</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;                              <a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(in, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a>, encoded, encoded_size);</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                              <a class="code" href="../../d6/db3/aoc_8h.html#a8f66f98f015246c294b10dc2c9350612">ast_aoc_destroy_encoded</a>(encoded);</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;                           }</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;                        }</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;                        peer = o;</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;                     }</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>:</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%s is busy\n&quot;</span>, ochan_name);</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;                     <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, <span class="stringliteral">&quot;BUSY&quot;</span>);</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;                     endtime = (long) time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;                     endtime -= starttime;</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;                     <a class="code" href="../../da/dfb/app__queue_8c.html#aa559870517303cbc5a5e4964eec56033">rna</a>(endtime * 1000, qe, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, membername, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ae71026599525356a453ca8f5b2fd9bb0">autopausebusy</a>);</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;                     <a class="code" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a>(o);</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;                     <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> != <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) {</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;                        <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb">timeoutrestart</a>) {</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;                           start_time_tv = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;                        }</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;                        <span class="comment">/* Have enough time for a queue member to answer? */</span></div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../de/df7/time_8h.html#a904a6933b710e14c7fa2029a0f0cc91a">ast_remaining_ms</a>(start_time_tv, orig) &gt; 500) {</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;                           <a class="code" href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31">ring_one</a>(qe, outgoing, &amp;numbusies);</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;                           starttime = (long) time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;                        }</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;                     }</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;                     numbusies++;</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>:</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%s is circuit-busy\n&quot;</span>, ochan_name);</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;                     <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, <span class="stringliteral">&quot;CONGESTION&quot;</span>);</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;                     endtime = (long) time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;                     endtime -= starttime;</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;                     <a class="code" href="../../da/dfb/app__queue_8c.html#aa559870517303cbc5a5e4964eec56033">rna</a>(endtime * 1000, qe, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, membername, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a02a24815c7591a8655446b75e8dbaadd">autopauseunavail</a>);</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;                     <a class="code" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a>(o);</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;                     <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> != <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) {</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;                        <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb">timeoutrestart</a>) {</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;                           start_time_tv = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;                        }</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../de/df7/time_8h.html#a904a6933b710e14c7fa2029a0f0cc91a">ast_remaining_ms</a>(start_time_tv, orig) &gt; 500) {</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;                           <a class="code" href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31">ring_one</a>(qe, outgoing, &amp;numbusies);</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                           starttime = (long) time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                        }</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;                     }</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;                     numbusies++;</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>:</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%s is ringing\n&quot;</span>, ochan_name);</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;</div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;                     <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, <span class="stringliteral">&quot;RINGING&quot;</span>);</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;                     <span class="comment">/* Start ring indication when the channel is ringing, if specified */</span></div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;                     <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a93d5d1c5d8bf62627163cd9e53ed5048">ring_when_ringing</a>) {</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;                        <a class="code" href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;                     }</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a28cd8e9f9005e25624f993d6edd46755">AST_CONTROL_OFFHOOK</a>:</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;                     <span class="comment">/* Ignore going off hook */</span></div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>:</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;                     <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>) {</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;                        <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Connected line update to %s prevented.\n&quot;</span>, inchan_name);</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;                     }</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;                     <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) {</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> connected;</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;                        <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%s connected line has changed. Saving it until answer for %s\n&quot;</span>, ochan_name, inchan_name);</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#ade95e66d7c53181894de1d3569aee2b8">ast_party_connected_line_set_init</a>(&amp;connected, &amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>);</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#a93d3e245d714d1ab18c5fb2ecb5cbf0e">ast_connected_line_parse_data</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>, &amp;connected);</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#a65d86fdffdd9c52b17b79b069cd0c6cb">ast_party_connected_line_set</a>(&amp;o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, &amp;connected, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;connected);</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;                        o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2">pending_connected_update</a> = 1;</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;                     }</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;                     <span class="comment">/*</span></div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;<span class="comment">                      * Prevent using the CallerID from the outgoing channel since we</span></div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;<span class="comment">                      * got a connected line update from it.</span></div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;<span class="comment">                      */</span></div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;                     o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642">dial_callerid_absent</a> = 1;</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a2661f0a9305c7a9ab779f55f4e57c1ad">ast_channel_connected_line_sub</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, f, 1) &amp;&amp;</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#aa9958d9d3c90bdc9a37fff1243b4709b">ast_channel_connected_line_macro</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, f, 1, 1)) {</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(in, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;                     }</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a>:</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;                     {</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;                        <span class="keyword">struct </span><a class="code" href="../../d9/dca/structast__aoc__decoded.html">ast_aoc_decoded</a> *decoded = <a class="code" href="../../d6/db3/aoc_8h.html#a3849b484bd42840860ada0ac3db4f96d">ast_aoc_decode</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;                        <span class="keywordflow">if</span> (decoded &amp;&amp; (<a class="code" href="../../d6/db3/aoc_8h.html#a34cb435b356514ce26df36a7bff4dfeb">ast_aoc_get_msg_type</a>(decoded) == <a class="code" href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548a3cdee929459fa195eabd19f5c156c7ec">AST_AOC_S</a>)) {</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;                           <a class="code" href="../../d6/db3/aoc_8h.html#a33b761090d3debbfd4cdb0c800a13bb2">ast_aoc_destroy_decoded</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a>);</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;                           o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">aoc_s_rate_list</a> = decoded;</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;                        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;                           <a class="code" href="../../d6/db3/aoc_8h.html#a33b761090d3debbfd4cdb0c800a13bb2">ast_aoc_destroy_decoded</a>(decoded);</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;                        }</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;                     }</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a">AST_CONTROL_REDIRECTING</a>:</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;                     <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) {</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;                        <span class="comment">/*</span></div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;<span class="comment">                         * Redirecting updates to the caller make sense only on single</span></div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="comment">                         * call at a time strategies.</span></div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="comment">                         */</span></div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;                     }</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;                     <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>) {</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;                        <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Redirecting update to %s prevented\n&quot;</span>,</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;                           inchan_name);</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;                     }</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%s redirecting info has changed, passing it to %s\n&quot;</span>,</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;                        ochan_name, inchan_name);</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a88fe9ad417e869049cb359030f06cab4">ast_channel_redirecting_sub</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, f, 1) &amp;&amp;</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#a7176c4ba1352462039ef63412f425b00">ast_channel_redirecting_macro</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, in, f, 1, 1)) {</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;                        <a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(in, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a">AST_CONTROL_REDIRECTING</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);</div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;                     }</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;                  <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41">AST_CONTROL_PVT_CAUSE_CODE</a>:</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(in, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41">AST_CONTROL_PVT_CAUSE_CODE</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;                  <span class="keywordflow">default</span>:</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Dunno what to do with control type %d\n&quot;</span>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>);</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;                  }</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;               }</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;               <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(f);</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">/* ast_read() returned NULL */</span></div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;               endtime = (long) time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - starttime;</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;               <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, <span class="stringliteral">&quot;NOANSWER&quot;</span>);</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;               <a class="code" href="../../da/dfb/app__queue_8c.html#aa559870517303cbc5a5e4964eec56033">rna</a>(endtime * 1000, qe, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, on, membername, 1);</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;               <a class="code" href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a>(o);</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;               <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> != <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>) {</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;                  <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb">timeoutrestart</a>) {</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;                     start_time_tv = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;                  }</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../de/df7/time_8h.html#a904a6933b710e14c7fa2029a0f0cc91a">ast_remaining_ms</a>(start_time_tv, orig) &gt; 500) {</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;                     <a class="code" href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31">ring_one</a>(qe, outgoing, &amp;numbusies);</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                     starttime = (long) time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;                  }</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;               }</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;            }</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;         }</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;      }</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;      <span class="comment">/* If we received an event from the caller, deal with it. */</span></div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;      <span class="keywordflow">if</span> (winner == in) {</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;         f = <a class="code" href="../../d5/d7b/channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1">ast_read</a>(in);</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;         <span class="keywordflow">if</span> (!f || ((f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>) &amp;&amp; (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a>))) {</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;            <span class="comment">/* Got hung up */</span></div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;            *to = -1;</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;            <span class="keywordflow">if</span> (f) {</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;               <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#a5ad776be1fb768f3399aafcd1b58b3a2">uint32</a>) {</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(in, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#a5ad776be1fb768f3399aafcd1b58b3a2">uint32</a>);</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;               }</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;               <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(f);</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;            }</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;            canceled_by_caller = 1;</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>) &amp;&amp; caller_disconnect &amp;&amp; (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a> == <span class="charliteral">&#39;*&#39;</span>)) {</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;User hit %c to disconnect call.\n&quot;</span>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>);</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;            *to = 0;</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;            <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(f);</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;            canceled_by_caller = 1;</div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>) &amp;&amp; <a class="code" href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456">valid_exit</a>(qe, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>)) {</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;User pressed digit: %c\n&quot;</span>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>);</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;            *to = 0;</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;            *digit = f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>;</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;            <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(f);</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;            canceled_by_caller = 1;</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;         }</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;         <span class="comment">/* When caller hung up or pressed * or digit. */</span></div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;         <span class="keywordflow">if</span> (canceled_by_caller) {</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#ad207b1688e9f5af13048c10a3ed4850d">publish_dial_end_event</a>(in, outgoing, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;CANCEL&quot;</span>);</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;            <span class="keywordflow">for</span> (o = start; o; o = o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">call_next</a>) {</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;               <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;RINGCANCELED&quot;</span>, <span class="stringliteral">&quot;%d&quot;</span>, (<span class="keywordtype">int</span>) <a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), start_time_tv));</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;               }</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;            }</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;         }</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;         <span class="comment">/* Send the frame from the in channel to all outgoing channels. */</span></div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;         <span class="keywordflow">for</span> (o = start; o; o = o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">call_next</a>) {</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;            <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> || !o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;               <span class="comment">/* This outgoing channel has died so don&#39;t send the frame to it. */</span></div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;            }</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;            <span class="keywordflow">switch</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>) {</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>:</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;               <span class="keywordflow">switch</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>) {</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;               <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>:</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;                  <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>) {</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Connected line update to %s prevented.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;                  }</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a2661f0a9305c7a9ab779f55f4e57c1ad">ast_channel_connected_line_sub</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, f, 1) &amp;&amp;</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#aa9958d9d3c90bdc9a37fff1243b4709b">ast_channel_connected_line_macro</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, f, 0, 1)) {</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;                  }</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;               <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a">AST_CONTROL_REDIRECTING</a>:</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;                  <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a>) {</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Redirecting update to %s prevented.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;                  }</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a88fe9ad417e869049cb359030f06cab4">ast_channel_redirecting_sub</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, f, 1) &amp;&amp;</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#a7176c4ba1352462039ef63412f425b00">ast_channel_redirecting_macro</a>(in, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, f, 0, 1)) {</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>);</div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;                  }</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;               <span class="keywordflow">default</span>:</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;                  <span class="comment">/* We are not going to do anything with this frame. */</span></div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;                  <span class="keywordflow">goto</span> skip_frame;</div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;               }</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;               <span class="comment">/* We are not going to do anything with this frame. */</span></div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;               <span class="keywordflow">goto</span> skip_frame;</div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;            }</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;         }</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;skip_frame:;</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;         <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(f);</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;      }</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;   }</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;   <span class="keywordflow">if</span> (!*to) {</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;      <span class="keywordflow">for</span> (o = start; o; o = o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">call_next</a>) {</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;         <span class="keywordflow">if</span> (o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#aa559870517303cbc5a5e4964eec56033">rna</a>(orig, qe, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, o-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, 1);</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;         }</div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;      }</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad207b1688e9f5af13048c10a3ed4850d">publish_dial_end_event</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, outgoing, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;NOANSWER&quot;</span>);</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;   }</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;   <span class="keywordflow">return</span> peer;</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;}</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;<span class="comment"> * \brief Check if we should start attempting to call queue members.</span></div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;<span class="comment"> * A simple process, really. Count the number of members who are available</span></div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;<span class="comment"> * to take our call and then see if we are in a position in the queue at</span></div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;<span class="comment"> * which a member could accept our call.</span></div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;<span class="comment"> * \param[in] qe The caller who wants to know if it is his turn</span></div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;<span class="comment"> * \retval 0 It is not our turn</span></div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;<span class="comment"> * \retval 1 It is our turn</span></div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05487"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a09df986cff00524f91c16051486231ec"> 5487</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a09df986cff00524f91c16051486231ec">is_our_turn</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe)</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;{</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *ch;</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;   <span class="keywordtype">int</span> avl;</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;   <span class="keywordtype">int</span> idx = 0;</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;   <span class="comment">/* This needs a lock. How many members are available to be served? */</span></div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;   avl = <a class="code" href="../../da/dfb/app__queue_8c.html#ab9873b95b03723c7f06d85b044b9e96c">num_available_members</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;   ch = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>;</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;There %s %d available %s.\n&quot;</span>, avl != 1 ? <span class="stringliteral">&quot;are&quot;</span> : <span class="stringliteral">&quot;is&quot;</span>, avl, avl != 1 ? <span class="stringliteral">&quot;members&quot;</span> : <span class="stringliteral">&quot;member&quot;</span>);</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;</div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;   <span class="keywordflow">while</span> ((idx &lt; avl) &amp;&amp; (ch) &amp;&amp; (ch != qe)) {</div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;      <span class="keywordflow">if</span> (!ch-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a79ec26d453dcd29aec17f5536233e849">pending</a>) {</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;         idx++;</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;      }</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;      ch = ch-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>;</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;   }</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;</div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;   <span class="comment">/* If the queue entry is within avl [the number of available members] calls from the top ...</span></div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;<span class="comment">    * Autofill and position check added to support autofill=no (as only calls</span></div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;<span class="comment">    * from the front of the queue are valid when autofill is disabled)</span></div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;   <span class="keywordflow">if</span> (ch &amp;&amp; idx &lt; avl &amp;&amp; (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a76e20f3c9df399ad87bb4e45c7419e99">autofill</a> || qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> == 1)) {</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;It&#39;s our turn (%s).\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;      res = 1;</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;It&#39;s not our turn (%s).\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;      res = 0;</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;   }</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;   <span class="comment">/* Update realtime members if this is the first call and number of avalable members is 0 */</span></div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;   <span class="keywordflow">if</span> (avl == 0 &amp;&amp; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> == 1) {</div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad4d94a7a9e04ddf7984d69a8737221f9">update_realtime_members</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;   }</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;}</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;<span class="comment"> * \brief update rules for queues</span></div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;<span class="comment"> * Calculate min/max penalties making sure if relative they stay within bounds.</span></div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="comment"> * Update queues penalty and set dialplan vars, goto next list entry.</span></div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l05536"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa1efb798e09a88e68559b08c90c573ee"> 5536</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa1efb798e09a88e68559b08c90c573ee">update_qe_rule</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe)</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;{</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a> = INT_MAX;</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a> != INT_MAX) {</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;      <span class="keywordtype">char</span> max_penalty_str[20];</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a>) {</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;         max_penalty = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a> + qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a>;</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;         max_penalty = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a>;</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;      }</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;      <span class="comment">/* a relative change to the penalty could put it below 0 */</span></div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;      <span class="keywordflow">if</span> (max_penalty &lt; 0) {</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;         max_penalty = 0;</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;      }</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;      snprintf(max_penalty_str, <span class="keyword">sizeof</span>(max_penalty_str), <span class="stringliteral">&quot;%d&quot;</span>, max_penalty);</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;QUEUE_MAX_PENALTY&quot;</span>, max_penalty_str);</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a> = <a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>;</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Setting max penalty to %d for caller %s since %d seconds have elapsed\n&quot;</span>,</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>);</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;   }</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a> != INT_MAX) {</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;      <span class="keywordtype">char</span> min_penalty_str[20];</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>;</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a>) {</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;         min_penalty = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a> + qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a>;</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;         min_penalty = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a>;</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;      }</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;      <span class="comment">/* a relative change to the penalty could put it below 0 */</span></div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;      <span class="keywordflow">if</span> (min_penalty &lt; 0) {</div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;         min_penalty = 0;</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;      }</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;      <span class="keywordflow">if</span> (max_penalty != INT_MAX &amp;&amp; min_penalty &gt; max_penalty) {</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;         min_penalty = <a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>;</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;      }</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;      snprintf(min_penalty_str, <span class="keyword">sizeof</span>(min_penalty_str), <span class="stringliteral">&quot;%d&quot;</span>, min_penalty);</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;QUEUE_MIN_PENALTY&quot;</span>, min_penalty_str);</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a> = <a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>;</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Setting min penalty to %d for caller %s since %d seconds have elapsed\n&quot;</span>,</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>);</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;   }</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a> != INT_MAX) {</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;      <span class="keywordtype">char</span> raise_penalty_str[20];</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>;</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a>) {</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;         raise_penalty = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a> + qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a>;</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;         raise_penalty = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a>;</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;      }</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;      <span class="comment">/* a relative change to the penalty could put it below 0 */</span></div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;      <span class="keywordflow">if</span> (raise_penalty &lt; 0) {</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;         raise_penalty = 0;</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;      }</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;      <span class="keywordflow">if</span> (max_penalty != INT_MAX &amp;&amp; raise_penalty &gt; max_penalty) {</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;         raise_penalty = <a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>;</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;      }</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;      snprintf(raise_penalty_str, <span class="keyword">sizeof</span>(raise_penalty_str), <span class="stringliteral">&quot;%d&quot;</span>, raise_penalty);</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;QUEUE_RAISE_PENALTY&quot;</span>, raise_penalty_str);</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a> = <a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>;</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Setting raised penalty to %d for caller %s since %d seconds have elapsed\n&quot;</span>,</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>);</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;   }</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;   qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a> = <a class="code" href="../../df/d90/linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6">AST_LIST_NEXT</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>, list);</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;}</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;<span class="comment">/*! \brief The waiting areas for callers who are not actively calling members</span></div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;<span class="comment"> * This function is one large loop. This function will return if a caller</span></div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;<span class="comment"> * either exits the queue or it becomes that caller&#39;s turn to attempt calling</span></div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;<span class="comment"> * queue members. Inside the loop, we service the caller with periodic announcements,</span></div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;<span class="comment"> * holdtime announcements, etc. as configured in queues.conf</span></div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;<span class="comment"> * \retval  0 if the caller&#39;s turn has arrived</span></div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;<span class="comment"> * \retval -1 if the caller should exit the queue.</span></div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05626"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a54d8f5c6ba5bd46020c7c319fa5a89c2"> 5626</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a54d8f5c6ba5bd46020c7c319fa5a89c2">wait_our_turn</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keywordtype">int</span> <a class="code" href="../../d7/d9b/bridge__basic_8c.html#a6ab6e51f783d7cea98857990908996d3">ringing</a>, <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2">queue_result</a> *reason)</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;{</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;   <span class="comment">/* This is the holding pen for callers 2 through maxlen */</span></div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a09df986cff00524f91c16051486231ec">is_our_turn</a>(qe)) {</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;      }</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      <span class="comment">/* If we have timed out, break out */</span></div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;         *reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      }</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016">leavewhenempty</a>) {</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = 0;</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;         <span class="keywordflow">if</span> ((status = <a class="code" href="../../da/dfb/app__queue_8c.html#a2cfafe91008492ba14ad4a0f8e11ea63">get_member_status</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016">leavewhenempty</a>, 0))) {</div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(qe);</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;            *reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101">QUEUE_LEAVEEMPTY</a>;</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;EXITEMPTY&quot;</span>, <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;            res = -1;</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;            qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab234be20f2e48f4f08d2d2c071b8ff55">handled</a> = -1;</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;         }</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      }</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;</div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;      <span class="comment">/* Make a position announcement, if enabled */</span></div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb">announcefrequency</a> &amp;&amp;</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;         (res = <a class="code" href="../../da/dfb/app__queue_8c.html#ad395c86c08af4a1c22518966e9ead32f">say_position</a>(qe,ringing))) {</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;      }</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;      <span class="comment">/* If we have timed out, break out */</span></div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;         *reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;      }</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;      <span class="comment">/* Make a periodic announcement, if enabled */</span></div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132">periodicannouncefrequency</a> &amp;&amp;</div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;         (res = <a class="code" href="../../da/dfb/app__queue_8c.html#a3d3fbc78100b994e44f9f270af21c451">say_periodic_announcement</a>(qe,ringing)))</div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;      <span class="comment">/* see if we need to move to the next penalty level for this queue */</span></div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;      <span class="keywordflow">while</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a> &amp;&amp; ((time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>)) {</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#aa1efb798e09a88e68559b08c90c573ee">update_qe_rule</a>(qe);</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;      }</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;</div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;      <span class="comment">/* If we have timed out, break out */</span></div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;         *reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;      }</div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;</div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;      <span class="comment">/* Wait a second before checking again */</span></div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;      <span class="keywordflow">if</span> ((res = <a class="code" href="../../d5/d7b/channel_8h.html#a050bec9a4abc1a599b6573a6091b080c">ast_waitfordigit</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#ac483b545204943907eab26ae059e65dd">RECHECK</a> * 1000))) {</div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;         <span class="keywordflow">if</span> (res &gt; 0 &amp;&amp; !<a class="code" href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456">valid_exit</a>(qe, res)) {</div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;            res = 0;</div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;         }</div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;      }</div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;</div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;      <span class="comment">/* If we have timed out, break out */</span></div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;         *reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;      }</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;   }</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;}</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;<span class="comment"> * \brief update the queue status</span></div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;<span class="comment"> * \retval Always 0</span></div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l05707"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3"> 5707</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3">update_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>, <span class="keywordtype">int</span> callcompletedinsl, time_t starttime)</div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;{</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;   <span class="keywordtype">int</span> oldtalktime;</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;   <span class="keywordtype">int</span> newtalktime = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - starttime;</div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;   <span class="keyword">struct </span>member *mem;</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *qtmp;</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;   <span class="comment">/* It is possible for us to be called when a call has already been considered terminated</span></div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;<span class="comment">    * and data updated, so to ensure we only act on the call that the agent is currently in</span></div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;<span class="comment">    * we check when the call was bridged.</span></div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;   <span class="keywordflow">if</span> (!starttime || (member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> != starttime)) {</div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;   }</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;</div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;   <span class="keywordflow">if</span> (shared_lastcall) {</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;      queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;      <span class="keywordflow">while</span> ((qtmp = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qtmp);</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;         <span class="keywordflow">if</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(qtmp-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, member, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>))) {</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;            time(&amp;mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>);</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;            mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>++;</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;            mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a> = 0;</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;            mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> = 0;</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;            mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a> = q;</div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;         }</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qtmp);</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(qtmp, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;      }</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;      time(&amp;member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>);</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;      member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a> = 0;</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;      member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>++;</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;      member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> = 0;</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;      member-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a> = q;</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;   }</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;   <span class="comment">/* Member might never experience any direct status change (local</span></div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;<span class="comment">    * channel with forwarding in particular). If that&#39;s the case,</span></div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;<span class="comment">    * this is the last chance to remove it from pending or subsequent</span></div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;<span class="comment">    * calls will not occur.</span></div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(member);</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;   q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>++;</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;   <span class="keywordflow">if</span> (callcompletedinsl) {</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a>++;</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;   }</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> == 1) {</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a> = newtalktime;</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;      <span class="comment">/* Calculate talktime using the same exponential average as holdtime code */</span></div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;      oldtalktime = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>;</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a> = (((oldtalktime &lt;&lt; 2) - oldtalktime) + newtalktime) &gt;&gt; 2;</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;   }</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;}</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;<span class="comment">/*! \brief Calculate the metric of each member in the outgoing callattempts</span></div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;<span class="comment"> * A numeric metric is given to each member depending on the ring strategy used</span></div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;<span class="comment"> * by the queue. Members with lower metrics will be called before members with</span></div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;<span class="comment"> * higher metrics</span></div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;<span class="comment"> * \retval -1 if penalties are exceeded</span></div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;<span class="comment"> * \retval 0 otherwise</span></div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05779"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a76af963fe9291f7d528d6db711144a6d"> 5779</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a76af963fe9291f7d528d6db711144a6d">calc_metric</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem, <span class="keywordtype">int</span> pos, <span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>)</div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;{</div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;   <span class="comment">/* disregarding penalty on too few members? */</span></div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;   <span class="keywordtype">int</span> membercount = <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> usepenalty = (membercount &lt;= q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039">penaltymemberslimit</a>) ? 0 : 1;</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;   <span class="keywordtype">int</span> penalty = mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;   <span class="keywordflow">if</span> (usepenalty) {</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a> != INT_MAX &amp;&amp; penalty &lt; qe-&gt;raise_penalty) {</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;         <span class="comment">/* Low penalty is raised up to the current minimum */</span></div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;         penalty = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>;</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;      }</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;      <span class="keywordflow">if</span> ((qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a> != INT_MAX &amp;&amp; penalty &gt; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>) ||</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;         (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a> != INT_MAX &amp;&amp; penalty &lt; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>)) {</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;      }</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Disregarding penalty, %d members and %d in penaltymemberslimit.\n&quot;</span>,</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;           membercount, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039">penaltymemberslimit</a>);</div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;   }</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;</div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;   <span class="keywordflow">switch</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>) {</div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>:</div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;      <span class="comment">/* Everyone equal, except for penalty */</span></div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = penalty * 1000000 * usepenalty;</div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a>:</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;      <span class="keywordflow">if</span> (pos &lt; qe-&gt;linpos) {</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;         tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = 1000 + pos;</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;         <span class="keywordflow">if</span> (pos &gt; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930">linpos</a>) {</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;            <span class="comment">/* Indicate there is another priority */</span></div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;            qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab552667d2252975f206fb8a8af49888a">linwrapped</a> = 1;</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;         }</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;         tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = pos;</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;      }</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> += penalty * 1000000 * usepenalty;</div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f">QUEUE_STRATEGY_RRORDERED</a>:</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a">QUEUE_STRATEGY_RRMEMORY</a>:</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;      pos = mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a>;</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;      <span class="keywordflow">if</span> (pos &lt; q-&gt;rrpos) {</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;         tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = 1000 + pos;</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;         <span class="keywordflow">if</span> (pos &gt; q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">rrpos</a>) {</div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;            <span class="comment">/* Indicate there is another priority */</span></div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ac3419e9b31cb1aebe3666439449bcecc">wrapped</a> = 1;</div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;         }</div><div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;         tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = pos;</div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;      }</div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> += penalty * 1000000 * usepenalty;</div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a89db95f6e97c58cd5915abddc140df70">QUEUE_STRATEGY_RANDOM</a>:</div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>() % 1000;</div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> += penalty * 1000000 * usepenalty;</div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67aee8588c59bd53b91d0cebce5faca7a06">QUEUE_STRATEGY_WRANDOM</a>:</div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>() % ((1 + penalty) * 1000);</div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a9b9caf74d13b75b846264a89d5aea9a4">QUEUE_STRATEGY_FEWESTCALLS</a>:</div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>;</div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> += penalty * 1000000 * usepenalty;</div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a5ecd46d3615498a0c1f620952b919855">QUEUE_STRATEGY_LEASTRECENT</a>:</div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;      <span class="keywordflow">if</span> (!mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>) {</div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;         tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = 0;</div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;         tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> = 1000000 - (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>);</div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;      }</div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">metric</a> += penalty * 1000000 * usepenalty;</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Can&#39;t calculate metric for unknown strategy %d\n&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>);</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;   }</div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;}</div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;</div><div class="line"><a name="l05857"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564d"> 5857</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564d">agent_complete_reason</a> {</div><div class="line"><a name="l05858"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889"> 5858</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889">CALLER</a>,</div><div class="line"><a name="l05859"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da40e60d510aa885cf9334b0c0175cd2b2"> 5859</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da40e60d510aa885cf9334b0c0175cd2b2">AGENT</a>,</div><div class="line"><a name="l05860"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564dac1bee29cc4915cda4b613b8b95330663"> 5860</a></span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564dac1bee29cc4915cda4b613b8b95330663">TRANSFER</a></div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;};</div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;<span class="comment">/*! \brief Send out AMI message with member call completion status information */</span></div><div class="line"><a name="l05864"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3a355e71b1bbd152d9eccde42a0212e2"> 5864</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3a355e71b1bbd152d9eccde42a0212e2">send_agent_complete</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *caller,</div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *peer, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>, time_t holdstart,</div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;   time_t callstart, <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564d">agent_complete_reason</a> rsn)</div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;{</div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *reason = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; <span class="comment">/* silence dumb compilers */</span></div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;   <span class="keywordflow">switch</span> (rsn) {</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889">CALLER</a>:</div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;      reason = <span class="stringliteral">&quot;caller&quot;</span>;</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da40e60d510aa885cf9334b0c0175cd2b2">AGENT</a>:</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;      reason = <span class="stringliteral">&quot;agent&quot;</span>;</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564dac1bee29cc4915cda4b613b8b95330663">TRANSFER</a>:</div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;      reason = <span class="stringliteral">&quot;transfer&quot;</span>;</div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;   }</div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;</div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: s, s: s, s: I, s: I, s: s}&quot;</span>,</div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;      <span class="stringliteral">&quot;Queue&quot;</span>, queuename,</div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;      <span class="stringliteral">&quot;Interface&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>,</div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;      <span class="stringliteral">&quot;MemberName&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>,</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;      <span class="stringliteral">&quot;HoldTime&quot;</span>, (<a class="code" href="../../d4/d05/json_8h.html#ae2cc29409ec389e8feaf38ec3a585d83">ast_json_int_t</a>)(callstart - holdstart),</div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;      <span class="stringliteral">&quot;TalkTime&quot;</span>, (<a class="code" href="../../d4/d05/json_8h.html#ae2cc29409ec389e8feaf38ec3a585d83">ast_json_int_t</a>)(time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - callstart),</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;      <span class="stringliteral">&quot;Reason&quot;</span>, reason ?: <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;</div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#ad5d008a8d00288be0065438ae331071f">queue_publish_multi_channel_snapshot_blob</a>(<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a88bee182f285c3e0b206c1de01324fc4">ast_queue_topic</a>(queuename), caller, peer,</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;         queue_agent_complete_type(), blob);</div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;}</div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;</div><div class="line"><a name="l05895"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a45259088e42ad1164f934c4c20ba2bba"> 5895</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a45259088e42ad1164f934c4c20ba2bba">queue_agent_cb</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;{</div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df0/structast__channel__blob.html">ast_channel_blob</a> *agent_blob;</div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;</div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;   agent_blob = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;</div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga03332d35946786d0689462e58d01467a">ast_channel_agent_login_type</a>() == <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(msg)) {</div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<span class="stringliteral">&quot;NONE&quot;</span>, agent_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;         <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(agent_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#ad2b8e22df32b99651f727cd9a8dcb9f3">blob</a>, <span class="stringliteral">&quot;agent&quot;</span>)),</div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;         <span class="stringliteral">&quot;AGENTLOGIN&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, agent_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga55d6d1e96f8f003200274d8756a9398a">ast_channel_agent_logoff_type</a>() == <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(msg)) {</div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<span class="stringliteral">&quot;NONE&quot;</span>, agent_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;         <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(agent_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#ad2b8e22df32b99651f727cd9a8dcb9f3">blob</a>, <span class="stringliteral">&quot;agent&quot;</span>)),</div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;         <span class="stringliteral">&quot;AGENTLOGOFF&quot;</span>, <span class="stringliteral">&quot;%s|%ld&quot;</span>, agent_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;         (<span class="keywordtype">long</span>) <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(agent_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#ad2b8e22df32b99651f727cd9a8dcb9f3">blob</a>, <span class="stringliteral">&quot;logintime&quot;</span>)));</div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;   }</div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;}</div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;<span class="comment"> * \brief Structure representing relevant data during a local channel optimization</span></div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;<span class="comment"> * The reason we care about local channel optimizations is that we want to be able</span></div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;<span class="comment"> * to accurately report when the caller and queue member have stopped talking to</span></div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;<span class="comment"> * each other. A local channel optimization can cause it to appear that the conversation</span></div><div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;<span class="comment"> * has stopped immediately after it has begun. By tracking that the relevant channels</span></div><div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;<span class="comment"> * to monitor have changed due to a local channel optimization, we can give accurate</span></div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;<span class="comment"> * reports.</span></div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;<span class="comment"> * Local channel optimizations for queues are restricted from their normal operation.</span></div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;<span class="comment"> * Bridges created by queues can only be the destination of local channel optimizations,</span></div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;<span class="comment"> * not the source. In addition, move-swap local channel optimizations are the only</span></div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;<span class="comment"> * permitted types of local channel optimization.</span></div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;<span class="comment"> * This data is populated when we are told that a local channel optimization begin</span></div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;<span class="comment"> * is occurring. When we get told the optimization has ended successfully, we then</span></div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;<span class="comment"> * apply the data here into the queue_stasis_data.</span></div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05933"></a><span class="lineno"><a class="line" href="../../dc/d83/structlocal__optimization.html"> 5933</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dc/d83/structlocal__optimization.html">local_optimization</a> {<span class="comment"></span></div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;<span class="comment">   /*! The uniqueid of the channel that will be taking the place of the caller or member */</span></div><div class="line"><a name="l05935"></a><span class="lineno"><a class="line" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa"> 5935</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">source_chan_uniqueid</a>;<span class="comment"></span></div><div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;<span class="comment">   /*! Indication of whether we think there is a local channel optimization in progress */</span></div><div class="line"><a name="l05937"></a><span class="lineno"><a class="line" href="../../dc/d83/structlocal__optimization.html#a74cdb8c7c6a2e5f456212d23cd3b3a66"> 5937</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d83/structlocal__optimization.html#a74cdb8c7c6a2e5f456212d23cd3b3a66">in_progress</a>;<span class="comment"></span></div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;<span class="comment">   /*! The identifier for this local channel optimization */</span></div><div class="line"><a name="l05939"></a><span class="lineno"><a class="line" href="../../dc/d83/structlocal__optimization.html#ab7ce6f462afaf105224b0ca772a33c43"> 5939</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/d83/structlocal__optimization.html#ab7ce6f462afaf105224b0ca772a33c43">id</a>;</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;};</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;<span class="comment"> * \brief User data for stasis subscriptions used for queue calls.</span></div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;<span class="comment"> * app_queue subscribes to channel and bridge events for all bridged calls.</span></div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;<span class="comment"> * app_queue cares about the following events:</span></div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;<span class="comment"> * \li bridge enter: To determine the unique ID of the bridge created for the call.</span></div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;<span class="comment"> * \li blind transfer: To send an appropriate agent complete event.</span></div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;<span class="comment"> * \li attended transfer: To send an appropriate agent complete event.</span></div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;<span class="comment"> * \li local optimization: To update caller and member unique IDs for the call.</span></div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;<span class="comment"> * \li hangup: To send an appropriate agent complete event.</span></div><div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;<span class="comment"> * The stasis subscriptions last until we determine that the caller and the member</span></div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;<span class="comment"> * are no longer bridged with each other.</span></div><div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05957"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html"> 5957</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> {</div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a>(<span class="comment"></span></div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;<span class="comment">      /*! The unique ID of the caller&#39;s channel. */</span></div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(caller_uniqueid);<span class="comment"></span></div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;<span class="comment">      /*! The unique ID of the queue member&#39;s channel */</span></div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(member_uniqueid);<span class="comment"></span></div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;<span class="comment">      /*! The unique ID of the bridge created by the queue */</span></div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(bridge_uniqueid);</div><div class="line"><a name="l05965"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00"> 5965</a></span>&#160;   );<span class="comment"></span></div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;<span class="comment">   /*! The relevant queue */</span></div><div class="line"><a name="l05967"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea"> 5967</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>;<span class="comment"></span></div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;<span class="comment">   /*! The queue member that has answered the call */</span></div><div class="line"><a name="l05969"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4"> 5969</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>;<span class="comment"></span></div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;<span class="comment">   /*! The time at which the caller entered the queue. Start of the caller&#39;s hold time */</span></div><div class="line"><a name="l05971"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f"> 5971</a></span>&#160;   time_t <a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>;<span class="comment"></span></div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;<span class="comment">   /*! The time at which the member answered the call. */</span></div><div class="line"><a name="l05973"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8"> 5973</a></span>&#160;   time_t <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>;<span class="comment"></span></div><div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;<span class="comment">   /*! The original position of the caller when he entered the queue */</span></div><div class="line"><a name="l05975"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#a25e485e2c95898fadb88ad00e152751d"> 5975</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a25e485e2c95898fadb88ad00e152751d">caller_pos</a>;<span class="comment"></span></div><div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;<span class="comment">   /*! Indication if the call was answered within the configured service level of the queue */</span></div><div class="line"><a name="l05977"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab"> 5977</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>;<span class="comment"></span></div><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;<span class="comment">   /*! Indicates if the stasis subscriptions are shutting down */</span></div><div class="line"><a name="l05979"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac"> 5979</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>;<span class="comment"></span></div><div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;<span class="comment">   /*! The stasis message router for bridge events */</span></div><div class="line"><a name="l05981"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8"> 5981</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>;<span class="comment"></span></div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;<span class="comment">   /*! The stasis message router for channel events */</span></div><div class="line"><a name="l05983"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56"> 5983</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>;<span class="comment"></span></div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;<span class="comment">   /*! Local channel optimization details for the caller */</span></div><div class="line"><a name="l05985"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#ad16306b671d391b6b8f0927c77baf0f5"> 5985</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d83/structlocal__optimization.html">local_optimization</a> caller_optimize;<span class="comment"></span></div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;<span class="comment">   /*! Local channel optimization details for the member */</span></div><div class="line"><a name="l05987"></a><span class="lineno"><a class="line" href="../../d3/d16/structqueue__stasis__data.html#a81d8d675a88cf528020284936ae4ef9a"> 5987</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d83/structlocal__optimization.html">local_optimization</a> member_optimize;</div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;};</div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;<span class="comment"> * \brief Free memory for a queue_stasis_data</span></div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05994"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a68951f4ce8e115a7210e7db5750ef6d1"> 5994</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a68951f4ce8e115a7210e7db5750ef6d1">queue_stasis_data_destructor</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;{</div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = obj;</div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;</div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;   <span class="comment">/* This can only happen if refcounts for this object have got severely messed up */</span></div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;</div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>);</div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab">queue_unref</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>);</div><div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(queue_data);</div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;}</div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;<span class="comment"> * \brief End all stasis subscriptions on a queue_stasis_data</span></div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06011"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aaf4ff45b97c96176ab583091f47339c8"> 6011</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaf4ff45b97c96176ab583091f47339c8">remove_stasis_subscriptions</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data)</div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;{</div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, queue_data);</div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;</div><div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a> = 1;</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>);</div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>);</div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;}</div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;<span class="comment"> * \brief Allocate a queue_stasis_data and initialize its data.</span></div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06026"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ada7cb973bbec700e3472e0cb9a240805"> 6026</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ada7cb973bbec700e3472e0cb9a240805">queue_stasis_data_alloc</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe,</div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem, time_t <a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>,</div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;      time_t <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>, <span class="keywordtype">int</span> <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>)</div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;{</div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data;</div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;</div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;   queue_data = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*queue_data), <a class="code" href="../../da/dfb/app__queue_8c.html#a68951f4ce8e115a7210e7db5750ef6d1">queue_stasis_data_destructor</a>);</div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;   <span class="keywordflow">if</span> (!queue_data) {</div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;   }</div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;</div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(queue_data, 64)) {</div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(queue_data);</div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;   }</div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;</div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(queue_data, <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(queue_data, <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(peer));</div><div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#aa08344a84581d62ffa83c87eea5da4ba">queue_ref</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> = <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>;</div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a> = <a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>;</div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a> = <a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>;</div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a25e485e2c95898fadb88ad00e152751d">caller_pos</a> = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>;</div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, +1);</div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a> = mem;</div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;</div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;   <span class="keywordflow">return</span> queue_data;</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;}</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;<span class="comment"> * \brief Log an attended transfer in the queue log.</span></div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;<span class="comment"> * Attended transfer queue log messages vary based on the method by which the</span></div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;<span class="comment"> * attended transfer was completed.</span></div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;<span class="comment"> * \param queue_data Data pertaining to the particular call in the queue.</span></div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;<span class="comment"> * \param atxfer_msg The stasis attended transfer message data.</span></div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06065"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af041692db9a20d1ffa7ea69e4864deb3"> 6065</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af041692db9a20d1ffa7ea69e4864deb3">log_attended_transfer</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data,</div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../df/d6d/structast__attended__transfer__message.html">ast_attended_transfer_message</a> *atxfer_msg)</div><div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;{</div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, transfer_str, <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(32), <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;   <span class="keywordflow">if</span> (!transfer_str) {</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to log attended transfer to queue log\n&quot;</span>);</div><div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;   }</div><div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;</div><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;   <span class="keywordflow">switch</span> (atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a4623d089424156732a5f5591381d8b31">dest_type</a>) {</div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950a70f8fe62b08cc358ba25a274626ac515">AST_ATTENDED_TRANSFER_DEST_BRIDGE_MERGE</a>:</div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;transfer_str, 0, <span class="stringliteral">&quot;BRIDGE|%s&quot;</span>, atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a68eeab7290249706588af2b6cffbdcaa">dest</a>.<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#ad62863a88a87dfc024a1d18c32ab3958">bridge</a>);</div><div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950adefb7a844b18a31888a4fee73a0649e4">AST_ATTENDED_TRANSFER_DEST_APP</a>:</div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950aa9d22a276b09440f114a18a5924c0dc8">AST_ATTENDED_TRANSFER_DEST_LOCAL_APP</a>:</div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;transfer_str, 0, <span class="stringliteral">&quot;APP|%s&quot;</span>, atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a68eeab7290249706588af2b6cffbdcaa">dest</a>.<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a3fa409a52b6210dbe249b2f37430fd4a">app</a>);</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950ab31bcd53098fda59c1bb2c2492686527">AST_ATTENDED_TRANSFER_DEST_LINK</a>:</div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;transfer_str, 0, <span class="stringliteral">&quot;LINK|%s|%s&quot;</span>, atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a68eeab7290249706588af2b6cffbdcaa">dest</a>.<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a7f2aed874f63d44e55ccbe7b4e59f356">links</a>[0]-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>,</div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;            atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a68eeab7290249706588af2b6cffbdcaa">dest</a>.<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a7f2aed874f63d44e55ccbe7b4e59f356">links</a>[1]-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950af927648ab0472ab615a296e8103b4caf">AST_ATTENDED_TRANSFER_DEST_THREEWAY</a>:</div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950a6d7eec1c6d7b9003b642c7c061444aeb">AST_ATTENDED_TRANSFER_DEST_FAIL</a>:</div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;      <span class="comment">/* Threeways are headed off and should not be logged here */</span></div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;   }</div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;</div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;ATTENDEDTRANSFER&quot;</span>, <span class="stringliteral">&quot;%s|%ld|%ld|%d&quot;</span>,</div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(transfer_str),</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;         (<span class="keywordtype">long</span>) (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> - queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>),</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;         (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>), queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a25e485e2c95898fadb88ad00e152751d">caller_pos</a>);</div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;}</div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;<span class="comment"> * \brief Handle a stasis bridge enter event.</span></div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;<span class="comment"> * We track this particular event in order to learn what bridge</span></div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;<span class="comment"> * was created for the queue call.</span></div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;<span class="comment"> * \param userdata Data pertaining to the particular call in the queue.</span></div><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;<span class="comment"> * \param sub The stasis subscription on which the message occurred.</span></div><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;<span class="comment"> * \param topic The topic for this event.</span></div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;<span class="comment"> * \param msg The stasis message for the bridge enter event</span></div><div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06112"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a031fff6b06ef6683954708c49280137f"> 6112</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a031fff6b06ef6683954708c49280137f">handle_bridge_enter</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;{</div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = userdata;</div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d01/structast__bridge__blob.html">ast_bridge_blob</a> *enter_blob = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, queue_data);</div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;</div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;   <span class="keywordflow">if</span> (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>) {</div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;   }</div><div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;</div><div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">bridge_uniqueid</a>)) {</div><div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;   }</div><div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;</div><div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;   <span class="keywordflow">if</span> (!strcmp(enter_blob-&gt;<a class="code" href="../../d7/d01/structast__bridge__blob.html#a8ee8cdf03a2b9d3424011cb6875751fa">channel</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>)) {</div><div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(queue_data, bridge_uniqueid,</div><div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;            enter_blob-&gt;<a class="code" href="../../d7/d01/structast__bridge__blob.html#a820b583b07f0cf97618ca22d73cd8f09">bridge</a>-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Detected entry of caller channel %s into bridge %s\n&quot;</span>,</div><div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;            enter_blob-&gt;<a class="code" href="../../d7/d01/structast__bridge__blob.html#a8ee8cdf03a2b9d3424011cb6875751fa">channel</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">bridge_uniqueid</a>);</div><div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;   }</div><div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;}</div><div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;<span class="comment"> * \brief Handle a blind transfer event</span></div><div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;<span class="comment"> * This event is important in order to be able to log the end of the</span></div><div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;<span class="comment"> * call to the queue log and to stasis.</span></div><div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;<span class="comment"> * \param userdata Data pertaining to the particular call in the queue.</span></div><div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;<span class="comment"> * \param sub The stasis subscription on which the message occurred.</span></div><div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;<span class="comment"> * \param topic The topic for this event.</span></div><div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;<span class="comment"> * \param msg The stasis message for the blind transfer event</span></div><div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06146"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af50d62be1a33353655366ede45e2da2e"> 6146</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af50d62be1a33353655366ede45e2da2e">handle_blind_transfer</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;{</div><div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = userdata;</div><div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dbf/structast__blind__transfer__message.html">ast_blind_transfer_message</a> *transfer_msg = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>;</div><div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;</div><div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, caller_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, member_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;</div><div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;   <span class="keywordflow">if</span> (transfer_msg-&gt;<a class="code" href="../../d1/dbf/structast__blind__transfer__message.html#abd45d96954fe74af9e011742ce09882d">result</a> != <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>) {</div><div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;   }</div><div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;</div><div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(queue_data);</div><div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;</div><div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;   <span class="keywordflow">if</span> (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>) {</div><div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;   }</div><div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;</div><div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">bridge_uniqueid</a>) ||</div><div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;         strcmp(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">bridge_uniqueid</a>, transfer_msg-&gt;<a class="code" href="../../d1/dbf/structast__blind__transfer__message.html#a820b583b07f0cf97618ca22d73cd8f09">bridge</a>-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>)) {</div><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;   }</div><div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;</div><div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;   caller_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>);</div><div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;   member_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>);</div><div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;</div><div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;</div><div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;   exten = transfer_msg-&gt;<a class="code" href="../../d1/dbf/structast__blind__transfer__message.html#a78d4847658b695383d849efd12399b38">exten</a>;</div><div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;   context = transfer_msg-&gt;<a class="code" href="../../d1/dbf/structast__blind__transfer__message.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;</div><div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;</div><div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Detected blind transfer in queue %s\n&quot;</span>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>,</div><div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;         <span class="stringliteral">&quot;BLINDTRANSFER&quot;</span>, <span class="stringliteral">&quot;%s|%s|%ld|%ld|%d&quot;</span>,</div><div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;         exten, context,</div><div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;         (<span class="keywordtype">long</span>) (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> - queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>),</div><div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;         (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>), queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a25e485e2c95898fadb88ad00e152751d">caller_pos</a>);</div><div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;</div><div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a3a355e71b1bbd152d9eccde42a0212e2">send_agent_complete</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, caller_snapshot, member_snapshot, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>,</div><div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;         queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564dac1bee29cc4915cda4b613b8b95330663">TRANSFER</a>);</div><div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3">update_queue</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>,</div><div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;         queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>);</div><div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#aaf4ff45b97c96176ab583091f47339c8">remove_stasis_subscriptions</a>(queue_data);</div><div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;}</div><div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;<span class="comment"> * \brief Handle an attended transfer event</span></div><div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;<span class="comment"> * This event is important in order to be able to log the end of the</span></div><div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;<span class="comment"> * call to the queue log and to stasis.</span></div><div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;<span class="comment"> * \param userdata Data pertaining to the particular call in the queue.</span></div><div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;<span class="comment"> * \param sub The stasis subscription on which the message occurred.</span></div><div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;<span class="comment"> * \param topic The topic for this event.</span></div><div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;<span class="comment"> * \param msg The stasis message for the attended transfer event.</span></div><div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06206"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a42473ab02a99b1df4c0e915291181d0e"> 6206</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a42473ab02a99b1df4c0e915291181d0e">handle_attended_transfer</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;{</div><div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = userdata;</div><div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d6d/structast__attended__transfer__message.html">ast_attended_transfer_message</a> *atxfer_msg = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, caller_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, member_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;</div><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;   <span class="keywordflow">if</span> (atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#abd45d96954fe74af9e011742ce09882d">result</a> != <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a> ||</div><div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;         atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a4623d089424156732a5f5591381d8b31">dest_type</a> == <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950af927648ab0472ab615a296e8103b4caf">AST_ATTENDED_TRANSFER_DEST_THREEWAY</a>) {</div><div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;   }</div><div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;</div><div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(queue_data);</div><div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;</div><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;   <span class="keywordflow">if</span> (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>) {</div><div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;   }</div><div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;</div><div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">bridge_uniqueid</a>)) {</div><div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;   }</div><div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;</div><div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;   <span class="keywordflow">if</span> ((!atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#ad4cabb0173fd175d7bac078a1a49bcb4">to_transferee</a>.<a class="code" href="../../da/db4/structast__bridge__channel__snapshot__pair.html#a548fa9691ccede16b32f244dd9637db4">bridge_snapshot</a> || strcmp(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">bridge_uniqueid</a>,</div><div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;               atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#ad4cabb0173fd175d7bac078a1a49bcb4">to_transferee</a>.<a class="code" href="../../da/db4/structast__bridge__channel__snapshot__pair.html#a548fa9691ccede16b32f244dd9637db4">bridge_snapshot</a>-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>)) &amp;&amp;</div><div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;          (!atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a82a439e20f31112e595909550f5201c4">to_transfer_target</a>.<a class="code" href="../../da/db4/structast__bridge__channel__snapshot__pair.html#a548fa9691ccede16b32f244dd9637db4">bridge_snapshot</a> || strcmp(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">bridge_uniqueid</a>,</div><div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;             atxfer_msg-&gt;<a class="code" href="../../df/d6d/structast__attended__transfer__message.html#a82a439e20f31112e595909550f5201c4">to_transfer_target</a>.<a class="code" href="../../da/db4/structast__bridge__channel__snapshot__pair.html#a548fa9691ccede16b32f244dd9637db4">bridge_snapshot</a>-&gt;<a class="code" href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>))) {</div><div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;   }</div><div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;</div><div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;   caller_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>);</div><div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;   member_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>);</div><div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;</div><div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;</div><div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Detected attended transfer in queue %s\n&quot;</span>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#af041692db9a20d1ffa7ea69e4864deb3">log_attended_transfer</a>(queue_data, atxfer_msg);</div><div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;</div><div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a3a355e71b1bbd152d9eccde42a0212e2">send_agent_complete</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, caller_snapshot, member_snapshot, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>,</div><div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;         queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564dac1bee29cc4915cda4b613b8b95330663">TRANSFER</a>);</div><div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3">update_queue</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>,</div><div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;         queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>);</div><div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#aaf4ff45b97c96176ab583091f47339c8">remove_stasis_subscriptions</a>(queue_data);</div><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;}</div><div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;<span class="comment"> * \brief Callback for all stasis bridge events</span></div><div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;<span class="comment"> * Based on the event and what bridge it is on, the task is farmed out to relevant</span></div><div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;<span class="comment"> * subroutines for further processing.</span></div><div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06261"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2d37dc60db794ef631ada82b564f1afb"> 6261</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2d37dc60db794ef631ada82b564f1afb">queue_bridge_cb</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;{</div><div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a>(sub, msg)) {</div><div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(userdata);</div><div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;   }</div><div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;}</div><div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;<span class="comment"> * \brief Handler for the beginning of a local channel optimization</span></div><div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;<span class="comment"> * This method gathers data relevant to the local channel optimization and stores</span></div><div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;<span class="comment"> * it to be used once the local optimization completes.</span></div><div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;<span class="comment"> * \param userdata Data pertaining to the particular call in the queue.</span></div><div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;<span class="comment"> * \param sub The stasis subscription on which the message occurred.</span></div><div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;<span class="comment"> * \param topic The topic for this event.</span></div><div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;<span class="comment"> * \param msg The stasis message for the local optimization begin event</span></div><div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06281"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a70bab206de25bd96bebc592ad255d277"> 6281</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a70bab206de25bd96bebc592ad255d277">handle_local_optimization_begin</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;{</div><div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = userdata;</div><div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dcb/structast__multi__channel__blob.html">ast_multi_channel_blob</a> *optimization_blob = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *local_one = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a>(optimization_blob, <span class="stringliteral">&quot;1&quot;</span>);</div><div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *local_two = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a>(optimization_blob, <span class="stringliteral">&quot;2&quot;</span>);</div><div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *source = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a>(optimization_blob, <span class="stringliteral">&quot;source&quot;</span>);</div><div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d83/structlocal__optimization.html">local_optimization</a> *optimization;</div><div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, queue_data);</div><div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;</div><div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;   <span class="keywordflow">if</span> (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>) {</div><div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;   }</div><div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;</div><div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;   <span class="keywordflow">if</span> (!strcmp(local_one-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>)) {</div><div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;      optimization = &amp;queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a81d8d675a88cf528020284936ae4ef9a">member_optimize</a>;</div><div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(local_two-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>)) {</div><div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;      optimization = &amp;queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ad16306b671d391b6b8f0927c77baf0f5">caller_optimize</a>;</div><div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;   }</div><div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;</div><div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;   <span class="comment">/* We only allow move-swap optimizations, so there had BETTER be a source */</span></div><div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(source != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;</div><div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;   optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">source_chan_uniqueid</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(source-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>);</div><div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;   <span class="keywordflow">if</span> (!optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">source_chan_uniqueid</a>) {</div><div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to track local channel optimization for channel %s. Expect further errors\n&quot;</span>, local_one-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;   }</div><div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;   <span class="keywordtype">id</span> = <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga54c9b2b1131c872d25a1395882333ae3">ast_multi_channel_blob_get_json</a>(optimization_blob), <span class="stringliteral">&quot;id&quot;</span>));</div><div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;</div><div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;   optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#ab7ce6f462afaf105224b0ca772a33c43">id</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;   optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a74cdb8c7c6a2e5f456212d23cd3b3a66">in_progress</a> = 1;</div><div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;}</div><div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;<span class="comment"> * \brief Handler for the end of a local channel optimization</span></div><div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;<span class="comment"> * This method takes the data gathered during the local channel optimization begin</span></div><div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;<span class="comment"> * event and applies it to the queue stasis data appropriately. This generally involves</span></div><div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;<span class="comment"> * updating the caller or member unique ID with the channel that is taking the place of</span></div><div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;<span class="comment"> * the previous caller or member.</span></div><div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;<span class="comment"> * \param userdata Data pertaining to the particular call in the queue.</span></div><div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;<span class="comment"> * \param sub The stasis subscription on which the message occurred.</span></div><div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;<span class="comment"> * \param topic The topic for this event.</span></div><div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;<span class="comment"> * \param msg The stasis message for the local optimization end event</span></div><div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06333"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad376f945649cc4fa527d23ad59c73d37"> 6333</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad376f945649cc4fa527d23ad59c73d37">handle_local_optimization_end</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;{</div><div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = userdata;</div><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dcb/structast__multi__channel__blob.html">ast_multi_channel_blob</a> *optimization_blob = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *local_one = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a>(optimization_blob, <span class="stringliteral">&quot;1&quot;</span>);</div><div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *local_two = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a>(optimization_blob, <span class="stringliteral">&quot;2&quot;</span>);</div><div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d83/structlocal__optimization.html">local_optimization</a> *optimization;</div><div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;   <span class="keywordtype">int</span> is_caller;</div><div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, queue_data);</div><div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;</div><div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;   <span class="keywordflow">if</span> (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>) {</div><div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;   }</div><div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;</div><div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;   <span class="keywordflow">if</span> (!strcmp(local_one-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>)) {</div><div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;      optimization = &amp;queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a81d8d675a88cf528020284936ae4ef9a">member_optimize</a>;</div><div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;      is_caller = 0;</div><div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(local_two-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>)) {</div><div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;      optimization = &amp;queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ad16306b671d391b6b8f0927c77baf0f5">caller_optimize</a>;</div><div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;      is_caller = 1;</div><div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;   }</div><div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;</div><div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;   <span class="keywordtype">id</span> = <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga54c9b2b1131c872d25a1395882333ae3">ast_multi_channel_blob_get_json</a>(optimization_blob), <span class="stringliteral">&quot;id&quot;</span>));</div><div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;</div><div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;   <span class="keywordflow">if</span> (!optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a74cdb8c7c6a2e5f456212d23cd3b3a66">in_progress</a>) {</div><div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Told of a local optimization end when we had no previous begin\n&quot;</span>);</div><div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;   }</div><div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;</div><div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;   <span class="keywordflow">if</span> (<span class="keywordtype">id</span> != optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#ab7ce6f462afaf105224b0ca772a33c43">id</a>) {</div><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Local optimization end event ID does not match begin (%u != %u)\n&quot;</span>,</div><div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;            <span class="keywordtype">id</span>, optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#ab7ce6f462afaf105224b0ca772a33c43">id</a>);</div><div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;   }</div><div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;</div><div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;   <span class="keywordflow">if</span> (is_caller) {</div><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Local optimization: Changing queue caller uniqueid from %s to %s\n&quot;</span>,</div><div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;            queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>, optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">source_chan_uniqueid</a>);</div><div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(queue_data, caller_uniqueid, optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">source_chan_uniqueid</a>);</div><div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Local optimization: Changing queue member uniqueid from %s to %s\n&quot;</span>,</div><div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;            queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>, optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">source_chan_uniqueid</a>);</div><div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(queue_data, member_uniqueid, optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">source_chan_uniqueid</a>);</div><div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;   }</div><div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;</div><div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;   optimization-&gt;<a class="code" href="../../dc/d83/structlocal__optimization.html#a74cdb8c7c6a2e5f456212d23cd3b3a66">in_progress</a> = 0;</div><div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;}</div><div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;<span class="comment"> * \brief Handler for hangup stasis event</span></div><div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;<span class="comment"> * This is how we determine that the caller or member has hung up and the call</span></div><div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;<span class="comment"> * has ended. An appropriate queue log and stasis message are raised in this</span></div><div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;<span class="comment"> * callback.</span></div><div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;<span class="comment"> * \param userdata Data pertaining to the particular call in the queue.</span></div><div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;<span class="comment"> * \param sub The stasis subscription on which the message occurred.</span></div><div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;<span class="comment"> * \param topic The topic for this event.</span></div><div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;<span class="comment"> * \param msg The stasis message for the hangup event.</span></div><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06398"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae40aa031d8166daa7404b8da0645f8cd"> 6398</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae40aa031d8166daa7404b8da0645f8cd">handle_hangup</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;{</div><div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = userdata;</div><div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df0/structast__channel__blob.html">ast_channel_blob</a> *channel_blob = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, caller_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, member_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *, chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564d">agent_complete_reason</a> reason;</div><div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;</div><div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(queue_data);</div><div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;</div><div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;   <span class="keywordflow">if</span> (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>) {</div><div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;   }</div><div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;</div><div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;   <span class="keywordflow">if</span> (!strcmp(channel_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>)) {</div><div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;      reason = <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889">CALLER</a>;</div><div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(channel_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>)) {</div><div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;      reason = <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da40e60d510aa885cf9334b0c0175cd2b2">AGENT</a>;</div><div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;   }</div><div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;</div><div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;   chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(channel_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;   <span class="keywordflow">if</span> (chan &amp;&amp; (<a class="code" href="../../dd/dff/bridge__roles_8h.html#a6b856fa6db0d3de843aa5a1d89db1154">ast_channel_has_role</a>(chan, <a class="code" href="../../d4/d1e/bridge__basic_8h.html#a0b6d741f492cd88fd405a10396c62ab6">AST_TRANSFERER_ROLE_NAME</a>) ||</div><div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;           !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;ATTENDEDTRANSFER&quot;</span>)) ||</div><div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;           !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;BLINDTRANSFER&quot;</span>)))) {</div><div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;      <span class="comment">/* Channel that is hanging up is doing it as part of a transfer.</span></div><div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;<span class="comment">       * We&#39;ll get a transfer event later</span></div><div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;   }</div><div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;</div><div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;   caller_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>);</div><div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;   member_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>);</div><div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;</div><div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;</div><div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Detected hangup of queue %s channel %s\n&quot;</span>, reason == <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889">CALLER</a> ? <span class="stringliteral">&quot;caller&quot;</span> : <span class="stringliteral">&quot;member&quot;</span>,</div><div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;         channel_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;</div><div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>,</div><div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;         reason == <a class="code" href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889">CALLER</a> ? <span class="stringliteral">&quot;COMPLETECALLER&quot;</span> : <span class="stringliteral">&quot;COMPLETEAGENT&quot;</span>, <span class="stringliteral">&quot;%ld|%ld|%d&quot;</span>,</div><div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;      (<span class="keywordtype">long</span>) (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> - queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>),</div><div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;      (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>), queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a25e485e2c95898fadb88ad00e152751d">caller_pos</a>);</div><div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;</div><div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a3a355e71b1bbd152d9eccde42a0212e2">send_agent_complete</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, caller_snapshot, member_snapshot, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>,</div><div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;         queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">holdstart</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>, reason);</div><div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3">update_queue</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a>,</div><div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;         queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>);</div><div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#aaf4ff45b97c96176ab583091f47339c8">remove_stasis_subscriptions</a>(queue_data);</div><div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;}</div><div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;</div><div class="line"><a name="l06455"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a540035f6c37b254f8547dde38b25b6d0"> 6455</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a540035f6c37b254f8547dde38b25b6d0">handle_masquerade</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;{</div><div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = userdata;</div><div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/df0/structast__channel__blob.html">ast_channel_blob</a> *channel_blob = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *new_channel_id;</div><div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;</div><div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;   new_channel_id = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(channel_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#ad2b8e22df32b99651f727cd9a8dcb9f3">blob</a>, <span class="stringliteral">&quot;newchanneluniqueid&quot;</span>));</div><div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;</div><div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(queue_data);</div><div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;</div><div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;   <span class="keywordflow">if</span> (queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">dying</a>) {</div><div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;   }</div><div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;</div><div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;   <span class="keywordflow">if</span> (!strcmp(channel_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>)) {</div><div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Replacing caller channel %s with %s due to masquerade\n&quot;</span>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">caller_uniqueid</a>, new_channel_id);</div><div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(queue_data, caller_uniqueid, new_channel_id);</div><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(channel_blob-&gt;<a class="code" href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>)) {</div><div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Replacing member channel %s with %s due to masquerade\n&quot;</span>, queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">member_uniqueid</a>, new_channel_id);</div><div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(queue_data, member_uniqueid, new_channel_id);</div><div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;   }</div><div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;</div><div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queue_data);</div><div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;}</div><div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;<span class="comment"> * \brief Callback for all stasis channel events</span></div><div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;<span class="comment"> * Based on the event and the channels involved, the work is farmed out into</span></div><div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;<span class="comment"> * subroutines for further processing.</span></div><div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06489"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#addeed7ca2ef4ef9fa3d373cb63a4a87c"> 6489</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#addeed7ca2ef4ef9fa3d373cb63a4a87c">queue_channel_cb</a>(<span class="keywordtype">void</span> *userdata, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>,</div><div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;      <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</div><div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;{</div><div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a>(sub, msg)) {</div><div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(userdata);</div><div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;   }</div><div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;}</div><div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;<span class="comment"> * \brief Create stasis subscriptions for a particular call in the queue.</span></div><div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;<span class="comment"> * These subscriptions are created once the call has been answered. The subscriptions</span></div><div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;<span class="comment"> * are put in place so that call progress may be tracked. Once the call can be determined</span></div><div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;<span class="comment"> * to have ended, then messages are logged to the queue log and stasis events are emitted.</span></div><div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;<span class="comment"> * \param qe The queue entry representing the caller</span></div><div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;<span class="comment"> * \param peer The channel that has answered the call</span></div><div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;<span class="comment"> * \param mem The queue member that answered the call</span></div><div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;<span class="comment"> * \param holdstart The time at which the caller entered the queue</span></div><div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;<span class="comment"> * \param starttime The time at which the call was answered</span></div><div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;<span class="comment"> * \param callcompletedinsl Indicates if the call was answered within the configured service level of the queue.</span></div><div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;<span class="comment"> * \retval 0 Success</span></div><div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;<span class="comment"> * \retval non-zero Failure</span></div><div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06514"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a1834405d3ba8801a861dc0e85b1225e3"> 6514</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a1834405d3ba8801a861dc0e85b1225e3">setup_stasis_subs</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem,</div><div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;      time_t holdstart, time_t starttime, <span class="keywordtype">int</span> callcompletedinsl)</div><div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;{</div><div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a> *queue_data = <a class="code" href="../../da/dfb/app__queue_8c.html#ada7cb973bbec700e3472e0cb9a240805">queue_stasis_data_alloc</a>(qe, peer, mem, holdstart, starttime, callcompletedinsl);</div><div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;</div><div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;   <span class="keywordflow">if</span> (!queue_data) {</div><div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;   }</div><div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;</div><div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a> = <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a7ba1d69412c7149859c52b8a6664fc31">stasis_message_router_create_pool</a>(<a class="code" href="../../dc/d4e/stasis__bridges_8h.html#abf64fa441014314244648caa6c8ab80b">ast_bridge_topic_all</a>());</div><div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;   <span class="keywordflow">if</span> (!queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>) {</div><div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(queue_data, -1);</div><div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;   }</div><div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;</div><div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>, <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a8bd3a6c07bd2064a82a7c27091ba0fce">ast_channel_entered_bridge_type</a>(),</div><div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a031fff6b06ef6683954708c49280137f">handle_bridge_enter</a>, queue_data);</div><div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>, <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a05b1c5a7666e29a9ec982e3c9d6c1b85">ast_blind_transfer_type</a>(),</div><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#af50d62be1a33353655366ede45e2da2e">handle_blind_transfer</a>, queue_data);</div><div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>, <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a263062ed75918c257f5401617389bdd8">ast_attended_transfer_type</a>(),</div><div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a42473ab02a99b1df4c0e915291181d0e">handle_attended_transfer</a>, queue_data);</div><div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#aa59d4e87c66028292722730a82c149ab">stasis_message_router_set_default</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>,</div><div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a2d37dc60db794ef631ada82b564f1afb">queue_bridge_cb</a>, queue_data);</div><div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;</div><div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;   queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a> = <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a7ba1d69412c7149859c52b8a6664fc31">stasis_message_router_create_pool</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga34a3ac59fb8d0c49cbc2cb9b87261d31">ast_channel_topic_all</a>());</div><div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;   <span class="keywordflow">if</span> (!queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>) {</div><div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;      <span class="comment">/* Unsubscribing from the bridge router will remove the only ref of queue_data,</span></div><div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;<span class="comment">       * thus beginning the destruction process</span></div><div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;      <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>);</div><div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;      queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;   }</div><div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;</div><div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(queue_data, +1);</div><div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>, <a class="code" href="../../d5/da6/core__local_8h.html#a8f023d0ccc8c7d3365abf4d60412deb5">ast_local_optimization_begin_type</a>(),</div><div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a70bab206de25bd96bebc592ad255d277">handle_local_optimization_begin</a>, queue_data);</div><div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>, <a class="code" href="../../d5/da6/core__local_8h.html#a6f6f7583dcbd0b63d59bdfe79f654945">ast_local_optimization_end_type</a>(),</div><div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ad376f945649cc4fa527d23ad59c73d37">handle_local_optimization_end</a>, queue_data);</div><div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab7e251e9a467cda68d93a47184fe0727">ast_channel_hangup_request_type</a>(),</div><div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ae40aa031d8166daa7404b8da0645f8cd">handle_hangup</a>, queue_data);</div><div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga793b849e5b7c9257e92fe30621de5b74">ast_channel_masquerade_type</a>(),</div><div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a540035f6c37b254f8547dde38b25b6d0">handle_masquerade</a>, queue_data);</div><div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#aa59d4e87c66028292722730a82c149ab">stasis_message_router_set_default</a>(queue_data-&gt;<a class="code" href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">channel_router</a>,</div><div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#addeed7ca2ef4ef9fa3d373cb63a4a87c">queue_channel_cb</a>, queue_data);</div><div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;</div><div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;}</div><div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;</div><div class="line"><a name="l06563"></a><span class="lineno"><a class="line" href="../../d5/d61/structqueue__end__bridge.html"> 6563</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d5/d61/structqueue__end__bridge.html">queue_end_bridge</a> {</div><div class="line"><a name="l06564"></a><span class="lineno"><a class="line" href="../../d5/d61/structqueue__end__bridge.html#a6d8b242e106dd6592a625bdc396bbe55"> 6564</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *<a class="code" href="../../d5/d61/structqueue__end__bridge.html#a6d8b242e106dd6592a625bdc396bbe55">q</a>;</div><div class="line"><a name="l06565"></a><span class="lineno"><a class="line" href="../../d5/d61/structqueue__end__bridge.html#a84d1435c5b8d387806714ea7079304b7"> 6565</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d5/d61/structqueue__end__bridge.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;};</div><div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;</div><div class="line"><a name="l06568"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#adc150dec1056eca590d0f1555ff5188b"> 6568</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#adc150dec1056eca590d0f1555ff5188b">end_bridge_callback_data_fixup</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d13/structast__bridge__config.html">ast_bridge_config</a> *bconfig, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *originator, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *terminator)</div><div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;{</div><div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d61/structqueue__end__bridge.html">queue_end_bridge</a> *qeb = bconfig-&gt;<a class="code" href="../../d0/d13/structast__bridge__config.html#a30cb875f49910a9515ee92d8dfdf8b83">end_bridge_callback_data</a>;</div><div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(qeb, +1);</div><div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;   qeb-&gt;<a class="code" href="../../d5/d61/structqueue__end__bridge.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = originator;</div><div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;}</div><div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;</div><div class="line"><a name="l06575"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#acb5e3261ae018d7bbe4cbdcc9cace101"> 6575</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#acb5e3261ae018d7bbe4cbdcc9cace101">end_bridge_callback</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;{</div><div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d61/structqueue__end__bridge.html">queue_end_bridge</a> *qeb = data;</div><div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = qeb-&gt;<a class="code" href="../../d5/d61/structqueue__end__bridge.html#a6d8b242e106dd6592a625bdc396bbe55">q</a>;</div><div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = qeb-&gt;<a class="code" href="../../d5/d61/structqueue__end__bridge.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;</div><div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(qeb, -1) == 1) {</div><div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138">set_queue_variables</a>(q, chan);</div><div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;      <span class="comment">/* This unrefs the reference we made in try_calling when we allocated qeb */</span></div><div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Expire bridge_config reference&quot;</span>);</div><div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;   }</div><div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;}</div><div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;<span class="comment"> * \brief Setup the after bridge goto location on the peer.</span></div><div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;<span class="comment"> * \param chan Calling channel for bridge.</span></div><div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;<span class="comment"> * \param peer Peer channel for bridge.</span></div><div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;<span class="comment"> * \param opts Dialing option flags.</span></div><div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;<span class="comment"> * \param opt_args Dialing option argument strings.</span></div><div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06600"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aef676b88f94e92332fdded27143a56f5"> 6600</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aef676b88f94e92332fdded27143a56f5">setup_peer_after_bridge_goto</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer, <span class="keyword">struct</span> <a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> *opts, <span class="keywordtype">char</span> *opt_args[])</div><div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;{</div><div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;</div><div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d5a/structextension.html">extension</a>;</div><div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>;</div><div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;</div><div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a78690a8e97e0eac7d0982b81d5cadac8">OPT_CALLEE_GO_ON</a>)) {</div><div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;      context = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a>(chan));</div><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;      extension = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aa8b52fbc8168e939bc5553502367d46a">ast_channel_exten</a>(chan));</div><div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;      priority = <a class="code" href="../../d5/d7b/channel_8h.html#a6610c8171ced0a69738622c11736ff5e">ast_channel_priority</a>(chan);</div><div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;      <a class="code" href="../../d8/d85/bridge__after_8h.html#abffcfc07534d569ab73f8fdb19a94677">ast_bridge_set_after_go_on</a>(peer, context, extension, priority,</div><div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;         opt_args[<a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a1d0a4362e89e71be70b2ca0d47616c99">OPT_ARG_CALLEE_GO_ON</a>]);</div><div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;   }</div><div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;}</div><div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;</div><div class="line"><a name="l06617"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a64fbaaf618f14ff586946ad7efb80987"> 6617</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a64fbaaf618f14ff586946ad7efb80987">escape_and_substitute</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a5a634cf4429798b1c921a81de8250051">input</a>,</div><div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;      <span class="keywordtype">char</span> *output, <span class="keywordtype">size_t</span> size)</div><div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;{</div><div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *m = <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a5a634cf4429798b1c921a81de8250051">input</a>;</div><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;   <span class="keywordtype">char</span> escaped[size];</div><div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;   <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;</div><div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;   <span class="keywordflow">for</span> (p = escaped; p &lt; escaped + size - 1; p++, m++) {</div><div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;      <span class="keywordflow">switch</span> (*m) {</div><div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;^&#39;</span>:</div><div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;         <span class="keywordflow">if</span> (*(m + 1) == <span class="charliteral">&#39;{&#39;</span>) {</div><div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;            *p = <span class="charliteral">&#39;$&#39;</span>;</div><div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;         }</div><div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;,&#39;</span>:</div><div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;         *p++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;         <span class="comment">/* Fall through */</span></div><div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;         *p = *m;</div><div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;      }</div><div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;      <span class="keywordflow">if</span> (*m == <span class="charliteral">&#39;\0&#39;</span>)</div><div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;   }</div><div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;</div><div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;   <span class="keywordflow">if</span> (p == escaped + size) {</div><div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;      escaped[size - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;   }</div><div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;</div><div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#af5a13a9ab5aac5bb61e4f98ae7e8d296">pbx_substitute_variables_helper</a>(chan, escaped, output, size - 1);</div><div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;}</div><div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;</div><div class="line"><a name="l06648"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3ee5f9b7ec29ebb95c4e1ac00fafde83"> 6648</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3ee5f9b7ec29ebb95c4e1ac00fafde83">setup_mixmonitor</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">const</span> <span class="keywordtype">char</span> *filename)</div><div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;{</div><div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;   <span class="keywordtype">char</span> escaped_filename[256];</div><div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;   <span class="keywordtype">char</span> file_with_ext[<span class="keyword">sizeof</span>(escaped_filename) + <span class="keyword">sizeof</span>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>)];</div><div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;   <span class="keywordtype">char</span> mixmonargs[1512];</div><div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;   <span class="keywordtype">char</span> escaped_monitor_exec[1024];</div><div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *monitor_options;</div><div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *monitor_exec;</div><div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;</div><div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;   escaped_monitor_exec[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;</div><div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;   <span class="keywordflow">if</span> (filename) {</div><div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a64fbaaf618f14ff586946ad7efb80987">escape_and_substitute</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, filename, escaped_filename, <span class="keyword">sizeof</span>(escaped_filename));</div><div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(escaped_filename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <span class="keyword">sizeof</span>(escaped_filename));</div><div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;   }</div><div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;</div><div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;   <span class="keywordflow">if</span> ((monitor_exec = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;MONITOR_EXEC&quot;</span>))) {</div><div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;      monitor_exec = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(monitor_exec);</div><div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;   }</div><div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;   <span class="keywordflow">if</span> ((monitor_options = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;MONITOR_OPTIONS&quot;</span>))) {</div><div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;      monitor_options = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(monitor_options);</div><div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;      monitor_options = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;   }</div><div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;</div><div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;   <span class="keywordflow">if</span> (monitor_exec) {</div><div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a64fbaaf618f14ff586946ad7efb80987">escape_and_substitute</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, monitor_exec, escaped_monitor_exec, <span class="keyword">sizeof</span>(escaped_monitor_exec));</div><div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;   }</div><div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;</div><div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;   snprintf(file_with_ext, <span class="keyword">sizeof</span>(file_with_ext), <span class="stringliteral">&quot;%s.%s&quot;</span>, escaped_filename, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>);</div><div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;</div><div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(escaped_monitor_exec)) {</div><div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;      snprintf(mixmonargs, <span class="keyword">sizeof</span>(mixmonargs), <span class="stringliteral">&quot;b%s,%s&quot;</span>, monitor_options, escaped_monitor_exec);</div><div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;      snprintf(mixmonargs, <span class="keyword">sizeof</span>(mixmonargs), <span class="stringliteral">&quot;b%s&quot;</span>, monitor_options);</div><div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;   }</div><div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;</div><div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Arguments being passed to MixMonitor: %s,%s\n&quot;</span>, file_with_ext, mixmonargs);</div><div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;</div><div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d40/mixmonitor_8h.html#aa149ed49d6cff18515821855abd9fc17">ast_start_mixmonitor</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, file_with_ext, mixmonargs)) {</div><div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to start mixmonitor. Is the MixMonitor app loaded?\n&quot;</span>);</div><div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;   }</div><div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;}</div><div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;<span class="comment"> * \brief A large function which calls members, updates statistics, and bridges the caller and a member</span></div><div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;<span class="comment"> * Here is the process of this function</span></div><div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;<span class="comment"> * 1. Process any options passed to the Queue() application. Options here mean the third argument to Queue()</span></div><div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;<span class="comment"> * 2. Iterate trough the members of the queue, creating a callattempt corresponding to each member.</span></div><div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;<span class="comment"> * 3. Call ring_one to place a call to the appropriate member(s)</span></div><div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;<span class="comment"> * 4. Call wait_for_answer to wait for an answer. If no one answers, return.</span></div><div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;<span class="comment"> * 5. Take care of any holdtime announcements, member delays, or other options which occur after a call has been answered.</span></div><div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;<span class="comment"> * 6. Start the monitor or mixmonitor if the option is set</span></div><div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="comment"> * 7. Remove the caller from the queue to allow other callers to advance</span></div><div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;<span class="comment"> * 8. Bridge the call.</span></div><div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;<span class="comment"> * 9. Do any post processing after the call has disconnected.</span></div><div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;<span class="comment"> * \param[in] qe the queue_ent structure which corresponds to the caller attempting to reach members</span></div><div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;<span class="comment"> * \param[in] opts the options passed as the third parameter to the Queue() application</span></div><div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;<span class="comment"> * \param[in] opt_args the options passed as the third parameter to the Queue() application</span></div><div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;<span class="comment"> * \param[in] announceoverride filename to play to user when waiting</span></div><div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;<span class="comment"> * \param[in] url the url passed as the fourth parameter to the Queue() application</span></div><div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;<span class="comment"> * \param[in,out] tries the number of times we have tried calling queue members</span></div><div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;<span class="comment"> * \param[out] noption set if the call to Queue() has the &#39;n&#39; option set.</span></div><div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;<span class="comment"> * \param[in] agi the agi passed as the fifth parameter to the Queue() application</span></div><div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;<span class="comment"> * \param[in] macro the macro passed as the sixth parameter to the Queue() application</span></div><div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;<span class="comment"> * \param[in] gosub the gosub passed as the seventh parameter to the Queue() application</span></div><div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;<span class="comment"> * \param[in] ringing 1 if the &#39;r&#39; option is set, otherwise 0</span></div><div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06722"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac66c7e437e2829c88f56aad3cc7cf508"> 6722</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ac66c7e437e2829c88f56aad3cc7cf508">try_calling</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">struct</span> <a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> opts, <span class="keywordtype">char</span> **opt_args, <span class="keywordtype">char</span> *announceoverride, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d12/res__config__ldap_8c.html#a75e4590043edf35241d30fabe2eda546">url</a>, <span class="keywordtype">int</span> *tries, <span class="keywordtype">int</span> *noption, <span class="keyword">const</span> <span class="keywordtype">char</span> *agi, <span class="keyword">const</span> <span class="keywordtype">char</span> *macro, <span class="keyword">const</span> <span class="keywordtype">char</span> *gosub, <span class="keywordtype">int</span> <a class="code" href="../../d7/d9b/bridge__basic_8c.html#a6ab6e51f783d7cea98857990908996d3">ringing</a>)</div><div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;{</div><div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *cur;</div><div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/dcd/structoutgoing.html">outgoing</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; <span class="comment">/* the list of calls we are building */</span></div><div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;   <span class="keywordtype">int</span> to, orig;</div><div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;   <span class="keywordtype">char</span> oldexten[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>]=<span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;   <span class="keywordtype">char</span> oldcontext[<a class="code" href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a>]=<span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;   <span class="keywordtype">char</span> queuename[256]=<span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *peer;</div><div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *which;</div><div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *lpeer;</div><div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>;</div><div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da3/structast__app.html">ast_app</a> *application;</div><div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;   <span class="keywordtype">int</span> res = 0, bridge = 0;</div><div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;   <span class="keywordtype">int</span> numbusies = 0;</div><div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;   <span class="keywordtype">int</span> x=0;</div><div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;   <span class="keywordtype">char</span> *announce = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a> = 0;</div><div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;   time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d13/structast__bridge__config.html">ast_bridge_config</a> bridge_config;</div><div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;   <span class="keywordtype">char</span> nondataquality = 1;</div><div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;   <span class="keywordtype">char</span> *agiexec = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;   <span class="keywordtype">char</span> *macroexec = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;   <span class="keywordtype">char</span> *gosubexec = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *monitorfilename;</div><div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;   <span class="keywordtype">char</span> tmpid[256];</div><div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;   <span class="keywordtype">int</span> forwardsallowed = 1;</div><div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;   <span class="keywordtype">int</span> block_connected_line = 0;</div><div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> memi;</div><div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d61/structqueue__end__bridge.html">queue_end_bridge</a> *<a class="code" href="../../d5/d61/structqueue__end__bridge.html">queue_end_bridge</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;   <span class="keywordtype">int</span> callcompletedinsl;</div><div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;   time_t starttime;</div><div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;</div><div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;   memset(&amp;bridge_config, 0, <span class="keyword">sizeof</span>(bridge_config));</div><div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;   tmpid[0] = 0;</div><div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;   time(&amp;now);</div><div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;</div><div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;   <span class="comment">/* If we&#39;ve already exceeded our timeout, then just stop</span></div><div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;<span class="comment">    * This should be extremely rare. queue_exec will take care</span></div><div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;<span class="comment">    * of removing the caller and reporting the timeout as the reason.</span></div><div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; now &gt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>) {</div><div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;      res = 0;</div><div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>;</div><div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;   }</div><div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;</div><div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6faa363811a3b467116d290d52d967da">OPT_CALLEE_TRANSFER</a>)) {</div><div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#a725b051d26c3350f8cd04467b4202c60">features_callee</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1a33e339fbf78c26377f6c7057dda06ccc">AST_FEATURE_REDIRECT</a>);</div><div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;   }</div><div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3adb3ae0c7823e3bd3f4a45db3d03f33cb">OPT_CALLER_TRANSFER</a>)) {</div><div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#aa9510db9c5a776dfbd1aaab8c48970f0">features_caller</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1a33e339fbf78c26377f6c7057dda06ccc">AST_FEATURE_REDIRECT</a>);</div><div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;   }</div><div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6cda8c882997c543030f3dde846f9df3">OPT_CALLEE_AUTOMON</a>)) {</div><div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#a725b051d26c3350f8cd04467b4202c60">features_callee</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ae16218a9dfb2123d391f959e3d078362">AST_FEATURE_AUTOMON</a>);</div><div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;   }</div><div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a0c9c1b291152109321095a6734256794">OPT_CALLER_AUTOMON</a>)) {</div><div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#aa9510db9c5a776dfbd1aaab8c48970f0">features_caller</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ae16218a9dfb2123d391f959e3d078362">AST_FEATURE_AUTOMON</a>);</div><div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;   }</div><div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9d07e60d74a39d3012cf728a0e75d91e">OPT_DATA_QUALITY</a>)) {</div><div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;      nondataquality = 0;</div><div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;   }</div><div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab0eb8a377bf253cf368bf70f0b59fc31">OPT_CALLEE_HANGUP</a>)) {</div><div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#a725b051d26c3350f8cd04467b4202c60">features_callee</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ae4ef6bff70f5837c4ccfcef8d789a9cc">AST_FEATURE_DISCONNECT</a>);</div><div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;   }</div><div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9f03cca4e2ee93778ae8ed2db279587d">OPT_CALLER_HANGUP</a>)) {</div><div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#aa9510db9c5a776dfbd1aaab8c48970f0">features_caller</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ae4ef6bff70f5837c4ccfcef8d789a9cc">AST_FEATURE_DISCONNECT</a>);</div><div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;   }</div><div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a35080c34427591a22d34370e0a8ebab4">OPT_CALLEE_PARK</a>)) {</div><div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#a725b051d26c3350f8cd04467b4202c60">features_callee</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ace68898ce2f86298d8e39e0473a55e28">AST_FEATURE_PARKCALL</a>);</div><div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;   }</div><div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a82c1e40f3b210bce47d00d44dec0b8fd">OPT_CALLER_PARK</a>)) {</div><div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#aa9510db9c5a776dfbd1aaab8c48970f0">features_caller</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ace68898ce2f86298d8e39e0473a55e28">AST_FEATURE_PARKCALL</a>);</div><div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;   }</div><div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9343294711278062e3bcf5b51417ccb4">OPT_NO_RETRY</a>)) {</div><div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a">QUEUE_STRATEGY_RRMEMORY</a> || qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a></div><div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;         || qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f">QUEUE_STRATEGY_RRORDERED</a>) {</div><div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;         (*tries)++;</div><div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;         *tries = <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;      }</div><div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;      *noption = 1;</div><div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;   }</div><div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a8235d5ff2f8003fdb1d20c6876425ebf">OPT_IGNORE_CALL_FW</a>)) {</div><div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;      forwardsallowed = 0;</div><div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;   }</div><div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6ab17f35d26d691c590098350b231988">OPT_IGNORE_CONNECTEDLINE</a>)) {</div><div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;      block_connected_line = 1;</div><div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;   }</div><div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3aa465a2ae8739e3b612225fe15f19c0ad">OPT_CALLEE_AUTOMIXMON</a>)) {</div><div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#a725b051d26c3350f8cd04467b4202c60">features_callee</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1a0a015b303a0970eda3ea8328714cbbae">AST_FEATURE_AUTOMIXMON</a>);</div><div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;   }</div><div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab61ce333627051f88077d9b6d7fb2e06">OPT_CALLER_AUTOMIXMON</a>)) {</div><div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#aa9510db9c5a776dfbd1aaab8c48970f0">features_caller</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1a0a015b303a0970eda3ea8328714cbbae">AST_FEATURE_AUTOMIXMON</a>);</div><div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;   }</div><div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a7c4515f386fff57ac14217a7a5a6c388">OPT_MARK_AS_ANSWERED</a>)) {</div><div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517">cancel_answered_elsewhere</a> = 1;</div><div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;   }</div><div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;</div><div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;   <span class="comment">/* if the calling channel has AST_CAUSE_ANSWERED_ELSEWHERE set, make sure this is inherited.</span></div><div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;<span class="comment">      (this is mainly to support unreal/local channels)</span></div><div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) == <a class="code" href="../../d4/da3/causes_8h.html#aa71419a0c598e31312477c5a644e7440">AST_CAUSE_ANSWERED_ELSEWHERE</a>) {</div><div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517">cancel_answered_elsewhere</a> = 1;</div><div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;   }</div><div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;</div><div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s is trying to call a queue member.\n&quot;</span>,</div><div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(queuename, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="keyword">sizeof</span>(queuename));</div><div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#aa774cd5d9be3c23ac43ab1798f437339">announce</a>)) {</div><div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;      announce = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#aa774cd5d9be3c23ac43ab1798f437339">announce</a>;</div><div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;   }</div><div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(announceoverride)) {</div><div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;      announce = announceoverride;</div><div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;   }</div><div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;</div><div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;   memi = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;   <span class="keywordflow">while</span> ((cur = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;memi))) {</div><div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/dc6/structcallattempt.html">callattempt</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tmp));</div><div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;      <span class="keywordflow">if</span> (!tmp) {</div><div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cur, -1);</div><div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;memi);</div><div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>;</div><div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;      }</div><div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;</div><div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;<span class="comment">       * Seed the callattempt&#39;s connected line information with previously</span></div><div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;<span class="comment">       * acquired connected line info from the queued channel.  The</span></div><div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;<span class="comment">       * previously acquired connected line info could have been set</span></div><div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;<span class="comment">       * through the CONNECTED_LINE dialplan function.</span></div><div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a5d3c15fe1dffda82e6dc03ca7b26526a">ast_party_connected_line_copy</a>(&amp;tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">connected</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;</div><div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">block_connected_update</a> = block_connected_line;</div><div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">stillgoing</a> = 1;</div><div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;      tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a> = cur; <span class="comment">/* Place the reference for cur into callattempt. */</span></div><div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>, cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keyword">sizeof</span>(tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">interface</a>));</div><div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;      <span class="comment">/* Calculate the metric for the appropriate strategy. */</span></div><div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a76af963fe9291f7d528d6db711144a6d">calc_metric</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, cur, x++, qe, tmp)) {</div><div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;         <span class="comment">/* Put them in the list of outgoing thingies...  We&#39;re ready now.</span></div><div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;<span class="comment">            XXX If we&#39;re forcibly removed, these outgoing calls won&#39;t get</span></div><div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;<span class="comment">            hung up XXX */</span></div><div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;         tmp-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">q_next</a> = outgoing;</div><div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;         outgoing = <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a88cbf36725c411333529927a28f37915">callattempt_free</a>(tmp);</div><div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;      }</div><div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;   }</div><div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;memi);</div><div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;</div><div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#af983858a2192f96c9a30e44467b87f61">timeoutpriority</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844aabaf51de14755cf9b47a42c3cc460a87">TIMEOUT_PRIORITY_APP</a>) {</div><div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;      <span class="comment">/* Application arguments have higher timeout priority (behaviour for &lt;=1.6) */</span></div><div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (!qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> || (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> - now) &lt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>)) {</div><div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;         to = (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> - now) * 1000;</div><div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;         to = (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>) ? qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> * 1000 : -1;</div><div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;      }</div><div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;      <span class="comment">/* Config timeout is higher priority thatn application timeout */</span></div><div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>&lt;=now) {</div><div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;         to = 0;</div><div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>) {</div><div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;         to = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> * 1000;</div><div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;         to = -1;</div><div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;      }</div><div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;   }</div><div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;   orig = to;</div><div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;   ++qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a79ec26d453dcd29aec17f5536233e849">pending</a>;</div><div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;   <span class="comment">/* Call the queue members with the best metric now. */</span></div><div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31">ring_one</a>(qe, outgoing, &amp;numbusies);</div><div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;   lpeer = <a class="code" href="../../da/dfb/app__queue_8c.html#a0034e8c905ec7f5d1222f3ac4947efa8">wait_for_answer</a>(qe, outgoing, &amp;to, &amp;digit, numbusies,</div><div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;(bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#aa9510db9c5a776dfbd1aaab8c48970f0">features_caller</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ae4ef6bff70f5837c4ccfcef8d789a9cc">AST_FEATURE_DISCONNECT</a>),</div><div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;      forwardsallowed);</div><div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;</div><div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a">QUEUE_STRATEGY_RRMEMORY</a> || qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f">QUEUE_STRATEGY_RRORDERED</a>) {</div><div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#abdcc4a1bb61f226f36c2026ec3d65a35">store_next_rr</a>(qe, outgoing);</div><div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;</div><div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;   }</div><div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;   <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> == <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a>) {</div><div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8a12ebde49cdd091865dc355f41a3cb9">store_next_lin</a>(qe, outgoing);</div><div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;   }</div><div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;   peer = lpeer ? lpeer-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">chan</a> : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;   <span class="keywordflow">if</span> (!peer) {</div><div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a79ec26d453dcd29aec17f5536233e849">pending</a> = 0;</div><div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;      <span class="keywordflow">if</span> (to) {</div><div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;         <span class="comment">/* Must gotten hung up */</span></div><div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;         res = -1;</div><div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;         <span class="comment">/* User exited by pressing a digit */</span></div><div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;         res = <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;      }</div><div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;      <span class="keywordflow">if</span> (res == -1) {</div><div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: Nobody answered.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;      }</div><div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;   } <span class="keywordflow">else</span> { <span class="comment">/* peer is valid */</span></div><div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, interfacevar, <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(325), <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;      <span class="comment">/* Ah ha!  Someone answered within the desired timeframe.  Of course after this</span></div><div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;<span class="comment">         we will always return with -1 so that it is hung up properly after the</span></div><div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;<span class="comment">         conversation.  */</span></div><div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;      <span class="keywordflow">if</span> (!strcmp(<a class="code" href="../../d5/d7b/channel_8h.html#af5dee96d4dcc88a95fce391c22d4d21f">ast_channel_tech</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d85/structast__channel__tech.html#a8ff938fb2f815be425fd2859a21e6d61">type</a>, <span class="stringliteral">&quot;DAHDI&quot;</span>)) {</div><div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#adcfd8d241b6de48068ead143ac29978d">ast_channel_setoption</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a31312f6b6c2296e3495ad1d9e198cbf4">AST_OPTION_TONE_VERIFY</a>, &amp;nondataquality, <span class="keyword">sizeof</span>(nondataquality), 0);</div><div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;      }</div><div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;      <span class="keywordflow">if</span> (!strcmp(<a class="code" href="../../d5/d7b/channel_8h.html#af5dee96d4dcc88a95fce391c22d4d21f">ast_channel_tech</a>(peer)-&gt;<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="stringliteral">&quot;DAHDI&quot;</span>)) {</div><div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#adcfd8d241b6de48068ead143ac29978d">ast_channel_setoption</a>(peer, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a31312f6b6c2296e3495ad1d9e198cbf4">AST_OPTION_TONE_VERIFY</a>, &amp;nondataquality, <span class="keyword">sizeof</span>(nondataquality), 0);</div><div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;      }</div><div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;      <span class="comment">/* Update parameters for the queue */</span></div><div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;      time(&amp;now);</div><div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a43d6ec3224724bd43cc280902fe22991">recalc_holdtime</a>(qe, (now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;      member = lpeer-&gt;<a class="code" href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">member</a>;</div><div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;      callcompletedinsl = member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">callcompletedinsl</a> = ((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) &lt;= qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>);</div><div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;      <span class="comment">/* Increment the refcount for this member, since we&#39;re going to be using it for awhile in here. */</span></div><div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, 1);</div><div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a683847486195523a31706eeada8b4237">hangupcalls</a>(qe, outgoing, peer, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517">cancel_answered_elsewhere</a>);</div><div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;      outgoing = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;      <span class="keywordflow">if</span> (announce || qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a20ba21c586c791a31ef97102b4811a8f">reportholdtime</a> || qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">memberdelay</a>) {</div><div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;         <span class="keywordtype">int</span> res2;</div><div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;</div><div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;         res2 = <a class="code" href="../../d5/d7b/channel_8h.html#a7a8f6a50f3db42cb40cad7cfbd1d54f9">ast_autoservice_start</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;         <span class="keywordflow">if</span> (!res2) {</div><div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;            <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">memberdelay</a>) {</div><div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Delaying member connect for %d seconds\n&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">memberdelay</a>);</div><div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;               res2 = <a class="code" href="../../d5/d7b/channel_8h.html#af10e3bd01602095e1908d3926afc3b76">ast_safe_sleep</a>(peer, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">memberdelay</a> * 1000);</div><div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;            }</div><div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;            <span class="keywordflow">if</span> (!res2 &amp;&amp; announce) {</div><div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(peer, announce) &lt; 0) {</div><div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;play_file failed for &#39;%s&#39; on %s\n&quot;</span>, announce, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer));</div><div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;               }</div><div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;            }</div><div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;            <span class="keywordflow">if</span> (!res2 &amp;&amp; qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a20ba21c586c791a31ef97102b4811a8f">reportholdtime</a>) {</div><div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;               <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(peer, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a17b2ac278623f5aeb166dd16fc784acd">sound_reporthold</a>)) {</div><div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;                  <span class="keywordtype">long</span> holdtime, holdtimesecs;</div><div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;</div><div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;                  time(&amp;now);</div><div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;                  holdtime = labs((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) / 60);</div><div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;                  holdtimesecs = labs((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) % 60);</div><div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;                  <span class="keywordflow">if</span> (holdtime &gt; 0) {</div><div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;                     <a class="code" href="../../db/dce/say_8h.html#a899e1f86b2d65a32eeb6e17aabfa1f12">ast_say_number</a>(peer, holdtime, <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(peer), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(peer, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5a589c9dea9c88d7fea000ed1b8fc15">sound_minutes</a>) &lt; 0) {</div><div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;                        <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;play_file failed for &#39;%s&#39; on %s\n&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa5a589c9dea9c88d7fea000ed1b8fc15">sound_minutes</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer));</div><div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;                     }</div><div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;                  }</div><div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;                  <span class="keywordflow">if</span> (holdtimesecs &gt; 1) {</div><div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;                     <a class="code" href="../../db/dce/say_8h.html#a899e1f86b2d65a32eeb6e17aabfa1f12">ast_say_number</a>(peer, holdtimesecs, <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(peer), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;                     <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(peer, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a239514696fb2a3869913aee8fe9b83c7">sound_seconds</a>) &lt; 0) {</div><div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;                        <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;play_file failed for &#39;%s&#39; on %s\n&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a239514696fb2a3869913aee8fe9b83c7">sound_seconds</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer));</div><div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;                     }</div><div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;                  }</div><div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;               }</div><div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;            }</div><div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a08bde7d8cf72457fc8c519a4443b413b">ast_autoservice_stop</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;         }</div><div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a9c63fff1d736568d1ee332dd7ea502bd">ast_check_hangup</a>(peer)) {</div><div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;            <span class="comment">/* Agent must have hung up */</span></div><div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Agent on %s hungup on the customer.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer));</div><div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;AGENTDUMP&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;</div><div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;            blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: s, s: s}&quot;</span>,</div><div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;                       <span class="stringliteral">&quot;Queue&quot;</span>, queuename,</div><div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;                       <span class="stringliteral">&quot;Interface&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>,</div><div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;                       <span class="stringliteral">&quot;MemberName&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a8e96a6fc0050e0b3a0b79783d337aa3a">queue_publish_multi_channel_blob</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, queue_agent_dump_type(), blob);</div><div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;</div><div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;            <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <a class="code" href="../../df/dcf/dial_8h.html#aa6f5744a63607a37d8f8f1f6b646502b">ast_hangup_cause_to_dial_status</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a>(peer)));</div><div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ae6c85ee3595b7e9ee6fc072a3b7da814">ast_autoservice_chan_hangup_peer</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer);</div><div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(member);</div><div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, -1);</div><div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>;</div><div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a9c63fff1d736568d1ee332dd7ea502bd">ast_check_hangup</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)) {</div><div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;            <span class="comment">/* Caller must have hung up just before being connected */</span></div><div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Caller was about to talk to agent on %s but the caller hungup.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer));</div><div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;ABANDON&quot;</span>, <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(qe);</div><div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;            qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab234be20f2e48f4f08d2d2c071b8ff55">handled</a> = -1;</div><div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;            <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <a class="code" href="../../df/dcf/dial_8h.html#aa6f5744a63607a37d8f8f1f6b646502b">ast_hangup_cause_to_dial_status</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a>(peer)));</div><div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ae6c85ee3595b7e9ee6fc072a3b7da814">ast_autoservice_chan_hangup_peer</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer);</div><div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(member);</div><div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, -1);</div><div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;         }</div><div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;      }</div><div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;      <span class="comment">/* Stop music on hold */</span></div><div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;      <span class="keywordflow">if</span> (ringing) {</div><div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,-1);</div><div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;         <a class="code" href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;      }</div><div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;</div><div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;      <span class="comment">/* Make sure channels are compatible */</span></div><div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;      res = <a class="code" href="../../d5/d7b/channel_8h.html#a4aff0f5358bdc107a92320b4c4631834">ast_channel_make_compatible</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer);</div><div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;      <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;SYSCOMPAT&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Had to drop call because I couldn&#39;t make %s compatible with %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(peer));</div><div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(qe);</div><div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;         <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <a class="code" href="../../df/dcf/dial_8h.html#aa6f5744a63607a37d8f8f1f6b646502b">ast_hangup_cause_to_dial_status</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a>(peer)));</div><div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ae6c85ee3595b7e9ee6fc072a3b7da814">ast_autoservice_chan_hangup_peer</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer);</div><div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a>(member);</div><div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, -1);</div><div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;      }</div><div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;</div><div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;      <span class="comment">/* Play announcement to the caller telling it&#39;s his turn if defined */</span></div><div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a152370dd0464215e2573e744665cbe1a">sound_callerannounce</a>)) {</div><div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a152370dd0464215e2573e744665cbe1a">sound_callerannounce</a>)) {</div><div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Announcement file &#39;%s&#39; is unavailable, continuing anyway...\n&quot;</span>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a152370dd0464215e2573e744665cbe1a">sound_callerannounce</a>);</div><div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;         }</div><div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;      }</div><div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;</div><div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;      <span class="comment">/* if setinterfacevar is defined, make member variables available to the channel */</span></div><div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;      <span class="comment">/* use  pbx_builtin_setvar to set a load of variables with one call */</span></div><div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a0c5bcd98bca1c3085183ba1fc80195ed">setinterfacevar</a> &amp;&amp; interfacevar) {</div><div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;interfacevar, 0, <span class="stringliteral">&quot;MEMBERINTERFACE=%s,MEMBERNAME=%s,MEMBERCALLS=%d,MEMBERLASTCALL=%ld,MEMBERPENALTY=%d,MEMBERDYNAMIC=%d,MEMBERREALTIME=%d&quot;</span>,</div><div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;            member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>, (<span class="keywordtype">long</span>)member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>);</div><div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a7527f4b7b64622b458a3999ba51af07e">pbx_builtin_setvar_multiple</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(interfacevar));</div><div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a7527f4b7b64622b458a3999ba51af07e">pbx_builtin_setvar_multiple</a>(peer, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(interfacevar));</div><div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;      }</div><div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;</div><div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;      <span class="comment">/* if setqueueentryvar is defined, make queue entry (i.e. the caller) variables available to the channel */</span></div><div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;      <span class="comment">/* use  pbx_builtin_setvar to set a load of variables with one call */</span></div><div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;      <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a23486e86a21295aa734885d335ae9c2f">setqueueentryvar</a> &amp;&amp; interfacevar) {</div><div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;interfacevar, 0, <span class="stringliteral">&quot;QEHOLDTIME=%ld,QEORIGINALPOS=%d&quot;</span>,</div><div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;            (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>), qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>);</div><div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a7527f4b7b64622b458a3999ba51af07e">pbx_builtin_setvar_multiple</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(interfacevar));</div><div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a7527f4b7b64622b458a3999ba51af07e">pbx_builtin_setvar_multiple</a>(peer, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(interfacevar));</div><div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;      }</div><div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;</div><div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;</div><div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;      <span class="comment">/* try to set queue variables if configured to do so*/</span></div><div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138">set_queue_variables</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138">set_queue_variables</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, peer);</div><div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;</div><div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#aef676b88f94e92332fdded27143a56f5">setup_peer_after_bridge_goto</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, &amp;opts, opt_args);</div><div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;      <span class="keywordflow">if</span> ((monitorfilename = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;MONITOR_FILENAME&quot;</span>))) {</div><div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;            monitorfilename = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(monitorfilename);</div><div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;      }</div><div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;</div><div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;      <span class="comment">/* Begin Monitoring */</span></div><div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;      <span class="keywordflow">if</span> (*qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>) {</div><div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;         <span class="keywordflow">if</span> (!qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7ccaa047c703f95f5eaf0dd0a10670b5">montype</a>) {</div><div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *monexec;</div><div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Starting Monitor as requested.\n&quot;</span>);</div><div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;            <span class="keywordflow">if</span> ((monexec = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;MONITOR_EXEC&quot;</span>)) || <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;MONITOR_EXEC_ARGS&quot;</span>)) {</div><div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;               which = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;               monexec = monexec ? <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(monexec) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;               which = peer;</div><div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;            }</div><div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;            <span class="keywordflow">if</span> (monitorfilename) {</div><div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;               <a class="code" href="../../d2/d1b/res__monitor_8c.html#acbcd8e50de0a8867d7a843c2b6915e0d">ast_monitor_start</a>(which, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>, monitorfilename, 1, <a class="code" href="../../d5/d60/monitor_8h.html#a95b90f61870300ea984afae5123dd44f">X_REC_IN</a> | <a class="code" href="../../d5/d60/monitor_8h.html#ac03869f26afacb6d45355d401ced19d8">X_REC_OUT</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>) {</div><div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;               <a class="code" href="../../d2/d1b/res__monitor_8c.html#acbcd8e50de0a8867d7a843c2b6915e0d">ast_monitor_start</a>(which, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), 1, <a class="code" href="../../d5/d60/monitor_8h.html#a95b90f61870300ea984afae5123dd44f">X_REC_IN</a> | <a class="code" href="../../d5/d60/monitor_8h.html#ac03869f26afacb6d45355d401ced19d8">X_REC_OUT</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;               <span class="comment">/* Last ditch effort -- no channel, make up something */</span></div><div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;               snprintf(tmpid, <span class="keyword">sizeof</span>(tmpid), <span class="stringliteral">&quot;chan-%lx&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>());</div><div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;               <a class="code" href="../../d2/d1b/res__monitor_8c.html#acbcd8e50de0a8867d7a843c2b6915e0d">ast_monitor_start</a>(which, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">monfmt</a>, tmpid, 1, <a class="code" href="../../d5/d60/monitor_8h.html#a95b90f61870300ea984afae5123dd44f">X_REC_IN</a> | <a class="code" href="../../d5/d60/monitor_8h.html#ac03869f26afacb6d45355d401ced19d8">X_REC_OUT</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;            }</div><div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(monexec)) {</div><div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;               <a class="code" href="../../d2/d1b/res__monitor_8c.html#a24009cd78ef05c71b550254624eb6c13">ast_monitor_setjoinfiles</a>(which, 1);</div><div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;            }</div><div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a3ee5f9b7ec29ebb95c4e1ac00fafde83">setup_mixmonitor</a>(qe, monitorfilename);</div><div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;         }</div><div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;      }</div><div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;      <span class="comment">/* Drop out of the queue at this point, to prepare for next caller */</span></div><div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a3135d5c6b468bef49c1e3fc5d7394f30">leave_queue</a>(qe);</div><div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(url) &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#a981a7bfac667e10cb62582b465e48d98">ast_channel_supports_html</a>(peer)) {</div><div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;app_queue: sendurl=%s.\n&quot;</span>, url);</div><div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ac1509976728f0058b229802a66a485ee">ast_channel_sendurl</a>(peer, url);</div><div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;      }</div><div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;</div><div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;      <span class="comment">/* run a macro for this connection if defined. The macro simply returns, no action is taken on the result */</span></div><div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;      <span class="comment">/* use macro from dialplan if passed as a option, otherwise use the default queue macro */</span></div><div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(macro)) {</div><div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;         macroexec = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(macro);</div><div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;         <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#af24a688a480acefa8eaa91133cefd156">membermacro</a>) {</div><div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;            macroexec = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#af24a688a480acefa8eaa91133cefd156">membermacro</a>);</div><div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;         }</div><div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;      }</div><div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;</div><div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(macroexec)) {</div><div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;app_queue: macro=%s.\n&quot;</span>, macroexec);</div><div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;         <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aaf3af8d672383b48d194deb468074cbe">ast_app_exec_macro</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, macroexec);</div><div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;      }</div><div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;</div><div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;      <span class="comment">/* run a gosub for this connection if defined. The gosub simply returns, no action is taken on the result */</span></div><div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;      <span class="comment">/* use gosub from dialplan if passed as a option, otherwise use the default queue gosub */</span></div><div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(gosub)) {</div><div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;         gosubexec = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(gosub);</div><div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;         <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aafe5c53f028a19ef0c45dd193115d2aa">membergosub</a>) {</div><div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;            gosubexec = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aafe5c53f028a19ef0c45dd193115d2aa">membergosub</a>);</div><div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;         }</div><div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;      }</div><div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;</div><div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(gosubexec)) {</div><div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;         <span class="keywordtype">char</span> *gosub_args = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;         <span class="keywordtype">char</span> *gosub_argstart;</div><div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;</div><div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;app_queue: gosub=%s.\n&quot;</span>, gosubexec);</div><div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;</div><div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;         gosub_argstart = strchr(gosubexec, <span class="charliteral">&#39;,&#39;</span>);</div><div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;         <span class="keywordflow">if</span> (gosub_argstart) {</div><div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *what_is_s = <span class="stringliteral">&quot;s&quot;</span>;</div><div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;            *gosub_argstart = 0;</div><div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(peer, gosubexec, <span class="stringliteral">&quot;s&quot;</span>, 1, <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) &amp;&amp;</div><div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;                <a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(peer, gosubexec, <span class="stringliteral">&quot;~~s~~&quot;</span>, 1, <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;               what_is_s = <span class="stringliteral">&quot;~~s~~&quot;</span>;</div><div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;            }</div><div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;gosub_args, <span class="stringliteral">&quot;%s,%s,1(%s)&quot;</span>, gosubexec, what_is_s, gosub_argstart + 1) &lt; 0) {</div><div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;               gosub_args = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;            }</div><div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;            *gosub_argstart = <span class="charliteral">&#39;,&#39;</span>;</div><div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *what_is_s = <span class="stringliteral">&quot;s&quot;</span>;</div><div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(peer, gosubexec, <span class="stringliteral">&quot;s&quot;</span>, 1, <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) &amp;&amp;</div><div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;                <a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(peer, gosubexec, <span class="stringliteral">&quot;~~s~~&quot;</span>, 1, <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(peer)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;               what_is_s = <span class="stringliteral">&quot;~~s~~&quot;</span>;</div><div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;            }</div><div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;gosub_args, <span class="stringliteral">&quot;%s,%s,1&quot;</span>, gosubexec, what_is_s) &lt; 0) {</div><div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;               gosub_args = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;            }</div><div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;         }</div><div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;         <span class="keywordflow">if</span> (gosub_args) {</div><div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;            <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aee5e20694b04eee43463fde6cf121d06">ast_app_exec_sub</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, gosub_args, 0);</div><div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(gosub_args);</div><div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not Allocate string for Gosub arguments -- Gosub Call Aborted!\n&quot;</span>);</div><div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;         }</div><div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;      }</div><div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;</div><div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(agi)) {</div><div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;app_queue: agi=%s.\n&quot;</span>, agi);</div><div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;         application = <a class="code" href="../../db/de0/pbx_8h.html#ad4a6912dcd2ad44a186d0a284afafc51">pbx_findapp</a>(<span class="stringliteral">&quot;agi&quot;</span>);</div><div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;         <span class="keywordflow">if</span> (application) {</div><div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;            agiexec = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(agi);</div><div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;            <a class="code" href="../../db/de0/pbx_8h.html#a6e3dbc57c03c23543354ef108c31fac8">pbx_exec</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, application, agiexec);</div><div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Asked to execute an AGI on this channel, but could not find application (agi)!\n&quot;</span>);</div><div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;         }</div><div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;      }</div><div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;      qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ab234be20f2e48f4f08d2d2c071b8ff55">handled</a>++;</div><div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;</div><div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;CONNECT&quot;</span>, <span class="stringliteral">&quot;%ld|%s|%ld&quot;</span>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(peer),</div><div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;                                       (<span class="keywordtype">long</span>)(orig - to &gt; 0 ? (orig - to) / 1000 : 0));</div><div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;</div><div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;      blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: s, s: s, s: I, s: I}&quot;</span>,</div><div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;                 <span class="stringliteral">&quot;Queue&quot;</span>, queuename,</div><div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;                 <span class="stringliteral">&quot;Interface&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>,</div><div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;                 <span class="stringliteral">&quot;MemberName&quot;</span>, member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>,</div><div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;                 <span class="stringliteral">&quot;HoldTime&quot;</span>, (<a class="code" href="../../d4/d05/json_8h.html#ae2cc29409ec389e8feaf38ec3a585d83">ast_json_int_t</a>)(time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>),</div><div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;                 <span class="stringliteral">&quot;RingTime&quot;</span>, (<a class="code" href="../../d4/d05/json_8h.html#ae2cc29409ec389e8feaf38ec3a585d83">ast_json_int_t</a>)(orig - to &gt; 0 ? (orig - to) / 1000 : 0));</div><div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8e96a6fc0050e0b3a0b79783d337aa3a">queue_publish_multi_channel_blob</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, queue_agent_connect_type(), blob);</div><div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;</div><div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(oldcontext, <a class="code" href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <span class="keyword">sizeof</span>(oldcontext));</div><div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(oldexten, <a class="code" href="../../d5/d7b/channel_8h.html#aa8b52fbc8168e939bc5553502367d46a">ast_channel_exten</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <span class="keyword">sizeof</span>(oldexten));</div><div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;</div><div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;      <span class="keywordflow">if</span> ((queue_end_bridge = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*queue_end_bridge), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;         queue_end_bridge-&gt;<a class="code" href="../../d5/d61/structqueue__end__bridge.html#a6d8b242e106dd6592a625bdc396bbe55">q</a> = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>;</div><div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;         queue_end_bridge-&gt;<a class="code" href="../../d5/d61/structqueue__end__bridge.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;         bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#a5fd13b216c2752f4f1fb843cae429558">end_bridge_callback</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#acb5e3261ae018d7bbe4cbdcc9cace101">end_bridge_callback</a>;</div><div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;         bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#a30cb875f49910a9515ee92d8dfdf8b83">end_bridge_callback_data</a> = queue_end_bridge;</div><div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;         bridge_config.<a class="code" href="../../d0/d13/structast__bridge__config.html#ad4660f46b880089e643fd8798808bd5f">end_bridge_callback_data_fixup</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#adc150dec1056eca590d0f1555ff5188b">end_bridge_callback_data_fixup</a>;</div><div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;         <span class="comment">/* Since queue_end_bridge can survive beyond the life of this call to Queue, we need</span></div><div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;<span class="comment">          * to make sure to increase the refcount of this queue so it cannot be freed until we</span></div><div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;<span class="comment">          * are done with it. We remove this reference in end_bridge_callback.</span></div><div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a92781796b10a269001fffa4646ac1a1f">queue_t_ref</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, <span class="stringliteral">&quot;For bridge_config reference&quot;</span>);</div><div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;      }</div><div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;</div><div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;      time(&amp;member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>);</div><div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;      starttime = member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a>;</div><div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;      <span class="comment">/* As a queue member may end up in multiple calls at once if a transfer occurs with</span></div><div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;<span class="comment">       * a Local channel in the mix we pass the current call information (starttime) to the</span></div><div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;<span class="comment">       * Stasis subscriptions so when they update the queue member data it becomes a noop</span></div><div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;<span class="comment">       * if this call is no longer between the caller and the queue member.</span></div><div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a1834405d3ba8801a861dc0e85b1225e3">setup_stasis_subs</a>(qe, peer, member, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>, starttime, callcompletedinsl);</div><div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;      bridge = <a class="code" href="../../de/d47/features_8h.html#a8b286e6d3fdb7ca3a907c5b327e1b4a9">ast_bridge_call_with_flags</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, peer, &amp;bridge_config,</div><div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;            <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a>);</div><div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;</div><div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;      res = bridge ? bridge : 1;</div><div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, -1);</div><div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;   }</div><div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>:</div><div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a683847486195523a31706eeada8b4237">hangupcalls</a>(qe, outgoing, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517">cancel_answered_elsewhere</a>);</div><div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;</div><div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;}</div><div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;</div><div class="line"><a name="l07229"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae2c06dcaa81d44b2782bb33be68c4858"> 7229</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae2c06dcaa81d44b2782bb33be68c4858">wait_a_bit</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe)</div><div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;{</div><div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;   <span class="comment">/* Don&#39;t need to hold the lock while we setup the outgoing calls */</span></div><div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;   <span class="keywordtype">int</span> retrywait = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b">retry</a> * 1000;</div><div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;</div><div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;   <span class="keywordtype">int</span> res = <a class="code" href="../../d5/d7b/channel_8h.html#a050bec9a4abc1a599b6573a6091b080c">ast_waitfordigit</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, retrywait);</div><div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;   <span class="keywordflow">if</span> (res &gt; 0 &amp;&amp; !<a class="code" href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456">valid_exit</a>(qe, res)) {</div><div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;      res = 0;</div><div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;   }</div><div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;</div><div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;}</div><div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;</div><div class="line"><a name="l07242"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa"> 7242</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>)</div><div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;{</div><div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;</div><div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;   <span class="keywordflow">if</span> (!q) {</div><div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;   }</div><div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;   <span class="keywordflow">while</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(interface, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>)) {</div><div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;         <span class="keywordflow">return</span> mem;</div><div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;      }</div><div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;   }</div><div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;</div><div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;}</div><div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;</div><div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;<span class="comment">/*! \brief Dump all members in a specific queue to the database</span></div><div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;<span class="comment"> * \code</span></div><div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;<span class="comment"> * &lt;pm_family&gt;/&lt;queuename&gt; = &lt;interface&gt;;&lt;penalty&gt;;&lt;paused&gt;;&lt;state_interface&gt;[|...]</span></div><div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;<span class="comment"> * \endcode</span></div><div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07269"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2268442ff742f200d845e5223a722594"> 7269</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2268442ff742f200d845e5223a722594">dump_queue_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *pm_queue)</div><div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;{</div><div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *cur_member;</div><div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;</div><div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;   <span class="keywordflow">if</span> (!pm_queue) {</div><div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;   }</div><div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;</div><div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;   <span class="comment">/* 4K is a reasonable default for most applications, but we grow to</span></div><div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;<span class="comment">    * accommodate more if necessary. */</span></div><div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;   <span class="keywordflow">if</span> (!(value = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(4096))) {</div><div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;   }</div><div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;</div><div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;   mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(pm_queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;   <span class="keywordflow">while</span> ((cur_member = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;      <span class="keywordflow">if</span> (!cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a>) {</div><div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cur_member, -1);</div><div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;      }</div><div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;</div><div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;value, 0, <span class="stringliteral">&quot;%s%s;%d;%d;%s;%s;%s;%d&quot;</span>,</div><div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(value) ? <span class="stringliteral">&quot;|&quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;         cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>,</div><div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;         cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>,</div><div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;         cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>,</div><div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;         cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>,</div><div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;         cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>,</div><div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;         cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>,</div><div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;         cur_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>);</div><div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;</div><div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cur_member, -1);</div><div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;   }</div><div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;</div><div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(value) &amp;&amp; !cur_member) {</div><div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../de/d4a/astdb_8h.html#a0f14f6bff4f412c88b50aba34d3a5e35">ast_db_put</a>(pm_family, pm_queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(value))) {</div><div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;failed to create persistent dynamic entry!\n&quot;</span>);</div><div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;      }</div><div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;      <span class="comment">/* Delete the entry if the queue is empty or there is an error */</span></div><div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;      <a class="code" href="../../de/d4a/astdb_8h.html#a71e8d5ab1757b184683a99125d1c8160">ast_db_del</a>(pm_family, pm_queue-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;   }</div><div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;</div><div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(value);</div><div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;}</div><div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;<span class="comment">/*! \brief Remove member from queue</span></div><div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;<span class="comment"> * \retval RES_NOT_DYNAMIC when they aren&#39;t a RT member</span></div><div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;<span class="comment"> * \retval RES_NOSUCHQUEUE queue does not exist</span></div><div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;<span class="comment"> * \retval RES_OKAY removed member from queue</span></div><div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;<span class="comment"> * \retval RES_EXISTS queue exists but no members</span></div><div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l07324"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2d8545a6eecf92b885f8880aaaf662d2"> 7324</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2d8545a6eecf92b885f8880aaaf662d2">remove_from_queue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *interface)</div><div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;{</div><div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, tmpq = {</div><div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;      .<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> = queuename,</div><div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;   };</div><div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem, tmpmem;</div><div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;   <span class="keywordtype">int</span> res = <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>;</div><div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;</div><div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmpmem.<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, interface, <span class="keyword">sizeof</span>(tmpmem.<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>));</div><div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a>(queues, &amp;tmpq, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>, <span class="stringliteral">&quot;Temporary reference for interface removal&quot;</span>))) {</div><div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;      <span class="keywordflow">if</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, &amp;tmpmem, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>))) {</div><div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;         <span class="comment">/* XXX future changes should beware of this assumption!! */</span></div><div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;         <span class="comment">/*Change Penalty on realtime users*/</span></div><div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;         <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a> &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">rt_uniqueid</a>) &amp;&amp; negative_penalty_invalid) {</div><div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#abc63b07b1a30653be5a5f722ce7ee39c">update_realtime_member_field</a>(mem, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;penalty&quot;</span>, <span class="stringliteral">&quot;-1&quot;</span>);</div><div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a>) {</div><div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Interface wasn&#39;t dynamic, expiring temporary reference&quot;</span>);</div><div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a447a632daaf1a56114da95816c12b8a5">RES_NOT_DYNAMIC</a>;</div><div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;         }</div><div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a>(queue_member_removed_type(), <a class="code" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a>(q, mem));</div><div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;</div><div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a">member_remove_from_queue</a>(q, mem);</div><div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;</div><div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;         <span class="keywordflow">if</span> (queue_persistent_members) {</div><div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a2268442ff742f200d845e5223a722594">dump_queue_members</a>(q);</div><div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;         }</div><div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;</div><div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#ab9873b95b03723c7f06d85b044b9e96c">num_available_members</a>(q)) {</div><div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_avail&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;         }</div><div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;</div><div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;         res = <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>;</div><div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;         res = <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>;</div><div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;      }</div><div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Expiring temporary reference&quot;</span>);</div><div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;   }</div><div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;</div><div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;}</div><div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;<span class="comment">/*! \brief Add member to queue</span></div><div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;<span class="comment"> * \retval RES_NOT_DYNAMIC when they aren&#39;t a RT member</span></div><div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;<span class="comment"> * \retval RES_NOSUCHQUEUE queue does not exist</span></div><div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;<span class="comment"> * \retval RES_OKAY added member from queue</span></div><div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;<span class="comment"> * \retval RES_EXISTS queue exists but no members</span></div><div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;<span class="comment"> * \retval RES_OUT_OF_MEMORY queue exists but not enough memory to create member</span></div><div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l07377"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad6687a49016ace40e5834f697417268a"> 7377</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad6687a49016ace40e5834f697417268a">add_to_queue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>, <span class="keywordtype">int</span> dump, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>)</div><div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;{</div><div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *new_member, *old_member;</div><div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;   <span class="keywordtype">int</span> res = <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>;</div><div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;<span class="comment">   /*! \note Ensure the appropriate realtime queue is loaded.  Note that this</span></div><div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;<span class="comment">    * short-circuits if the queue is already in memory. */</span></div><div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;   <span class="keywordflow">if</span> (!(q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queuename))) {</div><div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;   }</div><div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;</div><div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;   <span class="keywordflow">if</span> ((old_member = <a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(q, interface)) == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;      <span class="keywordflow">if</span> ((new_member = <a class="code" href="../../da/dfb/app__queue_8c.html#a066e0020d2b8551be747bd42d26ab94a">create_queue_member</a>(interface, membername, penalty, paused, state_interface, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>, wrapuptime))) {</div><div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;         new_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a> = 1;</div><div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;         <span class="keywordflow">if</span> (reason_paused) {</div><div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(new_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>, reason_paused, <span class="keyword">sizeof</span>(new_member-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>));</div><div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;         }</div><div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ac3cd051d456ef70c6b88a3c2c6056432">member_add_to_queue</a>(q, new_member);</div><div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a>(queue_member_added_type(), <a class="code" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a>(q, new_member));</div><div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;</div><div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a4fe68b376a679a230a33d09423e76b15">is_member_available</a>(q, new_member)) {</div><div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_avail&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;         }</div><div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;</div><div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(new_member, -1);</div><div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;         new_member = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;</div><div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;         <span class="keywordflow">if</span> (dump) {</div><div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a2268442ff742f200d845e5223a722594">dump_queue_members</a>(q);</div><div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;         }</div><div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;</div><div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;         res = <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>;</div><div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;         res = <a class="code" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a>;</div><div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;      }</div><div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(old_member, -1);</div><div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;      res = <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>;</div><div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;   }</div><div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Expiring temporary reference&quot;</span>);</div><div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;</div><div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;}</div><div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;</div><div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;<span class="comment">/*! \brief Change priority caller into a queue</span></div><div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;<span class="comment"> * \retval RES_NOSUCHQUEUE queue does not exist</span></div><div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;<span class="comment"> * \retval RES_OKAY change priority</span></div><div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;<span class="comment"> * \retval RES_NOT_CALLER queue exists but no caller</span></div><div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l07430"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a53953b67278cd604638905b98734c248"> 7430</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a53953b67278cd604638905b98734c248">change_priority_caller_on_queue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *caller, <span class="keywordtype">int</span> <a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>)</div><div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;{</div><div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe;</div><div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;   <span class="keywordtype">int</span> res = <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>;</div><div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;<span class="comment">   /*! \note Ensure the appropriate realtime queue is loaded.  Note that this</span></div><div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;<span class="comment">    * short-circuits if the queue is already in memory. */</span></div><div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;   <span class="keywordflow">if</span> (!(q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queuename))) {</div><div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;   }</div><div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;</div><div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;   res = <a class="code" href="../../da/dfb/app__queue_8c.html#a1802f66ae1666498af70e9a4ff2e616b">RES_NOT_CALLER</a>;</div><div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;   <span class="keywordflow">for</span> (qe = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>; qe; qe = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>) {</div><div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;      <span class="keywordflow">if</span> (strcmp(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), caller) == 0) {</div><div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s Caller new prioriry %d in queue %s\n&quot;</span>,</div><div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;                      caller, priority, queuename);</div><div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;         qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a> = <a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>;</div><div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;         res = <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>;</div><div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;      }</div><div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;   }</div><div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;}</div><div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;</div><div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;</div><div class="line"><a name="l07457"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a88738ce65026cc83cafc0e6a96fe8cf9"> 7457</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88738ce65026cc83cafc0e6a96fe8cf9">publish_queue_member_pause</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>)</div><div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;{</div><div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json_blob = <a class="code" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a>(q, member);</div><div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;</div><div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;   <span class="keywordflow">if</span> (!json_blob) {</div><div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;   }</div><div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;</div><div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a>(queue_member_pause_type(), json_blob);</div><div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;</div><div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;}</div><div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;<span class="comment"> * \brief Set the pause status of the specific queue member.</span></div><div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;<span class="comment"> * \param q Which queue the member belongs.</span></div><div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;<span class="comment"> * \param mem Queue member being paused/unpaused.</span></div><div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;<span class="comment"> * \param reason Why is this happening (Can be NULL/empty for no reason given.)</span></div><div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;<span class="comment"> * \param paused Set to 1 if the member is being paused or 0 to unpause.</span></div><div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;<span class="comment"> * \pre The q is locked on entry.</span></div><div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07483"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9861344280a3db982c67cd1f6de89d2b"> 7483</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9861344280a3db982c67cd1f6de89d2b">set_queue_member_pause</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem, <span class="keyword">const</span> <span class="keywordtype">char</span> *reason, <span class="keywordtype">int</span> paused)</div><div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;{</div><div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;   <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> == paused) {</div><div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%spausing already-%spaused queue member %s:%s\n&quot;</span>,</div><div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;         (paused ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;un&quot;</span>), (paused ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;un&quot;</span>), q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;   }</div><div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;</div><div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;   <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>) {</div><div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#abc63b07b1a30653be5a5f722ce7ee39c">update_realtime_member_field</a>(mem, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;paused&quot;</span>, paused ? <span class="stringliteral">&quot;1&quot;</span> : <span class="stringliteral">&quot;0&quot;</span>)) {</div><div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed %spause update of realtime queue member %s:%s\n&quot;</span>,</div><div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;            (paused ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;un&quot;</span>), q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;      }</div><div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;   }</div><div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;</div><div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;   mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> = paused;</div><div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;   <span class="keywordflow">if</span> (paused) {</div><div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;      time(&amp;mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a>); <span class="comment">/* update last pause field */</span></div><div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;   }</div><div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;   <span class="keywordflow">if</span> (paused &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(reason)) {</div><div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>, reason, <span class="keyword">sizeof</span>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>));</div><div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;      mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;   }</div><div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;</div><div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;   <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> ? <a class="code" href="../../da/dfb/app__queue_8c.html#a5186e735a8b6b1d630a236fce8db0fd7">QUEUE_PAUSED_DEVSTATE</a> : <a class="code" href="../../da/dfb/app__queue_8c.html#a232b6e5850a21fb799fdec8a3072bd45">QUEUE_UNPAUSED_DEVSTATE</a>,</div><div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;      <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Queue:%s_pause_%s&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;</div><div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;   <span class="keywordflow">if</span> (queue_persistent_members) {</div><div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a2268442ff742f200d845e5223a722594">dump_queue_members</a>(q);</div><div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;   }</div><div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;</div><div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a4fe68b376a679a230a33d09423e76b15">is_member_available</a>(q, mem)) {</div><div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;      <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>,</div><div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;         <span class="stringliteral">&quot;Queue:%s_avail&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#ab9873b95b03723c7f06d85b044b9e96c">num_available_members</a>(q)) {</div><div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;      <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>,</div><div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;         <span class="stringliteral">&quot;Queue:%s_avail&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;   }</div><div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;</div><div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;NONE&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, (paused ? <span class="stringliteral">&quot;PAUSE&quot;</span> : <span class="stringliteral">&quot;UNPAUSE&quot;</span>),</div><div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(reason, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;</div><div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a88738ce65026cc83cafc0e6a96fe8cf9">publish_queue_member_pause</a>(q, mem);</div><div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;}</div><div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;</div><div class="line"><a name="l07528"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290"> 7528</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *interface, <span class="keyword">const</span> <span class="keywordtype">char</span> *reason, <span class="keywordtype">int</span> paused)</div><div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;{</div><div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;   <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;</div><div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate over queues&quot;</span>))) {</div><div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename) || !strcasecmp(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queuename)) {</div><div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;</div><div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;         <span class="keywordflow">if</span> ((mem = <a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(q, interface))) {</div><div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;<span class="comment">             * Before we do the PAUSE/UNPAUSE, log if this was a</span></div><div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;<span class="comment">             * PAUSEALL/UNPAUSEALL but only on the first found entry.</span></div><div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;            ++found;</div><div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;            <span class="keywordflow">if</span> (found == 1</div><div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;               &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) {</div><div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;               <span class="comment">/*</span></div><div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;<span class="comment">                * XXX In all other cases, we use the queue name,</span></div><div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;<span class="comment">                * but since this affects all queues, we cannot.</span></div><div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;NONE&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>,</div><div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;                  (paused ? <span class="stringliteral">&quot;PAUSEALL&quot;</span> : <span class="stringliteral">&quot;UNPAUSEALL&quot;</span>), <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(reason, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;            }</div><div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;</div><div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a9861344280a3db982c67cd1f6de89d2b">set_queue_member_pause</a>(q, mem, reason, paused);</div><div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;         }</div><div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;</div><div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) {</div><div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;         }</div><div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;      }</div><div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;</div><div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;   }</div><div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;</div><div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;   <span class="keywordflow">return</span> found ? <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a> : <a class="code" href="../../dc/db0/cli_8h.html#aea87ce97f86effb2c4df6274d4aac567">RESULT_FAILURE</a>;</div><div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;}</div><div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;<span class="comment"> * \brief helper function for set_member_penalty - given a queue, sets all member penalties with the interface</span></div><div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;<span class="comment"> * \param[in] q queue which is having its member&#39;s penalty changed - must be unlocked prior to calling</span></div><div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;<span class="comment"> * \param[in] interface String of interface used to search for queue members being changed</span></div><div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;<span class="comment"> * \param[in] penalty Value penalty is being changed to for the member.</span></div><div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;<span class="comment"> * \retval 0 if the there is no member with interface belonging to q and no change is made</span></div><div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;<span class="comment"> * \retval 1 if the there is a member with interface belonging to q and changes are made</span></div><div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07584"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#afd9e966fe2ccc284fbe37cc5acd60f17"> 7584</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#afd9e966fe2ccc284fbe37cc5acd60f17">set_member_penalty_help_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>)</div><div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;{</div><div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;   <span class="keywordtype">int</span> foundinterface = 0;</div><div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160;</div><div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;   <span class="keywordflow">if</span> ((mem = <a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(q, interface))) {</div><div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;      foundinterface++;</div><div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;      <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>) {</div><div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;         <span class="keywordtype">char</span> rtpenalty[80];</div><div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;</div><div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;         sprintf(rtpenalty, <span class="stringliteral">&quot;%i&quot;</span>, penalty);</div><div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#abc63b07b1a30653be5a5f722ce7ee39c">update_realtime_member_field</a>(mem, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;penalty&quot;</span>, rtpenalty);</div><div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;      }</div><div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;</div><div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;      mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a> = <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;</div><div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;NONE&quot;</span>, interface, <span class="stringliteral">&quot;PENALTY&quot;</span>, <span class="stringliteral">&quot;%d&quot;</span>, penalty);</div><div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a>(queue_member_penalty_type(), <a class="code" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a>(q, mem));</div><div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;   }</div><div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;</div><div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;   <span class="keywordflow">return</span> foundinterface;</div><div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;}</div><div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;<span class="comment"> * \brief Set the ringinuse value of the specific queue member.</span></div><div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;<span class="comment"> * \param q Which queue the member belongs.</span></div><div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;<span class="comment"> * \param mem Queue member being set.</span></div><div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;<span class="comment"> * \param ringinuse Set to 1 if the member is called when inuse.</span></div><div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;<span class="comment"> * \pre The q is locked on entry.</span></div><div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07622"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2c78c8b752b9ea7de6e7def56bd0b4ce"> 7622</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2c78c8b752b9ea7de6e7def56bd0b4ce">set_queue_member_ringinuse</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">struct</span> <a class="code" href="../../d7/dd6/structmember.html">member</a> *mem, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>)</div><div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;{</div><div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;   <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>) {</div><div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#abc63b07b1a30653be5a5f722ce7ee39c">update_realtime_member_field</a>(mem, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, realtime_ringinuse_field,</div><div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;         ringinuse ? <span class="stringliteral">&quot;1&quot;</span> : <span class="stringliteral">&quot;0&quot;</span>);</div><div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;   }</div><div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;</div><div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;   mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> = <a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;</div><div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <span class="stringliteral">&quot;NONE&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="stringliteral">&quot;RINGINUSE&quot;</span>, <span class="stringliteral">&quot;%d&quot;</span>, ringinuse);</div><div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a>(queue_member_ringinuse_type(), <a class="code" href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a>(q, mem));</div><div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;}</div><div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;</div><div class="line"><a name="l07635"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a450fb190b54c3d071e9a51111edb6e54"> 7635</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a450fb190b54c3d071e9a51111edb6e54">set_member_ringinuse_help_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>)</div><div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;{</div><div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;   <span class="keywordtype">int</span> foundinterface = 0;</div><div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;</div><div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;   <span class="keywordflow">if</span> ((mem = <a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(q, interface))) {</div><div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;      foundinterface++;</div><div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a2c78c8b752b9ea7de6e7def56bd0b4ce">set_queue_member_ringinuse</a>(q, mem, ringinuse);</div><div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;   }</div><div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;</div><div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;   <span class="keywordflow">return</span> foundinterface;</div><div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;}</div><div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;</div><div class="line"><a name="l07651"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9f47efbf12dd8d11585d5bd6da60b600"> 7651</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9f47efbf12dd8d11585d5bd6da60b600">set_member_value_help_members</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keywordtype">int</span> property, <span class="keywordtype">int</span> <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>)</div><div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;{</div><div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;   <span class="keywordflow">switch</span>(property) {</div><div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a>:</div><div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#afd9e966fe2ccc284fbe37cc5acd60f17">set_member_penalty_help_members</a>(q, interface, value);</div><div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;</div><div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b">MEMBER_RINGINUSE</a>:</div><div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a450fb190b54c3d071e9a51111edb6e54">set_member_ringinuse_help_members</a>(q, interface, value);</div><div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;</div><div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Attempted to set invalid property\n&quot;</span>);</div><div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;   }</div><div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;}</div><div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;<span class="comment"> * \brief Sets members penalty, if queuename=NULL we set member penalty in all the queues.</span></div><div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;<span class="comment"> * \param[in] queuename If specified, only act on a member if it belongs to this queue</span></div><div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;<span class="comment"> * \param[in] interface Interface of queue member(s) having priority set.</span></div><div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;<span class="comment"> * \param[in] property Which queue property is being set</span></div><div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;<span class="comment"> * \param[in] penalty Value penalty is being changed to for each member</span></div><div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07674"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72"> 7674</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, <span class="keywordtype">int</span> property, <span class="keywordtype">int</span> <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>)</div><div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;{</div><div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;   <span class="keywordtype">int</span> foundinterface = 0, foundqueue = 0;</div><div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *queue_config = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;</div><div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;   <span class="comment">/* property dependent restrictions on values should be checked in this switch */</span></div><div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;   <span class="keywordflow">switch</span> (property) {</div><div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a>:</div><div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;      <span class="keywordflow">if</span> (value &lt; 0 &amp;&amp; !negative_penalty_invalid) {</div><div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid penalty (%d)\n&quot;</span>, value);</div><div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#aea87ce97f86effb2c4df6274d4aac567">RESULT_FAILURE</a>;</div><div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;      }</div><div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;   }</div><div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;</div><div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) { <span class="comment">/* This means we need to iterate through all the queues. */</span></div><div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a910f835a41772603d33e200c956549ff">ast_check_realtime</a>(<span class="stringliteral">&quot;queues&quot;</span>)) {</div><div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;         queue_config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a29ff8cd717c0c0bac60abbd827fec409">ast_load_realtime_multientry</a>(<span class="stringliteral">&quot;queues&quot;</span>, <span class="stringliteral">&quot;name LIKE&quot;</span>, <span class="stringliteral">&quot;%&quot;</span>, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;         <span class="keywordflow">if</span> (queue_config) {</div><div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;            <span class="keywordtype">char</span> *category = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;            <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(queue_config, category))) {</div><div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(queue_config, category, <span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Ignoring realtime queue with a NULL or empty &#39;name.&#39;\n&quot;</span>);</div><div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;               }</div><div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;               <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(name))) {</div><div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;                  foundqueue++;</div><div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;                  foundinterface += <a class="code" href="../../da/dfb/app__queue_8c.html#a9f47efbf12dd8d11585d5bd6da60b600">set_member_value_help_members</a>(q, interface, property, value);</div><div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;                  <a class="code" href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab">queue_unref</a>(q);</div><div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;               }</div><div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;            }</div><div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;         }</div><div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;      }</div><div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;</div><div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;      <span class="comment">/* After hitting realtime queues, go back and get the regular ones. */</span></div><div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;      queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;      <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;         foundqueue++;</div><div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;         foundinterface += <a class="code" href="../../da/dfb/app__queue_8c.html#a9f47efbf12dd8d11585d5bd6da60b600">set_member_value_help_members</a>(q, interface, property, value);</div><div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab">queue_unref</a>(q);</div><div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;      }</div><div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;   } <span class="keywordflow">else</span> { <span class="comment">/* We actually have a queuename, so we can just act on the single queue. */</span></div><div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;      <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queuename))) {</div><div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;         foundqueue++;</div><div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;         foundinterface += <a class="code" href="../../da/dfb/app__queue_8c.html#a9f47efbf12dd8d11585d5bd6da60b600">set_member_value_help_members</a>(q, interface, property, value);</div><div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab">queue_unref</a>(q);</div><div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;      }</div><div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;   }</div><div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;</div><div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;   <span class="keywordflow">if</span> (foundinterface) {</div><div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a>;</div><div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!foundqueue) {</div><div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid queuename\n&quot;</span>);</div><div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid interface\n&quot;</span>);</div><div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;   }</div><div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;</div><div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#aea87ce97f86effb2c4df6274d4aac567">RESULT_FAILURE</a>;</div><div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;}</div><div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;</div><div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;<span class="comment">/* \brief Gets members penalty.</span></div><div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;<span class="comment"> * \return Return the members penalty or RESULT_FAILURE on error.</span></div><div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l07740"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6fdd4581a4a8945d35a54bb170b21ac6"> 7740</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6fdd4581a4a8945d35a54bb170b21ac6">get_member_penalty</a>(<span class="keywordtype">char</span> *queuename, <span class="keywordtype">char</span> *interface)</div><div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;{</div><div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;   <span class="keywordtype">int</span> foundqueue = 0, penalty;</div><div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;</div><div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queuename))) {</div><div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;      foundqueue = 1;</div><div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;      <span class="keywordflow">if</span> ((mem = <a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(q, interface))) {</div><div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;         <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a> = mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Search complete&quot;</span>);</div><div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;      }</div><div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Search complete&quot;</span>);</div><div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;   }</div><div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;</div><div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;   <span class="comment">/* some useful debuging */</span></div><div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;   <span class="keywordflow">if</span> (foundqueue) {</div><div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid queuename\n&quot;</span>);</div><div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid interface\n&quot;</span>);</div><div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;   }</div><div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;</div><div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#aea87ce97f86effb2c4df6274d4aac567">RESULT_FAILURE</a>;</div><div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;}</div><div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;<span class="comment">/*! \brief Reload dynamic queue members persisted into the astdb */</span></div><div class="line"><a name="l07771"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a4a18e85dad5b206bccd39112cf9d0002"> 7771</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a4a18e85dad5b206bccd39112cf9d0002">reload_queue_members</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;{</div><div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;   <span class="keywordtype">char</span> *cur_ptr;</div><div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queue_name;</div><div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html">member</a>;</div><div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>;</div><div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>;</div><div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;   <span class="keywordtype">char</span> *penalty_tok;</div><div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a> = 0;</div><div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;   <span class="keywordtype">char</span> *paused_tok;</div><div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> = 0;</div><div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;   <span class="keywordtype">char</span> *wrapuptime_tok;</div><div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a> = 0;</div><div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>;</div><div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d1d/structast__db__entry.html">ast_db_entry</a> *db_tree;</div><div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d1d/structast__db__entry.html">ast_db_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a>;</div><div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *cur_queue;</div><div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;   <span class="keywordtype">char</span> *queue_data;</div><div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;</div><div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;   <span class="comment">/* Each key in &#39;pm_family&#39; is the name of a queue */</span></div><div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;   db_tree = <a class="code" href="../../de/d4a/astdb_8h.html#afeb9839f89da4fc24838de74739d181e">ast_db_gettree</a>(pm_family, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;   <span class="keywordflow">for</span> (entry = db_tree; entry; entry = entry-&gt;<a class="code" href="../../da/d1d/structast__db__entry.html#a3fee4a0a4bff112e0262fb8d49f41b5e">next</a>) {</div><div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;</div><div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;      queue_name = entry-&gt;<a class="code" href="../../da/d1d/structast__db__entry.html#a5892a9181e6a332f84d27aecd41dcd12">key</a> + strlen(pm_family) + 2;</div><div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;</div><div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;      {</div><div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> tmpq = {</div><div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;            .<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> = queue_name,</div><div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;         };</div><div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;         cur_queue = <a class="code" href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a>(queues, &amp;tmpq, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>, <span class="stringliteral">&quot;Reload queue members&quot;</span>);</div><div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;      }</div><div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;</div><div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;      <span class="keywordflow">if</span> (!cur_queue) {</div><div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;         cur_queue = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queue_name);</div><div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;      }</div><div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;</div><div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;      <span class="keywordflow">if</span> (!cur_queue) {</div><div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;         <span class="comment">/* If the queue no longer exists, remove it from the</span></div><div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;<span class="comment">          * database */</span></div><div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error loading persistent queue: &#39;%s&#39;: it does not exist\n&quot;</span>, queue_name);</div><div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;         <a class="code" href="../../de/d4a/astdb_8h.html#a71e8d5ab1757b184683a99125d1c8160">ast_db_del</a>(pm_family, queue_name);</div><div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;      }</div><div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;</div><div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../de/d4a/astdb_8h.html#a60488b5c3b6fd447d39d58e52172657e">ast_db_get_allocated</a>(pm_family, queue_name, &amp;queue_data)) {</div><div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(cur_queue, <span class="stringliteral">&quot;Expire reload reference&quot;</span>);</div><div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;      }</div><div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;</div><div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;      cur_ptr = queue_data;</div><div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;      <span class="keywordflow">while</span> ((member = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;cur_ptr, <span class="stringliteral">&quot;,|&quot;</span>))) {</div><div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(member)) {</div><div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;         }</div><div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;</div><div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;         <span class="keyword">interface </span>= <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;member, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;         penalty_tok = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;member, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;         paused_tok = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;member, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;         membername = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;member, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;         state_interface = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;member, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;         reason_paused = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;member, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;         wrapuptime_tok = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;member, <span class="stringliteral">&quot;;&quot;</span>);</div><div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;</div><div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;         <span class="keywordflow">if</span> (!penalty_tok) {</div><div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error parsing persistent member string for &#39;%s&#39; (penalty)\n&quot;</span>, queue_name);</div><div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;         }</div><div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;         penalty = strtol(penalty_tok, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 10);</div><div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == ERANGE) {</div><div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error converting penalty: %s: Out of range.\n&quot;</span>, penalty_tok);</div><div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;         }</div><div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;</div><div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;         <span class="keywordflow">if</span> (!paused_tok) {</div><div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error parsing persistent member string for &#39;%s&#39; (paused)\n&quot;</span>, queue_name);</div><div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;         }</div><div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;         paused = strtol(paused_tok, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 10);</div><div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;         <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == ERANGE) || paused &lt; 0 || paused &gt; 1) {</div><div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error converting paused: %s: Expected 0 or 1.\n&quot;</span>, paused_tok);</div><div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;         }</div><div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;</div><div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(wrapuptime_tok)) {</div><div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;            wrapuptime = strtol(wrapuptime_tok, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 10);</div><div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == ERANGE) {</div><div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Error converting wrapuptime: %s: Out of range.\n&quot;</span>, wrapuptime_tok);</div><div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;            }</div><div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;         }</div><div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;</div><div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Reload Members: Queue: %s  Member: %s  Name: %s  Penalty: %d  Paused: %d ReasonPause: %s  Wrapuptime: %d\n&quot;</span>,</div><div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;                       queue_name, interface, membername, penalty, paused, reason_paused, wrapuptime);</div><div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;</div><div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#ad6687a49016ace40e5834f697417268a">add_to_queue</a>(queue_name, interface, membername, penalty, paused, 0, state_interface, reason_paused, wrapuptime) == <a class="code" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a>) {</div><div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Out of Memory when reloading persistent queue member\n&quot;</span>);</div><div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;         }</div><div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;      }</div><div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(cur_queue, <span class="stringliteral">&quot;Expire reload reference&quot;</span>);</div><div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(queue_data);</div><div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;   }</div><div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;</div><div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;   <span class="keywordflow">if</span> (db_tree) {</div><div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Queue members successfully reloaded from database.\n&quot;</span>);</div><div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;      <a class="code" href="../../de/d4a/astdb_8h.html#af9ab454a70a91551b2bf6c55199fc514">ast_db_freetree</a>(db_tree);</div><div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;   }</div><div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;}</div><div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;<span class="comment">/*! \brief PauseQueueMember application */</span></div><div class="line"><a name="l07882"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a70c5fe5519fb5cbb2aa683c7a49ef04b"> 7882</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a70c5fe5519fb5cbb2aa683c7a49ef04b">pqm_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;{</div><div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(interface);</div><div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>);</div><div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(reason);</div><div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;   );</div><div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;</div><div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;PauseQueueMember requires an argument ([queuename],interface[,options][,reason])\n&quot;</span>);</div><div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;   }</div><div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;</div><div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;</div><div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;</div><div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface)) {</div><div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Missing interface argument to PauseQueueMember ([queuename],interface[,options[,reason]])\n&quot;</span>);</div><div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;   }</div><div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;</div><div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.reason, 1)) {</div><div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Attempt to pause interface %s, not found\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;PQMSTATUS&quot;</span>, <span class="stringliteral">&quot;NOTFOUND&quot;</span>);</div><div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;   }</div><div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;</div><div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;PQMSTATUS&quot;</span>, <span class="stringliteral">&quot;PAUSED&quot;</span>);</div><div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;</div><div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;}</div><div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;<span class="comment">/*! \brief UnPauseQueueMember application */</span></div><div class="line"><a name="l07918"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3f4703e2907ef0ff09af7be1332ddb5a"> 7918</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3f4703e2907ef0ff09af7be1332ddb5a">upqm_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;{</div><div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(interface);</div><div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>);</div><div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(reason);</div><div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;   );</div><div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;</div><div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;UnpauseQueueMember requires an argument ([queuename],interface[,options[,reason]])\n&quot;</span>);</div><div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;   }</div><div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;</div><div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;</div><div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;</div><div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface)) {</div><div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Missing interface argument to PauseQueueMember ([queuename],interface[,options[,reason]])\n&quot;</span>);</div><div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160;   }</div><div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;</div><div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.reason, 0)) {</div><div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Attempt to unpause interface %s, not found\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;UPQMSTATUS&quot;</span>, <span class="stringliteral">&quot;NOTFOUND&quot;</span>);</div><div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;   }</div><div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;</div><div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;UPQMSTATUS&quot;</span>, <span class="stringliteral">&quot;UNPAUSED&quot;</span>);</div><div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;</div><div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;}</div><div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;<span class="comment">/*! \brief RemoveQueueMember application */</span></div><div class="line"><a name="l07954"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a4d4a25d601ed08189ac3fa379f9f5145"> 7954</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a4d4a25d601ed08189ac3fa379f9f5145">rqm_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;{</div><div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;   <span class="keywordtype">int</span> res=-1;</div><div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>, *temppos = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;</div><div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;   );</div><div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;</div><div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;</div><div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;RemoveQueueMember requires an argument (queuename[,interface])\n&quot;</span>);</div><div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;   }</div><div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;</div><div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;</div><div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;</div><div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface)) {</div><div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;      <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;      temppos = strrchr(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <span class="charliteral">&#39;-&#39;</span>);</div><div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;      <span class="keywordflow">if</span> (temppos) {</div><div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;         *temppos = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;      }</div><div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;   }</div><div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;</div><div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;queue: %s, member: %s\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;</div><div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;   <span class="keywordflow">if</span> (log_membername_as_agent) {</div><div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;      mem = <a class="code" href="../../da/dfb/app__queue_8c.html#aa9439de0855115f7361b2ca30ce71af1">find_member_by_queuename_and_interface</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;   }</div><div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;</div><div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a2d8545a6eecf92b885f8880aaaf662d2">remove_from_queue</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface)) {</div><div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;      <span class="keywordflow">if</span> (!mem || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>)) {</div><div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;      }</div><div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Removed interface &#39;%s&#39; from queue &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;RQMSTATUS&quot;</span>, <span class="stringliteral">&quot;REMOVED&quot;</span>);</div><div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;      res = 0;</div><div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>:</div><div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Unable to remove interface &#39;%s&#39; from queue &#39;%s&#39;: Not there\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;RQMSTATUS&quot;</span>, <span class="stringliteral">&quot;NOTINQUEUE&quot;</span>);</div><div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;      res = 0;</div><div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to remove interface from queue &#39;%s&#39;: No such queue\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;RQMSTATUS&quot;</span>, <span class="stringliteral">&quot;NOSUCHQUEUE&quot;</span>);</div><div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;      res = 0;</div><div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a447a632daaf1a56114da95816c12b8a5">RES_NOT_DYNAMIC</a>:</div><div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to remove interface from queue &#39;%s&#39;: &#39;%s&#39; is not a dynamic member\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;RQMSTATUS&quot;</span>, <span class="stringliteral">&quot;NOTDYNAMIC&quot;</span>);</div><div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;      res = 0;</div><div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;   }</div><div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;</div><div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;   <span class="keywordflow">if</span> (mem) {</div><div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;   }</div><div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;</div><div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;}</div><div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;<span class="comment">/*! \brief AddQueueMember application */</span></div><div class="line"><a name="l08025"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2feb2a31bf81358e86919381547161ac"> 8025</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2feb2a31bf81358e86919381547161ac">aqm_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;{</div><div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;   <span class="keywordtype">int</span> res=-1;</div><div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>, *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>, *temppos = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>);</div><div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>);</div><div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>);</div><div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>);</div><div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;   );</div><div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a> = 0;</div><div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;</div><div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;</div><div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;AddQueueMember requires an argument (queuename[,interface[,penalty[,options[,membername[,stateinterface][,wrapuptime]]]]])\n&quot;</span>);</div><div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;   }</div><div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;</div><div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;</div><div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;</div><div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface)) {</div><div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;      <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;      temppos = strrchr(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <span class="charliteral">&#39;-&#39;</span>);</div><div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;      <span class="keywordflow">if</span> (temppos) {</div><div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;         *temppos = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;      }</div><div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;   }</div><div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;</div><div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.penalty)) {</div><div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;      <span class="keywordflow">if</span> ((sscanf(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.penalty, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;penalty) != 1) || penalty &lt; 0) {</div><div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Penalty &#39;%s&#39; is invalid, must be an integer &gt;= 0\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.penalty);</div><div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;         penalty = 0;</div><div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;      }</div><div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;   }</div><div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;</div><div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.wrapuptime)) {</div><div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;      tmp = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.wrapuptime;</div><div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(tmp);</div><div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;      wrapuptime = atoi(tmp);</div><div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;      <span class="keywordflow">if</span> (wrapuptime &lt; 0) {</div><div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;         wrapuptime = 0;</div><div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;      }</div><div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;      wrapuptime = 0;</div><div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;   }</div><div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;</div><div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#ad6687a49016ace40e5834f697417268a">add_to_queue</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.membername, penalty, 0, queue_persistent_members, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.state_interface, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, wrapuptime)) {</div><div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.membername) || !log_membername_as_agent) {</div><div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.membername, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;      }</div><div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Added interface &#39;%s&#39; to queue &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AQMSTATUS&quot;</span>, <span class="stringliteral">&quot;ADDED&quot;</span>);</div><div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;      res = 0;</div><div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>:</div><div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to add interface &#39;%s&#39; to queue &#39;%s&#39;: Already there\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AQMSTATUS&quot;</span>, <span class="stringliteral">&quot;MEMBERALREADY&quot;</span>);</div><div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;      res = 0;</div><div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to add interface to queue &#39;%s&#39;: No such queue\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AQMSTATUS&quot;</span>, <span class="stringliteral">&quot;NOSUCHQUEUE&quot;</span>);</div><div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;      res = 0;</div><div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a>:</div><div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Out of memory adding interface %s to queue %s\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;   }</div><div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;</div><div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;}</div><div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;<span class="comment">/*! \brief QueueLog application */</span></div><div class="line"><a name="l08106"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abac35567c42a41eb955ba8879bffa15d"> 8106</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#abac35567c42a41eb955ba8879bffa15d">ql_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;{</div><div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;</div><div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(uniqueid);</div><div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../df/d7d/structevent.html">event</a>);</div><div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(params);</div><div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;   );</div><div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;</div><div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;QueueLog requires arguments (queuename,uniqueid,membername,event[,additionalinfo]\n&quot;</span>);</div><div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;   }</div><div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;</div><div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;</div><div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;</div><div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.uniqueid)</div><div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;       || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.membername) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.event)) {</div><div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;QueueLog requires arguments (queuename,uniqueid,membername,event[,additionalinfo])\n&quot;</span>);</div><div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;   }</div><div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;</div><div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.uniqueid, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.membername, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.event,</div><div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.params ? <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.params : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;</div><div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;}</div><div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;<span class="comment">/*! \brief Copy rule from global list into specified queue */</span></div><div class="line"><a name="l08140"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5a980ba36a8d002f369930cbf8a9b595"> 8140</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a5a980ba36a8d002f369930cbf8a9b595">copy_rules</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe, <span class="keyword">const</span> <span class="keywordtype">char</span> *rulename)</div><div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;{</div><div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *pr_iter;</div><div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> *rl_iter;</div><div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(rulename) ? qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a48bf0904a10400913c3e04f898028f20">defaultrule</a> : rulename;</div><div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, rl_iter, <a class="code" href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">list</a>) {</div><div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, tmp)) {</div><div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;      }</div><div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;   }</div><div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;   <span class="keywordflow">if</span> (rl_iter) {</div><div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, pr_iter, <a class="code" href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">list</a>) {</div><div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *new_pr = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*new_pr));</div><div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;         <span class="keywordflow">if</span> (!new_pr) {</div><div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Memory allocation error when copying penalty rules! Aborting!\n&quot;</span>);</div><div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;         }</div><div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;         new_pr-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a> = pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>;</div><div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160;         new_pr-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a> = pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a>;</div><div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;         new_pr-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a> = pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a>;</div><div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160;         new_pr-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a> = pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a>;</div><div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;         new_pr-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> = pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a>;</div><div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;         new_pr-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a> = pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a>;</div><div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;         new_pr-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> = pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a>;</div><div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ae75d4fd9822187bfe2bfe55a75b7c6ef">qe_rules</a>, new_pr, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>);</div><div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;      }</div><div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;   }</div><div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;}</div><div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;<span class="comment">/*!\brief The starting point for all queue calls</span></div><div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;<span class="comment"> * The process involved here is to</span></div><div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;<span class="comment"> * 1. Parse the options specified in the call to Queue()</span></div><div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;<span class="comment"> * 2. Join the queue</span></div><div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;<span class="comment"> * 3. Wait in a loop until it is our turn to try calling a queue member</span></div><div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;<span class="comment"> * 4. Attempt to call a queue member</span></div><div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;<span class="comment"> * 5. If 4. did not result in a bridged call, then check for between</span></div><div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;<span class="comment"> *    call options such as periodic announcements etc.</span></div><div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;<span class="comment"> * 6. Try 4 again unless some condition (such as an expiration time) causes us to</span></div><div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;<span class="comment"> *    exit the queue.</span></div><div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08183"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa4019656b705c76e4475a9e8fc0c4116"> 8183</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa4019656b705c76e4475a9e8fc0c4116">queue_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;{</div><div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;   <span class="keywordtype">int</span> res=-1;</div><div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/d9b/bridge__basic_8c.html#a6ab6e51f783d7cea98857990908996d3">ringing</a>=0;</div><div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *user_priority;</div><div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *max_penalty_str;</div><div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *min_penalty_str;</div><div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *raise_penalty_str;</div><div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;   <span class="keywordtype">int</span> prio;</div><div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;   <span class="keywordtype">int</span> qcontinue = 0;</div><div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;   <span class="keywordtype">int</span> max_penalty, min_penalty, raise_penalty;</div><div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2">queue_result</a> reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c">QUEUE_UNKNOWN</a>;</div><div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;   <span class="comment">/* whether to exit Queue application after the timeout hits */</span></div><div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;   <span class="keywordtype">int</span> tries = 0;</div><div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;   <span class="keywordtype">int</span> noption = 0;</div><div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;   <span class="keywordtype">int</span> makeannouncement = 0;</div><div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;   <span class="keywordtype">int</span> position = 0;</div><div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>);</div><div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../dc/d12/res__config__ldap_8c.html#a75e4590043edf35241d30fabe2eda546">url</a>);</div><div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(announceoverride);</div><div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuetimeoutstr);</div><div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(agi);</div><div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(macro);</div><div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(gosub);</div><div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d3/d61/structrule.html">rule</a>);</div><div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(position);</div><div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;   );</div><div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;   <span class="comment">/* Our queue entry */</span></div><div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> qe = { 0 };</div><div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> opts = { 0, };</div><div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;   <span class="keywordtype">char</span> *opt_args[<a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493aec7326f60e7edad15d96ff935e5616d6">OPT_ARG_ARRAY_SIZE</a>];</div><div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d3/d68/structmax__forwards.html">max_forwards</a>;</div><div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;</div><div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Queue requires an argument: queuename[,options[,URL[,announceoverride[,timeout[,agi[,macro[,gosub[,rule[,position]]]]]]]]]\n&quot;</span>);</div><div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;   }</div><div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;</div><div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;   max_forwards = <a class="code" href="../../d3/d93/max__forwards_8h.html#a6a88ae3674510012e1c04f8501ea1ad1">ast_max_forwards_get</a>(chan);</div><div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;</div><div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;   <span class="keywordflow">if</span> (max_forwards &lt;= 0) {</div><div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Channel &#39;%s&#39; cannot enter queue. Max forwards exceeded\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;   }</div><div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;</div><div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;</div><div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;queue: %s, options: %s, url: %s, announce: %s, timeout: %s, agi: %s, macro: %s, gosub: %s, rule: %s, position: %s\n&quot;</span>,</div><div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;      <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename,</div><div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.options, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.url, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.announceoverride, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuetimeoutstr, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agi, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.macro, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.gosub, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.rule, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.position, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;</div><div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.options)) {</div><div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb">ast_app_parse_options</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a8e71a98f661c0f497104849cd61261ae">queue_exec_options</a>, &amp;opts, opt_args, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.options);</div><div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;   }</div><div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160;</div><div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;   <span class="comment">/* Setup our queue entry */</span></div><div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a> = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;</div><div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;ABANDONED&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;</div><div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;   <span class="comment">/* set the expire time based on the supplied timeout; */</span></div><div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuetimeoutstr)) {</div><div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;      qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> = qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a> + atoi(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuetimeoutstr);</div><div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;      qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> = 0;</div><div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;   }</div><div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;</div><div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;   <span class="comment">/* Get the priority from the variable ${QUEUE_PRIO} */</span></div><div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;   user_priority = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;QUEUE_PRIO&quot;</span>);</div><div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;   <span class="keywordflow">if</span> (user_priority) {</div><div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;      <span class="keywordflow">if</span> (sscanf(user_priority, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;prio) == 1) {</div><div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: Got priority %d from ${QUEUE_PRIO}.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), prio);</div><div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;${QUEUE_PRIO}: Invalid value (%s), channel %s.\n&quot;</span>,</div><div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;            user_priority, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;         prio = 0;</div><div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;      }</div><div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;NO QUEUE_PRIO variable found. Using default.\n&quot;</span>);</div><div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;      prio = 0;</div><div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;   }</div><div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;</div><div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160;   <span class="comment">/* Get the maximum penalty from the variable ${QUEUE_MAX_PENALTY} */</span></div><div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;</div><div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;   <span class="keywordflow">if</span> ((max_penalty_str = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;QUEUE_MAX_PENALTY&quot;</span>))) {</div><div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;      <span class="keywordflow">if</span> (sscanf(max_penalty_str, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;max_penalty) == 1) {</div><div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: Got max penalty %d from ${QUEUE_MAX_PENALTY}.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), max_penalty);</div><div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;${QUEUE_MAX_PENALTY}: Invalid value (%s), channel %s.\n&quot;</span>,</div><div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;            max_penalty_str, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;         max_penalty = INT_MAX;</div><div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;      }</div><div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;      max_penalty = INT_MAX;</div><div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;   }</div><div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;</div><div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160;   <span class="keywordflow">if</span> ((min_penalty_str = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;QUEUE_MIN_PENALTY&quot;</span>))) {</div><div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;      <span class="keywordflow">if</span> (sscanf(min_penalty_str, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;min_penalty) == 1) {</div><div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: Got min penalty %d from ${QUEUE_MIN_PENALTY}.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), min_penalty);</div><div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;${QUEUE_MIN_PENALTY}: Invalid value (%s), channel %s.\n&quot;</span>,</div><div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;            min_penalty_str, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;         min_penalty = INT_MAX;</div><div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;      }</div><div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;      min_penalty = INT_MAX;</div><div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;   }</div><div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;</div><div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;   <span class="keywordflow">if</span> ((raise_penalty_str = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;QUEUE_RAISE_PENALTY&quot;</span>))) {</div><div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160;      <span class="keywordflow">if</span> (sscanf(raise_penalty_str, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;raise_penalty) == 1) {</div><div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: Got raise penalty %d from ${QUEUE_RAISE_PENALTY}.\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), raise_penalty);</div><div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;${QUEUE_RAISE_PENALTY}: Invalid value (%s), channel %s.\n&quot;</span>,</div><div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;            raise_penalty_str, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;         raise_penalty = INT_MAX;</div><div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160;      }</div><div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;      raise_penalty = INT_MAX;</div><div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;   }</div><div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;</div><div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ad4edc18ee0c5ce6e2af1ed26a64f39ad">OPT_RINGING</a>)) {</div><div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;      ringing = 1;</div><div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;   }</div><div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;</div><div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;   <span class="keywordflow">if</span> (ringing != 1 &amp;&amp; <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae363b1e6b1f2fcb5536719a640aa9dd9">OPT_RING_WHEN_RINGING</a>)) {</div><div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;      qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a93d5d1c5d8bf62627163cd9e53ed5048">ring_when_ringing</a> = 1;</div><div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;   }</div><div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;</div><div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a5745afa61052d9e54f177910f53da159">OPT_GO_ON</a>)) {</div><div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;      qcontinue = 1;</div><div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;   }</div><div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;</div><div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.position) {</div><div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;      position = atoi(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.position);</div><div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;      <span class="keywordflow">if</span> (position &lt; 0) {</div><div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid position &#39;%s&#39; given for call to queue &#39;%s&#39;. Assuming no preference for position\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.position, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;         position = 0;</div><div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;      }</div><div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;   }</div><div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;</div><div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;queue: %s, expires: %ld, priority: %d\n&quot;</span>,</div><div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;      <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, (<span class="keywordtype">long</span>)qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>, prio);</div><div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;</div><div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = chan;</div><div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a> = prio;</div><div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a> = max_penalty;</div><div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a> = min_penalty;</div><div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a> = raise_penalty;</div><div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ac019537a959f6147cecffb126bb04381">last_pos_said</a> = 0;</div><div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6">last_pos</a> = 0;</div><div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a26f62e545090b51f4c7e8efbf2db8d6b">last_periodic_announce_time</a> = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">last_periodic_announce_sound</a> = 0;</div><div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a12851de4518c71edbf5c5adb40976629">valid_digits</a> = 0;</div><div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#aa4bb418a30af8cf4e1be6aa3fea01016">join_queue</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, &amp;qe, &amp;reason, position)) {</div><div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to join queue &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a30fd2efd3517fe2537656bdd18a09c6f">set_queue_result</a>(chan, reason);</div><div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;   }</div><div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;</div><div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;ENTERQUEUE&quot;</span>, <span class="stringliteral">&quot;%s|%s|%d&quot;</span>,</div><div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.url, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(chan)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(chan)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;      qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>);</div><div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;</div><div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;   <span class="comment">/* PREDIAL: Preprocess any callee gosub arguments. */</span></div><div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae014616d0271c5671a6d8c24c46dc6b2">OPT_PREDIAL_CALLEE</a>)</div><div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;      &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(opt_args[<a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a2896cd262bf3d0d9dc2c33f3e5a48ac0">OPT_ARG_PREDIAL_CALLEE</a>])) {</div><div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ae01ad140af5f1041395f4355ed0f4d60">ast_replace_subargument_delimiter</a>(opt_args[OPT_ARG_PREDIAL_CALLEE]);</div><div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;      qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">predial_callee</a> = opt_args[<a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a2896cd262bf3d0d9dc2c33f3e5a48ac0">OPT_ARG_PREDIAL_CALLEE</a>];</div><div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;   }</div><div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160;</div><div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;   <span class="comment">/* PREDIAL: Run gosub on the caller&#39;s channel */</span></div><div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a54b4e68636084106abe671c5dcb10b22">OPT_PREDIAL_CALLER</a>)</div><div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;      &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(opt_args[<a class="code" href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493ae98734a2a20c3c7367ba5d8835378f60">OPT_ARG_PREDIAL_CALLER</a>])) {</div><div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ae01ad140af5f1041395f4355ed0f4d60">ast_replace_subargument_delimiter</a>(opt_args[OPT_ARG_PREDIAL_CALLER]);</div><div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aee5e20694b04eee43463fde6cf121d06">ast_app_exec_sub</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, chan, opt_args[OPT_ARG_PREDIAL_CALLER], 0);</div><div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;   }</div><div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;</div><div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a5a980ba36a8d002f369930cbf8a9b595">copy_rules</a>(&amp;qe, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.rule);</div><div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a> = <a class="code" href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a>(&amp;qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae75d4fd9822187bfe2bfe55a75b7c6ef">qe_rules</a>);</div><div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;check_turns:</div><div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;   <span class="keywordflow">if</span> (ringing) {</div><div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(chan, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);</div><div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;      <a class="code" href="../../dc/d07/musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7">ast_moh_start</a>(chan, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542">moh</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;   }</div><div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;</div><div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;   <span class="comment">/* This is the wait loop for callers 2 through maxlen */</span></div><div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;   res = <a class="code" href="../../da/dfb/app__queue_8c.html#a54d8f5c6ba5bd46020c7c319fa5a89c2">wait_our_turn</a>(&amp;qe, ringing, &amp;reason);</div><div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../df/d44/app__meetme_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>;</div><div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;   }</div><div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;</div><div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;   makeannouncement = qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a34c5860043ef96a75828b7107fcffb17">announce_to_first_user</a>;</div><div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;</div><div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;      <span class="comment">/* This is the wait loop for the head caller*/</span></div><div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;      <span class="comment">/* To exit, they may get their call answered; */</span></div><div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;      <span class="comment">/* they may dial a digit from the queue context; */</span></div><div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;      <span class="comment">/* or, they may timeout. */</span></div><div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;</div><div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;      <span class="comment">/* Leave if we have exceeded our queuetimeout */</span></div><div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;      <span class="keywordflow">if</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(&amp;qe);</div><div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;         reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;         res = 0;</div><div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan),<span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;EXITWITHTIMEOUT&quot;</span>, <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>,</div><div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;            qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;      }</div><div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;</div><div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;      <span class="keywordflow">if</span> (makeannouncement) {</div><div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;         <span class="comment">/* Make a position announcement, if enabled */</span></div><div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;         <span class="keywordflow">if</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb">announcefrequency</a>) {</div><div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;            <span class="keywordflow">if</span> ((res = <a class="code" href="../../da/dfb/app__queue_8c.html#ad395c86c08af4a1c22518966e9ead32f">say_position</a>(&amp;qe, ringing))) {</div><div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;               <span class="keywordflow">goto</span> <a class="code" href="../../df/d44/app__meetme_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>;</div><div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;            }</div><div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;         }</div><div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;      }</div><div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;      makeannouncement = 1;</div><div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;</div><div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;      <span class="comment">/* Make a periodic announcement, if enabled */</span></div><div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;      <span class="keywordflow">if</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132">periodicannouncefrequency</a>) {</div><div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160;         <span class="keywordflow">if</span> ((res = <a class="code" href="../../da/dfb/app__queue_8c.html#a3d3fbc78100b994e44f9f270af21c451">say_periodic_announcement</a>(&amp;qe, ringing))) {</div><div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;            <span class="keywordflow">goto</span> <a class="code" href="../../df/d44/app__meetme_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>;</div><div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;         }</div><div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;      }</div><div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;</div><div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;      <span class="comment">/* Leave if we have exceeded our queuetimeout */</span></div><div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;      <span class="keywordflow">if</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(&amp;qe);</div><div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;         reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;         res = 0;</div><div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;EXITWITHTIMEOUT&quot;</span>,</div><div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;            <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;      }</div><div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;</div><div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;      <span class="comment">/* see if we need to move to the next penalty level for this queue */</span></div><div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;      <span class="keywordflow">while</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a> &amp;&amp; ((time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) &gt; qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">pr</a>-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>)) {</div><div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#aa1efb798e09a88e68559b08c90c573ee">update_qe_rule</a>(&amp;qe);</div><div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;      }</div><div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;</div><div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;      <span class="comment">/* Try calling all queue members for &#39;timeout&#39; seconds */</span></div><div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;      res = <a class="code" href="../../da/dfb/app__queue_8c.html#ac66c7e437e2829c88f56aad3cc7cf508">try_calling</a>(&amp;qe, opts, opt_args, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.announceoverride, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.url, &amp;tries, &amp;noption, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agi, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.macro, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.gosub, ringing);</div><div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../df/d44/app__meetme_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>;</div><div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;      }</div><div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;</div><div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;      <span class="keywordflow">if</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016">leavewhenempty</a>) {</div><div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = 0;</div><div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;         <span class="keywordflow">if</span> ((status = <a class="code" href="../../da/dfb/app__queue_8c.html#a2cfafe91008492ba14ad4a0f8e11ea63">get_member_status</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">max_penalty</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">min_penalty</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">raise_penalty</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016">leavewhenempty</a>, 0))) {</div><div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(&amp;qe);</div><div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;            reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101">QUEUE_LEAVEEMPTY</a>;</div><div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;EXITEMPTY&quot;</span>, <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>)(time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;            res = 0;</div><div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;         }</div><div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;      }</div><div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;</div><div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;      <span class="comment">/* exit after &#39;timeout&#39; cycle if &#39;n&#39; option enabled */</span></div><div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;      <span class="keywordflow">if</span> (noption &amp;&amp; tries &gt;= <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>)) {</div><div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Exiting on time-out cycle\n&quot;</span>);</div><div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;EXITWITHTIMEOUT&quot;</span>,</div><div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;            <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(&amp;qe);</div><div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;         reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;         res = 0;</div><div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;      }</div><div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;</div><div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;</div><div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;      <span class="comment">/* Leave if we have exceeded our queuetimeout */</span></div><div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;      <span class="keywordflow">if</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a> &amp;&amp; (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &gt;= qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">expire</a>)) {</div><div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(&amp;qe);</div><div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;         reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a>;</div><div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;         res = 0;</div><div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),<span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;EXITWITHTIMEOUT&quot;</span>, <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;      }</div><div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;</div><div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;      <span class="comment">/* OK, we didn&#39;t get anybody; wait for &#39;retry&#39; seconds; may get a digit to exit with */</span></div><div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;      res = <a class="code" href="../../da/dfb/app__queue_8c.html#ae2c06dcaa81d44b2782bb33be68c4858">wait_a_bit</a>(&amp;qe);</div><div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../df/d44/app__meetme_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>;</div><div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;      }</div><div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;</div><div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;      <span class="comment">/* If using dynamic realtime members, we should regenerate the member list for this queue */</span></div><div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad4d94a7a9e04ddf7984d69a8737221f9">update_realtime_members</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;</div><div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;      <span class="comment">/* Since this is a priority queue and</span></div><div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;<span class="comment">       * it is not sure that we are still at the head</span></div><div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;<span class="comment">       * of the queue, go and check for our turn again.</span></div><div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a09df986cff00524f91c16051486231ec">is_our_turn</a>(&amp;qe)) {</div><div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Darn priorities, going back in queue (%s)!\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;         <span class="keywordflow">goto</span> check_turns;</div><div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;      }</div><div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;   }</div><div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;</div><div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;<a class="code" href="../../df/d44/app__meetme_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a>:</div><div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;      <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;         <span class="keywordflow">if</span> (!qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ab234be20f2e48f4f08d2d2c071b8ff55">handled</a>) {</div><div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a>(&amp;qe);</div><div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;ABANDON&quot;</span>,</div><div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;               <span class="stringliteral">&quot;%d|%d|%ld&quot;</span>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>,</div><div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;               (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;            res = -1;</div><div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (reason == <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101">QUEUE_LEAVEEMPTY</a>) {</div><div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;            <span class="comment">/* Return back to dialplan, don&#39;t hang up */</span></div><div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;            res = 0;</div><div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qcontinue) {</div><div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;            reason = <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a7d363853794316b276622be186ead6f0">QUEUE_CONTINUE</a>;</div><div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;            res = 0;</div><div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;         }</div><div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a12851de4518c71edbf5c5adb40976629">valid_digits</a>) {</div><div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan), <span class="stringliteral">&quot;NONE&quot;</span>, <span class="stringliteral">&quot;EXITWITHKEY&quot;</span>,</div><div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;            <span class="stringliteral">&quot;%s|%d|%d|%ld&quot;</span>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">digits</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">opos</a>, (<span class="keywordtype">long</span>) (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>));</div><div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;      }</div><div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;   }</div><div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160;</div><div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;   <span class="comment">/* Don&#39;t allow return code &gt; 0 */</span></div><div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;   <span class="keywordflow">if</span> (res &gt;= 0) {</div><div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;      res = 0;</div><div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;      <span class="keywordflow">if</span> (ringing) {</div><div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(chan, -1);</div><div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;         <a class="code" href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a>(chan);</div><div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;      }</div><div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;      <a class="code" href="../../d2/d4d/file_8h.html#a3092bf11d4bba66f646562759608b1bc">ast_stopstream</a>(chan);</div><div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;   }</div><div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;</div><div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138">set_queue_variables</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>, qe.<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;</div><div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a3135d5c6b468bef49c1e3fc5d7394f30">leave_queue</a>(&amp;qe);</div><div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;   <span class="keywordflow">if</span> (reason != <a class="code" href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c">QUEUE_UNKNOWN</a>)</div><div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a30fd2efd3517fe2537656bdd18a09c6f">set_queue_result</a>(chan, reason);</div><div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;</div><div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;<span class="comment">    * every queue_ent is given a reference to it&#39;s parent</span></div><div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;<span class="comment">    * call_queue when it joins the queue.  This ref must be taken</span></div><div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;<span class="comment">    * away right before the queue_ent is destroyed.  In this case</span></div><div class="line"><a name="l08543"></a><span class="lineno"> 8543</span>&#160;<span class="comment">    * the queue_ent is about to be returned on the stack</span></div><div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;   qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab">queue_unref</a>(qe.<a class="code" href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">parent</a>);</div><div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;</div><div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;}</div><div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;<span class="comment"> * \brief create interface var with all queue details.</span></div><div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;<span class="comment"> * \retval -1 on error</span></div><div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l08555"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a7b254b14693f1f30d4ddd615d7f777b9"> 8555</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a7b254b14693f1f30d4ddd615d7f777b9">queue_function_var</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;{</div><div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;   <span class="keywordtype">char</span> interfacevar[256] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;   <span class="keywordtype">float</span> sl = 0;</div><div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;</div><div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s requires an argument: queuename\n&quot;</span>, cmd);</div><div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;   }</div><div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;</div><div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(data))) {</div><div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a32794c302b9a60821d519f6d4d1e7885">setqueuevar</a>) {</div><div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;         sl = 0;</div><div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;         res = 0;</div><div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;</div><div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;         <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> &gt; 0) {</div><div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;            sl = 100 * ((float) q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a> / (<span class="keywordtype">float</span>) q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>);</div><div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;         }</div><div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;</div><div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160;         snprintf(interfacevar, <span class="keyword">sizeof</span>(interfacevar),</div><div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;            <span class="stringliteral">&quot;QUEUEMAX=%d,QUEUESTRATEGY=%s,QUEUECALLS=%d,QUEUEHOLDTIME=%d,QUEUETALKTIME=%d,QUEUECOMPLETED=%d,QUEUEABANDONED=%d,QUEUESRVLEVEL=%d,QUEUESRVLEVELPERF=%2.1f&quot;</span>,</div><div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a792b5d8a5231db2f05b08bd73d318ea5">int2strat</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>), q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>,  q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>, sl);</div><div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;</div><div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a7527f4b7b64622b458a3999ba51af07e">pbx_builtin_setvar_multiple</a>(chan, interfacevar);</div><div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;      }</div><div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;</div><div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with QUEUE() function&quot;</span>);</div><div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;queue %s was not found\n&quot;</span>, data);</div><div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;   }</div><div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;</div><div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;   snprintf(buf, len, <span class="stringliteral">&quot;%d&quot;</span>, res);</div><div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;</div><div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;}</div><div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;<span class="comment"> * \brief Check if a given queue exists</span></div><div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08599"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a331ac4441ab3808ba988804d9d0c9a29"> 8599</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a331ac4441ab3808ba988804d9d0c9a29">queue_function_exists</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;{</div><div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;</div><div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;</div><div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s requires an argument: queuename\n&quot;</span>, cmd);</div><div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;   }</div><div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;   q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(data);</div><div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;   snprintf(buf, len, <span class="stringliteral">&quot;%d&quot;</span>, q != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>? 1 : 0);</div><div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;   <span class="keywordflow">if</span> (q) {</div><div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with temporary reference in QUEUE_EXISTS()&quot;</span>);</div><div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;   }</div><div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;</div><div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;}</div><div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;</div><div class="line"><a name="l08618"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab48d01c852ebb7b07f572e4b20a1abb3"> 8618</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#ab48d01c852ebb7b07f572e4b20a1abb3">get_interface_helper</a>(<span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>)</div><div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;{</div><div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;</div><div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(interface)) {</div><div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;QUEUE_MEMBER: Missing required interface argument.\n&quot;</span>);</div><div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;   }</div><div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;</div><div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;   m = <a class="code" href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a>(q, interface);</div><div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;   <span class="keywordflow">if</span> (!m) {</div><div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Queue member interface &#39;%s&#39; not in queue &#39;%s&#39;.\n&quot;</span>,</div><div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;         interface, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;   }</div><div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;   <span class="keywordflow">return</span> m;</div><div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;}</div><div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;<span class="comment"> * \brief Get number either busy / free / ready or total members of a specific queue</span></div><div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;<span class="comment"> * \brief Get or set member properties penalty / paused / ringinuse</span></div><div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;<span class="comment"> * \retval number of members (busy / free / ready / total) or member info (penalty / paused / ringinuse)</span></div><div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;<span class="comment"> * \retval -1 on error</span></div><div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08641"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a0b3abb2f63fd6e5269cbb96f801b35a7"> 8641</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a0b3abb2f63fd6e5269cbb96f801b35a7">queue_function_mem_read</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;{</div><div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;   <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;</div><div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(option);</div><div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(interface);</div><div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;   );</div><div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;   <span class="comment">/* Make sure the returned value on error is zero length string. */</span></div><div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;</div><div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;         <span class="stringliteral">&quot;Missing required argument. %s(&lt;queuename&gt;,&lt;option&gt;[,&lt;interface&gt;])\n&quot;</span>,</div><div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;         cmd);</div><div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;   }</div><div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;</div><div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, data);</div><div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;</div><div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option)) {</div><div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;         <span class="stringliteral">&quot;Missing required argument. %s(&lt;queuename&gt;,&lt;option&gt;[,&lt;interface&gt;])\n&quot;</span>,</div><div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;         cmd);</div><div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;   }</div><div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;</div><div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename))) {</div><div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;logged&quot;</span>)) {</div><div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;         mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;         <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;            <span class="comment">/* Count the agents who are logged in and presently answering calls */</span></div><div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;            <span class="keywordflow">if</span> ((m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>) &amp;&amp; (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a>)) {</div><div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160;               count++;</div><div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;            }</div><div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;         }</div><div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;free&quot;</span>)) {</div><div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;         mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;         <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;            <span class="comment">/* Count the agents who are logged in and presently answering calls */</span></div><div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;            <span class="keywordflow">if</span> ((m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>) &amp;&amp; (!m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>)) {</div><div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;               count++;</div><div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160;            }</div><div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160;         }</div><div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;ready&quot;</span>)) {</div><div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;         time_t now;</div><div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160;         time(&amp;now);</div><div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;         mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;         <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;            <span class="comment">/* Count the agents who are logged in, not paused and not wrapping up */</span></div><div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;            <span class="keywordflow">if</span> ((m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>) &amp;&amp; (!m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>) &amp;&amp;</div><div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;                  !(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a> &amp;&amp; <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(q, m) &amp;&amp; ((now - <a class="code" href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a>(q, m)) &lt; m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>))) {</div><div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160;               count++;</div><div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;            }</div><div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;         }</div><div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;count&quot;</span>)) {</div><div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;         count = <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;penalty&quot;</span>)) {</div><div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;         m = <a class="code" href="../../da/dfb/app__queue_8c.html#ab48d01c852ebb7b07f572e4b20a1abb3">get_interface_helper</a>(q, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;         <span class="keywordflow">if</span> (m) {</div><div class="line"><a name="l08712"></a><span class="lineno"> 8712</span>&#160;            count = m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160;         }</div><div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;paused&quot;</span>)) {</div><div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;         m = <a class="code" href="../../da/dfb/app__queue_8c.html#ab48d01c852ebb7b07f572e4b20a1abb3">get_interface_helper</a>(q, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;         <span class="keywordflow">if</span> (m) {</div><div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;            count = m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>;</div><div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;         }</div><div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;ignorebusy&quot;</span>) <span class="comment">/* ignorebusy is legacy */</span></div><div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;         || !strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;ringinuse&quot;</span>))) {</div><div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;         m = <a class="code" href="../../da/dfb/app__queue_8c.html#ab48d01c852ebb7b07f572e4b20a1abb3">get_interface_helper</a>(q, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;         <span class="keywordflow">if</span> (m) {</div><div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;            count = m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;         }</div><div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Invalid option &#39;%s&#39; provided.\n&quot;</span>, cmd, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option);</div><div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;      }</div><div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with temporary reference in QUEUE_MEMBER()&quot;</span>);</div><div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;queue %s was not found\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;   }</div><div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;</div><div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;   snprintf(buf, len, <span class="stringliteral">&quot;%d&quot;</span>, count);</div><div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160;</div><div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;}</div><div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08742"></a><span class="lineno"> 8742</span>&#160;<span class="comment">/*! \brief Dialplan function QUEUE_MEMBER() Sets the members penalty / paused / ringinuse. */</span></div><div class="line"><a name="l08743"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae72cf4b6314dca87511064e3d257ab1e"> 8743</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae72cf4b6314dca87511064e3d257ab1e">queue_function_mem_write</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>)</div><div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;{</div><div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;   <span class="keywordtype">int</span> memvalue;</div><div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160;</div><div class="line"><a name="l08747"></a><span class="lineno"> 8747</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(option);</div><div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(interface);</div><div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;   );</div><div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;</div><div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;         <span class="stringliteral">&quot;Missing required argument. %s([&lt;queuename&gt;],&lt;option&gt;,&lt;interface&gt;)\n&quot;</span>,</div><div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;         cmd);</div><div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;   }</div><div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;</div><div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, data);</div><div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;</div><div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option)</div><div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;      || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface)) {</div><div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;         <span class="stringliteral">&quot;Missing required argument. %s([&lt;queuename&gt;],&lt;option&gt;,&lt;interface&gt;)\n&quot;</span>,</div><div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160;         cmd);</div><div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160;   }</div><div class="line"><a name="l08769"></a><span class="lineno"> 8769</span>&#160;</div><div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;<span class="comment">    * If queuename is empty then the option will be</span></div><div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;<span class="comment">    * set for the interface in all queues.</span></div><div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l08774"></a><span class="lineno"> 8774</span>&#160;</div><div class="line"><a name="l08775"></a><span class="lineno"> 8775</span>&#160;   memvalue = atoi(value);</div><div class="line"><a name="l08776"></a><span class="lineno"> 8776</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;penalty&quot;</span>)) {</div><div class="line"><a name="l08777"></a><span class="lineno"> 8777</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a>, memvalue)) {</div><div class="line"><a name="l08778"></a><span class="lineno"> 8778</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid interface, queue, or penalty\n&quot;</span>);</div><div class="line"><a name="l08779"></a><span class="lineno"> 8779</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08780"></a><span class="lineno"> 8780</span>&#160;      }</div><div class="line"><a name="l08781"></a><span class="lineno"> 8781</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;paused&quot;</span>)) {</div><div class="line"><a name="l08782"></a><span class="lineno"> 8782</span>&#160;      memvalue = (memvalue &lt;= 0) ? 0 : 1;</div><div class="line"><a name="l08783"></a><span class="lineno"> 8783</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, memvalue)) {</div><div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid interface or queue\n&quot;</span>);</div><div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08786"></a><span class="lineno"> 8786</span>&#160;      }</div><div class="line"><a name="l08787"></a><span class="lineno"> 8787</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;ignorebusy&quot;</span>) <span class="comment">/* ignorebusy is legacy */</span></div><div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;      || !strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option, <span class="stringliteral">&quot;ringinuse&quot;</span>)) {</div><div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160;      memvalue = (memvalue &lt;= 0) ? 0 : 1;</div><div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b">MEMBER_RINGINUSE</a>, memvalue)) {</div><div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid interface or queue\n&quot;</span>);</div><div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08793"></a><span class="lineno"> 8793</span>&#160;      }</div><div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Invalid option &#39;%s&#39; provided.\n&quot;</span>, cmd, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.option);</div><div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160;   }</div><div class="line"><a name="l08798"></a><span class="lineno"> 8798</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08799"></a><span class="lineno"> 8799</span>&#160;}</div><div class="line"><a name="l08800"></a><span class="lineno"> 8800</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08801"></a><span class="lineno"> 8801</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l08802"></a><span class="lineno"> 8802</span>&#160;<span class="comment"> * \brief Get the total number of members in a specific queue (Deprecated)</span></div><div class="line"><a name="l08803"></a><span class="lineno"> 8803</span>&#160;<span class="comment"> * \retval number of members</span></div><div class="line"><a name="l08804"></a><span class="lineno"> 8804</span>&#160;<span class="comment"> * \retval -1 on error</span></div><div class="line"><a name="l08805"></a><span class="lineno"> 8805</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l08806"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa08d109f431a880fd7c401d6f2e58d25"> 8806</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aa08d109f431a880fd7c401d6f2e58d25">queue_function_qac_dep</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08807"></a><span class="lineno"> 8807</span>&#160;{</div><div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> = 0;</div><div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l08810"></a><span class="lineno"> 8810</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;   <span class="keyword">static</span> <span class="keywordtype">int</span> depflag = 1;</div><div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;</div><div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;   <span class="keywordflow">if</span> (depflag) {</div><div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;      depflag = 0;</div><div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;The function QUEUE_MEMBER_COUNT has been deprecated in favor of the QUEUE_MEMBER function and will not be in further releases.\n&quot;</span>);</div><div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160;   }</div><div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;</div><div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s requires an argument: queuename\n&quot;</span>, cmd);</div><div class="line"><a name="l08821"></a><span class="lineno"> 8821</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;   }</div><div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;</div><div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(data))) {</div><div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;      mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;      <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;         <span class="comment">/* Count the agents who are logged in and presently answering calls */</span></div><div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;         <span class="keywordflow">if</span> ((m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>) &amp;&amp; (m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a>)) {</div><div class="line"><a name="l08830"></a><span class="lineno"> 8830</span>&#160;            count++;</div><div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;         }</div><div class="line"><a name="l08832"></a><span class="lineno"> 8832</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08833"></a><span class="lineno"> 8833</span>&#160;      }</div><div class="line"><a name="l08834"></a><span class="lineno"> 8834</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l08835"></a><span class="lineno"> 8835</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l08836"></a><span class="lineno"> 8836</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with temporary reference in QUEUE_MEMBER_COUNT&quot;</span>);</div><div class="line"><a name="l08837"></a><span class="lineno"> 8837</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;queue %s was not found\n&quot;</span>, data);</div><div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;   }</div><div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;</div><div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;   snprintf(buf, len, <span class="stringliteral">&quot;%d&quot;</span>, count);</div><div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;</div><div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;}</div><div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;<span class="comment">/*! \brief Dialplan function QUEUE_GET_CHANNEL() Get caller channel waiting at specified position in the queue */</span></div><div class="line"><a name="l08847"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aeefd277e923719dc1671a0bc0eb3c2ed"> 8847</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aeefd277e923719dc1671a0bc0eb3c2ed">queue_function_queuegetchannel</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;{</div><div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;   <span class="keywordtype">int</span> position;</div><div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;</div><div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(position);</div><div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160;   );</div><div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;</div><div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;</div><div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Missing argument. QUEUE_GET_CHANNEL(&lt;queuename&gt;,&lt;position&gt;)\n&quot;</span>);</div><div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;   }</div><div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;</div><div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;</div><div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename)) {</div><div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;The &lt;queuename&gt; parameter is required.\n&quot;</span>);</div><div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160;   }</div><div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;</div><div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.position)) {</div><div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;      position = 1;</div><div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;      <span class="keywordflow">if</span> (sscanf(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.position, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;position) != 1) {</div><div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;&lt;position&gt; parameter must be an integer.\n&quot;</span>);</div><div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;      }</div><div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;      <span class="keywordflow">if</span> (position &lt; 1) {</div><div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;&lt;position&gt; parameter must be an integer greater than zero.\n&quot;</span>);</div><div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;      }</div><div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160;   }</div><div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;</div><div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;   {</div><div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> tmpq = {</div><div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;         .<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename,</div><div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;      };</div><div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;</div><div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;      q = <a class="code" href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a>(queues, &amp;tmpq, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>, <span class="stringliteral">&quot;Find for QUEUE_GET_CHANNEL()&quot;</span>);</div><div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;   }</div><div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;   <span class="keywordflow">if</span> (q) {</div><div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> &gt;= position) {</div><div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe;</div><div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;</div><div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;         <span class="keywordflow">for</span> (qe = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>; qe; qe = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>) {</div><div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;            <span class="keywordflow">if</span> (qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> == position) {</div><div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), len);</div><div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;            }</div><div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;         }</div><div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;      }</div><div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with reference in QUEUE_GET_CHANNEL()&quot;</span>);</div><div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;   }</div><div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;</div><div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;   var = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1a03993603e2bc2463153857836645bb">ast_load_realtime</a>(<span class="stringliteral">&quot;queues&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;   <span class="keywordflow">if</span> (var) {</div><div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;      <span class="comment">/* if the queue is realtime but was not found in memory, this</span></div><div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;<span class="comment">       * means that the queue had been deleted from memory since it was</span></div><div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;<span class="comment">       * &quot;dead.&quot;</span></div><div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(var);</div><div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160;   }</div><div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;</div><div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;queue %s was not found\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;}</div><div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;<span class="comment">/*! \brief Dialplan function QUEUE_WAITING_COUNT() Get number callers waiting in a specific queue */</span></div><div class="line"><a name="l08926"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab058e7cb09a0800bc35a1db2053de820"> 8926</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab058e7cb09a0800bc35a1db2053de820">queue_function_queuewaitingcount</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;{</div><div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;   <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q, tmpq = {</div><div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160;      .<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> = data,</div><div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;   };</div><div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;</div><div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;</div><div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;QUEUE_WAITING_COUNT requires an argument: queuename\n&quot;</span>);</div><div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;   }</div><div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160;</div><div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a>(queues, &amp;tmpq, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>, <span class="stringliteral">&quot;Find for QUEUE_WAITING_COUNT()&quot;</span>))) {</div><div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;      count = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div><div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with reference in QUEUE_WAITING_COUNT()&quot;</span>);</div><div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((var = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1a03993603e2bc2463153857836645bb">ast_load_realtime</a>(<span class="stringliteral">&quot;queues&quot;</span>, <span class="stringliteral">&quot;name&quot;</span>, data, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>))) {</div><div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;      <span class="comment">/* if the queue is realtime but was not found in memory, this</span></div><div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;<span class="comment">       * means that the queue had been deleted from memory since it was</span></div><div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;<span class="comment">       * &quot;dead.&quot; This means it has a 0 waiting count</span></div><div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;      count = 0;</div><div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(var);</div><div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;queue %s was not found\n&quot;</span>, data);</div><div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;   }</div><div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;</div><div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;   snprintf(buf, len, <span class="stringliteral">&quot;%d&quot;</span>, count);</div><div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;</div><div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;}</div><div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;<span class="comment">/*! \brief Dialplan function QUEUE_MEMBER_LIST() Get list of members in a specific queue */</span></div><div class="line"><a name="l08963"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a47a9a7eb9151809e5e86948c146bee2e"> 8963</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a47a9a7eb9151809e5e86948c146bee2e">queue_function_queuememberlist</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;{</div><div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;</div><div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;   <span class="comment">/* Ensure an otherwise empty list doesn&#39;t return garbage */</span></div><div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;</div><div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;QUEUE_MEMBER_LIST requires an argument: queuename\n&quot;</span>);</div><div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;   }</div><div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;</div><div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(data))) {</div><div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;      <span class="keywordtype">int</span> buflen = 0, count = 0;</div><div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;</div><div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;      mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;      <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;         <span class="comment">/* strcat() is always faster than printf() */</span></div><div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160;         <span class="keywordflow">if</span> (count++) {</div><div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;            strncat(buf + buflen, <span class="stringliteral">&quot;,&quot;</span>, len - buflen - 1);</div><div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;            buflen++;</div><div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160;         }</div><div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;         strncat(buf + buflen, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, len - buflen - 1);</div><div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;         buflen += strlen(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;         <span class="comment">/* Safeguard against overflow (negative length) */</span></div><div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160;         <span class="keywordflow">if</span> (buflen &gt;= len - 2) {</div><div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Truncating list\n&quot;</span>);</div><div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;         }</div><div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;      }</div><div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with QUEUE_MEMBER_LIST()&quot;</span>);</div><div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;   } <span class="keywordflow">else</span></div><div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;queue %s was not found\n&quot;</span>, data);</div><div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160;</div><div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160;   <span class="comment">/* We should already be terminated, but let&#39;s make sure. */</span></div><div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;   buf[len - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160;</div><div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;}</div><div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160;<span class="comment">/*! \brief Dialplan function QUEUE_MEMBER_PENALTY() Gets the members penalty. */</span></div><div class="line"><a name="l09011"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a332b673addb088061273b81df018d7ac"> 9011</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a332b673addb088061273b81df018d7ac">queue_function_memberpenalty_read</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160;{</div><div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;   <span class="keywordtype">int</span> penalty;</div><div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(interface);</div><div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160;   );</div><div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;   <span class="comment">/* Make sure the returned value on error is NULL. */</span></div><div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;</div><div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Missing argument. QUEUE_MEMBER_PENALTY(&lt;queuename&gt;,&lt;interface&gt;)\n&quot;</span>);</div><div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;   }</div><div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;</div><div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, data);</div><div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;</div><div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.argc &lt; 2) {</div><div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Missing argument. QUEUE_MEMBER_PENALTY(&lt;queuename&gt;,&lt;interface&gt;)\n&quot;</span>);</div><div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160;   }</div><div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;</div><div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;   penalty = <a class="code" href="../../da/dfb/app__queue_8c.html#a6fdd4581a4a8945d35a54bb170b21ac6">get_member_penalty</a> (<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface);</div><div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;</div><div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;   <span class="keywordflow">if</span> (penalty &gt;= 0) { <span class="comment">/* remember that buf is already &#39;\0&#39; */</span></div><div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160;      snprintf (buf, len, <span class="stringliteral">&quot;%d&quot;</span>, penalty);</div><div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;   }</div><div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160;</div><div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;}</div><div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160;<span class="comment">/*! \brief Dialplan function QUEUE_MEMBER_PENALTY() Sets the members penalty. */</span></div><div class="line"><a name="l09043"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad4e6d4309c0c90061cdc3d10adb669a0"> 9043</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad4e6d4309c0c90061cdc3d10adb669a0">queue_function_memberpenalty_write</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>)</div><div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;{</div><div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;   <span class="keywordtype">int</span> penalty;</div><div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(interface);</div><div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;   );</div><div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;</div><div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Missing argument. QUEUE_MEMBER_PENALTY(&lt;queuename&gt;,&lt;interface&gt;)\n&quot;</span>);</div><div class="line"><a name="l09053"></a><span class="lineno"> 9053</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;   }</div><div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;</div><div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, data);</div><div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160;</div><div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.argc &lt; 2) {</div><div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Missing argument. QUEUE_MEMBER_PENALTY(&lt;queuename&gt;,&lt;interface&gt;)\n&quot;</span>);</div><div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160;   }</div><div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;</div><div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160;   penalty = atoi(value);</div><div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;</div><div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface)) {</div><div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;&lt;interface&gt; parameter can&#39;t be null\n&quot;</span>);</div><div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160;   }</div><div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160;</div><div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;   <span class="comment">/* if queuename = NULL then penalty will be set for interface in all the queues. */</span></div><div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface, <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a>, penalty)) {</div><div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid interface, queue or penalty\n&quot;</span>);</div><div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;   }</div><div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160;</div><div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;}</div><div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;</div><div class="line"><a name="l09079"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aecd410aab662a3c57a3ca1fcf1cecfbf"> 9079</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#aecd410aab662a3c57a3ca1fcf1cecfbf">queueexists_function</a> = {</div><div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_EXISTS&quot;</span>,</div><div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#a331ac4441ab3808ba988804d9d0c9a29">queue_function_exists</a>,</div><div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;};</div><div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;</div><div class="line"><a name="l09084"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a030c82755a6b35bb25eb912920d997ba"> 9084</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#a030c82755a6b35bb25eb912920d997ba">queuevar_function</a> = {</div><div class="line"><a name="l09085"></a><span class="lineno"> 9085</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_VARIABLES&quot;</span>,</div><div class="line"><a name="l09086"></a><span class="lineno"> 9086</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#a7b254b14693f1f30d4ddd615d7f777b9">queue_function_var</a>,</div><div class="line"><a name="l09087"></a><span class="lineno"> 9087</span>&#160;};</div><div class="line"><a name="l09088"></a><span class="lineno"> 9088</span>&#160;</div><div class="line"><a name="l09089"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a23c0aa9ae2331c5f79a8e7a998a20ea0"> 9089</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#a23c0aa9ae2331c5f79a8e7a998a20ea0">queuemembercount_function</a> = {</div><div class="line"><a name="l09090"></a><span class="lineno"> 9090</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_MEMBER&quot;</span>,</div><div class="line"><a name="l09091"></a><span class="lineno"> 9091</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#a0b3abb2f63fd6e5269cbb96f801b35a7">queue_function_mem_read</a>,</div><div class="line"><a name="l09092"></a><span class="lineno"> 9092</span>&#160;   .write = <a class="code" href="../../da/dfb/app__queue_8c.html#ae72cf4b6314dca87511064e3d257ab1e">queue_function_mem_write</a>,</div><div class="line"><a name="l09093"></a><span class="lineno"> 9093</span>&#160;};</div><div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160;</div><div class="line"><a name="l09095"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad6116b09b58e795dd72862b6c5a6d140"> 9095</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#ad6116b09b58e795dd72862b6c5a6d140">queuemembercount_dep</a> = {</div><div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_MEMBER_COUNT&quot;</span>,</div><div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#aa08d109f431a880fd7c401d6f2e58d25">queue_function_qac_dep</a>,</div><div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160;};</div><div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160;</div><div class="line"><a name="l09100"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae98d530ca277ac225286ff90659ed9f4"> 9100</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#ae98d530ca277ac225286ff90659ed9f4">queuegetchannel_function</a> = {</div><div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_GET_CHANNEL&quot;</span>,</div><div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#aeefd277e923719dc1671a0bc0eb3c2ed">queue_function_queuegetchannel</a>,</div><div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;};</div><div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160;</div><div class="line"><a name="l09105"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a244749c3d8b00d8ad1c335cf2cd2e54c"> 9105</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#a244749c3d8b00d8ad1c335cf2cd2e54c">queuewaitingcount_function</a> = {</div><div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_WAITING_COUNT&quot;</span>,</div><div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#ab058e7cb09a0800bc35a1db2053de820">queue_function_queuewaitingcount</a>,</div><div class="line"><a name="l09108"></a><span class="lineno"> 9108</span>&#160;};</div><div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;</div><div class="line"><a name="l09110"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2ae3e4026ef50c6dbe7de7bae5023d15"> 9110</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#a2ae3e4026ef50c6dbe7de7bae5023d15">queuememberlist_function</a> = {</div><div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_MEMBER_LIST&quot;</span>,</div><div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#a47a9a7eb9151809e5e86948c146bee2e">queue_function_queuememberlist</a>,</div><div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160;};</div><div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;</div><div class="line"><a name="l09115"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9827f040c8a8bbf13b82b6098c0e7d25"> 9115</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../da/dfb/app__queue_8c.html#a9827f040c8a8bbf13b82b6098c0e7d25">queuememberpenalty_function</a> = {</div><div class="line"><a name="l09116"></a><span class="lineno"> 9116</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;QUEUE_MEMBER_PENALTY&quot;</span>,</div><div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;   .read = <a class="code" href="../../da/dfb/app__queue_8c.html#a332b673addb088061273b81df018d7ac">queue_function_memberpenalty_read</a>,</div><div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;   .write = <a class="code" href="../../da/dfb/app__queue_8c.html#ad4e6d4309c0c90061cdc3d10adb669a0">queue_function_memberpenalty_write</a>,</div><div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;};</div><div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;<span class="comment">/*! Reset the global queue rules parameters even if there is no &quot;general&quot; section of queuerules.conf */</span></div><div class="line"><a name="l09122"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a63d1be9b7af452b0ffe285d8a1cc7a43"> 9122</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a63d1be9b7af452b0ffe285d8a1cc7a43">queue_rules_reset_global_params</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;{</div><div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;   realtime_rules = 0;</div><div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;}</div><div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;<span class="comment">/*! Set the global queue rules parameters as defined in the &quot;general&quot; section of queuerules.conf */</span></div><div class="line"><a name="l09128"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae7ea23e36e4f751740b5651111de1de4"> 9128</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae7ea23e36e4f751740b5651111de1de4">queue_rules_set_global_params</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg)</div><div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;{</div><div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *general_val = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160;   <span class="keywordflow">if</span> ((general_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;realtime_rules&quot;</span>))) {</div><div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;      realtime_rules = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(general_val);</div><div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;   }</div><div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160;}</div><div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;<span class="comment">/*! \brief Reload the rules defined in queuerules.conf</span></div><div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09138"></a><span class="lineno"> 9138</span>&#160;<span class="comment"> * \param reload If 1, then only process queuerules.conf if the file</span></div><div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;<span class="comment"> * has changed since the last time we inspected it.</span></div><div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;<span class="comment"> * \return Always returns AST_MODULE_LOAD_SUCCESS</span></div><div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09142"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a7c735420578948b9097fbf5dc71a094c"> 9142</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a7c735420578948b9097fbf5dc71a094c">reload_queue_rules</a>(<span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>)</div><div class="line"><a name="l09143"></a><span class="lineno"> 9143</span>&#160;{</div><div class="line"><a name="l09144"></a><span class="lineno"> 9144</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l09145"></a><span class="lineno"> 9145</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> *rl_iter, *new_rl;</div><div class="line"><a name="l09146"></a><span class="lineno"> 9146</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *pr_iter;</div><div class="line"><a name="l09147"></a><span class="lineno"> 9147</span>&#160;   <span class="keywordtype">char</span> *rulecat = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09148"></a><span class="lineno"> 9148</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *rulevar = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09149"></a><span class="lineno"> 9149</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { (reload &amp;&amp; !<a class="code" href="../../da/dfb/app__queue_8c.html#a703a108712f8f7b20303de08a0c4f5ac">realtime_rules</a>) ? <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };</div><div class="line"><a name="l09150"></a><span class="lineno"> 9150</span>&#160;</div><div class="line"><a name="l09151"></a><span class="lineno"> 9151</span>&#160;   <span class="keywordflow">if</span> (!(cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a>(<span class="stringliteral">&quot;queuerules.conf&quot;</span>, config_flags))) {</div><div class="line"><a name="l09152"></a><span class="lineno"> 9152</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;No queuerules.conf file found, queues will not follow penalty rules\n&quot;</span>);</div><div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) {</div><div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;queuerules.conf has not changed since it was last loaded. Not taking any action.\n&quot;</span>);</div><div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Config file queuerules.conf is in an invalid format.  Aborting.\n&quot;</span>);</div><div class="line"><a name="l09159"></a><span class="lineno"> 9159</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l09160"></a><span class="lineno"> 9160</span>&#160;   }</div><div class="line"><a name="l09161"></a><span class="lineno"> 9161</span>&#160;</div><div class="line"><a name="l09162"></a><span class="lineno"> 9162</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l09163"></a><span class="lineno"> 9163</span>&#160;   <span class="keywordflow">while</span> ((rl_iter = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, list))) {</div><div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160;      <span class="keywordflow">while</span> ((pr_iter = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, list)))</div><div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(pr_iter);</div><div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(rl_iter);</div><div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;   }</div><div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a63d1be9b7af452b0ffe285d8a1cc7a43">queue_rules_reset_global_params</a>();</div><div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;   <span class="keywordflow">while</span> ((rulecat = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(cfg, rulecat))) {</div><div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(rulecat, <span class="stringliteral">&quot;general&quot;</span>)) {</div><div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ae7ea23e36e4f751740b5651111de1de4">queue_rules_set_global_params</a>(cfg);</div><div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;      }</div><div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160;      <span class="keywordflow">if</span> (!(new_rl = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*new_rl)))) {</div><div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160;         <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(new_rl-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, rulecat, <span class="keyword">sizeof</span>(new_rl-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>));</div><div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, new_rl, list);</div><div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;         <span class="keywordflow">for</span> (rulevar = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, rulecat); rulevar; rulevar = rulevar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>)</div><div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160;            <span class="keywordflow">if</span>(!strcasecmp(rulevar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;penaltychange&quot;</span>))</div><div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;               <a class="code" href="../../da/dfb/app__queue_8c.html#ab7086bc4304099aec95794ea6ed63260">insert_penaltychange</a>(new_rl-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, rulevar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, rulevar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Don&#39;t know how to handle rule type &#39;%s&#39; on line %d\n&quot;</span>, rulevar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, rulevar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;      }</div><div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160;   }</div><div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;</div><div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160;</div><div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;   <span class="keywordflow">if</span> (realtime_rules &amp;&amp; <a class="code" href="../../da/dfb/app__queue_8c.html#a61e1b2c0b46092bc326d39def24be4f8">load_realtime_rules</a>()) {</div><div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160;   }</div><div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;</div><div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;}</div><div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160;<span class="comment">/*! Always set the global queue defaults, even if there is no &quot;general&quot; section in queues.conf */</span></div><div class="line"><a name="l09201"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a1d2780396e569561ccc91f09174f3c3f"> 9201</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a1d2780396e569561ccc91f09174f3c3f">queue_reset_global_params</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;{</div><div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160;   queue_persistent_members = 0;</div><div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;   autofill_default = 0;</div><div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;   montype_default = 0;</div><div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160;   shared_lastcall = 0;</div><div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;   negative_penalty_invalid = 0;</div><div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;   log_membername_as_agent = 0;</div><div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;}</div><div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;<span class="comment">/*! Set the global queue parameters as defined in the &quot;general&quot; section of queues.conf */</span></div><div class="line"><a name="l09212"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a49cb6663a6fd8f3f40808206df196722"> 9212</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a49cb6663a6fd8f3f40808206df196722">queue_set_global_params</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg)</div><div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160;{</div><div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *general_val = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;   <span class="keywordflow">if</span> ((general_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;persistentmembers&quot;</span>))) {</div><div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;      queue_persistent_members = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(general_val);</div><div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160;   }</div><div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;   <span class="keywordflow">if</span> ((general_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;autofill&quot;</span>))) {</div><div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;      autofill_default = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(general_val);</div><div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;   }</div><div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160;   <span class="keywordflow">if</span> ((general_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;monitor-type&quot;</span>))) {</div><div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(general_val, <span class="stringliteral">&quot;mixmonitor&quot;</span>))</div><div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;         montype_default = 1;</div><div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;   }</div><div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;   <span class="keywordflow">if</span> ((general_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;shared_lastcall&quot;</span>))) {</div><div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;      shared_lastcall = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(general_val);</div><div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;   }</div><div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160;   <span class="keywordflow">if</span> ((general_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;negative_penalty_invalid&quot;</span>))) {</div><div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;      negative_penalty_invalid = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(general_val);</div><div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;   }</div><div class="line"><a name="l09231"></a><span class="lineno"> 9231</span>&#160;   <span class="keywordflow">if</span> ((general_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;log_membername_as_agent&quot;</span>))) {</div><div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;      log_membername_as_agent = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(general_val);</div><div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;   }</div><div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;}</div><div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;<span class="comment">/*! \brief reload information pertaining to a single member</span></div><div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;<span class="comment"> * This function is called when a member = line is encountered in</span></div><div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160;<span class="comment"> * queues.conf.</span></div><div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;<span class="comment"> * \param memberdata The part after member = in the config file</span></div><div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160;<span class="comment"> * \param q The queue to which this member belongs</span></div><div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09244"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a39bf3539cac69a629428927d5228ec1d"> 9244</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a39bf3539cac69a629428927d5228ec1d">reload_single_member</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *memberdata, <span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q)</div><div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;{</div><div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;   <span class="keywordtype">char</span> *membername, *interface, *state_interface, *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *cur, *newm;</div><div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> tmpmem;</div><div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>;</div><div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>;</div><div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(interface);</div><div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(penalty);</div><div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(membername);</div><div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(state_interface);</div><div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(ringinuse);</div><div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(wrapuptime);</div><div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;   );</div><div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160;</div><div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(memberdata)) {</div><div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Empty queue member definition. Moving on!\n&quot;</span>);</div><div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;   }</div><div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;</div><div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;   <span class="comment">/* Add a new member */</span></div><div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(memberdata);</div><div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;</div><div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;</div><div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160;   <span class="keyword">interface </span>= <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.interface;</div><div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.penalty)) {</div><div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;      tmp = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.penalty;</div><div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(tmp);</div><div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;      penalty = atoi(tmp);</div><div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;      <span class="keywordflow">if</span> (penalty &lt; 0) {</div><div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;         penalty = 0;</div><div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160;      }</div><div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;      penalty = 0;</div><div class="line"><a name="l09282"></a><span class="lineno"> 9282</span>&#160;   }</div><div class="line"><a name="l09283"></a><span class="lineno"> 9283</span>&#160;</div><div class="line"><a name="l09284"></a><span class="lineno"> 9284</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.membername)) {</div><div class="line"><a name="l09285"></a><span class="lineno"> 9285</span>&#160;      membername = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.membername;</div><div class="line"><a name="l09286"></a><span class="lineno"> 9286</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(membername);</div><div class="line"><a name="l09287"></a><span class="lineno"> 9287</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09288"></a><span class="lineno"> 9288</span>&#160;      membername = interface;</div><div class="line"><a name="l09289"></a><span class="lineno"> 9289</span>&#160;   }</div><div class="line"><a name="l09290"></a><span class="lineno"> 9290</span>&#160;</div><div class="line"><a name="l09291"></a><span class="lineno"> 9291</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.state_interface)) {</div><div class="line"><a name="l09292"></a><span class="lineno"> 9292</span>&#160;      state_interface = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.state_interface;</div><div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(state_interface);</div><div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;      state_interface = interface;</div><div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160;   }</div><div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;</div><div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.ringinuse)) {</div><div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;      tmp = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.ringinuse;</div><div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(tmp);</div><div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(tmp)) {</div><div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160;         ringinuse = 1;</div><div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(tmp)) {</div><div class="line"><a name="l09304"></a><span class="lineno"> 9304</span>&#160;         ringinuse = 0;</div><div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Member %s has an invalid ringinuse value. Using %s ringinuse value.\n&quot;</span>,</div><div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160;            membername, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160;         ringinuse = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;      }</div><div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160;      ringinuse = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;   }</div><div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;</div><div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.wrapuptime)) {</div><div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;      tmp = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.wrapuptime;</div><div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(tmp);</div><div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;      wrapuptime = atoi(tmp);</div><div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;      <span class="keywordflow">if</span> (wrapuptime &lt; 0) {</div><div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;         wrapuptime = 0;</div><div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;      }</div><div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;      wrapuptime = 0;</div><div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;   }</div><div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;</div><div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;   <span class="comment">/* Find the old position in the list */</span></div><div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmpmem.<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, interface, <span class="keyword">sizeof</span>(tmpmem.<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>));</div><div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;   cur = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, &amp;tmpmem, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>);</div><div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;</div><div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;   <span class="keywordflow">if</span> ((newm = <a class="code" href="../../da/dfb/app__queue_8c.html#a066e0020d2b8551be747bd42d26ab94a">create_queue_member</a>(interface, membername, penalty, cur ? cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a> : 0, state_interface, ringinuse, wrapuptime))) {</div><div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;      newm-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a> = wrapuptime;</div><div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;      <span class="keywordflow">if</span> (cur) {</div><div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;         <span class="comment">/* Round Robin Queue Position must be copied if this is replacing an existing member */</span></div><div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;         newm-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a> = cur-&gt;<a class="code" href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">queuepos</a>;</div><div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, newm);</div><div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, cur);</div><div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160;         <span class="comment">/* Otherwise we need to add using the function that will apply a round robin queue position manually. */</span></div><div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ac3cd051d456ef70c6b88a3c2c6056432">member_add_to_queue</a>(q, newm);</div><div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160;      }</div><div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(newm, -1);</div><div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160;   }</div><div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;   newm = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;</div><div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160;   <span class="keywordflow">if</span> (cur) {</div><div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cur, -1);</div><div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;   }</div><div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;}</div><div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160;</div><div class="line"><a name="l09351"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2807f5312b497d9ccbb4c43f226d5c19"> 9351</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2807f5312b497d9ccbb4c43f226d5c19">mark_member_dead</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160;{</div><div class="line"><a name="l09353"></a><span class="lineno"> 9353</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a> = obj;</div><div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;   <span class="keywordflow">if</span> (!member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a> &amp;&amp; !member-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a>) {</div><div class="line"><a name="l09355"></a><span class="lineno"> 9355</span>&#160;      member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a22ed1f20028b26f7ece35aeec695293f">delme</a> = 1;</div><div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;   }</div><div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;}</div><div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160;</div><div class="line"><a name="l09360"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aac7dfe864fa6fde0b2069f9aca32d9bf"> 9360</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aac7dfe864fa6fde0b2069f9aca32d9bf">kill_dead_members</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160;{</div><div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a> = obj;</div><div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;</div><div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160;   <span class="keywordflow">if</span> (!member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a22ed1f20028b26f7ece35aeec695293f">delme</a>) {</div><div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;      member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#acfa0c49ab441d6095ecaaf9bcdf72c04">get_queue_member_status</a>(member);</div><div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160;   }</div><div class="line"><a name="l09370"></a><span class="lineno"> 9370</span>&#160;}</div><div class="line"><a name="l09371"></a><span class="lineno"> 9371</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09372"></a><span class="lineno"> 9372</span>&#160;<span class="comment">/*! \brief Reload information pertaining to a particular queue</span></div><div class="line"><a name="l09373"></a><span class="lineno"> 9373</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09374"></a><span class="lineno"> 9374</span>&#160;<span class="comment"> * Once we have isolated a queue within reload_queues, we call this. This will either</span></div><div class="line"><a name="l09375"></a><span class="lineno"> 9375</span>&#160;<span class="comment"> * reload information for the queue or if we&#39;re just reloading member information, we&#39;ll just</span></div><div class="line"><a name="l09376"></a><span class="lineno"> 9376</span>&#160;<span class="comment"> * reload that without touching other settings within the queue</span></div><div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09378"></a><span class="lineno"> 9378</span>&#160;<span class="comment"> * \param cfg The configuration which we are reading</span></div><div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;<span class="comment"> * \param mask Tells us what information we need to reload</span></div><div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;<span class="comment"> * \param queuename The name of the queue we are reloading information from</span></div><div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160;<span class="comment"> * \retval void</span></div><div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09383"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3dcb3584df9f70680b14a8fb4d152e10"> 9383</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3dcb3584df9f70680b14a8fb4d152e10">reload_single_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg, <span class="keyword">struct</span> <a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> *mask, <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename)</div><div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160;{</div><div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160;   <span class="keywordtype">int</span> <span class="keyword">new</span>;</div><div class="line"><a name="l09386"></a><span class="lineno"> 9386</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09387"></a><span class="lineno"> 9387</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../d7/dd6/structmember.html">member</a>;</div><div class="line"><a name="l09388"></a><span class="lineno"> 9388</span>&#160;   <span class="comment">/*We&#39;re defining a queue*/</span></div><div class="line"><a name="l09389"></a><span class="lineno"> 9389</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> tmpq = {</div><div class="line"><a name="l09390"></a><span class="lineno"> 9390</span>&#160;      .<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a> = queuename,</div><div class="line"><a name="l09391"></a><span class="lineno"> 9391</span>&#160;   };</div><div class="line"><a name="l09392"></a><span class="lineno"> 9392</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *tmpvar;</div><div class="line"><a name="l09393"></a><span class="lineno"> 9393</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> queue_reload = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44">QUEUE_RELOAD_PARAMETERS</a>);</div><div class="line"><a name="l09394"></a><span class="lineno"> 9394</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> member_reload = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f">QUEUE_RELOAD_MEMBER</a>);</div><div class="line"><a name="l09395"></a><span class="lineno"> 9395</span>&#160;   <span class="keywordtype">int</span> prev_weight = 0;</div><div class="line"><a name="l09396"></a><span class="lineno"> 9396</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l09397"></a><span class="lineno"> 9397</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;</div><div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;   <span class="keywordflow">if</span> (!(q = <a class="code" href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a>(queues, &amp;tmpq, <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>, <span class="stringliteral">&quot;Find queue for reload&quot;</span>))) {</div><div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;      <span class="keywordflow">if</span> (queue_reload) {</div><div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160;         <span class="comment">/* Make one then */</span></div><div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;         <span class="keywordflow">if</span> (!(q = <a class="code" href="../../da/dfb/app__queue_8c.html#a73f936847e6ad20cb842d03593dc47c4">alloc_queue</a>(queuename))) {</div><div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160;         }</div><div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160;         <span class="comment">/* Since we&#39;re not reloading queues, this means that we found a queue</span></div><div class="line"><a name="l09407"></a><span class="lineno"> 9407</span>&#160;<span class="comment">          * in the configuration file which we don&#39;t know about yet. Just return.</span></div><div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l09409"></a><span class="lineno"> 9409</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l09410"></a><span class="lineno"> 9410</span>&#160;      }</div><div class="line"><a name="l09411"></a><span class="lineno"> 9411</span>&#160;      <span class="keyword">new</span> = 1;</div><div class="line"><a name="l09412"></a><span class="lineno"> 9412</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09413"></a><span class="lineno"> 9413</span>&#160;      <span class="keyword">new</span> = 0;</div><div class="line"><a name="l09414"></a><span class="lineno"> 9414</span>&#160;   }</div><div class="line"><a name="l09415"></a><span class="lineno"> 9415</span>&#160;</div><div class="line"><a name="l09416"></a><span class="lineno"> 9416</span>&#160;   <span class="keywordflow">if</span> (!<span class="keyword">new</span>) {</div><div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160;      prev_weight = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> ? 1 : 0;</div><div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;   }</div><div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;   <span class="comment">/* Check if we already found a queue with this name in the config file */</span></div><div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a>) {</div><div class="line"><a name="l09422"></a><span class="lineno"> 9422</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Queue &#39;%s&#39; already defined! Skipping!\n&quot;</span>, queuename);</div><div class="line"><a name="l09423"></a><span class="lineno"> 9423</span>&#160;      <span class="keywordflow">if</span> (!<span class="keyword">new</span>) {</div><div class="line"><a name="l09424"></a><span class="lineno"> 9424</span>&#160;         <span class="comment">/* It should be impossible to *not* hit this case*/</span></div><div class="line"><a name="l09425"></a><span class="lineno"> 9425</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l09426"></a><span class="lineno"> 9426</span>&#160;      }</div><div class="line"><a name="l09427"></a><span class="lineno"> 9427</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;We exist! Expiring temporary pointer&quot;</span>);</div><div class="line"><a name="l09428"></a><span class="lineno"> 9428</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;   }</div><div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160;   <span class="comment">/* Due to the fact that the &quot;linear&quot; strategy will have a different allocation</span></div><div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;<span class="comment">    * scheme for queue members, we must devise the queue&#39;s strategy before other initializations.</span></div><div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;<span class="comment">    * To be specific, the linear strategy needs to function like a linked list, meaning the ao2</span></div><div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160;<span class="comment">    * container used will have only a single bucket instead of the typical number.</span></div><div class="line"><a name="l09434"></a><span class="lineno"> 9434</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160;   <span class="keywordflow">if</span> (queue_reload) {</div><div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;      <span class="keywordflow">if</span> ((tmpvar = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, queuename, <span class="stringliteral">&quot;strategy&quot;</span>))) {</div><div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#aeee3b4385050286dedc0e20f247d428c">strat2int</a>(tmpvar);</div><div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160;         <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> &lt; 0) {</div><div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;&#39;%s&#39; isn&#39;t a valid strategy for queue &#39;%s&#39;, using ringall instead\n&quot;</span>,</div><div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;            tmpvar, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>;</div><div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;         }</div><div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160;         q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a>;</div><div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;      }</div><div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#aa76378a6ff09ce40268e214fdae6a61d">init_queue</a>(q);</div><div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;   }</div><div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160;   <span class="keywordflow">if</span> (member_reload) {</div><div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2807f5312b497d9ccbb4c43f226d5c19">mark_member_dead</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a> = 1;</div><div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;   }</div><div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160;</div><div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160;   <span class="comment">/* On the first pass we just read the parameters of the queue */</span></div><div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;   <span class="keywordflow">for</span> (var = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, queuename); <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>; var = var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;      <span class="keywordflow">if</span> (queue_reload &amp;&amp; strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;member&quot;</span>)) {</div><div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a94baaee180e6f6ae082418dc78e7c7cf">queue_set_param</a>(q, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>, 1);</div><div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;      }</div><div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;   }</div><div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160;</div><div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;   <span class="comment">/* On the second pass, we read members */</span></div><div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160;   <span class="keywordflow">for</span> (var = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, queuename); <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>; var = var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;      <span class="keywordflow">if</span> (member_reload &amp;&amp; !strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;member&quot;</span>)) {</div><div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a39bf3539cac69a629428927d5228ec1d">reload_single_member</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, q);</div><div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160;      }</div><div class="line"><a name="l09465"></a><span class="lineno"> 9465</span>&#160;   }</div><div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;</div><div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;   <span class="comment">/* Update ringinuse for dynamic members */</span></div><div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160;   <span class="keywordflow">if</span> (member_reload) {</div><div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160;      mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a7b5de2aa80f528d3dc554caadb8dc6aba42e2c6aadc44e4259a058a6675b7e7e4">AO2_ITERATOR_DONTLOCK</a>);</div><div class="line"><a name="l09471"></a><span class="lineno"> 9471</span>&#160;      <span class="keywordflow">while</span> ((member = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160;         <span class="keywordflow">if</span> (member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a>) {</div><div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;            member-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a>;</div><div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;         }</div><div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(member, -1);</div><div class="line"><a name="l09476"></a><span class="lineno"> 9476</span>&#160;      }</div><div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160;   }</div><div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;</div><div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160;   <span class="comment">/* At this point, we&#39;ve determined if the queue has a weight, so update use_weight</span></div><div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160;<span class="comment">    * as appropriate</span></div><div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;   <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> &amp;&amp; prev_weight) {</div><div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;use_weight, -1);</div><div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a> &amp;&amp; !prev_weight) {</div><div class="line"><a name="l09487"></a><span class="lineno"> 9487</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;use_weight, +1);</div><div class="line"><a name="l09488"></a><span class="lineno"> 9488</span>&#160;   }</div><div class="line"><a name="l09489"></a><span class="lineno"> 9489</span>&#160;</div><div class="line"><a name="l09490"></a><span class="lineno"> 9490</span>&#160;   <span class="comment">/* Free remaining members marked as delme */</span></div><div class="line"><a name="l09491"></a><span class="lineno"> 9491</span>&#160;   <span class="keywordflow">if</span> (member_reload) {</div><div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#ab56591994d9db2eb3cf3eb8404c881f4">queue_delme_members_decrement_followers</a>, q);</div><div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#aac7dfe864fa6fde0b2069f9aca32d9bf">kill_dead_members</a>, q);</div><div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>);</div><div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;   }</div><div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;</div><div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;   <span class="keywordflow">if</span> (<span class="keyword">new</span>) {</div><div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a6d56dcc1f330ae7fe1b5a1ee832077c1">queues_t_link</a>(queues, q, <span class="stringliteral">&quot;Add queue to container&quot;</span>);</div><div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160;   }</div><div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Expiring creation reference&quot;</span>);</div><div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160;}</div><div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160;</div><div class="line"><a name="l09506"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abf9e3172ae159d6dc89bc77fc3d25c83"> 9506</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#abf9e3172ae159d6dc89bc77fc3d25c83">mark_unfound</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> <a class="code" href="../../d9/d97/structao2__iterator.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>)</div><div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;{</div><div class="line"><a name="l09508"></a><span class="lineno"> 9508</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = obj;</div><div class="line"><a name="l09509"></a><span class="lineno"> 9509</span>&#160;   <span class="keywordtype">char</span> *queuename = arg;</div><div class="line"><a name="l09510"></a><span class="lineno"> 9510</span>&#160;   <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a> &amp;&amp; (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename) || !strcasecmp(queuename, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>))) {</div><div class="line"><a name="l09511"></a><span class="lineno"> 9511</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a> = 0;</div><div class="line"><a name="l09512"></a><span class="lineno"> 9512</span>&#160;   }</div><div class="line"><a name="l09513"></a><span class="lineno"> 9513</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09514"></a><span class="lineno"> 9514</span>&#160;}</div><div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160;</div><div class="line"><a name="l09516"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae3f91b4dcac991435b8341363b37e54e"> 9516</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae3f91b4dcac991435b8341363b37e54e">kill_if_unfound</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;{</div><div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q = obj;</div><div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160;   <span class="keywordtype">char</span> *queuename = arg;</div><div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;   <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a> &amp;&amp; !q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">found</a> &amp;&amp; (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename) || !strcasecmp(queuename, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>))) {</div><div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;      q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 1;</div><div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;   }</div><div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160;}</div><div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160;<span class="comment">/*! \brief reload the queues.conf file</span></div><div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;<span class="comment"> * This function reloads the information in the general section of the queues.conf</span></div><div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160;<span class="comment"> * file and potentially more, depending on the value of mask.</span></div><div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160;<span class="comment"> * \param reload 0 if we are calling this the first time, 1 every other time</span></div><div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;<span class="comment"> * \param mask Gives flags telling us what information to actually reload</span></div><div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;<span class="comment"> * \param queuename If set to a non-zero string, then only reload information from</span></div><div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160;<span class="comment"> * that particular queue. Otherwise inspect all queues</span></div><div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;<span class="comment"> * \retval -1 Failure occurred</span></div><div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160;<span class="comment"> * \retval 0 All clear!</span></div><div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09540"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a3d172953bea29dc16fe1596eca35b186"> 9540</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a3d172953bea29dc16fe1596eca35b186">reload_queues</a>(<span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>, <span class="keyword">struct</span> <a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> *mask, <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename)</div><div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;{</div><div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;   <span class="keywordtype">char</span> *cat;</div><div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { reload ? <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };</div><div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> queue_reload = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44">QUEUE_RELOAD_PARAMETERS</a>);</div><div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160;</div><div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160;   <span class="keywordflow">if</span> (!(cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a>(<span class="stringliteral">&quot;queues.conf&quot;</span>, config_flags))) {</div><div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;No call queueing config file (queues.conf), so no call queues\n&quot;</span>);</div><div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) {</div><div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Config file queues.conf is in an invalid format.  Aborting.\n&quot;</span>);</div><div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;   }</div><div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;</div><div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160;   <span class="comment">/* We&#39;ve made it here, so it looks like we&#39;re doing operations on all queues. */</span></div><div class="line"><a name="l09558"></a><span class="lineno"> 9558</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(queues);</div><div class="line"><a name="l09559"></a><span class="lineno"> 9559</span>&#160;</div><div class="line"><a name="l09560"></a><span class="lineno"> 9560</span>&#160;   <span class="comment">/* Mark non-realtime queues not found at the beginning. */</span></div><div class="line"><a name="l09561"></a><span class="lineno"> 9561</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(queues, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#abf9e3172ae159d6dc89bc77fc3d25c83">mark_unfound</a>, (<span class="keywordtype">char</span> *) queuename);</div><div class="line"><a name="l09562"></a><span class="lineno"> 9562</span>&#160;</div><div class="line"><a name="l09563"></a><span class="lineno"> 9563</span>&#160;   <span class="comment">/* Chug through config file. */</span></div><div class="line"><a name="l09564"></a><span class="lineno"> 9564</span>&#160;   cat = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09565"></a><span class="lineno"> 9565</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a1d2780396e569561ccc91f09174f3c3f">queue_reset_global_params</a>();</div><div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160;   <span class="keywordflow">while</span> ((cat = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(cfg, cat)) ) {</div><div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">&quot;general&quot;</span>) &amp;&amp; queue_reload) {</div><div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a49cb6663a6fd8f3f40808206df196722">queue_set_global_params</a>(cfg);</div><div class="line"><a name="l09569"></a><span class="lineno"> 9569</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09570"></a><span class="lineno"> 9570</span>&#160;      }</div><div class="line"><a name="l09571"></a><span class="lineno"> 9571</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename) || !strcasecmp(cat, queuename))</div><div class="line"><a name="l09572"></a><span class="lineno"> 9572</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a3dcb3584df9f70680b14a8fb4d152e10">reload_single_queue</a>(cfg, mask, cat);</div><div class="line"><a name="l09573"></a><span class="lineno"> 9573</span>&#160;   }</div><div class="line"><a name="l09574"></a><span class="lineno"> 9574</span>&#160;</div><div class="line"><a name="l09575"></a><span class="lineno"> 9575</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;   <span class="keywordflow">if</span> (queue_reload) {</div><div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;      <span class="comment">/* Unlink and mark dead all non-realtime queues that were not found in the configuration file. */</span></div><div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(queues, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#ae3f91b4dcac991435b8341363b37e54e">kill_if_unfound</a>, (<span class="keywordtype">char</span> *) queuename);</div><div class="line"><a name="l09579"></a><span class="lineno"> 9579</span>&#160;   }</div><div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(queues);</div><div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;}</div><div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160;<span class="comment">/*! \brief Facilitates resetting statistics for a queue</span></div><div class="line"><a name="l09585"></a><span class="lineno"> 9585</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;<span class="comment"> * This function actually does not reset any statistics, but</span></div><div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160;<span class="comment"> * rather finds a call_queue struct which corresponds to the</span></div><div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;<span class="comment"> * passed-in queue name and passes that structure to the</span></div><div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;<span class="comment"> * clear_queue function. If no queuename is passed in, then</span></div><div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160;<span class="comment"> * all queues will have their statistics reset.</span></div><div class="line"><a name="l09591"></a><span class="lineno"> 9591</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;<span class="comment"> * \param queuename The name of the queue to reset the statistics</span></div><div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160;<span class="comment"> * for. If this is NULL or zero-length, then this means to reset</span></div><div class="line"><a name="l09594"></a><span class="lineno"> 9594</span>&#160;<span class="comment"> * the statistics for all queues</span></div><div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160;<span class="comment"> * \retval void</span></div><div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09597"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a97708d329e8643860a9f82eafcd5a4ff"> 9597</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a97708d329e8643860a9f82eafcd5a4ff">clear_stats</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename)</div><div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;{</div><div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;</div><div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename) || !strcasecmp(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queuename))</div><div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a3f75910c35a627fb9d15d0024fe0c36b">clear_queue</a>(q);</div><div class="line"><a name="l09607"></a><span class="lineno"> 9607</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;   }</div><div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09612"></a><span class="lineno"> 9612</span>&#160;}</div><div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160;<span class="comment">/*! \brief The command center for all reload operations</span></div><div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;<span class="comment"> * Whenever any piece of queue information is to be reloaded, this function</span></div><div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;<span class="comment"> * is called. It interprets the flags set in the mask parameter and acts</span></div><div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;<span class="comment"> * based on how they are set.</span></div><div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160;<span class="comment"> * \param reload True if we are reloading information, false if we are loading</span></div><div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;<span class="comment"> * information for the first time.</span></div><div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;<span class="comment"> * \param mask A bitmask which tells the handler what actions to take</span></div><div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;<span class="comment"> * \param queuename The name of the queue on which we wish to take action</span></div><div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160;<span class="comment"> * \retval 0 All reloads were successful</span></div><div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;<span class="comment"> * \retval non-zero There was a failure</span></div><div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09627"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5"> 9627</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(<span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>, <span class="keyword">struct</span> <a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> *mask, <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename)</div><div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;{</div><div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160;</div><div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a04da28a6a506fbc6dfce3f3da3569acc">QUEUE_RELOAD_RULES</a>)) {</div><div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;      res |= <a class="code" href="../../da/dfb/app__queue_8c.html#a7c735420578948b9097fbf5dc71a094c">reload_queue_rules</a>(reload);</div><div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160;   }</div><div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c">QUEUE_RESET_STATS</a>)) {</div><div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;      res |= <a class="code" href="../../da/dfb/app__queue_8c.html#a97708d329e8643860a9f82eafcd5a4ff">clear_stats</a>(queuename);</div><div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;   }</div><div class="line"><a name="l09637"></a><span class="lineno"> 9637</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(mask, (<a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44">QUEUE_RELOAD_PARAMETERS</a> | <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f">QUEUE_RELOAD_MEMBER</a>))) {</div><div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;      res |= <a class="code" href="../../da/dfb/app__queue_8c.html#a3d172953bea29dc16fe1596eca35b186">reload_queues</a>(reload, mask, queuename);</div><div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160;   }</div><div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;}</div><div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;<span class="comment">/*! \brief direct ouput to manager or cli with proper terminator */</span></div><div class="line"><a name="l09644"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48"> 9644</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keywordtype">int</span> fd, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</div><div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160;{</div><div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;   <span class="keywordflow">if</span> (s) {</div><div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;%s\r\n&quot;</span>, str);</div><div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09649"></a><span class="lineno"> 9649</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(fd, <span class="stringliteral">&quot;%s\n&quot;</span>, str);</div><div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;   }</div><div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;}</div><div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;<span class="comment">/*! \brief Print a single queue to AMI or the CLI */</span></div><div class="line"><a name="l09654"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a55c36f2f3daa5a20c2b2e8861112ac35"> 9654</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a55c36f2f3daa5a20c2b2e8861112ac35">print_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keywordtype">int</span> fd, <span class="keyword">struct</span> <a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q)</div><div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160;{</div><div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160;   <span class="keywordtype">float</span> sl;</div><div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;   <span class="keywordtype">float</span> sl2;</div><div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(512);</div><div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;   time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09661"></a><span class="lineno"> 9661</span>&#160;</div><div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <span class="stringliteral">&quot;%s has %d calls (max &quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a>) {</div><div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;%d&quot;</span>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a>);</div><div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09666"></a><span class="lineno"> 9666</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;unlimited&quot;</span>);</div><div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;   }</div><div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160;   sl = 0;</div><div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;   sl2 = 0;</div><div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> &gt; 0) {</div><div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160;      sl = 100 * ((float) q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a> / (<span class="keywordtype">float</span>) q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>);</div><div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;   }</div><div class="line"><a name="l09673"></a><span class="lineno"> 9673</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> + q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a> &gt; 0) {</div><div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;      sl2 =100 * (((float)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a9d7f2e93f4bdd39ea6aa5eeaa02f0066">callsabandonedinsl</a> + (<span class="keywordtype">float</span>)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a>) / ((<span class="keywordtype">float</span>)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a> + (float)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>));</div><div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160;   }</div><div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;</div><div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;) in &#39;%s&#39; strategy (%ds holdtime, %ds talktime), W:%d, C:%d, A:%d, SL:%2.1f%%, SL2:%2.1f%% within %ds&quot;</span>,</div><div class="line"><a name="l09678"></a><span class="lineno"> 9678</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a792b5d8a5231db2f05b08bd73d318ea5">int2strat</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>), q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>, sl, sl2, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>);</div><div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out));</div><div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>)) {</div><div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <span class="stringliteral">&quot;   No Members&quot;</span>);</div><div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;</div><div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <span class="stringliteral">&quot;   Members: &quot;</span>);</div><div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160;      mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;      <span class="keywordflow">while</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <span class="stringliteral">&quot;      %s&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>);</div><div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;         <span class="keywordflow">if</span> (strcasecmp(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>)) {</div><div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; (%s&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>)</div><div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;               &amp;&amp; strcmp(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>)) {</div><div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; from %s&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>);</div><div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;            }</div><div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;)&quot;</span>);</div><div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160;         }</div><div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;         <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>) {</div><div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; with penalty %d&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>);</div><div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;         }</div><div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;</div><div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; (ringinuse %s)&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">ringinuse</a> ? <span class="stringliteral">&quot;enabled&quot;</span> : <span class="stringliteral">&quot;disabled&quot;</span>);</div><div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160;</div><div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;%s%s%s%s%s%s%s%s%s&quot;</span>,</div><div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;            mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a> ? <a class="code" href="../../db/d45/term_8h.html#aa86a4efe2acaee184cf754ccc5248599">ast_term_color</a>(<a class="code" href="../../db/d45/term_8h.html#a82573859711fce56f1aa0a76b18a9b18">COLOR_CYAN</a>, <a class="code" href="../../db/d45/term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>) : <span class="stringliteral">&quot;&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a> ? <span class="stringliteral">&quot; (dynamic)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a11b0efffc76ab7f40399993cb468e46a">ast_term_reset</a>(),</div><div class="line"><a name="l09705"></a><span class="lineno"> 9705</span>&#160;            mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a> ? <a class="code" href="../../db/d45/term_8h.html#aa86a4efe2acaee184cf754ccc5248599">ast_term_color</a>(<a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, <a class="code" href="../../db/d45/term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>) : <span class="stringliteral">&quot;&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">realtime</a> ? <span class="stringliteral">&quot; (realtime)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a11b0efffc76ab7f40399993cb468e46a">ast_term_reset</a>(),</div><div class="line"><a name="l09706"></a><span class="lineno"> 9706</span>&#160;            mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> ? <a class="code" href="../../db/d45/term_8h.html#aa86a4efe2acaee184cf754ccc5248599">ast_term_color</a>(<a class="code" href="../../db/d45/term_8h.html#a928e144dbbe4316dbb854245c7e38de7">COLOR_BROWN</a>, <a class="code" href="../../db/d45/term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>) : <span class="stringliteral">&quot;&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> ? <span class="stringliteral">&quot; (in call)&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a11b0efffc76ab7f40399993cb468e46a">ast_term_reset</a>());</div><div class="line"><a name="l09707"></a><span class="lineno"> 9707</span>&#160;</div><div class="line"><a name="l09708"></a><span class="lineno"> 9708</span>&#160;         <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>) {</div><div class="line"><a name="l09709"></a><span class="lineno"> 9709</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; %s(paused%s%s was %ld secs ago)%s&quot;</span>,</div><div class="line"><a name="l09710"></a><span class="lineno"> 9710</span>&#160;               <a class="code" href="../../db/d45/term_8h.html#aa86a4efe2acaee184cf754ccc5248599">ast_term_color</a>(<a class="code" href="../../db/d45/term_8h.html#a928e144dbbe4316dbb854245c7e38de7">COLOR_BROWN</a>, <a class="code" href="../../db/d45/term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>),</div><div class="line"><a name="l09711"></a><span class="lineno"> 9711</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>) ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;:&quot;</span>,</div><div class="line"><a name="l09712"></a><span class="lineno"> 9712</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>) ? <span class="stringliteral">&quot;&quot;</span> : mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>,</div><div class="line"><a name="l09713"></a><span class="lineno"> 9713</span>&#160;               (<span class="keywordtype">long</span>) (now - mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a>),</div><div class="line"><a name="l09714"></a><span class="lineno"> 9714</span>&#160;               <a class="code" href="../../db/d45/term_8h.html#a11b0efffc76ab7f40399993cb468e46a">ast_term_reset</a>());</div><div class="line"><a name="l09715"></a><span class="lineno"> 9715</span>&#160;         }</div><div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160;</div><div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; (%s%s%s)&quot;</span>,</div><div class="line"><a name="l09718"></a><span class="lineno"> 9718</span>&#160;            <a class="code" href="../../db/d45/term_8h.html#aa86a4efe2acaee184cf754ccc5248599">ast_term_color</a>(</div><div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160;               mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a> || mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> == <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a">AST_DEVICE_UNKNOWN</a> ?</div><div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;                  <a class="code" href="../../db/d45/term_8h.html#ad86358bf19927183dd7b4ae215a29731">COLOR_RED</a> : <a class="code" href="../../db/d45/term_8h.html#afc9149f5de51bd9ac4f5ebbfa153f018">COLOR_GREEN</a>, <a class="code" href="../../db/d45/term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a>),</div><div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;               <a class="code" href="../../da/da2/devicestate_8h.html#ac3a57910a6eb04d12d793fe3df796b8e">ast_devstate2str</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>), <a class="code" href="../../db/d45/term_8h.html#a11b0efffc76ab7f40399993cb468e46a">ast_term_reset</a>());</div><div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160;         <span class="keywordflow">if</span> (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>) {</div><div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; has taken %d calls (last was %ld secs ago)&quot;</span>,</div><div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;               mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>, (<span class="keywordtype">long</span>) (now - mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>));</div><div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot; has taken no calls yet&quot;</span>);</div><div class="line"><a name="l09727"></a><span class="lineno"> 9727</span>&#160;         }</div><div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out));</div><div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;      }</div><div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;   }</div><div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160;   <span class="keywordflow">if</span> (!q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>) {</div><div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <span class="stringliteral">&quot;   No Callers&quot;</span>);</div><div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe;</div><div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = 1;</div><div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160;</div><div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <span class="stringliteral">&quot;   Callers: &quot;</span>);</div><div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;      <span class="keywordflow">for</span> (qe = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>; qe; qe = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>) {</div><div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <span class="stringliteral">&quot;      %d. %s (wait: %ld:%2.2ld, prio: %d)&quot;</span>,</div><div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;            pos++, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), (<span class="keywordtype">long</span>) (now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) / 60,</div><div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160;            (<span class="keywordtype">long</span>) (now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) % 60, qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a>);</div><div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out));</div><div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;      }</div><div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160;   }</div><div class="line"><a name="l09747"></a><span class="lineno"> 9747</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <span class="stringliteral">&quot;&quot;</span>); <span class="comment">/* blank line between entries */</span></div><div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160;}</div><div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;</div><div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;<a class="code" href="../../da/dfb/app__queue_8c.html#a936023f0e0bee9641dac365079c9cd00">AO2_STRING_FIELD_SORT_FN</a>(<a class="code" href="../../df/db5/structcall__queue.html">call_queue</a>, <a class="code" href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160;<span class="comment"> * \brief Show queue(s) status and statistics</span></div><div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;<span class="comment"> * List the queues strategy, calls processed, members logged in,</span></div><div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160;<span class="comment"> * other queue statistics such as avg hold time.</span></div><div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l09758"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#afafcdeab5f3a75ed0670d4dac7020f03"> 9758</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#afafcdeab5f3a75ed0670d4dac7020f03">__queues_show</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keywordtype">int</span> fd, <span class="keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> *argv)</div><div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160;{</div><div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(512);</div><div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *sorted_queues;</div><div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160;</div><div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160;   <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l09766"></a><span class="lineno"> 9766</span>&#160;</div><div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;   <span class="keywordflow">if</span> (argc != 2 &amp;&amp; argc != 3) {</div><div class="line"><a name="l09768"></a><span class="lineno"> 9768</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l09769"></a><span class="lineno"> 9769</span>&#160;   }</div><div class="line"><a name="l09770"></a><span class="lineno"> 9770</span>&#160;</div><div class="line"><a name="l09771"></a><span class="lineno"> 9771</span>&#160;   <span class="keywordflow">if</span> (argc == 3) { <span class="comment">/* specific queue */</span></div><div class="line"><a name="l09772"></a><span class="lineno"> 9772</span>&#160;      <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(argv[2]))) {</div><div class="line"><a name="l09773"></a><span class="lineno"> 9773</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l09774"></a><span class="lineno"> 9774</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a55c36f2f3daa5a20c2b2e8861112ac35">print_queue</a>(s, fd, q);</div><div class="line"><a name="l09775"></a><span class="lineno"> 9775</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l09776"></a><span class="lineno"> 9776</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab">queue_unref</a>(q);</div><div class="line"><a name="l09777"></a><span class="lineno"> 9777</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09778"></a><span class="lineno"> 9778</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <span class="stringliteral">&quot;No such queue: %s.&quot;</span>, argv[2]);</div><div class="line"><a name="l09779"></a><span class="lineno"> 9779</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out));</div><div class="line"><a name="l09780"></a><span class="lineno"> 9780</span>&#160;      }</div><div class="line"><a name="l09781"></a><span class="lineno"> 9781</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l09782"></a><span class="lineno"> 9782</span>&#160;   }</div><div class="line"><a name="l09783"></a><span class="lineno"> 9783</span>&#160;</div><div class="line"><a name="l09784"></a><span class="lineno"> 9784</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a910f835a41772603d33e200c956549ff">ast_check_realtime</a>(<span class="stringliteral">&quot;queues&quot;</span>)) {</div><div class="line"><a name="l09785"></a><span class="lineno"> 9785</span>&#160;      <span class="comment">/* This block is to find any queues which are defined in realtime but</span></div><div class="line"><a name="l09786"></a><span class="lineno"> 9786</span>&#160;<span class="comment">       * which have not yet been added to the in-core container</span></div><div class="line"><a name="l09787"></a><span class="lineno"> 9787</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09788"></a><span class="lineno"> 9788</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a29ff8cd717c0c0bac60abbd827fec409">ast_load_realtime_multientry</a>(<span class="stringliteral">&quot;queues&quot;</span>, <span class="stringliteral">&quot;name LIKE&quot;</span>, <span class="stringliteral">&quot;%&quot;</span>, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l09789"></a><span class="lineno"> 9789</span>&#160;      <span class="keywordflow">if</span> (cfg) {</div><div class="line"><a name="l09790"></a><span class="lineno"> 9790</span>&#160;         <span class="keywordtype">char</span> *category = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09791"></a><span class="lineno"> 9791</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(cfg, category))) {</div><div class="line"><a name="l09792"></a><span class="lineno"> 9792</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(cfg, category, <span class="stringliteral">&quot;name&quot;</span>);</div><div class="line"><a name="l09793"></a><span class="lineno"> 9793</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) {</div><div class="line"><a name="l09794"></a><span class="lineno"> 9794</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Ignoring realtime queue with a NULL or empty &#39;name.&#39;\n&quot;</span>);</div><div class="line"><a name="l09795"></a><span class="lineno"> 9795</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09796"></a><span class="lineno"> 9796</span>&#160;            }</div><div class="line"><a name="l09797"></a><span class="lineno"> 9797</span>&#160;            <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queuename))) {</div><div class="line"><a name="l09798"></a><span class="lineno"> 9798</span>&#160;               <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with temporary pointer&quot;</span>);</div><div class="line"><a name="l09799"></a><span class="lineno"> 9799</span>&#160;            }</div><div class="line"><a name="l09800"></a><span class="lineno"> 9800</span>&#160;         }</div><div class="line"><a name="l09801"></a><span class="lineno"> 9801</span>&#160;         <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l09802"></a><span class="lineno"> 9802</span>&#160;      }</div><div class="line"><a name="l09803"></a><span class="lineno"> 9803</span>&#160;   }</div><div class="line"><a name="l09804"></a><span class="lineno"> 9804</span>&#160;</div><div class="line"><a name="l09805"></a><span class="lineno"> 9805</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l09806"></a><span class="lineno"> 9806</span>&#160;<span class="comment">    * Snapping a copy of the container prevents having to lock both the queues container</span></div><div class="line"><a name="l09807"></a><span class="lineno"> 9807</span>&#160;<span class="comment">    * and the queue itself at the same time.  It also allows us to sort the entries.</span></div><div class="line"><a name="l09808"></a><span class="lineno"> 9808</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l09809"></a><span class="lineno"> 9809</span>&#160;   sorted_queues = <a class="code" href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0, call_queue_sort_fn, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09810"></a><span class="lineno"> 9810</span>&#160;   <span class="keywordflow">if</span> (!sorted_queues) {</div><div class="line"><a name="l09811"></a><span class="lineno"> 9811</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l09812"></a><span class="lineno"> 9812</span>&#160;   }</div><div class="line"><a name="l09813"></a><span class="lineno"> 9813</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#a04bf2beaf5811f6b95768e42fb95d9a5">ao2_container_dup</a>(sorted_queues, queues, 0)) {</div><div class="line"><a name="l09814"></a><span class="lineno"> 9814</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sorted_queues, -1);</div><div class="line"><a name="l09815"></a><span class="lineno"> 9815</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l09816"></a><span class="lineno"> 9816</span>&#160;   }</div><div class="line"><a name="l09817"></a><span class="lineno"> 9817</span>&#160;</div><div class="line"><a name="l09818"></a><span class="lineno"> 9818</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l09819"></a><span class="lineno"> 9819</span>&#160;<span class="comment">    * No need to lock the container since it&#39;s temporary and static.</span></div><div class="line"><a name="l09820"></a><span class="lineno"> 9820</span>&#160;<span class="comment">    * We also unlink the entries as we use them so the container is</span></div><div class="line"><a name="l09821"></a><span class="lineno"> 9821</span>&#160;<span class="comment">    * empty when the iterator finishes.  We can then just unref the container.</span></div><div class="line"><a name="l09822"></a><span class="lineno"> 9822</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l09823"></a><span class="lineno"> 9823</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sorted_queues, <a class="code" href="../../d5/da5/astobj2_8h.html#a7b5de2aa80f528d3dc554caadb8dc6aba42e2c6aadc44e4259a058a6675b7e7e4">AO2_ITERATOR_DONTLOCK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a7b5de2aa80f528d3dc554caadb8dc6aba3a8f36e68b2b6873804d167724e1891c">AO2_ITERATOR_UNLINK</a>);</div><div class="line"><a name="l09824"></a><span class="lineno"> 9824</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l09825"></a><span class="lineno"> 9825</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *realtime_queue = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09826"></a><span class="lineno"> 9826</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l09827"></a><span class="lineno"> 9827</span>&#160;      <span class="comment">/* This check is to make sure we don&#39;t print information for realtime</span></div><div class="line"><a name="l09828"></a><span class="lineno"> 9828</span>&#160;<span class="comment">       * queues which have been deleted from realtime but which have not yet</span></div><div class="line"><a name="l09829"></a><span class="lineno"> 9829</span>&#160;<span class="comment">       * been deleted from the in-core container. Only do this if we&#39;re not</span></div><div class="line"><a name="l09830"></a><span class="lineno"> 9830</span>&#160;<span class="comment">       * looking for a specific queue.</span></div><div class="line"><a name="l09831"></a><span class="lineno"> 9831</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09832"></a><span class="lineno"> 9832</span>&#160;      <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">realtime</a>) {</div><div class="line"><a name="l09833"></a><span class="lineno"> 9833</span>&#160;         realtime_queue = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l09834"></a><span class="lineno"> 9834</span>&#160;         <span class="keywordflow">if</span> (!realtime_queue) {</div><div class="line"><a name="l09835"></a><span class="lineno"> 9835</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l09836"></a><span class="lineno"> 9836</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l09837"></a><span class="lineno"> 9837</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09838"></a><span class="lineno"> 9838</span>&#160;         }</div><div class="line"><a name="l09839"></a><span class="lineno"> 9839</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(realtime_queue, <span class="stringliteral">&quot;Queue is already in memory&quot;</span>);</div><div class="line"><a name="l09840"></a><span class="lineno"> 9840</span>&#160;      }</div><div class="line"><a name="l09841"></a><span class="lineno"> 9841</span>&#160;</div><div class="line"><a name="l09842"></a><span class="lineno"> 9842</span>&#160;      found = 1;</div><div class="line"><a name="l09843"></a><span class="lineno"> 9843</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a55c36f2f3daa5a20c2b2e8861112ac35">print_queue</a>(s, fd, q);</div><div class="line"><a name="l09844"></a><span class="lineno"> 9844</span>&#160;</div><div class="line"><a name="l09845"></a><span class="lineno"> 9845</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l09846"></a><span class="lineno"> 9846</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>); <span class="comment">/* Unref the iterator&#39;s reference */</span></div><div class="line"><a name="l09847"></a><span class="lineno"> 9847</span>&#160;   }</div><div class="line"><a name="l09848"></a><span class="lineno"> 9848</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l09849"></a><span class="lineno"> 9849</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sorted_queues, -1);</div><div class="line"><a name="l09850"></a><span class="lineno"> 9850</span>&#160;   <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l09851"></a><span class="lineno"> 9851</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <span class="stringliteral">&quot;No queues.&quot;</span>);</div><div class="line"><a name="l09852"></a><span class="lineno"> 9852</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a>(s, fd, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out));</div><div class="line"><a name="l09853"></a><span class="lineno"> 9853</span>&#160;   }</div><div class="line"><a name="l09854"></a><span class="lineno"> 9854</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l09855"></a><span class="lineno"> 9855</span>&#160;}</div><div class="line"><a name="l09856"></a><span class="lineno"> 9856</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09857"></a><span class="lineno"> 9857</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l09858"></a><span class="lineno"> 9858</span>&#160;<span class="comment"> * \brief Check if a given word is in a space-delimited list</span></div><div class="line"><a name="l09859"></a><span class="lineno"> 9859</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09860"></a><span class="lineno"> 9860</span>&#160;<span class="comment"> * \param list Space delimited list of words</span></div><div class="line"><a name="l09861"></a><span class="lineno"> 9861</span>&#160;<span class="comment"> * \param word The word used to search the list</span></div><div class="line"><a name="l09862"></a><span class="lineno"> 9862</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09863"></a><span class="lineno"> 9863</span>&#160;<span class="comment"> * \note This function will not return 1 if the word is at the very end of the</span></div><div class="line"><a name="l09864"></a><span class="lineno"> 9864</span>&#160;<span class="comment"> * list (followed immediately by a \0, not a space) since it is used for</span></div><div class="line"><a name="l09865"></a><span class="lineno"> 9865</span>&#160;<span class="comment"> * checking tab-completion and a word at the end is still being tab-completed.</span></div><div class="line"><a name="l09866"></a><span class="lineno"> 9866</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09867"></a><span class="lineno"> 9867</span>&#160;<span class="comment"> * \return Returns 1 if the word is found</span></div><div class="line"><a name="l09868"></a><span class="lineno"> 9868</span>&#160;<span class="comment"> * \return Returns 0 if the word is not found</span></div><div class="line"><a name="l09869"></a><span class="lineno"> 9869</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l09870"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af01909aa0583ac7df7e17b9c1f46c3c4"> 9870</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af01909aa0583ac7df7e17b9c1f46c3c4">word_in_list</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/db5/structcall__queue.html#abfb829c4f5dfe0e57f78f6b1da91ca2d">list</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>) {</div><div class="line"><a name="l09871"></a><span class="lineno"> 9871</span>&#160;   <span class="keywordtype">int</span> list_len, word_len = strlen(word);</div><div class="line"><a name="l09872"></a><span class="lineno"> 9872</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *find, *end_find, *end_list;</div><div class="line"><a name="l09873"></a><span class="lineno"> 9873</span>&#160;</div><div class="line"><a name="l09874"></a><span class="lineno"> 9874</span>&#160;   <span class="comment">/* strip whitespace from front */</span></div><div class="line"><a name="l09875"></a><span class="lineno"> 9875</span>&#160;   <span class="keywordflow">while</span>(isspace(*list)) {</div><div class="line"><a name="l09876"></a><span class="lineno"> 9876</span>&#160;      list++;</div><div class="line"><a name="l09877"></a><span class="lineno"> 9877</span>&#160;   }</div><div class="line"><a name="l09878"></a><span class="lineno"> 9878</span>&#160;</div><div class="line"><a name="l09879"></a><span class="lineno"> 9879</span>&#160;   <span class="keywordflow">while</span>((find = strstr(list, word))) {</div><div class="line"><a name="l09880"></a><span class="lineno"> 9880</span>&#160;      <span class="comment">/* beginning of find starts inside another word? */</span></div><div class="line"><a name="l09881"></a><span class="lineno"> 9881</span>&#160;      <span class="keywordflow">if</span> (find != list &amp;&amp; *(find - 1) != <span class="charliteral">&#39; &#39;</span>) {</div><div class="line"><a name="l09882"></a><span class="lineno"> 9882</span>&#160;         list = find;</div><div class="line"><a name="l09883"></a><span class="lineno"> 9883</span>&#160;         <span class="comment">/* strip word from front */</span></div><div class="line"><a name="l09884"></a><span class="lineno"> 9884</span>&#160;         <span class="keywordflow">while</span>(!isspace(*list) &amp;&amp; *list != <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l09885"></a><span class="lineno"> 9885</span>&#160;            list++;</div><div class="line"><a name="l09886"></a><span class="lineno"> 9886</span>&#160;         }</div><div class="line"><a name="l09887"></a><span class="lineno"> 9887</span>&#160;         <span class="comment">/* strip whitespace from front */</span></div><div class="line"><a name="l09888"></a><span class="lineno"> 9888</span>&#160;         <span class="keywordflow">while</span>(isspace(*list)) {</div><div class="line"><a name="l09889"></a><span class="lineno"> 9889</span>&#160;            list++;</div><div class="line"><a name="l09890"></a><span class="lineno"> 9890</span>&#160;         }</div><div class="line"><a name="l09891"></a><span class="lineno"> 9891</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09892"></a><span class="lineno"> 9892</span>&#160;      }</div><div class="line"><a name="l09893"></a><span class="lineno"> 9893</span>&#160;</div><div class="line"><a name="l09894"></a><span class="lineno"> 9894</span>&#160;      <span class="comment">/* end of find ends inside another word or at very end of list? */</span></div><div class="line"><a name="l09895"></a><span class="lineno"> 9895</span>&#160;      list_len = strlen(list);</div><div class="line"><a name="l09896"></a><span class="lineno"> 9896</span>&#160;      end_find = find + word_len;</div><div class="line"><a name="l09897"></a><span class="lineno"> 9897</span>&#160;      end_list = list + list_len;</div><div class="line"><a name="l09898"></a><span class="lineno"> 9898</span>&#160;      <span class="keywordflow">if</span> (end_find == end_list || *end_find != <span class="charliteral">&#39; &#39;</span>) {</div><div class="line"><a name="l09899"></a><span class="lineno"> 9899</span>&#160;         list = find;</div><div class="line"><a name="l09900"></a><span class="lineno"> 9900</span>&#160;         <span class="comment">/* strip word from front */</span></div><div class="line"><a name="l09901"></a><span class="lineno"> 9901</span>&#160;         <span class="keywordflow">while</span>(!isspace(*list) &amp;&amp; *list != <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l09902"></a><span class="lineno"> 9902</span>&#160;            list++;</div><div class="line"><a name="l09903"></a><span class="lineno"> 9903</span>&#160;         }</div><div class="line"><a name="l09904"></a><span class="lineno"> 9904</span>&#160;         <span class="comment">/* strip whitespace from front */</span></div><div class="line"><a name="l09905"></a><span class="lineno"> 9905</span>&#160;         <span class="keywordflow">while</span>(isspace(*list)) {</div><div class="line"><a name="l09906"></a><span class="lineno"> 9906</span>&#160;            list++;</div><div class="line"><a name="l09907"></a><span class="lineno"> 9907</span>&#160;         }</div><div class="line"><a name="l09908"></a><span class="lineno"> 9908</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09909"></a><span class="lineno"> 9909</span>&#160;      }</div><div class="line"><a name="l09910"></a><span class="lineno"> 9910</span>&#160;</div><div class="line"><a name="l09911"></a><span class="lineno"> 9911</span>&#160;      <span class="comment">/* terminating conditions satisfied, word at beginning or separated by &#39; &#39; */</span></div><div class="line"><a name="l09912"></a><span class="lineno"> 9912</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l09913"></a><span class="lineno"> 9913</span>&#160;   }</div><div class="line"><a name="l09914"></a><span class="lineno"> 9914</span>&#160;</div><div class="line"><a name="l09915"></a><span class="lineno"> 9915</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09916"></a><span class="lineno"> 9916</span>&#160;}</div><div class="line"><a name="l09917"></a><span class="lineno"> 9917</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09918"></a><span class="lineno"> 9918</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l09919"></a><span class="lineno"> 9919</span>&#160;<span class="comment"> * \brief Check if a given word is in a space-delimited list</span></div><div class="line"><a name="l09920"></a><span class="lineno"> 9920</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09921"></a><span class="lineno"> 9921</span>&#160;<span class="comment"> * \param line The line as typed not including the current word being completed</span></div><div class="line"><a name="l09922"></a><span class="lineno"> 9922</span>&#160;<span class="comment"> * \param word The word currently being completed</span></div><div class="line"><a name="l09923"></a><span class="lineno"> 9923</span>&#160;<span class="comment"> * \param pos The number of completed words in line</span></div><div class="line"><a name="l09924"></a><span class="lineno"> 9924</span>&#160;<span class="comment"> * \param state The nth desired completion option</span></div><div class="line"><a name="l09925"></a><span class="lineno"> 9925</span>&#160;<span class="comment"> * \param word_list_offset Offset into the line where the list of queues begins.  If non-zero, queues in the list will not be offered for further completion.</span></div><div class="line"><a name="l09926"></a><span class="lineno"> 9926</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09927"></a><span class="lineno"> 9927</span>&#160;<span class="comment"> * \return Returns the queue tab-completion for the given word and state</span></div><div class="line"><a name="l09928"></a><span class="lineno"> 9928</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l09929"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f"> 9929</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>, ptrdiff_t word_list_offset)</div><div class="line"><a name="l09930"></a><span class="lineno"> 9930</span>&#160;{</div><div class="line"><a name="l09931"></a><span class="lineno"> 9931</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l09932"></a><span class="lineno"> 9932</span>&#160;   <span class="keywordtype">char</span> *ret = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09933"></a><span class="lineno"> 9933</span>&#160;   <span class="keywordtype">int</span> which = 0;</div><div class="line"><a name="l09934"></a><span class="lineno"> 9934</span>&#160;   <span class="keywordtype">int</span> wordlen = strlen(word);</div><div class="line"><a name="l09935"></a><span class="lineno"> 9935</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l09936"></a><span class="lineno"> 9936</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *word_list = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09937"></a><span class="lineno"> 9937</span>&#160;</div><div class="line"><a name="l09938"></a><span class="lineno"> 9938</span>&#160;   <span class="comment">/* for certain commands, already completed items should be left out of</span></div><div class="line"><a name="l09939"></a><span class="lineno"> 9939</span>&#160;<span class="comment">    * the list */</span></div><div class="line"><a name="l09940"></a><span class="lineno"> 9940</span>&#160;   <span class="keywordflow">if</span> (word_list_offset &amp;&amp; strlen(line) &gt;= word_list_offset) {</div><div class="line"><a name="l09941"></a><span class="lineno"> 9941</span>&#160;      word_list = line + word_list_offset;</div><div class="line"><a name="l09942"></a><span class="lineno"> 9942</span>&#160;   }</div><div class="line"><a name="l09943"></a><span class="lineno"> 9943</span>&#160;</div><div class="line"><a name="l09944"></a><span class="lineno"> 9944</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l09945"></a><span class="lineno"> 9945</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l09946"></a><span class="lineno"> 9946</span>&#160;      <span class="keywordflow">if</span> (!strncasecmp(word, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, wordlen) &amp;&amp; ++which &gt; state</div><div class="line"><a name="l09947"></a><span class="lineno"> 9947</span>&#160;         &amp;&amp; (!word_list_offset || !<a class="code" href="../../da/dfb/app__queue_8c.html#af01909aa0583ac7df7e17b9c1f46c3c4">word_in_list</a>(word_list, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>))) {</div><div class="line"><a name="l09948"></a><span class="lineno"> 9948</span>&#160;         ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l09949"></a><span class="lineno"> 9949</span>&#160;         <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l09950"></a><span class="lineno"> 9950</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l09951"></a><span class="lineno"> 9951</span>&#160;      }</div><div class="line"><a name="l09952"></a><span class="lineno"> 9952</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l09953"></a><span class="lineno"> 9953</span>&#160;   }</div><div class="line"><a name="l09954"></a><span class="lineno"> 9954</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l09955"></a><span class="lineno"> 9955</span>&#160;</div><div class="line"><a name="l09956"></a><span class="lineno"> 9956</span>&#160;   <span class="comment">/* Pretend &quot;rules&quot; is at the end of the queues list in certain</span></div><div class="line"><a name="l09957"></a><span class="lineno"> 9957</span>&#160;<span class="comment">    * circumstances since it is an alternate command that should be</span></div><div class="line"><a name="l09958"></a><span class="lineno"> 9958</span>&#160;<span class="comment">    * tab-completable for &quot;queue show&quot; */</span></div><div class="line"><a name="l09959"></a><span class="lineno"> 9959</span>&#160;   <span class="keywordflow">if</span> (!ret &amp;&amp; which == state &amp;&amp; !wordlen &amp;&amp; !strncmp(<span class="stringliteral">&quot;queue show&quot;</span>, line, 10)) {</div><div class="line"><a name="l09960"></a><span class="lineno"> 9960</span>&#160;      ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;rules&quot;</span>);</div><div class="line"><a name="l09961"></a><span class="lineno"> 9961</span>&#160;   }</div><div class="line"><a name="l09962"></a><span class="lineno"> 9962</span>&#160;</div><div class="line"><a name="l09963"></a><span class="lineno"> 9963</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l09964"></a><span class="lineno"> 9964</span>&#160;}</div><div class="line"><a name="l09965"></a><span class="lineno"> 9965</span>&#160;</div><div class="line"><a name="l09966"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5b08d861378519df1563080cc0e22fd4"> 9966</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5b08d861378519df1563080cc0e22fd4">complete_queue_show</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l09967"></a><span class="lineno"> 9967</span>&#160;{</div><div class="line"><a name="l09968"></a><span class="lineno"> 9968</span>&#160;   <span class="keywordflow">if</span> (pos == 2) {</div><div class="line"><a name="l09969"></a><span class="lineno"> 9969</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(line, word, pos, state, 0);</div><div class="line"><a name="l09970"></a><span class="lineno"> 9970</span>&#160;   }</div><div class="line"><a name="l09971"></a><span class="lineno"> 9971</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09972"></a><span class="lineno"> 9972</span>&#160;}</div><div class="line"><a name="l09973"></a><span class="lineno"> 9973</span>&#160;</div><div class="line"><a name="l09974"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8f11ecb2ece22635477ca2ee913b39e3"> 9974</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a8f11ecb2ece22635477ca2ee913b39e3">queue_show</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l09975"></a><span class="lineno"> 9975</span>&#160;{</div><div class="line"><a name="l09976"></a><span class="lineno"> 9976</span>&#160;   <span class="keywordflow">switch</span> ( cmd ) {</div><div class="line"><a name="l09977"></a><span class="lineno"> 9977</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l09978"></a><span class="lineno"> 9978</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue show&quot;</span>;</div><div class="line"><a name="l09979"></a><span class="lineno"> 9979</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l09980"></a><span class="lineno"> 9980</span>&#160;         <span class="stringliteral">&quot;Usage: queue show\n&quot;</span></div><div class="line"><a name="l09981"></a><span class="lineno"> 9981</span>&#160;         <span class="stringliteral">&quot;       Provides summary information on a specified queue.\n&quot;</span>;</div><div class="line"><a name="l09982"></a><span class="lineno"> 9982</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09983"></a><span class="lineno"> 9983</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l09984"></a><span class="lineno"> 9984</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a5b08d861378519df1563080cc0e22fd4">complete_queue_show</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l09985"></a><span class="lineno"> 9985</span>&#160;   }</div><div class="line"><a name="l09986"></a><span class="lineno"> 9986</span>&#160;</div><div class="line"><a name="l09987"></a><span class="lineno"> 9987</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#afafcdeab5f3a75ed0670d4dac7020f03">__queues_show</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>);</div><div class="line"><a name="l09988"></a><span class="lineno"> 9988</span>&#160;}</div><div class="line"><a name="l09989"></a><span class="lineno"> 9989</span>&#160;</div><div class="line"><a name="l09990"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a5b0161cb9388c7e8886b1b35a9b54fdc"> 9990</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a5b0161cb9388c7e8886b1b35a9b54fdc">manager_queue_rule_show</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l09991"></a><span class="lineno"> 9991</span>&#160;{</div><div class="line"><a name="l09992"></a><span class="lineno"> 9992</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d3/d61/structrule.html">rule</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Rule&quot;</span>);</div><div class="line"><a name="l09993"></a><span class="lineno"> 9993</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l09994"></a><span class="lineno"> 9994</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> *rl_iter;</div><div class="line"><a name="l09995"></a><span class="lineno"> 9995</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *pr_iter;</div><div class="line"><a name="l09996"></a><span class="lineno"> 9996</span>&#160;</div><div class="line"><a name="l09997"></a><span class="lineno"> 9997</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n&quot;</span>);</div><div class="line"><a name="l09998"></a><span class="lineno"> 9998</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l09999"></a><span class="lineno"> 9999</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l10000"></a><span class="lineno">10000</span>&#160;   }</div><div class="line"><a name="l10001"></a><span class="lineno">10001</span>&#160;</div><div class="line"><a name="l10002"></a><span class="lineno">10002</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l10003"></a><span class="lineno">10003</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, rl_iter, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>) {</div><div class="line"><a name="l10004"></a><span class="lineno">10004</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(rule) || !strcasecmp(rule, rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>)) {</div><div class="line"><a name="l10005"></a><span class="lineno">10005</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;RuleList: %s\r\n&quot;</span>, rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l10006"></a><span class="lineno">10006</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, pr_iter, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>) {</div><div class="line"><a name="l10007"></a><span class="lineno">10007</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Rule: %d,%s%d,%s%d\r\n&quot;</span>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> &amp;&amp; pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a> &gt;= 0 ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a> &amp;&amp; pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a> &gt;= 0 ? <span class="stringliteral">&quot;+&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a> );</div><div class="line"><a name="l10008"></a><span class="lineno">10008</span>&#160;         }</div><div class="line"><a name="l10009"></a><span class="lineno">10009</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(rule)) {</div><div class="line"><a name="l10010"></a><span class="lineno">10010</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l10011"></a><span class="lineno">10011</span>&#160;         }</div><div class="line"><a name="l10012"></a><span class="lineno">10012</span>&#160;      }</div><div class="line"><a name="l10013"></a><span class="lineno">10013</span>&#160;   }</div><div class="line"><a name="l10014"></a><span class="lineno">10014</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l10015"></a><span class="lineno">10015</span>&#160;</div><div class="line"><a name="l10016"></a><span class="lineno">10016</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l10017"></a><span class="lineno">10017</span>&#160;<span class="comment">    * Two blank lines instead of one because the Response and</span></div><div class="line"><a name="l10018"></a><span class="lineno">10018</span>&#160;<span class="comment">    * ActionID headers used to not be present.</span></div><div class="line"><a name="l10019"></a><span class="lineno">10019</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l10020"></a><span class="lineno">10020</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\r\n\r\n&quot;</span>);</div><div class="line"><a name="l10021"></a><span class="lineno">10021</span>&#160;</div><div class="line"><a name="l10022"></a><span class="lineno">10022</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a>;</div><div class="line"><a name="l10023"></a><span class="lineno">10023</span>&#160;}</div><div class="line"><a name="l10024"></a><span class="lineno">10024</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10025"></a><span class="lineno">10025</span>&#160;<span class="comment">/*! \brief Summary of queue info via the AMI */</span></div><div class="line"><a name="l10026"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ace5e218ac5b4850ddcf7cb1a9866da6b">10026</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ace5e218ac5b4850ddcf7cb1a9866da6b">manager_queues_summary</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10027"></a><span class="lineno">10027</span>&#160;{</div><div class="line"><a name="l10028"></a><span class="lineno">10028</span>&#160;   time_t now;</div><div class="line"><a name="l10029"></a><span class="lineno">10029</span>&#160;   <span class="keywordtype">int</span> qmemcount = 0;</div><div class="line"><a name="l10030"></a><span class="lineno">10030</span>&#160;   <span class="keywordtype">int</span> qmemavail = 0;</div><div class="line"><a name="l10031"></a><span class="lineno">10031</span>&#160;   <span class="keywordtype">int</span> qchancount = 0;</div><div class="line"><a name="l10032"></a><span class="lineno">10032</span>&#160;   <span class="keywordtype">int</span> qlongestholdtime = 0;</div><div class="line"><a name="l10033"></a><span class="lineno">10033</span>&#160;   <span class="keywordtype">int</span> qsummaries = 0;</div><div class="line"><a name="l10034"></a><span class="lineno">10034</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l10035"></a><span class="lineno">10035</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuefilter = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10036"></a><span class="lineno">10036</span>&#160;   <span class="keywordtype">char</span> idText[256];</div><div class="line"><a name="l10037"></a><span class="lineno">10037</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l10038"></a><span class="lineno">10038</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe;</div><div class="line"><a name="l10039"></a><span class="lineno">10039</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l10040"></a><span class="lineno">10040</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l10041"></a><span class="lineno">10041</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l10042"></a><span class="lineno">10042</span>&#160;</div><div class="line"><a name="l10043"></a><span class="lineno">10043</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Queue summary will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l10044"></a><span class="lineno">10044</span>&#160;   time(&amp;now);</div><div class="line"><a name="l10045"></a><span class="lineno">10045</span>&#160;   idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l10046"></a><span class="lineno">10046</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l10047"></a><span class="lineno">10047</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l10048"></a><span class="lineno">10048</span>&#160;   }</div><div class="line"><a name="l10049"></a><span class="lineno">10049</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l10050"></a><span class="lineno">10050</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l10051"></a><span class="lineno">10051</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l10052"></a><span class="lineno">10052</span>&#160;</div><div class="line"><a name="l10053"></a><span class="lineno">10053</span>&#160;      <span class="comment">/* List queue properties */</span></div><div class="line"><a name="l10054"></a><span class="lineno">10054</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuefilter) || !strcasecmp(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queuefilter)) {</div><div class="line"><a name="l10055"></a><span class="lineno">10055</span>&#160;         <span class="comment">/* Reset the necessary local variables if no queuefilter is set*/</span></div><div class="line"><a name="l10056"></a><span class="lineno">10056</span>&#160;         qmemcount = 0;</div><div class="line"><a name="l10057"></a><span class="lineno">10057</span>&#160;         qmemavail = 0;</div><div class="line"><a name="l10058"></a><span class="lineno">10058</span>&#160;         qchancount = 0;</div><div class="line"><a name="l10059"></a><span class="lineno">10059</span>&#160;         qlongestholdtime = 0;</div><div class="line"><a name="l10060"></a><span class="lineno">10060</span>&#160;</div><div class="line"><a name="l10061"></a><span class="lineno">10061</span>&#160;         <span class="comment">/* List Queue Members */</span></div><div class="line"><a name="l10062"></a><span class="lineno">10062</span>&#160;         mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l10063"></a><span class="lineno">10063</span>&#160;         <span class="keywordflow">while</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l10064"></a><span class="lineno">10064</span>&#160;            <span class="keywordflow">if</span> ((mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>) &amp;&amp; (mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a> != <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a>)) {</div><div class="line"><a name="l10065"></a><span class="lineno">10065</span>&#160;               ++qmemcount;</div><div class="line"><a name="l10066"></a><span class="lineno">10066</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#ae803d04a5ce0edaf0c49e2be684d9436">member_status_available</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>) &amp;&amp; !mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>) {</div><div class="line"><a name="l10067"></a><span class="lineno">10067</span>&#160;                  ++qmemavail;</div><div class="line"><a name="l10068"></a><span class="lineno">10068</span>&#160;               }</div><div class="line"><a name="l10069"></a><span class="lineno">10069</span>&#160;            }</div><div class="line"><a name="l10070"></a><span class="lineno">10070</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l10071"></a><span class="lineno">10071</span>&#160;         }</div><div class="line"><a name="l10072"></a><span class="lineno">10072</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l10073"></a><span class="lineno">10073</span>&#160;         <span class="keywordflow">for</span> (qe = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>; qe; qe = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>) {</div><div class="line"><a name="l10074"></a><span class="lineno">10074</span>&#160;            <span class="keywordflow">if</span> ((now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>) &gt; qlongestholdtime) {</div><div class="line"><a name="l10075"></a><span class="lineno">10075</span>&#160;               qlongestholdtime = now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>;</div><div class="line"><a name="l10076"></a><span class="lineno">10076</span>&#160;            }</div><div class="line"><a name="l10077"></a><span class="lineno">10077</span>&#160;            ++qchancount;</div><div class="line"><a name="l10078"></a><span class="lineno">10078</span>&#160;         }</div><div class="line"><a name="l10079"></a><span class="lineno">10079</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: QueueSummary\r\n&quot;</span></div><div class="line"><a name="l10080"></a><span class="lineno">10080</span>&#160;            <span class="stringliteral">&quot;Queue: %s\r\n&quot;</span></div><div class="line"><a name="l10081"></a><span class="lineno">10081</span>&#160;            <span class="stringliteral">&quot;LoggedIn: %d\r\n&quot;</span></div><div class="line"><a name="l10082"></a><span class="lineno">10082</span>&#160;            <span class="stringliteral">&quot;Available: %d\r\n&quot;</span></div><div class="line"><a name="l10083"></a><span class="lineno">10083</span>&#160;            <span class="stringliteral">&quot;Callers: %d\r\n&quot;</span></div><div class="line"><a name="l10084"></a><span class="lineno">10084</span>&#160;            <span class="stringliteral">&quot;HoldTime: %d\r\n&quot;</span></div><div class="line"><a name="l10085"></a><span class="lineno">10085</span>&#160;            <span class="stringliteral">&quot;TalkTime: %d\r\n&quot;</span></div><div class="line"><a name="l10086"></a><span class="lineno">10086</span>&#160;            <span class="stringliteral">&quot;LongestHoldTime: %d\r\n&quot;</span></div><div class="line"><a name="l10087"></a><span class="lineno">10087</span>&#160;            <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l10088"></a><span class="lineno">10088</span>&#160;            <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l10089"></a><span class="lineno">10089</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, qmemcount, qmemavail, qchancount, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>, qlongestholdtime, idText);</div><div class="line"><a name="l10090"></a><span class="lineno">10090</span>&#160;         ++qsummaries;</div><div class="line"><a name="l10091"></a><span class="lineno">10091</span>&#160;      }</div><div class="line"><a name="l10092"></a><span class="lineno">10092</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l10093"></a><span class="lineno">10093</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l10094"></a><span class="lineno">10094</span>&#160;   }</div><div class="line"><a name="l10095"></a><span class="lineno">10095</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l10096"></a><span class="lineno">10096</span>&#160;</div><div class="line"><a name="l10097"></a><span class="lineno">10097</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;QueueSummaryComplete&quot;</span>, qsummaries);</div><div class="line"><a name="l10098"></a><span class="lineno">10098</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l10099"></a><span class="lineno">10099</span>&#160;</div><div class="line"><a name="l10100"></a><span class="lineno">10100</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a>;</div><div class="line"><a name="l10101"></a><span class="lineno">10101</span>&#160;}</div><div class="line"><a name="l10102"></a><span class="lineno">10102</span>&#160;<span class="comment"></span></div><div class="line"><a name="l10103"></a><span class="lineno">10103</span>&#160;<span class="comment">/*! \brief Queue status info via AMI */</span></div><div class="line"><a name="l10104"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad2bd8d5629fdba7d86c59b7d72c892a7">10104</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad2bd8d5629fdba7d86c59b7d72c892a7">manager_queues_status</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10105"></a><span class="lineno">10105</span>&#160;{</div><div class="line"><a name="l10106"></a><span class="lineno">10106</span>&#160;   time_t now;</div><div class="line"><a name="l10107"></a><span class="lineno">10107</span>&#160;   <span class="keywordtype">int</span> pos;</div><div class="line"><a name="l10108"></a><span class="lineno">10108</span>&#160;   <span class="keywordtype">int</span> q_items = 0;</div><div class="line"><a name="l10109"></a><span class="lineno">10109</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m,<span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l10110"></a><span class="lineno">10110</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuefilter = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m,<span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10111"></a><span class="lineno">10111</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *memberfilter = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m,<span class="stringliteral">&quot;Member&quot;</span>);</div><div class="line"><a name="l10112"></a><span class="lineno">10112</span>&#160;   <span class="keywordtype">char</span> idText[256];</div><div class="line"><a name="l10113"></a><span class="lineno">10113</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l10114"></a><span class="lineno">10114</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d79/structqueue__ent.html">queue_ent</a> *qe;</div><div class="line"><a name="l10115"></a><span class="lineno">10115</span>&#160;   <span class="keywordtype">float</span> sl = 0;</div><div class="line"><a name="l10116"></a><span class="lineno">10116</span>&#160;   <span class="keywordtype">float</span> sl2 = 0;</div><div class="line"><a name="l10117"></a><span class="lineno">10117</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l10118"></a><span class="lineno">10118</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l10119"></a><span class="lineno">10119</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l10120"></a><span class="lineno">10120</span>&#160;</div><div class="line"><a name="l10121"></a><span class="lineno">10121</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Queue status will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l10122"></a><span class="lineno">10122</span>&#160;   time(&amp;now);</div><div class="line"><a name="l10123"></a><span class="lineno">10123</span>&#160;   idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l10124"></a><span class="lineno">10124</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l10125"></a><span class="lineno">10125</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l10126"></a><span class="lineno">10126</span>&#160;   }</div><div class="line"><a name="l10127"></a><span class="lineno">10127</span>&#160;</div><div class="line"><a name="l10128"></a><span class="lineno">10128</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l10129"></a><span class="lineno">10129</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l10130"></a><span class="lineno">10130</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l10131"></a><span class="lineno">10131</span>&#160;</div><div class="line"><a name="l10132"></a><span class="lineno">10132</span>&#160;      <span class="comment">/* List queue properties */</span></div><div class="line"><a name="l10133"></a><span class="lineno">10133</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuefilter) || !strcasecmp(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, queuefilter)) {</div><div class="line"><a name="l10134"></a><span class="lineno">10134</span>&#160;         sl = ((q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> &gt; 0) ? 100 * ((<span class="keywordtype">float</span>)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a> / (float)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>) : 0);</div><div class="line"><a name="l10135"></a><span class="lineno">10135</span>&#160;         sl2 = (((q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a> + q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>) &gt; 0) ? 100 * (((float)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a9d7f2e93f4bdd39ea6aa5eeaa02f0066">callsabandonedinsl</a> + (<span class="keywordtype">float</span>)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a>) / ((<span class="keywordtype">float</span>)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a> + (float)q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>)) : 0);</div><div class="line"><a name="l10136"></a><span class="lineno">10136</span>&#160;</div><div class="line"><a name="l10137"></a><span class="lineno">10137</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: QueueParams\r\n&quot;</span></div><div class="line"><a name="l10138"></a><span class="lineno">10138</span>&#160;            <span class="stringliteral">&quot;Queue: %s\r\n&quot;</span></div><div class="line"><a name="l10139"></a><span class="lineno">10139</span>&#160;            <span class="stringliteral">&quot;Max: %d\r\n&quot;</span></div><div class="line"><a name="l10140"></a><span class="lineno">10140</span>&#160;            <span class="stringliteral">&quot;Strategy: %s\r\n&quot;</span></div><div class="line"><a name="l10141"></a><span class="lineno">10141</span>&#160;            <span class="stringliteral">&quot;Calls: %d\r\n&quot;</span></div><div class="line"><a name="l10142"></a><span class="lineno">10142</span>&#160;            <span class="stringliteral">&quot;Holdtime: %d\r\n&quot;</span></div><div class="line"><a name="l10143"></a><span class="lineno">10143</span>&#160;            <span class="stringliteral">&quot;TalkTime: %d\r\n&quot;</span></div><div class="line"><a name="l10144"></a><span class="lineno">10144</span>&#160;            <span class="stringliteral">&quot;Completed: %d\r\n&quot;</span></div><div class="line"><a name="l10145"></a><span class="lineno">10145</span>&#160;            <span class="stringliteral">&quot;Abandoned: %d\r\n&quot;</span></div><div class="line"><a name="l10146"></a><span class="lineno">10146</span>&#160;            <span class="stringliteral">&quot;ServiceLevel: %d\r\n&quot;</span></div><div class="line"><a name="l10147"></a><span class="lineno">10147</span>&#160;            <span class="stringliteral">&quot;ServicelevelPerf: %2.1f\r\n&quot;</span></div><div class="line"><a name="l10148"></a><span class="lineno">10148</span>&#160;            <span class="stringliteral">&quot;ServicelevelPerf2: %2.1f\r\n&quot;</span></div><div class="line"><a name="l10149"></a><span class="lineno">10149</span>&#160;            <span class="stringliteral">&quot;Weight: %d\r\n&quot;</span></div><div class="line"><a name="l10150"></a><span class="lineno">10150</span>&#160;            <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l10151"></a><span class="lineno">10151</span>&#160;            <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l10152"></a><span class="lineno">10152</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">maxlen</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a792b5d8a5231db2f05b08bd73d318ea5">int2strat</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">strategy</a>), q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">holdtime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>,</div><div class="line"><a name="l10153"></a><span class="lineno">10153</span>&#160;            q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">servicelevel</a>, sl, sl2, q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">weight</a>, idText);</div><div class="line"><a name="l10154"></a><span class="lineno">10154</span>&#160;         ++q_items;</div><div class="line"><a name="l10155"></a><span class="lineno">10155</span>&#160;</div><div class="line"><a name="l10156"></a><span class="lineno">10156</span>&#160;         <span class="comment">/* List Queue Members */</span></div><div class="line"><a name="l10157"></a><span class="lineno">10157</span>&#160;         mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l10158"></a><span class="lineno">10158</span>&#160;         <span class="keywordflow">while</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l10159"></a><span class="lineno">10159</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(memberfilter) || !strcmp(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, memberfilter) || !strcmp(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, memberfilter)) {</div><div class="line"><a name="l10160"></a><span class="lineno">10160</span>&#160;               <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: QueueMember\r\n&quot;</span></div><div class="line"><a name="l10161"></a><span class="lineno">10161</span>&#160;                  <span class="stringliteral">&quot;Queue: %s\r\n&quot;</span></div><div class="line"><a name="l10162"></a><span class="lineno">10162</span>&#160;                  <span class="stringliteral">&quot;Name: %s\r\n&quot;</span></div><div class="line"><a name="l10163"></a><span class="lineno">10163</span>&#160;                  <span class="stringliteral">&quot;Location: %s\r\n&quot;</span></div><div class="line"><a name="l10164"></a><span class="lineno">10164</span>&#160;                  <span class="stringliteral">&quot;StateInterface: %s\r\n&quot;</span></div><div class="line"><a name="l10165"></a><span class="lineno">10165</span>&#160;                  <span class="stringliteral">&quot;Membership: %s\r\n&quot;</span></div><div class="line"><a name="l10166"></a><span class="lineno">10166</span>&#160;                  <span class="stringliteral">&quot;Penalty: %d\r\n&quot;</span></div><div class="line"><a name="l10167"></a><span class="lineno">10167</span>&#160;                  <span class="stringliteral">&quot;CallsTaken: %d\r\n&quot;</span></div><div class="line"><a name="l10168"></a><span class="lineno">10168</span>&#160;                  <span class="stringliteral">&quot;LastCall: %d\r\n&quot;</span></div><div class="line"><a name="l10169"></a><span class="lineno">10169</span>&#160;                  <span class="stringliteral">&quot;LastPause: %d\r\n&quot;</span></div><div class="line"><a name="l10170"></a><span class="lineno">10170</span>&#160;                  <span class="stringliteral">&quot;InCall: %d\r\n&quot;</span></div><div class="line"><a name="l10171"></a><span class="lineno">10171</span>&#160;                  <span class="stringliteral">&quot;Status: %d\r\n&quot;</span></div><div class="line"><a name="l10172"></a><span class="lineno">10172</span>&#160;                  <span class="stringliteral">&quot;Paused: %d\r\n&quot;</span></div><div class="line"><a name="l10173"></a><span class="lineno">10173</span>&#160;                  <span class="stringliteral">&quot;PausedReason: %s\r\n&quot;</span></div><div class="line"><a name="l10174"></a><span class="lineno">10174</span>&#160;                  <span class="stringliteral">&quot;Wrapuptime: %d\r\n&quot;</span></div><div class="line"><a name="l10175"></a><span class="lineno">10175</span>&#160;                  <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l10176"></a><span class="lineno">10176</span>&#160;                  <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l10177"></a><span class="lineno">10177</span>&#160;                  q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">state_interface</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">dynamic</a> ? <span class="stringliteral">&quot;dynamic&quot;</span> : <span class="stringliteral">&quot;static&quot;</span>,</div><div class="line"><a name="l10178"></a><span class="lineno">10178</span>&#160;                  mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">penalty</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>, (<span class="keywordtype">int</span>)mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>, (<span class="keywordtype">int</span>)mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">lastpause</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">starttime</a> ? 1 : 0, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">status</a>,</div><div class="line"><a name="l10179"></a><span class="lineno">10179</span>&#160;                  mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">paused</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">reason_paused</a>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">wrapuptime</a>, idText);</div><div class="line"><a name="l10180"></a><span class="lineno">10180</span>&#160;               ++q_items;</div><div class="line"><a name="l10181"></a><span class="lineno">10181</span>&#160;            }</div><div class="line"><a name="l10182"></a><span class="lineno">10182</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l10183"></a><span class="lineno">10183</span>&#160;         }</div><div class="line"><a name="l10184"></a><span class="lineno">10184</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l10185"></a><span class="lineno">10185</span>&#160;</div><div class="line"><a name="l10186"></a><span class="lineno">10186</span>&#160;         <span class="comment">/* List Queue Entries */</span></div><div class="line"><a name="l10187"></a><span class="lineno">10187</span>&#160;         pos = 1;</div><div class="line"><a name="l10188"></a><span class="lineno">10188</span>&#160;         <span class="keywordflow">for</span> (qe = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">head</a>; qe; qe = qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">next</a>) {</div><div class="line"><a name="l10189"></a><span class="lineno">10189</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: QueueEntry\r\n&quot;</span></div><div class="line"><a name="l10190"></a><span class="lineno">10190</span>&#160;               <span class="stringliteral">&quot;Queue: %s\r\n&quot;</span></div><div class="line"><a name="l10191"></a><span class="lineno">10191</span>&#160;               <span class="stringliteral">&quot;Position: %d\r\n&quot;</span></div><div class="line"><a name="l10192"></a><span class="lineno">10192</span>&#160;               <span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l10193"></a><span class="lineno">10193</span>&#160;               <span class="stringliteral">&quot;Uniqueid: %s\r\n&quot;</span></div><div class="line"><a name="l10194"></a><span class="lineno">10194</span>&#160;               <span class="stringliteral">&quot;CallerIDNum: %s\r\n&quot;</span></div><div class="line"><a name="l10195"></a><span class="lineno">10195</span>&#160;               <span class="stringliteral">&quot;CallerIDName: %s\r\n&quot;</span></div><div class="line"><a name="l10196"></a><span class="lineno">10196</span>&#160;               <span class="stringliteral">&quot;ConnectedLineNum: %s\r\n&quot;</span></div><div class="line"><a name="l10197"></a><span class="lineno">10197</span>&#160;               <span class="stringliteral">&quot;ConnectedLineName: %s\r\n&quot;</span></div><div class="line"><a name="l10198"></a><span class="lineno">10198</span>&#160;               <span class="stringliteral">&quot;Wait: %ld\r\n&quot;</span></div><div class="line"><a name="l10199"></a><span class="lineno">10199</span>&#160;               <span class="stringliteral">&quot;Priority: %d\r\n&quot;</span></div><div class="line"><a name="l10200"></a><span class="lineno">10200</span>&#160;               <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l10201"></a><span class="lineno">10201</span>&#160;               <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l10202"></a><span class="lineno">10202</span>&#160;               q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, pos++, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>),</div><div class="line"><a name="l10203"></a><span class="lineno">10203</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <span class="stringliteral">&quot;unknown&quot;</span>),</div><div class="line"><a name="l10204"></a><span class="lineno">10204</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <span class="stringliteral">&quot;unknown&quot;</span>),</div><div class="line"><a name="l10205"></a><span class="lineno">10205</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <span class="stringliteral">&quot;unknown&quot;</span>),</div><div class="line"><a name="l10206"></a><span class="lineno">10206</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">chan</a>)-&gt;<a class="code" href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <span class="stringliteral">&quot;unknown&quot;</span>),</div><div class="line"><a name="l10207"></a><span class="lineno">10207</span>&#160;               (<span class="keywordtype">long</span>) (now - qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">start</a>), qe-&gt;<a class="code" href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">prio</a>, idText);</div><div class="line"><a name="l10208"></a><span class="lineno">10208</span>&#160;            ++q_items;</div><div class="line"><a name="l10209"></a><span class="lineno">10209</span>&#160;         }</div><div class="line"><a name="l10210"></a><span class="lineno">10210</span>&#160;      }</div><div class="line"><a name="l10211"></a><span class="lineno">10211</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l10212"></a><span class="lineno">10212</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l10213"></a><span class="lineno">10213</span>&#160;   }</div><div class="line"><a name="l10214"></a><span class="lineno">10214</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l10215"></a><span class="lineno">10215</span>&#160;</div><div class="line"><a name="l10216"></a><span class="lineno">10216</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;QueueStatusComplete&quot;</span>, q_items);</div><div class="line"><a name="l10217"></a><span class="lineno">10217</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l10218"></a><span class="lineno">10218</span>&#160;</div><div class="line"><a name="l10219"></a><span class="lineno">10219</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a>;</div><div class="line"><a name="l10220"></a><span class="lineno">10220</span>&#160;}</div><div class="line"><a name="l10221"></a><span class="lineno">10221</span>&#160;</div><div class="line"><a name="l10222"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2ec48379febcdee77d6c659269714dd6">10222</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2ec48379febcdee77d6c659269714dd6">manager_add_queue_member</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10223"></a><span class="lineno">10223</span>&#160;{</div><div class="line"><a name="l10224"></a><span class="lineno">10224</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface, *penalty_s, *paused_s, *membername, *state_interface, *wrapuptime_s;</div><div class="line"><a name="l10225"></a><span class="lineno">10225</span>&#160;   <span class="keywordtype">int</span> paused, penalty, wrapuptime = 0;</div><div class="line"><a name="l10226"></a><span class="lineno">10226</span>&#160;</div><div class="line"><a name="l10227"></a><span class="lineno">10227</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10228"></a><span class="lineno">10228</span>&#160;   <span class="keyword">interface </span>= <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, &quot;Interface&quot;);</div><div class="line"><a name="l10229"></a><span class="lineno">10229</span>&#160;   penalty_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Penalty&quot;</span>);</div><div class="line"><a name="l10230"></a><span class="lineno">10230</span>&#160;   paused_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Paused&quot;</span>);</div><div class="line"><a name="l10231"></a><span class="lineno">10231</span>&#160;   membername = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;MemberName&quot;</span>);</div><div class="line"><a name="l10232"></a><span class="lineno">10232</span>&#160;   state_interface = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;StateInterface&quot;</span>);</div><div class="line"><a name="l10233"></a><span class="lineno">10233</span>&#160;   wrapuptime_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Wrapuptime&quot;</span>);</div><div class="line"><a name="l10234"></a><span class="lineno">10234</span>&#160;</div><div class="line"><a name="l10235"></a><span class="lineno">10235</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) {</div><div class="line"><a name="l10236"></a><span class="lineno">10236</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;&#39;Queue&#39; not specified.&quot;</span>);</div><div class="line"><a name="l10237"></a><span class="lineno">10237</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10238"></a><span class="lineno">10238</span>&#160;   }</div><div class="line"><a name="l10239"></a><span class="lineno">10239</span>&#160;</div><div class="line"><a name="l10240"></a><span class="lineno">10240</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(interface)) {</div><div class="line"><a name="l10241"></a><span class="lineno">10241</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;&#39;Interface&#39; not specified.&quot;</span>);</div><div class="line"><a name="l10242"></a><span class="lineno">10242</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10243"></a><span class="lineno">10243</span>&#160;   }</div><div class="line"><a name="l10244"></a><span class="lineno">10244</span>&#160;</div><div class="line"><a name="l10245"></a><span class="lineno">10245</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(penalty_s)) {</div><div class="line"><a name="l10246"></a><span class="lineno">10246</span>&#160;      penalty = 0;</div><div class="line"><a name="l10247"></a><span class="lineno">10247</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(penalty_s, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;penalty) != 1 || penalty &lt; 0) {</div><div class="line"><a name="l10248"></a><span class="lineno">10248</span>&#160;      penalty = 0;</div><div class="line"><a name="l10249"></a><span class="lineno">10249</span>&#160;   }</div><div class="line"><a name="l10250"></a><span class="lineno">10250</span>&#160;</div><div class="line"><a name="l10251"></a><span class="lineno">10251</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(wrapuptime_s)) {</div><div class="line"><a name="l10252"></a><span class="lineno">10252</span>&#160;      wrapuptime = 0;</div><div class="line"><a name="l10253"></a><span class="lineno">10253</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(wrapuptime_s, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;wrapuptime) != 1 || wrapuptime &lt; 0) {</div><div class="line"><a name="l10254"></a><span class="lineno">10254</span>&#160;      wrapuptime = 0;</div><div class="line"><a name="l10255"></a><span class="lineno">10255</span>&#160;   }</div><div class="line"><a name="l10256"></a><span class="lineno">10256</span>&#160;</div><div class="line"><a name="l10257"></a><span class="lineno">10257</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(paused_s)) {</div><div class="line"><a name="l10258"></a><span class="lineno">10258</span>&#160;      paused = 0;</div><div class="line"><a name="l10259"></a><span class="lineno">10259</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10260"></a><span class="lineno">10260</span>&#160;      paused = <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(paused_s));</div><div class="line"><a name="l10261"></a><span class="lineno">10261</span>&#160;   }</div><div class="line"><a name="l10262"></a><span class="lineno">10262</span>&#160;</div><div class="line"><a name="l10263"></a><span class="lineno">10263</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#ad6687a49016ace40e5834f697417268a">add_to_queue</a>(queuename, interface, membername, penalty, paused, queue_persistent_members, state_interface, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, wrapuptime)) {</div><div class="line"><a name="l10264"></a><span class="lineno">10264</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l10265"></a><span class="lineno">10265</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(membername) || !log_membername_as_agent) {</div><div class="line"><a name="l10266"></a><span class="lineno">10266</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;MANAGER&quot;</span>, interface, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, paused ? <span class="stringliteral">&quot;PAUSED&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10267"></a><span class="lineno">10267</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10268"></a><span class="lineno">10268</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;MANAGER&quot;</span>, membername, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, paused ? <span class="stringliteral">&quot;PAUSED&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10269"></a><span class="lineno">10269</span>&#160;      }</div><div class="line"><a name="l10270"></a><span class="lineno">10270</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Added interface to queue&quot;</span>);</div><div class="line"><a name="l10271"></a><span class="lineno">10271</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10272"></a><span class="lineno">10272</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>:</div><div class="line"><a name="l10273"></a><span class="lineno">10273</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to add interface: Already there&quot;</span>);</div><div class="line"><a name="l10274"></a><span class="lineno">10274</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10275"></a><span class="lineno">10275</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l10276"></a><span class="lineno">10276</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to add interface to queue: No such queue&quot;</span>);</div><div class="line"><a name="l10277"></a><span class="lineno">10277</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10278"></a><span class="lineno">10278</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a>:</div><div class="line"><a name="l10279"></a><span class="lineno">10279</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Out of memory&quot;</span>);</div><div class="line"><a name="l10280"></a><span class="lineno">10280</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10281"></a><span class="lineno">10281</span>&#160;   }</div><div class="line"><a name="l10282"></a><span class="lineno">10282</span>&#160;</div><div class="line"><a name="l10283"></a><span class="lineno">10283</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10284"></a><span class="lineno">10284</span>&#160;}</div><div class="line"><a name="l10285"></a><span class="lineno">10285</span>&#160;</div><div class="line"><a name="l10286"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abbeea50ec5fd219991763c7a848464ea">10286</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#abbeea50ec5fd219991763c7a848464ea">manager_remove_queue_member</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10287"></a><span class="lineno">10287</span>&#160;{</div><div class="line"><a name="l10288"></a><span class="lineno">10288</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface;</div><div class="line"><a name="l10289"></a><span class="lineno">10289</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10290"></a><span class="lineno">10290</span>&#160;</div><div class="line"><a name="l10291"></a><span class="lineno">10291</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10292"></a><span class="lineno">10292</span>&#160;   <span class="keyword">interface </span>= <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, &quot;Interface&quot;);</div><div class="line"><a name="l10293"></a><span class="lineno">10293</span>&#160;</div><div class="line"><a name="l10294"></a><span class="lineno">10294</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(interface)) {</div><div class="line"><a name="l10295"></a><span class="lineno">10295</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Need &#39;Queue&#39; and &#39;Interface&#39; parameters.&quot;</span>);</div><div class="line"><a name="l10296"></a><span class="lineno">10296</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10297"></a><span class="lineno">10297</span>&#160;   }</div><div class="line"><a name="l10298"></a><span class="lineno">10298</span>&#160;</div><div class="line"><a name="l10299"></a><span class="lineno">10299</span>&#160;   <span class="keywordflow">if</span> (log_membername_as_agent) {</div><div class="line"><a name="l10300"></a><span class="lineno">10300</span>&#160;      mem = <a class="code" href="../../da/dfb/app__queue_8c.html#aa9439de0855115f7361b2ca30ce71af1">find_member_by_queuename_and_interface</a>(queuename, interface);</div><div class="line"><a name="l10301"></a><span class="lineno">10301</span>&#160;   }</div><div class="line"><a name="l10302"></a><span class="lineno">10302</span>&#160;</div><div class="line"><a name="l10303"></a><span class="lineno">10303</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a2d8545a6eecf92b885f8880aaaf662d2">remove_from_queue</a>(queuename, interface)) {</div><div class="line"><a name="l10304"></a><span class="lineno">10304</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l10305"></a><span class="lineno">10305</span>&#160;      <span class="keywordflow">if</span> (!mem || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>)) {</div><div class="line"><a name="l10306"></a><span class="lineno">10306</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;MANAGER&quot;</span>, interface, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10307"></a><span class="lineno">10307</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10308"></a><span class="lineno">10308</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;MANAGER&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10309"></a><span class="lineno">10309</span>&#160;      }</div><div class="line"><a name="l10310"></a><span class="lineno">10310</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Removed interface from queue&quot;</span>);</div><div class="line"><a name="l10311"></a><span class="lineno">10311</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10312"></a><span class="lineno">10312</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>:</div><div class="line"><a name="l10313"></a><span class="lineno">10313</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to remove interface: Not there&quot;</span>);</div><div class="line"><a name="l10314"></a><span class="lineno">10314</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10315"></a><span class="lineno">10315</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l10316"></a><span class="lineno">10316</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to remove interface from queue: No such queue&quot;</span>);</div><div class="line"><a name="l10317"></a><span class="lineno">10317</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10318"></a><span class="lineno">10318</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a>:</div><div class="line"><a name="l10319"></a><span class="lineno">10319</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Out of memory&quot;</span>);</div><div class="line"><a name="l10320"></a><span class="lineno">10320</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10321"></a><span class="lineno">10321</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a447a632daaf1a56114da95816c12b8a5">RES_NOT_DYNAMIC</a>:</div><div class="line"><a name="l10322"></a><span class="lineno">10322</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Member not dynamic&quot;</span>);</div><div class="line"><a name="l10323"></a><span class="lineno">10323</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10324"></a><span class="lineno">10324</span>&#160;   }</div><div class="line"><a name="l10325"></a><span class="lineno">10325</span>&#160;</div><div class="line"><a name="l10326"></a><span class="lineno">10326</span>&#160;   <span class="keywordflow">if</span> (mem) {</div><div class="line"><a name="l10327"></a><span class="lineno">10327</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l10328"></a><span class="lineno">10328</span>&#160;   }</div><div class="line"><a name="l10329"></a><span class="lineno">10329</span>&#160;</div><div class="line"><a name="l10330"></a><span class="lineno">10330</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10331"></a><span class="lineno">10331</span>&#160;}</div><div class="line"><a name="l10332"></a><span class="lineno">10332</span>&#160;</div><div class="line"><a name="l10333"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab294d279fc57c00a43df3d8783e10dcf">10333</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab294d279fc57c00a43df3d8783e10dcf">manager_pause_queue_member</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10334"></a><span class="lineno">10334</span>&#160;{</div><div class="line"><a name="l10335"></a><span class="lineno">10335</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface, *paused_s, *reason;</div><div class="line"><a name="l10336"></a><span class="lineno">10336</span>&#160;   <span class="keywordtype">int</span> paused;</div><div class="line"><a name="l10337"></a><span class="lineno">10337</span>&#160;</div><div class="line"><a name="l10338"></a><span class="lineno">10338</span>&#160;   <span class="keyword">interface </span>= <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, &quot;Interface&quot;);</div><div class="line"><a name="l10339"></a><span class="lineno">10339</span>&#160;   paused_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Paused&quot;</span>);</div><div class="line"><a name="l10340"></a><span class="lineno">10340</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);      <span class="comment">/* Optional - if not supplied, pause the given Interface in all queues */</span></div><div class="line"><a name="l10341"></a><span class="lineno">10341</span>&#160;   reason = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Reason&quot;</span>);        <span class="comment">/* Optional */</span></div><div class="line"><a name="l10342"></a><span class="lineno">10342</span>&#160;</div><div class="line"><a name="l10343"></a><span class="lineno">10343</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(interface) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(paused_s)) {</div><div class="line"><a name="l10344"></a><span class="lineno">10344</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Need &#39;Interface&#39; and &#39;Paused&#39; parameters.&quot;</span>);</div><div class="line"><a name="l10345"></a><span class="lineno">10345</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10346"></a><span class="lineno">10346</span>&#160;   }</div><div class="line"><a name="l10347"></a><span class="lineno">10347</span>&#160;</div><div class="line"><a name="l10348"></a><span class="lineno">10348</span>&#160;   paused = <a class="code" href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a>(<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(paused_s));</div><div class="line"><a name="l10349"></a><span class="lineno">10349</span>&#160;</div><div class="line"><a name="l10350"></a><span class="lineno">10350</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(queuename, interface, reason, paused)) {</div><div class="line"><a name="l10351"></a><span class="lineno">10351</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Interface not found&quot;</span>);</div><div class="line"><a name="l10352"></a><span class="lineno">10352</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10353"></a><span class="lineno">10353</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, paused ? <span class="stringliteral">&quot;Interface paused successfully&quot;</span> : <span class="stringliteral">&quot;Interface unpaused successfully&quot;</span>);</div><div class="line"><a name="l10354"></a><span class="lineno">10354</span>&#160;   }</div><div class="line"><a name="l10355"></a><span class="lineno">10355</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10356"></a><span class="lineno">10356</span>&#160;}</div><div class="line"><a name="l10357"></a><span class="lineno">10357</span>&#160;</div><div class="line"><a name="l10358"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#afc981f304f48009b383c870db6aac776">10358</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#afc981f304f48009b383c870db6aac776">manager_queue_log_custom</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10359"></a><span class="lineno">10359</span>&#160;{</div><div class="line"><a name="l10360"></a><span class="lineno">10360</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *<a class="code" href="../../df/d7d/structevent.html">event</a>, *<a class="code" href="../../d8/d9e/structmessage.html">message</a>, *interface, *uniqueid;</div><div class="line"><a name="l10361"></a><span class="lineno">10361</span>&#160;</div><div class="line"><a name="l10362"></a><span class="lineno">10362</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10363"></a><span class="lineno">10363</span>&#160;   uniqueid = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;UniqueId&quot;</span>);</div><div class="line"><a name="l10364"></a><span class="lineno">10364</span>&#160;   <span class="keyword">interface </span>= <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, &quot;Interface&quot;);</div><div class="line"><a name="l10365"></a><span class="lineno">10365</span>&#160;   <span class="keyword">event</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Event&quot;</span>);</div><div class="line"><a name="l10366"></a><span class="lineno">10366</span>&#160;   message = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Message&quot;</span>);</div><div class="line"><a name="l10367"></a><span class="lineno">10367</span>&#160;</div><div class="line"><a name="l10368"></a><span class="lineno">10368</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(event)) {</div><div class="line"><a name="l10369"></a><span class="lineno">10369</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Need &#39;Queue&#39; and &#39;Event&#39; parameters.&quot;</span>);</div><div class="line"><a name="l10370"></a><span class="lineno">10370</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10371"></a><span class="lineno">10371</span>&#160;   }</div><div class="line"><a name="l10372"></a><span class="lineno">10372</span>&#160;</div><div class="line"><a name="l10373"></a><span class="lineno">10373</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(uniqueid, <span class="stringliteral">&quot;NONE&quot;</span>), interface, event, <span class="stringliteral">&quot;%s&quot;</span>, message);</div><div class="line"><a name="l10374"></a><span class="lineno">10374</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Event added successfully&quot;</span>);</div><div class="line"><a name="l10375"></a><span class="lineno">10375</span>&#160;</div><div class="line"><a name="l10376"></a><span class="lineno">10376</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10377"></a><span class="lineno">10377</span>&#160;}</div><div class="line"><a name="l10378"></a><span class="lineno">10378</span>&#160;</div><div class="line"><a name="l10379"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a6eb92f6a70762912ce80b53e9282204a">10379</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a6eb92f6a70762912ce80b53e9282204a">manager_queue_reload</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10380"></a><span class="lineno">10380</span>&#160;{</div><div class="line"><a name="l10381"></a><span class="lineno">10381</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> mask = {0,};</div><div class="line"><a name="l10382"></a><span class="lineno">10382</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10383"></a><span class="lineno">10383</span>&#160;   <span class="keywordtype">int</span> header_found = 0;</div><div class="line"><a name="l10384"></a><span class="lineno">10384</span>&#160;</div><div class="line"><a name="l10385"></a><span class="lineno">10385</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10386"></a><span class="lineno">10386</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Members&quot;</span>), <span class="stringliteral">&quot;&quot;</span>), <span class="stringliteral">&quot;yes&quot;</span>)) {</div><div class="line"><a name="l10387"></a><span class="lineno">10387</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f">QUEUE_RELOAD_MEMBER</a>);</div><div class="line"><a name="l10388"></a><span class="lineno">10388</span>&#160;      header_found = 1;</div><div class="line"><a name="l10389"></a><span class="lineno">10389</span>&#160;   }</div><div class="line"><a name="l10390"></a><span class="lineno">10390</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Rules&quot;</span>), <span class="stringliteral">&quot;&quot;</span>), <span class="stringliteral">&quot;yes&quot;</span>)) {</div><div class="line"><a name="l10391"></a><span class="lineno">10391</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a04da28a6a506fbc6dfce3f3da3569acc">QUEUE_RELOAD_RULES</a>);</div><div class="line"><a name="l10392"></a><span class="lineno">10392</span>&#160;      header_found = 1;</div><div class="line"><a name="l10393"></a><span class="lineno">10393</span>&#160;   }</div><div class="line"><a name="l10394"></a><span class="lineno">10394</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Parameters&quot;</span>), <span class="stringliteral">&quot;&quot;</span>), <span class="stringliteral">&quot;yes&quot;</span>)) {</div><div class="line"><a name="l10395"></a><span class="lineno">10395</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44">QUEUE_RELOAD_PARAMETERS</a>);</div><div class="line"><a name="l10396"></a><span class="lineno">10396</span>&#160;      header_found = 1;</div><div class="line"><a name="l10397"></a><span class="lineno">10397</span>&#160;   }</div><div class="line"><a name="l10398"></a><span class="lineno">10398</span>&#160;</div><div class="line"><a name="l10399"></a><span class="lineno">10399</span>&#160;   <span class="keywordflow">if</span> (!header_found) {</div><div class="line"><a name="l10400"></a><span class="lineno">10400</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a>);</div><div class="line"><a name="l10401"></a><span class="lineno">10401</span>&#160;   }</div><div class="line"><a name="l10402"></a><span class="lineno">10402</span>&#160;</div><div class="line"><a name="l10403"></a><span class="lineno">10403</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(1, &amp;mask, queuename)) {</div><div class="line"><a name="l10404"></a><span class="lineno">10404</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Queue reloaded successfully&quot;</span>);</div><div class="line"><a name="l10405"></a><span class="lineno">10405</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10406"></a><span class="lineno">10406</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Error encountered while reloading queue&quot;</span>);</div><div class="line"><a name="l10407"></a><span class="lineno">10407</span>&#160;   }</div><div class="line"><a name="l10408"></a><span class="lineno">10408</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10409"></a><span class="lineno">10409</span>&#160;}</div><div class="line"><a name="l10410"></a><span class="lineno">10410</span>&#160;</div><div class="line"><a name="l10411"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a14d56b1e279722b17bc293e06c099b6b">10411</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a14d56b1e279722b17bc293e06c099b6b">manager_queue_reset</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10412"></a><span class="lineno">10412</span>&#160;{</div><div class="line"><a name="l10413"></a><span class="lineno">10413</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10414"></a><span class="lineno">10414</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> mask = {<a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c">QUEUE_RESET_STATS</a>,};</div><div class="line"><a name="l10415"></a><span class="lineno">10415</span>&#160;</div><div class="line"><a name="l10416"></a><span class="lineno">10416</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10417"></a><span class="lineno">10417</span>&#160;</div><div class="line"><a name="l10418"></a><span class="lineno">10418</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(1, &amp;mask, queuename)) {</div><div class="line"><a name="l10419"></a><span class="lineno">10419</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Queue stats reset successfully&quot;</span>);</div><div class="line"><a name="l10420"></a><span class="lineno">10420</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10421"></a><span class="lineno">10421</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Error encountered while resetting queue stats&quot;</span>);</div><div class="line"><a name="l10422"></a><span class="lineno">10422</span>&#160;   }</div><div class="line"><a name="l10423"></a><span class="lineno">10423</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10424"></a><span class="lineno">10424</span>&#160;}</div><div class="line"><a name="l10425"></a><span class="lineno">10425</span>&#160;</div><div class="line"><a name="l10426"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab5a25afd13aa42a238c165bd5a8fecf2">10426</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#ab5a25afd13aa42a238c165bd5a8fecf2">complete_queue_add_member</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l10427"></a><span class="lineno">10427</span>&#160;{</div><div class="line"><a name="l10428"></a><span class="lineno">10428</span>&#160;   <span class="comment">/* 0 - queue; 1 - add; 2 - member; 3 - &lt;interface&gt;; 4 - to; 5 - &lt;queue&gt;; 6 - penalty; 7 - &lt;penalty&gt;; 8 - as; 9 - &lt;membername&gt; */</span></div><div class="line"><a name="l10429"></a><span class="lineno">10429</span>&#160;   <span class="keywordflow">switch</span> (pos) {</div><div class="line"><a name="l10430"></a><span class="lineno">10430</span>&#160;   <span class="keywordflow">case</span> 3: <span class="comment">/* Don&#39;t attempt to complete name of interface (infinite possibilities) */</span></div><div class="line"><a name="l10431"></a><span class="lineno">10431</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10432"></a><span class="lineno">10432</span>&#160;   <span class="keywordflow">case</span> 4: <span class="comment">/* only one possible match, &quot;to&quot; */</span></div><div class="line"><a name="l10433"></a><span class="lineno">10433</span>&#160;      <span class="keywordflow">return</span> state == 0 ? <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;to&quot;</span>) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10434"></a><span class="lineno">10434</span>&#160;   <span class="keywordflow">case</span> 5: <span class="comment">/* &lt;queue&gt; */</span></div><div class="line"><a name="l10435"></a><span class="lineno">10435</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(line, word, pos, state, 0);</div><div class="line"><a name="l10436"></a><span class="lineno">10436</span>&#160;   <span class="keywordflow">case</span> 6: <span class="comment">/* only one possible match, &quot;penalty&quot; */</span></div><div class="line"><a name="l10437"></a><span class="lineno">10437</span>&#160;      <span class="keywordflow">return</span> state == 0 ? <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;penalty&quot;</span>) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10438"></a><span class="lineno">10438</span>&#160;   <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l10439"></a><span class="lineno">10439</span>&#160;      <span class="keywordflow">if</span> (0 &lt;= state &amp;&amp; state &lt; 100) {      <span class="comment">/* 0-99 */</span></div><div class="line"><a name="l10440"></a><span class="lineno">10440</span>&#160;         <span class="keywordtype">char</span> *num;</div><div class="line"><a name="l10441"></a><span class="lineno">10441</span>&#160;         <span class="keywordflow">if</span> ((num = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(3))) {</div><div class="line"><a name="l10442"></a><span class="lineno">10442</span>&#160;            sprintf(num, <span class="stringliteral">&quot;%d&quot;</span>, state);</div><div class="line"><a name="l10443"></a><span class="lineno">10443</span>&#160;         }</div><div class="line"><a name="l10444"></a><span class="lineno">10444</span>&#160;         <span class="keywordflow">return</span> num;</div><div class="line"><a name="l10445"></a><span class="lineno">10445</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10446"></a><span class="lineno">10446</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10447"></a><span class="lineno">10447</span>&#160;      }</div><div class="line"><a name="l10448"></a><span class="lineno">10448</span>&#160;   <span class="keywordflow">case</span> 8: <span class="comment">/* only one possible match, &quot;as&quot; */</span></div><div class="line"><a name="l10449"></a><span class="lineno">10449</span>&#160;      <span class="keywordflow">return</span> state == 0 ? <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;as&quot;</span>) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10450"></a><span class="lineno">10450</span>&#160;   <span class="keywordflow">case</span> 9: <span class="comment">/* Don&#39;t attempt to complete name of member (infinite possibilities) */</span></div><div class="line"><a name="l10451"></a><span class="lineno">10451</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10452"></a><span class="lineno">10452</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l10453"></a><span class="lineno">10453</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10454"></a><span class="lineno">10454</span>&#160;   }</div><div class="line"><a name="l10455"></a><span class="lineno">10455</span>&#160;}</div><div class="line"><a name="l10456"></a><span class="lineno">10456</span>&#160;</div><div class="line"><a name="l10457"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8292022a7532175e3af8a5a67f87de9c">10457</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a8292022a7532175e3af8a5a67f87de9c">manager_queue_member_ringinuse</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10458"></a><span class="lineno">10458</span>&#160;{</div><div class="line"><a name="l10459"></a><span class="lineno">10459</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface, *ringinuse_s;</div><div class="line"><a name="l10460"></a><span class="lineno">10460</span>&#160;   <span class="keywordtype">int</span> ringinuse;</div><div class="line"><a name="l10461"></a><span class="lineno">10461</span>&#160;</div><div class="line"><a name="l10462"></a><span class="lineno">10462</span>&#160;   <span class="keyword">interface </span>= <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, &quot;Interface&quot;);</div><div class="line"><a name="l10463"></a><span class="lineno">10463</span>&#160;   ringinuse_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;RingInUse&quot;</span>);</div><div class="line"><a name="l10464"></a><span class="lineno">10464</span>&#160;</div><div class="line"><a name="l10465"></a><span class="lineno">10465</span>&#160;   <span class="comment">/* Optional - if not supplied, set the ringinuse value for the given Interface in all queues */</span></div><div class="line"><a name="l10466"></a><span class="lineno">10466</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10467"></a><span class="lineno">10467</span>&#160;</div><div class="line"><a name="l10468"></a><span class="lineno">10468</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(interface) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(ringinuse_s)) {</div><div class="line"><a name="l10469"></a><span class="lineno">10469</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Need &#39;Interface&#39; and &#39;RingInUse&#39; parameters.&quot;</span>);</div><div class="line"><a name="l10470"></a><span class="lineno">10470</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10471"></a><span class="lineno">10471</span>&#160;   }</div><div class="line"><a name="l10472"></a><span class="lineno">10472</span>&#160;</div><div class="line"><a name="l10473"></a><span class="lineno">10473</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(ringinuse_s)) {</div><div class="line"><a name="l10474"></a><span class="lineno">10474</span>&#160;      ringinuse = 1;</div><div class="line"><a name="l10475"></a><span class="lineno">10475</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(ringinuse_s)) {</div><div class="line"><a name="l10476"></a><span class="lineno">10476</span>&#160;      ringinuse = 0;</div><div class="line"><a name="l10477"></a><span class="lineno">10477</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10478"></a><span class="lineno">10478</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;&#39;RingInUse&#39; parameter must be a truth value (yes/no, on/off, 0/1, etc)&quot;</span>);</div><div class="line"><a name="l10479"></a><span class="lineno">10479</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10480"></a><span class="lineno">10480</span>&#160;   }</div><div class="line"><a name="l10481"></a><span class="lineno">10481</span>&#160;</div><div class="line"><a name="l10482"></a><span class="lineno">10482</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>(queuename, interface, <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b">MEMBER_RINGINUSE</a>, ringinuse)) {</div><div class="line"><a name="l10483"></a><span class="lineno">10483</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid interface, queuename, or ringinuse value\n&quot;</span>);</div><div class="line"><a name="l10484"></a><span class="lineno">10484</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10485"></a><span class="lineno">10485</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Interface ringinuse set successfully&quot;</span>);</div><div class="line"><a name="l10486"></a><span class="lineno">10486</span>&#160;   }</div><div class="line"><a name="l10487"></a><span class="lineno">10487</span>&#160;</div><div class="line"><a name="l10488"></a><span class="lineno">10488</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10489"></a><span class="lineno">10489</span>&#160;}</div><div class="line"><a name="l10490"></a><span class="lineno">10490</span>&#160;</div><div class="line"><a name="l10491"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a90a66cbfb007419fb44ca4426265a03d">10491</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a90a66cbfb007419fb44ca4426265a03d">manager_queue_member_penalty</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10492"></a><span class="lineno">10492</span>&#160;{</div><div class="line"><a name="l10493"></a><span class="lineno">10493</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface, *penalty_s;</div><div class="line"><a name="l10494"></a><span class="lineno">10494</span>&#160;   <span class="keywordtype">int</span> penalty;</div><div class="line"><a name="l10495"></a><span class="lineno">10495</span>&#160;</div><div class="line"><a name="l10496"></a><span class="lineno">10496</span>&#160;   <span class="keyword">interface </span>= <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, &quot;Interface&quot;);</div><div class="line"><a name="l10497"></a><span class="lineno">10497</span>&#160;   penalty_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Penalty&quot;</span>);</div><div class="line"><a name="l10498"></a><span class="lineno">10498</span>&#160;   <span class="comment">/* Optional - if not supplied, set the penalty value for the given Interface in all queues */</span></div><div class="line"><a name="l10499"></a><span class="lineno">10499</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10500"></a><span class="lineno">10500</span>&#160;</div><div class="line"><a name="l10501"></a><span class="lineno">10501</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(interface) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(penalty_s)) {</div><div class="line"><a name="l10502"></a><span class="lineno">10502</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Need &#39;Interface&#39; and &#39;Penalty&#39; parameters.&quot;</span>);</div><div class="line"><a name="l10503"></a><span class="lineno">10503</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10504"></a><span class="lineno">10504</span>&#160;   }</div><div class="line"><a name="l10505"></a><span class="lineno">10505</span>&#160;</div><div class="line"><a name="l10506"></a><span class="lineno">10506</span>&#160;   penalty = atoi(penalty_s);</div><div class="line"><a name="l10507"></a><span class="lineno">10507</span>&#160;</div><div class="line"><a name="l10508"></a><span class="lineno">10508</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>((<span class="keywordtype">char</span> *)queuename, (<span class="keywordtype">char</span> *)interface, <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a>, penalty)) {</div><div class="line"><a name="l10509"></a><span class="lineno">10509</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid interface, queuename or penalty&quot;</span>);</div><div class="line"><a name="l10510"></a><span class="lineno">10510</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10511"></a><span class="lineno">10511</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Interface penalty set successfully&quot;</span>);</div><div class="line"><a name="l10512"></a><span class="lineno">10512</span>&#160;   }</div><div class="line"><a name="l10513"></a><span class="lineno">10513</span>&#160;</div><div class="line"><a name="l10514"></a><span class="lineno">10514</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10515"></a><span class="lineno">10515</span>&#160;}</div><div class="line"><a name="l10516"></a><span class="lineno">10516</span>&#160;</div><div class="line"><a name="l10517"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#af9ba6814d17cb9a49be24f92cb660645">10517</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#af9ba6814d17cb9a49be24f92cb660645">manager_change_priority_caller_on_queue</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l10518"></a><span class="lineno">10518</span>&#160;{</div><div class="line"><a name="l10519"></a><span class="lineno">10519</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *caller, *priority_s;</div><div class="line"><a name="l10520"></a><span class="lineno">10520</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> = 0;</div><div class="line"><a name="l10521"></a><span class="lineno">10521</span>&#160;</div><div class="line"><a name="l10522"></a><span class="lineno">10522</span>&#160;   queuename = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Queue&quot;</span>);</div><div class="line"><a name="l10523"></a><span class="lineno">10523</span>&#160;   caller = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Caller&quot;</span>);</div><div class="line"><a name="l10524"></a><span class="lineno">10524</span>&#160;   priority_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Priority&quot;</span>);</div><div class="line"><a name="l10525"></a><span class="lineno">10525</span>&#160;</div><div class="line"><a name="l10526"></a><span class="lineno">10526</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) {</div><div class="line"><a name="l10527"></a><span class="lineno">10527</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;&#39;Queue&#39; not specified.&quot;</span>);</div><div class="line"><a name="l10528"></a><span class="lineno">10528</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10529"></a><span class="lineno">10529</span>&#160;   }</div><div class="line"><a name="l10530"></a><span class="lineno">10530</span>&#160;</div><div class="line"><a name="l10531"></a><span class="lineno">10531</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(caller)) {</div><div class="line"><a name="l10532"></a><span class="lineno">10532</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;&#39;Caller&#39; not specified.&quot;</span>);</div><div class="line"><a name="l10533"></a><span class="lineno">10533</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10534"></a><span class="lineno">10534</span>&#160;   }</div><div class="line"><a name="l10535"></a><span class="lineno">10535</span>&#160;</div><div class="line"><a name="l10536"></a><span class="lineno">10536</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(priority_s)) {</div><div class="line"><a name="l10537"></a><span class="lineno">10537</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;&#39;Priority&#39; not specified.&quot;</span>);</div><div class="line"><a name="l10538"></a><span class="lineno">10538</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10539"></a><span class="lineno">10539</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(priority_s, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;priority) != 1) {</div><div class="line"><a name="l10540"></a><span class="lineno">10540</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;&#39;Priority&#39; need integer.&quot;</span>);</div><div class="line"><a name="l10541"></a><span class="lineno">10541</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10542"></a><span class="lineno">10542</span>&#160;   }</div><div class="line"><a name="l10543"></a><span class="lineno">10543</span>&#160;</div><div class="line"><a name="l10544"></a><span class="lineno">10544</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a53953b67278cd604638905b98734c248">change_priority_caller_on_queue</a>(queuename, caller, priority)) {</div><div class="line"><a name="l10545"></a><span class="lineno">10545</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l10546"></a><span class="lineno">10546</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Priority change for caller on queue&quot;</span>);</div><div class="line"><a name="l10547"></a><span class="lineno">10547</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10548"></a><span class="lineno">10548</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l10549"></a><span class="lineno">10549</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to change priority caller on queue: No such queue&quot;</span>);</div><div class="line"><a name="l10550"></a><span class="lineno">10550</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10551"></a><span class="lineno">10551</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a1802f66ae1666498af70e9a4ff2e616b">RES_NOT_CALLER</a>:</div><div class="line"><a name="l10552"></a><span class="lineno">10552</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unable to change priority caller on queue: No such caller&quot;</span>);</div><div class="line"><a name="l10553"></a><span class="lineno">10553</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10554"></a><span class="lineno">10554</span>&#160;   }</div><div class="line"><a name="l10555"></a><span class="lineno">10555</span>&#160;</div><div class="line"><a name="l10556"></a><span class="lineno">10556</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l10557"></a><span class="lineno">10557</span>&#160;}</div><div class="line"><a name="l10558"></a><span class="lineno">10558</span>&#160;</div><div class="line"><a name="l10559"></a><span class="lineno">10559</span>&#160;</div><div class="line"><a name="l10560"></a><span class="lineno">10560</span>&#160;</div><div class="line"><a name="l10561"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a809b8e2a1be84c1a33a191a1c8ed549f">10561</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a809b8e2a1be84c1a33a191a1c8ed549f">handle_queue_add_member</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l10562"></a><span class="lineno">10562</span>&#160;{</div><div class="line"><a name="l10563"></a><span class="lineno">10563</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface, *membername = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *state_interface = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10564"></a><span class="lineno">10564</span>&#160;   <span class="keywordtype">int</span> penalty;</div><div class="line"><a name="l10565"></a><span class="lineno">10565</span>&#160;</div><div class="line"><a name="l10566"></a><span class="lineno">10566</span>&#160;   <span class="keywordflow">switch</span> ( cmd ) {</div><div class="line"><a name="l10567"></a><span class="lineno">10567</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l10568"></a><span class="lineno">10568</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue add member&quot;</span>;</div><div class="line"><a name="l10569"></a><span class="lineno">10569</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l10570"></a><span class="lineno">10570</span>&#160;         <span class="stringliteral">&quot;Usage: queue add member &lt;dial string&gt; to &lt;queue&gt; [[[penalty &lt;penalty&gt;] as &lt;membername&gt;] state_interface &lt;interface&gt;]\n&quot;</span></div><div class="line"><a name="l10571"></a><span class="lineno">10571</span>&#160;         <span class="stringliteral">&quot;       Add a dial string (Such as a channel,e.g. SIP/6001) to a queue with optionally:  a penalty, membername and a state_interface\n&quot;</span>;</div><div class="line"><a name="l10572"></a><span class="lineno">10572</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10573"></a><span class="lineno">10573</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l10574"></a><span class="lineno">10574</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ab5a25afd13aa42a238c165bd5a8fecf2">complete_queue_add_member</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l10575"></a><span class="lineno">10575</span>&#160;   }</div><div class="line"><a name="l10576"></a><span class="lineno">10576</span>&#160;</div><div class="line"><a name="l10577"></a><span class="lineno">10577</span>&#160;   <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 6) &amp;&amp; (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 8) &amp;&amp; (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 10) &amp;&amp; (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 12)) {</div><div class="line"><a name="l10578"></a><span class="lineno">10578</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10579"></a><span class="lineno">10579</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;to&quot;</span>)) {</div><div class="line"><a name="l10580"></a><span class="lineno">10580</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10581"></a><span class="lineno">10581</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt;= 8) &amp;&amp; strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[6], <span class="stringliteral">&quot;penalty&quot;</span>)) {</div><div class="line"><a name="l10582"></a><span class="lineno">10582</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10583"></a><span class="lineno">10583</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt;= 10) &amp;&amp; strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[8], <span class="stringliteral">&quot;as&quot;</span>)) {</div><div class="line"><a name="l10584"></a><span class="lineno">10584</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10585"></a><span class="lineno">10585</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 12) &amp;&amp; strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[10], <span class="stringliteral">&quot;state_interface&quot;</span>)) {</div><div class="line"><a name="l10586"></a><span class="lineno">10586</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10587"></a><span class="lineno">10587</span>&#160;   }</div><div class="line"><a name="l10588"></a><span class="lineno">10588</span>&#160;</div><div class="line"><a name="l10589"></a><span class="lineno">10589</span>&#160;   queuename = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[5];</div><div class="line"><a name="l10590"></a><span class="lineno">10590</span>&#160;   <span class="keyword">interface </span>= a-&gt;argv[3];</div><div class="line"><a name="l10591"></a><span class="lineno">10591</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt;= 8) {</div><div class="line"><a name="l10592"></a><span class="lineno">10592</span>&#160;      <span class="keywordflow">if</span> (sscanf(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[7], <span class="stringliteral">&quot;%30d&quot;</span>, &amp;penalty) == 1) {</div><div class="line"><a name="l10593"></a><span class="lineno">10593</span>&#160;         <span class="keywordflow">if</span> (penalty &lt; 0) {</div><div class="line"><a name="l10594"></a><span class="lineno">10594</span>&#160;            <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Penalty must be &gt;= 0\n&quot;</span>);</div><div class="line"><a name="l10595"></a><span class="lineno">10595</span>&#160;            penalty = 0;</div><div class="line"><a name="l10596"></a><span class="lineno">10596</span>&#160;         }</div><div class="line"><a name="l10597"></a><span class="lineno">10597</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10598"></a><span class="lineno">10598</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Penalty must be an integer &gt;= 0\n&quot;</span>);</div><div class="line"><a name="l10599"></a><span class="lineno">10599</span>&#160;         penalty = 0;</div><div class="line"><a name="l10600"></a><span class="lineno">10600</span>&#160;      }</div><div class="line"><a name="l10601"></a><span class="lineno">10601</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10602"></a><span class="lineno">10602</span>&#160;      penalty = 0;</div><div class="line"><a name="l10603"></a><span class="lineno">10603</span>&#160;   }</div><div class="line"><a name="l10604"></a><span class="lineno">10604</span>&#160;</div><div class="line"><a name="l10605"></a><span class="lineno">10605</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt;= 10) {</div><div class="line"><a name="l10606"></a><span class="lineno">10606</span>&#160;      membername = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[9];</div><div class="line"><a name="l10607"></a><span class="lineno">10607</span>&#160;   }</div><div class="line"><a name="l10608"></a><span class="lineno">10608</span>&#160;</div><div class="line"><a name="l10609"></a><span class="lineno">10609</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt;= 12) {</div><div class="line"><a name="l10610"></a><span class="lineno">10610</span>&#160;      state_interface = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[11];</div><div class="line"><a name="l10611"></a><span class="lineno">10611</span>&#160;   }</div><div class="line"><a name="l10612"></a><span class="lineno">10612</span>&#160;</div><div class="line"><a name="l10613"></a><span class="lineno">10613</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#ad6687a49016ace40e5834f697417268a">add_to_queue</a>(queuename, interface, membername, penalty, 0, queue_persistent_members, state_interface, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l10614"></a><span class="lineno">10614</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l10615"></a><span class="lineno">10615</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(membername) || !log_membername_as_agent) {</div><div class="line"><a name="l10616"></a><span class="lineno">10616</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;CLI&quot;</span>, interface, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10617"></a><span class="lineno">10617</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10618"></a><span class="lineno">10618</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;CLI&quot;</span>, membername, <span class="stringliteral">&quot;ADDMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10619"></a><span class="lineno">10619</span>&#160;      }</div><div class="line"><a name="l10620"></a><span class="lineno">10620</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Added interface &#39;%s&#39; to queue &#39;%s&#39;\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10621"></a><span class="lineno">10621</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l10622"></a><span class="lineno">10622</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>:</div><div class="line"><a name="l10623"></a><span class="lineno">10623</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to add interface &#39;%s&#39; to queue &#39;%s&#39;: Already there\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10624"></a><span class="lineno">10624</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10625"></a><span class="lineno">10625</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l10626"></a><span class="lineno">10626</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to add interface to queue &#39;%s&#39;: No such queue\n&quot;</span>, queuename);</div><div class="line"><a name="l10627"></a><span class="lineno">10627</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10628"></a><span class="lineno">10628</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a>:</div><div class="line"><a name="l10629"></a><span class="lineno">10629</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Out of memory\n&quot;</span>);</div><div class="line"><a name="l10630"></a><span class="lineno">10630</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10631"></a><span class="lineno">10631</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a447a632daaf1a56114da95816c12b8a5">RES_NOT_DYNAMIC</a>:</div><div class="line"><a name="l10632"></a><span class="lineno">10632</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Member not dynamic\n&quot;</span>);</div><div class="line"><a name="l10633"></a><span class="lineno">10633</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10634"></a><span class="lineno">10634</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l10635"></a><span class="lineno">10635</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10636"></a><span class="lineno">10636</span>&#160;   }</div><div class="line"><a name="l10637"></a><span class="lineno">10637</span>&#160;}</div><div class="line"><a name="l10638"></a><span class="lineno">10638</span>&#160;</div><div class="line"><a name="l10639"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a2555f8439a688d7ac9f3aa9d368d197b">10639</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a2555f8439a688d7ac9f3aa9d368d197b">complete_queue_remove_member</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l10640"></a><span class="lineno">10640</span>&#160;{</div><div class="line"><a name="l10641"></a><span class="lineno">10641</span>&#160;   <span class="keywordtype">int</span> which = 0;</div><div class="line"><a name="l10642"></a><span class="lineno">10642</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l10643"></a><span class="lineno">10643</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *m;</div><div class="line"><a name="l10644"></a><span class="lineno">10644</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> queue_iter;</div><div class="line"><a name="l10645"></a><span class="lineno">10645</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter;</div><div class="line"><a name="l10646"></a><span class="lineno">10646</span>&#160;   <span class="keywordtype">int</span> wordlen = strlen(word);</div><div class="line"><a name="l10647"></a><span class="lineno">10647</span>&#160;</div><div class="line"><a name="l10648"></a><span class="lineno">10648</span>&#160;   <span class="comment">/* 0 - queue; 1 - remove; 2 - member; 3 - &lt;member&gt;; 4 - from; 5 - &lt;queue&gt; */</span></div><div class="line"><a name="l10649"></a><span class="lineno">10649</span>&#160;   <span class="keywordflow">if</span> (pos &gt; 5 || pos &lt; 3) {</div><div class="line"><a name="l10650"></a><span class="lineno">10650</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10651"></a><span class="lineno">10651</span>&#160;   }</div><div class="line"><a name="l10652"></a><span class="lineno">10652</span>&#160;   <span class="keywordflow">if</span> (pos == 4) {   <span class="comment">/* only one possible match, &#39;from&#39; */</span></div><div class="line"><a name="l10653"></a><span class="lineno">10653</span>&#160;      <span class="keywordflow">return</span> (state == 0 ? <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;from&quot;</span>) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10654"></a><span class="lineno">10654</span>&#160;   }</div><div class="line"><a name="l10655"></a><span class="lineno">10655</span>&#160;</div><div class="line"><a name="l10656"></a><span class="lineno">10656</span>&#160;   <span class="keywordflow">if</span> (pos == 5) {   <span class="comment">/* No need to duplicate code */</span></div><div class="line"><a name="l10657"></a><span class="lineno">10657</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(line, word, pos, state, 0);</div><div class="line"><a name="l10658"></a><span class="lineno">10658</span>&#160;   }</div><div class="line"><a name="l10659"></a><span class="lineno">10659</span>&#160;</div><div class="line"><a name="l10660"></a><span class="lineno">10660</span>&#160;   <span class="comment">/* here is the case for 3, &lt;member&gt; */</span></div><div class="line"><a name="l10661"></a><span class="lineno">10661</span>&#160;   queue_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(queues, 0);</div><div class="line"><a name="l10662"></a><span class="lineno">10662</span>&#160;   <span class="keywordflow">while</span> ((q = <a class="code" href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a>(&amp;queue_iter, <span class="stringliteral">&quot;Iterate through queues&quot;</span>))) {</div><div class="line"><a name="l10663"></a><span class="lineno">10663</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l10664"></a><span class="lineno">10664</span>&#160;      mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l10665"></a><span class="lineno">10665</span>&#160;      <span class="keywordflow">while</span> ((m = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l10666"></a><span class="lineno">10666</span>&#160;         <span class="keywordflow">if</span> (!strncasecmp(word, m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, wordlen) &amp;&amp; ++which &gt; state) {</div><div class="line"><a name="l10667"></a><span class="lineno">10667</span>&#160;            <span class="keywordtype">char</span> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l10668"></a><span class="lineno">10668</span>&#160;            tmp = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(m-&gt;<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>);</div><div class="line"><a name="l10669"></a><span class="lineno">10669</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l10670"></a><span class="lineno">10670</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l10671"></a><span class="lineno">10671</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l10672"></a><span class="lineno">10672</span>&#160;            <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator, returning interface name&quot;</span>);</div><div class="line"><a name="l10673"></a><span class="lineno">10673</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l10674"></a><span class="lineno">10674</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l10675"></a><span class="lineno">10675</span>&#160;         }</div><div class="line"><a name="l10676"></a><span class="lineno">10676</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(m, -1);</div><div class="line"><a name="l10677"></a><span class="lineno">10677</span>&#160;      }</div><div class="line"><a name="l10678"></a><span class="lineno">10678</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l10679"></a><span class="lineno">10679</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l10680"></a><span class="lineno">10680</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with iterator&quot;</span>);</div><div class="line"><a name="l10681"></a><span class="lineno">10681</span>&#160;   }</div><div class="line"><a name="l10682"></a><span class="lineno">10682</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;queue_iter);</div><div class="line"><a name="l10683"></a><span class="lineno">10683</span>&#160;</div><div class="line"><a name="l10684"></a><span class="lineno">10684</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10685"></a><span class="lineno">10685</span>&#160;}</div><div class="line"><a name="l10686"></a><span class="lineno">10686</span>&#160;</div><div class="line"><a name="l10687"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a9b97d0ffb7e1a6127de3acc037ea464b">10687</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a9b97d0ffb7e1a6127de3acc037ea464b">handle_queue_remove_member</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l10688"></a><span class="lineno">10688</span>&#160;{</div><div class="line"><a name="l10689"></a><span class="lineno">10689</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface;</div><div class="line"><a name="l10690"></a><span class="lineno">10690</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10691"></a><span class="lineno">10691</span>&#160;   <span class="keywordtype">char</span> *res = <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10692"></a><span class="lineno">10692</span>&#160;</div><div class="line"><a name="l10693"></a><span class="lineno">10693</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l10694"></a><span class="lineno">10694</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l10695"></a><span class="lineno">10695</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue remove member&quot;</span>;</div><div class="line"><a name="l10696"></a><span class="lineno">10696</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l10697"></a><span class="lineno">10697</span>&#160;         <span class="stringliteral">&quot;Usage: queue remove member &lt;channel&gt; from &lt;queue&gt;\n&quot;</span></div><div class="line"><a name="l10698"></a><span class="lineno">10698</span>&#160;         <span class="stringliteral">&quot;       Remove a specific channel from a queue.\n&quot;</span>;</div><div class="line"><a name="l10699"></a><span class="lineno">10699</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10700"></a><span class="lineno">10700</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l10701"></a><span class="lineno">10701</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a2555f8439a688d7ac9f3aa9d368d197b">complete_queue_remove_member</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l10702"></a><span class="lineno">10702</span>&#160;   }</div><div class="line"><a name="l10703"></a><span class="lineno">10703</span>&#160;</div><div class="line"><a name="l10704"></a><span class="lineno">10704</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 6) {</div><div class="line"><a name="l10705"></a><span class="lineno">10705</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10706"></a><span class="lineno">10706</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;from&quot;</span>)) {</div><div class="line"><a name="l10707"></a><span class="lineno">10707</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10708"></a><span class="lineno">10708</span>&#160;   }</div><div class="line"><a name="l10709"></a><span class="lineno">10709</span>&#160;</div><div class="line"><a name="l10710"></a><span class="lineno">10710</span>&#160;   queuename = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[5];</div><div class="line"><a name="l10711"></a><span class="lineno">10711</span>&#160;   <span class="keyword">interface </span>= a-&gt;argv[3];</div><div class="line"><a name="l10712"></a><span class="lineno">10712</span>&#160;</div><div class="line"><a name="l10713"></a><span class="lineno">10713</span>&#160;   <span class="keywordflow">if</span> (log_membername_as_agent) {</div><div class="line"><a name="l10714"></a><span class="lineno">10714</span>&#160;      mem = <a class="code" href="../../da/dfb/app__queue_8c.html#aa9439de0855115f7361b2ca30ce71af1">find_member_by_queuename_and_interface</a>(queuename, interface);</div><div class="line"><a name="l10715"></a><span class="lineno">10715</span>&#160;   }</div><div class="line"><a name="l10716"></a><span class="lineno">10716</span>&#160;</div><div class="line"><a name="l10717"></a><span class="lineno">10717</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a2d8545a6eecf92b885f8880aaaf662d2">remove_from_queue</a>(queuename, interface)) {</div><div class="line"><a name="l10718"></a><span class="lineno">10718</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l10719"></a><span class="lineno">10719</span>&#160;      <span class="keywordflow">if</span> (!mem || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>)) {</div><div class="line"><a name="l10720"></a><span class="lineno">10720</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;CLI&quot;</span>, interface, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10721"></a><span class="lineno">10721</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10722"></a><span class="lineno">10722</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(queuename, <span class="stringliteral">&quot;CLI&quot;</span>, mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <span class="stringliteral">&quot;REMOVEMEMBER&quot;</span>, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l10723"></a><span class="lineno">10723</span>&#160;      }</div><div class="line"><a name="l10724"></a><span class="lineno">10724</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Removed interface %s from queue &#39;%s&#39;\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10725"></a><span class="lineno">10725</span>&#160;      res = <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l10726"></a><span class="lineno">10726</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10727"></a><span class="lineno">10727</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a>:</div><div class="line"><a name="l10728"></a><span class="lineno">10728</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to remove interface &#39;%s&#39; from queue &#39;%s&#39;: Not there\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10729"></a><span class="lineno">10729</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10730"></a><span class="lineno">10730</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l10731"></a><span class="lineno">10731</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to remove interface from queue &#39;%s&#39;: No such queue\n&quot;</span>, queuename);</div><div class="line"><a name="l10732"></a><span class="lineno">10732</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10733"></a><span class="lineno">10733</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a>:</div><div class="line"><a name="l10734"></a><span class="lineno">10734</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Out of memory\n&quot;</span>);</div><div class="line"><a name="l10735"></a><span class="lineno">10735</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10736"></a><span class="lineno">10736</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a447a632daaf1a56114da95816c12b8a5">RES_NOT_DYNAMIC</a>:</div><div class="line"><a name="l10737"></a><span class="lineno">10737</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to remove interface &#39;%s&#39; from queue &#39;%s&#39;: Member is not dynamic\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10738"></a><span class="lineno">10738</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10739"></a><span class="lineno">10739</span>&#160;   }</div><div class="line"><a name="l10740"></a><span class="lineno">10740</span>&#160;</div><div class="line"><a name="l10741"></a><span class="lineno">10741</span>&#160;   <span class="keywordflow">if</span> (mem) {</div><div class="line"><a name="l10742"></a><span class="lineno">10742</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l10743"></a><span class="lineno">10743</span>&#160;   }</div><div class="line"><a name="l10744"></a><span class="lineno">10744</span>&#160;</div><div class="line"><a name="l10745"></a><span class="lineno">10745</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l10746"></a><span class="lineno">10746</span>&#160;}</div><div class="line"><a name="l10747"></a><span class="lineno">10747</span>&#160;</div><div class="line"><a name="l10748"></a><span class="lineno">10748</span>&#160;</div><div class="line"><a name="l10749"></a><span class="lineno">10749</span>&#160;</div><div class="line"><a name="l10750"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a1b9f504553df5c7e9971f1ad3c695381">10750</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a1b9f504553df5c7e9971f1ad3c695381">handle_queue_change_priority_caller</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l10751"></a><span class="lineno">10751</span>&#160;{</div><div class="line"><a name="l10752"></a><span class="lineno">10752</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *caller;</div><div class="line"><a name="l10753"></a><span class="lineno">10753</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>;</div><div class="line"><a name="l10754"></a><span class="lineno">10754</span>&#160;   <span class="keywordtype">char</span> *res = <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10755"></a><span class="lineno">10755</span>&#160;</div><div class="line"><a name="l10756"></a><span class="lineno">10756</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l10757"></a><span class="lineno">10757</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l10758"></a><span class="lineno">10758</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue priority caller&quot;</span>;</div><div class="line"><a name="l10759"></a><span class="lineno">10759</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l10760"></a><span class="lineno">10760</span>&#160;         <span class="stringliteral">&quot;Usage: queue priority caller &lt;channel&gt; on &lt;queue&gt; to &lt;priority&gt;\n&quot;</span></div><div class="line"><a name="l10761"></a><span class="lineno">10761</span>&#160;         <span class="stringliteral">&quot;       Change the priority of a channel on a queue.\n&quot;</span>;</div><div class="line"><a name="l10762"></a><span class="lineno">10762</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10763"></a><span class="lineno">10763</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l10764"></a><span class="lineno">10764</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10765"></a><span class="lineno">10765</span>&#160;   }</div><div class="line"><a name="l10766"></a><span class="lineno">10766</span>&#160;</div><div class="line"><a name="l10767"></a><span class="lineno">10767</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 8) {</div><div class="line"><a name="l10768"></a><span class="lineno">10768</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10769"></a><span class="lineno">10769</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;on&quot;</span>)) {</div><div class="line"><a name="l10770"></a><span class="lineno">10770</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10771"></a><span class="lineno">10771</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[6], <span class="stringliteral">&quot;to&quot;</span>)) {</div><div class="line"><a name="l10772"></a><span class="lineno">10772</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10773"></a><span class="lineno">10773</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sscanf(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[7], <span class="stringliteral">&quot;%30d&quot;</span>, &amp;priority) != 1) {</div><div class="line"><a name="l10774"></a><span class="lineno">10774</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a> (<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;&lt;priority&gt; parameter must be an integer.\n&quot;</span>);</div><div class="line"><a name="l10775"></a><span class="lineno">10775</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10776"></a><span class="lineno">10776</span>&#160;   }</div><div class="line"><a name="l10777"></a><span class="lineno">10777</span>&#160;</div><div class="line"><a name="l10778"></a><span class="lineno">10778</span>&#160;   caller = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3];</div><div class="line"><a name="l10779"></a><span class="lineno">10779</span>&#160;   queuename = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[5];</div><div class="line"><a name="l10780"></a><span class="lineno">10780</span>&#160;</div><div class="line"><a name="l10781"></a><span class="lineno">10781</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a53953b67278cd604638905b98734c248">change_priority_caller_on_queue</a>(queuename, caller, priority)) {</div><div class="line"><a name="l10782"></a><span class="lineno">10782</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a>:</div><div class="line"><a name="l10783"></a><span class="lineno">10783</span>&#160;      res = <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l10784"></a><span class="lineno">10784</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10785"></a><span class="lineno">10785</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a>:</div><div class="line"><a name="l10786"></a><span class="lineno">10786</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable change priority caller %s on queue &#39;%s&#39;: No such queue\n&quot;</span>, caller, queuename);</div><div class="line"><a name="l10787"></a><span class="lineno">10787</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10788"></a><span class="lineno">10788</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a1802f66ae1666498af70e9a4ff2e616b">RES_NOT_CALLER</a>:</div><div class="line"><a name="l10789"></a><span class="lineno">10789</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to change priority caller &#39;%s&#39; on queue &#39;%s&#39;: Not there\n&quot;</span>, caller, queuename);</div><div class="line"><a name="l10790"></a><span class="lineno">10790</span>&#160;</div><div class="line"><a name="l10791"></a><span class="lineno">10791</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10792"></a><span class="lineno">10792</span>&#160;   }</div><div class="line"><a name="l10793"></a><span class="lineno">10793</span>&#160;</div><div class="line"><a name="l10794"></a><span class="lineno">10794</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l10795"></a><span class="lineno">10795</span>&#160;}</div><div class="line"><a name="l10796"></a><span class="lineno">10796</span>&#160;</div><div class="line"><a name="l10797"></a><span class="lineno">10797</span>&#160;</div><div class="line"><a name="l10798"></a><span class="lineno">10798</span>&#160;</div><div class="line"><a name="l10799"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a4c7d813324c2a5aec46aa9206cbaa912">10799</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a4c7d813324c2a5aec46aa9206cbaa912">complete_queue_pause_member</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l10800"></a><span class="lineno">10800</span>&#160;{</div><div class="line"><a name="l10801"></a><span class="lineno">10801</span>&#160;   <span class="comment">/* 0 - queue; 1 - pause; 2 - member; 3 - &lt;interface&gt;; 4 - queue; 5 - &lt;queue&gt;; 6 - reason; 7 - &lt;reason&gt; */</span></div><div class="line"><a name="l10802"></a><span class="lineno">10802</span>&#160;   <span class="keywordflow">switch</span> (pos) {</div><div class="line"><a name="l10803"></a><span class="lineno">10803</span>&#160;   <span class="keywordflow">case</span> 3:  <span class="comment">/* Don&#39;t attempt to complete name of interface (infinite possibilities) */</span></div><div class="line"><a name="l10804"></a><span class="lineno">10804</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10805"></a><span class="lineno">10805</span>&#160;   <span class="keywordflow">case</span> 4:  <span class="comment">/* only one possible match, &quot;queue&quot; */</span></div><div class="line"><a name="l10806"></a><span class="lineno">10806</span>&#160;      <span class="keywordflow">return</span> state == 0 ? <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;queue&quot;</span>) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10807"></a><span class="lineno">10807</span>&#160;   <span class="keywordflow">case</span> 5:  <span class="comment">/* &lt;queue&gt; */</span></div><div class="line"><a name="l10808"></a><span class="lineno">10808</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(line, word, pos, state, 0);</div><div class="line"><a name="l10809"></a><span class="lineno">10809</span>&#160;   <span class="keywordflow">case</span> 6: <span class="comment">/* &quot;reason&quot; */</span></div><div class="line"><a name="l10810"></a><span class="lineno">10810</span>&#160;      <span class="keywordflow">return</span> state == 0 ? <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;reason&quot;</span>) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10811"></a><span class="lineno">10811</span>&#160;   <span class="keywordflow">case</span> 7: <span class="comment">/* Can&#39;t autocomplete a reason, since it&#39;s 100% customizeable */</span></div><div class="line"><a name="l10812"></a><span class="lineno">10812</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10813"></a><span class="lineno">10813</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l10814"></a><span class="lineno">10814</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10815"></a><span class="lineno">10815</span>&#160;   }</div><div class="line"><a name="l10816"></a><span class="lineno">10816</span>&#160;}</div><div class="line"><a name="l10817"></a><span class="lineno">10817</span>&#160;</div><div class="line"><a name="l10818"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a8cd08f19554c293e7455c33b6b225d0a">10818</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a8cd08f19554c293e7455c33b6b225d0a">handle_queue_pause_member</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l10819"></a><span class="lineno">10819</span>&#160;{</div><div class="line"><a name="l10820"></a><span class="lineno">10820</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, *interface, *reason;</div><div class="line"><a name="l10821"></a><span class="lineno">10821</span>&#160;   <span class="keywordtype">int</span> paused;</div><div class="line"><a name="l10822"></a><span class="lineno">10822</span>&#160;</div><div class="line"><a name="l10823"></a><span class="lineno">10823</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l10824"></a><span class="lineno">10824</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l10825"></a><span class="lineno">10825</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue {pause|unpause} member&quot;</span>;</div><div class="line"><a name="l10826"></a><span class="lineno">10826</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l10827"></a><span class="lineno">10827</span>&#160;         <span class="stringliteral">&quot;Usage: queue {pause|unpause} member &lt;member&gt; [queue &lt;queue&gt; [reason &lt;reason&gt;]]\n&quot;</span></div><div class="line"><a name="l10828"></a><span class="lineno">10828</span>&#160;         <span class="stringliteral">&quot;  Pause or unpause a queue member. Not specifying a particular queue\n&quot;</span></div><div class="line"><a name="l10829"></a><span class="lineno">10829</span>&#160;         <span class="stringliteral">&quot;  will pause or unpause a member across all queues to which the member\n&quot;</span></div><div class="line"><a name="l10830"></a><span class="lineno">10830</span>&#160;         <span class="stringliteral">&quot;  belongs.\n&quot;</span>;</div><div class="line"><a name="l10831"></a><span class="lineno">10831</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10832"></a><span class="lineno">10832</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l10833"></a><span class="lineno">10833</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a4c7d813324c2a5aec46aa9206cbaa912">complete_queue_pause_member</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt; <a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l10834"></a><span class="lineno">10834</span>&#160;   }</div><div class="line"><a name="l10835"></a><span class="lineno">10835</span>&#160;</div><div class="line"><a name="l10836"></a><span class="lineno">10836</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &lt; 4 || a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 5 || a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 7 || a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt; 8) {</div><div class="line"><a name="l10837"></a><span class="lineno">10837</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10838"></a><span class="lineno">10838</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt;= 5 &amp;&amp; strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;queue&quot;</span>)) {</div><div class="line"><a name="l10839"></a><span class="lineno">10839</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10840"></a><span class="lineno">10840</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 8 &amp;&amp; strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[6], <span class="stringliteral">&quot;reason&quot;</span>)) {</div><div class="line"><a name="l10841"></a><span class="lineno">10841</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10842"></a><span class="lineno">10842</span>&#160;   }</div><div class="line"><a name="l10843"></a><span class="lineno">10843</span>&#160;</div><div class="line"><a name="l10844"></a><span class="lineno">10844</span>&#160;</div><div class="line"><a name="l10845"></a><span class="lineno">10845</span>&#160;   <span class="keyword">interface </span>= a-&gt;argv[3];</div><div class="line"><a name="l10846"></a><span class="lineno">10846</span>&#160;   queuename = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt;= 6 ? a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[5] : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10847"></a><span class="lineno">10847</span>&#160;   reason = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 8 ? a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[7] : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10848"></a><span class="lineno">10848</span>&#160;   paused = !strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[1], <span class="stringliteral">&quot;pause&quot;</span>);</div><div class="line"><a name="l10849"></a><span class="lineno">10849</span>&#160;</div><div class="line"><a name="l10850"></a><span class="lineno">10850</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a>(queuename, interface, reason, paused) == <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a>) {</div><div class="line"><a name="l10851"></a><span class="lineno">10851</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%spaused interface &#39;%s&#39;&quot;</span>, paused ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;un&quot;</span>, interface);</div><div class="line"><a name="l10852"></a><span class="lineno">10852</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) {</div><div class="line"><a name="l10853"></a><span class="lineno">10853</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot; in queue &#39;%s&#39;&quot;</span>, queuename);</div><div class="line"><a name="l10854"></a><span class="lineno">10854</span>&#160;      }</div><div class="line"><a name="l10855"></a><span class="lineno">10855</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(reason)) {</div><div class="line"><a name="l10856"></a><span class="lineno">10856</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot; for reason &#39;%s&#39;&quot;</span>, reason);</div><div class="line"><a name="l10857"></a><span class="lineno">10857</span>&#160;      }</div><div class="line"><a name="l10858"></a><span class="lineno">10858</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l10859"></a><span class="lineno">10859</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l10860"></a><span class="lineno">10860</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10861"></a><span class="lineno">10861</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Unable to %spause interface &#39;%s&#39;&quot;</span>, paused ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;un&quot;</span>, interface);</div><div class="line"><a name="l10862"></a><span class="lineno">10862</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(queuename)) {</div><div class="line"><a name="l10863"></a><span class="lineno">10863</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot; in queue &#39;%s&#39;&quot;</span>, queuename);</div><div class="line"><a name="l10864"></a><span class="lineno">10864</span>&#160;      }</div><div class="line"><a name="l10865"></a><span class="lineno">10865</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(reason)) {</div><div class="line"><a name="l10866"></a><span class="lineno">10866</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot; for reason &#39;%s&#39;&quot;</span>, reason);</div><div class="line"><a name="l10867"></a><span class="lineno">10867</span>&#160;      }</div><div class="line"><a name="l10868"></a><span class="lineno">10868</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l10869"></a><span class="lineno">10869</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10870"></a><span class="lineno">10870</span>&#160;   }</div><div class="line"><a name="l10871"></a><span class="lineno">10871</span>&#160;}</div><div class="line"><a name="l10872"></a><span class="lineno">10872</span>&#160;</div><div class="line"><a name="l10873"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a75901a27e4606596337f8579b5637b53">10873</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a75901a27e4606596337f8579b5637b53">complete_queue_set_member_value</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l10874"></a><span class="lineno">10874</span>&#160;{</div><div class="line"><a name="l10875"></a><span class="lineno">10875</span>&#160;   <span class="comment">/* 0 - queue; 1 - set; 2 - penalty/ringinuse; 3 - &lt;value&gt;; 4 - on; 5 - &lt;member&gt;; 6 - in; 7 - &lt;queue&gt;;*/</span></div><div class="line"><a name="l10876"></a><span class="lineno">10876</span>&#160;   <span class="keywordflow">switch</span> (pos) {</div><div class="line"><a name="l10877"></a><span class="lineno">10877</span>&#160;   <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l10878"></a><span class="lineno">10878</span>&#160;      <span class="keywordflow">if</span> (state == 0) {</div><div class="line"><a name="l10879"></a><span class="lineno">10879</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;on&quot;</span>);</div><div class="line"><a name="l10880"></a><span class="lineno">10880</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10881"></a><span class="lineno">10881</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10882"></a><span class="lineno">10882</span>&#160;      }</div><div class="line"><a name="l10883"></a><span class="lineno">10883</span>&#160;   <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l10884"></a><span class="lineno">10884</span>&#160;      <span class="keywordflow">if</span> (state == 0) {</div><div class="line"><a name="l10885"></a><span class="lineno">10885</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;in&quot;</span>);</div><div class="line"><a name="l10886"></a><span class="lineno">10886</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10887"></a><span class="lineno">10887</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10888"></a><span class="lineno">10888</span>&#160;      }</div><div class="line"><a name="l10889"></a><span class="lineno">10889</span>&#160;   <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l10890"></a><span class="lineno">10890</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(line, word, pos, state, 0);</div><div class="line"><a name="l10891"></a><span class="lineno">10891</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l10892"></a><span class="lineno">10892</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10893"></a><span class="lineno">10893</span>&#160;   }</div><div class="line"><a name="l10894"></a><span class="lineno">10894</span>&#160;}</div><div class="line"><a name="l10895"></a><span class="lineno">10895</span>&#160;</div><div class="line"><a name="l10896"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aec2dcfe87edd23912e4e94c46085af2c">10896</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#aec2dcfe87edd23912e4e94c46085af2c">handle_queue_set_member_ringinuse</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l10897"></a><span class="lineno">10897</span>&#160;{</div><div class="line"><a name="l10898"></a><span class="lineno">10898</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *interface;</div><div class="line"><a name="l10899"></a><span class="lineno">10899</span>&#160;   <span class="keywordtype">int</span> ringinuse;</div><div class="line"><a name="l10900"></a><span class="lineno">10900</span>&#160;</div><div class="line"><a name="l10901"></a><span class="lineno">10901</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l10902"></a><span class="lineno">10902</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l10903"></a><span class="lineno">10903</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue set ringinuse&quot;</span>;</div><div class="line"><a name="l10904"></a><span class="lineno">10904</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l10905"></a><span class="lineno">10905</span>&#160;      <span class="stringliteral">&quot;Usage: queue set ringinuse &lt;yes/no&gt; on &lt;interface&gt; [in &lt;queue&gt;]\n&quot;</span></div><div class="line"><a name="l10906"></a><span class="lineno">10906</span>&#160;      <span class="stringliteral">&quot;  Set a member&#39;s ringinuse in the queue specified. If no queue is specified\n&quot;</span></div><div class="line"><a name="l10907"></a><span class="lineno">10907</span>&#160;      <span class="stringliteral">&quot;  then that interface&#39;s penalty is set in all queues to which that interface is a member.\n&quot;</span>;</div><div class="line"><a name="l10908"></a><span class="lineno">10908</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l10909"></a><span class="lineno">10909</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10910"></a><span class="lineno">10910</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l10911"></a><span class="lineno">10911</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a75901a27e4606596337f8579b5637b53">complete_queue_set_member_value</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l10912"></a><span class="lineno">10912</span>&#160;   }</div><div class="line"><a name="l10913"></a><span class="lineno">10913</span>&#160;</div><div class="line"><a name="l10914"></a><span class="lineno">10914</span>&#160;   <span class="comment">/* Sensible argument counts */</span></div><div class="line"><a name="l10915"></a><span class="lineno">10915</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 6 &amp;&amp; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 8) {</div><div class="line"><a name="l10916"></a><span class="lineno">10916</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10917"></a><span class="lineno">10917</span>&#160;   }</div><div class="line"><a name="l10918"></a><span class="lineno">10918</span>&#160;</div><div class="line"><a name="l10919"></a><span class="lineno">10919</span>&#160;   <span class="comment">/* Uses proper indicational words */</span></div><div class="line"><a name="l10920"></a><span class="lineno">10920</span>&#160;   <span class="keywordflow">if</span> (strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;on&quot;</span>) || (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt; 6 &amp;&amp; strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[6], <span class="stringliteral">&quot;in&quot;</span>))) {</div><div class="line"><a name="l10921"></a><span class="lineno">10921</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10922"></a><span class="lineno">10922</span>&#160;   }</div><div class="line"><a name="l10923"></a><span class="lineno">10923</span>&#160;</div><div class="line"><a name="l10924"></a><span class="lineno">10924</span>&#160;   <span class="comment">/* Set the queue name if applicale */</span></div><div class="line"><a name="l10925"></a><span class="lineno">10925</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 8) {</div><div class="line"><a name="l10926"></a><span class="lineno">10926</span>&#160;      queuename = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[7];</div><div class="line"><a name="l10927"></a><span class="lineno">10927</span>&#160;   }</div><div class="line"><a name="l10928"></a><span class="lineno">10928</span>&#160;</div><div class="line"><a name="l10929"></a><span class="lineno">10929</span>&#160;   <span class="comment">/* Interface being set */</span></div><div class="line"><a name="l10930"></a><span class="lineno">10930</span>&#160;   <span class="keyword">interface </span>= a-&gt;argv[5];</div><div class="line"><a name="l10931"></a><span class="lineno">10931</span>&#160;</div><div class="line"><a name="l10932"></a><span class="lineno">10932</span>&#160;   <span class="comment">/* Check and set the ringinuse value */</span></div><div class="line"><a name="l10933"></a><span class="lineno">10933</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3])) {</div><div class="line"><a name="l10934"></a><span class="lineno">10934</span>&#160;      ringinuse = 1;</div><div class="line"><a name="l10935"></a><span class="lineno">10935</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3])) {</div><div class="line"><a name="l10936"></a><span class="lineno">10936</span>&#160;      ringinuse = 0;</div><div class="line"><a name="l10937"></a><span class="lineno">10937</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l10938"></a><span class="lineno">10938</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10939"></a><span class="lineno">10939</span>&#160;   }</div><div class="line"><a name="l10940"></a><span class="lineno">10940</span>&#160;</div><div class="line"><a name="l10941"></a><span class="lineno">10941</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>(queuename, interface, <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b">MEMBER_RINGINUSE</a>, ringinuse)) {</div><div class="line"><a name="l10942"></a><span class="lineno">10942</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a>:</div><div class="line"><a name="l10943"></a><span class="lineno">10943</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Set ringinuse on interface &#39;%s&#39; from queue &#39;%s&#39;\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10944"></a><span class="lineno">10944</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l10945"></a><span class="lineno">10945</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#aea87ce97f86effb2c4df6274d4aac567">RESULT_FAILURE</a>:</div><div class="line"><a name="l10946"></a><span class="lineno">10946</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Failed to set ringinuse on interface &#39;%s&#39; from queue &#39;%s&#39;\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10947"></a><span class="lineno">10947</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10948"></a><span class="lineno">10948</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l10949"></a><span class="lineno">10949</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10950"></a><span class="lineno">10950</span>&#160;   }</div><div class="line"><a name="l10951"></a><span class="lineno">10951</span>&#160;}</div><div class="line"><a name="l10952"></a><span class="lineno">10952</span>&#160;</div><div class="line"><a name="l10953"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ab8cbb9ecaec149b8f265951980818cfc">10953</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#ab8cbb9ecaec149b8f265951980818cfc">handle_queue_set_member_penalty</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l10954"></a><span class="lineno">10954</span>&#160;{</div><div class="line"><a name="l10955"></a><span class="lineno">10955</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *interface;</div><div class="line"><a name="l10956"></a><span class="lineno">10956</span>&#160;   <span class="keywordtype">int</span> penalty = 0;</div><div class="line"><a name="l10957"></a><span class="lineno">10957</span>&#160;</div><div class="line"><a name="l10958"></a><span class="lineno">10958</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l10959"></a><span class="lineno">10959</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l10960"></a><span class="lineno">10960</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue set penalty&quot;</span>;</div><div class="line"><a name="l10961"></a><span class="lineno">10961</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l10962"></a><span class="lineno">10962</span>&#160;      <span class="stringliteral">&quot;Usage: queue set penalty &lt;penalty&gt; on &lt;interface&gt; [in &lt;queue&gt;]\n&quot;</span></div><div class="line"><a name="l10963"></a><span class="lineno">10963</span>&#160;      <span class="stringliteral">&quot;  Set a member&#39;s penalty in the queue specified. If no queue is specified\n&quot;</span></div><div class="line"><a name="l10964"></a><span class="lineno">10964</span>&#160;      <span class="stringliteral">&quot;  then that interface&#39;s penalty is set in all queues to which that interface is a member\n&quot;</span>;</div><div class="line"><a name="l10965"></a><span class="lineno">10965</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10966"></a><span class="lineno">10966</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l10967"></a><span class="lineno">10967</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a75901a27e4606596337f8579b5637b53">complete_queue_set_member_value</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l10968"></a><span class="lineno">10968</span>&#160;   }</div><div class="line"><a name="l10969"></a><span class="lineno">10969</span>&#160;</div><div class="line"><a name="l10970"></a><span class="lineno">10970</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 6 &amp;&amp; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 8) {</div><div class="line"><a name="l10971"></a><span class="lineno">10971</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10972"></a><span class="lineno">10972</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[4], <span class="stringliteral">&quot;on&quot;</span>) || (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt; 6 &amp;&amp; strcmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[6], <span class="stringliteral">&quot;in&quot;</span>))) {</div><div class="line"><a name="l10973"></a><span class="lineno">10973</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l10974"></a><span class="lineno">10974</span>&#160;   }</div><div class="line"><a name="l10975"></a><span class="lineno">10975</span>&#160;</div><div class="line"><a name="l10976"></a><span class="lineno">10976</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 8) {</div><div class="line"><a name="l10977"></a><span class="lineno">10977</span>&#160;      queuename = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[7];</div><div class="line"><a name="l10978"></a><span class="lineno">10978</span>&#160;   }</div><div class="line"><a name="l10979"></a><span class="lineno">10979</span>&#160;   <span class="keyword">interface </span>= a-&gt;argv[5];</div><div class="line"><a name="l10980"></a><span class="lineno">10980</span>&#160;   penalty = atoi(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l10981"></a><span class="lineno">10981</span>&#160;</div><div class="line"><a name="l10982"></a><span class="lineno">10982</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a>(queuename, interface, <a class="code" href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a>, penalty)) {</div><div class="line"><a name="l10983"></a><span class="lineno">10983</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a>:</div><div class="line"><a name="l10984"></a><span class="lineno">10984</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Set penalty on interface &#39;%s&#39; from queue &#39;%s&#39;\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10985"></a><span class="lineno">10985</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l10986"></a><span class="lineno">10986</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#aea87ce97f86effb2c4df6274d4aac567">RESULT_FAILURE</a>:</div><div class="line"><a name="l10987"></a><span class="lineno">10987</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Failed to set penalty on interface &#39;%s&#39; from queue &#39;%s&#39;\n&quot;</span>, interface, queuename);</div><div class="line"><a name="l10988"></a><span class="lineno">10988</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10989"></a><span class="lineno">10989</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l10990"></a><span class="lineno">10990</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l10991"></a><span class="lineno">10991</span>&#160;   }</div><div class="line"><a name="l10992"></a><span class="lineno">10992</span>&#160;}</div><div class="line"><a name="l10993"></a><span class="lineno">10993</span>&#160;</div><div class="line"><a name="l10994"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a19ddc6dbd24b622cdf07e0e0e3e4ce01">10994</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a19ddc6dbd24b622cdf07e0e0e3e4ce01">complete_queue_rule_show</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> pos, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l10995"></a><span class="lineno">10995</span>&#160;{</div><div class="line"><a name="l10996"></a><span class="lineno">10996</span>&#160;   <span class="keywordtype">int</span> which = 0;</div><div class="line"><a name="l10997"></a><span class="lineno">10997</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> *rl_iter;</div><div class="line"><a name="l10998"></a><span class="lineno">10998</span>&#160;   <span class="keywordtype">int</span> wordlen = strlen(word);</div><div class="line"><a name="l10999"></a><span class="lineno">10999</span>&#160;   <span class="keywordtype">char</span> *ret = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11000"></a><span class="lineno">11000</span>&#160;   <span class="keywordflow">if</span> (pos != 3) <span class="comment">/* Wha? */</span> {</div><div class="line"><a name="l11001"></a><span class="lineno">11001</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11002"></a><span class="lineno">11002</span>&#160;   }</div><div class="line"><a name="l11003"></a><span class="lineno">11003</span>&#160;</div><div class="line"><a name="l11004"></a><span class="lineno">11004</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l11005"></a><span class="lineno">11005</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, rl_iter, <a class="code" href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">list</a>) {</div><div class="line"><a name="l11006"></a><span class="lineno">11006</span>&#160;      <span class="keywordflow">if</span> (!strncasecmp(word, rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, wordlen) &amp;&amp; ++which &gt; state) {</div><div class="line"><a name="l11007"></a><span class="lineno">11007</span>&#160;         ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l11008"></a><span class="lineno">11008</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l11009"></a><span class="lineno">11009</span>&#160;      }</div><div class="line"><a name="l11010"></a><span class="lineno">11010</span>&#160;   }</div><div class="line"><a name="l11011"></a><span class="lineno">11011</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l11012"></a><span class="lineno">11012</span>&#160;</div><div class="line"><a name="l11013"></a><span class="lineno">11013</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l11014"></a><span class="lineno">11014</span>&#160;}</div><div class="line"><a name="l11015"></a><span class="lineno">11015</span>&#160;</div><div class="line"><a name="l11016"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa69c5e8b97eda56a099f72a195f28bea">11016</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#aa69c5e8b97eda56a099f72a195f28bea">handle_queue_rule_show</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l11017"></a><span class="lineno">11017</span>&#160;{</div><div class="line"><a name="l11018"></a><span class="lineno">11018</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d3/d61/structrule.html">rule</a>;</div><div class="line"><a name="l11019"></a><span class="lineno">11019</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/de5/structrule__list.html">rule_list</a> *rl_iter;</div><div class="line"><a name="l11020"></a><span class="lineno">11020</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a> *pr_iter;</div><div class="line"><a name="l11021"></a><span class="lineno">11021</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l11022"></a><span class="lineno">11022</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l11023"></a><span class="lineno">11023</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue show rules&quot;</span>;</div><div class="line"><a name="l11024"></a><span class="lineno">11024</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l11025"></a><span class="lineno">11025</span>&#160;      <span class="stringliteral">&quot;Usage: queue show rules [rulename]\n&quot;</span></div><div class="line"><a name="l11026"></a><span class="lineno">11026</span>&#160;      <span class="stringliteral">&quot;  Show the list of rules associated with rulename. If no\n&quot;</span></div><div class="line"><a name="l11027"></a><span class="lineno">11027</span>&#160;      <span class="stringliteral">&quot;  rulename is specified, list all rules defined in queuerules.conf\n&quot;</span>;</div><div class="line"><a name="l11028"></a><span class="lineno">11028</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11029"></a><span class="lineno">11029</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l11030"></a><span class="lineno">11030</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a19ddc6dbd24b622cdf07e0e0e3e4ce01">complete_queue_rule_show</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l11031"></a><span class="lineno">11031</span>&#160;   }</div><div class="line"><a name="l11032"></a><span class="lineno">11032</span>&#160;</div><div class="line"><a name="l11033"></a><span class="lineno">11033</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3 &amp;&amp; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l11034"></a><span class="lineno">11034</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l11035"></a><span class="lineno">11035</span>&#160;   }</div><div class="line"><a name="l11036"></a><span class="lineno">11036</span>&#160;</div><div class="line"><a name="l11037"></a><span class="lineno">11037</span>&#160;   rule = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 4 ? a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3] : <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l11038"></a><span class="lineno">11038</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l11039"></a><span class="lineno">11039</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>, rl_iter, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>) {</div><div class="line"><a name="l11040"></a><span class="lineno">11040</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(rule) || !strcasecmp(rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>, rule)) {</div><div class="line"><a name="l11041"></a><span class="lineno">11041</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Rule: %s\n&quot;</span>, rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l11042"></a><span class="lineno">11042</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;rl_iter-&gt;<a class="code" href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rules</a>, pr_iter, <a class="code" href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">list</a>) {</div><div class="line"><a name="l11043"></a><span class="lineno">11043</span>&#160;            <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\tAfter %d seconds, adjust QUEUE_MAX_PENALTY %s %d, adjust QUEUE_MIN_PENALTY %s %d and adjust QUEUE_RAISE_PENALTY %s %d\n&quot;</span>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">time</a>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">max_relative</a> ? <span class="stringliteral">&quot;by&quot;</span> : <span class="stringliteral">&quot;to&quot;</span>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">max_value</a>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">min_relative</a> ? <span class="stringliteral">&quot;by&quot;</span> : <span class="stringliteral">&quot;to&quot;</span>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">min_value</a>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">raise_relative</a> ? <span class="stringliteral">&quot;by&quot;</span> : <span class="stringliteral">&quot;to&quot;</span>, pr_iter-&gt;<a class="code" href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">raise_value</a>);</div><div class="line"><a name="l11044"></a><span class="lineno">11044</span>&#160;         }</div><div class="line"><a name="l11045"></a><span class="lineno">11045</span>&#160;      }</div><div class="line"><a name="l11046"></a><span class="lineno">11046</span>&#160;   }</div><div class="line"><a name="l11047"></a><span class="lineno">11047</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a>(&amp;<a class="code" href="../../dd/d61/structrule__lists.html">rule_lists</a>);</div><div class="line"><a name="l11048"></a><span class="lineno">11048</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l11049"></a><span class="lineno">11049</span>&#160;}</div><div class="line"><a name="l11050"></a><span class="lineno">11050</span>&#160;</div><div class="line"><a name="l11051"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aab6f3afb06683e692b69f0e886c0bedb">11051</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#aab6f3afb06683e692b69f0e886c0bedb">handle_queue_reset</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l11052"></a><span class="lineno">11052</span>&#160;{</div><div class="line"><a name="l11053"></a><span class="lineno">11053</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> mask = {<a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c">QUEUE_RESET_STATS</a>,};</div><div class="line"><a name="l11054"></a><span class="lineno">11054</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l11055"></a><span class="lineno">11055</span>&#160;</div><div class="line"><a name="l11056"></a><span class="lineno">11056</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l11057"></a><span class="lineno">11057</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l11058"></a><span class="lineno">11058</span>&#160;         e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue reset stats&quot;</span>;</div><div class="line"><a name="l11059"></a><span class="lineno">11059</span>&#160;         e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l11060"></a><span class="lineno">11060</span>&#160;            <span class="stringliteral">&quot;Usage: queue reset stats [&lt;queuenames&gt;]\n&quot;</span></div><div class="line"><a name="l11061"></a><span class="lineno">11061</span>&#160;            <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l11062"></a><span class="lineno">11062</span>&#160;            <span class="stringliteral">&quot;Issuing this command will reset statistics for\n&quot;</span></div><div class="line"><a name="l11063"></a><span class="lineno">11063</span>&#160;            <span class="stringliteral">&quot;&lt;queuenames&gt;, or for all queues if no queue is\n&quot;</span></div><div class="line"><a name="l11064"></a><span class="lineno">11064</span>&#160;            <span class="stringliteral">&quot;specified.\n&quot;</span>;</div><div class="line"><a name="l11065"></a><span class="lineno">11065</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11066"></a><span class="lineno">11066</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l11067"></a><span class="lineno">11067</span>&#160;         <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> &gt;= 3) {</div><div class="line"><a name="l11068"></a><span class="lineno">11068</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>, 17);</div><div class="line"><a name="l11069"></a><span class="lineno">11069</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l11070"></a><span class="lineno">11070</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11071"></a><span class="lineno">11071</span>&#160;         }</div><div class="line"><a name="l11072"></a><span class="lineno">11072</span>&#160;   }</div><div class="line"><a name="l11073"></a><span class="lineno">11073</span>&#160;</div><div class="line"><a name="l11074"></a><span class="lineno">11074</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &lt; 3) {</div><div class="line"><a name="l11075"></a><span class="lineno">11075</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l11076"></a><span class="lineno">11076</span>&#160;   }</div><div class="line"><a name="l11077"></a><span class="lineno">11077</span>&#160;</div><div class="line"><a name="l11078"></a><span class="lineno">11078</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 3) {</div><div class="line"><a name="l11079"></a><span class="lineno">11079</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(1, &amp;mask, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l11080"></a><span class="lineno">11080</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l11081"></a><span class="lineno">11081</span>&#160;   }</div><div class="line"><a name="l11082"></a><span class="lineno">11082</span>&#160;</div><div class="line"><a name="l11083"></a><span class="lineno">11083</span>&#160;   <span class="keywordflow">for</span> (i = 3; i &lt; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a>; ++i) {</div><div class="line"><a name="l11084"></a><span class="lineno">11084</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(1, &amp;mask, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[i]);</div><div class="line"><a name="l11085"></a><span class="lineno">11085</span>&#160;   }</div><div class="line"><a name="l11086"></a><span class="lineno">11086</span>&#160;</div><div class="line"><a name="l11087"></a><span class="lineno">11087</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l11088"></a><span class="lineno">11088</span>&#160;}</div><div class="line"><a name="l11089"></a><span class="lineno">11089</span>&#160;</div><div class="line"><a name="l11090"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a22f7d751732c215b14ab3e80aec3f541">11090</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a22f7d751732c215b14ab3e80aec3f541">handle_queue_reload</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l11091"></a><span class="lineno">11091</span>&#160;{</div><div class="line"><a name="l11092"></a><span class="lineno">11092</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> mask = {0,};</div><div class="line"><a name="l11093"></a><span class="lineno">11093</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l11094"></a><span class="lineno">11094</span>&#160;</div><div class="line"><a name="l11095"></a><span class="lineno">11095</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l11096"></a><span class="lineno">11096</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l11097"></a><span class="lineno">11097</span>&#160;         e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;queue reload {parameters|members|rules|all}&quot;</span>;</div><div class="line"><a name="l11098"></a><span class="lineno">11098</span>&#160;         e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l11099"></a><span class="lineno">11099</span>&#160;            <span class="stringliteral">&quot;Usage: queue reload {parameters|members|rules|all} [&lt;queuenames&gt;]\n&quot;</span></div><div class="line"><a name="l11100"></a><span class="lineno">11100</span>&#160;            <span class="stringliteral">&quot;Reload queues. If &lt;queuenames&gt; are specified, only reload information pertaining\n&quot;</span></div><div class="line"><a name="l11101"></a><span class="lineno">11101</span>&#160;            <span class="stringliteral">&quot;to &lt;queuenames&gt;. One of &#39;parameters,&#39; &#39;members,&#39; &#39;rules,&#39; or &#39;all&#39; must be\n&quot;</span></div><div class="line"><a name="l11102"></a><span class="lineno">11102</span>&#160;            <span class="stringliteral">&quot;specified in order to know what information to reload. Below is an explanation\n&quot;</span></div><div class="line"><a name="l11103"></a><span class="lineno">11103</span>&#160;            <span class="stringliteral">&quot;of each of these qualifiers.\n&quot;</span></div><div class="line"><a name="l11104"></a><span class="lineno">11104</span>&#160;            <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l11105"></a><span class="lineno">11105</span>&#160;            <span class="stringliteral">&quot;\t&#39;members&#39; - reload queue members from queues.conf\n&quot;</span></div><div class="line"><a name="l11106"></a><span class="lineno">11106</span>&#160;            <span class="stringliteral">&quot;\t&#39;parameters&#39; - reload all queue options except for queue members\n&quot;</span></div><div class="line"><a name="l11107"></a><span class="lineno">11107</span>&#160;            <span class="stringliteral">&quot;\t&#39;rules&#39; - reload the queuerules.conf file\n&quot;</span></div><div class="line"><a name="l11108"></a><span class="lineno">11108</span>&#160;            <span class="stringliteral">&quot;\t&#39;all&#39; - reload queue rules, parameters, and members\n&quot;</span></div><div class="line"><a name="l11109"></a><span class="lineno">11109</span>&#160;            <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l11110"></a><span class="lineno">11110</span>&#160;            <span class="stringliteral">&quot;Note: the &#39;rules&#39; qualifier here cannot actually be applied to a specific queue.\n&quot;</span></div><div class="line"><a name="l11111"></a><span class="lineno">11111</span>&#160;            <span class="stringliteral">&quot;Use of the &#39;rules&#39; qualifier causes queuerules.conf to be reloaded. Even if only\n&quot;</span></div><div class="line"><a name="l11112"></a><span class="lineno">11112</span>&#160;            <span class="stringliteral">&quot;one queue is specified when using this command, reloading queue rules may cause\n&quot;</span></div><div class="line"><a name="l11113"></a><span class="lineno">11113</span>&#160;            <span class="stringliteral">&quot;other queues to be affected\n&quot;</span>;</div><div class="line"><a name="l11114"></a><span class="lineno">11114</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11115"></a><span class="lineno">11115</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l11116"></a><span class="lineno">11116</span>&#160;         <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> &gt;= 3) {</div><div class="line"><a name="l11117"></a><span class="lineno">11117</span>&#160;            <span class="comment">/* find the point at which the list of queue names starts */</span></div><div class="line"><a name="l11118"></a><span class="lineno">11118</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *command_end = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a> + strlen(<span class="stringliteral">&quot;queue reload &quot;</span>);</div><div class="line"><a name="l11119"></a><span class="lineno">11119</span>&#160;            command_end = strchr(command_end, <span class="charliteral">&#39; &#39;</span>);</div><div class="line"><a name="l11120"></a><span class="lineno">11120</span>&#160;            <span class="keywordflow">if</span> (!command_end) {</div><div class="line"><a name="l11121"></a><span class="lineno">11121</span>&#160;               command_end = a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a> + strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>);</div><div class="line"><a name="l11122"></a><span class="lineno">11122</span>&#160;            }</div><div class="line"><a name="l11123"></a><span class="lineno">11123</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>, command_end - a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">line</a>);</div><div class="line"><a name="l11124"></a><span class="lineno">11124</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l11125"></a><span class="lineno">11125</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11126"></a><span class="lineno">11126</span>&#160;         }</div><div class="line"><a name="l11127"></a><span class="lineno">11127</span>&#160;   }</div><div class="line"><a name="l11128"></a><span class="lineno">11128</span>&#160;</div><div class="line"><a name="l11129"></a><span class="lineno">11129</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &lt; 3)</div><div class="line"><a name="l11130"></a><span class="lineno">11130</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l11131"></a><span class="lineno">11131</span>&#160;</div><div class="line"><a name="l11132"></a><span class="lineno">11132</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], <span class="stringliteral">&quot;rules&quot;</span>)) {</div><div class="line"><a name="l11133"></a><span class="lineno">11133</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a04da28a6a506fbc6dfce3f3da3569acc">QUEUE_RELOAD_RULES</a>);</div><div class="line"><a name="l11134"></a><span class="lineno">11134</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], <span class="stringliteral">&quot;members&quot;</span>)) {</div><div class="line"><a name="l11135"></a><span class="lineno">11135</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f">QUEUE_RELOAD_MEMBER</a>);</div><div class="line"><a name="l11136"></a><span class="lineno">11136</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], <span class="stringliteral">&quot;parameters&quot;</span>)) {</div><div class="line"><a name="l11137"></a><span class="lineno">11137</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44">QUEUE_RELOAD_PARAMETERS</a>);</div><div class="line"><a name="l11138"></a><span class="lineno">11138</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], <span class="stringliteral">&quot;all&quot;</span>)) {</div><div class="line"><a name="l11139"></a><span class="lineno">11139</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;mask, <a class="code" href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a>);</div><div class="line"><a name="l11140"></a><span class="lineno">11140</span>&#160;   }</div><div class="line"><a name="l11141"></a><span class="lineno">11141</span>&#160;</div><div class="line"><a name="l11142"></a><span class="lineno">11142</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 3) {</div><div class="line"><a name="l11143"></a><span class="lineno">11143</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(1, &amp;mask, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l11144"></a><span class="lineno">11144</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l11145"></a><span class="lineno">11145</span>&#160;   }</div><div class="line"><a name="l11146"></a><span class="lineno">11146</span>&#160;</div><div class="line"><a name="l11147"></a><span class="lineno">11147</span>&#160;   <span class="keywordflow">for</span> (i = 3; i &lt; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a>; ++i) {</div><div class="line"><a name="l11148"></a><span class="lineno">11148</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(1, &amp;mask, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[i]);</div><div class="line"><a name="l11149"></a><span class="lineno">11149</span>&#160;   }</div><div class="line"><a name="l11150"></a><span class="lineno">11150</span>&#160;</div><div class="line"><a name="l11151"></a><span class="lineno">11151</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l11152"></a><span class="lineno">11152</span>&#160;}</div><div class="line"><a name="l11153"></a><span class="lineno">11153</span>&#160;<span class="comment"></span></div><div class="line"><a name="l11154"></a><span class="lineno">11154</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l11155"></a><span class="lineno">11155</span>&#160;<span class="comment"> * \brief Update Queue with data of an outgoing call</span></div><div class="line"><a name="l11156"></a><span class="lineno">11156</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l11157"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a78458fd1a0596bd7755bfbf47b360d1a">11157</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#a78458fd1a0596bd7755bfbf47b360d1a">qupd_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l11158"></a><span class="lineno">11158</span>&#160;{</div><div class="line"><a name="l11159"></a><span class="lineno">11159</span>&#160;   <span class="keywordtype">int</span> oldtalktime;</div><div class="line"><a name="l11160"></a><span class="lineno">11160</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l11161"></a><span class="lineno">11161</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l11162"></a><span class="lineno">11162</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem;</div><div class="line"><a name="l11163"></a><span class="lineno">11163</span>&#160;   <span class="keywordtype">int</span> newtalktime = 0;</div><div class="line"><a name="l11164"></a><span class="lineno">11164</span>&#160;</div><div class="line"><a name="l11165"></a><span class="lineno">11165</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l11166"></a><span class="lineno">11166</span>&#160;         <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(queuename);</div><div class="line"><a name="l11167"></a><span class="lineno">11167</span>&#160;         <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(uniqueid);</div><div class="line"><a name="l11168"></a><span class="lineno">11168</span>&#160;         <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(agent);</div><div class="line"><a name="l11169"></a><span class="lineno">11169</span>&#160;         <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>);</div><div class="line"><a name="l11170"></a><span class="lineno">11170</span>&#160;         <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(talktime);</div><div class="line"><a name="l11171"></a><span class="lineno">11171</span>&#160;         <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(params););</div><div class="line"><a name="l11172"></a><span class="lineno">11172</span>&#160;</div><div class="line"><a name="l11173"></a><span class="lineno">11173</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data)) {</div><div class="line"><a name="l11174"></a><span class="lineno">11174</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;QueueUpdate requires arguments (queuename,uniqueid,agent,status,talktime,params[totaltime,callednumber])\n&quot;</span>);</div><div class="line"><a name="l11175"></a><span class="lineno">11175</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l11176"></a><span class="lineno">11176</span>&#160;   }</div><div class="line"><a name="l11177"></a><span class="lineno">11177</span>&#160;</div><div class="line"><a name="l11178"></a><span class="lineno">11178</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l11179"></a><span class="lineno">11179</span>&#160;</div><div class="line"><a name="l11180"></a><span class="lineno">11180</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l11181"></a><span class="lineno">11181</span>&#160;</div><div class="line"><a name="l11182"></a><span class="lineno">11182</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.uniqueid) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.status)) {</div><div class="line"><a name="l11183"></a><span class="lineno">11183</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Missing argument to QueueUpdate (queuename,uniqueid,agent,status,talktime,params[totaltime|callednumber])\n&quot;</span>);</div><div class="line"><a name="l11184"></a><span class="lineno">11184</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l11185"></a><span class="lineno">11185</span>&#160;   }</div><div class="line"><a name="l11186"></a><span class="lineno">11186</span>&#160;</div><div class="line"><a name="l11187"></a><span class="lineno">11187</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.talktime)) {</div><div class="line"><a name="l11188"></a><span class="lineno">11188</span>&#160;      newtalktime = atoi(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.talktime);</div><div class="line"><a name="l11189"></a><span class="lineno">11189</span>&#160;   }</div><div class="line"><a name="l11190"></a><span class="lineno">11190</span>&#160;</div><div class="line"><a name="l11191"></a><span class="lineno">11191</span>&#160;   q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l11192"></a><span class="lineno">11192</span>&#160;   <span class="keywordflow">if</span> (!q) {</div><div class="line"><a name="l11193"></a><span class="lineno">11193</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;QueueUpdate could not find requested queue &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename);</div><div class="line"><a name="l11194"></a><span class="lineno">11194</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l11195"></a><span class="lineno">11195</span>&#160;   }</div><div class="line"><a name="l11196"></a><span class="lineno">11196</span>&#160;</div><div class="line"><a name="l11197"></a><span class="lineno">11197</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l11198"></a><span class="lineno">11198</span>&#160;   <span class="keywordflow">if</span> (q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>) {</div><div class="line"><a name="l11199"></a><span class="lineno">11199</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> mem_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, 0);</div><div class="line"><a name="l11200"></a><span class="lineno">11200</span>&#160;      <span class="keywordflow">while</span> ((mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;mem_iter))) {</div><div class="line"><a name="l11201"></a><span class="lineno">11201</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">membername</a>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent)) {</div><div class="line"><a name="l11202"></a><span class="lineno">11202</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.status, <span class="stringliteral">&quot;ANSWER&quot;</span>)) {</div><div class="line"><a name="l11203"></a><span class="lineno">11203</span>&#160;               oldtalktime = q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a>;</div><div class="line"><a name="l11204"></a><span class="lineno">11204</span>&#160;               q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">talktime</a> = (((oldtalktime &lt;&lt; 2) - oldtalktime) + newtalktime) &gt;&gt; 2;</div><div class="line"><a name="l11205"></a><span class="lineno">11205</span>&#160;               time(&amp;mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>);</div><div class="line"><a name="l11206"></a><span class="lineno">11206</span>&#160;               mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">calls</a>++;</div><div class="line"><a name="l11207"></a><span class="lineno">11207</span>&#160;               mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">lastqueue</a> = q;</div><div class="line"><a name="l11208"></a><span class="lineno">11208</span>&#160;               q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">callscompleted</a>++;</div><div class="line"><a name="l11209"></a><span class="lineno">11209</span>&#160;</div><div class="line"><a name="l11210"></a><span class="lineno">11210</span>&#160;               <span class="keywordflow">if</span> (newtalktime &lt;= q-&gt;servicelevel) {</div><div class="line"><a name="l11211"></a><span class="lineno">11211</span>&#160;                  q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">callscompletedinsl</a>++;</div><div class="line"><a name="l11212"></a><span class="lineno">11212</span>&#160;               }</div><div class="line"><a name="l11213"></a><span class="lineno">11213</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l11214"></a><span class="lineno">11214</span>&#160;</div><div class="line"><a name="l11215"></a><span class="lineno">11215</span>&#160;               time(&amp;mem-&gt;<a class="code" href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">lastcall</a>);</div><div class="line"><a name="l11216"></a><span class="lineno">11216</span>&#160;               q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">callsabandoned</a>++;</div><div class="line"><a name="l11217"></a><span class="lineno">11217</span>&#160;            }</div><div class="line"><a name="l11218"></a><span class="lineno">11218</span>&#160;</div><div class="line"><a name="l11219"></a><span class="lineno">11219</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.queuename, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.uniqueid, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent, <span class="stringliteral">&quot;OUTCALL&quot;</span>, <span class="stringliteral">&quot;%s|%s|%s&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.status, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.talktime, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.params);</div><div class="line"><a name="l11220"></a><span class="lineno">11220</span>&#160;         }</div><div class="line"><a name="l11221"></a><span class="lineno">11221</span>&#160;</div><div class="line"><a name="l11222"></a><span class="lineno">11222</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mem, -1);</div><div class="line"><a name="l11223"></a><span class="lineno">11223</span>&#160;      }</div><div class="line"><a name="l11224"></a><span class="lineno">11224</span>&#160;</div><div class="line"><a name="l11225"></a><span class="lineno">11225</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;mem_iter);</div><div class="line"><a name="l11226"></a><span class="lineno">11226</span>&#160;   }</div><div class="line"><a name="l11227"></a><span class="lineno">11227</span>&#160;</div><div class="line"><a name="l11228"></a><span class="lineno">11228</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l11229"></a><span class="lineno">11229</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Done with temporary pointer&quot;</span>);</div><div class="line"><a name="l11230"></a><span class="lineno">11230</span>&#160;</div><div class="line"><a name="l11231"></a><span class="lineno">11231</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l11232"></a><span class="lineno">11232</span>&#160;}</div><div class="line"><a name="l11233"></a><span class="lineno">11233</span>&#160;</div><div class="line"><a name="l11234"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ae88eeca2bab42ff051da9157696726d4">11234</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> <a class="code" href="../../da/dfb/app__queue_8c.html#ae88eeca2bab42ff051da9157696726d4">cli_queue</a>[] = {</div><div class="line"><a name="l11235"></a><span class="lineno">11235</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a8f11ecb2ece22635477ca2ee913b39e3">queue_show</a>, <span class="stringliteral">&quot;Show status of a specified queue&quot;</span>),</div><div class="line"><a name="l11236"></a><span class="lineno">11236</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#aa69c5e8b97eda56a099f72a195f28bea">handle_queue_rule_show</a>, <span class="stringliteral">&quot;Show the rules defined in queuerules.conf&quot;</span>),</div><div class="line"><a name="l11237"></a><span class="lineno">11237</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a809b8e2a1be84c1a33a191a1c8ed549f">handle_queue_add_member</a>, <span class="stringliteral">&quot;Add a channel to a specified queue&quot;</span>),</div><div class="line"><a name="l11238"></a><span class="lineno">11238</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a9b97d0ffb7e1a6127de3acc037ea464b">handle_queue_remove_member</a>, <span class="stringliteral">&quot;Removes a channel from a specified queue&quot;</span>),</div><div class="line"><a name="l11239"></a><span class="lineno">11239</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a8cd08f19554c293e7455c33b6b225d0a">handle_queue_pause_member</a>, <span class="stringliteral">&quot;Pause or unpause a queue member&quot;</span>),</div><div class="line"><a name="l11240"></a><span class="lineno">11240</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#ab8cbb9ecaec149b8f265951980818cfc">handle_queue_set_member_penalty</a>, <span class="stringliteral">&quot;Set penalty for a channel of a specified queue&quot;</span>),</div><div class="line"><a name="l11241"></a><span class="lineno">11241</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#aec2dcfe87edd23912e4e94c46085af2c">handle_queue_set_member_ringinuse</a>, <span class="stringliteral">&quot;Set ringinuse for a channel of a specified queue&quot;</span>),</div><div class="line"><a name="l11242"></a><span class="lineno">11242</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a22f7d751732c215b14ab3e80aec3f541">handle_queue_reload</a>, <span class="stringliteral">&quot;Reload queues, members, queue rules, or parameters&quot;</span>),</div><div class="line"><a name="l11243"></a><span class="lineno">11243</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#aab6f3afb06683e692b69f0e886c0bedb">handle_queue_reset</a>, <span class="stringliteral">&quot;Reset statistics for a queue&quot;</span>),</div><div class="line"><a name="l11244"></a><span class="lineno">11244</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../da/dfb/app__queue_8c.html#a1b9f504553df5c7e9971f1ad3c695381">handle_queue_change_priority_caller</a>, <span class="stringliteral">&quot;Change priority caller on queue&quot;</span>),</div><div class="line"><a name="l11245"></a><span class="lineno">11245</span>&#160;};</div><div class="line"><a name="l11246"></a><span class="lineno">11246</span>&#160;</div><div class="line"><a name="l11247"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#abe2e63f4e5ce699214b75e7299ce924b">11247</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#abe2e63f4e5ce699214b75e7299ce924b">agent_router</a>;</div><div class="line"><a name="l11248"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aeb9ef797eacc8523239c5136cfb7677e">11248</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#aeb9ef797eacc8523239c5136cfb7677e">topic_forwarder</a>;</div><div class="line"><a name="l11249"></a><span class="lineno">11249</span>&#160;</div><div class="line"><a name="l11250"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">11250</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l11251"></a><span class="lineno">11251</span>&#160;{</div><div class="line"><a name="l11252"></a><span class="lineno">11252</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a641f77c471ff127e8586247ff6c0d64c">stasis_message_router_unsubscribe_and_join</a>(agent_router);</div><div class="line"><a name="l11253"></a><span class="lineno">11253</span>&#160;   agent_router = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11254"></a><span class="lineno">11254</span>&#160;</div><div class="line"><a name="l11255"></a><span class="lineno">11255</span>&#160;   topic_forwarder = <a class="code" href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a>(topic_forwarder);</div><div class="line"><a name="l11256"></a><span class="lineno">11256</span>&#160;</div><div class="line"><a name="l11257"></a><span class="lineno">11257</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_caller_join_type);</div><div class="line"><a name="l11258"></a><span class="lineno">11258</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_caller_leave_type);</div><div class="line"><a name="l11259"></a><span class="lineno">11259</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_caller_abandon_type);</div><div class="line"><a name="l11260"></a><span class="lineno">11260</span>&#160;</div><div class="line"><a name="l11261"></a><span class="lineno">11261</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_member_status_type);</div><div class="line"><a name="l11262"></a><span class="lineno">11262</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_member_added_type);</div><div class="line"><a name="l11263"></a><span class="lineno">11263</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_member_removed_type);</div><div class="line"><a name="l11264"></a><span class="lineno">11264</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_member_pause_type);</div><div class="line"><a name="l11265"></a><span class="lineno">11265</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_member_penalty_type);</div><div class="line"><a name="l11266"></a><span class="lineno">11266</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_member_ringinuse_type);</div><div class="line"><a name="l11267"></a><span class="lineno">11267</span>&#160;</div><div class="line"><a name="l11268"></a><span class="lineno">11268</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_agent_called_type);</div><div class="line"><a name="l11269"></a><span class="lineno">11269</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_agent_connect_type);</div><div class="line"><a name="l11270"></a><span class="lineno">11270</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_agent_complete_type);</div><div class="line"><a name="l11271"></a><span class="lineno">11271</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_agent_dump_type);</div><div class="line"><a name="l11272"></a><span class="lineno">11272</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(queue_agent_ringnoanswer_type);</div><div class="line"><a name="l11273"></a><span class="lineno">11273</span>&#160;</div><div class="line"><a name="l11274"></a><span class="lineno">11274</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(cli_queue, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_queue));</div><div class="line"><a name="l11275"></a><span class="lineno">11275</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueStatus&quot;</span>);</div><div class="line"><a name="l11276"></a><span class="lineno">11276</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueRule&quot;</span>);</div><div class="line"><a name="l11277"></a><span class="lineno">11277</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueSummary&quot;</span>);</div><div class="line"><a name="l11278"></a><span class="lineno">11278</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueAdd&quot;</span>);</div><div class="line"><a name="l11279"></a><span class="lineno">11279</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueRemove&quot;</span>);</div><div class="line"><a name="l11280"></a><span class="lineno">11280</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueuePause&quot;</span>);</div><div class="line"><a name="l11281"></a><span class="lineno">11281</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueLog&quot;</span>);</div><div class="line"><a name="l11282"></a><span class="lineno">11282</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueUpdate&quot;</span>);</div><div class="line"><a name="l11283"></a><span class="lineno">11283</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueuePenalty&quot;</span>);</div><div class="line"><a name="l11284"></a><span class="lineno">11284</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueReload&quot;</span>);</div><div class="line"><a name="l11285"></a><span class="lineno">11285</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueReset&quot;</span>);</div><div class="line"><a name="l11286"></a><span class="lineno">11286</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueMemberRingInUse&quot;</span>);</div><div class="line"><a name="l11287"></a><span class="lineno">11287</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;QueueChangePriorityCaller&quot;</span>);</div><div class="line"><a name="l11288"></a><span class="lineno">11288</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(app_aqm);</div><div class="line"><a name="l11289"></a><span class="lineno">11289</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(app_rqm);</div><div class="line"><a name="l11290"></a><span class="lineno">11290</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(app_pqm);</div><div class="line"><a name="l11291"></a><span class="lineno">11291</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(app_upqm);</div><div class="line"><a name="l11292"></a><span class="lineno">11292</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(app_ql);</div><div class="line"><a name="l11293"></a><span class="lineno">11293</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(app_qupd);</div><div class="line"><a name="l11294"></a><span class="lineno">11294</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(app);</div><div class="line"><a name="l11295"></a><span class="lineno">11295</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queueexists_function);</div><div class="line"><a name="l11296"></a><span class="lineno">11296</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queuevar_function);</div><div class="line"><a name="l11297"></a><span class="lineno">11297</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queuemembercount_function);</div><div class="line"><a name="l11298"></a><span class="lineno">11298</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queuemembercount_dep);</div><div class="line"><a name="l11299"></a><span class="lineno">11299</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queuememberlist_function);</div><div class="line"><a name="l11300"></a><span class="lineno">11300</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queuegetchannel_function);</div><div class="line"><a name="l11301"></a><span class="lineno">11301</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queuewaitingcount_function);</div><div class="line"><a name="l11302"></a><span class="lineno">11302</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;queuememberpenalty_function);</div><div class="line"><a name="l11303"></a><span class="lineno">11303</span>&#160;</div><div class="line"><a name="l11304"></a><span class="lineno">11304</span>&#160;   device_state_sub = <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(device_state_sub);</div><div class="line"><a name="l11305"></a><span class="lineno">11305</span>&#160;</div><div class="line"><a name="l11306"></a><span class="lineno">11306</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66b6af9ceef39cb23b48501efe87219f">ast_unload_realtime</a>(<span class="stringliteral">&quot;queue_members&quot;</span>);</div><div class="line"><a name="l11307"></a><span class="lineno">11307</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(queues);</div><div class="line"><a name="l11308"></a><span class="lineno">11308</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(pending_members);</div><div class="line"><a name="l11309"></a><span class="lineno">11309</span>&#160;</div><div class="line"><a name="l11310"></a><span class="lineno">11310</span>&#160;   queues = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11311"></a><span class="lineno">11311</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l11312"></a><span class="lineno">11312</span>&#160;}</div><div class="line"><a name="l11313"></a><span class="lineno">11313</span>&#160;<span class="comment"></span></div><div class="line"><a name="l11314"></a><span class="lineno">11314</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l11315"></a><span class="lineno">11315</span>&#160;<span class="comment"> * \brief Load the module</span></div><div class="line"><a name="l11316"></a><span class="lineno">11316</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l11317"></a><span class="lineno">11317</span>&#160;<span class="comment"> * Module loading including tests for configuration or dependencies.</span></div><div class="line"><a name="l11318"></a><span class="lineno">11318</span>&#160;<span class="comment"> * This function can return AST_MODULE_LOAD_FAILURE, AST_MODULE_LOAD_DECLINE,</span></div><div class="line"><a name="l11319"></a><span class="lineno">11319</span>&#160;<span class="comment"> * or AST_MODULE_LOAD_SUCCESS. If a dependency or environment variable fails</span></div><div class="line"><a name="l11320"></a><span class="lineno">11320</span>&#160;<span class="comment"> * tests return AST_MODULE_LOAD_FAILURE. If the module can not load the</span></div><div class="line"><a name="l11321"></a><span class="lineno">11321</span>&#160;<span class="comment"> * configuration file or other non-critical problem return</span></div><div class="line"><a name="l11322"></a><span class="lineno">11322</span>&#160;<span class="comment"> * AST_MODULE_LOAD_DECLINE. On success return AST_MODULE_LOAD_SUCCESS.</span></div><div class="line"><a name="l11323"></a><span class="lineno">11323</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l11324"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">11324</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l11325"></a><span class="lineno">11325</span>&#160;{</div><div class="line"><a name="l11326"></a><span class="lineno">11326</span>&#160;   <span class="keywordtype">int</span> err = 0;</div><div class="line"><a name="l11327"></a><span class="lineno">11327</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> mask = {<a class="code" href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a>, };</div><div class="line"><a name="l11328"></a><span class="lineno">11328</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *member_config;</div><div class="line"><a name="l11329"></a><span class="lineno">11329</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *queue_topic;</div><div class="line"><a name="l11330"></a><span class="lineno">11330</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#gadeff73697d2789905f4c3a21671ef6d3">manager_topic</a>;</div><div class="line"><a name="l11331"></a><span class="lineno">11331</span>&#160;</div><div class="line"><a name="l11332"></a><span class="lineno">11332</span>&#160;   queues = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../da/dfb/app__queue_8c.html#a318c21ecadbe981df2771149df1ed361">MAX_QUEUE_BUCKETS</a>,</div><div class="line"><a name="l11333"></a><span class="lineno">11333</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a9f81db529b7d97134601164c43a945f2">queue_hash_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a9a488aa902d38d97f26bbfbb59a22e2b">queue_cmp_cb</a>);</div><div class="line"><a name="l11334"></a><span class="lineno">11334</span>&#160;   <span class="keywordflow">if</span> (!queues) {</div><div class="line"><a name="l11335"></a><span class="lineno">11335</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11336"></a><span class="lineno">11336</span>&#160;   }</div><div class="line"><a name="l11337"></a><span class="lineno">11337</span>&#160;</div><div class="line"><a name="l11338"></a><span class="lineno">11338</span>&#160;   pending_members = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l11339"></a><span class="lineno">11339</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a563ce4840e1461a302bd2af34d404f38">MAX_CALL_ATTEMPT_BUCKETS</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#ab1e47d681926f94694873b3ce842dfbe">pending_members_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a1d03e640ed40f48f1cec61cac6d569ab">pending_members_cmp</a>);</div><div class="line"><a name="l11340"></a><span class="lineno">11340</span>&#160;   <span class="keywordflow">if</span> (!pending_members) {</div><div class="line"><a name="l11341"></a><span class="lineno">11341</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l11342"></a><span class="lineno">11342</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11343"></a><span class="lineno">11343</span>&#160;   }</div><div class="line"><a name="l11344"></a><span class="lineno">11344</span>&#160;</div><div class="line"><a name="l11345"></a><span class="lineno">11345</span>&#160;   use_weight = 0;</div><div class="line"><a name="l11346"></a><span class="lineno">11346</span>&#160;</div><div class="line"><a name="l11347"></a><span class="lineno">11347</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(0, &amp;mask, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l11348"></a><span class="lineno">11348</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l11349"></a><span class="lineno">11349</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11350"></a><span class="lineno">11350</span>&#160;   }</div><div class="line"><a name="l11351"></a><span class="lineno">11351</span>&#160;</div><div class="line"><a name="l11352"></a><span class="lineno">11352</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a403ec8b49645ea204e82cb72bb8cf9f4">ast_realtime_require_field</a>(<span class="stringliteral">&quot;queue_members&quot;</span>, <span class="stringliteral">&quot;paused&quot;</span>, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#abbca034b0a98715c687b808347af82a3a7b4a9e81298a296d3e066ed369727cc4">RQ_INTEGER1</a>, 1, <span class="stringliteral">&quot;uniqueid&quot;</span>, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#abbca034b0a98715c687b808347af82a3a1ab15af464bf1838c9ca91d32ca7a2a1">RQ_UINTEGER2</a>, 5, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l11353"></a><span class="lineno">11353</span>&#160;</div><div class="line"><a name="l11354"></a><span class="lineno">11354</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l11355"></a><span class="lineno">11355</span>&#160;<span class="comment">    * This section is used to determine which name for &#39;ringinuse&#39; to use in realtime members</span></div><div class="line"><a name="l11356"></a><span class="lineno">11356</span>&#160;<span class="comment">    * Necessary for supporting older setups.</span></div><div class="line"><a name="l11357"></a><span class="lineno">11357</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l11358"></a><span class="lineno">11358</span>&#160;   member_config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a29ff8cd717c0c0bac60abbd827fec409">ast_load_realtime_multientry</a>(<span class="stringliteral">&quot;queue_members&quot;</span>, <span class="stringliteral">&quot;interface LIKE&quot;</span>, <span class="stringliteral">&quot;%&quot;</span>, <span class="stringliteral">&quot;queue_name LIKE&quot;</span>, <span class="stringliteral">&quot;%&quot;</span>, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l11359"></a><span class="lineno">11359</span>&#160;   <span class="keywordflow">if</span> (!member_config) {</div><div class="line"><a name="l11360"></a><span class="lineno">11360</span>&#160;      realtime_ringinuse_field = <span class="stringliteral">&quot;ringinuse&quot;</span>;</div><div class="line"><a name="l11361"></a><span class="lineno">11361</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l11362"></a><span class="lineno">11362</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *config_val;</div><div class="line"><a name="l11363"></a><span class="lineno">11363</span>&#160;</div><div class="line"><a name="l11364"></a><span class="lineno">11364</span>&#160;      <span class="keywordflow">if</span> ((config_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;ringinuse&quot;</span>))) {</div><div class="line"><a name="l11365"></a><span class="lineno">11365</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;ringinuse field entries found in queue_members table. Using &#39;ringinuse&#39;\n&quot;</span>);</div><div class="line"><a name="l11366"></a><span class="lineno">11366</span>&#160;         realtime_ringinuse_field = <span class="stringliteral">&quot;ringinuse&quot;</span>;</div><div class="line"><a name="l11367"></a><span class="lineno">11367</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((config_val = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(member_config, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;ignorebusy&quot;</span>))) {</div><div class="line"><a name="l11368"></a><span class="lineno">11368</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;ignorebusy field found in queue_members table with no ringinuse field. Using &#39;ignorebusy&#39;\n&quot;</span>);</div><div class="line"><a name="l11369"></a><span class="lineno">11369</span>&#160;         realtime_ringinuse_field = <span class="stringliteral">&quot;ignorebusy&quot;</span>;</div><div class="line"><a name="l11370"></a><span class="lineno">11370</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l11371"></a><span class="lineno">11371</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;No entries were found for ringinuse/ignorebusy in queue_members table. Using &#39;ringinuse&#39;\n&quot;</span>);</div><div class="line"><a name="l11372"></a><span class="lineno">11372</span>&#160;         realtime_ringinuse_field = <span class="stringliteral">&quot;ringinuse&quot;</span>;</div><div class="line"><a name="l11373"></a><span class="lineno">11373</span>&#160;      }</div><div class="line"><a name="l11374"></a><span class="lineno">11374</span>&#160;   }</div><div class="line"><a name="l11375"></a><span class="lineno">11375</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(member_config);</div><div class="line"><a name="l11376"></a><span class="lineno">11376</span>&#160;</div><div class="line"><a name="l11377"></a><span class="lineno">11377</span>&#160;   <span class="keywordflow">if</span> (queue_persistent_members) {</div><div class="line"><a name="l11378"></a><span class="lineno">11378</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a4a18e85dad5b206bccd39112cf9d0002">reload_queue_members</a>();</div><div class="line"><a name="l11379"></a><span class="lineno">11379</span>&#160;   }</div><div class="line"><a name="l11380"></a><span class="lineno">11380</span>&#160;</div><div class="line"><a name="l11381"></a><span class="lineno">11381</span>&#160;   err |= <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(cli_queue, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_queue));</div><div class="line"><a name="l11382"></a><span class="lineno">11382</span>&#160;   err |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(app, <a class="code" href="../../da/dfb/app__queue_8c.html#aa4019656b705c76e4475a9e8fc0c4116">queue_exec</a>);</div><div class="line"><a name="l11383"></a><span class="lineno">11383</span>&#160;   err |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(app_aqm, <a class="code" href="../../da/dfb/app__queue_8c.html#a2feb2a31bf81358e86919381547161ac">aqm_exec</a>);</div><div class="line"><a name="l11384"></a><span class="lineno">11384</span>&#160;   err |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(app_rqm, <a class="code" href="../../da/dfb/app__queue_8c.html#a4d4a25d601ed08189ac3fa379f9f5145">rqm_exec</a>);</div><div class="line"><a name="l11385"></a><span class="lineno">11385</span>&#160;   err |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(app_pqm, <a class="code" href="../../da/dfb/app__queue_8c.html#a70c5fe5519fb5cbb2aa683c7a49ef04b">pqm_exec</a>);</div><div class="line"><a name="l11386"></a><span class="lineno">11386</span>&#160;   err |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(app_upqm, <a class="code" href="../../da/dfb/app__queue_8c.html#a3f4703e2907ef0ff09af7be1332ddb5a">upqm_exec</a>);</div><div class="line"><a name="l11387"></a><span class="lineno">11387</span>&#160;   err |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(app_ql, <a class="code" href="../../da/dfb/app__queue_8c.html#abac35567c42a41eb955ba8879bffa15d">ql_exec</a>);</div><div class="line"><a name="l11388"></a><span class="lineno">11388</span>&#160;   err |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(app_qupd, <a class="code" href="../../da/dfb/app__queue_8c.html#a78458fd1a0596bd7755bfbf47b360d1a">qupd_exec</a>);</div><div class="line"><a name="l11389"></a><span class="lineno">11389</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueStatus&quot;</span>, 0, <a class="code" href="../../da/dfb/app__queue_8c.html#ad2bd8d5629fdba7d86c59b7d72c892a7">manager_queues_status</a>);</div><div class="line"><a name="l11390"></a><span class="lineno">11390</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueSummary&quot;</span>, 0, <a class="code" href="../../da/dfb/app__queue_8c.html#ace5e218ac5b4850ddcf7cb1a9866da6b">manager_queues_summary</a>);</div><div class="line"><a name="l11391"></a><span class="lineno">11391</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueAdd&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a2ec48379febcdee77d6c659269714dd6">manager_add_queue_member</a>);</div><div class="line"><a name="l11392"></a><span class="lineno">11392</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueRemove&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#abbeea50ec5fd219991763c7a848464ea">manager_remove_queue_member</a>);</div><div class="line"><a name="l11393"></a><span class="lineno">11393</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueuePause&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#ab294d279fc57c00a43df3d8783e10dcf">manager_pause_queue_member</a>);</div><div class="line"><a name="l11394"></a><span class="lineno">11394</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueLog&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#afc981f304f48009b383c870db6aac776">manager_queue_log_custom</a>);</div><div class="line"><a name="l11395"></a><span class="lineno">11395</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueuePenalty&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a90a66cbfb007419fb44ca4426265a03d">manager_queue_member_penalty</a>);</div><div class="line"><a name="l11396"></a><span class="lineno">11396</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueMemberRingInUse&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a8292022a7532175e3af8a5a67f87de9c">manager_queue_member_ringinuse</a>);</div><div class="line"><a name="l11397"></a><span class="lineno">11397</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueRule&quot;</span>, 0, <a class="code" href="../../da/dfb/app__queue_8c.html#a5b0161cb9388c7e8886b1b35a9b54fdc">manager_queue_rule_show</a>);</div><div class="line"><a name="l11398"></a><span class="lineno">11398</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueReload&quot;</span>, 0, <a class="code" href="../../da/dfb/app__queue_8c.html#a6eb92f6a70762912ce80b53e9282204a">manager_queue_reload</a>);</div><div class="line"><a name="l11399"></a><span class="lineno">11399</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueReset&quot;</span>, 0, <a class="code" href="../../da/dfb/app__queue_8c.html#a14d56b1e279722b17bc293e06c099b6b">manager_queue_reset</a>);</div><div class="line"><a name="l11400"></a><span class="lineno">11400</span>&#160;   err |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;QueueChangePriorityCaller&quot;</span>, 0,  <a class="code" href="../../da/dfb/app__queue_8c.html#af9ba6814d17cb9a49be24f92cb660645">manager_change_priority_caller_on_queue</a>);</div><div class="line"><a name="l11401"></a><span class="lineno">11401</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queuevar_function);</div><div class="line"><a name="l11402"></a><span class="lineno">11402</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queueexists_function);</div><div class="line"><a name="l11403"></a><span class="lineno">11403</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queuemembercount_function);</div><div class="line"><a name="l11404"></a><span class="lineno">11404</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queuemembercount_dep);</div><div class="line"><a name="l11405"></a><span class="lineno">11405</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queuememberlist_function);</div><div class="line"><a name="l11406"></a><span class="lineno">11406</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queuegetchannel_function);</div><div class="line"><a name="l11407"></a><span class="lineno">11407</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queuewaitingcount_function);</div><div class="line"><a name="l11408"></a><span class="lineno">11408</span>&#160;   err |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;queuememberpenalty_function);</div><div class="line"><a name="l11409"></a><span class="lineno">11409</span>&#160;</div><div class="line"><a name="l11410"></a><span class="lineno">11410</span>&#160;   <span class="comment">/* in the following subscribe call, do I use DEVICE_STATE, or DEVICE_STATE_CHANGE? */</span></div><div class="line"><a name="l11411"></a><span class="lineno">11411</span>&#160;   device_state_sub = <a class="code" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>(<a class="code" href="../../da/da2/devicestate_8h.html#a9fa7376e8e627cf5a512209005692013">ast_device_state_topic_all</a>(), <a class="code" href="../../da/dfb/app__queue_8c.html#ac1dd446fcf3d75d5da9228faf2dce1d3">device_state_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l11412"></a><span class="lineno">11412</span>&#160;   <span class="keywordflow">if</span> (!device_state_sub) {</div><div class="line"><a name="l11413"></a><span class="lineno">11413</span>&#160;      err = -1;</div><div class="line"><a name="l11414"></a><span class="lineno">11414</span>&#160;   }</div><div class="line"><a name="l11415"></a><span class="lineno">11415</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(device_state_sub, <a class="code" href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type</a>());</div><div class="line"><a name="l11416"></a><span class="lineno">11416</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(device_state_sub, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l11417"></a><span class="lineno">11417</span>&#160;</div><div class="line"><a name="l11418"></a><span class="lineno">11418</span>&#160;   manager_topic = <a class="code" href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a>();</div><div class="line"><a name="l11419"></a><span class="lineno">11419</span>&#160;   queue_topic = <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ade65e4a6a8802772595db25eb8e500ea">ast_queue_topic_all</a>();</div><div class="line"><a name="l11420"></a><span class="lineno">11420</span>&#160;   <span class="keywordflow">if</span> (!manager_topic || !queue_topic) {</div><div class="line"><a name="l11421"></a><span class="lineno">11421</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l11422"></a><span class="lineno">11422</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11423"></a><span class="lineno">11423</span>&#160;   }</div><div class="line"><a name="l11424"></a><span class="lineno">11424</span>&#160;   topic_forwarder = <a class="code" href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a>(queue_topic, manager_topic);</div><div class="line"><a name="l11425"></a><span class="lineno">11425</span>&#160;   <span class="keywordflow">if</span> (!topic_forwarder) {</div><div class="line"><a name="l11426"></a><span class="lineno">11426</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l11427"></a><span class="lineno">11427</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11428"></a><span class="lineno">11428</span>&#160;   }</div><div class="line"><a name="l11429"></a><span class="lineno">11429</span>&#160;</div><div class="line"><a name="l11430"></a><span class="lineno">11430</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga03332d35946786d0689462e58d01467a">ast_channel_agent_login_type</a>()</div><div class="line"><a name="l11431"></a><span class="lineno">11431</span>&#160;      || !<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga55d6d1e96f8f003200274d8756a9398a">ast_channel_agent_logoff_type</a>()) {</div><div class="line"><a name="l11432"></a><span class="lineno">11432</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l11433"></a><span class="lineno">11433</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11434"></a><span class="lineno">11434</span>&#160;   }</div><div class="line"><a name="l11435"></a><span class="lineno">11435</span>&#160;   agent_router = <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a1a1761c57f73009d305f95d8ad99e2a7">stasis_message_router_create</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga34a3ac59fb8d0c49cbc2cb9b87261d31">ast_channel_topic_all</a>());</div><div class="line"><a name="l11436"></a><span class="lineno">11436</span>&#160;   <span class="keywordflow">if</span> (!agent_router) {</div><div class="line"><a name="l11437"></a><span class="lineno">11437</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l11438"></a><span class="lineno">11438</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11439"></a><span class="lineno">11439</span>&#160;   }</div><div class="line"><a name="l11440"></a><span class="lineno">11440</span>&#160;   err |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(agent_router,</div><div class="line"><a name="l11441"></a><span class="lineno">11441</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga03332d35946786d0689462e58d01467a">ast_channel_agent_login_type</a>(),</div><div class="line"><a name="l11442"></a><span class="lineno">11442</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a45259088e42ad1164f934c4c20ba2bba">queue_agent_cb</a>,</div><div class="line"><a name="l11443"></a><span class="lineno">11443</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l11444"></a><span class="lineno">11444</span>&#160;   err |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(agent_router,</div><div class="line"><a name="l11445"></a><span class="lineno">11445</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga55d6d1e96f8f003200274d8756a9398a">ast_channel_agent_logoff_type</a>(),</div><div class="line"><a name="l11446"></a><span class="lineno">11446</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a45259088e42ad1164f934c4c20ba2bba">queue_agent_cb</a>,</div><div class="line"><a name="l11447"></a><span class="lineno">11447</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l11448"></a><span class="lineno">11448</span>&#160;</div><div class="line"><a name="l11449"></a><span class="lineno">11449</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_caller_join_type);</div><div class="line"><a name="l11450"></a><span class="lineno">11450</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_caller_leave_type);</div><div class="line"><a name="l11451"></a><span class="lineno">11451</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_caller_abandon_type);</div><div class="line"><a name="l11452"></a><span class="lineno">11452</span>&#160;</div><div class="line"><a name="l11453"></a><span class="lineno">11453</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_member_status_type);</div><div class="line"><a name="l11454"></a><span class="lineno">11454</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_member_added_type);</div><div class="line"><a name="l11455"></a><span class="lineno">11455</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_member_removed_type);</div><div class="line"><a name="l11456"></a><span class="lineno">11456</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_member_pause_type);</div><div class="line"><a name="l11457"></a><span class="lineno">11457</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_member_penalty_type);</div><div class="line"><a name="l11458"></a><span class="lineno">11458</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_member_ringinuse_type);</div><div class="line"><a name="l11459"></a><span class="lineno">11459</span>&#160;</div><div class="line"><a name="l11460"></a><span class="lineno">11460</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_agent_called_type);</div><div class="line"><a name="l11461"></a><span class="lineno">11461</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_agent_connect_type);</div><div class="line"><a name="l11462"></a><span class="lineno">11462</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_agent_complete_type);</div><div class="line"><a name="l11463"></a><span class="lineno">11463</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_agent_dump_type);</div><div class="line"><a name="l11464"></a><span class="lineno">11464</span>&#160;   err |= <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(queue_agent_ringnoanswer_type);</div><div class="line"><a name="l11465"></a><span class="lineno">11465</span>&#160;</div><div class="line"><a name="l11466"></a><span class="lineno">11466</span>&#160;   <span class="keywordflow">if</span> (err) {</div><div class="line"><a name="l11467"></a><span class="lineno">11467</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l11468"></a><span class="lineno">11468</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l11469"></a><span class="lineno">11469</span>&#160;   }</div><div class="line"><a name="l11470"></a><span class="lineno">11470</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l11471"></a><span class="lineno">11471</span>&#160;}</div><div class="line"><a name="l11472"></a><span class="lineno">11472</span>&#160;</div><div class="line"><a name="l11473"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">11473</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l11474"></a><span class="lineno">11474</span>&#160;{</div><div class="line"><a name="l11475"></a><span class="lineno">11475</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> mask = {<a class="code" href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a> &amp; ~<a class="code" href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c">QUEUE_RESET_STATS</a>,};</div><div class="line"><a name="l11476"></a><span class="lineno">11476</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66b6af9ceef39cb23b48501efe87219f">ast_unload_realtime</a>(<span class="stringliteral">&quot;queue_members&quot;</span>);</div><div class="line"><a name="l11477"></a><span class="lineno">11477</span>&#160;   <a class="code" href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a>(1, &amp;mask, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l11478"></a><span class="lineno">11478</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l11479"></a><span class="lineno">11479</span>&#160;}</div><div class="line"><a name="l11480"></a><span class="lineno">11480</span>&#160;</div><div class="line"><a name="l11481"></a><span class="lineno">11481</span>&#160;<span class="comment">/* \brief Find a member by looking up queuename and interface.</span></div><div class="line"><a name="l11482"></a><span class="lineno">11482</span>&#160;<span class="comment"> * \return Returns a member or NULL if member not found.</span></div><div class="line"><a name="l11483"></a><span class="lineno">11483</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l11484"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#aa9439de0855115f7361b2ca30ce71af1">11484</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#aa9439de0855115f7361b2ca30ce71af1">find_member_by_queuename_and_interface</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">interface</a>)</div><div class="line"><a name="l11485"></a><span class="lineno">11485</span>&#160;{</div><div class="line"><a name="l11486"></a><span class="lineno">11486</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/dd6/structmember.html">member</a> *mem = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l11487"></a><span class="lineno">11487</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db5/structcall__queue.html">call_queue</a> *q;</div><div class="line"><a name="l11488"></a><span class="lineno">11488</span>&#160;</div><div class="line"><a name="l11489"></a><span class="lineno">11489</span>&#160;   <span class="keywordflow">if</span> ((q = <a class="code" href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a>(queuename))) {</div><div class="line"><a name="l11490"></a><span class="lineno">11490</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(q);</div><div class="line"><a name="l11491"></a><span class="lineno">11491</span>&#160;      mem = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(q-&gt;<a class="code" href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">members</a>, interface, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l11492"></a><span class="lineno">11492</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(q);</div><div class="line"><a name="l11493"></a><span class="lineno">11493</span>&#160;      <a class="code" href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a>(q, <span class="stringliteral">&quot;Expiring temporary reference.&quot;</span>);</div><div class="line"><a name="l11494"></a><span class="lineno">11494</span>&#160;   }</div><div class="line"><a name="l11495"></a><span class="lineno">11495</span>&#160;   <span class="keywordflow">return</span> mem;</div><div class="line"><a name="l11496"></a><span class="lineno">11496</span>&#160;}</div><div class="line"><a name="l11497"></a><span class="lineno">11497</span>&#160;</div><div class="line"><a name="l11498"></a><span class="lineno">11498</span>&#160;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a>(<a class="code" href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a>, <a class="code" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a>, <span class="stringliteral">&quot;True Call Queueing&quot;</span>,</div><div class="line"><a name="l11499"></a><span class="lineno">11499</span>&#160;   .support_level = <a class="code" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>,</div><div class="line"><a name="l11500"></a><span class="lineno">11500</span>&#160;   .load = <a class="code" href="../../da/dfb/app__queue_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>,</div><div class="line"><a name="l11501"></a><span class="lineno">11501</span>&#160;   .unload = <a class="code" href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>,</div><div class="line"><a name="l11502"></a><span class="lineno">11502</span>&#160;   .<a class="code" href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>,</div><div class="line"><a name="l11503"></a><span class="lineno">11503</span>&#160;   .load_pri = <a class="code" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58ac8f668d27e0baf549e54a5e71da40c13">AST_MODPRI_DEVSTATE_CONSUMER</a>,</div><div class="line"><a name="l11504"></a><span class="lineno">11504</span>&#160;   .optional_modules = <span class="stringliteral">&quot;res_monitor&quot;</span>,</div><div class="line"><a name="l11505"></a><span class="lineno"><a class="line" href="../../da/dfb/app__queue_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">11505</a></span>&#160;);</div><div class="ttc" id="stasis__bridges_8h_html_af3a657a2b25861869f8b0e67f0eaa950a70f8fe62b08cc358ba25a274626ac515"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950a70f8fe62b08cc358ba25a274626ac515">AST_ATTENDED_TRANSFER_DEST_BRIDGE_MERGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00305">stasis_bridges.h:305</a></div></div>
<div class="ttc" id="app__queue_8c_html_a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a81bf731ee308fb06447d09c508221ee3">MEMBER_PENALTY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01631">app_queue.c:1631</a></div></div>
<div class="ttc" id="structast__custom__function_html_afcd1706c9144e6d6eee6127661ae3be2"><div class="ttname"><a href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">ast_custom_function::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00119">pbx.h:119</a></div></div>
<div class="ttc" id="structpenalty__rule_html_a2af6b4046a27a2bf36d092c30b8fb2da"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#a2af6b4046a27a2bf36d092c30b8fb2da">penalty_rule::raise_value</a></div><div class="ttdeci">int raise_value</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01644">app_queue.c:1644</a></div></div>
<div class="ttc" id="channel_8h_html_ac2dc872b606534943c98304aed841b34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a></div><div class="ttdeci">struct ast_party_caller * ast_channel_caller(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00888">channel_internal_api.c:888</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6fdd4581a4a8945d35a54bb170b21ac6"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6fdd4581a4a8945d35a54bb170b21ac6">get_member_penalty</a></div><div class="ttdeci">static int get_member_penalty(char *queuename, char *interface)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07740">app_queue.c:7740</a></div></div>
<div class="ttc" id="structcall__queue_html_a105b54b12ae3aab330cdcce0b6d71953"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a105b54b12ae3aab330cdcce0b6d71953">call_queue::sound_periodicannounce</a></div><div class="ttdeci">struct ast_str * sound_periodicannounce[MAX_PERIODIC_ANNOUNCEMENTS]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01698">app_queue.c:1698</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a1a03993603e2bc2463153857836645bb"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a1a03993603e2bc2463153857836645bb">ast_load_realtime</a></div><div class="ttdeci">struct ast_variable * ast_load_realtime(const char *family,...) attribute_sentinel</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03339">main/config.c:3339</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa08d109f431a880fd7c401d6f2e58d25"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa08d109f431a880fd7c401d6f2e58d25">queue_function_qac_dep</a></div><div class="ttdeci">static int queue_function_qac_dep(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">Get the total number of members in a specific queue (Deprecated) </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08806">app_queue.c:8806</a></div></div>
<div class="ttc" id="structast__variable_html_afaaf66cc5029a563bd0bb9df076ea14b"><div class="ttname"><a href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">ast_variable::next</a></div><div class="ttdeci">struct ast_variable * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">include/asterisk/config.h:90</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a05b1c5a7666e29a9ec982e3c9d6c1b85"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a05b1c5a7666e29a9ec982e3c9d6c1b85">ast_blind_transfer_type</a></div><div class="ttdeci">struct stasis_message_type * ast_blind_transfer_type(void)</div><div class="ttdoc">Message type for ast_blind_transfer_message. </div></div>
<div class="ttc" id="channel_8h_html_af10e3bd01602095e1908d3926afc3b76"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af10e3bd01602095e1908d3926afc3b76">ast_safe_sleep</a></div><div class="ttdeci">int ast_safe_sleep(struct ast_channel *chan, int ms)</div><div class="ttdoc">Wait for a specified amount of time, looking for hangups. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01574">channel.c:1574</a></div></div>
<div class="ttc" id="channel_8h_html_aec8ce59b78afbd3651f3de011f13290a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aec8ce59b78afbd3651f3de011f13290a">ast_waitfor_n</a></div><div class="ttdeci">struct ast_channel * ast_waitfor_n(struct ast_channel **chan, int n, int *ms)</div><div class="ttdoc">Waits for input on a group of channels Wait for input on an array of channels for a given # of millis...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l03166">channel.c:3166</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a9a2af6e4da551e6d05da960a6f2432ab"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a9a2af6e4da551e6d05da960a6f2432ab">queue_stasis_data::callcompletedinsl</a></div><div class="ttdeci">int callcompletedinsl</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05977">app_queue.c:5977</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6af68e289850cc046b29075b71cc9b2d2c">QUEUE_EMPTY_PAUSED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01621">app_queue.c:1621</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab9c47b132cfd5583a8814e9e817baa5e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab9c47b132cfd5583a8814e9e817baa5e">queue_member_added_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_member_added_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02040">app_queue.c:2040</a></div></div>
<div class="ttc" id="structcallattempt_html_a9e0459b954643e4b37535fdcb0140326"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a9e0459b954643e4b37535fdcb0140326">callattempt::q_next</a></div><div class="ttdeci">struct callattempt * q_next</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01538">app_queue.c:1538</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structmember_html_a26bb3d453f9194968669861d4ae0a77c"><div class="ttname"><a href="../../d7/dd6/structmember.html#a26bb3d453f9194968669861d4ae0a77c">member::queuepos</a></div><div class="ttdeci">int queuepos</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01606">app_queue.c:1606</a></div></div>
<div class="ttc" id="structast__manager__event__blob_html"><div class="ttname"><a href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a></div><div class="ttdoc">Struct containing info for an AMI event to send out. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00491">manager.h:491</a></div></div>
<div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="channel_8h_html_abf514b9d96a1821a33fec8c64ee4e26f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a></div><div class="ttdeci">void ast_party_connected_line_init(struct ast_party_connected_line *init)</div><div class="ttdoc">Initialize the given connected line structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02022">channel.c:2022</a></div></div>
<div class="ttc" id="structpenalty__rule_html_aff3c96df7d67617d6ee82fa1f257ff84"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#aff3c96df7d67617d6ee82fa1f257ff84">penalty_rule::max_value</a></div><div class="ttdeci">int max_value</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01642">app_queue.c:1642</a></div></div>
<div class="ttc" id="app__queue_8c_html_a68951f4ce8e115a7210e7db5750ef6d1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a68951f4ce8e115a7210e7db5750ef6d1">queue_stasis_data_destructor</a></div><div class="ttdeci">static void queue_stasis_data_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05994">app_queue.c:5994</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae42d359bffaf530be173cc3239f64c48"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae42d359bffaf530be173cc3239f64c48">do_print</a></div><div class="ttdeci">static void do_print(struct mansession *s, int fd, const char *str)</div><div class="ttdoc">direct ouput to manager or cli with proper terminator </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09644">app_queue.c:9644</a></div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625faf53cb090b99fb8e952c8151990bd4192"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625faf53cb090b99fb8e952c8151990bd4192">AST_EXTENSION_DEACTIVATED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00063">pbx.h:63</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad395c86c08af4a1c22518966e9ead32f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad395c86c08af4a1c22518966e9ead32f">say_position</a></div><div class="ttdeci">static int say_position(struct queue_ent *qe, int ringing)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03980">app_queue.c:3980</a></div></div>
<div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="devicestate_8h_html_ac3a57910a6eb04d12d793fe3df796b8e"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#ac3a57910a6eb04d12d793fe3df796b8e">ast_devstate2str</a></div><div class="ttdeci">const char * ast_devstate2str(enum ast_device_state devstate) attribute_pure</div><div class="ttdoc">Convert device state to text string for output. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00237">devicestate.c:237</a></div></div>
<div class="ttc" id="structcall__queue_html_a6293d1622ff45ccac3a1679171376856"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a6293d1622ff45ccac3a1679171376856">call_queue::servicelevel</a></div><div class="ttdeci">int servicelevel</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01731">app_queue.c:1731</a></div></div>
<div class="ttc" id="channel_8h_html_a88d833a56ea7de33e230281c5c12b75d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a88d833a56ea7de33e230281c5c12b75d">ast_set_callerid</a></div><div class="ttdeci">void ast_set_callerid(struct ast_channel *chan, const char *cid_num, const char *cid_name, const char *cid_ani)</div><div class="ttdoc">Set caller ID number, name and ANI and generate AMI event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07434">channel.c:7434</a></div></div>
<div class="ttc" id="structqueue__ent_html_ae696e1fe3492379e4f8a1df0c72f63ab"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ae696e1fe3492379e4f8a1df0c72f63ab">queue_ent::parent</a></div><div class="ttdeci">struct call_queue * parent</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01561">app_queue.c:1561</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="monitor_8h_html_a95b90f61870300ea984afae5123dd44f"><div class="ttname"><a href="../../d5/d60/monitor_8h.html#a95b90f61870300ea984afae5123dd44f">X_REC_IN</a></div><div class="ttdeci">#define X_REC_IN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/monitor_8h_source.html#l00030">monitor.h:30</a></div></div>
<div class="ttc" id="channel_8h_html_ad1107e82de7494c8a10f19179e75b1fb"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ad1107e82de7494c8a10f19179e75b1fb">ast_channel_req_accountcodes_precious</a></div><div class="ttdeci">void ast_channel_req_accountcodes_precious(struct ast_channel *chan, const struct ast_channel *requestor, enum ast_channel_requestor_relationship relationship)</div><div class="ttdoc">Setup new channel accountcodes from the requestor channel after ast_request(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06531">channel.c:6531</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea6b7416bea92d3bc5ee8e36f0a484cdc1"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea6b7416bea92d3bc5ee8e36f0a484cdc1">AST_DEVICE_ONHOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00061">devicestate.h:61</a></div></div>
<div class="ttc" id="structmember_html_a44690a0a629211d7620ce0d55c412e9d"><div class="ttname"><a href="../../d7/dd6/structmember.html#a44690a0a629211d7620ce0d55c412e9d">member::dynamic</a></div><div class="ttdeci">int dynamic</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01601">app_queue.c:1601</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="structast__party__dialed_html_a436a3700bd4ae24751d7fad4538466aa"><div class="ttname"><a href="../../d1/dd1/structast__party__dialed.html#a436a3700bd4ae24751d7fad4538466aa">ast_party_dialed::number</a></div><div class="ttdeci">struct ast_party_dialed::@246 number</div><div class="ttdoc">Dialed/Called number. </div></div>
<div class="ttc" id="core__local_8h_html"><div class="ttname"><a href="../../d5/da6/core__local_8h.html">core_local.h</a></div><div class="ttdoc">Local proxy channel special access. </div></div>
<div class="ttc" id="app__queue_8c_html_a244749c3d8b00d8ad1c335cf2cd2e54c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a244749c3d8b00d8ad1c335cf2cd2e54c">queuewaitingcount_function</a></div><div class="ttdeci">static struct ast_custom_function queuewaitingcount_function</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09105">app_queue.c:9105</a></div></div>
<div class="ttc" id="musiconhold_8h_html"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html">musiconhold.h</a></div><div class="ttdoc">Music on hold handling. </div></div>
<div class="ttc" id="app__queue_8c_html_abc63b07b1a30653be5a5f722ce7ee39c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abc63b07b1a30653be5a5f722ce7ee39c">update_realtime_member_field</a></div><div class="ttdeci">static int update_realtime_member_field(struct member *mem, const char *queue_name, const char *field, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03757">app_queue.c:3757</a></div></div>
<div class="ttc" id="app__queue_8c_html_a53953b67278cd604638905b98734c248"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a53953b67278cd604638905b98734c248">change_priority_caller_on_queue</a></div><div class="ttdeci">static int change_priority_caller_on_queue(const char *queuename, const char *caller, int priority)</div><div class="ttdoc">Change priority caller into a queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07430">app_queue.c:7430</a></div></div>
<div class="ttc" id="cli_8h_html_a5c4130cf8f1e93acfdd84416cebf1aef"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a></div><div class="ttdeci">#define AST_CLI_DEFINE(fn, txt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00197">cli.h:197</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eee"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eee">ast_device_state</a></div><div class="ttdeci">ast_device_state</div><div class="ttdoc">Device States. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00052">devicestate.h:52</a></div></div>
<div class="ttc" id="app__queue_8c_html_a663a7b1ad590cc3041706eb246d91ba7"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a663a7b1ad590cc3041706eb246d91ba7">member_hash_fn</a></div><div class="ttdeci">static int member_hash_fn(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02740">app_queue.c:2740</a></div></div>
<div class="ttc" id="max__forwards_8h_html_a6a88ae3674510012e1c04f8501ea1ad1"><div class="ttname"><a href="../../d3/d93/max__forwards_8h.html#a6a88ae3674510012e1c04f8501ea1ad1">ast_max_forwards_get</a></div><div class="ttdeci">int ast_max_forwards_get(struct ast_channel *chan)</div><div class="ttdoc">Get the current max forwards for a particular channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ddd/max__forwards_8c_source.html#l00121">max_forwards.c:121</a></div></div>
<div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_af3a657a2b25861869f8b0e67f0eaa950ab31bcd53098fda59c1bb2c2492686527"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950ab31bcd53098fda59c1bb2c2492686527">AST_ATTENDED_TRANSFER_DEST_LINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00311">stasis_bridges.h:311</a></div></div>
<div class="ttc" id="app__queue_8c_html_a066e0020d2b8551be747bd42d26ab94a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a066e0020d2b8551be747bd42d26ab94a">create_queue_member</a></div><div class="ttdeci">static struct member * create_queue_member(const char *interface, const char *membername, int penalty, int paused, const char *state_interface, int ringinuse, int wrapuptime)</div><div class="ttdoc">allocate space for new queue member and set fields based on parameters passed </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02686">app_queue.c:2686</a></div></div>
<div class="ttc" id="structmessage_html"><div class="ttname"><a href="../../d8/d9e/structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00144">manager.h:144</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad5d008a8d00288be0065438ae331071f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad5d008a8d00288be0065438ae331071f">queue_publish_multi_channel_snapshot_blob</a></div><div class="ttdeci">static void queue_publish_multi_channel_snapshot_blob(struct stasis_topic *topic, struct ast_channel_snapshot *caller_snapshot, struct ast_channel_snapshot *agent_snapshot, struct stasis_message_type *type, struct ast_json *blob)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02166">app_queue.c:2166</a></div></div>
<div class="ttc" id="app__queue_8c_html_a78458fd1a0596bd7755bfbf47b360d1a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a78458fd1a0596bd7755bfbf47b360d1a">qupd_exec</a></div><div class="ttdeci">static int qupd_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">Update Queue with data of an outgoing call. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11157">app_queue.c:11157</a></div></div>
<div class="ttc" id="app__queue_8c_html_af50d62be1a33353655366ede45e2da2e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af50d62be1a33353655366ede45e2da2e">handle_blind_transfer</a></div><div class="ttdeci">static void handle_blind_transfer(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Handle a blind transfer event. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06146">app_queue.c:6146</a></div></div>
<div class="ttc" id="file_8h_html_a67c7e271b4ca70aca6d48fd48d121857"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a67c7e271b4ca70aca6d48fd48d121857">ast_streamfile</a></div><div class="ttdeci">int ast_streamfile(struct ast_channel *c, const char *filename, const char *preflang)</div><div class="ttdoc">Streams a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01250">file.c:1250</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f5d1f6fb6cd3af5e8b07d19e4ab273a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f5d1f6fb6cd3af5e8b07d19e4ab273a">MAX_PERIODIC_ANNOUNCEMENTS</a></div><div class="ttdeci">#define MAX_PERIODIC_ANNOUNCEMENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01432">app_queue.c:1432</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a9140a4e4d781264fa9469c52b1adae40"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a9140a4e4d781264fa9469c52b1adae40">AST_LIST_LOCK</a></div><div class="ttdeci">#define AST_LIST_LOCK(head)</div><div class="ttdoc">Locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00039">linkedlists.h:39</a></div></div>
<div class="ttc" id="app__queue_8c_html_a531c35e38ede3ea4e5ba5afb24b29493aec7326f60e7edad15d96ff935e5616d6"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493aec7326f60e7edad15d96ff935e5616d6">OPT_ARG_ARRAY_SIZE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01354">app_queue.c:1354</a></div></div>
<div class="ttc" id="app__queue_8c_html_a499685f064d4f862700499819b42bb0a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a499685f064d4f862700499819b42bb0a">app_ql</a></div><div class="ttdeci">static char * app_ql</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01458">app_queue.c:1458</a></div></div>
<div class="ttc" id="app__queue_8c_html_abdcc4a1bb61f226f36c2026ec3d65a35"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abdcc4a1bb61f226f36c2026ec3d65a35">store_next_rr</a></div><div class="ttdeci">static int store_next_rr(struct queue_ent *qe, struct callattempt *outgoing)</div><div class="ttdoc">Search for best metric and add to Round Robbin queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04699">app_queue.c:4699</a></div></div>
<div class="ttc" id="structast__channel__tech_html_a8ff938fb2f815be425fd2859a21e6d61"><div class="ttname"><a href="../../d4/d85/structast__channel__tech.html#a8ff938fb2f815be425fd2859a21e6d61">ast_channel_tech::type</a></div><div class="ttdeci">const char *const type</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00630">channel.h:630</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html_ab6103ad1bbc12922f93c0526204573cf"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">ast_channel_snapshot::base</a></div><div class="ttdeci">struct ast_channel_snapshot_base * base</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00146">stasis_channels.h:146</a></div></div>
<div class="ttc" id="lock_8h_html"><div class="ttname"><a href="../../dd/d42/lock_8h.html">lock.h</a></div><div class="ttdoc">Asterisk locking-related definitions: </div></div>
<div class="ttc" id="structqueue__ent_html_a82816e03a6ff618cd555d6b436213b53"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a82816e03a6ff618cd555d6b436213b53">queue_ent::raise_penalty</a></div><div class="ttdeci">int raise_penalty</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01580">app_queue.c:1580</a></div></div>
<div class="ttc" id="structautopause_html_a4092d0238a0a8aa7aeaf503a7f0e6380"><div class="ttname"><a href="../../df/dd2/structautopause.html#a4092d0238a0a8aa7aeaf503a7f0e6380">autopause::autopause</a></div><div class="ttdeci">int autopause</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01421">app_queue.c:1421</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_a68eeab7290249706588af2b6cffbdcaa"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#a68eeab7290249706588af2b6cffbdcaa">ast_attended_transfer_message::dest</a></div><div class="ttdeci">union ast_attended_transfer_message::@324 dest</div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2aa4eb95a01ce1882ef6fe8fc0b7626e2b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aa4eb95a01ce1882ef6fe8fc0b7626e2b">QUEUE_LEAVEUNAVAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01501">app_queue.c:1501</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="stasis__channels_8h_html"><div class="ttname"><a href="../../d9/d4a/stasis__channels_8h.html">stasis_channels.h</a></div></div>
<div class="ttc" id="structcall__queue_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ad43c3812e6d13e0518d9f8b8f463ffcf">call_queue::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01735">app_queue.c:1735</a></div></div>
<div class="ttc" id="asterisk_8h_html"><div class="ttname"><a href="../../db/db2/asterisk_8h.html">asterisk.h</a></div><div class="ttdoc">Asterisk main include file. File version handling, generic pbx functions. </div></div>
<div class="ttc" id="structcall__queue_html_a9d7f2e93f4bdd39ea6aa5eeaa02f0066"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a9d7f2e93f4bdd39ea6aa5eeaa02f0066">call_queue::callsabandonedinsl</a></div><div class="ttdeci">int callsabandonedinsl</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01730">app_queue.c:1730</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8628933cde20921c453a6d2607bdad62a92b2b0d4b3b19ef4bd9b02a302f2026b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62a92b2b0d4b3b19ef4bd9b02a302f2026b">QUEUE_AUTOPAUSE_ON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01394">app_queue.c:1394</a></div></div>
<div class="ttc" id="linkedlists_8h_html_adf1959c5c03a3a706da97ad2f49617e5"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#adf1959c5c03a3a706da97ad2f49617e5">AST_LIST_FIRST</a></div><div class="ttdeci">#define AST_LIST_FIRST(head)</div><div class="ttdoc">Returns the first entry contained in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00420">linkedlists.h:420</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8292022a7532175e3af8a5a67f87de9c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8292022a7532175e3af8a5a67f87de9c">manager_queue_member_ringinuse</a></div><div class="ttdeci">static int manager_queue_member_ringinuse(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10457">app_queue.c:10457</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5dc9ad9f36c4de3a6588baf8fa466131"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5dc9ad9f36c4de3a6588baf8fa466131">queue_member_status_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_member_status_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02035">app_queue.c:2035</a></div></div>
<div class="ttc" id="structmember_html_a868659a2f991de87c2b0dcbe6cea6175"><div class="ttname"><a href="../../d7/dd6/structmember.html#a868659a2f991de87c2b0dcbe6cea6175">member::paused</a></div><div class="ttdeci">int paused</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01604">app_queue.c:1604</a></div></div>
<div class="ttc" id="app__queue_8c_html_aaa42581c853cb64af155ddd19937d80e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aaa42581c853cb64af155ddd19937d80e">RES_OKAY</a></div><div class="ttdeci">#define RES_OKAY</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01441">app_queue.c:1441</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html">stasis_bridges.h</a></div></div>
<div class="ttc" id="channel_8h_html_aa9958d9d3c90bdc9a37fff1243b4709b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa9958d9d3c90bdc9a37fff1243b4709b">ast_channel_connected_line_macro</a></div><div class="ttdeci">int ast_channel_connected_line_macro(struct ast_channel *autoservice_chan, struct ast_channel *macro_chan, const void *connected_info, int is_caller, int frame)</div><div class="ttdoc">Run a connected line interception macro and update a channel&amp;#39;s connected line information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10435">channel.c:10435</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a7ba1d69412c7149859c52b8a6664fc31"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a7ba1d69412c7149859c52b8a6664fc31">stasis_message_router_create_pool</a></div><div class="ttdeci">#define stasis_message_router_create_pool(topic)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d25/stasis__message__router_8h_source.html#l00077">stasis_message_router.h:77</a></div></div>
<div class="ttc" id="app__queue_8c_html_a4d4a25d601ed08189ac3fa379f9f5145"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a4d4a25d601ed08189ac3fa379f9f5145">rqm_exec</a></div><div class="ttdeci">static int rqm_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">RemoveQueueMember application. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07954">app_queue.c:7954</a></div></div>
<div class="ttc" id="astobj2_8h_html_a512cc40ce96c63b3d5c78040baa4c9cd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a></div><div class="ttdeci">int ao2_container_count(struct ao2_container *c)</div><div class="ttdoc">Returns the number of elements in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00034">astobj2_container.c:34</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3aa465a2ae8739e3b612225fe15f19c0ad"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3aa465a2ae8739e3b612225fe15f19c0ad">OPT_CALLEE_AUTOMIXMON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01341">app_queue.c:1341</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00045">bridge_features.h:45</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structqueue__ent_html_a03f45477f89c1c873bd0ce9b508901ca"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a03f45477f89c1c873bd0ce9b508901ca">queue_ent::digits</a></div><div class="ttdeci">char digits[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01565">app_queue.c:1565</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc150dec1056eca590d0f1555ff5188b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc150dec1056eca590d0f1555ff5188b">end_bridge_callback_data_fixup</a></div><div class="ttdeci">static void end_bridge_callback_data_fixup(struct ast_bridge_config *bconfig, struct ast_channel *originator, struct ast_channel *terminator)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06568">app_queue.c:6568</a></div></div>
<div class="ttc" id="structast__party__dialed_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d1/dd1/structast__party__dialed.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_dialed::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00387">channel.h:387</a></div></div>
<div class="ttc" id="structcall__queue_html_a1c463871b9383c36385eb3250e3f9e70"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a1c463871b9383c36385eb3250e3f9e70">call_queue::sound_holdtime</a></div><div class="ttdeci">const ast_string_field sound_holdtime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="channel_8h_html_a46837c158733334d2bb155bbd827ddb8"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a46837c158733334d2bb155bbd827ddb8">ast_channel_set_caller_event</a></div><div class="ttdeci">void ast_channel_set_caller_event(struct ast_channel *chan, const struct ast_party_caller *caller, const struct ast_set_party_caller *update)</div><div class="ttdoc">Set the caller id information in the Asterisk channel and generate an AMI event if the caller id name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07472">channel.c:7472</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structrule__lists_html"><div class="ttname"><a href="../../dd/d61/structrule__lists.html">rule_lists</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01764">app_queue.c:1764</a></div></div>
<div class="ttc" id="channel_8h_html_a7a8f6a50f3db42cb40cad7cfbd1d54f9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7a8f6a50f3db42cb40cad7cfbd1d54f9">ast_autoservice_start</a></div><div class="ttdeci">int ast_autoservice_start(struct ast_channel *chan)</div><div class="ttdoc">Automatically service a channel for us... </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d66/autoservice_8c_source.html#l00200">autoservice.c:200</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3192e5a563b2f9e827c2362fe249019c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3192e5a563b2f9e827c2362fe249019c">find_load_queue_rt_friendly</a></div><div class="ttdeci">static struct call_queue * find_load_queue_rt_friendly(const char *queuename)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03702">app_queue.c:3702</a></div></div>
<div class="ttc" id="structqueue__ent_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a84d1435c5b8d387806714ea7079304b7">queue_ent::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01586">app_queue.c:1586</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="app__queue_8c_html_a541a1e91d9ec3ef9f489b63a57413c3e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a541a1e91d9ec3ef9f489b63a57413c3e">queue_results</a></div><div class="ttdeci">static const struct @66 queue_results[]</div></div>
<div class="ttc" id="app__queue_8c_html_abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a4fc330b82c294649884cd4d189da8d5f">QUEUE_RELOAD_MEMBER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01400">app_queue.c:1400</a></div></div>
<div class="ttc" id="structqueue__ent_html_a9038df9f3d3bbd51a7bb8d04cf2e4125"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a9038df9f3d3bbd51a7bb8d04cf2e4125">queue_ent::min_penalty</a></div><div class="ttdeci">int min_penalty</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01579">app_queue.c:1579</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8e0726d1faabee57a4b66622bd716588"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8e0726d1faabee57a4b66622bd716588">app_qupd</a></div><div class="ttdeci">static char * app_qupd</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01460">app_queue.c:1460</a></div></div>
<div class="ttc" id="structcall__queue_html_a9298f7c0bf15cf275f4664d6959a6da6"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a9298f7c0bf15cf275f4664d6959a6da6">call_queue::wrapuptime</a></div><div class="ttdeci">int wrapuptime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01737">app_queue.c:1737</a></div></div>
<div class="ttc" id="pbx_8h_html_a6e3dbc57c03c23543354ef108c31fac8"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6e3dbc57c03c23543354ef108c31fac8">pbx_exec</a></div><div class="ttdeci">int pbx_exec(struct ast_channel *c, struct ast_app *app, const char *data)</div><div class="ttdoc">Execute an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/pbx__app_8c_source.html#l00471">pbx_app.c:471</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2807f5312b497d9ccbb4c43f226d5c19"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2807f5312b497d9ccbb4c43f226d5c19">mark_member_dead</a></div><div class="ttdeci">static int mark_member_dead(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09351">app_queue.c:9351</a></div></div>
<div class="ttc" id="structcall__queue_html_aafe5c53f028a19ef0c45dd193115d2aa"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aafe5c53f028a19ef0c45dd193115d2aa">call_queue::membergosub</a></div><div class="ttdeci">const ast_string_field membergosub</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_af3a657a2b25861869f8b0e67f0eaa950af927648ab0472ab615a296e8103b4caf"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950af927648ab0472ab615a296e8103b4caf">AST_ATTENDED_TRANSFER_DEST_THREEWAY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00313">stasis_bridges.h:313</a></div></div>
<div class="ttc" id="module_8h_html_ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15"><div class="ttname"><a href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00121">module.h:121</a></div></div>
<div class="ttc" id="structast__bridge__config_html_a725b051d26c3350f8cd04467b4202c60"><div class="ttname"><a href="../../d0/d13/structast__bridge__config.html#a725b051d26c3350f8cd04467b4202c60">ast_bridge_config::features_callee</a></div><div class="ttdeci">struct ast_flags features_callee</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01079">channel.h:1079</a></div></div>
<div class="ttc" id="strings_8h_html"><div class="ttname"><a href="../../d6/d90/strings_8h.html">strings.h</a></div><div class="ttdoc">String manipulation functions. </div></div>
<div class="ttc" id="app__queue_8c_html_a809b8e2a1be84c1a33a191a1c8ed549f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a809b8e2a1be84c1a33a191a1c8ed549f">handle_queue_add_member</a></div><div class="ttdeci">static char * handle_queue_add_member(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10561">app_queue.c:10561</a></div></div>
<div class="ttc" id="structpenalty__rule_html_ae0778c688a39dcc28198f568176370eb"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#ae0778c688a39dcc28198f568176370eb">penalty_rule::max_relative</a></div><div class="ttdeci">int max_relative</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01645">app_queue.c:1645</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a8bd3a6c07bd2064a82a7c27091ba0fce"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a8bd3a6c07bd2064a82a7c27091ba0fce">ast_channel_entered_bridge_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_entered_bridge_type(void)</div><div class="ttdoc">Message type for channel enter bridge blob messages. </div></div>
<div class="ttc" id="app__queue_8c_html_ac3382bf6da54c56b37069bd76bbdf4f9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a></div><div class="ttdeci">static int load_module(void)</div><div class="ttdoc">Load the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11324">app_queue.c:11324</a></div></div>
<div class="ttc" id="app__queue_8c_html_a22f7d751732c215b14ab3e80aec3f541"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a22f7d751732c215b14ab3e80aec3f541">handle_queue_reload</a></div><div class="ttdeci">static char * handle_queue_reload(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11090">app_queue.c:11090</a></div></div>
<div class="ttc" id="app__queue_8c_html_a450fb190b54c3d071e9a51111edb6e54"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a450fb190b54c3d071e9a51111edb6e54">set_member_ringinuse_help_members</a></div><div class="ttdeci">static int set_member_ringinuse_help_members(struct call_queue *q, const char *interface, int ringinuse)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07635">app_queue.c:7635</a></div></div>
<div class="ttc" id="app__queue_8c_html_a452e8221d8fbd54db8c589265a09e844aabaf51de14755cf9b47a42c3cc460a87"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844aabaf51de14755cf9b47a42c3cc460a87">TIMEOUT_PRIORITY_APP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01521">app_queue.c:1521</a></div></div>
<div class="ttc" id="callerid_8h_html"><div class="ttname"><a href="../../de/d47/callerid_8h.html">callerid.h</a></div><div class="ttdoc">CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr...</div></div>
<div class="ttc" id="structast__attended__transfer__message_html"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html">ast_attended_transfer_message</a></div><div class="ttdoc">Message representing attended transfer. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00319">stasis_bridges.h:319</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_adea5390496e5477192d86f340d512d04"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a></div><div class="ttdeci">void ast_variables_destroy(struct ast_variable *var)</div><div class="ttdoc">Free variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01263">extconf.c:1263</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9bdd4e15bb6c07cf8751f72a26bc62bd"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9bdd4e15bb6c07cf8751f72a26bc62bd">queue_member_penalty_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_member_penalty_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02055">app_queue.c:2055</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_ab88eb28b8d887439a811399b36edfbe8"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#ab88eb28b8d887439a811399b36edfbe8">queue_stasis_data::bridge_router</a></div><div class="ttdeci">struct stasis_message_router * bridge_router</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05981">app_queue.c:5981</a></div></div>
<div class="ttc" id="structval_html"><div class="ttname"><a href="../../d5/d85/structval.html">val</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dd1/ast__expr2_8c_source.html#l00325">ast_expr2.c:325</a></div></div>
<div class="ttc" id="structast__bridge__blob_html_a8ee8cdf03a2b9d3424011cb6875751fa"><div class="ttname"><a href="../../d7/d01/structast__bridge__blob.html#a8ee8cdf03a2b9d3424011cb6875751fa">ast_bridge_blob::channel</a></div><div class="ttdeci">struct ast_channel_snapshot * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00127">stasis_bridges.h:127</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae30d56b03bf5537faee32eec7856a2bf"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae30d56b03bf5537faee32eec7856a2bf">app_aqm</a></div><div class="ttdeci">static char * app_aqm</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01450">app_queue.c:1450</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad57326008c326db88dc36779741622b8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a></div><div class="ttdeci">#define ao2_t_alloc(data_size, destructor_fn, debug_msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00409">astobj2.h:409</a></div></div>
<div class="ttc" id="structqueue__ent_html_a6953d3232b673de8d1b0112a0bae49cc"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a6953d3232b673de8d1b0112a0bae49cc">queue_ent::max_penalty</a></div><div class="ttdeci">int max_penalty</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01578">app_queue.c:1578</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a54b4e68636084106abe671c5dcb10b22"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a54b4e68636084106abe671c5dcb10b22">OPT_PREDIAL_CALLER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01346">app_queue.c:1346</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa7d1afea6dfbecdafb8db467ff324d5a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa7d1afea6dfbecdafb8db467ff324d5a">pending_members</a></div><div class="ttdeci">static struct ao2_container * pending_members</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02375">app_queue.c:2375</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a54be9f0e166d88bc3d740221060f14e4">QUEUE_EMPTY_PENALTY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01620">app_queue.c:1620</a></div></div>
<div class="ttc" id="structast__party__connected__line_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../dc/d9e/structast__party__connected__line.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_party_connected_line::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdoc">Connected party ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00459">channel.h:459</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_af3a657a2b25861869f8b0e67f0eaa950a6d7eec1c6d7b9003b642c7c061444aeb"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950a6d7eec1c6d7b9003b642c7c061444aeb">AST_ATTENDED_TRANSFER_DEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00303">stasis_bridges.h:303</a></div></div>
<div class="ttc" id="structqueue__ent_html_ac49f311625f4ec75469d1af3e7505a4b"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ac49f311625f4ec75469d1af3e7505a4b">queue_ent::last_periodic_announce_sound</a></div><div class="ttdeci">int last_periodic_announce_sound</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01573">app_queue.c:1573</a></div></div>
<div class="ttc" id="app__queue_8c_html_a452e8221d8fbd54db8c589265a09e844a94a7510a93b7241883228503227335af"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844a94a7510a93b7241883228503227335af">TIMEOUT_PRIORITY_CONF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01522">app_queue.c:1522</a></div></div>
<div class="ttc" id="file_8h_html_afa92b0106fb7a918ea994c2867ac0a04"><div class="ttname"><a href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a></div><div class="ttdeci">#define AST_DIGIT_ANY</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00048">file.h:48</a></div></div>
<div class="ttc" id="app__queue_8c_html_abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a845535b8e69c40b11c12b08740d1357c">QUEUE_RESET_STATS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01402">app_queue.c:1402</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae40aa031d8166daa7404b8da0645f8cd"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae40aa031d8166daa7404b8da0645f8cd">handle_hangup</a></div><div class="ttdeci">static void handle_hangup(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06398">app_queue.c:6398</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae98d530ca277ac225286ff90659ed9f4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae98d530ca277ac225286ff90659ed9f4">queuegetchannel_function</a></div><div class="ttdeci">static struct ast_custom_function queuegetchannel_function</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09100">app_queue.c:9100</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a49bae9dfad805972b20763389a090d09">QUEUE_STRATEGY_LINEAR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01387">app_queue.c:1387</a></div></div>
<div class="ttc" id="structqueue__ent_html_ada310e7f72b38fadd4b24d80ed3438ee"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ada310e7f72b38fadd4b24d80ed3438ee">queue_ent::start</a></div><div class="ttdeci">time_t start</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01583">app_queue.c:1583</a></div></div>
<div class="ttc" id="structao2__iterator_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html#ac8bf36fe0577cba66bccda3a6f7e80a4">ao2_iterator::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01849">astobj2.h:1849</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_af3a657a2b25861869f8b0e67f0eaa950adefb7a844b18a31888a4fee73a0649e4"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950adefb7a844b18a31888a4fee73a0649e4">AST_ATTENDED_TRANSFER_DEST_APP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00307">stasis_bridges.h:307</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6caef970e3bb201ea9dc78d2fe366bba"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6caef970e3bb201ea9dc78d2fe366bba">queue_multi_channel_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_multi_channel_to_ami(const char *type, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02084">app_queue.c:2084</a></div></div>
<div class="ttc" id="json_8h_html_a8ac267a28e7eddf5b10bbb65139406f2"><div class="ttname"><a href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a></div><div class="ttdeci">struct ast_json_payload * ast_json_payload_create(struct ast_json *json)</div><div class="ttdoc">Create an ao2 object to pass json blobs as data payloads for stasis. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00735">json.c:735</a></div></div>
<div class="ttc" id="channel_8h_html_ade95e66d7c53181894de1d3569aee2b8"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ade95e66d7c53181894de1d3569aee2b8">ast_party_connected_line_set_init</a></div><div class="ttdeci">void ast_party_connected_line_set_init(struct ast_party_connected_line *init, const struct ast_party_connected_line *guide)</div><div class="ttdoc">Initialize the given connected line structure using the given guide for a set update operation...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02045">channel.c:2045</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="structcall__queue_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a493b57f443cc38b3d3df9c1e584d9d82">call_queue::timeout</a></div><div class="ttdeci">int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01741">app_queue.c:1741</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aef636ed2f3d33f4c7a1ba67eb7c4d052"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a></div><div class="ttdeci">struct ast_variable * ast_variable_browse(const struct ast_config *config, const char *category_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01216">extconf.c:1216</a></div></div>
<div class="ttc" id="structast__blind__transfer__message_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../d1/dbf/structast__blind__transfer__message.html#a78d4847658b695383d849efd12399b38">ast_blind_transfer_message::exten</a></div><div class="ttdeci">char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00261">stasis_bridges.h:261</a></div></div>
<div class="ttc" id="structcall__queue_html_a7bfdaae079344b1a48263c16c6e39039"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a7bfdaae079344b1a48263c16c6e39039">call_queue::penaltymemberslimit</a></div><div class="ttdeci">int penaltymemberslimit</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01738">app_queue.c:1738</a></div></div>
<div class="ttc" id="devicestate_8h_html"><div class="ttname"><a href="../../da/da2/devicestate_8h.html">devicestate.h</a></div><div class="ttdoc">Device state management. </div></div>
<div class="ttc" id="structcall__queue_html_a02a24815c7591a8655446b75e8dbaadd"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a02a24815c7591a8655446b75e8dbaadd">call_queue::autopauseunavail</a></div><div class="ttdeci">unsigned int autopauseunavail</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01716">app_queue.c:1716</a></div></div>
<div class="ttc" id="translate_8h_html"><div class="ttname"><a href="../../db/d39/translate_8h.html">translate.h</a></div><div class="ttdoc">Support for translation of data formats. translate.c. </div></div>
<div class="ttc" id="app__queue_8c_html_a3f4703e2907ef0ff09af7be1332ddb5a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3f4703e2907ef0ff09af7be1332ddb5a">upqm_exec</a></div><div class="ttdeci">static int upqm_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">UnPauseQueueMember application. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07918">app_queue.c:7918</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ab451a4653176c211d131b899e1f91bde"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ab451a4653176c211d131b899e1f91bde">BEGIN_OPTIONS</a></div><div class="ttdeci">#define BEGIN_OPTIONS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01343">include/asterisk/app.h:1343</a></div></div>
<div class="ttc" id="structast__blind__transfer__message_html"><div class="ttname"><a href="../../d1/dbf/structast__blind__transfer__message.html">ast_blind_transfer_message</a></div><div class="ttdoc">Message published during a blind transfer. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00249">stasis_bridges.h:249</a></div></div>
<div class="ttc" id="channel_8h_html_aef2af15a597c948e97628da6c5c84f28"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a></div><div class="ttdeci">int ast_indicate(struct ast_channel *chan, int condition)</div><div class="ttdoc">Indicates condition of channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04322">channel.c:4322</a></div></div>
<div class="ttc" id="structrule__list_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d8/de5/structrule__list.html#a3777dbae63a15da001b2baa317a25149">rule_list::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01759">app_queue.c:1759</a></div></div>
<div class="ttc" id="channel_8h_html_afb2ae2e53d6676f3ca44a98aa3f92a2c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afb2ae2e53d6676f3ca44a98aa3f92a2c">MAX_MUSICCLASS</a></div><div class="ttdeci">#define MAX_MUSICCLASS</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00174">channel.h:174</a></div></div>
<div class="ttc" id="structcall__queue_html_a32794c302b9a60821d519f6d4d1e7885"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a32794c302b9a60821d519f6d4d1e7885">call_queue::setqueuevar</a></div><div class="ttdeci">unsigned int setqueuevar</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01703">app_queue.c:1703</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3f1683ed5a30b46922e3f88b7c716e04"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3f1683ed5a30b46922e3f88b7c716e04">DEFAULT_RETRY</a></div><div class="ttdeci">#define DEFAULT_RETRY</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01429">app_queue.c:1429</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga565fc39c360b014dd5d4054fa72bbae8"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga565fc39c360b014dd5d4054fa72bbae8">ast_channel_publish_cached_blob</a></div><div class="ttdeci">void ast_channel_publish_cached_blob(struct ast_channel *chan, struct stasis_message_type *type, struct ast_json *blob)</div><div class="ttdoc">Publish a channel blob message using the latest snapshot from the cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l01120">stasis_channels.c:1120</a></div></div>
<div class="ttc" id="app__queue_8c_html_a52464c2ddf292a0a9c91cfc7481b0178"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a52464c2ddf292a0a9c91cfc7481b0178">ANNOUNCEPOSITION_NO</a></div><div class="ttdeci">#define ANNOUNCEPOSITION_NO</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01652">app_queue.c:1652</a></div></div>
<div class="ttc" id="structast__party__redirecting_html_acf09e8312b8b4396ec42c5147cdf9b5b"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html#acf09e8312b8b4396ec42c5147cdf9b5b">ast_party_redirecting::from</a></div><div class="ttdeci">struct ast_party_id from</div><div class="ttdoc">Who is redirecting the call (Sent to the party the call is redirected toward) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00528">channel.h:528</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7d446221f9a272b003c4ad660a7e14dc"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7d446221f9a272b003c4ad660a7e14dc">ast_channel_publish_dial</a></div><div class="ttdeci">void ast_channel_publish_dial(struct ast_channel *caller, struct ast_channel *peer, const char *dialstring, const char *dialstatus)</div><div class="ttdoc">Publish in the ast_channel_topic or ast_channel_topic_all topics a stasis message for the channels in...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00739">stasis_channels.c:739</a></div></div>
<div class="ttc" id="pbx_8h_html_aa992580d26443e3306f7f08cf5908e7c"><div class="ttname"><a href="../../db/de0/pbx_8h.html#aa992580d26443e3306f7f08cf5908e7c">ast_extension_state_del</a></div><div class="ttdeci">int ast_extension_state_del(int id, ast_state_cb_type change_cb)</div><div class="ttdoc">Deletes a state change watcher by ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l03858">pbx.c:3858</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2d37dc60db794ef631ada82b564f1afb"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2d37dc60db794ef631ada82b564f1afb">queue_bridge_cb</a></div><div class="ttdeci">static void queue_bridge_cb(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06261">app_queue.c:6261</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="app__queue_8c_html_a4c7d813324c2a5aec46aa9206cbaa912"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a4c7d813324c2a5aec46aa9206cbaa912">complete_queue_pause_member</a></div><div class="ttdeci">static char * complete_queue_pause_member(const char *line, const char *word, int pos, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10799">app_queue.c:10799</a></div></div>
<div class="ttc" id="channel_8h_html_a14af45a19bb70a19d44cc965e88e0a3b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a14af45a19bb70a19d44cc965e88e0a3b">ast_channel_appl_set</a></div><div class="ttdeci">void ast_channel_appl_set(struct ast_channel *chan, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00321">channel_internal_api.c:321</a></div></div>
<div class="ttc" id="channel_8h_html_ae6b4b7ba458e88fdbb2df9f39d935337"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a></div><div class="ttdeci">void ast_channel_hangupcause_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00431">channel_internal_api.c:431</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab47b5d2f3bd776ba10789dba63ee6ade"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab47b5d2f3bd776ba10789dba63ee6ade">queue_member_removed_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_member_removed_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02045">app_queue.c:2045</a></div></div>
<div class="ttc" id="structmember_html_af6be5c301b33dd6e5014890f8aeb12de"><div class="ttname"><a href="../../d7/dd6/structmember.html#af6be5c301b33dd6e5014890f8aeb12de">member::state_interface</a></div><div class="ttdeci">char state_interface[AST_CHANNEL_NAME]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01596">app_queue.c:1596</a></div></div>
<div class="ttc" id="structast__channel__blob_html_ad2b8e22df32b99651f727cd9a8dcb9f3"><div class="ttname"><a href="../../db/df0/structast__channel__blob.html#ad2b8e22df32b99651f727cd9a8dcb9f3">ast_channel_blob::blob</a></div><div class="ttdeci">struct ast_json * blob</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00188">stasis_channels.h:188</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9a9f9385afb8035ab410f06da649bce9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9a9f9385afb8035ab410f06da649bce9">strategies</a></div><div class="ttdeci">static const struct strategy strategies[]</div></div>
<div class="ttc" id="app__queue_8c_html_ac9c899c7c5a12d97016687c8745a6de6"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac9c899c7c5a12d97016687c8745a6de6">queue_caller_abandon_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_caller_abandon_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02005">app_queue.c:2005</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad4d94a7a9e04ddf7984d69a8737221f9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad4d94a7a9e04ddf7984d69a8737221f9">update_realtime_members</a></div><div class="ttdeci">static void update_realtime_members(struct call_queue *q)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03773">app_queue.c:3773</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a49a10204f0f100fb6ae669936e01a90c">QUEUE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01496">app_queue.c:1496</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a5adc304e693097ec75b474e6a5309958"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a></div><div class="ttdeci">int stasis_message_router_add(struct stasis_message_router *router, struct stasis_message_type *message_type, stasis_subscription_cb callback, void *data)</div><div class="ttdoc">Add a route to a message router. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00310">stasis_message_router.c:310</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9b97d0ffb7e1a6127de3acc037ea464b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9b97d0ffb7e1a6127de3acc037ea464b">handle_queue_remove_member</a></div><div class="ttdeci">static char * handle_queue_remove_member(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10687">app_queue.c:10687</a></div></div>
<div class="ttc" id="channel_8h_html_ab025bba87d1757aa28e1a837596b1ead"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab025bba87d1757aa28e1a837596b1ead">ast_channel_update_redirecting</a></div><div class="ttdeci">void ast_channel_update_redirecting(struct ast_channel *chan, const struct ast_party_redirecting *redirecting, const struct ast_set_party_redirecting *update)</div><div class="ttdoc">Indicate that the redirecting id has changed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10379">channel.c:10379</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad1982509765f4870f1f63412a53ea668"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11473">app_queue.c:11473</a></div></div>
<div class="ttc" id="app__queue_8c_html_a679ea032e9e26f6e6e569769fb528722"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a679ea032e9e26f6e6e569769fb528722">DEFAULT_MIN_ANNOUNCE_FREQUENCY</a></div><div class="ttdeci">#define DEFAULT_MIN_ANNOUNCE_FREQUENCY</div><div class="ttdoc">The minimum number of seconds between position announcements. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01437">app_queue.c:1437</a></div></div>
<div class="ttc" id="structcall__queue_html_a2e7cadcc5625b17fdd07051a07a3773c"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a2e7cadcc5625b17fdd07051a07a3773c">call_queue::announceposition_only_up</a></div><div class="ttdeci">unsigned int announceposition_only_up</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01710">app_queue.c:1710</a></div></div>
<div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="structmember_html_a9298f7c0bf15cf275f4664d6959a6da6"><div class="ttname"><a href="../../d7/dd6/structmember.html#a9298f7c0bf15cf275f4664d6959a6da6">member::wrapuptime</a></div><div class="ttdeci">int wrapuptime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01608">app_queue.c:1608</a></div></div>
<div class="ttc" id="structast__channel__blob_html_a36584c0251e54a7af4892d63f7a28c77"><div class="ttname"><a href="../../db/df0/structast__channel__blob.html#a36584c0251e54a7af4892d63f7a28c77">ast_channel_blob::snapshot</a></div><div class="ttdeci">struct ast_channel_snapshot * snapshot</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00186">stasis_channels.h:186</a></div></div>
<div class="ttc" id="structcall__queue_html_a7ccaa047c703f95f5eaf0dd0a10670b5"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a7ccaa047c703f95f5eaf0dd0a10670b5">call_queue::montype</a></div><div class="ttdeci">int montype</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01734">app_queue.c:1734</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2448088751e4d494d1981c7f4b84e8d0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a></div><div class="ttdeci">#define OBJ_POINTER</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01154">astobj2.h:1154</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae7ea23e36e4f751740b5651111de1de4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae7ea23e36e4f751740b5651111de1de4">queue_rules_set_global_params</a></div><div class="ttdeci">static void queue_rules_set_global_params(struct ast_config *cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09128">app_queue.c:9128</a></div></div>
<div class="ttc" id="app__queue_8c_html_a14d56b1e279722b17bc293e06c099b6b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a14d56b1e279722b17bc293e06c099b6b">manager_queue_reset</a></div><div class="ttdeci">static int manager_queue_reset(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10411">app_queue.c:10411</a></div></div>
<div class="ttc" id="channel_8h_html_a981a7bfac667e10cb62582b465e48d98"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a981a7bfac667e10cb62582b465e48d98">ast_channel_supports_html</a></div><div class="ttdeci">int ast_channel_supports_html(struct ast_channel *channel)</div><div class="ttdoc">Checks for HTML support on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06720">channel.c:6720</a></div></div>
<div class="ttc" id="app__queue_8c_html_af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da705a981107e0ea89ff36ae0707a97889">CALLER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05858">app_queue.c:5858</a></div></div>
<div class="ttc" id="structpenalty__rule_html_a790961d8e38a4dbcdd59e8c2b0a292b4"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#a790961d8e38a4dbcdd59e8c2b0a292b4">penalty_rule::min_relative</a></div><div class="ttdeci">int min_relative</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01646">app_queue.c:1646</a></div></div>
<div class="ttc" id="utils_8h_html_ab5033a1f3d781d45e7ccc27598114510"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a></div><div class="ttdeci">#define ast_set_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00070">utils.h:70</a></div></div>
<div class="ttc" id="structcall__queue_html_a7724cd5a7395de6d0cbc7f0a02b0c20a"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a7724cd5a7395de6d0cbc7f0a02b0c20a">call_queue::minannouncefrequency</a></div><div class="ttdeci">int minannouncefrequency</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01721">app_queue.c:1721</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ac08f7eb1eb9476b30987c73e1052ada8"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a></div><div class="ttdeci">#define AST_STANDARD_APP_ARGS(args, parse)</div><div class="ttdoc">Performs the &amp;#39;standard&amp;#39; argument separation process for an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01285">include/asterisk/app.h:1285</a></div></div>
<div class="ttc" id="app__queue_8c_html_aded397e4a6aabaef4c22702edf92e87f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aded397e4a6aabaef4c22702edf92e87f">queue_caller_leave_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_caller_leave_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02000">app_queue.c:2000</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="app__queue_8c_html_a177ca78dcb7d3e97d83c7c0273f70189"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a177ca78dcb7d3e97d83c7c0273f70189">queue_agent_complete_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_agent_complete_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02135">app_queue.c:2135</a></div></div>
<div class="ttc" id="structqueue__ent_html_ac019537a959f6147cecffb126bb04381"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ac019537a959f6147cecffb126bb04381">queue_ent::last_pos_said</a></div><div class="ttdeci">int last_pos_said</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01570">app_queue.c:1570</a></div></div>
<div class="ttc" id="structast__cli__entry_html"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a></div><div class="ttdoc">descriptor for a cli entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00171">cli.h:171</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="app__queue_8c_html_a90a66cbfb007419fb44ca4426265a03d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a90a66cbfb007419fb44ca4426265a03d">manager_queue_member_penalty</a></div><div class="ttdeci">static int manager_queue_member_penalty(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10491">app_queue.c:10491</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ab48cb9e1e612dd486b747ba1c5d68d01"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ab48cb9e1e612dd486b747ba1c5d68d01">AST_LIST_UNLOCK</a></div><div class="ttdeci">#define AST_LIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00139">linkedlists.h:139</a></div></div>
<div class="ttc" id="app__queue_8c_html_a618d839aac1e2aa80050a5d54598a33d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a618d839aac1e2aa80050a5d54598a33d">AST_MAX_WATCHERS</a></div><div class="ttdeci">#define AST_MAX_WATCHERS</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04923">app_queue.c:4923</a></div></div>
<div class="ttc" id="channel_8h_html_a25f1c885c7f5230ea4c9bc48dde88fe1ae4ef6bff70f5837c4ccfcef8d789a9cc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ae4ef6bff70f5837c4ccfcef8d789a9cc">AST_FEATURE_DISCONNECT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01066">channel.h:1066</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="json_8h_html_ae2cc29409ec389e8feaf38ec3a585d83"><div class="ttname"><a href="../../d4/d05/json_8h.html#ae2cc29409ec389e8feaf38ec3a585d83">ast_json_int_t</a></div><div class="ttdeci">AST_JSON_INT_T ast_json_int_t</div><div class="ttdoc">Primarily used to cast when packing to an &quot;I&quot; type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00087">json.h:87</a></div></div>
<div class="ttc" id="app__queue_8c_html_a057d0063ad944915f6af2fe93e69bc5a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a057d0063ad944915f6af2fe93e69bc5a">member_remove_from_queue</a></div><div class="ttdeci">static void member_remove_from_queue(struct call_queue *queue, struct member *mem)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03376">app_queue.c:3376</a></div></div>
<div class="ttc" id="structcall__queue_html_a245b5bee0d02a20222d815dbeaaac0fb"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a245b5bee0d02a20222d815dbeaaac0fb">call_queue::maxlen</a></div><div class="ttdeci">int maxlen</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01736">app_queue.c:1736</a></div></div>
<div class="ttc" id="app__queue_8c_html_a60c2c6eafb4f5d6b7abf2ef596191843"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a60c2c6eafb4f5d6b7abf2ef596191843">negative_penalty_invalid</a></div><div class="ttdeci">static int negative_penalty_invalid</div><div class="ttdoc">queues.conf [general] option </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01487">app_queue.c:1487</a></div></div>
<div class="ttc" id="structqueue__ent_html_ab552667d2252975f206fb8a8af49888a"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ab552667d2252975f206fb8a8af49888a">queue_ent::linwrapped</a></div><div class="ttdeci">int linwrapped</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01582">app_queue.c:1582</a></div></div>
<div class="ttc" id="astdb_8h_html_af9ab454a70a91551b2bf6c55199fc514"><div class="ttname"><a href="../../de/d4a/astdb_8h.html#af9ab454a70a91551b2bf6c55199fc514">ast_db_freetree</a></div><div class="ttdeci">void ast_db_freetree(struct ast_db_entry *entry)</div><div class="ttdoc">Free structure created by ast_db_gettree() </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d21/main_2db_8c_source.html#l00598">main/db.c:598</a></div></div>
<div class="ttc" id="structast__json__payload_html"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html">ast_json_payload</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01024">json.h:1024</a></div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625fa3e2a2f5572580f74e94b6d5e80261ea7"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa3e2a2f5572580f74e94b6d5e80261ea7">AST_EXTENSION_REMOVED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00062">pbx.h:62</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="channel_8h_html_a7ee3ff7bf7773329e9e20143f0ba2f69"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ee3ff7bf7773329e9e20143f0ba2f69">ast_channel_update_connected_line</a></div><div class="ttdeci">void ast_channel_update_connected_line(struct ast_channel *chan, const struct ast_party_connected_line *connected, const struct ast_set_party_connected_line *update)</div><div class="ttdoc">Indicate that the connected line information has changed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l09189">channel.c:9189</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a9752a3f99952a0b6576a927a1f5951ac"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a9752a3f99952a0b6576a927a1f5951ac">queue_stasis_data::dying</a></div><div class="ttdeci">int dying</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05979">app_queue.c:5979</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a66b6af9ceef39cb23b48501efe87219f"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a66b6af9ceef39cb23b48501efe87219f">ast_unload_realtime</a></div><div class="ttdeci">int ast_unload_realtime(const char *family)</div><div class="ttdoc">Release any resources cached for a realtime family. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03406">main/config.c:3406</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8d1a63cdf2c7aff22a77b6e75d93b377"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEINVALID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">include/asterisk/config.h:60</a></div></div>
<div class="ttc" id="structast__variable_html_a501b314f49b3a9ff6e7be599d94686ee"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">ast_variable::lineno</a></div><div class="ttdeci">int lineno</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00095">include/asterisk/config.h:95</a></div></div>
<div class="ttc" id="term_8h_html_a82573859711fce56f1aa0a76b18a9b18"><div class="ttname"><a href="../../db/d45/term_8h.html#a82573859711fce56f1aa0a76b18a9b18">COLOR_CYAN</a></div><div class="ttdeci">#define COLOR_CYAN</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/term_8h_source.html#l00059">term.h:59</a></div></div>
<div class="ttc" id="structcall__queue_html_a4092d0238a0a8aa7aeaf503a7f0e6380"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a4092d0238a0a8aa7aeaf503a7f0e6380">call_queue::autopause</a></div><div class="ttdeci">int autopause</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01743">app_queue.c:1743</a></div></div>
<div class="ttc" id="structcall__queue_html_a88ec6754dea8cb6d040f61a279b1c298"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a88ec6754dea8cb6d040f61a279b1c298">call_queue::ringinuse</a></div><div class="ttdeci">unsigned int ringinuse</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01700">app_queue.c:1700</a></div></div>
<div class="ttc" id="app__queue_8c_html_aac7dfe864fa6fde0b2069f9aca32d9bf"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aac7dfe864fa6fde0b2069f9aca32d9bf">kill_dead_members</a></div><div class="ttdeci">static int kill_dead_members(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09360">app_queue.c:9360</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">include/asterisk/frame.h:281</a></div></div>
<div class="ttc" id="structast__device__state__message_html_a1acd064aff48cf4d5eafec1030f8429d"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">ast_device_state_message::state</a></div><div class="ttdeci">enum ast_device_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00250">devicestate.h:250</a></div></div>
<div class="ttc" id="structqueue__end__bridge_html"><div class="ttname"><a href="../../d5/d61/structqueue__end__bridge.html">queue_end_bridge</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06563">app_queue.c:6563</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6">empty_conditions</a></div><div class="ttdeci">empty_conditions</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01619">app_queue.c:1619</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625fa5820eb407f3a3dbc5046c97ad43ee1f3"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa5820eb407f3a3dbc5046c97ad43ee1f3">AST_EXTENSION_UNAVAILABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00067">pbx.h:67</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6ea5b09a3e18d9f5d2131cb884f09186"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6ea5b09a3e18d9f5d2131cb884f09186">queue_caller_join_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_caller_join_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01995">app_queue.c:1995</a></div></div>
<div class="ttc" id="app__queue_8c_html_a447a632daaf1a56114da95816c12b8a5"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a447a632daaf1a56114da95816c12b8a5">RES_NOT_DYNAMIC</a></div><div class="ttdeci">#define RES_NOT_DYNAMIC</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01445">app_queue.c:1445</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a35080c34427591a22d34370e0a8ebab4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a35080c34427591a22d34370e0a8ebab4">OPT_CALLEE_PARK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01334">app_queue.c:1334</a></div></div>
<div class="ttc" id="structqueue__ent_html_a30cde435136d2c66ba5c601bf6e52d1e"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a30cde435136d2c66ba5c601bf6e52d1e">queue_ent::expire</a></div><div class="ttdeci">time_t expire</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01584">app_queue.c:1584</a></div></div>
<div class="ttc" id="app__queue_8c_html_a318c21ecadbe981df2771149df1ed361"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a318c21ecadbe981df2771149df1ed361">MAX_QUEUE_BUCKETS</a></div><div class="ttdeci">#define MAX_QUEUE_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01439">app_queue.c:1439</a></div></div>
<div class="ttc" id="structast__state__cb__info_html_a3a7a902ef9b30b78b595eeee1485090f"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html#a3a7a902ef9b30b78b595eeee1485090f">ast_state_cb_info::reason</a></div><div class="ttdeci">enum ast_state_cb_update_reason reason</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00103">pbx.h:103</a></div></div>
<div class="ttc" id="structqueue__ent_html_a86191f9cf0936c2201653d521b369c6c"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a86191f9cf0936c2201653d521b369c6c">queue_ent::opos</a></div><div class="ttdeci">int opos</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01575">app_queue.c:1575</a></div></div>
<div class="ttc" id="structcall__queue_html_a24cf7a74d65e1d4f4b9bfd16455187fb"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a24cf7a74d65e1d4f4b9bfd16455187fb">call_queue::timeoutrestart</a></div><div class="ttdeci">unsigned int timeoutrestart</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01707">app_queue.c:1707</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a641f77c471ff127e8586247ff6c0d64c"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a641f77c471ff127e8586247ff6c0d64c">stasis_message_router_unsubscribe_and_join</a></div><div class="ttdeci">void stasis_message_router_unsubscribe_and_join(struct stasis_message_router *router)</div><div class="ttdoc">Unsubscribe the router from the upstream topic, blocking until the final message has been processed...</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00269">stasis_message_router.c:269</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a910f835a41772603d33e200c956549ff"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a910f835a41772603d33e200c956549ff">ast_check_realtime</a></div><div class="ttdeci">int ast_check_realtime(const char *family)</div><div class="ttdoc">Check if realtime engine is configured for family. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03363">main/config.c:3363</a></div></div>
<div class="ttc" id="channel_8h_html_a1b732eb4ed203140b1a3aae9e7dec2c1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1b732eb4ed203140b1a3aae9e7dec2c1">ast_call</a></div><div class="ttdeci">int ast_call(struct ast_channel *chan, const char *addr, int timeout)</div><div class="ttdoc">Make a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06553">channel.c:6553</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ade65e4a6a8802772595db25eb8e500ea"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ade65e4a6a8802772595db25eb8e500ea">ast_queue_topic_all</a></div><div class="ttdeci">struct stasis_topic * ast_queue_topic_all(void)</div><div class="ttdoc">Get the Stasis Message Bus API topic for queue messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l03184">main/app.c:3184</a></div></div>
<div class="ttc" id="app__queue_8c_html_a1d2780396e569561ccc91f09174f3c3f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a1d2780396e569561ccc91f09174f3c3f">queue_reset_global_params</a></div><div class="ttdeci">static void queue_reset_global_params(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09201">app_queue.c:9201</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a1b0936415a643c88ce543099c10e0d7f"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a></div><div class="ttdeci">#define var</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00614">ast_expr2f.c:614</a></div></div>
<div class="ttc" id="structast__json__payload_html_a9cf488298469ae63ef947653d7ff9bab"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">ast_json_payload::json</a></div><div class="ttdeci">struct ast_json * json</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01025">json.h:1025</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a></div><div class="ttdoc">Structure representing a snapshot of channel state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00145">stasis_channels.h:145</a></div></div>
<div class="ttc" id="logger_8h_html_a9f7a6acbec3680a06af27ae561772915"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a9f7a6acbec3680a06af27ae561772915">ast_queue_log</a></div><div class="ttdeci">void ast_queue_log(const char *queuename, const char *callid, const char *agent, const char *event, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/logger_8c_source.html#l00894">logger.c:894</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad6116b09b58e795dd72862b6c5a6d140"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad6116b09b58e795dd72862b6c5a6d140">queuemembercount_dep</a></div><div class="ttdeci">static struct ast_custom_function queuemembercount_dep</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09095">app_queue.c:9095</a></div></div>
<div class="ttc" id="structstasis__subscription_html"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00681">stasis.c:681</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa08344a84581d62ffa83c87eea5da4ba"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa08344a84581d62ffa83c87eea5da4ba">queue_ref</a></div><div class="ttdeci">#define queue_ref(q)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01918">app_queue.c:1918</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ae234825bcb65b88c0554b995ff1b8ba6"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6">AST_LIST_NEXT</a></div><div class="ttdeci">#define AST_LIST_NEXT(elm, field)</div><div class="ttdoc">Returns the next entry in the list after the given entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00438">linkedlists.h:438</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa1cb8ea53e09c5d7d32b81c3e7a88b7c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa1cb8ea53e09c5d7d32b81c3e7a88b7c">log_membername_as_agent</a></div><div class="ttdeci">static int log_membername_as_agent</div><div class="ttdoc">queues.conf [general] option </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01490">app_queue.c:1490</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00058">devicestate.h:58</a></div></div>
<div class="ttc" id="app__queue_8c_html_abfd16358cfabbb3ad0c435c17883e398a04da28a6a506fbc6dfce3f3da3569acc"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398a04da28a6a506fbc6dfce3f3da3569acc">QUEUE_RELOAD_RULES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01401">app_queue.c:1401</a></div></div>
<div class="ttc" id="channel_8h_html_a7ef6737309dc9e8b6c4a7cb4800638b1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1">ast_read</a></div><div class="ttdeci">struct ast_frame * ast_read(struct ast_channel *chan)</div><div class="ttdoc">Reads a frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04302">channel.c:4302</a></div></div>
<div class="ttc" id="manager_8h_html_ab71472ea55b4114f460a4459e3dcd18b"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab71472ea55b4114f460a4459e3dcd18b">ast_manager_build_channel_state_string_prefix</a></div><div class="ttdeci">struct ast_str * ast_manager_build_channel_state_string_prefix(const struct ast_channel_snapshot *snapshot, const char *prefix)</div><div class="ttdoc">Generate the AMI message body from a channel snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1c/manager__channels_8c_source.html#l00487">manager_channels.c:487</a></div></div>
<div class="ttc" id="app__queue_8c_html_a331ac4441ab3808ba988804d9d0c9a29"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a331ac4441ab3808ba988804d9d0c9a29">queue_function_exists</a></div><div class="ttdeci">static int queue_function_exists(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">Check if a given queue exists. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08599">app_queue.c:8599</a></div></div>
<div class="ttc" id="stasis_8h_html_a31197e193b1dfd6c122ff6d7c7f6b3fa"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_CLEANUP(name)</div><div class="ttdoc">Boiler-plate messaging macro for cleaning up message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01523">stasis.h:1523</a></div></div>
<div class="ttc" id="app__queue_8c_html_a76af963fe9291f7d528d6db711144a6d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a76af963fe9291f7d528d6db711144a6d">calc_metric</a></div><div class="ttdeci">static int calc_metric(struct call_queue *q, struct member *mem, int pos, struct queue_ent *qe, struct callattempt *tmp)</div><div class="ttdoc">Calculate the metric of each member in the outgoing callattempts. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05779">app_queue.c:5779</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="aoc_8h_html_a33b761090d3debbfd4cdb0c800a13bb2"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a33b761090d3debbfd4cdb0c800a13bb2">ast_aoc_destroy_decoded</a></div><div class="ttdeci">void * ast_aoc_destroy_decoded(struct ast_aoc_decoded *decoded)</div><div class="ttdoc">free an ast_aoc_decoded object </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00307">aoc.c:307</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="structcall__queue_html_a1b9572151ecc081254a026796ef65d33"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a1b9572151ecc081254a026796ef65d33">call_queue::announceholdtime</a></div><div class="ttdeci">unsigned int announceholdtime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01708">app_queue.c:1708</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a></div><div class="ttdeci">ast_channel_state</div><div class="ttdoc">ast_channel states </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00035">channelstate.h:35</a></div></div>
<div class="ttc" id="app__queue_8c_html_a7c735420578948b9097fbf5dc71a094c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a7c735420578948b9097fbf5dc71a094c">reload_queue_rules</a></div><div class="ttdeci">static int reload_queue_rules(int reload)</div><div class="ttdoc">Reload the rules defined in queuerules.conf. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09142">app_queue.c:9142</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="app__meetme_8c_html_a111277a0849f92b793ed6aa1efe54462"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#a111277a0849f92b793ed6aa1efe54462">stop</a></div><div class="ttdeci">unsigned int stop</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01096">app_meetme.c:1096</a></div></div>
<div class="ttc" id="channel_8h_html_aa8c3522af1bc639cbd5b38f5fdf171fa"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a></div><div class="ttdeci">int ast_indicate_data(struct ast_channel *chan, int condition, const void *data, size_t datalen)</div><div class="ttdoc">Indicates condition of channel, with payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04698">channel.c:4698</a></div></div>
<div class="ttc" id="app__queue_8c_html_abf9e3172ae159d6dc89bc77fc3d25c83"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abf9e3172ae159d6dc89bc77fc3d25c83">mark_unfound</a></div><div class="ttdeci">static int mark_unfound(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09506">app_queue.c:9506</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8e51eaa0402ef1ffba4520220c4dbbab"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8e51eaa0402ef1ffba4520220c4dbbab">queue_unref</a></div><div class="ttdeci">#define queue_unref(q)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01919">app_queue.c:1919</a></div></div>
<div class="ttc" id="dial_8h_html"><div class="ttname"><a href="../../df/dcf/dial_8h.html">dial.h</a></div><div class="ttdoc">Dialing API. </div></div>
<div class="ttc" id="astdb_8h_html_a60488b5c3b6fd447d39d58e52172657e"><div class="ttname"><a href="../../de/d4a/astdb_8h.html#a60488b5c3b6fd447d39d58e52172657e">ast_db_get_allocated</a></div><div class="ttdeci">int ast_db_get_allocated(const char *family, const char *key, char **out)</div><div class="ttdoc">Get key value specified by family/key as a heap allocated string. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d21/main_2db_8c_source.html#l00422">main/db.c:422</a></div></div>
<div class="ttc" id="structcall__queue_html_aa01147b1f07072d246c76dc85d69df7c"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aa01147b1f07072d246c76dc85d69df7c">call_queue::weight</a></div><div class="ttdeci">int weight</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01742">app_queue.c:1742</a></div></div>
<div class="ttc" id="structcallattempt_html_a5b9365892c1d516cba42c3c6df59ff69"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a5b9365892c1d516cba42c3c6df59ff69">callattempt::interface</a></div><div class="ttdeci">char interface[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01541">app_queue.c:1541</a></div></div>
<div class="ttc" id="structpenalty__rule_html"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html">penalty_rule</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01640">app_queue.c:1640</a></div></div>
<div class="ttc" id="structast__state__cb__info_html"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html">ast_state_cb_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00102">pbx.h:102</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01117">bridge.h:1117</a></div></div>
<div class="ttc" id="structast__channel__snapshot__base_html_a753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../d6/d29/structast__channel__snapshot__base.html#a753c7b39e3284d771f13f513b003d033">ast_channel_snapshot_base::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00112">stasis_channels.h:112</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_af3a657a2b25861869f8b0e67f0eaa950aa9d22a276b09440f114a18a5924c0dc8"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#af3a657a2b25861869f8b0e67f0eaa950aa9d22a276b09440f114a18a5924c0dc8">AST_ATTENDED_TRANSFER_DEST_LOCAL_APP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00309">stasis_bridges.h:309</a></div></div>
<div class="ttc" id="app__queue_8c_html_afafcdeab5f3a75ed0670d4dac7020f03"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#afafcdeab5f3a75ed0670d4dac7020f03">__queues_show</a></div><div class="ttdeci">static char * __queues_show(struct mansession *s, int fd, int argc, const char *const *argv)</div><div class="ttdoc">Show queue(s) status and statistics. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09758">app_queue.c:9758</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="dial_8h_html_aa6f5744a63607a37d8f8f1f6b646502b"><div class="ttname"><a href="../../df/dcf/dial_8h.html#aa6f5744a63607a37d8f8f1f6b646502b">ast_hangup_cause_to_dial_status</a></div><div class="ttdeci">const char * ast_hangup_cause_to_dial_status(int hangup_cause)</div><div class="ttdoc">Convert a hangup cause to a publishable dial status. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d43/dial_8c_source.html#l00753">dial.c:753</a></div></div>
<div class="ttc" id="app__queue_8c_html_a92781796b10a269001fffa4646ac1a1f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a92781796b10a269001fffa4646ac1a1f">queue_t_ref</a></div><div class="ttdeci">#define queue_t_ref(q, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01920">app_queue.c:1920</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="stringfields_8h_html_a061580e89c55282a7140fa3fdfd52b6d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a></div><div class="ttdeci">#define AST_DECLARE_STRING_FIELDS(field_list)</div><div class="ttdoc">Declare the fields needed in a structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00337">stringfields.h:337</a></div></div>
<div class="ttc" id="structrule__list_html_a2f45d9fefb81a85a0be1e0b29cc5bb66"><div class="ttname"><a href="../../d8/de5/structrule__list.html#a2f45d9fefb81a85a0be1e0b29cc5bb66">rule_list::rules</a></div><div class="ttdeci">struct rule_list::@71 rules</div></div>
<div class="ttc" id="term_8h_html_afc9149f5de51bd9ac4f5ebbfa153f018"><div class="ttname"><a href="../../db/d45/term_8h.html#afc9149f5de51bd9ac4f5ebbfa153f018">COLOR_GREEN</a></div><div class="ttdeci">#define COLOR_GREEN</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/term_8h_source.html#l00051">term.h:51</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a">AST_CONTROL_REDIRECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00300">include/asterisk/frame.h:300</a></div></div>
<div class="ttc" id="app__queue_8c_html_a39bf3539cac69a629428927d5228ec1d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a39bf3539cac69a629428927d5228ec1d">reload_single_member</a></div><div class="ttdeci">static void reload_single_member(const char *memberdata, struct call_queue *q)</div><div class="ttdoc">reload information pertaining to a single member </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09244">app_queue.c:9244</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2">queue_result</a></div><div class="ttdeci">queue_result</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01495">app_queue.c:1495</a></div></div>
<div class="ttc" id="structmember_html_aac1ae37fa4007496a50df75cf1f698c1"><div class="ttname"><a href="../../d7/dd6/structmember.html#aac1ae37fa4007496a50df75cf1f698c1">member::realtime</a></div><div class="ttdeci">int realtime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01602">app_queue.c:1602</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga77315fa8e29950f0c88120501acda0a3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a></div><div class="ttdeci">void astman_send_ack(struct mansession *s, const struct message *m, char *msg)</div><div class="ttdoc">Send ack in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03191">manager.c:3191</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6adfcf6310d20a8088a392ea40fa381e09"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6adfcf6310d20a8088a392ea40fa381e09">QUEUE_EMPTY_UNAVAILABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01624">app_queue.c:1624</a></div></div>
<div class="ttc" id="app__queue_8c_html_a1b9f504553df5c7e9971f1ad3c695381"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a1b9f504553df5c7e9971f1ad3c695381">handle_queue_change_priority_caller</a></div><div class="ttdeci">static char * handle_queue_change_priority_caller(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10750">app_queue.c:10750</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">include/asterisk/frame.h:282</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00042">channelstate.h:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="structcall__queue_html_a0c5bcd98bca1c3085183ba1fc80195ed"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a0c5bcd98bca1c3085183ba1fc80195ed">call_queue::setinterfacevar</a></div><div class="ttdeci">unsigned int setinterfacevar</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01702">app_queue.c:1702</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="mixmonitor_8h_html_aa149ed49d6cff18515821855abd9fc17"><div class="ttname"><a href="../../d9/d40/mixmonitor_8h.html#aa149ed49d6cff18515821855abd9fc17">ast_start_mixmonitor</a></div><div class="ttdeci">int ast_start_mixmonitor(struct ast_channel *chan, const char *filename, const char *options)</div><div class="ttdoc">Start a mixmonitor on a channel with the given parameters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd8/mixmonitor_8c_source.html#l00074">mixmonitor.c:74</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="app__queue_8c_html_a1834405d3ba8801a861dc0e85b1225e3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a1834405d3ba8801a861dc0e85b1225e3">setup_stasis_subs</a></div><div class="ttdeci">static int setup_stasis_subs(struct queue_ent *qe, struct ast_channel *peer, struct member *mem, time_t holdstart, time_t starttime, int callcompletedinsl)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06514">app_queue.c:6514</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="chan__pjsip_8c_html_acc941e909d1ca6a0997028d9562d78da"><div class="ttname"><a href="../../d0/d29/chan__pjsip_8c.html#acc941e909d1ca6a0997028d9562d78da">call</a></div><div class="ttdeci">static int call(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/chan__pjsip_8c_source.html#l02358">chan_pjsip.c:2358</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="channel_8h_html_a40fc421536e02d30fecaa51a255b4144"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a></div><div class="ttdeci">void ast_party_connected_line_free(struct ast_party_connected_line *doomed)</div><div class="ttdoc">Destroy the connected line information contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02072">channel.c:2072</a></div></div>
<div class="ttc" id="app__queue_8c_html_a30fd2efd3517fe2537656bdd18a09c6f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a30fd2efd3517fe2537656bdd18a09c6f">set_queue_result</a></div><div class="ttdeci">static void set_queue_result(struct ast_channel *chan, enum queue_result res)</div><div class="ttdoc">sets the QUEUESTATUS channel variable </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01775">app_queue.c:1775</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="app__queue_8c_html_a332b673addb088061273b81df018d7ac"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a332b673addb088061273b81df018d7ac">queue_function_memberpenalty_read</a></div><div class="ttdeci">static int queue_function_memberpenalty_read(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">Dialplan function QUEUE_MEMBER_PENALTY() Gets the members penalty. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09011">app_queue.c:9011</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_ad62863a88a87dfc024a1d18c32ab3958"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#ad62863a88a87dfc024a1d18c32ab3958">ast_attended_transfer_message::bridge</a></div><div class="ttdeci">char bridge[AST_UUID_STR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00338">stasis_bridges.h:338</a></div></div>
<div class="ttc" id="file_8h_html"><div class="ttname"><a href="../../d2/d4d/file_8h.html">file.h</a></div><div class="ttdoc">Generic File Format Support. Should be included by clients of the file handling routines. File service providers should instead include mod_format.h. </div></div>
<div class="ttc" id="app__queue_8c_html_ab56591994d9db2eb3cf3eb8404c881f4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab56591994d9db2eb3cf3eb8404c881f4">queue_delme_members_decrement_followers</a></div><div class="ttdeci">static int queue_delme_members_decrement_followers(void *obj, void *arg, int flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01887">app_queue.c:1887</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a1e5e3d08eff5e2357e75c01e127e7922"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a></div><div class="ttdeci">char * ast_category_browse(struct ast_config *config, const char *prev_name)</div><div class="ttdoc">Browse categories. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l03328">extconf.c:3328</a></div></div>
<div class="ttc" id="structmember_html_a1d67f434933f43ad9deb32da61dda2b6"><div class="ttname"><a href="../../d7/dd6/structmember.html#a1d67f434933f43ad9deb32da61dda2b6">member::dead</a></div><div class="ttdeci">unsigned int dead</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01613">app_queue.c:1613</a></div></div>
<div class="ttc" id="test__func__file_8c_html_a7df83d295429a2562396f1ec127a46c0"><div class="ttname"><a href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a></div><div class="ttdeci">const char * args</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/test__func__file_8c_source.html#l00046">test_func_file.c:46</a></div></div>
<div class="ttc" id="structcallattempt_html_a4fc1cf8f276dc2f4269cdc890b53e7cd"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a4fc1cf8f276dc2f4269cdc890b53e7cd">callattempt::aoc_s_rate_list</a></div><div class="ttdeci">struct ast_aoc_decoded * aoc_s_rate_list</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01554">app_queue.c:1554</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8e71a98f661c0f497104849cd61261ae"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8e71a98f661c0f497104849cd61261ae">queue_exec_options</a></div><div class="ttdeci">static const struct ast_app_option queue_exec_options[128]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01379">app_queue.c:1379</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3d3fbc78100b994e44f9f270af21c451"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3d3fbc78100b994e44f9f270af21c451">say_periodic_announcement</a></div><div class="ttdeci">static int say_periodic_announcement(struct queue_ent *qe, int ringing)</div><div class="ttdoc">Playback announcement to queued members if period has elapsed. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04747">app_queue.c:4747</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gadeff73697d2789905f4c3a21671ef6d3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gadeff73697d2789905f4c3a21671ef6d3">manager_topic</a></div><div class="ttdeci">static struct stasis_topic * manager_topic</div><div class="ttdoc">A stasis_topic that all topics AMI cares about will be forwarded to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01490">manager.c:1490</a></div></div>
<div class="ttc" id="structcall__queue_html_a2ae7c9e1d1b6942f11170fac6fd73127"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a2ae7c9e1d1b6942f11170fac6fd73127">call_queue::sound_thanks</a></div><div class="ttdeci">const ast_string_field sound_thanks</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67a9b9caf74d13b75b846264a89d5aea9a4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a9b9caf74d13b75b846264a89d5aea9a4">QUEUE_STRATEGY_FEWESTCALLS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01384">app_queue.c:1384</a></div></div>
<div class="ttc" id="callerid_8h_html_a5cdbc47cd18e7f41d450e9caea186b1bac0f31b03872d178b92b054fb07358495"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a5cdbc47cd18e7f41d450e9caea186b1bac0f31b03872d178b92b054fb07358495">AST_CONNECTED_LINE_UPDATE_SOURCE_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00446">callerid.h:446</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3f75910c35a627fb9d15d0024fe0c36b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3f75910c35a627fb9d15d0024fe0c36b">clear_queue</a></div><div class="ttdeci">static void clear_queue(struct call_queue *q)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02863">app_queue.c:2863</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="app__queue_8c_html_a86b9ff2f0b12ba29cd6b78477ea012c3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a86b9ff2f0b12ba29cd6b78477ea012c3">can_ring_entry</a></div><div class="ttdeci">static int can_ring_entry(struct queue_ent *qe, struct callattempt *call)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04388">app_queue.c:4388</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a248afd6c02044259a386f6b7aee922a2"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a></div><div class="ttdeci">#define AST_FRAME_DTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00139">include/asterisk/frame.h:139</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a5a634cf4429798b1c921a81de8250051"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a5a634cf4429798b1c921a81de8250051">input</a></div><div class="ttdeci">static int input(yyscan_t yyscanner)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l01584">ast_expr2f.c:1584</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5a66ec06a1a699e1b7827695ee7fa784"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5a66ec06a1a699e1b7827695ee7fa784">app_rqm</a></div><div class="ttdeci">static char * app_rqm</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01452">app_queue.c:1452</a></div></div>
<div class="ttc" id="channel_8h_html_adcfd8d241b6de48068ead143ac29978d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#adcfd8d241b6de48068ead143ac29978d">ast_channel_setoption</a></div><div class="ttdeci">int ast_channel_setoption(struct ast_channel *channel, int option, void *data, int datalen, int block)</div><div class="ttdoc">Sets an option on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07522">channel.c:7522</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8f11ecb2ece22635477ca2ee913b39e3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8f11ecb2ece22635477ca2ee913b39e3">queue_show</a></div><div class="ttdeci">static char * queue_show(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09974">app_queue.c:9974</a></div></div>
<div class="ttc" id="app__queue_8c_html_a540035f6c37b254f8547dde38b25b6d0"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a540035f6c37b254f8547dde38b25b6d0">handle_masquerade</a></div><div class="ttdeci">static void handle_masquerade(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06455">app_queue.c:6455</a></div></div>
<div class="ttc" id="structmember_html_a22ed1f20028b26f7ece35aeec695293f"><div class="ttname"><a href="../../d7/dd6/structmember.html#a22ed1f20028b26f7ece35aeec695293f">member::delme</a></div><div class="ttdeci">unsigned int delme</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01614">app_queue.c:1614</a></div></div>
<div class="ttc" id="cdr__beanstalkd_8c_html_acec9ce2df15222151ad66fcb1d74eb9f"><div class="ttname"><a href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a></div><div class="ttdeci">static int priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d47/cdr__beanstalkd_8c_source.html#l00076">cdr_beanstalkd.c:76</a></div></div>
<div class="ttc" id="structqueue__ent_html_a1910d262855b71da353ed0d07a6c7823"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a1910d262855b71da353ed0d07a6c7823">queue_ent::pos</a></div><div class="ttdeci">int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01568">app_queue.c:1568</a></div></div>
<div class="ttc" id="module_8h_html_ad2ca15621101154f29748cf1dac3c3cf"><div class="ttname"><a href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a></div><div class="ttdeci">int ast_unregister_application(const char *app)</div><div class="ttdoc">Unregister an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/pbx__app_8c_source.html#l00392">pbx_app.c:392</a></div></div>
<div class="ttc" id="structcall__queue_html_a34c5860043ef96a75828b7107fcffb17"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a34c5860043ef96a75828b7107fcffb17">call_queue::announce_to_first_user</a></div><div class="ttdeci">unsigned int announce_to_first_user</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01701">app_queue.c:1701</a></div></div>
<div class="ttc" id="structrule_html"><div class="ttname"><a href="../../d3/d61/structrule.html">rule</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00248">localtime.c:248</a></div></div>
<div class="ttc" id="musiconhold_8h_html_a52fead32f69533450f3c05b2e6960149"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html#a52fead32f69533450f3c05b2e6960149">ast_moh_stop</a></div><div class="ttdeci">void ast_moh_stop(struct ast_channel *chan)</div><div class="ttdoc">Turn off music on hold on a given channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07876">channel.c:7876</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="structcall__queue_html_a27056a1575e82ba16b1d2cf11ca3eb16"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a27056a1575e82ba16b1d2cf11ca3eb16">call_queue::members</a></div><div class="ttdeci">struct ao2_container * members</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01752">app_queue.c:1752</a></div></div>
<div class="ttc" id="channel_8h_html_af2f955678d93e76be4776d66154b5fdc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af2f955678d93e76be4776d66154b5fdc">ast_channel_call_forward</a></div><div class="ttdeci">const char * ast_channel_call_forward(const struct ast_channel *chan)</div></div>
<div class="ttc" id="structcall__queue_html_a4cee904f94736300a8eba28cc5763bed"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a4cee904f94736300a8eba28cc5763bed">call_queue::head</a></div><div class="ttdeci">struct queue_ent * head</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01753">app_queue.c:1753</a></div></div>
<div class="ttc" id="channel_8h_html_a6610c8171ced0a69738622c11736ff5e"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6610c8171ced0a69738622c11736ff5e">ast_channel_priority</a></div><div class="ttdeci">int ast_channel_priority(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00444">channel_internal_api.c:444</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="structcall__queue_html_ab76c064ab44a836302512ee2adbb297e"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ab76c064ab44a836302512ee2adbb297e">call_queue::monfmt</a></div><div class="ttdeci">char monfmt[8]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01733">app_queue.c:1733</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ab845019b2f1bb324ff57e14192d62c39"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ab845019b2f1bb324ff57e14192d62c39">ast_update_realtime</a></div><div class="ttdeci">int ast_update_realtime(const char *family, const char *keyfield, const char *lookup,...) attribute_sentinel</div><div class="ttdoc">Update realtime configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03489">main/config.c:3489</a></div></div>
<div class="ttc" id="app__queue_8c_html_ac6cf9820dbec95fa8bfd9ca8cafbab98"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac6cf9820dbec95fa8bfd9ca8cafbab98">pending_members_remove</a></div><div class="ttdeci">static void pending_members_remove(struct member *mem)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02426">app_queue.c:2426</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_ad4cabb0173fd175d7bac078a1a49bcb4"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#ad4cabb0173fd175d7bac078a1a49bcb4">ast_attended_transfer_message::to_transferee</a></div><div class="ttdeci">struct ast_bridge_channel_snapshot_pair to_transferee</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00325">stasis_bridges.h:325</a></div></div>
<div class="ttc" id="app__queue_8c_html_a43d6ec3224724bd43cc280902fe22991"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a43d6ec3224724bd43cc280902fe22991">recalc_holdtime</a></div><div class="ttdeci">static void recalc_holdtime(struct queue_ent *qe, int newholdtime)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04128">app_queue.c:4128</a></div></div>
<div class="ttc" id="structcall__queue_html_ad22c84b7016cae07c521dda4a74544f8"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ad22c84b7016cae07c521dda4a74544f8">call_queue::callscompletedinsl</a></div><div class="ttdeci">int callscompletedinsl</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01732">app_queue.c:1732</a></div></div>
<div class="ttc" id="channel_8h_html_a31a465197a7766c3d0bb9f65f0a4418fa0e613bbe5c524be8c225eff98782e3a8"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a31a465197a7766c3d0bb9f65f0a4418fa0e613bbe5c524be8c225eff98782e3a8">AST_CHANNEL_REQUESTOR_BRIDGE_PEER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01479">channel.h:1479</a></div></div>
<div class="ttc" id="structcall__queue_html_af24a688a480acefa8eaa91133cefd156"><div class="ttname"><a href="../../df/db5/structcall__queue.html#af24a688a480acefa8eaa91133cefd156">call_queue::membermacro</a></div><div class="ttdeci">const ast_string_field membermacro</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="manager_8h_html_a3ace32eaf9a3fc2f7d15121c64bf8ecd"><div class="ttname"><a href="../../db/d45/manager_8h.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a></div><div class="ttdeci">struct ast_manager_event_blob * ast_manager_event_blob_create(int event_flags, const char *manager_event, const char *extra_fields_fmt,...)</div><div class="ttdoc">Construct a ast_manager_event_blob. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09727">manager.c:9727</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41">AST_CONTROL_PVT_CAUSE_CODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00310">include/asterisk/frame.h:310</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="structcall__queue_html_a336eac6939e5ebd50b2871148243dee6"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a336eac6939e5ebd50b2871148243dee6">call_queue::announcepositionlimit</a></div><div class="ttdeci">int announcepositionlimit</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01719">app_queue.c:1719</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae72cf4b6314dca87511064e3d257ab1e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae72cf4b6314dca87511064e3d257ab1e">queue_function_mem_write</a></div><div class="ttdeci">static int queue_function_mem_write(struct ast_channel *chan, const char *cmd, char *data, const char *value)</div><div class="ttdoc">Dialplan function QUEUE_MEMBER() Sets the members penalty / paused / ringinuse. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08743">app_queue.c:8743</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab7086bc4304099aec95794ea6ed63260"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab7086bc4304099aec95794ea6ed63260">insert_penaltychange</a></div><div class="ttdeci">static int insert_penaltychange(const char *list_name, const char *content, const int linenum)</div><div class="ttdoc">Change queue penalty by adding rule. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02895">app_queue.c:2895</a></div></div>
<div class="ttc" id="structast__cli__args_html_a2a7a1aa13a4f14075411123a4495593c"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a2a7a1aa13a4f14075411123a4495593c">ast_cli_args::line</a></div><div class="ttdeci">const char * line</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00162">cli.h:162</a></div></div>
<div class="ttc" id="app__queue_8c_html_aecd410aab662a3c57a3ca1fcf1cecfbf"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aecd410aab662a3c57a3ca1fcf1cecfbf">queueexists_function</a></div><div class="ttdeci">static struct ast_custom_function queueexists_function</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09079">app_queue.c:9079</a></div></div>
<div class="ttc" id="app__queue_8c_html_a102046cd40dd055e01a8b22491c89ce4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a102046cd40dd055e01a8b22491c89ce4">rt_handle_member_record</a></div><div class="ttdeci">static void rt_handle_member_record(struct call_queue *q, char *category, struct ast_config *member_config)</div><div class="ttdoc">Find rt member record to update otherwise create one. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03392">app_queue.c:3392</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7f4919ce97dcdee0a98979ca4de29242"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_create(struct ast_channel *chan)</div><div class="ttdoc">Generate a snapshot of the channel state. This is an ao2 object, so ao2_cleanup() to deallocate...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00451">stasis_channels.c:451</a></div></div>
<div class="ttc" id="pbx_8h_html_a965977ea9a3144bc203e0ce7a64680a1"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a></div><div class="ttdeci">int ast_custom_function_unregister(struct ast_custom_function *acf)</div><div class="ttdoc">Unregister a custom function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d70/pbx__functions_8c_source.html#l00273">pbx_functions.c:273</a></div></div>
<div class="ttc" id="structmember_html_a56c9306da4383826a84cd7602384db15"><div class="ttname"><a href="../../d7/dd6/structmember.html#a56c9306da4383826a84cd7602384db15">member::membername</a></div><div class="ttdeci">char membername[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01598">app_queue.c:1598</a></div></div>
<div class="ttc" id="structmember_html_a0b09e11c9a5a7f8ec93a16554befec89"><div class="ttname"><a href="../../d7/dd6/structmember.html#a0b09e11c9a5a7f8ec93a16554befec89">member::interface</a></div><div class="ttdeci">char interface[AST_CHANNEL_NAME]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01593">app_queue.c:1593</a></div></div>
<div class="ttc" id="pbx_8h_html_a93f9868530c1e8a9d9d367d1ead8782e"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a93f9868530c1e8a9d9d367d1ead8782e">ast_canmatch_extension</a></div><div class="ttdeci">int ast_canmatch_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Looks for a valid matching extension. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04194">pbx.c:4194</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa21a70b7d5a3490c980bd54a3f8ed5e3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa21a70b7d5a3490c980bd54a3f8ed5e3">update_connected_line_from_peer</a></div><div class="ttdeci">static void update_connected_line_from_peer(struct ast_channel *chan, struct ast_channel *peer, int is_caller)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04906">app_queue.c:4906</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga54c9b2b1131c872d25a1395882333ae3"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga54c9b2b1131c872d25a1395882333ae3">ast_multi_channel_blob_get_json</a></div><div class="ttdeci">struct ast_json * ast_multi_channel_blob_get_json(struct ast_multi_channel_blob *obj)</div><div class="ttdoc">Retrieve the JSON blob from a ast_multi_channel_blob. Returned ast_json is still owned by obj...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l01030">stasis_channels.c:1030</a></div></div>
<div class="ttc" id="app__queue_8c_html_aeb9ef797eacc8523239c5136cfb7677e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aeb9ef797eacc8523239c5136cfb7677e">topic_forwarder</a></div><div class="ttdeci">static struct stasis_forward * topic_forwarder</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11248">app_queue.c:11248</a></div></div>
<div class="ttc" id="pbx_8h_html_a98c5425b90ec7c5e136a40f529170b1b"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a></div><div class="ttdeci">const char * pbx_builtin_getvar_helper(struct ast_channel *chan, const char *name)</div><div class="ttdoc">Return a pointer to the value of the corresponding channel variable. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01000">pbx_variables.c:1000</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="monitor_8h_html_ac03869f26afacb6d45355d401ced19d8"><div class="ttname"><a href="../../d5/d60/monitor_8h.html#ac03869f26afacb6d45355d401ced19d8">X_REC_OUT</a></div><div class="ttdeci">#define X_REC_OUT</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/monitor_8h_source.html#l00031">monitor.h:31</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6a1532fb860aed655673cca9f18f44a7d1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1532fb860aed655673cca9f18f44a7d1">QUEUE_EMPTY_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01626">app_queue.c:1626</a></div></div>
<div class="ttc" id="app__queue_8c_html_aeee3b4385050286dedc0e20f247d428c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aeee3b4385050286dedc0e20f247d428c">strat2int</a></div><div class="ttdeci">static int strat2int(const char *strategy)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01800">app_queue.c:1800</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6e99f5e0e3c3fa175e9fafe3af76c25e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6e99f5e0e3c3fa175e9fafe3af76c25e">extension_state_cb</a></div><div class="ttdeci">static int extension_state_cb(const char *context, const char *exten, struct ast_state_cb_info *info, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02627">app_queue.c:2627</a></div></div>
<div class="ttc" id="app__queue_8c_html_a662a43c452569dfc9f20d49a73498c64"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a662a43c452569dfc9f20d49a73498c64">RES_OUTOFMEMORY</a></div><div class="ttdeci">#define RES_OUTOFMEMORY</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01443">app_queue.c:1443</a></div></div>
<div class="ttc" id="stringfields_8h_html"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html">stringfields.h</a></div></div>
<div class="ttc" id="utils_8h_html"><div class="ttname"><a href="../../d5/d60/utils_8h.html">utils.h</a></div><div class="ttdoc">Utility functions. </div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structast__channel__blob_html"><div class="ttname"><a href="../../db/df0/structast__channel__blob.html">ast_channel_blob</a></div><div class="ttdoc">Blob of data associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00184">stasis_channels.h:184</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae803d04a5ce0edaf0c49e2be684d9436"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae803d04a5ce0edaf0c49e2be684d9436">member_status_available</a></div><div class="ttdeci">static int member_status_available(int status)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04374">app_queue.c:4374</a></div></div>
<div class="ttc" id="channel_8h_html_a39fc055500e09810d0afd0bff87407c5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a39fc055500e09810d0afd0bff87407c5">ast_request</a></div><div class="ttdeci">struct ast_channel * ast_request(const char *type, struct ast_format_cap *request_cap, const struct ast_assigned_ids *assignedids, const struct ast_channel *requestor, const char *addr, int *cause)</div><div class="ttdoc">Requests a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06444">channel.c:6444</a></div></div>
<div class="ttc" id="structlocal__optimization_html_a891af128a67273822773687701431aaa"><div class="ttname"><a href="../../dc/d83/structlocal__optimization.html#a891af128a67273822773687701431aaa">local_optimization::source_chan_uniqueid</a></div><div class="ttdeci">const char * source_chan_uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05935">app_queue.c:5935</a></div></div>
<div class="ttc" id="channel_8h_html_ae616309e9eba6a1b009a0466bada50cc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae616309e9eba6a1b009a0466bada50cc">ast_channel_whentohangup</a></div><div class="ttdeci">struct timeval * ast_channel_whentohangup(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00928">channel_internal_api.c:928</a></div></div>
<div class="ttc" id="structcall__queue_html"><div class="ttname"><a href="../../df/db5/structcall__queue.html">call_queue</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01656">app_queue.c:1656</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9e5f57131367eff409b9e0bd7b31aa1a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a></div><div class="ttdeci">static char * app</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01448">app_queue.c:1448</a></div></div>
<div class="ttc" id="structcall__queue_html_ac3419e9b31cb1aebe3666439449bcecc"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ac3419e9b31cb1aebe3666439449bcecc">call_queue::wrapped</a></div><div class="ttdeci">unsigned int wrapped</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01706">app_queue.c:1706</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5b0161cb9388c7e8886b1b35a9b54fdc"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5b0161cb9388c7e8886b1b35a9b54fdc">manager_queue_rule_show</a></div><div class="ttdeci">static int manager_queue_rule_show(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09990">app_queue.c:9990</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2a7a78b91c9ba54f89c9b5a9e7435027"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027">ast_manager_str_from_json_object</a></div><div class="ttdeci">struct ast_str * ast_manager_str_from_json_object(struct ast_json *blob, key_exclusion_cb exclusion_cb)</div><div class="ttdoc">Convert a JSON object into an AMI compatible string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01821">manager.c:1821</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a520a3c6b7d57903d9a616051da1a019d"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a520a3c6b7d57903d9a616051da1a019d">AST_APP_OPTIONS</a></div><div class="ttdeci">#define AST_APP_OPTIONS(holder, options...)</div><div class="ttdoc">Declares an array of options for an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01393">include/asterisk/app.h:1393</a></div></div>
<div class="ttc" id="app__queue_8c_html_aec2dcfe87edd23912e4e94c46085af2c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aec2dcfe87edd23912e4e94c46085af2c">handle_queue_set_member_ringinuse</a></div><div class="ttdeci">static char * handle_queue_set_member_ringinuse(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10896">app_queue.c:10896</a></div></div>
<div class="ttc" id="structnumber_html"><div class="ttname"><a href="../../d6/d49/structnumber.html">number</a></div><div class="ttdoc">Number structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d55/app__followme_8c_source.html#l00154">app_followme.c:154</a></div></div>
<div class="ttc" id="structast__channel_html_aa8f6a3233b196d1a6b727edc83063a63"><div class="ttname"><a href="../../df/d3c/structast__channel.html#aa8f6a3233b196d1a6b727edc83063a63">ast_channel::tech</a></div><div class="ttdeci">const struct ast_channel_tech * tech</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00074">channel_internal_api.c:74</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae2c06dcaa81d44b2782bb33be68c4858"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae2c06dcaa81d44b2782bb33be68c4858">wait_a_bit</a></div><div class="ttdeci">static int wait_a_bit(struct queue_ent *qe)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07229">app_queue.c:7229</a></div></div>
<div class="ttc" id="app__queue_8c_html_a0518452f134d22e471d5501d4c02102d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a0518452f134d22e471d5501d4c02102d">queue_channel_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_channel_to_ami(const char *type, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01976">app_queue.c:1976</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="app__queue_8c_html_a0034e8c905ec7f5d1222f3ac4947efa8"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a0034e8c905ec7f5d1222f3ac4947efa8">wait_for_answer</a></div><div class="ttdeci">static struct callattempt * wait_for_answer(struct queue_ent *qe, struct callattempt *outgoing, int *to, char *digit, int prebusies, int caller_disconnect, int forwardsallowed)</div><div class="ttdoc">Wait for a member to answer the call. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04937">app_queue.c:4937</a></div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625fa83180bb058ded006c01229431fc887f9"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa83180bb058ded006c01229431fc887f9">AST_EXTENSION_ONHOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00069">pbx.h:69</a></div></div>
<div class="ttc" id="app__queue_8c_html_a449c2a013ceb381a8f619d51fb609711"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a449c2a013ceb381a8f619d51fb609711">compare_weight</a></div><div class="ttdeci">static int compare_weight(struct call_queue *rq, struct member *member)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04323">app_queue.c:4323</a></div></div>
<div class="ttc" id="structcall__queue_html_aebac91dc9bbd110e44f8ffa9f2e697d1"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aebac91dc9bbd110e44f8ffa9f2e697d1">call_queue::holdtime</a></div><div class="ttdeci">int holdtime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01726">app_queue.c:1726</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62aaa5bca1f003f34f5c7beff4860a48dc0">QUEUE_AUTOPAUSE_OFF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01393">app_queue.c:1393</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="structast__party__caller_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_party_caller::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdoc">Caller party ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00421">channel.h:421</a></div></div>
<div class="ttc" id="app__queue_8c_html_a7b254b14693f1f30d4ddd615d7f777b9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a7b254b14693f1f30d4ddd615d7f777b9">queue_function_var</a></div><div class="ttdeci">static int queue_function_var(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">create interface var with all queue details. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08555">app_queue.c:8555</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad4e6d4309c0c90061cdc3d10adb669a0"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad4e6d4309c0c90061cdc3d10adb669a0">queue_function_memberpenalty_write</a></div><div class="ttdeci">static int queue_function_memberpenalty_write(struct ast_channel *chan, const char *cmd, char *data, const char *value)</div><div class="ttdoc">Dialplan function QUEUE_MEMBER_PENALTY() Sets the members penalty. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09043">app_queue.c:9043</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_a82a439e20f31112e595909550f5201c4"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#a82a439e20f31112e595909550f5201c4">ast_attended_transfer_message::to_transfer_target</a></div><div class="ttdeci">struct ast_bridge_channel_snapshot_pair to_transfer_target</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00327">stasis_bridges.h:327</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html">config.h</a></div><div class="ttdoc">Configuration File Parser. </div></div>
<div class="ttc" id="structast__state__cb__info_html_a6f3d8aa9a90b701e81dad4cc4a56be67"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html#a6f3d8aa9a90b701e81dad4cc4a56be67">ast_state_cb_info::exten_state</a></div><div class="ttdeci">enum ast_extension_states exten_state</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00104">pbx.h:104</a></div></div>
<div class="ttc" id="channel_8h_html_a6ce892974f59537bda03a71319b452e2"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6ce892974f59537bda03a71319b452e2">ast_channel_datastore_inherit</a></div><div class="ttdeci">int ast_channel_datastore_inherit(struct ast_channel *from, struct ast_channel *to)</div><div class="ttdoc">Inherit datastores from a parent to a child. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02373">channel.c:2373</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3ae014616d0271c5671a6d8c24c46dc6b2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae014616d0271c5671a6d8c24c46dc6b2">OPT_PREDIAL_CALLEE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01345">app_queue.c:1345</a></div></div>
<div class="ttc" id="devicestate_8h_html_a9459272db1c8c968ed1aff1387f0f9fd"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type</a></div><div class="ttdeci">struct stasis_message_type * ast_device_state_message_type(void)</div><div class="ttdoc">Get the Stasis message type for device state messages. </div></div>
<div class="ttc" id="app__queue_8c_html_a1802f66ae1666498af70e9a4ff2e616b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a1802f66ae1666498af70e9a4ff2e616b">RES_NOT_CALLER</a></div><div class="ttdeci">#define RES_NOT_CALLER</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01446">app_queue.c:1446</a></div></div>
<div class="ttc" id="structast__bridge__blob_html_a820b583b07f0cf97618ca22d73cd8f09"><div class="ttname"><a href="../../d7/d01/structast__bridge__blob.html#a820b583b07f0cf97618ca22d73cd8f09">ast_bridge_blob::bridge</a></div><div class="ttdeci">struct ast_bridge_snapshot * bridge</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00125">stasis_bridges.h:125</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2cd3616d2484da0e9bc9442ebfba0d7e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2cd3616d2484da0e9bc9442ebfba0d7e">realtime_ringinuse_field</a></div><div class="ttdeci">static char * realtime_ringinuse_field</div><div class="ttdoc">name of the ringinuse field in the realtime database </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01493">app_queue.c:1493</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga34a3ac59fb8d0c49cbc2cb9b87261d31"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga34a3ac59fb8d0c49cbc2cb9b87261d31">ast_channel_topic_all</a></div><div class="ttdeci">struct stasis_topic * ast_channel_topic_all(void)</div><div class="ttdoc">A topic which publishes the events for all channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00128">stasis_channels.c:128</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_adece183191b0e700e039e59101e06105"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">ast_frame_subclass::integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00152">include/asterisk/frame.h:152</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6a85b9e406efa42c21f44d6f5b3ae9b332"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a85b9e406efa42c21f44d6f5b3ae9b332">QUEUE_EMPTY_INUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01622">app_queue.c:1622</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_abd45d96954fe74af9e011742ce09882d"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#abd45d96954fe74af9e011742ce09882d">ast_attended_transfer_message::result</a></div><div class="ttdeci">enum ast_transfer_result result</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00321">stasis_bridges.h:321</a></div></div>
<div class="ttc" id="utils_8h_html_ae01ad140af5f1041395f4355ed0f4d60"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ae01ad140af5f1041395f4355ed0f4d60">ast_replace_subargument_delimiter</a></div><div class="ttdeci">void ast_replace_subargument_delimiter(char *s)</div><div class="ttdoc">Replace &amp;#39;^&amp;#39; in a string with &amp;#39;,&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02095">main/utils.c:2095</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structqueue__ent_html_ad8228f854a0f6f5f4bdbd00de5c7fa6f"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ad8228f854a0f6f5f4bdbd00de5c7fa6f">queue_ent::predial_callee</a></div><div class="ttdeci">const char * predial_callee</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01566">app_queue.c:1566</a></div></div>
<div class="ttc" id="channel_8h_html_a25f1c885c7f5230ea4c9bc48dde88fe1ae16218a9dfb2123d391f959e3d078362"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ae16218a9dfb2123d391f959e3d078362">AST_FEATURE_AUTOMON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01068">channel.h:1068</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a28cd8e9f9005e25624f993d6edd46755"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a28cd8e9f9005e25624f993d6edd46755">AST_CONTROL_OFFHOOK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00284">include/asterisk/frame.h:284</a></div></div>
<div class="ttc" id="app__queue_8c_html_ac3cd051d456ef70c6b88a3c2c6056432"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac3cd051d456ef70c6b88a3c2c6056432">member_add_to_queue</a></div><div class="ttdeci">static void member_add_to_queue(struct call_queue *queue, struct member *mem)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03360">app_queue.c:3360</a></div></div>
<div class="ttc" id="compiler_8h_html_af2af475b85aef66019c417d8ded1c435"><div class="ttname"><a href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a></div><div class="ttdeci">#define SENTINEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd1/compiler_8h_source.html#l00087">compiler.h:87</a></div></div>
<div class="ttc" id="structast__db__entry_html_a3fee4a0a4bff112e0262fb8d49f41b5e"><div class="ttname"><a href="../../da/d1d/structast__db__entry.html#a3fee4a0a4bff112e0262fb8d49f41b5e">ast_db_entry::next</a></div><div class="ttdeci">struct ast_db_entry * next</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4a/astdb_8h_source.html#l00032">astdb.h:32</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea17b87dfa3f4de5909b401017e229091d"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea17b87dfa3f4de5909b401017e229091d">AST_DEVICE_RINGINUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00060">devicestate.h:60</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca269370d42230fc6aa6700e2948e1eb20">OBJ_SEARCH_PARTIAL_KEY</a></div><div class="ttdoc">The arg parameter is a partial search key similar to OBJ_SEARCH_KEY. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01120">astobj2.h:1120</a></div></div>
<div class="ttc" id="aoc_8h_html"><div class="ttname"><a href="../../d6/db3/aoc_8h.html">aoc.h</a></div><div class="ttdoc">Generic Advice of Charge encode and decode routines. </div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a0a07ddd6bbcf44485e01c14c96109482"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a></div><div class="ttdeci">#define ast_config_load(filename, flags)</div><div class="ttdoc">Load a config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">include/asterisk/config.h:179</a></div></div>
<div class="ttc" id="structcall__queue_html_a958d0897e16b3262a0579075e3999187"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a958d0897e16b3262a0579075e3999187">call_queue::sound_minute</a></div><div class="ttdeci">const ast_string_field sound_minute</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a272ff295ebf6d216c1320a296908753a">QUEUE_STRATEGY_RRMEMORY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01386">app_queue.c:1386</a></div></div>
<div class="ttc" id="structcallattempt_html_a5023e29d4234076952bfecfff178b566"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a5023e29d4234076952bfecfff178b566">callattempt::connected</a></div><div class="ttdeci">struct ast_party_connected_line connected</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01545">app_queue.c:1545</a></div></div>
<div class="ttc" id="channel_8h_html_a4aff0f5358bdc107a92320b4c4631834"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4aff0f5358bdc107a92320b4c4631834">ast_channel_make_compatible</a></div><div class="ttdeci">int ast_channel_make_compatible(struct ast_channel *chan, struct ast_channel *peer)</div><div class="ttdoc">Make the frame formats of two channels compatible. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06817">channel.c:6817</a></div></div>
<div class="ttc" id="aoc_8h_html_a3849b484bd42840860ada0ac3db4f96d"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a3849b484bd42840860ada0ac3db4f96d">ast_aoc_decode</a></div><div class="ttdeci">struct ast_aoc_decoded * ast_aoc_decode(struct ast_aoc_encoded *encoded, size_t size, struct ast_channel *chan)</div><div class="ttdoc">decodes an encoded aoc payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00449">aoc.c:449</a></div></div>
<div class="ttc" id="devicestate_8h_html_a62a8e6bc4b82dd797e505688f9f29bff"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a></div><div class="ttdeci">int ast_devstate_changed(enum ast_device_state state, enum ast_devstate_cache cachable, const char *fmt,...)</div><div class="ttdoc">Tells Asterisk the State for Device is changed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00510">devicestate.c:510</a></div></div>
<div class="ttc" id="app__queue_8c_html_a94baaee180e6f6ae082418dc78e7c7cf"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a94baaee180e6f6ae082418dc78e7c7cf">queue_set_param</a></div><div class="ttdeci">static void queue_set_param(struct call_queue *q, const char *param, const char *val, int linenum, int failunknown)</div><div class="ttdoc">Configure a queue parameter. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03144">app_queue.c:3144</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9db8c10e0e5c60a4733e7f62ac7c567a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9db8c10e0e5c60a4733e7f62ac7c567a">queue_member_pause_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_member_pause_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02050">app_queue.c:2050</a></div></div>
<div class="ttc" id="app__queue_8c_html_a23c0aa9ae2331c5f79a8e7a998a20ea0"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a23c0aa9ae2331c5f79a8e7a998a20ea0">queuemembercount_function</a></div><div class="ttdeci">static struct ast_custom_function queuemembercount_function</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09089">app_queue.c:9089</a></div></div>
<div class="ttc" id="structast__party__caller_html_aeeb8c05290fd113bd0d1a3129898fd49"><div class="ttname"><a href="../../d4/d77/structast__party__caller.html#aeeb8c05290fd113bd0d1a3129898fd49">ast_party_caller::ani</a></div><div class="ttdeci">struct ast_party_id ani</div><div class="ttdoc">Automatic Number Identification (ANI) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00428">channel.h:428</a></div></div>
<div class="ttc" id="app__queue_8c_html_af59feeff9c61049bf1d1a7839164564d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564d">agent_complete_reason</a></div><div class="ttdeci">agent_complete_reason</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05857">app_queue.c:5857</a></div></div>
<div class="ttc" id="structcall__queue_html_a2a43a68cf8add918260068d677434132"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a2a43a68cf8add918260068d677434132">call_queue::periodicannouncefrequency</a></div><div class="ttdeci">int periodicannouncefrequency</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01722">app_queue.c:1722</a></div></div>
<div class="ttc" id="app__queue_8c_html_a60c18ff0a82f2460a253a69179aa9534"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a60c18ff0a82f2460a253a69179aa9534">queues</a></div><div class="ttdeci">static struct ao2_container * queues</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01766">app_queue.c:1766</a></div></div>
<div class="ttc" id="app__queue_8c_html_acb5e3261ae018d7bbe4cbdcc9cace101"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acb5e3261ae018d7bbe4cbdcc9cace101">end_bridge_callback</a></div><div class="ttdeci">static void end_bridge_callback(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06575">app_queue.c:6575</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_a3fa409a52b6210dbe249b2f37430fd4a"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#a3fa409a52b6210dbe249b2f37430fd4a">ast_attended_transfer_message::app</a></div><div class="ttdeci">char app[AST_MAX_APP]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00340">stasis_bridges.h:340</a></div></div>
<div class="ttc" id="channel_8h_html"><div class="ttname"><a href="../../d5/d7b/channel_8h.html">channel.h</a></div><div class="ttdoc">General Asterisk PBX channel definitions. </div></div>
<div class="ttc" id="structqueue__stasis__data_html_aaa4f0dc199f06516925d5cd39dc6c1ea"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#aaa4f0dc199f06516925d5cd39dc6c1ea">queue_stasis_data::queue</a></div><div class="ttdeci">struct call_queue * queue</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05967">app_queue.c:5967</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a403ec8b49645ea204e82cb72bb8cf9f4"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a403ec8b49645ea204e82cb72bb8cf9f4">ast_realtime_require_field</a></div><div class="ttdeci">int ast_realtime_require_field(const char *family,...) attribute_sentinel</div><div class="ttdoc">Inform realtime what fields that may be stored. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03382">main/config.c:3382</a></div></div>
<div class="ttc" id="structmember_html_ac924645eef1e4dee82dde344a5c667d5"><div class="ttname"><a href="../../d7/dd6/structmember.html#ac924645eef1e4dee82dde344a5c667d5">member::lastpause</a></div><div class="ttdeci">time_t lastpause</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01611">app_queue.c:1611</a></div></div>
<div class="ttc" id="module_8h_html_a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223"><div class="ttname"><a href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00317">module.h:317</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_aca392a8d3941cd0740aef3ad92545d67"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a></div><div class="ttdeci">FILE * in</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00033">utils/frame.c:33</a></div></div>
<div class="ttc" id="structcallattempt_html_ab7103c08fa28b20499d3a68a29c7e0a8"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#ab7103c08fa28b20499d3a68a29c7e0a8">callattempt::metric</a></div><div class="ttdeci">int metric</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01542">app_queue.c:1542</a></div></div>
<div class="ttc" id="structmember_html_a70500289fa53bc6e8b1c2d7b82a11640"><div class="ttname"><a href="../../d7/dd6/structmember.html#a70500289fa53bc6e8b1c2d7b82a11640">member::penalty</a></div><div class="ttdeci">int penalty</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01599">app_queue.c:1599</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_a7f2aed874f63d44e55ccbe7b4e59f356"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#a7f2aed874f63d44e55ccbe7b4e59f356">ast_attended_transfer_message::links</a></div><div class="ttdeci">struct ast_channel_snapshot * links[2]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00342">stasis_bridges.h:342</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a96a1965ee856fa58fbd96bc5b0ffc101">QUEUE_LEAVEEMPTY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01499">app_queue.c:1499</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9827f040c8a8bbf13b82b6098c0e7d25"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9827f040c8a8bbf13b82b6098c0e7d25">queuememberpenalty_function</a></div><div class="ttdeci">static struct ast_custom_function queuememberpenalty_function</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09115">app_queue.c:9115</a></div></div>
<div class="ttc" id="app__queue_8c_html_a70c5fe5519fb5cbb2aa683c7a49ef04b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a70c5fe5519fb5cbb2aa683c7a49ef04b">pqm_exec</a></div><div class="ttdeci">static int pqm_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">PauseQueueMember application. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07882">app_queue.c:7882</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="app__queue_8c_html_a75901a27e4606596337f8579b5637b53"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a75901a27e4606596337f8579b5637b53">complete_queue_set_member_value</a></div><div class="ttdeci">static char * complete_queue_set_member_value(const char *line, const char *word, int pos, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10873">app_queue.c:10873</a></div></div>
<div class="ttc" id="structcall__queue_html_adc032ac2dcea31bd708fc762f42c385e"><div class="ttname"><a href="../../df/db5/structcall__queue.html#adc032ac2dcea31bd708fc762f42c385e">call_queue::memberdelay</a></div><div class="ttdeci">int memberdelay</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01749">app_queue.c:1749</a></div></div>
<div class="ttc" id="structcall__queue_html_addf2eb79daee1e400c823a699b0f856b"><div class="ttname"><a href="../../df/db5/structcall__queue.html#addf2eb79daee1e400c823a699b0f856b">call_queue::retry</a></div><div class="ttdeci">int retry</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01740">app_queue.c:1740</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="structast__device__state__message_html_a39d1b63955a48c72508fa9f884d05762"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html#a39d1b63955a48c72508fa9f884d05762">ast_device_state_message::eid</a></div><div class="ttdeci">const struct ast_eid * eid</div><div class="ttdoc">The EID of the server where this message originated. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00248">devicestate.h:248</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00043">bridge_features.h:43</a></div></div>
<div class="ttc" id="app__queue_8c_html_a74f21e24f4f0efdeaebc930e41500f4f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a74f21e24f4f0efdeaebc930e41500f4f">complete_queue</a></div><div class="ttdeci">static char * complete_queue(const char *line, const char *word, int pos, int state, ptrdiff_t word_list_offset)</div><div class="ttdoc">Check if a given word is in a space-delimited list. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09929">app_queue.c:9929</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67a89db95f6e97c58cd5915abddc140df70"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a89db95f6e97c58cd5915abddc140df70">QUEUE_STRATEGY_RANDOM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01385">app_queue.c:1385</a></div></div>
<div class="ttc" id="structqueue__end__bridge_html_a6d8b242e106dd6592a625bdc396bbe55"><div class="ttname"><a href="../../d5/d61/structqueue__end__bridge.html#a6d8b242e106dd6592a625bdc396bbe55">queue_end_bridge::q</a></div><div class="ttdeci">struct call_queue * q</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06564">app_queue.c:6564</a></div></div>
<div class="ttc" id="channel_8h_html_a10f23f1907b804485f62973f66cd9aef"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a></div><div class="ttdeci">struct ast_party_connected_line * ast_channel_connected(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00892">channel_internal_api.c:892</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5186e735a8b6b1d630a236fce8db0fd7"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5186e735a8b6b1d630a236fce8db0fd7">QUEUE_PAUSED_DEVSTATE</a></div><div class="ttdeci">#define QUEUE_PAUSED_DEVSTATE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03350">app_queue.c:3350</a></div></div>
<div class="ttc" id="structstasis__message__router_html"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00131">stasis_message_router.c:131</a></div></div>
<div class="ttc" id="app__queue_8c_html_a031fff6b06ef6683954708c49280137f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a031fff6b06ef6683954708c49280137f">handle_bridge_enter</a></div><div class="ttdeci">static void handle_bridge_enter(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06112">app_queue.c:6112</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_adf5e7e1635f0aef4ff3c2119a46dbca4"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#adf5e7e1635f0aef4ff3c2119a46dbca4">queue_stasis_data::member</a></div><div class="ttdeci">struct member * member</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05969">app_queue.c:5969</a></div></div>
<div class="ttc" id="structast__device__state__message_html_a8059c3b19eb356cf729e5d25b139647e"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html#a8059c3b19eb356cf729e5d25b139647e">ast_device_state_message::device</a></div><div class="ttdeci">const char * device</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00242">devicestate.h:242</a></div></div>
<div class="ttc" id="structast__cli__args_html_acfc02ec89670db29251fda6a66602ce2"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">ast_cli_args::n</a></div><div class="ttdeci">const int n</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00165">cli.h:165</a></div></div>
<div class="ttc" id="aoc_8h_html_abbf1344a7eae88ea2cef85c1b0b6c24d"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#abbf1344a7eae88ea2cef85c1b0b6c24d">ast_aoc_encode</a></div><div class="ttdeci">struct ast_aoc_encoded * ast_aoc_encode(struct ast_aoc_decoded *decoded, size_t *out_size, struct ast_channel *chan)</div><div class="ttdoc">encodes a decoded aoc structure so it can be passed on the wire </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00650">aoc.c:650</a></div></div>
<div class="ttc" id="structcallattempt_html_a482a41c13a82d121309b1d13db4e906f"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a482a41c13a82d121309b1d13db4e906f">callattempt::block_connected_update</a></div><div class="ttdeci">unsigned int block_connected_update</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01549">app_queue.c:1549</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2faf444ec9b83e1847ac166c994ba3a8"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2faf444ec9b83e1847ac166c994ba3a8">parse_empty_options</a></div><div class="ttdeci">static void parse_empty_options(const char *value, enum empty_conditions *empty, int joinempty)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03101">app_queue.c:3101</a></div></div>
<div class="ttc" id="structcall__queue_html_a0869cb7961f7e245b3b7f8ece1457d5f"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a0869cb7961f7e245b3b7f8ece1457d5f">call_queue::sound_thereare</a></div><div class="ttdeci">const ast_string_field sound_thereare</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="app__queue_8c_html_a563ce4840e1461a302bd2af34d404f38"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a563ce4840e1461a302bd2af34d404f38">MAX_CALL_ATTEMPT_BUCKETS</a></div><div class="ttdeci">#define MAX_CALL_ATTEMPT_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02376">app_queue.c:2376</a></div></div>
<div class="ttc" id="structast__custom__function_html"><div class="ttname"><a href="../../db/dc0/structast__custom__function.html">ast_custom_function</a></div><div class="ttdoc">Data structure associated with a custom dialplan function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00118">pbx.h:118</a></div></div>
<div class="ttc" id="causes_8h_html_aa71419a0c598e31312477c5a644e7440"><div class="ttname"><a href="../../d4/da3/causes_8h.html#aa71419a0c598e31312477c5a644e7440">AST_CAUSE_ANSWERED_ELSEWHERE</a></div><div class="ttdeci">#define AST_CAUSE_ANSWERED_ELSEWHERE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00113">causes.h:113</a></div></div>
<div class="ttc" id="structqueue__ent_html_a93d5d1c5d8bf62627163cd9e53ed5048"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a93d5d1c5d8bf62627163cd9e53ed5048">queue_ent::ring_when_ringing</a></div><div class="ttdeci">int ring_when_ringing</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01571">app_queue.c:1571</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga9a3ff91f86f5f2e7e60571246c8e5873"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga9a3ff91f86f5f2e7e60571246c8e5873">ast_multi_channel_blob_add_channel</a></div><div class="ttdeci">void ast_multi_channel_blob_add_channel(struct ast_multi_channel_blob *obj, const char *role, struct ast_channel_snapshot *snapshot)</div><div class="ttdoc">Add a ast_channel_snapshot to a ast_multi_channel_blob object. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00956">stasis_channels.c:956</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a">AST_DEVICE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00053">devicestate.h:53</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8821eb9b47e097bb4696445a321d5e4a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8821eb9b47e097bb4696445a321d5e4a">free_members</a></div><div class="ttdeci">static void free_members(struct call_queue *q, int all)</div><div class="ttdoc">Iterate through queue&amp;#39;s member list and delete them. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03503">app_queue.c:3503</a></div></div>
<div class="ttc" id="astobj2_8h_html"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html">astobj2.h</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="app__queue_8c_html_a09ce5f08213c1eb769ddeba153a100aa"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a09ce5f08213c1eb769ddeba153a100aa">interface_exists</a></div><div class="ttdeci">static struct member * interface_exists(struct call_queue *q, const char *interface)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07242">app_queue.c:7242</a></div></div>
<div class="ttc" id="bridge__basic_8c_html_a6ab6e51f783d7cea98857990908996d3"><div class="ttname"><a href="../../d7/d9b/bridge__basic_8c.html#a6ab6e51f783d7cea98857990908996d3">ringing</a></div><div class="ttdeci">static void ringing(struct ast_channel *chan)</div><div class="ttdoc">Helper method to send a ringing indication to a channel in a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/bridge__basic_8c_source.html#l01814">bridge_basic.c:1814</a></div></div>
<div class="ttc" id="channel_8h_html_af4e59494f74ad9e0c50170d9e276ad31"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a></div><div class="ttdeci">#define AST_MAX_EXTENSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00135">channel.h:135</a></div></div>
<div class="ttc" id="app__queue_8c_html_af59feeff9c61049bf1d1a7839164564da40e60d510aa885cf9334b0c0175cd2b2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564da40e60d510aa885cf9334b0c0175cd2b2">AGENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05859">app_queue.c:5859</a></div></div>
<div class="ttc" id="strings_8h_html_ac92713b8d07a45720b2664be70810e55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a></div><div class="ttdeci">char * ast_strip(char *s)</div><div class="ttdoc">Strip leading/trailing whitespace from a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00219">strings.h:219</a></div></div>
<div class="ttc" id="structast__frame_html_ad67e07841d1233e596e6f822a3c81f6b"><div class="ttname"><a href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">ast_frame::datalen</a></div><div class="ttdeci">int datalen</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">include/asterisk/frame.h:171</a></div></div>
<div class="ttc" id="structcall__queue_html_a7faec841658b88ad0cfbc684853acad3"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a7faec841658b88ad0cfbc684853acad3">call_queue::context</a></div><div class="ttdeci">const ast_string_field context</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="app__queue_8c_html_a64113fcde5e28056a961c3379ac11bd3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a64113fcde5e28056a961c3379ac11bd3">update_queue</a></div><div class="ttdeci">static int update_queue(struct call_queue *q, struct member *member, int callcompletedinsl, time_t starttime)</div><div class="ttdoc">update the queue status </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05707">app_queue.c:5707</a></div></div>
<div class="ttc" id="channel_8h_html_a88fe9ad417e869049cb359030f06cab4"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a88fe9ad417e869049cb359030f06cab4">ast_channel_redirecting_sub</a></div><div class="ttdeci">int ast_channel_redirecting_sub(struct ast_channel *autoservice_chan, struct ast_channel *sub_chan, const void *redirecting_info, int is_frame)</div><div class="ttdoc">Run a redirecting interception subroutine and update a channel&amp;#39;s redirecting information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10584">channel.c:10584</a></div></div>
<div class="ttc" id="res__monitor_8c_html_acbcd8e50de0a8867d7a843c2b6915e0d"><div class="ttname"><a href="../../d2/d1b/res__monitor_8c.html#acbcd8e50de0a8867d7a843c2b6915e0d">ast_monitor_start</a></div><div class="ttdeci">int AST_OPTIONAL_API_NAME() ast_monitor_start(struct ast_channel *chan, const char *format_spec, const char *fname_base, int need_lock, int stream_action, const char *beep_id)</div><div class="ttdoc">Start monitoring a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1b/res__monitor_8c_source.html#l00305">res_monitor.c:305</a></div></div>
<div class="ttc" id="structlocal__optimization_html"><div class="ttname"><a href="../../dc/d83/structlocal__optimization.html">local_optimization</a></div><div class="ttdoc">Structure representing relevant data during a local channel optimization. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05933">app_queue.c:5933</a></div></div>
<div class="ttc" id="app__queue_8c_html_abe2e63f4e5ce699214b75e7299ce924b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abe2e63f4e5ce699214b75e7299ce924b">agent_router</a></div><div class="ttdeci">static struct stasis_message_router * agent_router</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11247">app_queue.c:11247</a></div></div>
<div class="ttc" id="stringfields_8h_html_a51b5729220efb7cda4393ed35ecdfea2"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a></div><div class="ttdeci">#define AST_STRING_FIELD(name)</div><div class="ttdoc">Declare a string field. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00299">stringfields.h:299</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa9439de0855115f7361b2ca30ce71af1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa9439de0855115f7361b2ca30ce71af1">find_member_by_queuename_and_interface</a></div><div class="ttdeci">static struct member * find_member_by_queuename_and_interface(const char *queuename, const char *interface)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11484">app_queue.c:11484</a></div></div>
<div class="ttc" id="channel_8h_html_a27c4f1a52c8a53bc9e7122dc04e81344"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a27c4f1a52c8a53bc9e7122dc04e81344">ast_party_number_init</a></div><div class="ttdeci">void ast_party_number_init(struct ast_party_number *init)</div><div class="ttdoc">Initialize the given number structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01644">channel.c:1644</a></div></div>
<div class="ttc" id="structast__bridge__config_html"><div class="ttname"><a href="../../d0/d13/structast__bridge__config.html">ast_bridge_config</a></div><div class="ttdoc">bridge configuration </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01077">channel.h:1077</a></div></div>
<div class="ttc" id="structast__bridge__config_html_a30cb875f49910a9515ee92d8dfdf8b83"><div class="ttname"><a href="../../d0/d13/structast__bridge__config.html#a30cb875f49910a9515ee92d8dfdf8b83">ast_bridge_config::end_bridge_callback_data</a></div><div class="ttdeci">void * end_bridge_callback_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01092">channel.h:1092</a></div></div>
<div class="ttc" id="structast__party__caller_html"><div class="ttname"><a href="../../d4/d77/structast__party__caller.html">ast_party_caller</a></div><div class="ttdoc">Caller Party information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00419">channel.h:419</a></div></div>
<div class="ttc" id="structextension_html"><div class="ttname"><a href="../../d0/d5a/structextension.html">extension</a></div><div class="ttdoc">structure to hold extensions </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00287">res_phoneprov.c:287</a></div></div>
<div class="ttc" id="structmember_html"><div class="ttname"><a href="../../d7/dd6/structmember.html">member</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01592">app_queue.c:1592</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="structlocal__optimization_html_a74cdb8c7c6a2e5f456212d23cd3b3a66"><div class="ttname"><a href="../../dc/d83/structlocal__optimization.html#a74cdb8c7c6a2e5f456212d23cd3b3a66">local_optimization::in_progress</a></div><div class="ttdeci">int in_progress</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05937">app_queue.c:5937</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="structcall__queue_html_ae71026599525356a453ca8f5b2fd9bb0"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ae71026599525356a453ca8f5b2fd9bb0">call_queue::autopausebusy</a></div><div class="ttdeci">unsigned int autopausebusy</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01715">app_queue.c:1715</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6b4d4d929013de7812fbba4e58353078"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a></div><div class="ttdeci">void ast_config_destroy(struct ast_config *config)</div><div class="ttdoc">Destroys a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01290">extconf.c:1290</a></div></div>
<div class="ttc" id="structast__bridge__config_html_ad4660f46b880089e643fd8798808bd5f"><div class="ttname"><a href="../../d0/d13/structast__bridge__config.html#ad4660f46b880089e643fd8798808bd5f">ast_bridge_config::end_bridge_callback_data_fixup</a></div><div class="ttdeci">void(* end_bridge_callback_data_fixup)(struct ast_bridge_config *bconfig, struct ast_channel *originator, struct ast_channel *terminator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01096">channel.h:1096</a></div></div>
<div class="ttc" id="app__queue_8c_html_ac00e45bc47eeabbfb3437ca2de3eea8a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac00e45bc47eeabbfb3437ca2de3eea8a">queue_member_ringinuse_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_member_ringinuse_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02060">app_queue.c:2060</a></div></div>
<div class="ttc" id="structmansession_html"><div class="ttname"><a href="../../d2/d8a/structmansession.html">mansession</a></div><div class="ttdoc">In case you didn&amp;#39;t read that giant block of text above the mansession_session struct, the struct mansession is named this solely to keep the API the same in Asterisk. This structure really represents data that is different from Manager action to Manager action. The mansession_session pointer contained within points to session-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01625">manager.c:1625</a></div></div>
<div class="ttc" id="app__queue_8c_html_a321f7a8a2dcb3064e3f719a0fd98c6b5"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a321f7a8a2dcb3064e3f719a0fd98c6b5">reload_handler</a></div><div class="ttdeci">static int reload_handler(int reload, struct ast_flags *mask, const char *queuename)</div><div class="ttdoc">The command center for all reload operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09627">app_queue.c:9627</a></div></div>
<div class="ttc" id="utils_8h_html_a7b4f10b070e95ba413e258a3e4b03c20"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a></div><div class="ttdeci">long int ast_random(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02064">main/utils.c:2064</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="app__queue_8c_html_a17ad3ee98f5c431f437da1940c21c9e7"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7">member_properties</a></div><div class="ttdeci">member_properties</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01630">app_queue.c:1630</a></div></div>
<div class="ttc" id="structautopause_html"><div class="ttname"><a href="../../df/dd2/structautopause.html">autopause</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01420">app_queue.c:1420</a></div></div>
<div class="ttc" id="structcall__queue_html_ae434b23b0508e678bde4b0ffc48dcab9"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ae434b23b0508e678bde4b0ffc48dcab9">call_queue::sound_next</a></div><div class="ttdeci">const ast_string_field sound_next</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6aec193cf33d944aed4807b36eefdbc1d1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6aec193cf33d944aed4807b36eefdbc1d1">QUEUE_EMPTY_WRAPUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01627">app_queue.c:1627</a></div></div>
<div class="ttc" id="structqueue__ent_html_a12851de4518c71edbf5c5adb40976629"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a12851de4518c71edbf5c5adb40976629">queue_ent::valid_digits</a></div><div class="ttdeci">int valid_digits</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01567">app_queue.c:1567</a></div></div>
<div class="ttc" id="structcallattempt_html_adf5e7e1635f0aef4ff3c2119a46dbca4"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#adf5e7e1635f0aef4ff3c2119a46dbca4">callattempt::member</a></div><div class="ttdeci">struct member * member</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01543">app_queue.c:1543</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab389b8ba466d7d05808b044592b05710"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab389b8ba466d7d05808b044592b05710">find_best</a></div><div class="ttdeci">static struct callattempt * find_best(struct callattempt *outgoing)</div><div class="ttdoc">find the entry with the best metric, or NULL </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04614">app_queue.c:4614</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67a5ecd46d3615498a0c1f620952b919855"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a5ecd46d3615498a0c1f620952b919855">QUEUE_STRATEGY_LEASTRECENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01383">app_queue.c:1383</a></div></div>
<div class="ttc" id="linkedlists_8h_html"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html">linkedlists.h</a></div><div class="ttdoc">A set of macros to manage forward-linked lists. </div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_ab034fec40c223af54d0f50bf342c180f"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#ab034fec40c223af54d0f50bf342c180f">queue_stasis_data::holdstart</a></div><div class="ttdeci">time_t holdstart</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05971">app_queue.c:5971</a></div></div>
<div class="ttc" id="structcall__queue_html_acc89aafdc65ecd15f010b7c6fc295522"><div class="ttname"><a href="../../df/db5/structcall__queue.html#acc89aafdc65ecd15f010b7c6fc295522">call_queue::strategy</a></div><div class="ttdeci">int strategy</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01711">app_queue.c:1711</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga03332d35946786d0689462e58d01467a"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga03332d35946786d0689462e58d01467a">ast_channel_agent_login_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_agent_login_type(void)</div><div class="ttdoc">Message type for agent login on a channel. </div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625fa4063bf4e94e14df04126be6f08cc7bfc"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa4063bf4e94e14df04126be6f08cc7bfc">AST_EXTENSION_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00068">pbx.h:68</a></div></div>
<div class="ttc" id="structast__blind__transfer__message_html_a820b583b07f0cf97618ca22d73cd8f09"><div class="ttname"><a href="../../d1/dbf/structast__blind__transfer__message.html#a820b583b07f0cf97618ca22d73cd8f09">ast_blind_transfer_message::bridge</a></div><div class="ttdeci">struct ast_bridge_snapshot * bridge</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00257">stasis_bridges.h:257</a></div></div>
<div class="ttc" id="app__queue_8c_html_a49cb6663a6fd8f3f40808206df196722"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a49cb6663a6fd8f3f40808206df196722">queue_set_global_params</a></div><div class="ttdeci">static void queue_set_global_params(struct ast_config *cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09212">app_queue.c:9212</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="structstasis__message__type_html"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00038">stasis_message.c:38</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="structmember_html_ad666640d5cfd34a434cfa5347f50def4"><div class="ttname"><a href="../../d7/dd6/structmember.html#ad666640d5cfd34a434cfa5347f50def4">member::lastqueue</a></div><div class="ttdeci">struct call_queue * lastqueue</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01612">app_queue.c:1612</a></div></div>
<div class="ttc" id="reqresp__parser_8h_html_a7e4aa55331b8292eff94249de72b807d"><div class="ttname"><a href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a></div><div class="ttdeci">AST_LIST_HEAD_NOLOCK(contactliststruct, contact)</div></div>
<div class="ttc" id="structlocal__optimization_html_ab7ce6f462afaf105224b0ca772a33c43"><div class="ttname"><a href="../../dc/d83/structlocal__optimization.html#ab7ce6f462afaf105224b0ca772a33c43">local_optimization::id</a></div><div class="ttdeci">unsigned int id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05939">app_queue.c:5939</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga55d6d1e96f8f003200274d8756a9398a"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga55d6d1e96f8f003200274d8756a9398a">ast_channel_agent_logoff_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_agent_logoff_type(void)</div><div class="ttdoc">Message type for agent logoff on a channel. </div></div>
<div class="ttc" id="app__queue_8c_html_ad09fa931f468002152a3cc2d5ce25eae"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a></div><div class="ttdeci">static int unload_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11250">app_queue.c:11250</a></div></div>
<div class="ttc" id="structoutgoing_html"><div class="ttname"><a href="../../de/dcd/structoutgoing.html">outgoing</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd4/pbx__spool_8c_source.html#l00077">pbx_spool.c:77</a></div></div>
<div class="ttc" id="pbx_8h_html_a64a5b8fdc919806135ad427aca9e71b7"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a></div><div class="ttdeci">int ast_exists_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Determine whether an extension exists. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04179">pbx.c:4179</a></div></div>
<div class="ttc" id="structast__party__connected__line_html_aeeb8c05290fd113bd0d1a3129898fd49"><div class="ttname"><a href="../../dc/d9e/structast__party__connected__line.html#aeeb8c05290fd113bd0d1a3129898fd49">ast_party_connected_line::ani</a></div><div class="ttdeci">struct ast_party_id ani</div><div class="ttdoc">Automatic Number Identification (ANI) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00466">channel.h:466</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_aaf3af8d672383b48d194deb468074cbe"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#aaf3af8d672383b48d194deb468074cbe">ast_app_exec_macro</a></div><div class="ttdeci">int ast_app_exec_macro(struct ast_channel *autoservice_chan, struct ast_channel *macro_chan, const char *macro_args)</div><div class="ttdoc">Run a macro on a channel, placing an optional second channel into autoservice. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l00273">main/app.c:273</a></div></div>
<div class="ttc" id="structast__bridge__blob_html"><div class="ttname"><a href="../../d7/d01/structast__bridge__blob.html">ast_bridge_blob</a></div><div class="ttdoc">Blob of data associated with a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00123">stasis_bridges.h:123</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa707168bdf0595df609e91bd8ec2dd71"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa707168bdf0595df609e91bd8ec2dd71">destroy_queue_member_cb</a></div><div class="ttdeci">static void destroy_queue_member_cb(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02676">app_queue.c:2676</a></div></div>
<div class="ttc" id="app__queue_8c_html_a183dcea5fd32422d981d4705cd770b15"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a183dcea5fd32422d981d4705cd770b15">ANNOUNCEPOSITION_MORE_THAN</a></div><div class="ttdeci">#define ANNOUNCEPOSITION_MORE_THAN</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01653">app_queue.c:1653</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa559870517303cbc5a5e4964eec56033"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa559870517303cbc5a5e4964eec56033">rna</a></div><div class="ttdeci">static void rna(int rnatime, struct queue_ent *qe, struct ast_channel *peer, char *interface, char *membername, int autopause)</div><div class="ttdoc">RNA == Ring No Answer. Common code that is executed when we try a queue member and they don&amp;#39;t answer...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04839">app_queue.c:4839</a></div></div>
<div class="ttc" id="manager_8h_html_a777cde87d12b331902f862ec44641688"><div class="ttname"><a href="../../db/d45/manager_8h.html#a777cde87d12b331902f862ec44641688">ast_manager_build_channel_state_string</a></div><div class="ttdeci">struct ast_str * ast_manager_build_channel_state_string(const struct ast_channel_snapshot *snapshot)</div><div class="ttdoc">Generate the AMI message body from a channel snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1c/manager__channels_8c_source.html#l00561">manager_channels.c:561</a></div></div>
<div class="ttc" id="structqueue__ent_html_a51db7b9d0e86f2188b541b3d68459930"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a51db7b9d0e86f2188b541b3d68459930">queue_ent::linpos</a></div><div class="ttdeci">int linpos</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01581">app_queue.c:1581</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a5122bc54131774ec22cfa03d95539d00"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a5122bc54131774ec22cfa03d95539d00">queue_stasis_data::member_uniqueid</a></div><div class="ttdeci">const ast_string_field member_uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05965">app_queue.c:5965</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2aed848300d343eb61491e3ddc2e562b9e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2aed848300d343eb61491e3ddc2e562b9e">QUEUE_JOINEMPTY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01498">app_queue.c:1498</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_af40039f1c49c16d0f6fa33fe9c43a0cb"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb">ast_app_parse_options</a></div><div class="ttdeci">int ast_app_parse_options(const struct ast_app_option *options, struct ast_flags *flags, char **args, char *optstr)</div><div class="ttdoc">Parses a string containing application options and sets flags/arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l02906">main/app.c:2906</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a3aac6b809a257df6ea7c3d2a9d22b9f5"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a3aac6b809a257df6ea7c3d2a9d22b9f5">ast_config_new</a></div><div class="ttdeci">struct ast_config * ast_config_new(void)</div><div class="ttdoc">Create a new base configuration structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l03276">extconf.c:3276</a></div></div>
<div class="ttc" id="channel_8h_html_ad75b575faec0b9bac758d6a373ee762f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ad75b575faec0b9bac758d6a373ee762f">ast_pre_call</a></div><div class="ttdeci">int ast_pre_call(struct ast_channel *chan, const char *sub_args)</div><div class="ttdoc">Execute a Gosub call on the channel before a call is placed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06536">channel.c:6536</a></div></div>
<div class="ttc" id="channel_8h_html_a6f3f42365ac84d888b55e35e1309f067"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6f3f42365ac84d888b55e35e1309f067">ast_channel_req_accountcodes</a></div><div class="ttdeci">void ast_channel_req_accountcodes(struct ast_channel *chan, const struct ast_channel *requestor, enum ast_channel_requestor_relationship relationship)</div><div class="ttdoc">Setup new channel accountcodes from the requestor channel after ast_request(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06526">channel.c:6526</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a9f03cca4e2ee93778ae8ed2db279587d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9f03cca4e2ee93778ae8ed2db279587d">OPT_CALLER_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01331">app_queue.c:1331</a></div></div>
<div class="ttc" id="channel_8h_html_aed40a28831fcb5791cd63c1b8761d659"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aed40a28831fcb5791cd63c1b8761d659">ast_channel_adsicpe_set</a></div><div class="ttdeci">void ast_channel_adsicpe_set(struct ast_channel *chan, enum ast_channel_adsicpe value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00785">channel_internal_api.c:785</a></div></div>
<div class="ttc" id="channel_8h_html_aa8b52fbc8168e939bc5553502367d46a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa8b52fbc8168e939bc5553502367d46a">ast_channel_exten</a></div><div class="ttdeci">const char * ast_channel_exten(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00353">channel_internal_api.c:353</a></div></div>
<div class="ttc" id="app__queue_8c_html_a64fbaaf618f14ff586946ad7efb80987"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a64fbaaf618f14ff586946ad7efb80987">escape_and_substitute</a></div><div class="ttdeci">static void escape_and_substitute(struct ast_channel *chan, const char *input, char *output, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06617">app_queue.c:6617</a></div></div>
<div class="ttc" id="pbx_8h_html"><div class="ttname"><a href="../../db/de0/pbx_8h.html">pbx.h</a></div><div class="ttdoc">Core PBX routines and definitions. </div></div>
<div class="ttc" id="structast__aoc__encoded_html"><div class="ttname"><a href="../../d8/d72/structast__aoc__encoded.html">ast_aoc_encoded</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00197">aoc.c:197</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00054">devicestate.h:54</a></div></div>
<div class="ttc" id="channel_8h_html_abc7ac58271a860c92fee033afb031e8d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abc7ac58271a860c92fee033afb031e8d">ast_party_number_free</a></div><div class="ttdeci">void ast_party_number_free(struct ast_party_number *doomed)</div><div class="ttdoc">Destroy the party number contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01691">channel.c:1691</a></div></div>
<div class="ttc" id="channel_8h_html_a08bde7d8cf72457fc8c519a4443b413b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a08bde7d8cf72457fc8c519a4443b413b">ast_autoservice_stop</a></div><div class="ttdeci">int ast_autoservice_stop(struct ast_channel *chan)</div><div class="ttdoc">Stop servicing a channel for us... </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d66/autoservice_8c_source.html#l00266">autoservice.c:266</a></div></div>
<div class="ttc" id="app__queue_8c_html_af59feeff9c61049bf1d1a7839164564dac1bee29cc4915cda4b613b8b95330663"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af59feeff9c61049bf1d1a7839164564dac1bee29cc4915cda4b613b8b95330663">TRANSFER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05860">app_queue.c:5860</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a1a1761c57f73009d305f95d8ad99e2a7"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a1a1761c57f73009d305f95d8ad99e2a7">stasis_message_router_create</a></div><div class="ttdeci">#define stasis_message_router_create(topic)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d25/stasis__message__router_8h_source.html#l00060">stasis_message_router.h:60</a></div></div>
<div class="ttc" id="channel_8h_html_a9c63fff1d736568d1ee332dd7ea502bd"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9c63fff1d736568d1ee332dd7ea502bd">ast_check_hangup</a></div><div class="ttdeci">int ast_check_hangup(struct ast_channel *chan)</div><div class="ttdoc">Check to see if a channel is needing hang up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00445">channel.c:445</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae878f92553205372e178f586fb3b4505"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae878f92553205372e178f586fb3b4505">queue_member_decrement_followers</a></div><div class="ttdeci">static int queue_member_decrement_followers(void *obj, void *arg, int flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01869">app_queue.c:1869</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00105">include/asterisk/frame.h:105</a></div></div>
<div class="ttc" id="structast__bridge__config_html_aa9510db9c5a776dfbd1aaab8c48970f0"><div class="ttname"><a href="../../d0/d13/structast__bridge__config.html#aa9510db9c5a776dfbd1aaab8c48970f0">ast_bridge_config::features_caller</a></div><div class="ttdeci">struct ast_flags features_caller</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01078">channel.h:1078</a></div></div>
<div class="ttc" id="structqueue__ent_html_ab93fe34ee0297a3c67d39d3b6fbf6542"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ab93fe34ee0297a3c67d39d3b6fbf6542">queue_ent::moh</a></div><div class="ttdeci">char moh[MAX_MUSICCLASS]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01562">app_queue.c:1562</a></div></div>
<div class="ttc" id="app__queue_8c_html_a531c35e38ede3ea4e5ba5afb24b29493a1d0a4362e89e71be70b2ca0d47616c99"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a1d0a4362e89e71be70b2ca0d47616c99">OPT_ARG_CALLEE_GO_ON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01350">app_queue.c:1350</a></div></div>
<div class="ttc" id="structpenalty__rule_html_a42715f65f02da52edc5b22021d8ae670"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#a42715f65f02da52edc5b22021d8ae670">penalty_rule::time</a></div><div class="ttdeci">int time</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01641">app_queue.c:1641</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a846844eb2c4eb44554445936b3770711"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEUNCHANGED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">include/asterisk/config.h:59</a></div></div>
<div class="ttc" id="stasis_8h_html_ae3fe7fe099389094244002113814ec23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a></div><div class="ttdeci">#define stasis_subscribe(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00652">stasis.h:652</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a10f9ed9242a397abf76de1ed1fa33c3b"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a10f9ed9242a397abf76de1ed1fa33c3b">AST_LIST_HEAD_STATIC</a></div><div class="ttdeci">#define AST_LIST_HEAD_STATIC(name, type)</div><div class="ttdoc">Defines a structure to be used to hold a list of specified type, statically initialized. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00290">linkedlists.h:290</a></div></div>
<div class="ttc" id="term_8h_html_ad86358bf19927183dd7b4ae215a29731"><div class="ttname"><a href="../../db/d45/term_8h.html#ad86358bf19927183dd7b4ae215a29731">COLOR_RED</a></div><div class="ttdeci">#define COLOR_RED</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/term_8h_source.html#l00049">term.h:49</a></div></div>
<div class="ttc" id="features_8h_html_a8b286e6d3fdb7ca3a907c5b327e1b4a9"><div class="ttname"><a href="../../de/d47/features_8h.html#a8b286e6d3fdb7ca3a907c5b327e1b4a9">ast_bridge_call_with_flags</a></div><div class="ttdeci">int ast_bridge_call_with_flags(struct ast_channel *chan, struct ast_channel *peer, struct ast_bridge_config *config, unsigned int flags)</div><div class="ttdoc">Bridge a call, and add additional flags to the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d92/features_8c_source.html#l00633">features.c:633</a></div></div>
<div class="ttc" id="app__queue_8c_html_af041692db9a20d1ffa7ea69e4864deb3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af041692db9a20d1ffa7ea69e4864deb3">log_attended_transfer</a></div><div class="ttdeci">static void log_attended_transfer(struct queue_stasis_data *queue_data, struct ast_attended_transfer_message *atxfer_msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06065">app_queue.c:6065</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html_ae7248b764758e655df26036dd6b8f4d7"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html#ae7248b764758e655df26036dd6b8f4d7">ast_channel_snapshot::caller</a></div><div class="ttdeci">struct ast_channel_snapshot_caller * caller</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00148">stasis_channels.h:148</a></div></div>
<div class="ttc" id="structast__attended__transfer__message_html_a4623d089424156732a5f5591381d8b31"><div class="ttname"><a href="../../df/d6d/structast__attended__transfer__message.html#a4623d089424156732a5f5591381d8b31">ast_attended_transfer_message::dest_type</a></div><div class="ttdeci">enum ast_attended_transfer_dest_type dest_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00335">stasis_bridges.h:335</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab9873b95b03723c7f06d85b044b9e96c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab9873b95b03723c7f06d85b044b9e96c">num_available_members</a></div><div class="ttdeci">static int num_available_members(struct call_queue *q)</div><div class="ttdoc">Get the number of members available to accept a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04290">app_queue.c:4290</a></div></div>
<div class="ttc" id="app__queue_8c_html_a42473ab02a99b1df4c0e915291181d0e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a42473ab02a99b1df4c0e915291181d0e">handle_attended_transfer</a></div><div class="ttdeci">static void handle_attended_transfer(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Handle an attended transfer event. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06206">app_queue.c:6206</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa69c5e8b97eda56a099f72a195f28bea"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa69c5e8b97eda56a099f72a195f28bea">handle_queue_rule_show</a></div><div class="ttdeci">static char * handle_queue_rule_show(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11016">app_queue.c:11016</a></div></div>
<div class="ttc" id="channel_8h_html_afdeaf9abb1aecc715313a4f62c1cf9c9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afdeaf9abb1aecc715313a4f62c1cf9c9">ast_channel_topic</a></div><div class="ttdeci">struct stasis_topic * ast_channel_topic(struct ast_channel *chan)</div><div class="ttdoc">A topic which publishes the events for a particular channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01502">channel_internal_api.c:1502</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeeab43afabf5bcd4ad1f531ad78c48ccb6f"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeab43afabf5bcd4ad1f531ad78c48ccb6f">AST_DEVICE_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00056">devicestate.h:56</a></div></div>
<div class="ttc" id="app__queue_8c_html_a255e617ba389793f7425d398afe9d557"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a255e617ba389793f7425d398afe9d557">montype_default</a></div><div class="ttdeci">static int montype_default</div><div class="ttdoc">queues.conf [general] option </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01475">app_queue.c:1475</a></div></div>
<div class="ttc" id="bridge__roles_8h_html_a6b856fa6db0d3de843aa5a1d89db1154"><div class="ttname"><a href="../../dd/dff/bridge__roles_8h.html#a6b856fa6db0d3de843aa5a1d89db1154">ast_channel_has_role</a></div><div class="ttdeci">int ast_channel_has_role(struct ast_channel *channel, const char *role_name)</div><div class="ttdoc">Check if a role exists on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d13/bridge__roles_8c_source.html#l00398">bridge_roles.c:398</a></div></div>
<div class="ttc" id="core__local_8h_html_a6f6f7583dcbd0b63d59bdfe79f654945"><div class="ttname"><a href="../../d5/da6/core__local_8h.html#a6f6f7583dcbd0b63d59bdfe79f654945">ast_local_optimization_end_type</a></div><div class="ttdeci">struct stasis_message_type * ast_local_optimization_end_type(void)</div><div class="ttdoc">Message type for when a local channel optimization completes. </div></div>
<div class="ttc" id="app__queue_8c_html_a3135d5c6b468bef49c1e3fc5d7394f30"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3135d5c6b468bef49c1e3fc5d7394f30">leave_queue</a></div><div class="ttdeci">static void leave_queue(struct queue_ent *qe)</div><div class="ttdoc">Caller leaving queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04151">app_queue.c:4151</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gafadf012f66a9fd7ecf985ec5b9dee101"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a></div><div class="ttdeci">int ast_manager_unregister(const char *action)</div><div class="ttdoc">Unregister a registered manager command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07258">manager.c:7258</a></div></div>
<div class="ttc" id="app__queue_8c_html_ac53cea8ee06b85c53f586133109f6ad7"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac53cea8ee06b85c53f586133109f6ad7">ring_entry</a></div><div class="ttdeci">static int ring_entry(struct queue_ent *qe, struct callattempt *tmp, int *busies)</div><div class="ttdoc">Part 2 of ring_one. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04478">app_queue.c:4478</a></div></div>
<div class="ttc" id="manager_8h_html"><div class="ttname"><a href="../../db/d45/manager_8h.html">manager.h</a></div><div class="ttdoc">The AMI - Asterisk Manager Interface - is a TCP protocol created to manage Asterisk with third-party ...</div></div>
<div class="ttc" id="structcallattempt_html"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html">callattempt</a></div><div class="ttdoc">We define a custom &quot;local user&quot; structure because we use it not only for keeping track of what is in ...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01537">app_queue.c:1537</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6659861a3baff7381bdfe00d7b36c19a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6659861a3baff7381bdfe00d7b36c19a">member_cmp_fn</a></div><div class="ttdeci">static int member_cmp_fn(void *obj1, void *obj2, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02756">app_queue.c:2756</a></div></div>
<div class="ttc" id="app__queue_8c_html_a19ddc6dbd24b622cdf07e0e0e3e4ce01"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a19ddc6dbd24b622cdf07e0e0e3e4ce01">complete_queue_rule_show</a></div><div class="ttdeci">static char * complete_queue_rule_show(const char *line, const char *word, int pos, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10994">app_queue.c:10994</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae3a7c6d80cb3aad8b62a77b6b9a3946a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae3a7c6d80cb3aad8b62a77b6b9a3946a">destroy_queue</a></div><div class="ttdeci">static void destroy_queue(void *obj)</div><div class="ttdoc">Free queue&amp;#39;s member list then its string fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03519">app_queue.c:3519</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab1e47d681926f94694873b3ce842dfbe"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab1e47d681926f94694873b3ce842dfbe">pending_members_hash</a></div><div class="ttdeci">static int pending_members_hash(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02378">app_queue.c:2378</a></div></div>
<div class="ttc" id="term_8h_html_aba2a7fe77a7501e5844370eec0185207"><div class="ttname"><a href="../../db/d45/term_8h.html#aba2a7fe77a7501e5844370eec0185207">COLOR_BLACK</a></div><div class="ttdeci">#define COLOR_BLACK</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/term_8h_source.html#l00047">term.h:47</a></div></div>
<div class="ttc" id="channel_8h_html_a93d3e245d714d1ab18c5fb2ecb5cbf0e"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a93d3e245d714d1ab18c5fb2ecb5cbf0e">ast_connected_line_parse_data</a></div><div class="ttdeci">int ast_connected_line_parse_data(const unsigned char *data, size_t datalen, struct ast_party_connected_line *connected)</div><div class="ttdoc">Parse connected line indication frame data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08881">channel.c:8881</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a29ff8cd717c0c0bac60abbd827fec409"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a29ff8cd717c0c0bac60abbd827fec409">ast_load_realtime_multientry</a></div><div class="ttdeci">struct ast_config * ast_load_realtime_multientry(const char *family,...) attribute_sentinel</div><div class="ttdoc">Retrieve realtime configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03452">main/config.c:3452</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9a488aa902d38d97f26bbfbb59a22e2b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9a488aa902d38d97f26bbfbb59a22e2b">queue_cmp_cb</a></div><div class="ttdeci">static int queue_cmp_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01843">app_queue.c:1843</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a6faa363811a3b467116d290d52d967da"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6faa363811a3b467116d290d52d967da">OPT_CALLEE_TRANSFER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01339">app_queue.c:1339</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2cb5962d53c4dc9410e0843aab7350b9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2cb5962d53c4dc9410e0843aab7350b9">queue_member_blob_create</a></div><div class="ttdeci">static struct ast_json * queue_member_blob_create(struct call_queue *q, struct member *mem)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02258">app_queue.c:2258</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a6ab17f35d26d691c590098350b231988"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6ab17f35d26d691c590098350b231988">OPT_IGNORE_CONNECTEDLINE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01333">app_queue.c:1333</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab20962f473e6a8976a3e4e23b90049cc"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab20962f473e6a8976a3e4e23b90049cc">autofill_default</a></div><div class="ttdeci">static int autofill_default</div><div class="ttdoc">queues.conf [general] option </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01472">app_queue.c:1472</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_ab6978928374a06cc70f0e06fbf858cb6"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#ab6978928374a06cc70f0e06fbf858cb6">queue_stasis_data::bridge_uniqueid</a></div><div class="ttdeci">const ast_string_field bridge_uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05965">app_queue.c:5965</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad376f945649cc4fa527d23ad59c73d37"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad376f945649cc4fa527d23ad59c73d37">handle_local_optimization_end</a></div><div class="ttdeci">static void handle_local_optimization_end(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06333">app_queue.c:6333</a></div></div>
<div class="ttc" id="structpenalty__rule_html_a24e45c57e28e783d25bdd8b8cadcc204"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#a24e45c57e28e783d25bdd8b8cadcc204">penalty_rule::raise_relative</a></div><div class="ttdeci">int raise_relative</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01647">app_queue.c:1647</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a997ae2300c5dc2cba5116571f29c9e56"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a997ae2300c5dc2cba5116571f29c9e56">queue_stasis_data::channel_router</a></div><div class="ttdeci">struct stasis_message_router * channel_router</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05983">app_queue.c:5983</a></div></div>
<div class="ttc" id="app__queue_8c_html_a0ef9ed36fcbd04f12b6fd2de7e2530fd"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a0ef9ed36fcbd04f12b6fd2de7e2530fd">get_wrapuptime</a></div><div class="ttdeci">static int get_wrapuptime(struct call_queue *q, struct member *member)</div><div class="ttdoc">Return wrapuptime. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01856">app_queue.c:1856</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67ac67e9c3a0f5aad82fcad50334c99832f">QUEUE_STRATEGY_RRORDERED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01389">app_queue.c:1389</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="app__queue_8c_html_afc981f304f48009b383c870db6aac776"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#afc981f304f48009b383c870db6aac776">manager_queue_log_custom</a></div><div class="ttdeci">static int manager_queue_log_custom(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10358">app_queue.c:10358</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a6cda8c882997c543030f3dde846f9df3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a6cda8c882997c543030f3dde846f9df3">OPT_CALLEE_AUTOMON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01343">app_queue.c:1343</a></div></div>
<div class="ttc" id="strings_8h_html_a387a69b3871ca31061566a73f45d20f4"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a></div><div class="ttdeci">int attribute_pure ast_true(const char *val)</div><div class="ttdoc">Make sure something is true. Determine if a string containing a boolean value is &quot;true&quot;. This function checks to see whether a string passed to it is an indication of an &quot;true&quot; value. It checks to see if the string is &quot;yes&quot;, &quot;true&quot;, &quot;y&quot;, &quot;t&quot;, &quot;on&quot; or &quot;1&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01951">main/utils.c:1951</a></div></div>
<div class="ttc" id="channel_8h_html_a84a85d871e634a86b2421ac9354b50c6"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a84a85d871e634a86b2421ac9354b50c6">ast_party_caller_set_init</a></div><div class="ttdeci">void ast_party_caller_set_init(struct ast_party_caller *init, const struct ast_party_caller *guide)</div><div class="ttdoc">Initialize the given caller structure using the given guide for a set update operation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01999">channel.c:1999</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6eb92f6a70762912ce80b53e9282204a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6eb92f6a70762912ce80b53e9282204a">manager_queue_reload</a></div><div class="ttdeci">static int manager_queue_reload(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10379">app_queue.c:10379</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="structcallattempt_html_a5ba4c870b5cfffa9ed46b7d1096c1b41"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a5ba4c870b5cfffa9ed46b7d1096c1b41">callattempt::orig_chan_name</a></div><div class="ttdeci">char * orig_chan_name</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01556">app_queue.c:1556</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa4bb418a30af8cf4e1be6aa3fea01016"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa4bb418a30af8cf4e1be6aa3fea01016">join_queue</a></div><div class="ttdeci">static int join_queue(char *queuename, struct queue_ent *qe, enum queue_result *reason, int position)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03832">app_queue.c:3832</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">include/asterisk/frame.h:278</a></div></div>
<div class="ttc" id="app__queue_8c_html_a232b6e5850a21fb799fdec8a3072bd45"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a232b6e5850a21fb799fdec8a3072bd45">QUEUE_UNPAUSED_DEVSTATE</a></div><div class="ttdeci">#define QUEUE_UNPAUSED_DEVSTATE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03351">app_queue.c:3351</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae19c02c3c0ba9ca01d7ede746f736c45"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae19c02c3c0ba9ca01d7ede746f736c45">ANNOUNCEPOSITION_YES</a></div><div class="ttdeci">#define ANNOUNCEPOSITION_YES</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01651">app_queue.c:1651</a></div></div>
<div class="ttc" id="structcall__queue_html_a1d67f434933f43ad9deb32da61dda2b6"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a1d67f434933f43ad9deb32da61dda2b6">call_queue::dead</a></div><div class="ttdeci">unsigned int dead</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01699">app_queue.c:1699</a></div></div>
<div class="ttc" id="structcall__queue_html_aef5bac7c1f7fa063b8707596001536dd"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aef5bac7c1f7fa063b8707596001536dd">call_queue::autopausedelay</a></div><div class="ttdeci">int autopausedelay</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01744">app_queue.c:1744</a></div></div>
<div class="ttc" id="channel_8h_html_a25f1c885c7f5230ea4c9bc48dde88fe1a33e339fbf78c26377f6c7057dda06ccc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1a33e339fbf78c26377f6c7057dda06ccc">AST_FEATURE_REDIRECT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01065">channel.h:1065</a></div></div>
<div class="ttc" id="app__queue_8c_html_af01909aa0583ac7df7e17b9c1f46c3c4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af01909aa0583ac7df7e17b9c1f46c3c4">word_in_list</a></div><div class="ttdeci">static int word_in_list(const char *list, const char *word)</div><div class="ttdoc">Check if a given word is in a space-delimited list. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09870">app_queue.c:9870</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a78690a8e97e0eac7d0982b81d5cadac8"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a78690a8e97e0eac7d0982b81d5cadac8">OPT_CALLEE_GO_ON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01329">app_queue.c:1329</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a7549377df87038be737e8cae73acaa9d"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a7549377df87038be737e8cae73acaa9d">AST_APP_OPTION_ARG</a></div><div class="ttdeci">#define AST_APP_OPTION_ARG(option, flagno, argno)</div><div class="ttdoc">Declares an application option that accepts an argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01413">include/asterisk/app.h:1413</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00055">devicestate.h:55</a></div></div>
<div class="ttc" id="app__queue_8c_html_addeed7ca2ef4ef9fa3d373cb63a4a87c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#addeed7ca2ef4ef9fa3d373cb63a4a87c">queue_channel_cb</a></div><div class="ttdeci">static void queue_channel_cb(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06489">app_queue.c:6489</a></div></div>
<div class="ttc" id="module_8h_html_aa4f734041ffd9d75b07cefb0291e1e58ac8f668d27e0baf549e54a5e71da40c13"><div class="ttname"><a href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58ac8f668d27e0baf549e54a5e71da40c13">AST_MODPRI_DEVSTATE_CONSUMER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00333">module.h:333</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a25e485e2c95898fadb88ad00e152751d"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a25e485e2c95898fadb88ad00e152751d">queue_stasis_data::caller_pos</a></div><div class="ttdeci">int caller_pos</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05975">app_queue.c:5975</a></div></div>
<div class="ttc" id="astdb_8h_html_afeb9839f89da4fc24838de74739d181e"><div class="ttname"><a href="../../de/d4a/astdb_8h.html#afeb9839f89da4fc24838de74739d181e">ast_db_gettree</a></div><div class="ttdeci">struct ast_db_entry * ast_db_gettree(const char *family, const char *keytree)</div><div class="ttdoc">Get a list of values within the astdb tree. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d21/main_2db_8c_source.html#l00531">main/db.c:531</a></div></div>
<div class="ttc" id="astobj2_8h_html_a04bf2beaf5811f6b95768e42fb95d9a5"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a04bf2beaf5811f6b95768e42fb95d9a5">ao2_container_dup</a></div><div class="ttdeci">int ao2_container_dup(struct ao2_container *dest, struct ao2_container *src, enum search_flags flags)</div><div class="ttdoc">Copy all object references in the src container into the dest container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00673">astobj2_container.c:673</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2f87a873c7ff5f3150044300fe83bb61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2f87a873c7ff5f3150044300fe83bb61">ao2_t_iterator_next</a></div><div class="ttdeci">#define ao2_t_iterator_next(iter, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01931">astobj2.h:1931</a></div></div>
<div class="ttc" id="structcall__queue_html_a0a7a994a2db49ad4569bfd6db242247b"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a0a7a994a2db49ad4569bfd6db242247b">call_queue::rrpos</a></div><div class="ttdeci">int rrpos</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01748">app_queue.c:1748</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html">stasis_message_router.h</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad207b1688e9f5af13048c10a3ed4850d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad207b1688e9f5af13048c10a3ed4850d">publish_dial_end_event</a></div><div class="ttdeci">static void publish_dial_end_event(struct ast_channel *in, struct callattempt *outgoing, struct ast_channel *exception, const char *status)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04238">app_queue.c:4238</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad1b4e6774a06546a16f8870ab8618753"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad1b4e6774a06546a16f8870ab8618753">QUEUE_UNKNOWN_PAUSED_DEVSTATE</a></div><div class="ttdeci">#define QUEUE_UNKNOWN_PAUSED_DEVSTATE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03352">app_queue.c:3352</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00299">include/asterisk/frame.h:299</a></div></div>
<div class="ttc" id="time_8h_html_a904a6933b710e14c7fa2029a0f0cc91a"><div class="ttname"><a href="../../de/df7/time_8h.html#a904a6933b710e14c7fa2029a0f0cc91a">ast_remaining_ms</a></div><div class="ttdeci">int ast_remaining_ms(struct timeval start, int max_ms)</div><div class="ttdoc">Calculate remaining milliseconds given a starting timestamp and upper bound. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02033">main/utils.c:2033</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7b5de2aa80f528d3dc554caadb8dc6aba3a8f36e68b2b6873804d167724e1891c"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7b5de2aa80f528d3dc554caadb8dc6aba3a8f36e68b2b6873804d167724e1891c">AO2_ITERATOR_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01883">astobj2.h:1883</a></div></div>
<div class="ttc" id="channel_8h_html_a25f1c885c7f5230ea4c9bc48dde88fe1a0a015b303a0970eda3ea8328714cbbae"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1a0a015b303a0970eda3ea8328714cbbae">AST_FEATURE_AUTOMIXMON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01070">channel.h:1070</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2ae3e4026ef50c6dbe7de7bae5023d15"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2ae3e4026ef50c6dbe7de7bae5023d15">queuememberlist_function</a></div><div class="ttdeci">static struct ast_custom_function queuememberlist_function</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09110">app_queue.c:9110</a></div></div>
<div class="ttc" id="channel_8h_html_a2661f0a9305c7a9ab779f55f4e57c1ad"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2661f0a9305c7a9ab779f55f4e57c1ad">ast_channel_connected_line_sub</a></div><div class="ttdeci">int ast_channel_connected_line_sub(struct ast_channel *autoservice_chan, struct ast_channel *sub_chan, const void *connected_info, int frame)</div><div class="ttdoc">Run a connected line interception subroutine and update a channel&amp;#39;s connected line information...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10539">channel.c:10539</a></div></div>
<div class="ttc" id="structcall__queue_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ace9168767fc3707cf5f0a7d049682ba3">call_queue::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="structmax__forwards_html"><div class="ttname"><a href="../../d3/d68/structmax__forwards.html">max_forwards</a></div><div class="ttdoc">Channel datastore data for max forwards. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ddd/max__forwards_8c_source.html#l00029">max_forwards.c:29</a></div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625fa435abb1e907b1cee83ec44d2d77866e6"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa435abb1e907b1cee83ec44d2d77866e6">AST_EXTENSION_NOT_INUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00064">pbx.h:64</a></div></div>
<div class="ttc" id="channel_8h_html_a65d86fdffdd9c52b17b79b069cd0c6cb"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a65d86fdffdd9c52b17b79b069cd0c6cb">ast_party_connected_line_set</a></div><div class="ttdeci">void ast_party_connected_line_set(struct ast_party_connected_line *dest, const struct ast_party_connected_line *src, const struct ast_set_party_connected_line *update)</div><div class="ttdoc">Set the connected line information based on another connected line source. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02054">channel.c:2054</a></div></div>
<div class="ttc" id="app__queue_8c_html_aef676b88f94e92332fdded27143a56f5"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aef676b88f94e92332fdded27143a56f5">setup_peer_after_bridge_goto</a></div><div class="ttdeci">static void setup_peer_after_bridge_goto(struct ast_channel *chan, struct ast_channel *peer, struct ast_flags *opts, char *opt_args[])</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06600">app_queue.c:6600</a></div></div>
<div class="ttc" id="structcall__queue_html_a20ba21c586c791a31ef97102b4811a8f"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a20ba21c586c791a31ef97102b4811a8f">call_queue::reportholdtime</a></div><div class="ttdeci">unsigned int reportholdtime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01705">app_queue.c:1705</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structqueue__end__bridge_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../d5/d61/structqueue__end__bridge.html#a84d1435c5b8d387806714ea7079304b7">queue_end_bridge::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06565">app_queue.c:6565</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="channel_8h_html_a828f537544a2ad2352c56c078390a0bd"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a828f537544a2ad2352c56c078390a0bd">ast_channel_adsicpe</a></div><div class="ttdeci">ast_channel_adsicpe</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00869">channel.h:869</a></div></div>
<div class="ttc" id="structcall__queue_html_a76e20f3c9df399ad87bb4e45c7419e99"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a76e20f3c9df399ad87bb4e45c7419e99">call_queue::autofill</a></div><div class="ttdeci">int autofill</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01750">app_queue.c:1750</a></div></div>
<div class="ttc" id="app__queue_8c_html_abfd16358cfabbb3ad0c435c17883e398"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398">queue_reload_mask</a></div><div class="ttdeci">queue_reload_mask</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01398">app_queue.c:1398</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6c96c5a03e8b94a8b55feb294012943f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6c96c5a03e8b94a8b55feb294012943f">extensionstate2devicestate</a></div><div class="ttdeci">static int extensionstate2devicestate(int state)</div><div class="ttdoc">Helper function which converts from extension state to device state values. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02590">app_queue.c:2590</a></div></div>
<div class="ttc" id="app__queue_8c_html_a0b3abb2f63fd6e5269cbb96f801b35a7"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a0b3abb2f63fd6e5269cbb96f801b35a7">queue_function_mem_read</a></div><div class="ttdeci">static int queue_function_mem_read(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">Get number either busy / free / ready or total members of a specific queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08641">app_queue.c:8641</a></div></div>
<div class="ttc" id="structast__party__connected__line_html"><div class="ttname"><a href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a></div><div class="ttdoc">Connected Line/Party information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00457">channel.h:457</a></div></div>
<div class="ttc" id="structcallattempt_html_af89ad667b09b003400a9281d04e6d4c2"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#af89ad667b09b003400a9281d04e6d4c2">callattempt::pending_connected_update</a></div><div class="ttdeci">unsigned int pending_connected_update</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01547">app_queue.c:1547</a></div></div>
<div class="ttc" id="pbx_8h_html_a7527f4b7b64622b458a3999ba51af07e"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7527f4b7b64622b458a3999ba51af07e">pbx_builtin_setvar_multiple</a></div><div class="ttdeci">int pbx_builtin_setvar_multiple(struct ast_channel *chan, const char *data)</div><div class="ttdoc">Parse and set multiple channel variables, where the pairs are separated by the &amp;#39;,&amp;#39; character...</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01155">pbx_variables.c:1155</a></div></div>
<div class="ttc" id="channel_8h_html_a63732831df3e7a0999b0900ec85c626a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a></div><div class="ttdeci">struct ast_party_dialed * ast_channel_dialed(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00904">channel_internal_api.c:904</a></div></div>
<div class="ttc" id="musiconhold_8h_html_a2acec01f2fddd8ca494d874003815cf7"><div class="ttname"><a href="../../dc/d07/musiconhold_8h.html#a2acec01f2fddd8ca494d874003815cf7">ast_moh_start</a></div><div class="ttdeci">int ast_moh_start(struct ast_channel *chan, const char *mclass, const char *interpclass)</div><div class="ttdoc">Turn on music on hold on a given channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07866">channel.c:7866</a></div></div>
<div class="ttc" id="structcall__queue_html_a080da53416fe93b51940797285eeee5c"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a080da53416fe93b51940797285eeee5c">call_queue::talktime</a></div><div class="ttdeci">int talktime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01727">app_queue.c:1727</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a20102c5c2e0298274a80b3824873cfe8"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a20102c5c2e0298274a80b3824873cfe8">queue_stasis_data::caller_uniqueid</a></div><div class="ttdeci">const ast_string_field caller_uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05965">app_queue.c:5965</a></div></div>
<div class="ttc" id="structast__blind__transfer__message_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../d1/dbf/structast__blind__transfer__message.html#ac25ea00ee3f082df06e0cf468cbde240">ast_blind_transfer_message::context</a></div><div class="ttdeci">char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00259">stasis_bridges.h:259</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3ad4edc18ee0c5ce6e2af1ed26a64f39ad"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ad4edc18ee0c5ce6e2af1ed26a64f39ad">OPT_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01337">app_queue.c:1337</a></div></div>
<div class="ttc" id="manager_8h_html_acd32bc0b58b87cc22c60ffff79496c7f"><div class="ttname"><a href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a></div><div class="ttdeci">#define EVENT_FLAG_AGENT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00076">manager.h:76</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_ad16306b671d391b6b8f0927c77baf0f5"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#ad16306b671d391b6b8f0927c77baf0f5">queue_stasis_data::caller_optimize</a></div><div class="ttdeci">struct local_optimization caller_optimize</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05985">app_queue.c:5985</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5d60239f838c9f941528fb426bcd2290"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5d60239f838c9f941528fb426bcd2290">set_member_paused</a></div><div class="ttdeci">static int set_member_paused(const char *queuename, const char *interface, const char *reason, int paused)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07528">app_queue.c:7528</a></div></div>
<div class="ttc" id="structcall__queue_html_abfb829c4f5dfe0e57f78f6b1da91ca2d"><div class="ttname"><a href="../../df/db5/structcall__queue.html#abfb829c4f5dfe0e57f78f6b1da91ca2d">call_queue::list</a></div><div class="ttdeci">struct call_queue::@69 list</div></div>
<div class="ttc" id="structqueue__ent_html_a1f8971bc7f04d9152056ed8aa4f36ef6"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a1f8971bc7f04d9152056ed8aa4f36ef6">queue_ent::last_pos</a></div><div class="ttdeci">time_t last_pos</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01574">app_queue.c:1574</a></div></div>
<div class="ttc" id="bridge__basic_8h_html_a0b6d741f492cd88fd405a10396c62ab6"><div class="ttname"><a href="../../d4/d1e/bridge__basic_8h.html#a0b6d741f492cd88fd405a10396c62ab6">AST_TRANSFERER_ROLE_NAME</a></div><div class="ttdeci">#define AST_TRANSFERER_ROLE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1e/bridge__basic_8h_source.html#l00036">bridge_basic.h:36</a></div></div>
<div class="ttc" id="app__queue_8c_html_abac35567c42a41eb955ba8879bffa15d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abac35567c42a41eb955ba8879bffa15d">ql_exec</a></div><div class="ttdeci">static int ql_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">QueueLog application. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08106">app_queue.c:8106</a></div></div>
<div class="ttc" id="structast__party__redirecting_html"><div class="ttname"><a href="../../df/d44/structast__party__redirecting.html">ast_party_redirecting</a></div><div class="ttdoc">Redirecting Line information. RDNIS (Redirecting Directory Number Information Service) Where a call d...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00523">channel.h:523</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="devicestate_8h_html_a9fa7376e8e627cf5a512209005692013"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a9fa7376e8e627cf5a512209005692013">ast_device_state_topic_all</a></div><div class="ttdeci">struct stasis_topic * ast_device_state_topic_all(void)</div><div class="ttdoc">Get the Stasis topic for device state messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00668">devicestate.c:668</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8dc9d913ab9bf3c318b9ad1f679e4447"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8dc9d913ab9bf3c318b9ad1f679e4447">update_status</a></div><div class="ttdeci">static void update_status(struct call_queue *q, struct member *m, const int status)</div><div class="ttdoc">set a member&amp;#39;s status based on device state of that member&amp;#39;s state_interface. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02437">app_queue.c:2437</a></div></div>
<div class="ttc" id="pbx_8h_html_a8f7166f50cb9642179c9b321b8143f55"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a8f7166f50cb9642179c9b321b8143f55">ast_goto_if_exists</a></div><div class="ttdeci">int ast_goto_if_exists(struct ast_channel *chan, const char *context, const char *exten, int priority)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l08793">pbx.c:8793</a></div></div>
<div class="ttc" id="structcall__queue_html_a8d528a59938ef4b2d91244482bef6302"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a8d528a59938ef4b2d91244482bef6302">call_queue::roundingseconds</a></div><div class="ttdeci">int roundingseconds</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01725">app_queue.c:1725</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2c78c8b752b9ea7de6e7def56bd0b4ce"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2c78c8b752b9ea7de6e7def56bd0b4ce">set_queue_member_ringinuse</a></div><div class="ttdeci">static void set_queue_member_ringinuse(struct call_queue *q, struct member *mem, int ringinuse)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07622">app_queue.c:7622</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a263062ed75918c257f5401617389bdd8"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a263062ed75918c257f5401617389bdd8">ast_attended_transfer_type</a></div><div class="ttdeci">struct stasis_message_type * ast_attended_transfer_type(void)</div><div class="ttdoc">Message type for ast_attended_transfer_message. </div></div>
<div class="ttc" id="app__queue_8c_html_a2268442ff742f200d845e5223a722594"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2268442ff742f200d845e5223a722594">dump_queue_members</a></div><div class="ttdeci">static void dump_queue_members(struct call_queue *pm_queue)</div><div class="ttdoc">Dump all members in a specific queue to the database. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07269">app_queue.c:7269</a></div></div>
<div class="ttc" id="structast__config_html"><div class="ttname"><a href="../../dd/d18/structast__config.html">ast_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00249">main/config.c:249</a></div></div>
<div class="ttc" id="structast__db__entry_html"><div class="ttname"><a href="../../da/d1d/structast__db__entry.html">ast_db_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4a/astdb_8h_source.html#l00031">astdb.h:31</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf83a1fec8f09a2acf1dc6912207af41a"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf83a1fec8f09a2acf1dc6912207af41a">ast_channel_publish_dial_forward</a></div><div class="ttdeci">void ast_channel_publish_dial_forward(struct ast_channel *caller, struct ast_channel *peer, struct ast_channel *forwarded, const char *dialstring, const char *dialstatus, const char *forward)</div><div class="ttdoc">Publish in the ast_channel_topic or ast_channel_topic_all topics a stasis message for the channels in...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00689">stasis_channels.c:689</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a2a6c54dcdbeb16bb2e1676a4abf4a4d8"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">queue_stasis_data::starttime</a></div><div class="ttdeci">time_t starttime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05973">app_queue.c:5973</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a67508a613c8f337732e35d9367b43ae7"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a></div><div class="ttdeci">#define AST_LIST_ENTRY(type)</div><div class="ttdoc">Declare a forward link structure inside a list entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00409">linkedlists.h:409</a></div></div>
<div class="ttc" id="structqueue__ent_html_a6f8e491cf1d80eb127fe0c10ebbfc659"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a6f8e491cf1d80eb127fe0c10ebbfc659">queue_ent::prio</a></div><div class="ttdeci">int prio</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01569">app_queue.c:1569</a></div></div>
<div class="ttc" id="app__queue_8c_html_a628bb0f021d9643fbe96ddb7fd3fa77c"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a628bb0f021d9643fbe96ddb7fd3fa77c">queue_agent_dump_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_agent_dump_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02140">app_queue.c:2140</a></div></div>
<div class="ttc" id="stasis_8h_html_a839350445aaa51cedf31f6daec933ee0"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a></div><div class="ttdeci">int stasis_subscription_final_message(struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Determine whether a message is the final message to be received on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01176">stasis.c:1176</a></div></div>
<div class="ttc" id="structmember_html_ad538681414464e9cf207565d1efff679"><div class="ttname"><a href="../../d7/dd6/structmember.html#ad538681414464e9cf207565d1efff679">member::reason_paused</a></div><div class="ttdeci">char reason_paused[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01605">app_queue.c:1605</a></div></div>
<div class="ttc" id="f2c_8h_html_abf5d144da384425ae6cb542ce6eec8d3"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#abf5d144da384425ae6cb542ce6eec8d3">flag</a></div><div class="ttdeci">long int flag</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00083">f2c.h:83</a></div></div>
<div class="ttc" id="app__queue_8c_html_ac1dd446fcf3d75d5da9228faf2dce1d3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac1dd446fcf3d75d5da9228faf2dce1d3">device_state_cb</a></div><div class="ttdeci">static void device_state_cb(void *unused, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">set a member&amp;#39;s status based on device state of that member&amp;#39;s interface </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02503">app_queue.c:2503</a></div></div>
<div class="ttc" id="app__queue_8c_html_a280cd035294778a19581ae7941fd5d09"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a280cd035294778a19581ae7941fd5d09">app_pqm</a></div><div class="ttdeci">static char * app_pqm</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01454">app_queue.c:1454</a></div></div>
<div class="ttc" id="app__queue_8c_html_a1816259819a6820726fd9803486d41da"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a1816259819a6820726fd9803486d41da">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a></div><div class="ttdeci">STASIS_MESSAGE_TYPE_DEFN_LOCAL(queue_caller_join_type,.to_ami=queue_caller_join_to_ami,)</div></div>
<div class="ttc" id="channel_8h_html_ac1509976728f0058b229802a66a485ee"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac1509976728f0058b229802a66a485ee">ast_channel_sendurl</a></div><div class="ttdeci">int ast_channel_sendurl(struct ast_channel *channel, const char *url)</div><div class="ttdoc">Sends a URL on a given link Send URL on link. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06732">channel.c:6732</a></div></div>
<div class="ttc" id="app__queue_8c_html_a73f936847e6ad20cb842d03593dc47c4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a73f936847e6ad20cb842d03593dc47c4">alloc_queue</a></div><div class="ttdeci">static struct call_queue * alloc_queue(const char *queuename)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03534">app_queue.c:3534</a></div></div>
<div class="ttc" id="structast__bridge__channel__snapshot__pair_html_a548fa9691ccede16b32f244dd9637db4"><div class="ttname"><a href="../../da/db4/structast__bridge__channel__snapshot__pair.html#a548fa9691ccede16b32f244dd9637db4">ast_bridge_channel_snapshot_pair::bridge_snapshot</a></div><div class="ttdeci">struct ast_bridge_snapshot * bridge_snapshot</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00234">stasis_bridges.h:234</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="cli_8h_html_ae47751901c430ebb833e59291a5e0b3f"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a></div><div class="ttdeci">#define CLI_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00046">cli.h:46</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a2e006acff60d9b3d65d7d60f975d6747"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a></div><div class="ttdeci">static void parse(struct mgcp_request *req)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l01872">chan_mgcp.c:1872</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a9343294711278062e3bcf5b51417ccb4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9343294711278062e3bcf5b51417ccb4">OPT_NO_RETRY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01336">app_queue.c:1336</a></div></div>
<div class="ttc" id="channel_8h_html_abcf1aea85b924e9cd605040b86241e2a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abcf1aea85b924e9cd605040b86241e2a">AST_MAX_CONTEXT</a></div><div class="ttdeci">#define AST_MAX_CONTEXT</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00136">channel.h:136</a></div></div>
<div class="ttc" id="lock_8h_html_a2cfb325ed371eb6e629446bac4676e9f"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a></div><div class="ttdeci">#define SCOPED_AO2LOCK(varname, obj)</div><div class="ttdoc">scoped lock specialization for ao2 mutexes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00602">lock.h:602</a></div></div>
<div class="ttc" id="channel_8h_html_a892b6550a4f90b70ad92198c9d05cedc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a892b6550a4f90b70ad92198c9d05cedc">ast_channel_inherit_variables</a></div><div class="ttdeci">void ast_channel_inherit_variables(const struct ast_channel *parent, struct ast_channel *child)</div><div class="ttdoc">Inherits channel variable from parent to child channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l06866">channel.c:6866</a></div></div>
<div class="ttc" id="structast__party__connected__line_html_a07a87b2e6ed927503e2f95f119c9fc23"><div class="ttname"><a href="../../dc/d9e/structast__party__connected__line.html#a07a87b2e6ed927503e2f95f119c9fc23">ast_party_connected_line::source</a></div><div class="ttdeci">int source</div><div class="ttdoc">Information about the source of an update. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00483">channel.h:483</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structmember_html_ab755590c3f680079c572a5176366c8fe"><div class="ttname"><a href="../../d7/dd6/structmember.html#ab755590c3f680079c572a5176366c8fe">member::state_id</a></div><div class="ttdeci">int state_id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01597">app_queue.c:1597</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2555f8439a688d7ac9f3aa9d368d197b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2555f8439a688d7ac9f3aa9d368d197b">complete_queue_remove_member</a></div><div class="ttdeci">static char * complete_queue_remove_member(const char *line, const char *word, int pos, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10639">app_queue.c:10639</a></div></div>
<div class="ttc" id="channel_8h_html_ab57c278099ea5f8d7cedbb41eba58b56"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a></div><div class="ttdeci">#define AST_CHANNEL_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00172">channel.h:172</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html_a81d8d675a88cf528020284936ae4ef9a"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html#a81d8d675a88cf528020284936ae4ef9a">queue_stasis_data::member_optimize</a></div><div class="ttdeci">struct local_optimization member_optimize</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05987">app_queue.c:5987</a></div></div>
<div class="ttc" id="term_8h_html_a11b0efffc76ab7f40399993cb468e46a"><div class="ttname"><a href="../../db/d45/term_8h.html#a11b0efffc76ab7f40399993cb468e46a">ast_term_reset</a></div><div class="ttdeci">const char * ast_term_reset(void)</div><div class="ttdoc">Returns the terminal reset code. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de5/term_8c_source.html#l00306">term.c:306</a></div></div>
<div class="ttc" id="app__queue_8c_html_aeefd277e923719dc1671a0bc0eb3c2ed"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aeefd277e923719dc1671a0bc0eb3c2ed">queue_function_queuegetchannel</a></div><div class="ttdeci">static int queue_function_queuegetchannel(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">Dialplan function QUEUE_GET_CHANNEL() Get caller channel waiting at specified position in the queue...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08847">app_queue.c:8847</a></div></div>
<div class="ttc" id="app__queue_8c_html_af9ba6814d17cb9a49be24f92cb660645"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af9ba6814d17cb9a49be24f92cb660645">manager_change_priority_caller_on_queue</a></div><div class="ttdeci">static int manager_change_priority_caller_on_queue(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10517">app_queue.c:10517</a></div></div>
<div class="ttc" id="app__queue_8c_html_a244b9e8ffcadf8040db882c82f5b120b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a244b9e8ffcadf8040db882c82f5b120b">play_file</a></div><div class="ttdeci">static int play_file(struct ast_channel *chan, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03916">app_queue.c:3916</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8628933cde20921c453a6d2607bdad62ac02f08ed9358bc830b66ced5c7cda8cd"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8628933cde20921c453a6d2607bdad62ac02f08ed9358bc830b66ced5c7cda8cd">QUEUE_AUTOPAUSE_ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01395">app_queue.c:1395</a></div></div>
<div class="ttc" id="utils_8h_html_afb8683b4d96960d7a82a86a974a57599"><div class="ttname"><a href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a></div><div class="ttdeci">#define AST_FLAGS_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00196">utils.h:196</a></div></div>
<div class="ttc" id="app__queue_8c_html_a6d56dcc1f330ae7fe1b5a1ee832077c1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a6d56dcc1f330ae7fe1b5a1ee832077c1">queues_t_link</a></div><div class="ttdeci">#define queues_t_link(c, q, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01922">app_queue.c:1922</a></div></div>
<div class="ttc" id="channel_8h_html_a29557c4823f5e9c02519a01daf6a289c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a></div><div class="ttdeci">void ast_hangup(struct ast_channel *chan)</div><div class="ttdoc">Hang up a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02548">channel.c:2548</a></div></div>
<div class="ttc" id="structpenalty__rule_html_a71440ae035748bcf5f23ef1a86fe115d"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#a71440ae035748bcf5f23ef1a86fe115d">penalty_rule::list</a></div><div class="ttdeci">struct penalty_rule::@68 list</div></div>
<div class="ttc" id="res__pjsip__exten__state_8c_html_ae8731a90be4dc2d8272b7dfd8a001d4c"><div class="ttname"><a href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a></div><div class="ttdeci">static void to_ami(struct ast_sip_subscription *sub, struct ast_str **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00542">res_pjsip_exten_state.c:542</a></div></div>
<div class="ttc" id="structcall__queue_html_a6c0ebcc78965d8817651856e7914631d"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a6c0ebcc78965d8817651856e7914631d">call_queue::moh</a></div><div class="ttdeci">const ast_string_field moh</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="stasis_8h_html_a5713715b0f26f4943d0af05363b07027"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a></div><div class="ttdeci">struct stasis_forward * stasis_forward_cancel(struct stasis_forward *forward)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01548">stasis.c:1548</a></div></div>
<div class="ttc" id="max__forwards_8h_html"><div class="ttname"><a href="../../d3/d93/max__forwards_8h.html">max_forwards.h</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="structrule__list_html_a820b1923a2e6b2f1d61cfd41a74fefd7"><div class="ttname"><a href="../../d8/de5/structrule__list.html#a820b1923a2e6b2f1d61cfd41a74fefd7">rule_list::list</a></div><div class="ttdeci">struct rule_list::@72 list</div></div>
<div class="ttc" id="aoc_8h_html_a8f66f98f015246c294b10dc2c9350612"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a8f66f98f015246c294b10dc2c9350612">ast_aoc_destroy_encoded</a></div><div class="ttdeci">void * ast_aoc_destroy_encoded(struct ast_aoc_encoded *encoded)</div><div class="ttdoc">free an ast_aoc_encoded object </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00313">aoc.c:313</a></div></div>
<div class="ttc" id="structautopause_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../df/dd2/structautopause.html#a8f8f80d37794cde9472343e4487ba3eb">autopause::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01422">app_queue.c:1422</a></div></div>
<div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab5a25afd13aa42a238c165bd5a8fecf2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab5a25afd13aa42a238c165bd5a8fecf2">complete_queue_add_member</a></div><div class="ttdeci">static char * complete_queue_add_member(const char *line, const char *word, int pos, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10426">app_queue.c:10426</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="app__queue_8c_html_aad2dd72565852b91c809cd4685833b17"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aad2dd72565852b91c809cd4685833b17">DEFAULT_TIMEOUT</a></div><div class="ttdeci">#define DEFAULT_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01430">app_queue.c:1430</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_aa59d4e87c66028292722730a82c149ab"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#aa59d4e87c66028292722730a82c149ab">stasis_message_router_set_default</a></div><div class="ttdeci">int stasis_message_router_set_default(struct stasis_message_router *router, stasis_subscription_cb callback, void *data)</div><div class="ttdoc">Sets the default route of a router. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00387">stasis_message_router.c:387</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00305">include/asterisk/frame.h:305</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad2bd8d5629fdba7d86c59b7d72c892a7"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad2bd8d5629fdba7d86c59b7d72c892a7">manager_queues_status</a></div><div class="ttdeci">static int manager_queues_status(struct mansession *s, const struct message *m)</div><div class="ttdoc">Queue status info via AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10104">app_queue.c:10104</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a1043fcafb4c428c3dfe5a3253485d7af">QUEUE_EMPTY_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01625">app_queue.c:1625</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a7c4515f386fff57ac14217a7a5a6c388"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a7c4515f386fff57ac14217a7a5a6c388">OPT_MARK_AS_ANSWERED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01326">app_queue.c:1326</a></div></div>
<div class="ttc" id="devicestate_8h_html_a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00070">devicestate.h:70</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67a1af23b1ad5497875f46898f87c3da396">QUEUE_STRATEGY_RINGALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01382">app_queue.c:1382</a></div></div>
<div class="ttc" id="term_8h_html_aa86a4efe2acaee184cf754ccc5248599"><div class="ttname"><a href="../../db/d45/term_8h.html#aa86a4efe2acaee184cf754ccc5248599">ast_term_color</a></div><div class="ttdeci">const char * ast_term_color(int fgcolor, int bgcolor)</div><div class="ttdoc">Return a color sequence string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de5/term_8c_source.html#l00290">term.c:290</a></div></div>
<div class="ttc" id="structast__bridge__snapshot_html_a753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../d0/d99/structast__bridge__snapshot.html#a753c7b39e3284d771f13f513b003d033">ast_bridge_snapshot::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00336">bridge.h:336</a></div></div>
<div class="ttc" id="structcall__queue_html_af983858a2192f96c9a30e44467b87f61"><div class="ttname"><a href="../../df/db5/structcall__queue.html#af983858a2192f96c9a30e44467b87f61">call_queue::timeoutpriority</a></div><div class="ttdeci">int timeoutpriority</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01745">app_queue.c:1745</a></div></div>
<div class="ttc" id="structcall__queue_html_a48bf0904a10400913c3e04f898028f20"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a48bf0904a10400913c3e04f898028f20">call_queue::defaultrule</a></div><div class="ttdeci">const ast_string_field defaultrule</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="taskprocessor_8h_html"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html">taskprocessor.h</a></div><div class="ttdoc">An API for managing task processing threads that can be shared across modules. </div></div>
<div class="ttc" id="structcall__queue_html_a239514696fb2a3869913aee8fe9b83c7"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a239514696fb2a3869913aee8fe9b83c7">call_queue::sound_seconds</a></div><div class="ttdeci">const ast_string_field sound_seconds</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="bridge__basic_8h_html"><div class="ttname"><a href="../../d4/d1e/bridge__basic_8h.html">bridge_basic.h</a></div><div class="ttdoc">Basic bridge subclass API. </div></div>
<div class="ttc" id="channel_8h_html_ae6c85ee3595b7e9ee6fc072a3b7da814"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae6c85ee3595b7e9ee6fc072a3b7da814">ast_autoservice_chan_hangup_peer</a></div><div class="ttdeci">void ast_autoservice_chan_hangup_peer(struct ast_channel *chan, struct ast_channel *peer)</div><div class="ttdoc">Put chan into autoservice while hanging up peer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d66/autoservice_8c_source.html#l00342">autoservice.c:342</a></div></div>
<div class="ttc" id="app__queue_8c_html_abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abfd16358cfabbb3ad0c435c17883e398ab18e9313e34662b745beabef3ed7ca44">QUEUE_RELOAD_PARAMETERS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01399">app_queue.c:1399</a></div></div>
<div class="ttc" id="structrule__list_html"><div class="ttname"><a href="../../d8/de5/structrule__list.html">rule_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01758">app_queue.c:1758</a></div></div>
<div class="ttc" id="structqueue__ent_html_a332b7fee721032ad71017510932cbbf9"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a332b7fee721032ad71017510932cbbf9">queue_ent::pr</a></div><div class="ttdeci">struct penalty_rule * pr</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01588">app_queue.c:1588</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2af24af6741501e58c5a32990e70a35a5d">QUEUE_TIMEOUT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01497">app_queue.c:1497</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga568aa1aff837fc0001279490a6d9b22f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a></div><div class="ttdeci">struct stasis_topic * ast_manager_get_topic(void)</div><div class="ttdoc">Get the Stasis Message Bus API topic for AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01720">manager.c:1720</a></div></div>
<div class="ttc" id="app__queue_8c_html_a54d8f5c6ba5bd46020c7c319fa5a89c2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a54d8f5c6ba5bd46020c7c319fa5a89c2">wait_our_turn</a></div><div class="ttdeci">static int wait_our_turn(struct queue_ent *qe, int ringing, enum queue_result *reason)</div><div class="ttdoc">The waiting areas for callers who are not actively calling members. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05626">app_queue.c:5626</a></div></div>
<div class="ttc" id="structcall__queue_html_aa5f94941fd815c8e5e37235a648ea91c"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aa5f94941fd815c8e5e37235a648ea91c">call_queue::announceposition</a></div><div class="ttdeci">unsigned int announceposition</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01709">app_queue.c:1709</a></div></div>
<div class="ttc" id="channel_8h_html_ad2334e69c466aec25ba3cbba53b7201b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ad2334e69c466aec25ba3cbba53b7201b">ast_channel_redirecting</a></div><div class="ttdeci">struct ast_party_redirecting * ast_channel_redirecting(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00908">channel_internal_api.c:908</a></div></div>
<div class="ttc" id="structqueue__ent_html_a79ec26d453dcd29aec17f5536233e849"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a79ec26d453dcd29aec17f5536233e849">queue_ent::pending</a></div><div class="ttdeci">int pending</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01577">app_queue.c:1577</a></div></div>
<div class="ttc" id="structcall__queue_html_a7dbc8370e15350314b041aad17f96706"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a7dbc8370e15350314b041aad17f96706">call_queue::found</a></div><div class="ttdeci">unsigned int found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01713">app_queue.c:1713</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00047">bridge_features.h:47</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8e96a6fc0050e0b3a0b79783d337aa3a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8e96a6fc0050e0b3a0b79783d337aa3a">queue_publish_multi_channel_blob</a></div><div class="ttdeci">static void queue_publish_multi_channel_blob(struct ast_channel *caller, struct ast_channel *agent, struct stasis_message_type *type, struct ast_json *blob)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02201">app_queue.c:2201</a></div></div>
<div class="ttc" id="app__queue_8c_html_a0809b6a4ede89226ed013ac442992872"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a0809b6a4ede89226ed013ac442992872">queue_agent_called_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_agent_called_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02125">app_queue.c:2125</a></div></div>
<div class="ttc" id="app__queue_8c_html_ace5e218ac5b4850ddcf7cb1a9866da6b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ace5e218ac5b4850ddcf7cb1a9866da6b">manager_queues_summary</a></div><div class="ttdeci">static int manager_queues_summary(struct mansession *s, const struct message *m)</div><div class="ttdoc">Summary of queue info via the AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10026">app_queue.c:10026</a></div></div>
<div class="ttc" id="structmember_html_a2a6c54dcdbeb16bb2e1676a4abf4a4d8"><div class="ttname"><a href="../../d7/dd6/structmember.html#a2a6c54dcdbeb16bb2e1676a4abf4a4d8">member::starttime</a></div><div class="ttdeci">time_t starttime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01609">app_queue.c:1609</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_addaa208b0ed785225e24490fb9f28a80"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a></div><div class="ttdeci">AST_MODULE_INFO(ASTERISK_GPL_KEY, AST_MODFLAG_GLOBAL_SYMBOLS|AST_MODFLAG_LOAD_ORDER, &quot;HTTP Phone Provisioning&quot;,.support_level=AST_MODULE_SUPPORT_EXTENDED,.load=load_module,.unload=unload_module,.reload=reload,.load_pri=AST_MODPRI_CHANNEL_DEPEND,.requires=&quot;http&quot;,)</div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea76d91d5d654cfa3edafb2afbe3e09b46"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea76d91d5d654cfa3edafb2afbe3e09b46">AST_DEVICE_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00059">devicestate.h:59</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_abf64fa441014314244648caa6c8ab80b"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#abf64fa441014314244648caa6c8ab80b">ast_bridge_topic_all</a></div><div class="ttdeci">struct stasis_topic * ast_bridge_topic_all(void)</div><div class="ttdoc">A topic which publishes the events for all bridges. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00179">stasis_bridges.c:179</a></div></div>
<div class="ttc" id="structcall__queue_html_a3991228a9e7540246c6cc4cf42c0794d"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a3991228a9e7540246c6cc4cf42c0794d">call_queue::randomperiodicannounce</a></div><div class="ttdeci">int randomperiodicannounce</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01724">app_queue.c:1724</a></div></div>
<div class="ttc" id="channel_8h_html_a018b7a29cef2d62074dc46e9aaad0d1a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a018b7a29cef2d62074dc46e9aaad0d1a">ast_channel_exten_set</a></div><div class="ttdeci">void ast_channel_exten_set(struct ast_channel *chan, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00357">channel_internal_api.c:357</a></div></div>
<div class="ttc" id="channel_8h_html_a4a5bc2ea394aace55ea3809e53365ea9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a></div><div class="ttdeci">struct ast_format_cap * ast_channel_nativeformats(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00637">channel_internal_api.c:637</a></div></div>
<div class="ttc" id="structmember_html_a5f1c773ac1d2f42241d25d73373885ab"><div class="ttname"><a href="../../d7/dd6/structmember.html#a5f1c773ac1d2f42241d25d73373885ab">member::calls</a></div><div class="ttdeci">int calls</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01600">app_queue.c:1600</a></div></div>
<div class="ttc" id="pbx_8h_html_a6e5b90edb84d216267148dddcffe9b9a"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a></div><div class="ttdeci">int pbx_builtin_setvar_helper(struct ast_channel *chan, const char *name, const char *value)</div><div class="ttdoc">Add a variable to the channel variable stack, removing the most recently set value for the same name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01071">pbx_variables.c:1071</a></div></div>
<div class="ttc" id="app__queue_8c_html_a47a9a7eb9151809e5e86948c146bee2e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a47a9a7eb9151809e5e86948c146bee2e">queue_function_queuememberlist</a></div><div class="ttdeci">static int queue_function_queuememberlist(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">Dialplan function QUEUE_MEMBER_LIST() Get list of members in a specific queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08963">app_queue.c:8963</a></div></div>
<div class="ttc" id="app__queue_8c_html_a88215ab017dd4ed8343d17918eacee81"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a88215ab017dd4ed8343d17918eacee81">RES_NOSUCHQUEUE</a></div><div class="ttdeci">#define RES_NOSUCHQUEUE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01444">app_queue.c:1444</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8e57e0916b189a3a78e018cc14e8cb1b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8e57e0916b189a3a78e018cc14e8cb1b">ANNOUNCEHOLDTIME_ALWAYS</a></div><div class="ttdeci">#define ANNOUNCEHOLDTIME_ALWAYS</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01636">app_queue.c:1636</a></div></div>
<div class="ttc" id="channel_8h_html_a050bec9a4abc1a599b6573a6091b080c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a050bec9a4abc1a599b6573a6091b080c">ast_waitfordigit</a></div><div class="ttdeci">int ast_waitfordigit(struct ast_channel *c, int ms)</div><div class="ttdoc">Waits for a digit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l03184">channel.c:3184</a></div></div>
<div class="ttc" id="structast__bridge__config_html_a5fd13b216c2752f4f1fb843cae429558"><div class="ttname"><a href="../../d0/d13/structast__bridge__config.html#a5fd13b216c2752f4f1fb843cae429558">ast_bridge_config::end_bridge_callback</a></div><div class="ttdeci">void(* end_bridge_callback)(void *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01091">channel.h:1091</a></div></div>
<div class="ttc" id="structmember_html_a6e27f49150e9a14580fb313cc2777e00"><div class="ttname"><a href="../../d7/dd6/structmember.html#a6e27f49150e9a14580fb313cc2777e00">member::status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01603">app_queue.c:1603</a></div></div>
<div class="ttc" id="structcall__queue_html_a23486e86a21295aa734885d335ae9c2f"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a23486e86a21295aa734885d335ae9c2f">call_queue::setqueueentryvar</a></div><div class="ttdeci">unsigned int setqueueentryvar</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01704">app_queue.c:1704</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8ae24afed07fd0a8f2cad72571999061"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8ae24afed07fd0a8f2cad72571999061">queue_t_unref</a></div><div class="ttdeci">#define queue_t_unref(q, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01921">app_queue.c:1921</a></div></div>
<div class="ttc" id="channel_8h_html_a695e5b4fcf983db6451b583fbd647424"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a695e5b4fcf983db6451b583fbd647424">ast_channel_lock_both</a></div><div class="ttdeci">#define ast_channel_lock_both(chan1, chan2)</div><div class="ttdoc">Lock two channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02952">channel.h:2952</a></div></div>
<div class="ttc" id="app__queue_8c_html_a320230789b7f2a50b186d18458f9cf9d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a320230789b7f2a50b186d18458f9cf9d">queue_member_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_member_to_ami(const char *type, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02020">app_queue.c:2020</a></div></div>
<div class="ttc" id="chan__dahdi_8c_html_a4ee142675554d362c585267c1290d5b3"><div class="ttname"><a href="../../d1/d97/chan__dahdi_8c.html#a4ee142675554d362c585267c1290d5b3">available</a></div><div class="ttdeci">static int available(struct dahdi_pvt **pvt, int is_specific_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/chan__dahdi_8c_source.html#l13058">chan_dahdi.c:13058</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae88eeca2bab42ff051da9157696726d4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae88eeca2bab42ff051da9157696726d4">cli_queue</a></div><div class="ttdeci">static struct ast_cli_entry cli_queue[]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11234">app_queue.c:11234</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a9ff7aa27ae5f1a980bcf81f91cd6e470"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a></div><div class="ttdeci">const char * ast_variable_retrieve(struct ast_config *config, const char *category, const char *variable)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00694">main/config.c:694</a></div></div>
<div class="ttc" id="structcall__queue_html_aed4d53167e5f2010bf8eca8f645c3745"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aed4d53167e5f2010bf8eca8f645c3745">call_queue::announce</a></div><div class="ttdeci">const ast_string_field announce</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="structcall__queue_html_a17b2ac278623f5aeb166dd16fc784acd"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a17b2ac278623f5aeb166dd16fc784acd">call_queue::sound_reporthold</a></div><div class="ttdeci">const ast_string_field sound_reporthold</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="app__queue_8c_html_a88cbf36725c411333529927a28f37915"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a88cbf36725c411333529927a28f37915">callattempt_free</a></div><div class="ttdeci">static void callattempt_free(struct callattempt *doomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04228">app_queue.c:4228</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2a131d9c4fe1d72d7b5f8532708ae18285"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a131d9c4fe1d72d7b5f8532708ae18285">QUEUE_FULL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01502">app_queue.c:1502</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9f47efbf12dd8d11585d5bd6da60b600"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9f47efbf12dd8d11585d5bd6da60b600">set_member_value_help_members</a></div><div class="ttdeci">static int set_member_value_help_members(struct call_queue *q, const char *interface, int property, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07651">app_queue.c:7651</a></div></div>
<div class="ttc" id="strings_8h_html_aabc005bd1c7e249e8f8659d57d4500b6"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a></div><div class="ttdeci">size_t ast_str_strlen(const struct ast_str *buf)</div><div class="ttdoc">Returns the current length of the string stored within buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00688">strings.h:688</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7b5de2aa80f528d3dc554caadb8dc6aba42e2c6aadc44e4259a058a6675b7e7e4"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7b5de2aa80f528d3dc554caadb8dc6aba42e2c6aadc44e4259a058a6675b7e7e4">AO2_ITERATOR_DONTLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01872">astobj2.h:1872</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="core__local_8h_html_a8f023d0ccc8c7d3365abf4d60412deb5"><div class="ttname"><a href="../../d5/da6/core__local_8h.html#a8f023d0ccc8c7d3365abf4d60412deb5">ast_local_optimization_begin_type</a></div><div class="ttdeci">struct stasis_message_type * ast_local_optimization_begin_type(void)</div><div class="ttdoc">Message type for when a local channel optimization begins. </div></div>
<div class="ttc" id="structcall__queue_html_a8c3a63527e11cef32f7e5aae9f3f270f"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a8c3a63527e11cef32f7e5aae9f3f270f">call_queue::callsabandoned</a></div><div class="ttdeci">int callsabandoned</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01729">app_queue.c:1729</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca4a56217fdad3e940fa6b87dfd296c829">OBJ_SEARCH_OBJECT</a></div><div class="ttdoc">The arg parameter is an object of the same type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01091">astobj2.h:1091</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9334a5b9057f32da96db9b5c6a045d67aee8588c59bd53b91d0cebce5faca7a06"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9334a5b9057f32da96db9b5c6a045d67aee8588c59bd53b91d0cebce5faca7a06">QUEUE_STRATEGY_WRANDOM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01388">app_queue.c:1388</a></div></div>
<div class="ttc" id="structast__party__dialed_html_af1107092b9e5d7570605297a465ec766"><div class="ttname"><a href="../../d1/dd1/structast__party__dialed.html#af1107092b9e5d7570605297a465ec766">ast_party_dialed::transit_network_select</a></div><div class="ttdeci">int transit_network_select</div><div class="ttdoc">Transit Network Select. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00398">channel.h:398</a></div></div>
<div class="ttc" id="app__queue_8c_html_a967650811eabe6b6373dddc731a286eb"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a967650811eabe6b6373dddc731a286eb">ANNOUNCEPOSITION_LIMIT</a></div><div class="ttdeci">#define ANNOUNCEPOSITION_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01654">app_queue.c:1654</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8a12ebde49cdd091865dc355f41a3cb9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8a12ebde49cdd091865dc355f41a3cb9">store_next_lin</a></div><div class="ttdeci">static int store_next_lin(struct queue_ent *qe, struct callattempt *outgoing)</div><div class="ttdoc">Search for best metric and add to Linear queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04723">app_queue.c:4723</a></div></div>
<div class="ttc" id="channel_8h_html_ac8bce0bf79829c59a7671c4eff83a31f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac8bce0bf79829c59a7671c4eff83a31f">ast_party_redirecting_free</a></div><div class="ttdeci">void ast_party_redirecting_free(struct ast_party_redirecting *doomed)</div><div class="ttdoc">Destroy the redirecting information contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02179">channel.c:2179</a></div></div>
<div class="ttc" id="channel_8h_html_a5d3c15fe1dffda82e6dc03ca7b26526a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5d3c15fe1dffda82e6dc03ca7b26526a">ast_party_connected_line_copy</a></div><div class="ttdeci">void ast_party_connected_line_copy(struct ast_party_connected_line *dest, const struct ast_party_connected_line *src)</div><div class="ttdoc">Copy the source connected line information to the destination connected line. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02031">channel.c:2031</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a0c9c1b291152109321095a6734256794"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a0c9c1b291152109321095a6734256794">OPT_CALLER_AUTOMON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01344">app_queue.c:1344</a></div></div>
<div class="ttc" id="app__queue_8c_html_a0b2ffd959c3ce34b11292c6ecfc8f2d8"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a0b2ffd959c3ce34b11292c6ecfc8f2d8">record_abandoned</a></div><div class="ttdeci">static void record_abandoned(struct queue_ent *qe)</div><div class="ttdoc">Record that a caller gave up on waiting in queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04808">app_queue.c:4808</a></div></div>
<div class="ttc" id="max__forwards_8h_html_a63b977e0cb5f350171fed9dffd4fabe5"><div class="ttname"><a href="../../d3/d93/max__forwards_8h.html#a63b977e0cb5f350171fed9dffd4fabe5">ast_max_forwards_decrement</a></div><div class="ttdeci">int ast_max_forwards_decrement(struct ast_channel *chan)</div><div class="ttdoc">Decrement the max forwards count for a particular channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ddd/max__forwards_8c_source.html#l00135">max_forwards.c:135</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3a355e71b1bbd152d9eccde42a0212e2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3a355e71b1bbd152d9eccde42a0212e2">send_agent_complete</a></div><div class="ttdeci">static void send_agent_complete(const char *queuename, struct ast_channel_snapshot *caller, struct ast_channel_snapshot *peer, const struct member *member, time_t holdstart, time_t callstart, enum agent_complete_reason rsn)</div><div class="ttdoc">Send out AMI message with member call completion status information. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05864">app_queue.c:5864</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a48bc11919b2752df9d14ce89557cfb25"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00033">utils/frame.c:33</a></div></div>
<div class="ttc" id="structcall__queue_html_a85d956ea75a2f9be8f6a4d0f8c09268a"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a85d956ea75a2f9be8f6a4d0f8c09268a">call_queue::sound_calls</a></div><div class="ttdeci">const ast_string_field sound_calls</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="bridge__after_8h_html"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html">bridge_after.h</a></div><div class="ttdoc">After Bridge Execution API. </div></div>
<div class="ttc" id="structast__aoc__decoded_html"><div class="ttname"><a href="../../d9/dca/structast__aoc__decoded.html">ast_aoc_decoded</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00205">aoc.c:205</a></div></div>
<div class="ttc" id="app__queue_8c_html_a703a108712f8f7b20303de08a0c4f5ac"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a703a108712f8f7b20303de08a0c4f5ac">realtime_rules</a></div><div class="ttdeci">static int realtime_rules</div><div class="ttdoc">queuesrules.conf [general] option </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01481">app_queue.c:1481</a></div></div>
<div class="ttc" id="f2c_8h_html_a3aa069ac3980707dae1e0530f50d59e4"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#a3aa069ac3980707dae1e0530f50d59e4">abs</a></div><div class="ttdeci">#define abs(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00195">f2c.h:195</a></div></div>
<div class="ttc" id="structcall__queue_html_a8e2c16675bb0afd19ebeabbcd4329681"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a8e2c16675bb0afd19ebeabbcd4329681">call_queue::numperiodicannounce</a></div><div class="ttdeci">int numperiodicannounce</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01723">app_queue.c:1723</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga68c55b443ba97dc157b493aafd05c876"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_get_latest(const char *uniqueid)</div><div class="ttdoc">Obtain the latest ast_channel_snapshot from the Stasis Message Bus API cache. This is an ao2 object...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00903">stasis_channels.c:903</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="say_8h_html_a899e1f86b2d65a32eeb6e17aabfa1f12"><div class="ttname"><a href="../../db/dce/say_8h.html#a899e1f86b2d65a32eeb6e17aabfa1f12">ast_say_number</a></div><div class="ttdeci">int ast_say_number(struct ast_channel *chan, int num, const char *ints, const char *lang, const char *options)</div><div class="ttdoc">says a number </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08337">channel.c:8337</a></div></div>
<div class="ttc" id="cli_8h_html"><div class="ttname"><a href="../../dc/db0/cli_8h.html">cli.h</a></div><div class="ttdoc">Standard Command Line Interface. </div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a8235d5ff2f8003fdb1d20c6876425ebf"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a8235d5ff2f8003fdb1d20c6876425ebf">OPT_IGNORE_CALL_FW</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01332">app_queue.c:1332</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad3dd27f57e607377bad90d16cde6693b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad3dd27f57e607377bad90d16cde6693b">find_queue_by_name_rt</a></div><div class="ttdeci">static struct call_queue * find_queue_by_name_rt(const char *queuename, struct ast_variable *queue_vars, struct ast_config *member_config)</div><div class="ttdoc">Reload a single queue via realtime. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03558">app_queue.c:3558</a></div></div>
<div class="ttc" id="structqueue__ent_html_a26f62e545090b51f4c7e8efbf2db8d6b"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a26f62e545090b51f4c7e8efbf2db8d6b">queue_ent::last_periodic_announce_time</a></div><div class="ttdeci">time_t last_periodic_announce_time</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01572">app_queue.c:1572</a></div></div>
<div class="ttc" id="res__monitor_8c_html_a24009cd78ef05c71b550254624eb6c13"><div class="ttname"><a href="../../d2/d1b/res__monitor_8c.html#a24009cd78ef05c71b550254624eb6c13">ast_monitor_setjoinfiles</a></div><div class="ttdeci">void AST_OPTIONAL_API_NAME() ast_monitor_setjoinfiles(struct ast_channel *chan, int turnon)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d1b/res__monitor_8c_source.html#l00926">res_monitor.c:926</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="app__queue_8c_html_a030c82755a6b35bb25eb912920d997ba"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a030c82755a6b35bb25eb912920d997ba">queuevar_function</a></div><div class="ttdeci">static struct ast_custom_function queuevar_function</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09084">app_queue.c:9084</a></div></div>
<div class="ttc" id="channel_8h_html_aa04afa262d7e1b211ee32d17c949a275"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a></div><div class="ttdeci">int ast_channel_hangupcause(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00427">channel_internal_api.c:427</a></div></div>
<div class="ttc" id="channel_8h_html_a25f1c885c7f5230ea4c9bc48dde88fe1ace68898ce2f86298d8e39e0473a55e28"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a25f1c885c7f5230ea4c9bc48dde88fe1ace68898ce2f86298d8e39e0473a55e28">AST_FEATURE_PARKCALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01069">channel.h:1069</a></div></div>
<div class="ttc" id="astdb_8h_html_a71e8d5ab1757b184683a99125d1c8160"><div class="ttname"><a href="../../de/d4a/astdb_8h.html#a71e8d5ab1757b184683a99125d1c8160">ast_db_del</a></div><div class="ttdeci">int ast_db_del(const char *family, const char *key)</div><div class="ttdoc">Delete entry in astdb. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d21/main_2db_8c_source.html#l00429">main/db.c:429</a></div></div>
<div class="ttc" id="app__queue_8c_html_a63d1be9b7af452b0ffe285d8a1cc7a43"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a63d1be9b7af452b0ffe285d8a1cc7a43">queue_rules_reset_global_params</a></div><div class="ttdeci">static void queue_rules_reset_global_params(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09122">app_queue.c:9122</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="channel_8h_html_accf4e9753bd5d7316f4988e74486552b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a></div><div class="ttdeci">void ast_connected_line_copy_from_caller(struct ast_party_connected_line *dest, const struct ast_party_caller *src)</div><div class="ttdoc">Copy the caller information to the connected line information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08389">channel.c:8389</a></div></div>
<div class="ttc" id="structmember_html_a5a242f61697cefa27ec3ce5082e2cd23"><div class="ttname"><a href="../../d7/dd6/structmember.html#a5a242f61697cefa27ec3ce5082e2cd23">member::rt_uniqueid</a></div><div class="ttdeci">char rt_uniqueid[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01615">app_queue.c:1615</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2adcb9aca3157b3a850bae64788f6593cd"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2adcb9aca3157b3a850bae64788f6593cd">QUEUE_JOINUNAVAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01500">app_queue.c:1500</a></div></div>
<div class="ttc" id="pbx_8h_html_aed6cfe76441ef995ab80609020a9990c"><div class="ttname"><a href="../../db/de0/pbx_8h.html#aed6cfe76441ef995ab80609020a9990c">ast_extension_state</a></div><div class="ttdeci">int ast_extension_state(struct ast_channel *c, const char *context, const char *exten)</div><div class="ttdoc">Uses hint and devicestate callback to get the state of an extension. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l03170">pbx.c:3170</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab2d834859be2c32442d2817935a0e3c7"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab2d834859be2c32442d2817935a0e3c7">insert_entry</a></div><div class="ttdeci">static void insert_entry(struct call_queue *q, struct queue_ent *prev, struct queue_ent *new, int *pos)</div><div class="ttdoc">Insert the &amp;#39;new&amp;#39; entry after the &amp;#39;prev&amp;#39; entry of queue &amp;#39;q&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01952">app_queue.c:1952</a></div></div>
<div class="ttc" id="app__queue_8c_html_af90b6bfe64cf7ef0df349ef23852ece3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af90b6bfe64cf7ef0df349ef23852ece3">autopause2int</a></div><div class="ttdeci">static int autopause2int(const char *autopause)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01813">app_queue.c:1813</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a5745afa61052d9e54f177910f53da159"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a5745afa61052d9e54f177910f53da159">OPT_GO_ON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01327">app_queue.c:1327</a></div></div>
<div class="ttc" id="structast__app_html"><div class="ttname"><a href="../../d0/da3/structast__app.html">ast_app</a></div><div class="ttdoc">ast_app: A registered application </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/pbx__app_8c_source.html#l00045">pbx_app.c:45</a></div></div>
<div class="ttc" id="structcall__queue_html_a53e750a536c8270e37bbdd35a9def3d4"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a53e750a536c8270e37bbdd35a9def3d4">call_queue::realtime</a></div><div class="ttdeci">unsigned int realtime</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01712">app_queue.c:1712</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="channel_8h_html_a1a5760823cd16fd0343e489efd9c8f89"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1a5760823cd16fd0343e489efd9c8f89">ast_party_redirecting_init</a></div><div class="ttdeci">void ast_party_redirecting_init(struct ast_party_redirecting *init)</div><div class="ttdoc">Initialize the given redirecting structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02122">channel.c:2122</a></div></div>
<div class="ttc" id="app__queue_8c_html_a70bab206de25bd96bebc592ad255d277"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a70bab206de25bd96bebc592ad255d277">handle_local_optimization_begin</a></div><div class="ttdeci">static void handle_local_optimization_begin(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06281">app_queue.c:6281</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab48d01c852ebb7b07f572e4b20a1abb3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab48d01c852ebb7b07f572e4b20a1abb3">get_interface_helper</a></div><div class="ttdeci">static struct member * get_interface_helper(struct call_queue *q, const char *interface)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08618">app_queue.c:8618</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2cfafe91008492ba14ad4a0f8e11ea63"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2cfafe91008492ba14ad4a0f8e11ea63">get_member_status</a></div><div class="ttdeci">static int get_member_status(struct call_queue *q, int max_penalty, int min_penalty, int raise_penalty, enum empty_conditions conditions, int devstate)</div><div class="ttdoc">Check if members are available. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02284">app_queue.c:2284</a></div></div>
<div class="ttc" id="strings_8h_html_a6c3dc0bad204e9dd9890325c1c861e38"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a></div><div class="ttdeci">int attribute_pure ast_false(const char *val)</div><div class="ttdoc">Make sure something is false. Determine if a string containing a boolean value is &quot;false&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01968">main/utils.c:1968</a></div></div>
<div class="ttc" id="app__queue_8c_html_afadb8ba08300e1949f925ea3da91d443"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#afadb8ba08300e1949f925ea3da91d443">compress_char</a></div><div class="ttdeci">static int compress_char(const char c)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02730">app_queue.c:2730</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gac6cf4ef94e11b14625a81ba56f89a183"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gac6cf4ef94e11b14625a81ba56f89a183">ast_multi_channel_blob_get_channel</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_multi_channel_blob_get_channel(struct ast_multi_channel_blob *obj, const char *role)</div><div class="ttdoc">Retrieve a channel snapshot associated with a specific role from a ast_multi_channel_blob. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00977">stasis_channels.c:977</a></div></div>
<div class="ttc" id="structast__cli__args_html_a4b911d12699acbbb5a8b62355b35bae8"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">ast_cli_args::pos</a></div><div class="ttdeci">const int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00164">cli.h:164</a></div></div>
<div class="ttc" id="file_8h_html_affc21cb57c6bf72a2cb7ec8a379b2137"><div class="ttname"><a href="../../d2/d4d/file_8h.html#affc21cb57c6bf72a2cb7ec8a379b2137">ast_waitstream</a></div><div class="ttdeci">int ast_waitstream(struct ast_channel *c, const char *breakon)</div><div class="ttdoc">Waits for a stream to stop or digit to be pressed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01776">file.c:1776</a></div></div>
<div class="ttc" id="app__queue_8c_html_a1248fe33745c5cb9c87db6be0a25d138"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a1248fe33745c5cb9c87db6be0a25d138">set_queue_variables</a></div><div class="ttdeci">static void set_queue_variables(struct call_queue *q, struct ast_channel *chan)</div><div class="ttdoc">Set variables of queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01926">app_queue.c:1926</a></div></div>
<div class="ttc" id="file_8h_html_ab9b8ab8e5ee34c9b4da25779255cafde"><div class="ttname"><a href="../../d2/d4d/file_8h.html#ab9b8ab8e5ee34c9b4da25779255cafde">ast_fileexists</a></div><div class="ttdeci">int ast_fileexists(const char *filename, const char *fmt, const char *preflang)</div><div class="ttdoc">Checks for the existence of a given file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01086">file.c:1086</a></div></div>
<div class="ttc" id="app__queue_8c_html_a452e8221d8fbd54db8c589265a09e844"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a452e8221d8fbd54db8c589265a09e844">queue_timeout_priority</a></div><div class="ttdeci">queue_timeout_priority</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01520">app_queue.c:1520</a></div></div>
<div class="ttc" id="monitor_8h_html"><div class="ttname"><a href="../../d5/d60/monitor_8h.html">monitor.h</a></div><div class="ttdoc">Channel monitoring. </div></div>
<div class="ttc" id="structast__multi__channel__blob_html"><div class="ttname"><a href="../../df/dcb/structast__multi__channel__blob.html">ast_multi_channel_blob</a></div><div class="ttdoc">A multi channel blob data structure for multi_channel_blob stasis messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00811">stasis_channels.c:811</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2feb2a31bf81358e86919381547161ac"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2feb2a31bf81358e86919381547161ac">aqm_exec</a></div><div class="ttdeci">static int aqm_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">AddQueueMember application. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08025">app_queue.c:8025</a></div></div>
<div class="ttc" id="app__queue_8c_html_a683847486195523a31706eeada8b4237"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a683847486195523a31706eeada8b4237">hangupcalls</a></div><div class="ttdeci">static void hangupcalls(struct queue_ent *qe, struct callattempt *outgoing, struct ast_channel *exception, int cancel_answered_elsewhere)</div><div class="ttdoc">Hang up a list of outgoing calls. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04250">app_queue.c:4250</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a2a1890787b3e55318c417c0a3e1432c7"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a2a1890787b3e55318c417c0a3e1432c7">END_OPTIONS</a></div><div class="ttdeci">#define END_OPTIONS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01344">include/asterisk/app.h:1344</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a5646e370e39cc29f5faa7a30fda11159"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a></div><div class="ttdeci">void stasis_message_router_unsubscribe(struct stasis_message_router *router)</div><div class="ttdoc">Unsubscribe the router from the upstream topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00258">stasis_message_router.c:258</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="structqueue__stasis__data_html"><div class="ttname"><a href="../../d3/d16/structqueue__stasis__data.html">queue_stasis_data</a></div><div class="ttdoc">User data for stasis subscriptions used for queue calls. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05957">app_queue.c:5957</a></div></div>
<div class="ttc" id="pbx_8h_html_af5a13a9ab5aac5bb61e4f98ae7e8d296"><div class="ttname"><a href="../../db/de0/pbx_8h.html#af5a13a9ab5aac5bb61e4f98ae7e8d296">pbx_substitute_variables_helper</a></div><div class="ttdeci">void pbx_substitute_variables_helper(struct ast_channel *c, const char *cp1, char *cp2, int count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db7/ael__main_8c_source.html#l00211">ael_main.c:211</a></div></div>
<div class="ttc" id="app__queue_8c_html_a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a17ad3ee98f5c431f437da1940c21c9e7a0ea0783c16992c83873a362e3e67af0b">MEMBER_RINGINUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01632">app_queue.c:1632</a></div></div>
<div class="ttc" id="astobj2_8h_html_a36591ec4147956994abd2c67dacba18f"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a36591ec4147956994abd2c67dacba18f">ao2_t_find</a></div><div class="ttdeci">#define ao2_t_find(container, arg, flags, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01754">astobj2.h:1754</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a82c1e40f3b210bce47d00d44dec0b8fd"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a82c1e40f3b210bce47d00d44dec0b8fd">OPT_CALLER_PARK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01335">app_queue.c:1335</a></div></div>
<div class="ttc" id="structmember_html_aa99dee44b85aa7057ed5bea20fa2bb52"><div class="ttname"><a href="../../d7/dd6/structmember.html#aa99dee44b85aa7057ed5bea20fa2bb52">member::state_context</a></div><div class="ttdeci">char state_context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01595">app_queue.c:1595</a></div></div>
<div class="ttc" id="structstrategy_html"><div class="ttname"><a href="../../d8/d51/structstrategy.html">strategy</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01405">app_queue.c:1405</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_aee5e20694b04eee43463fde6cf121d06"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#aee5e20694b04eee43463fde6cf121d06">ast_app_exec_sub</a></div><div class="ttdeci">int ast_app_exec_sub(struct ast_channel *autoservice_chan, struct ast_channel *sub_chan, const char *sub_args, int ignore_hangup)</div><div class="ttdoc">Run a subroutine on a channel, placing an optional second channel into autoservice. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l00370">main/app.c:370</a></div></div>
<div class="ttc" id="causes_8h_html"><div class="ttname"><a href="../../d4/da3/causes_8h.html">causes.h</a></div><div class="ttdoc">Internal Asterisk hangup causes. </div></div>
<div class="ttc" id="app__queue_8c_html_a1d03e640ed40f48f1cec61cac6d569ab"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a1d03e640ed40f48f1cec61cac6d569ab">pending_members_cmp</a></div><div class="ttdeci">static int pending_members_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02398">app_queue.c:2398</a></div></div>
<div class="ttc" id="channel_8h_html_a9abe31fe40dcd03cd2957e5309e32ac6"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a></div><div class="ttdeci">const char * ast_channel_language(const struct ast_channel *chan)</div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">include/asterisk/frame.h:280</a></div></div>
<div class="ttc" id="structcall__queue_html_a77bab4023f1969460cc9c64baa39e016"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a77bab4023f1969460cc9c64baa39e016">call_queue::leavewhenempty</a></div><div class="ttdeci">enum empty_conditions leavewhenempty</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01718">app_queue.c:1718</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3a9d07e60d74a39d3012cf728a0e75d91e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3a9d07e60d74a39d3012cf728a0e75d91e">OPT_DATA_QUALITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01328">app_queue.c:1328</a></div></div>
<div class="ttc" id="app__queue_8c_html_ade12aebf511dcd9862a12c4b25dc2216"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ade12aebf511dcd9862a12c4b25dc2216">use_weight</a></div><div class="ttdeci">static int use_weight</div><div class="ttdoc">Records that one or more queues use weight. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01469">app_queue.c:1469</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_abbca034b0a98715c687b808347af82a3a1ab15af464bf1838c9ca91d32ca7a2a1"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#abbca034b0a98715c687b808347af82a3a1ab15af464bf1838c9ca91d32ca7a2a1">RQ_UINTEGER2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00069">include/asterisk/config.h:69</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9be528c0673709889b09c11f2c0f77d2a7d363853794316b276622be186ead6f0"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9be528c0673709889b09c11f2c0f77d2a7d363853794316b276622be186ead6f0">QUEUE_CONTINUE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01503">app_queue.c:1503</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="structast__cli__args_html"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html">ast_cli_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00158">cli.h:158</a></div></div>
<div class="ttc" id="structqueue__ent_html_ae75d4fd9822187bfe2bfe55a75b7c6ef"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ae75d4fd9822187bfe2bfe55a75b7c6ef">queue_ent::qe_rules</a></div><div class="ttdeci">struct queue_ent::@67 qe_rules</div></div>
<div class="ttc" id="aoc_8h_html_aa7dc1e0987972e9eb92627a1190eb548a3cdee929459fa195eabd19f5c156c7ec"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548a3cdee929459fa195eabd19f5c156c7ec">AST_AOC_S</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00064">aoc.h:64</a></div></div>
<div class="ttc" id="app__queue_8c_html_adc1ece01a39a4297ac0369feaba4bcb6a6dd24d66d8fcdf0a3444d28ec9c82ba2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#adc1ece01a39a4297ac0369feaba4bcb6a6dd24d66d8fcdf0a3444d28ec9c82ba2">QUEUE_EMPTY_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01623">app_queue.c:1623</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a31312f6b6c2296e3495ad1d9e198cbf4"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a31312f6b6c2296e3495ad1d9e198cbf4">AST_OPTION_TONE_VERIFY</a></div><div class="ttdeci">#define AST_OPTION_TONE_VERIFY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00431">include/asterisk/frame.h:431</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3dcb3584df9f70680b14a8fb4d152e10"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3dcb3584df9f70680b14a8fb4d152e10">reload_single_queue</a></div><div class="ttdeci">static void reload_single_queue(struct ast_config *cfg, struct ast_flags *mask, const char *queuename)</div><div class="ttdoc">Reload information pertaining to a particular queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09383">app_queue.c:9383</a></div></div>
<div class="ttc" id="pbx_8h_html_ab077da615e93c9e88ce539bef23f82e6a2e89bd60b1752d920f58a70164607189"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ab077da615e93c9e88ce539bef23f82e6a2e89bd60b1752d920f58a70164607189">AST_HINT_UPDATE_DEVICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00091">pbx.h:91</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae72ca8d43e1d9acf1dbfcbc18c98a3ae"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae72ca8d43e1d9acf1dbfcbc18c98a3ae">RES_EXISTS</a></div><div class="ttdeci">#define RES_EXISTS</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01442">app_queue.c:1442</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3ab0eb8a377bf253cf368bf70f0b59fc31"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab0eb8a377bf253cf368bf70f0b59fc31">OPT_CALLEE_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01330">app_queue.c:1330</a></div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625fad62d357f0ccde2a718c374a0a4af2b98"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fad62d357f0ccde2a718c374a0a4af2b98">AST_EXTENSION_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00066">pbx.h:66</a></div></div>
<div class="ttc" id="structast__device__state__message_html"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html">ast_device_state_message</a></div><div class="ttdoc">The structure that contains device state. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00240">devicestate.h:240</a></div></div>
<div class="ttc" id="app__queue_8c_html_acb77c72db33e25dc53672af1b85526a4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acb77c72db33e25dc53672af1b85526a4">queue_agent_ringnoanswer_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_agent_ringnoanswer_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02145">app_queue.c:2145</a></div></div>
<div class="ttc" id="mixmonitor_8h_html"><div class="ttname"><a href="../../d9/d40/mixmonitor_8h.html">mixmonitor.h</a></div><div class="ttdoc">loadable MixMonitor functionality </div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="channel_8h_html_a582dee4d5ea9b2ff6f309f0c5239f6bd"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a></div><div class="ttdeci">const char * ast_channel_context(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00344">channel_internal_api.c:344</a></div></div>
<div class="ttc" id="term_8h_html"><div class="ttname"><a href="../../db/d45/term_8h.html">term.h</a></div><div class="ttdoc">Handy terminal functions for vt* terms. </div></div>
<div class="ttc" id="astdb_8h_html_a0f14f6bff4f412c88b50aba34d3a5e35"><div class="ttname"><a href="../../de/d4a/astdb_8h.html#a0f14f6bff4f412c88b50aba34d3a5e35">ast_db_put</a></div><div class="ttdeci">int ast_db_put(const char *family, const char *key, const char *value)</div><div class="ttdoc">Store value addressed by family/key. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d21/main_2db_8c_source.html#l00327">main/db.c:327</a></div></div>
<div class="ttc" id="structstasis__forward_html"><div class="ttname"><a href="../../d8/d54/structstasis__forward.html">stasis_forward</a></div><div class="ttdoc">Forwarding information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01531">stasis.c:1531</a></div></div>
<div class="ttc" id="app__queue_8c_html_a55c36f2f3daa5a20c2b2e8861112ac35"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a55c36f2f3daa5a20c2b2e8861112ac35">print_queue</a></div><div class="ttdeci">static void print_queue(struct mansession *s, int fd, struct call_queue *q)</div><div class="ttdoc">Print a single queue to AMI or the CLI. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09654">app_queue.c:9654</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9657c4f40f012fc1d426c3c94b3d32c0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a></div><div class="ttdeci">#define ao2_container_alloc_rbtree(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01358">astobj2.h:1358</a></div></div>
<div class="ttc" id="bridge__after_8h_html_abffcfc07534d569ab73f8fdb19a94677"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#abffcfc07534d569ab73f8fdb19a94677">ast_bridge_set_after_go_on</a></div><div class="ttdeci">void ast_bridge_set_after_go_on(struct ast_channel *chan, const char *context, const char *exten, int priority, const char *parseable_goto)</div><div class="ttdoc">Set channel to go on in the dialplan after the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00636">bridge_after.c:636</a></div></div>
<div class="ttc" id="structqueue__ent_html_af662104ad6f7bcab7c3e0cc4cb847fd7"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#af662104ad6f7bcab7c3e0cc4cb847fd7">queue_ent::next</a></div><div class="ttdeci">struct queue_ent * next</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01589">app_queue.c:1589</a></div></div>
<div class="ttc" id="aoc_8h_html_a34cb435b356514ce26df36a7bff4dfeb"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a34cb435b356514ce26df36a7bff4dfeb">ast_aoc_get_msg_type</a></div><div class="ttdeci">enum ast_aoc_type ast_aoc_get_msg_type(struct ast_aoc_decoded *decoded)</div><div class="ttdoc">get the message type, AOC-D, AOC-E, or AOC Request </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00892">aoc.c:892</a></div></div>
<div class="ttc" id="structcall__queue_html_afca2abcaa89f99883d526c469268bcf4"><div class="ttname"><a href="../../df/db5/structcall__queue.html#afca2abcaa89f99883d526c469268bcf4">call_queue::relativeperiodicannounce</a></div><div class="ttdeci">unsigned int relativeperiodicannounce</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01714">app_queue.c:1714</a></div></div>
<div class="ttc" id="app__queue_8c_html_acfa0c49ab441d6095ecaaf9bcdf72c04"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acfa0c49ab441d6095ecaaf9bcdf72c04">get_queue_member_status</a></div><div class="ttdeci">static int get_queue_member_status(struct member *cur)</div><div class="ttdoc">Return the current state of a member. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02671">app_queue.c:2671</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
<div class="ttc" id="structast__frame_html_a5ad776be1fb768f3399aafcd1b58b3a2"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a5ad776be1fb768f3399aafcd1b58b3a2">ast_frame::uint32</a></div><div class="ttdeci">uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="app__queue_8c_html_a88738ce65026cc83cafc0e6a96fe8cf9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a88738ce65026cc83cafc0e6a96fe8cf9">publish_queue_member_pause</a></div><div class="ttdeci">static int publish_queue_member_pause(struct call_queue *q, struct member *member)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07457">app_queue.c:7457</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="asterisk_8h_html_ae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00040">asterisk.h:40</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa03e5b6c636bd0625a52c367067ec906"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa03e5b6c636bd0625a52c367067ec906">pm_family</a></div><div class="ttdeci">static const char *const pm_family</div><div class="ttdoc">Persistent Members astdb family. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01463">app_queue.c:1463</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa4019656b705c76e4475a9e8fc0c4116"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa4019656b705c76e4475a9e8fc0c4116">queue_exec</a></div><div class="ttdeci">static int queue_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">The starting point for all queue calls. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08183">app_queue.c:8183</a></div></div>
<div class="ttc" id="app__queue_8c_html_ac483b545204943907eab26ae059e65dd"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac483b545204943907eab26ae059e65dd">RECHECK</a></div><div class="ttdeci">#define RECHECK</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01431">app_queue.c:1431</a></div></div>
<div class="ttc" id="app__queue_8c_html_a4a18e85dad5b206bccd39112cf9d0002"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a4a18e85dad5b206bccd39112cf9d0002">reload_queue_members</a></div><div class="ttdeci">static void reload_queue_members(void)</div><div class="ttdoc">Reload dynamic queue members persisted into the astdb. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07771">app_queue.c:7771</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3adb3ae0c7823e3bd3f4a45db3d03f33cb"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3adb3ae0c7823e3bd3f4a45db3d03f33cb">OPT_CALLER_TRANSFER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01340">app_queue.c:1340</a></div></div>
<div class="ttc" id="app__queue_8c_html_a45259088e42ad1164f934c4c20ba2bba"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a45259088e42ad1164f934c4c20ba2bba">queue_agent_cb</a></div><div class="ttdeci">static void queue_agent_cb(void *userdata, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05895">app_queue.c:5895</a></div></div>
<div class="ttc" id="structcall__queue_html_aa5a589c9dea9c88d7fea000ed1b8fc15"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aa5a589c9dea9c88d7fea000ed1b8fc15">call_queue::sound_minutes</a></div><div class="ttdeci">const ast_string_field sound_minutes</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="app__queue_8c_html_aaf4ff45b97c96176ab583091f47339c8"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aaf4ff45b97c96176ab583091f47339c8">remove_stasis_subscriptions</a></div><div class="ttdeci">static void remove_stasis_subscriptions(struct queue_stasis_data *queue_data)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06011">app_queue.c:6011</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9f81db529b7d97134601164c43a945f2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9f81db529b7d97134601164c43a945f2">queue_hash_cb</a></div><div class="ttdeci">static int queue_hash_cb(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01836">app_queue.c:1836</a></div></div>
<div class="ttc" id="structqueue__ent_html"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html">queue_ent</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01560">app_queue.c:1560</a></div></div>
<div class="ttc" id="structqueue__ent_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ac25ea00ee3f082df06e0cf468cbde240">queue_ent::context</a></div><div class="ttdeci">char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01564">app_queue.c:1564</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="app__queue_8c_html_a37f1ce6ab6c24242c99997e17ec4fc33"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a37f1ce6ab6c24242c99997e17ec4fc33">do_hang</a></div><div class="ttdeci">static void do_hang(struct callattempt *o)</div><div class="ttdoc">common hangup actions </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04358">app_queue.c:4358</a></div></div>
<div class="ttc" id="structcallattempt_html_a6babf4f66dfb83d62d08d3401f6e452b"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a6babf4f66dfb83d62d08d3401f6e452b">callattempt::call_next</a></div><div class="ttdeci">struct callattempt * call_next</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01539">app_queue.c:1539</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2ec48379febcdee77d6c659269714dd6"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2ec48379febcdee77d6c659269714dd6">manager_add_queue_member</a></div><div class="ttdeci">static int manager_add_queue_member(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10222">app_queue.c:10222</a></div></div>
<div class="ttc" id="app__queue_8c_html_ac66c7e437e2829c88f56aad3cc7cf508"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ac66c7e437e2829c88f56aad3cc7cf508">try_calling</a></div><div class="ttdeci">static int try_calling(struct queue_ent *qe, struct ast_flags opts, char **opt_args, char *announceoverride, const char *url, int *tries, int *noption, const char *agi, const char *macro, const char *gosub, int ringing)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06722">app_queue.c:6722</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="structcall__queue_html_a5b3b0db7403d11c5b32be0a53f4e4809"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a5b3b0db7403d11c5b32be0a53f4e4809">call_queue::queue_quantity2</a></div><div class="ttdeci">const ast_string_field queue_quantity2</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca61056b5855dc9921faa4f10a67b1a250">OBJ_SEARCH_MASK</a></div><div class="ttdoc">Search option field mask. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01076">astobj2.h:1076</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa76378a6ff09ce40268e214fdae6a61d"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa76378a6ff09ce40268e214fdae6a61d">init_queue</a></div><div class="ttdeci">static void init_queue(struct call_queue *q)</div><div class="ttdoc">Initialize Queue default values. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02769">app_queue.c:2769</a></div></div>
<div class="ttc" id="features_8h_html"><div class="ttname"><a href="../../de/d47/features_8h.html">features.h</a></div><div class="ttdoc">Call Parking and Pickup API Includes code and algorithms from the Zapata library. ...</div></div>
<div class="ttc" id="structqueue__ent_html_ab234be20f2e48f4f08d2d2c071b8ff55"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#ab234be20f2e48f4f08d2d2c071b8ff55">queue_ent::handled</a></div><div class="ttdeci">int handled</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01576">app_queue.c:1576</a></div></div>
<div class="ttc" id="structqueue__ent_html_a9edbd6d881ea6dd2b0b4d78c11723517"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#a9edbd6d881ea6dd2b0b4d78c11723517">queue_ent::cancel_answered_elsewhere</a></div><div class="ttdeci">int cancel_answered_elsewhere</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01585">app_queue.c:1585</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_aca036489931bf5571e2472331c8ac80b"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a></div><div class="ttdeci">#define AST_APP_OPTION(option, flagno)</div><div class="ttdoc">Declares an application option that does not accept an argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01402">include/asterisk/app.h:1402</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab37e1a4dafc93b1ded1edabe9927cf26"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab37e1a4dafc93b1ded1edabe9927cf26">ANNOUNCEHOLDTIME_ONCE</a></div><div class="ttdeci">#define ANNOUNCEHOLDTIME_ONCE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01637">app_queue.c:1637</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a83227c4f8c836f0452b607507c55752f"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a83227c4f8c836f0452b607507c55752f">AST_LIST_INSERT_BEFORE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_INSERT_BEFORE_CURRENT(elm, field)</div><div class="ttdoc">Inserts a list entry before the current entry during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00598">linkedlists.h:598</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab058e7cb09a0800bc35a1db2053de820"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab058e7cb09a0800bc35a1db2053de820">queue_function_queuewaitingcount</a></div><div class="ttdeci">static int queue_function_queuewaitingcount(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">Dialplan function QUEUE_WAITING_COUNT() Get number callers waiting in a specific queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08926">app_queue.c:8926</a></div></div>
<div class="ttc" id="stasis_8h_html_a2513a93567ddc93510f7896b777da119"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a></div><div class="ttdeci">struct stasis_forward * stasis_forward_all(struct stasis_topic *from_topic, struct stasis_topic *to_topic)</div><div class="ttdoc">Create a subscription which forwards all messages from one topic to another. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01578">stasis.c:1578</a></div></div>
<div class="ttc" id="pbx_8h_html_ab1d88f370509aae87302134e6f70628a"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ab1d88f370509aae87302134e6f70628a">ast_extension_state_add</a></div><div class="ttdeci">int ast_extension_state_add(const char *context, const char *exten, ast_state_cb_type change_cb, void *data)</div><div class="ttdoc">Add watcher for extension states. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l03825">pbx.c:3825</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2d8545a6eecf92b885f8880aaaf662d2"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2d8545a6eecf92b885f8880aaaf662d2">remove_from_queue</a></div><div class="ttdeci">static int remove_from_queue(const char *queuename, const char *interface)</div><div class="ttdoc">Remove member from queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07324">app_queue.c:7324</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3939bdf5f277fb14c688741f198a9e72"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3939bdf5f277fb14c688741f198a9e72">set_member_value</a></div><div class="ttdeci">static int set_member_value(const char *queuename, const char *interface, int property, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07674">app_queue.c:7674</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a88bee182f285c3e0b206c1de01324fc4"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a88bee182f285c3e0b206c1de01324fc4">ast_queue_topic</a></div><div class="ttdeci">struct stasis_topic * ast_queue_topic(const char *queuename)</div><div class="ttdoc">Get the Stasis Message Bus API topic for queue messages for a particular queue name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l03189">main/app.c:3189</a></div></div>
<div class="ttc" id="app__queue_8c_html_a531c35e38ede3ea4e5ba5afb24b29493a2896cd262bf3d0d9dc2c33f3e5a48ac0"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493a2896cd262bf3d0d9dc2c33f3e5a48ac0">OPT_ARG_PREDIAL_CALLEE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01351">app_queue.c:1351</a></div></div>
<div class="ttc" id="app__queue_8c_html_aab6f3afb06683e692b69f0e886c0bedb"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aab6f3afb06683e692b69f0e886c0bedb">handle_queue_reset</a></div><div class="ttdeci">static char * handle_queue_reset(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l11051">app_queue.c:11051</a></div></div>
<div class="ttc" id="structmember_html_a88ec6754dea8cb6d040f61a279b1c298"><div class="ttname"><a href="../../d7/dd6/structmember.html#a88ec6754dea8cb6d040f61a279b1c298">member::ringinuse</a></div><div class="ttdeci">unsigned int ringinuse</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01616">app_queue.c:1616</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5a980ba36a8d002f369930cbf8a9b595"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5a980ba36a8d002f369930cbf8a9b595">copy_rules</a></div><div class="ttdeci">static void copy_rules(struct queue_ent *qe, const char *rulename)</div><div class="ttdoc">Copy rule from global list into specified queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l08140">app_queue.c:8140</a></div></div>
<div class="ttc" id="res__config__ldap_8c_html_a75e4590043edf35241d30fabe2eda546"><div class="ttname"><a href="../../dc/d12/res__config__ldap_8c.html#a75e4590043edf35241d30fabe2eda546">url</a></div><div class="ttdeci">static char url[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d12/res__config__ldap_8c_source.html#l00074">res_config_ldap.c:74</a></div></div>
<div class="ttc" id="app__queue_8c_html_abed8e0f3934b58e838f035e19ebb05c3"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abed8e0f3934b58e838f035e19ebb05c3">queue_member_follower_removal</a></div><div class="ttdeci">static void queue_member_follower_removal(struct call_queue *queue, struct member *mem)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01905">app_queue.c:1905</a></div></div>
<div class="ttc" id="app__queue_8c_html_ada7cb973bbec700e3472e0cb9a240805"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ada7cb973bbec700e3472e0cb9a240805">queue_stasis_data_alloc</a></div><div class="ttdeci">static struct queue_stasis_data * queue_stasis_data_alloc(struct queue_ent *qe, struct ast_channel *peer, struct member *mem, time_t holdstart, time_t starttime, int callcompletedinsl)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06026">app_queue.c:6026</a></div></div>
<div class="ttc" id="pbx_8h_html_ad4a6912dcd2ad44a186d0a284afafc51"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ad4a6912dcd2ad44a186d0a284afafc51">pbx_findapp</a></div><div class="ttdeci">struct ast_app * pbx_findapp(const char *app)</div><div class="ttdoc">Look up an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db7/ael__main_8c_source.html#l00165">ael_main.c:165</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab7e251e9a467cda68d93a47184fe0727"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab7e251e9a467cda68d93a47184fe0727">ast_channel_hangup_request_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_hangup_request_type(void)</div><div class="ttdoc">Message type for when a hangup is requested on a channel. </div></div>
<div class="ttc" id="manager_8h_html_a5b63b8a8faede2d852e071e1f7b31c11"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a></div><div class="ttdeci">#define ast_manager_register_xml(action, authority, func)</div><div class="ttdoc">Register a manager callback using XML documentation to describe the manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00186">manager.h:186</a></div></div>
<div class="ttc" id="app__queue_8c_html_aa1efb798e09a88e68559b08c90c573ee"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#aa1efb798e09a88e68559b08c90c573ee">update_qe_rule</a></div><div class="ttdeci">static void update_qe_rule(struct queue_ent *qe)</div><div class="ttdoc">update rules for queues </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05536">app_queue.c:5536</a></div></div>
<div class="ttc" id="say_8h_html"><div class="ttname"><a href="../../db/dce/say_8h.html">say.h</a></div><div class="ttdoc">Say numbers and dates (maybe words one day too) </div></div>
<div class="ttc" id="app__queue_8c_html_ad7bfd042e07ab221f05374233ec2dcf6"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad7bfd042e07ab221f05374233ec2dcf6">autopausesmodes</a></div><div class="ttdeci">static const struct autopause autopausesmodes[]</div></div>
<div class="ttc" id="structpenalty__rule_html_a2b15eec5f0109b01f534046bb5c04666"><div class="ttname"><a href="../../d5/dd5/structpenalty__rule.html#a2b15eec5f0109b01f534046bb5c04666">penalty_rule::min_value</a></div><div class="ttdeci">int min_value</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01643">app_queue.c:1643</a></div></div>
<div class="ttc" id="structmember_html_a9a2af6e4da551e6d05da960a6f2432ab"><div class="ttname"><a href="../../d7/dd6/structmember.html#a9a2af6e4da551e6d05da960a6f2432ab">member::callcompletedinsl</a></div><div class="ttdeci">int callcompletedinsl</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01607">app_queue.c:1607</a></div></div>
<div class="ttc" id="module_8h_html_aba2c8d4be709a254658b21a834f8294a"><div class="ttname"><a href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a></div><div class="ttdeci">#define ASTERISK_GPL_KEY</div><div class="ttdoc">The text the key() function should return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00046">module.h:46</a></div></div>
<div class="ttc" id="structcallattempt_html_a1417a8e4a29d75f6e5e2d4ad52c22642"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a1417a8e4a29d75f6e5e2d4ad52c22642">callattempt::dial_callerid_absent</a></div><div class="ttdeci">unsigned int dial_callerid_absent</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01551">app_queue.c:1551</a></div></div>
<div class="ttc" id="structcall__queue_html_ab95f2fa73d00493b2fa1fc26eb37dc24"><div class="ttname"><a href="../../df/db5/structcall__queue.html#ab95f2fa73d00493b2fa1fc26eb37dc24">call_queue::joinempty</a></div><div class="ttdeci">enum empty_conditions joinempty</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01717">app_queue.c:1717</a></div></div>
<div class="ttc" id="channel_8h_html_ac7e42045272530c8678418993e75fd56"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a></div><div class="ttdeci">struct ast_channel * ast_channel_get_by_name(const char *name)</div><div class="ttdoc">Find a channel by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01454">channel.c:1454</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab8cbb9ecaec149b8f265951980818cfc"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab8cbb9ecaec149b8f265951980818cfc">handle_queue_set_member_penalty</a></div><div class="ttdeci">static char * handle_queue_set_member_penalty(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10953">app_queue.c:10953</a></div></div>
<div class="ttc" id="cli_8h_html_a7cc1753a05a0821f6c70dd2bccfbab5c"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a></div><div class="ttdeci">#define RESULT_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00040">cli.h:40</a></div></div>
<div class="ttc" id="structcallattempt_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a84d1435c5b8d387806714ea7079304b7">callattempt::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01540">app_queue.c:1540</a></div></div>
<div class="ttc" id="structcall__queue_html_aad352c7fad0be66a9c20e717239b488d"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aad352c7fad0be66a9c20e717239b488d">call_queue::queue_quantity1</a></div><div class="ttdeci">const ast_string_field queue_quantity1</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a414b69d7583bb4cfc6daf5276aac6d14"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a414b69d7583bb4cfc6daf5276aac6d14">connected</a></div><div class="ttdeci">char connected</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00082">eagi_proxy.c:82</a></div></div>
<div class="ttc" id="module_8h_html"><div class="ttname"><a href="../../d5/d16/module_8h.html">module.h</a></div><div class="ttdoc">Asterisk module definitions. </div></div>
<div class="ttc" id="term_8h_html_a928e144dbbe4316dbb854245c7e38de7"><div class="ttname"><a href="../../db/d45/term_8h.html#a928e144dbbe4316dbb854245c7e38de7">COLOR_BROWN</a></div><div class="ttdeci">#define COLOR_BROWN</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/term_8h_source.html#l00053">term.h:53</a></div></div>
<div class="ttc" id="app__queue_8c_html_ab294d279fc57c00a43df3d8783e10dcf"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ab294d279fc57c00a43df3d8783e10dcf">manager_pause_queue_member</a></div><div class="ttdeci">static int manager_pause_queue_member(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10333">app_queue.c:10333</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3ee5f9b7ec29ebb95c4e1ac00fafde83"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3ee5f9b7ec29ebb95c4e1ac00fafde83">setup_mixmonitor</a></div><div class="ttdeci">static void setup_mixmonitor(struct queue_ent *qe, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l06648">app_queue.c:6648</a></div></div>
<div class="ttc" id="app__queue_8c_html_a09df986cff00524f91c16051486231ec"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a09df986cff00524f91c16051486231ec">is_our_turn</a></div><div class="ttdeci">static int is_our_turn(struct queue_ent *qe)</div><div class="ttdoc">Check if we should start attempting to call queue members. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l05487">app_queue.c:5487</a></div></div>
<div class="ttc" id="app__queue_8c_html_a677f1c4c1a61e9e02d180803d8b8a008"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a677f1c4c1a61e9e02d180803d8b8a008">queues_t_unlink</a></div><div class="ttdeci">#define queues_t_unlink(c, q, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01923">app_queue.c:1923</a></div></div>
<div class="ttc" id="json_8h_html_ad20fdcbab1ed5c078284a687cced2877"><div class="ttname"><a href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a></div><div class="ttdeci">intmax_t ast_json_integer_get(const struct ast_json *integer)</div><div class="ttdoc">Get the value from a JSON integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00322">json.c:322</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga793b849e5b7c9257e92fe30621de5b74"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga793b849e5b7c9257e92fe30621de5b74">ast_channel_masquerade_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_masquerade_type(void)</div><div class="ttdoc">Message type for when a channel is being masqueraded. </div></div>
<div class="ttc" id="app__queue_8c_html_ace475b3c63f137d8ff9af0e10d4f5e97"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ace475b3c63f137d8ff9af0e10d4f5e97">device_state_sub</a></div><div class="ttdeci">static struct stasis_subscription * device_state_sub</div><div class="ttdoc">Subscription to device state change messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01484">app_queue.c:1484</a></div></div>
<div class="ttc" id="app__queue_8c_html_a58c9d0c9d53acc38bcb44fc1426d853f"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a58c9d0c9d53acc38bcb44fc1426d853f">queue_agent_connect_to_ami</a></div><div class="ttdeci">static struct ast_manager_event_blob * queue_agent_connect_to_ami(struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02130">app_queue.c:2130</a></div></div>
<div class="ttc" id="app__queue_8c_html_ae3f91b4dcac991435b8341363b37e54e"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ae3f91b4dcac991435b8341363b37e54e">kill_if_unfound</a></div><div class="ttdeci">static int kill_if_unfound(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09516">app_queue.c:9516</a></div></div>
<div class="ttc" id="structcall__queue_html_a98ff2e1b2bd8da1b71bb907198595e53"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a98ff2e1b2bd8da1b71bb907198595e53">call_queue::callscompleted</a></div><div class="ttdeci">int callscompleted</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01728">app_queue.c:1728</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00057">devicestate.h:57</a></div></div>
<div class="ttc" id="app__queue_8c_html_a4df5a56907979a04a511007899753456"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a4df5a56907979a04a511007899753456">valid_exit</a></div><div class="ttdeci">static int valid_exit(struct queue_ent *qe, char digit)</div><div class="ttdoc">Check for valid exit from queue via goto. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l03945">app_queue.c:3945</a></div></div>
<div class="ttc" id="app__queue_8c_html_a8f2df6113ce7f6858cc4e533d6f0f4bf"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8f2df6113ce7f6858cc4e533d6f0f4bf">shared_lastcall</a></div><div class="ttdeci">static int shared_lastcall</div><div class="ttdoc">queues.conf [general] option </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01478">app_queue.c:1478</a></div></div>
<div class="ttc" id="astdb_8h_html"><div class="ttname"><a href="../../de/d4a/astdb_8h.html">astdb.h</a></div><div class="ttdoc">Persistant data storage (akin to *doze registry) </div></div>
<div class="ttc" id="app__queue_8c_html_a8cd08f19554c293e7455c33b6b225d0a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a8cd08f19554c293e7455c33b6b225d0a">handle_queue_pause_member</a></div><div class="ttdeci">static char * handle_queue_pause_member(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10818">app_queue.c:10818</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a80cd3f6f786b59b742bcecfc0b3be7c2"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a></div><div class="ttdeci">#define AST_DECLARE_APP_ARGS(name, arglist)</div><div class="ttdoc">Declare a structure to hold an application&amp;#39;s arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01249">include/asterisk/app.h:1249</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html">app.h</a></div><div class="ttdoc">Application convenience functions, designed to give consistent look and feel to Asterisk apps...</div></div>
<div class="ttc" id="structcall__queue_html_aad8539031f4bacde568540c592b07945"><div class="ttname"><a href="../../df/db5/structcall__queue.html#aad8539031f4bacde568540c592b07945">call_queue::rules</a></div><div class="ttdeci">struct call_queue::@70 rules</div></div>
<div class="ttc" id="structcall__queue_html_a152370dd0464215e2573e744665cbe1a"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a152370dd0464215e2573e744665cbe1a">call_queue::sound_callerannounce</a></div><div class="ttdeci">const ast_string_field sound_callerannounce</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01696">app_queue.c:1696</a></div></div>
<div class="ttc" id="structcall__queue_html_a158e72e504d11a5f6cdfa8d25343adbb"><div class="ttname"><a href="../../df/db5/structcall__queue.html#a158e72e504d11a5f6cdfa8d25343adbb">call_queue::announcefrequency</a></div><div class="ttdeci">int announcefrequency</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01720">app_queue.c:1720</a></div></div>
<div class="ttc" id="app__queue_8c_html_a936023f0e0bee9641dac365079c9cd00"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a936023f0e0bee9641dac365079c9cd00">AO2_STRING_FIELD_SORT_FN</a></div><div class="ttdeci">AO2_STRING_FIELD_SORT_FN(call_queue, name)</div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="structast__blind__transfer__message_html_abd45d96954fe74af9e011742ce09882d"><div class="ttname"><a href="../../d1/dbf/structast__blind__transfer__message.html#abd45d96954fe74af9e011742ce09882d">ast_blind_transfer_message::result</a></div><div class="ttdeci">enum ast_transfer_result result</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d4e/stasis__bridges_8h_source.html#l00251">stasis_bridges.h:251</a></div></div>
<div class="ttc" id="channel_8h_html_af5dee96d4dcc88a95fce391c22d4d21f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af5dee96d4dcc88a95fce391c22d4d21f">ast_channel_tech</a></div><div class="ttdeci">const struct ast_channel_tech * ast_channel_tech(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00769">channel_internal_api.c:769</a></div></div>
<div class="ttc" id="app__queue_8c_html_a96a36b017bb210c4a0ee72163d7d6baa"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a96a36b017bb210c4a0ee72163d7d6baa">app_upqm</a></div><div class="ttdeci">static char * app_upqm</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01456">app_queue.c:1456</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_abbca034b0a98715c687b808347af82a3a7b4a9e81298a296d3e066ed369727cc4"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#abbca034b0a98715c687b808347af82a3a7b4a9e81298a296d3e066ed369727cc4">RQ_INTEGER1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00066">include/asterisk/config.h:66</a></div></div>
<div class="ttc" id="app__queue_8c_html_afd9e966fe2ccc284fbe37cc5acd60f17"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#afd9e966fe2ccc284fbe37cc5acd60f17">set_member_penalty_help_members</a></div><div class="ttdeci">static int set_member_penalty_help_members(struct call_queue *q, const char *interface, int penalty)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07584">app_queue.c:7584</a></div></div>
<div class="ttc" id="app__queue_8c_html_abbeea50ec5fd219991763c7a848464ea"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#abbeea50ec5fd219991763c7a848464ea">manager_remove_queue_member</a></div><div class="ttdeci">static int manager_remove_queue_member(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l10286">app_queue.c:10286</a></div></div>
<div class="ttc" id="pbx_8h_html_a8af0e93442a9e468425f63cc52b0ac7b"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a></div><div class="ttdeci">#define ast_custom_function_register(acf)</div><div class="ttdoc">Register a custom function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l01508">pbx.h:1508</a></div></div>
<div class="ttc" id="app__queue_8c_html_a531c35e38ede3ea4e5ba5afb24b29493ae98734a2a20c3c7367ba5d8835378f60"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a531c35e38ede3ea4e5ba5afb24b29493ae98734a2a20c3c7367ba5d8835378f60">OPT_ARG_PREDIAL_CALLER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01352">app_queue.c:1352</a></div></div>
<div class="ttc" id="structmember_html_a33479a2976f279910df62bda3a3df62d"><div class="ttname"><a href="../../d7/dd6/structmember.html#a33479a2976f279910df62bda3a3df62d">member::lastcall</a></div><div class="ttdeci">time_t lastcall</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01610">app_queue.c:1610</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3ae363b1e6b1f2fcb5536719a640aa9dd9"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ae363b1e6b1f2fcb5536719a640aa9dd9">OPT_RING_WHEN_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01338">app_queue.c:1338</a></div></div>
<div class="ttc" id="structcallattempt_html_a8944c87b7a9a71b8c0ae6c2b76d9ae37"><div class="ttname"><a href="../../dd/dc6/structcallattempt.html#a8944c87b7a9a71b8c0ae6c2b76d9ae37">callattempt::stillgoing</a></div><div class="ttdeci">unsigned int stillgoing</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01553">app_queue.c:1553</a></div></div>
<div class="ttc" id="channel_8h_html_ac967e3cfb7640aa743eb1c4811d46be0"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac967e3cfb7640aa743eb1c4811d46be0">ast_channel_macroexten</a></div><div class="ttdeci">const char * ast_channel_macroexten(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00370">channel_internal_api.c:370</a></div></div>
<div class="ttc" id="structqueue__ent_html_aa774cd5d9be3c23ac43ab1798f437339"><div class="ttname"><a href="../../dc/d79/structqueue__ent.html#aa774cd5d9be3c23ac43ab1798f437339">queue_ent::announce</a></div><div class="ttdeci">char announce[PATH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01563">app_queue.c:1563</a></div></div>
<div class="ttc" id="app__queue_8c_html_a792b5d8a5231db2f05b08bd73d318ea5"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a792b5d8a5231db2f05b08bd73d318ea5">int2strat</a></div><div class="ttdeci">static const char * int2strat(int strategy)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01787">app_queue.c:1787</a></div></div>
<div class="ttc" id="channel_8h_html_a4d7d602ffd3240a3deed5f01343ccd31"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4d7d602ffd3240a3deed5f01343ccd31">ast_channel_data_set</a></div><div class="ttdeci">void ast_channel_data_set(struct ast_channel *chan, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00338">channel_internal_api.c:338</a></div></div>
<div class="ttc" id="app__queue_8c_html_ad6687a49016ace40e5834f697417268a"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#ad6687a49016ace40e5834f697417268a">add_to_queue</a></div><div class="ttdeci">static int add_to_queue(const char *queuename, const char *interface, const char *membername, int penalty, int paused, int dump, const char *state_interface, const char *reason_paused, int wrapuptime)</div><div class="ttdoc">Add member to queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07377">app_queue.c:7377</a></div></div>
<div class="ttc" id="file_8h_html_a3092bf11d4bba66f646562759608b1bc"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a3092bf11d4bba66f646562759608b1bc">ast_stopstream</a></div><div class="ttdeci">int ast_stopstream(struct ast_channel *c)</div><div class="ttdoc">Stops a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00187">file.c:187</a></div></div>
<div class="ttc" id="module_8h_html_afba4eb7a910b10969041ae4cd488729d"><div class="ttname"><a href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a></div><div class="ttdeci">#define ast_register_application_xml(app, execute)</div><div class="ttdoc">Register an application using XML documentation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00626">module.h:626</a></div></div>
<div class="ttc" id="app__queue_8c_html_a24b4217999f5510710cabfc8a8bc8c07"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a24b4217999f5510710cabfc8a8bc8c07">queue_persistent_members</a></div><div class="ttdeci">static int queue_persistent_members</div><div class="ttdoc">queues.conf [general] option </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01466">app_queue.c:1466</a></div></div>
<div class="ttc" id="app__queue_8c_html_a3d172953bea29dc16fe1596eca35b186"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a3d172953bea29dc16fe1596eca35b186">reload_queues</a></div><div class="ttdeci">static int reload_queues(int reload, struct ast_flags *mask, const char *queuename)</div><div class="ttdoc">reload the queues.conf file </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09540">app_queue.c:9540</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafe90e356833a3ec8ba6020a39d0689b9"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafe90e356833a3ec8ba6020a39d0689b9">ast_multi_channel_blob_create</a></div><div class="ttdeci">struct ast_multi_channel_blob * ast_multi_channel_blob_create(struct ast_json *blob)</div><div class="ttdoc">Create a ast_multi_channel_blob suitable for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00881">stasis_channels.c:881</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">include/asterisk/frame.h:285</a></div></div>
<div class="ttc" id="channel_8h_html_af6f0b2102f29f86914e10a7787f0d536"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af6f0b2102f29f86914e10a7787f0d536">ast_party_redirecting_copy</a></div><div class="ttdeci">void ast_party_redirecting_copy(struct ast_party_redirecting *dest, const struct ast_party_redirecting *src)</div><div class="ttdoc">Copy the source redirecting information to the destination redirecting. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02135">channel.c:2135</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5b08d861378519df1563080cc0e22fd4"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5b08d861378519df1563080cc0e22fd4">complete_queue_show</a></div><div class="ttdeci">static char * complete_queue_show(const char *line, const char *word, int pos, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09966">app_queue.c:9966</a></div></div>
<div class="ttc" id="cli_8h_html_aea87ce97f86effb2c4df6274d4aac567"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea87ce97f86effb2c4df6274d4aac567">RESULT_FAILURE</a></div><div class="ttdeci">#define RESULT_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00042">cli.h:42</a></div></div>
<div class="ttc" id="strings_8h_html_ab08f8db2a7258e538a0da7417f58db58"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ab08f8db2a7258e538a0da7417f58db58">ast_str_case_hash</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_case_hash(const char *str)</div><div class="ttdoc">Compute a hash value on a case-insensitive string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01250">strings.h:1250</a></div></div>
<div class="ttc" id="app__queue_8c_html_a2f80701c36e79c0640d91c788feee0b3ab61ce333627051f88077d9b6d7fb2e06"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a2f80701c36e79c0640d91c788feee0b3ab61ce333627051f88077d9b6d7fb2e06">OPT_CALLER_AUTOMIXMON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01342">app_queue.c:1342</a></div></div>
<div class="ttc" id="app__queue_8c_html_a97708d329e8643860a9f82eafcd5a4ff"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a97708d329e8643860a9f82eafcd5a4ff">clear_stats</a></div><div class="ttdeci">static int clear_stats(const char *queuename)</div><div class="ttdoc">Facilitates resetting statistics for a queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l09597">app_queue.c:9597</a></div></div>
<div class="ttc" id="app__queue_8c_html_af0efe7e816fe1c82ebac5d82a3218b31"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#af0efe7e816fe1c82ebac5d82a3218b31">ring_one</a></div><div class="ttdeci">static int ring_one(struct queue_ent *qe, struct callattempt *outgoing, int *busies)</div><div class="ttdoc">Place a call to a queue member. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l04639">app_queue.c:4639</a></div></div>
<div class="ttc" id="app__queue_8c_html_afb324be239736414e8949fdfcd7890c0"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#afb324be239736414e8949fdfcd7890c0">queue_publish_member_blob</a></div><div class="ttdeci">static void queue_publish_member_blob(struct stasis_message_type *type, struct ast_json *blob)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02234">app_queue.c:2234</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
<div class="ttc" id="structmember_html_a9f02557f5018cc21b0afc193f8d34cfd"><div class="ttname"><a href="../../d7/dd6/structmember.html#a9f02557f5018cc21b0afc193f8d34cfd">member::state_exten</a></div><div class="ttdeci">char state_exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01594">app_queue.c:1594</a></div></div>
<div class="ttc" id="term_8h_html_a8deb0beccea721b35bdb1b4f7264fe75"><div class="ttname"><a href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a></div><div class="ttdeci">#define COLOR_MAGENTA</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/term_8h_source.html#l00057">term.h:57</a></div></div>
<div class="ttc" id="structast__channel__snapshot__base_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../d6/d29/structast__channel__snapshot__base.html#ace9168767fc3707cf5f0a7d049682ba3">ast_channel_snapshot_base::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00112">stasis_channels.h:112</a></div></div>
<div class="ttc" id="channel_8h_html_a7176c4ba1352462039ef63412f425b00"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7176c4ba1352462039ef63412f425b00">ast_channel_redirecting_macro</a></div><div class="ttdeci">int ast_channel_redirecting_macro(struct ast_channel *autoservice_chan, struct ast_channel *macro_chan, const void *redirecting_info, int is_caller, int is_frame)</div><div class="ttdoc">Run a redirecting interception macro and update a channel&amp;#39;s redirecting information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10487">channel.c:10487</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="codecs_2gsm_2inc_2private_8h_html_a0b023cbb2bf7d034c2269d58d7455ac8"><div class="ttname"><a href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a></div><div class="ttdeci">short word</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da0/codecs_2gsm_2inc_2private_8h_source.html#l00012">codecs/gsm/inc/private.h:12</a></div></div>
<div class="ttc" id="structast__db__entry_html_a5892a9181e6a332f84d27aecd41dcd12"><div class="ttname"><a href="../../da/d1d/structast__db__entry.html#a5892a9181e6a332f84d27aecd41dcd12">ast_db_entry::key</a></div><div class="ttdeci">char * key</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4a/astdb_8h_source.html#l00033">astdb.h:33</a></div></div>
<div class="ttc" id="pbx_8h_html_a7e545df4a5f38ef25616c7bdf55d625fa47e9214860b5f9b887945f7cd1baec1a"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a7e545df4a5f38ef25616c7bdf55d625fa47e9214860b5f9b887945f7cd1baec1a">AST_EXTENSION_INUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00065">pbx.h:65</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a037e9a5b28477b17e7c9acbe7ecb21d5"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a></div><div class="ttdeci">#define AST_APP_ARG(name)</div><div class="ttdoc">Define an application argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01232">include/asterisk/app.h:1232</a></div></div>
<div class="ttc" id="structstrategy_html_acc89aafdc65ecd15f010b7c6fc295522"><div class="ttname"><a href="../../d8/d51/structstrategy.html#acc89aafdc65ecd15f010b7c6fc295522">strategy::strategy</a></div><div class="ttdeci">int strategy</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01406">app_queue.c:1406</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
<div class="ttc" id="app__queue_8c_html_a61e1b2c0b46092bc326d39def24be4f8"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a61e1b2c0b46092bc326d39def24be4f8">load_realtime_rules</a></div><div class="ttdeci">static int load_realtime_rules(void)</div><div class="ttdoc">Load queue rules from realtime. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02999">app_queue.c:2999</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">include/asterisk/config.h:43</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
<div class="ttc" id="app__queue_8c_html_a4fe68b376a679a230a33d09423e76b15"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a4fe68b376a679a230a33d09423e76b15">is_member_available</a></div><div class="ttdeci">static int is_member_available(struct call_queue *q, struct member *mem)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l02468">app_queue.c:2468</a></div></div>
<div class="ttc" id="structstrategy_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d8/d51/structstrategy.html#a8f8f80d37794cde9472343e4487ba3eb">strategy::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01407">app_queue.c:1407</a></div></div>
<div class="ttc" id="app__queue_8c_html_a9861344280a3db982c67cd1f6de89d2b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a9861344280a3db982c67cd1f6de89d2b">set_queue_member_pause</a></div><div class="ttdeci">static void set_queue_member_pause(struct call_queue *q, struct member *mem, const char *reason, int paused)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l07483">app_queue.c:7483</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:43:03 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
