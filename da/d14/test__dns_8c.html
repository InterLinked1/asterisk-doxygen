<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: test_dns.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_59425e443f801f1f2fd8bbe4959a3ccf.html">tests</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">test_dns.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;arpa/nameser.h&gt;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d51/dns__core_8h_source.html">asterisk/dns_core.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/da7/dns__resolver_8h_source.html">asterisk/dns_resolver.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d07/dns__internal_8h_source.html">asterisk/dns_internal.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test_dns.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/dc7/test__dns_8c__incl.png" border="0" usemap="#test__dns_8c" alt=""/></div>
<map name="test__dns_8c" id="test__dns_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="993,162,1077,189"/>
<area shape="rect" id="node24" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="1209,80,1322,107"/>
<area shape="rect" id="node30" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1709,162,1845,189"/>
<area shape="rect" id="node31" href="../../d6/d51/dns__core_8h.html" title="Core DNS API. " alt="" coords="1729,80,1876,107"/>
<area shape="rect" id="node35" href="../../d9/da7/dns__resolver_8h.html" title="DNS Resolver API. " alt="" coords="2161,80,2329,107"/>
<area shape="rect" id="node36" href="../../d4/d07/dns__internal_8h.html" title="Internal DNS structure definitions. " alt="" coords="1487,80,1654,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="364,244,519,271"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="905,244,1042,271"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="1066,244,1201,271"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="5,319,152,345"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="177,319,319,345"/>
<area shape="rect" id="node25" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="1215,162,1316,189"/>
<area shape="rect" id="node27" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1388,244,1519,271"/>
<area shape="rect" id="node26" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1543,244,1694,271"/>
<area shape="rect" id="node28" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1593,319,1708,345"/>
<area shape="rect" id="node29" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1775,393,1902,420"/>
<area shape="rect" id="node32" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="1869,162,2016,189"/>
<area shape="rect" id="node37" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="1507,162,1634,189"/>
<area shape="rect" id="node38" href="../../d7/d38/dns__query__set_8h.html" title="DNS Query Set API. " alt="" coords="1341,155,1483,196"/>
</map>
</div>
</div>
<p><a href="../../da/d14/test__dns_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data used by async result callback.  <a href="../../dd/d15/structasync__resolution__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d4e/structresolver__data.html">resolver_data</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">File-scoped data used during resolver tests.  <a href="../../d3/d4e/structresolver__data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afc97a77c6a0610ac45975194f89a1e96"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>&#160;&#160;&#160;&quot;Grumble Grumble&quot;</td></tr>
<tr class="separator:afc97a77c6a0610ac45975194f89a1e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31888cf993f4e4e7afbec462ea65e6fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>&#160;&#160;&#160;strlen(<a class="el" href="../../d5/d36/test__dns__recurring_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>)</td></tr>
<tr class="separator:a31888cf993f4e4e7afbec462ea65e6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6b0829d47d5b8f1d40ef884de3ec249"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#af6b0829d47d5b8f1d40ef884de3ec249">AST_TEST_DEFINE</a> (resolver_register_unregister)</td></tr>
<tr class="separator:af6b0829d47d5b8f1d40ef884de3ec249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1f95894e4ce32763e97cc2b29bcbdf7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ae1f95894e4ce32763e97cc2b29bcbdf7">AST_TEST_DEFINE</a> (resolver_register_off_nominal)</td></tr>
<tr class="separator:ae1f95894e4ce32763e97cc2b29bcbdf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a179971d4d3fb5ce659f199238a90a218"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a179971d4d3fb5ce659f199238a90a218">AST_TEST_DEFINE</a> (resolver_unregister_off_nominal)</td></tr>
<tr class="separator:a179971d4d3fb5ce659f199238a90a218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862094b4249aaa00b6a1446731e8c17f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a862094b4249aaa00b6a1446731e8c17f">AST_TEST_DEFINE</a> (<a class="el" href="../../d3/d4e/structresolver__data.html">resolver_data</a>)</td></tr>
<tr class="separator:a862094b4249aaa00b6a1446731e8c17f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac60e6425c7a14b485ceafaf7545dc8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#aac60e6425c7a14b485ceafaf7545dc8c">AST_TEST_DEFINE</a> (resolver_set_result)</td></tr>
<tr class="separator:aac60e6425c7a14b485ceafaf7545dc8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8048af6bc60559ce43334f0e37523b34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a8048af6bc60559ce43334f0e37523b34">AST_TEST_DEFINE</a> (resolver_set_result_off_nominal)</td></tr>
<tr class="separator:a8048af6bc60559ce43334f0e37523b34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c165aee454f16925835183818bbf39f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a3c165aee454f16925835183818bbf39f">AST_TEST_DEFINE</a> (resolver_add_record)</td></tr>
<tr class="separator:a3c165aee454f16925835183818bbf39f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afee0718d414509b97cf3f22b533d1cce"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#afee0718d414509b97cf3f22b533d1cce">AST_TEST_DEFINE</a> (resolver_add_record_off_nominal)</td></tr>
<tr class="separator:afee0718d414509b97cf3f22b533d1cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42ad7ecfbdeb22a720d317d20d7056ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a42ad7ecfbdeb22a720d317d20d7056ba">AST_TEST_DEFINE</a> (resolver_resolve_sync)</td></tr>
<tr class="separator:a42ad7ecfbdeb22a720d317d20d7056ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48dd7232c8fd23f9b5119d8c55270dcb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a48dd7232c8fd23f9b5119d8c55270dcb">AST_TEST_DEFINE</a> (resolver_resolve_sync_off_nominal)</td></tr>
<tr class="separator:a48dd7232c8fd23f9b5119d8c55270dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f353983d2cd40012be45676c15feb35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a0f353983d2cd40012be45676c15feb35">AST_TEST_DEFINE</a> (resolver_resolve_async)</td></tr>
<tr class="separator:a0f353983d2cd40012be45676c15feb35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abfd705374e5ab643d3e3c6702d56e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a5abfd705374e5ab643d3e3c6702d56e5">AST_TEST_DEFINE</a> (resolver_resolve_async_off_nominal)</td></tr>
<tr class="separator:a5abfd705374e5ab643d3e3c6702d56e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa46614cc1dd1e12abaabcacff278487d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#aa46614cc1dd1e12abaabcacff278487d">AST_TEST_DEFINE</a> (resolver_resolve_async_cancel)</td></tr>
<tr class="separator:aa46614cc1dd1e12abaabcacff278487d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed3c37596cb5a728433115e6d427b92d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#aed3c37596cb5a728433115e6d427b92d">async_callback</a> (const struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query)</td></tr>
<tr class="memdesc:aed3c37596cb5a728433115e6d427b92d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Async DNS callback.  <a href="#aed3c37596cb5a728433115e6d427b92d">More...</a><br /></td></tr>
<tr class="separator:aed3c37596cb5a728433115e6d427b92d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7f1e6c33538ed73025433d963601b68"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#aa7f1e6c33538ed73025433d963601b68">async_data_alloc</a> (void)</td></tr>
<tr class="memdesc:aa7f1e6c33538ed73025433d963601b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocation/initialization for <a class="el" href="../../dd/d15/structasync__resolution__data.html" title="Data used by async result callback. ">async_resolution_data</a>.  <a href="#aa7f1e6c33538ed73025433d963601b68">More...</a><br /></td></tr>
<tr class="separator:aa7f1e6c33538ed73025433d963601b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab517f9e6e55d67b8b83c861ef8cfacc9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ab517f9e6e55d67b8b83c861ef8cfacc9">async_data_destructor</a> (void *obj)</td></tr>
<tr class="memdesc:ab517f9e6e55d67b8b83c861ef8cfacc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for <a class="el" href="../../dd/d15/structasync__resolution__data.html" title="Data used by async result callback. ">async_resolution_data</a>.  <a href="#ab517f9e6e55d67b8b83c861ef8cfacc9">More...</a><br /></td></tr>
<tr class="separator:ab517f9e6e55d67b8b83c861ef8cfacc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9d18ca4fc298a6c1590a3b76c092aab"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#af9d18ca4fc298a6c1590a3b76c092aab">fail_resolve</a> (struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query)</td></tr>
<tr class="memdesc:af9d18ca4fc298a6c1590a3b76c092aab"><td class="mdescLeft">&#160;</td><td class="mdescRight">A resolve() method that simply fails.  <a href="#af9d18ca4fc298a6c1590a3b76c092aab">More...</a><br /></td></tr>
<tr class="separator:af9d18ca4fc298a6c1590a3b76c092aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2607b002d7ef2ee9587fc97f431dda66"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a2607b002d7ef2ee9587fc97f431dda66">resolution_thread</a> (void *dns_query)</td></tr>
<tr class="memdesc:a2607b002d7ef2ee9587fc97f431dda66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread spawned by the mock resolver.  <a href="#a2607b002d7ef2ee9587fc97f431dda66">More...</a><br /></td></tr>
<tr class="separator:a2607b002d7ef2ee9587fc97f431dda66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d40e3200575a80d2ab6ed5ae1efdaa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a66d40e3200575a80d2ab6ed5ae1efdaa">resolver_data_cleanup</a> (void)</td></tr>
<tr class="memdesc:a66d40e3200575a80d2ab6ed5ae1efdaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleanup global mock resolver data.  <a href="#a66d40e3200575a80d2ab6ed5ae1efdaa">More...</a><br /></td></tr>
<tr class="separator:a66d40e3200575a80d2ab6ed5ae1efdaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab741e73a3fcaafba5724cb28bf7aece4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ab741e73a3fcaafba5724cb28bf7aece4">resolver_data_init</a> (void)</td></tr>
<tr class="memdesc:ab741e73a3fcaafba5724cb28bf7aece4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize global mock resolver data.  <a href="#ab741e73a3fcaafba5724cb28bf7aece4">More...</a><br /></td></tr>
<tr class="separator:ab741e73a3fcaafba5724cb28bf7aece4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9297cc5991195f91e0753ab66e8ea1c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a9297cc5991195f91e0753ab66e8ea1c4">stub_callback</a> (const struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query)</td></tr>
<tr class="separator:a9297cc5991195f91e0753ab66e8ea1c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f41ce4b5edac703c91c6aa4aba14a5d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a> (struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query)</td></tr>
<tr class="separator:a5f41ce4b5edac703c91c6aa4aba14a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac9da5d3ada597ee3f5dc8372baf1f6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a> (struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query)</td></tr>
<tr class="separator:a0ac9da5d3ada597ee3f5dc8372baf1f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e0c6a990cc94182afa0b73202a7c17"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a70e0c6a990cc94182afa0b73202a7c17">test_cancel</a> (struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query)</td></tr>
<tr class="memdesc:a70e0c6a990cc94182afa0b73202a7c17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mock resolver's cancel method.  <a href="#a70e0c6a990cc94182afa0b73202a7c17">More...</a><br /></td></tr>
<tr class="separator:a70e0c6a990cc94182afa0b73202a7c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea83082d294e18cd3ef8a4972ebfd322"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#aea83082d294e18cd3ef8a4972ebfd322">test_record</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record, int rr_type, int rr_class, int ttl, const char *data, const size_t size)</td></tr>
<tr class="separator:aea83082d294e18cd3ef8a4972ebfd322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75adcbb156f9eb67c5d5f044b3d7f20c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a75adcbb156f9eb67c5d5f044b3d7f20c">test_resolve</a> (struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query)</td></tr>
<tr class="memdesc:a75adcbb156f9eb67c5d5f044b3d7f20c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mock resolver's resolve method.  <a href="#a75adcbb156f9eb67c5d5f044b3d7f20c">More...</a><br /></td></tr>
<tr class="separator:a75adcbb156f9eb67c5d5f044b3d7f20c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3adf24b209cfe1c8c0ac5f096d17436"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ab3adf24b209cfe1c8c0ac5f096d17436">test_results</a> (struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>, const struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query, unsigned int expected_secure, unsigned int expected_bogus, unsigned int expected_rcode, const char *expected_canonical, const char *expected_answer, size_t answer_size)</td></tr>
<tr class="separator:ab3adf24b209cfe1c8c0ac5f096d17436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;DNS API Tests&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .load_pri = <a class="el" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a1d1eb207e01a2d3bf6aa6ba271c27dee">AST_MODPRI_DEFAULT</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530620b8a056d611a56ba6ec615df63b"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a></td></tr>
<tr class="memdesc:a530620b8a056d611a56ba6ec615df63b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The mock resolver.  <a href="#a530620b8a056d611a56ba6ec615df63b">More...</a><br /></td></tr>
<tr class="separator:a530620b8a056d611a56ba6ec615df63b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f581dd0678d1cedb456334d4208134"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d4e/structresolver__data.html">resolver_data</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></td></tr>
<tr class="separator:ad4f581dd0678d1cedb456334d4208134"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afc97a77c6a0610ac45975194f89a1e96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc97a77c6a0610ac45975194f89a1e96">&#9670;&nbsp;</a></span>DNS_ANSWER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DNS_ANSWER&#160;&#160;&#160;&quot;Grumble Grumble&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00294">294</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00297">AST_TEST_DEFINE()</a>, and <a class="el" href="../../da/d14/test__dns_8c_source.html#l00670">resolution_thread()</a>.</p>

</div>
</div>
<a id="a31888cf993f4e4e7afbec462ea65e6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31888cf993f4e4e7afbec462ea65e6fc">&#9670;&nbsp;</a></span>DNS_ANSWER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DNS_ANSWER_SIZE&#160;&#160;&#160;strlen(<a class="el" href="../../d5/d36/test__dns__recurring_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00295">295</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00297">AST_TEST_DEFINE()</a>, and <a class="el" href="../../da/d14/test__dns_8c_source.html#l00670">resolution_thread()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01337">1337</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01337">1337</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01337">1337</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

</div>
</div>
<a id="af6b0829d47d5b8f1d40ef884de3ec249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6b0829d47d5b8f1d40ef884de3ec249">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[1/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_register_unregister&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00047">47</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00630">ast_dns_resolver_register()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d9/da7/dns__resolver_8h_source.html#l00034">ast_dns_resolver::name</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00042">stub_cancel()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00036">stub_resolve()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> cool_guy_resolver = {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;A snake that swallowed a deer&quot;</span>,</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      .priority = 19890504,</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      .resolve = <a class="code" href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a>,</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      .cancel = <a class="code" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a>,</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   };</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_register_unregister&quot;</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test nominal resolver registration and unregistration&quot;</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         <span class="stringliteral">&quot;The test performs the following steps:\n&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <span class="stringliteral">&quot;\t* Register a valid resolver.\n&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         <span class="stringliteral">&quot;\t* Unregister the resolver.\n&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         <span class="stringliteral">&quot;If either step fails, the test fails&quot;</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;cool_guy_resolver)) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to register a perfectly good resolver\n&quot;</span>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;cool_guy_resolver);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div><div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test__dns_8c_html_a5f41ce4b5edac703c91c6aa4aba14a5d"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a></div><div class="ttdeci">static int stub_cancel(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00042">test_dns.c:42</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structast__dns__resolver_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">ast_dns_resolver::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of the resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00034">dns_resolver.h:34</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a7cf990e0d32f790b61b1cdffc6f005a2"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a></div><div class="ttdeci">int ast_dns_resolver_register(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Register a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00630">dns_core.c:630</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__resolver_html"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a></div><div class="ttdoc">DNS resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00032">dns_resolver.h:32</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__dns_8c_html_a0ac9da5d3ada597ee3f5dc8372baf1f6"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a></div><div class="ttdeci">static int stub_resolve(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00036">test_dns.c:36</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1f95894e4ce32763e97cc2b29bcbdf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1f95894e4ce32763e97cc2b29bcbdf7">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[2/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_register_off_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00081">81</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00630">ast_dns_resolver_register()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d9/da7/dns__resolver_8h_source.html#l00034">ast_dns_resolver::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00042">stub_cancel()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00036">stub_resolve()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> valid = {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;valid&quot;</span>,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      .resolve = <a class="code" href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a>,</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      .cancel = <a class="code" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a>,</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   };</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> incomplete1 = {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      .resolve = <a class="code" href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a>,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      .cancel = <a class="code" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a>,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   };</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> incomplete2 = {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;incomplete2&quot;</span>,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      .resolve = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      .cancel = <a class="code" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a>,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   };</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> incomplete3 = {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;incomplete3&quot;</span>,</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      .resolve = <a class="code" href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a>,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      .cancel = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   };</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_register_off_nominal&quot;</span>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test off-nominal resolver registration&quot;</span>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         <span class="stringliteral">&quot;Test off-nominal resolver registration:\n&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;         <span class="stringliteral">&quot;\t* Register a duplicate resolver\n&quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;         <span class="stringliteral">&quot;\t* Register a resolver without a name\n&quot;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;         <span class="stringliteral">&quot;\t* Register a resolver without a resolve() method\n&quot;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;         <span class="stringliteral">&quot;\t* Register a resolver without a cancel() method&quot;</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;valid)) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to register valid resolver\n&quot;</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;valid)) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully registered the same resolver multiple times\n&quot;</span>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;valid);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully registered a NULL resolver\n&quot;</span>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;incomplete1)) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully registered a DNS resolver with no name\n&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;incomplete2)) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully registered a DNS resolver with no resolve() method\n&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;incomplete3)) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully registered a DNS resolver with no cancel() method\n&quot;</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div><div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test__dns_8c_html_a5f41ce4b5edac703c91c6aa4aba14a5d"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a></div><div class="ttdeci">static int stub_cancel(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00042">test_dns.c:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structast__dns__resolver_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">ast_dns_resolver::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of the resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00034">dns_resolver.h:34</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a7cf990e0d32f790b61b1cdffc6f005a2"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a></div><div class="ttdeci">int ast_dns_resolver_register(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Register a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00630">dns_core.c:630</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__resolver_html"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a></div><div class="ttdoc">DNS resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00032">dns_resolver.h:32</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__dns_8c_html_a0ac9da5d3ada597ee3f5dc8372baf1f6"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a></div><div class="ttdeci">static int stub_resolve(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00036">test_dns.c:36</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a179971d4d3fb5ce659f199238a90a218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a179971d4d3fb5ce659f199238a90a218">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[3/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_unregister_off_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00158">158</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d9/da7/dns__resolver_8h_source.html#l00034">ast_dns_resolver::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00042">stub_cancel()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00036">stub_resolve()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> non_existent = {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;I do not exist&quot;</span>,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      .priority = 20141004,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      .resolve = <a class="code" href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a>,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      .cancel = <a class="code" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a>,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   };</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_unregister_off_nominal&quot;</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test off-nominal DNS resolver unregister&quot;</span>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         <span class="stringliteral">&quot;The test attempts the following:\n&quot;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         <span class="stringliteral">&quot;\t* Unregister a resolver that is not registered.\n&quot;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         <span class="stringliteral">&quot;\t* Unregister a NULL pointer.\n&quot;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         <span class="stringliteral">&quot;Because unregistering a resolver does not return an indicator of success, the best\n&quot;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;         <span class="stringliteral">&quot;this test can do is verify that nothing blows up when this is attempted.&quot;</span>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;non_existent);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div><div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test__dns_8c_html_a5f41ce4b5edac703c91c6aa4aba14a5d"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a></div><div class="ttdeci">static int stub_cancel(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00042">test_dns.c:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structast__dns__resolver_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">ast_dns_resolver::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of the resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00034">dns_resolver.h:34</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__resolver_html"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a></div><div class="ttdoc">DNS resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00032">dns_resolver.h:32</a></div></div>
<div class="ttc" id="test__dns_8c_html_a0ac9da5d3ada597ee3f5dc8372baf1f6"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a0ac9da5d3ada597ee3f5dc8372baf1f6">stub_resolve</a></div><div class="ttdeci">static int stub_resolve(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00036">test_dns.c:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a862094b4249aaa00b6a1446731e8c17f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a862094b4249aaa00b6a1446731e8c17f">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[4/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d4e/structresolver__data.html">resolver_data</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00189">189</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00451">ast_dns_resolver_get_data()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00440">ast_dns_resolver_set_data()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> some_query;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="keyword">struct </span>digits {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">int</span> fingers;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordtype">int</span> toes;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   };</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> digits *, average, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> digits *, polydactyl, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="keyword">struct </span>digits *data_ptr;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_data&quot;</span>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test getting and setting data on a DNS resolver&quot;</span>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description = <span class="stringliteral">&quot;This test does the following:\n&quot;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that requesting resolver data results in a NULL return if no data has been set.\n&quot;</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that setting resolver data does not result in an error.\n&quot;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that retrieving the set resolver data returns the data we expect\n&quot;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that setting new resolver data on the query does not result in an error\n&quot;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that retrieving the resolver data returns the new data that we set&quot;</span>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   memset(&amp;some_query, 0, <span class="keyword">sizeof</span>(some_query));</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   average = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*average), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   polydactyl = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*average), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordflow">if</span> (!average || !polydactyl) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Allocation failure during unit test\n&quot;</span>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="comment">/* Ensure that NULL is retrieved if we haven&#39;t set anything on the query */</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   data_ptr = <a class="code" href="../../d9/da7/dns__resolver_8h.html#aaf3d87b8ca10deacf438c70e030f9f8e">ast_dns_resolver_get_data</a>(&amp;some_query);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="keywordflow">if</span> (data_ptr) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Retrieved non-NULL resolver data from query unexpectedly\n&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a017e82027ca36bc66b610de1bc75c926">ast_dns_resolver_set_data</a>(&amp;some_query, average)) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to set resolver data on query\n&quot;</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <span class="comment">/* Go ahead now and remove the query&#39;s reference to the resolver data to prevent memory leaks */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(average, -1);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="comment">/* Ensure that data can be set and retrieved */</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   data_ptr = <a class="code" href="../../d9/da7/dns__resolver_8h.html#aaf3d87b8ca10deacf438c70e030f9f8e">ast_dns_resolver_get_data</a>(&amp;some_query);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordflow">if</span> (!data_ptr) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to retrieve resolver data from DNS query\n&quot;</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keywordflow">if</span> (data_ptr != average) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unexpected resolver data retrieved from DNS query\n&quot;</span>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="comment">/* Ensure that attempting to set new resolver data on the query fails */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a017e82027ca36bc66b610de1bc75c926">ast_dns_resolver_set_data</a>(&amp;some_query, polydactyl)) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully overwrote resolver data on a query. We shouldn&#39;t be able to do that\n&quot;</span>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div><div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_aaf3d87b8ca10deacf438c70e030f9f8e"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aaf3d87b8ca10deacf438c70e030f9f8e">ast_dns_resolver_get_data</a></div><div class="ttdeci">void * ast_dns_resolver_get_data(const struct ast_dns_query *query)</div><div class="ttdoc">Retrieve resolver specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00451">dns_core.c:451</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a017e82027ca36bc66b610de1bc75c926"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a017e82027ca36bc66b610de1bc75c926">ast_dns_resolver_set_data</a></div><div class="ttdeci">int ast_dns_resolver_set_data(struct ast_dns_query *query, void *data)</div><div class="ttdoc">Set resolver specific data on a query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00440">dns_core.c:440</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__query_html"><div class="ttname"><a href="../../dd/daa/structast__dns__query.html">ast_dns_query</a></div><div class="ttdoc">A DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00137">dns_internal.h:137</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aac60e6425c7a14b485ceafaf7545dc8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac60e6425c7a14b485ceafaf7545dc8c">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[5/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_set_result&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00297">297</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00077">ast_dns_query_get_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00456">ast_dns_resolver_set_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00130">ast_dns_result_free()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00294">DNS_ANSWER</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00295">DNS_ANSWER_SIZE</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../da/d14/test__dns_8c_source.html#l00265">test_results()</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> some_query;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keyword">struct </span>dns_result {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> secure;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bogus;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rcode;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   } results[] = {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      { 0, 0, NOERROR, },</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      { 0, 1, NOERROR, },</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      { 1, 0, NOERROR, },</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      { 0, 0, NXDOMAIN, },</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   };</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_set_result&quot;</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test setting and getting results on DNS queries&quot;</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;         <span class="stringliteral">&quot;This test performs the following:\n&quot;</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         <span class="stringliteral">&quot;\t* Sets a result that is not secure, bogus, and has rcode 0\n&quot;</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;         <span class="stringliteral">&quot;\t* Sets a result that is not secure, has rcode 0, but is secure\n&quot;</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;         <span class="stringliteral">&quot;\t* Sets a result that is not bogus, has rcode 0, but is secure\n&quot;</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         <span class="stringliteral">&quot;\t* Sets a result that is not secure or bogus, but has rcode NXDOMAIN\n&quot;</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;         <span class="stringliteral">&quot;After each result is set, we ensure that parameters retrieved from\n&quot;</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         <span class="stringliteral">&quot;the result have the expected values.&quot;</span>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   memset(&amp;some_query, 0, <span class="keyword">sizeof</span>(some_query));</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(results); ++i) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a>(&amp;some_query, results[i].secure, results[i].bogus,</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            results[i].rcode, <span class="stringliteral">&quot;asterisk.org&quot;</span>, <a class="code" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>)) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to add DNS result to query\n&quot;</span>);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;         res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../da/d14/test__dns_8c.html#ab3adf24b209cfe1c8c0ac5f096d17436">test_results</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, &amp;some_query, results[i].secure, results[i].bogus,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            results[i].rcode, <span class="stringliteral">&quot;asterisk.org&quot;</span>, <a class="code" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>)) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;         res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="comment">/* The final result we set needs to be freed */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   result = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(&amp;some_query);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>(result);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_afc97a77c6a0610ac45975194f89a1e96"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a></div><div class="ttdeci">#define DNS_ANSWER</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00294">test_dns.c:294</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dns__core_8h_html_a9d8517652042a392b47003f26c9baeb5"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a></div><div class="ttdeci">void ast_dns_result_free(struct ast_dns_result *result)</div><div class="ttdoc">Free the DNS result information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00130">dns_core.c:130</a></div></div>
<div class="ttc" id="test__dns_8c_html_a31888cf993f4e4e7afbec462ea65e6fc"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a></div><div class="ttdeci">#define DNS_ANSWER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00295">test_dns.c:295</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="test__dns_8c_html_ab3adf24b209cfe1c8c0ac5f096d17436"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ab3adf24b209cfe1c8c0ac5f096d17436">test_results</a></div><div class="ttdeci">static int test_results(struct ast_test *test, const struct ast_dns_query *query, unsigned int expected_secure, unsigned int expected_bogus, unsigned int expected_rcode, const char *expected_canonical, const char *expected_answer, size_t answer_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00265">test_dns.c:265</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="dns__core_8h_html_a39c90d1f2d020fff6587d8014ca57da8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a></div><div class="ttdeci">struct ast_dns_result * ast_dns_query_get_result(const struct ast_dns_query *query)</div><div class="ttdoc">Get the result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00077">dns_core.c:77</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__query_html"><div class="ttname"><a href="../../dd/daa/structast__dns__query.html">ast_dns_query</a></div><div class="ttdoc">A DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00137">dns_internal.h:137</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a321df8f3250551f796c99524dbcc2567"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a></div><div class="ttdeci">int ast_dns_resolver_set_result(struct ast_dns_query *query, unsigned int secure, unsigned int bogus, unsigned int rcode, const char *canonical, const char *answer, size_t answer_size)</div><div class="ttdoc">Set result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00456">dns_core.c:456</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8048af6bc60559ce43334f0e37523b34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8048af6bc60559ce43334f0e37523b34">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[6/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_set_result_off_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00355">355</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00077">ast_dns_query_get_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00456">ast_dns_resolver_set_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00130">ast_dns_result_free()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00294">DNS_ANSWER</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00295">DNS_ANSWER_SIZE</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> some_query;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_set_result_off_nominal&quot;</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test setting off-nominal DNS results&quot;</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;         <span class="stringliteral">&quot;This test performs the following:\n&quot;</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;         <span class="stringliteral">&quot;\t* Attempt to add a DNS result that is both bogus and secure\n&quot;</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         <span class="stringliteral">&quot;\t* Attempt to add a DNS result that has no canonical name&quot;</span>;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   memset(&amp;some_query, 0, <span class="keyword">sizeof</span>(some_query));</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a>(&amp;some_query, 1, 1, NOERROR, <span class="stringliteral">&quot;asterisk.org&quot;</span>,</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <a class="code" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>)) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added a result that was both secure and bogus\n&quot;</span>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      result = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(&amp;some_query);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>(result);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a>(&amp;some_query, 0, 0, NOERROR, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <a class="code" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>)) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added result with no canonical name\n&quot;</span>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      result = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(&amp;some_query);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>(result);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_afc97a77c6a0610ac45975194f89a1e96"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a></div><div class="ttdeci">#define DNS_ANSWER</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00294">test_dns.c:294</a></div></div>
<div class="ttc" id="dns__core_8h_html_a9d8517652042a392b47003f26c9baeb5"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a></div><div class="ttdeci">void ast_dns_result_free(struct ast_dns_result *result)</div><div class="ttdoc">Free the DNS result information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00130">dns_core.c:130</a></div></div>
<div class="ttc" id="test__dns_8c_html_a31888cf993f4e4e7afbec462ea65e6fc"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a></div><div class="ttdeci">#define DNS_ANSWER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00295">test_dns.c:295</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="dns__core_8h_html_a39c90d1f2d020fff6587d8014ca57da8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a></div><div class="ttdeci">struct ast_dns_result * ast_dns_query_get_result(const struct ast_dns_query *query)</div><div class="ttdoc">Get the result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00077">dns_core.c:77</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__query_html"><div class="ttname"><a href="../../dd/daa/structast__dns__query.html">ast_dns_query</a></div><div class="ttdoc">A DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00137">dns_internal.h:137</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a321df8f3250551f796c99524dbcc2567"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a></div><div class="ttdeci">int ast_dns_resolver_set_result(struct ast_dns_query *query, unsigned int secure, unsigned int bogus, unsigned int rcode, const char *canonical, const char *answer, size_t answer_size)</div><div class="ttdoc">Set result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00456">dns_core.c:456</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c165aee454f16925835183818bbf39f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c165aee454f16925835183818bbf39f">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[7/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_add_record&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00421">421</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00077">ast_dns_query_get_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00170">ast_dns_record_get_next()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00535">ast_dns_resolver_add_record()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00456">ast_dns_resolver_set_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00130">ast_dns_result_free()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00102">ast_dns_result_get_records()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00294">DNS_ANSWER</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00295">DNS_ANSWER_SIZE</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00084">records</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00395">test_record()</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>
<div class="fragment"><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;{</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *, <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> some_query;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *V4 = <span class="stringliteral">&quot;127.0.0.1&quot;</span>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> V4_BUFSIZE = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>in_addr);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="keywordtype">char</span> v4_buf[V4_BUFSIZE];</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *V6 = <span class="stringliteral">&quot;::1&quot;</span>;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> V6_BUFSIZE = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>in6_addr);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordtype">char</span> v6_buf[V6_BUFSIZE];</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keyword">struct </span>dns_record_details {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordtype">int</span> <span class="keyword">class</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordtype">int</span> ttl;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *data;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">size_t</span> size;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordtype">int</span> visited;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   } <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[] = {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      { T_A, C_IN, 12345, v4_buf, V4_BUFSIZE, 0, },</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      { T_AAAA, C_IN, 12345, v6_buf, V6_BUFSIZE, 0, },</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   };</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="keywordtype">int</span> num_records_visited = 0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_add_record&quot;</span>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test adding DNS records to a query&quot;</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;         <span class="stringliteral">&quot;This test performs the following:\n&quot;</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <span class="stringliteral">&quot;\t* Ensure a nominal A record can be added to a query result\n&quot;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         <span class="stringliteral">&quot;\t* Ensures that the record can be retrieved\n&quot;</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that a second record can be added to the query result\n&quot;</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <span class="stringliteral">&quot;\t* Ensures that both records can be retrieved&quot;</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   memset(&amp;some_query, 0, <span class="keyword">sizeof</span>(some_query));</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a>(&amp;some_query, 0, 0, NOERROR, <span class="stringliteral">&quot;asterisk.org&quot;</span>,</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <a class="code" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>)) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to set result for DNS query\n&quot;</span>);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(&amp;some_query);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>) {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to retrieve result from query\n&quot;</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   inet_pton(AF_INET, V4, v4_buf);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <span class="comment">/* Nominal Record */</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].<span class="keyword">class</span>,</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].ttl, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].data, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].size)) {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to add nominal record to query result\n&quot;</span>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="comment">/* I should only be able to retrieve one record */</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   record = <a class="code" href="../../d6/d51/dns__core_8h.html#abad4eaaea3a60b0e8b9dc1f69a7d69fc">ast_dns_result_get_records</a>(<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="keywordflow">if</span> (!record) {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to retrieve record from result\n&quot;</span>);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   }</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/d14/test__dns_8c.html#aea83082d294e18cd3ef8a4972ebfd322">test_record</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, record, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].type, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].<span class="keyword">class</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].ttl,</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].data, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].size)) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#a60c7de83431c14325042733b66a591d1">ast_dns_record_get_next</a>(record)) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Multiple records returned when only one was expected\n&quot;</span>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   inet_pton(AF_INET6, V6, v6_buf);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].type, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].<span class="keyword">class</span>,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].ttl, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].data, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].size)) {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to add second record to query result\n&quot;</span>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="keywordflow">for</span> (record = <a class="code" href="../../d6/d51/dns__core_8h.html#abad4eaaea3a60b0e8b9dc1f69a7d69fc">ast_dns_result_get_records</a>(<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>); record; record = <a class="code" href="../../d6/d51/dns__core_8h.html#a60c7de83431c14325042733b66a591d1">ast_dns_record_get_next</a>(record)) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="comment">/* The order of returned records is not specified by the API. We use the record type</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">       * as the discriminator to determine which record data to expect.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].type) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         res = <a class="code" href="../../da/d14/test__dns_8c.html#aea83082d294e18cd3ef8a4972ebfd322">test_record</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, record, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].type, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].<span class="keyword">class</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].ttl, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].data, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].size);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;         <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].visited = 1;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].type) {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;         res = <a class="code" href="../../da/d14/test__dns_8c.html#aea83082d294e18cd3ef8a4972ebfd322">test_record</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, record, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].type, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].<span class="keyword">class</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].ttl, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].data, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].size);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;         <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].visited = 1;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unknown record type found in DNS results\n&quot;</span>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      ++num_records_visited;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[0].visited || !<a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>[1].visited) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Did not visit all added DNS records\n&quot;</span>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <span class="keywordflow">if</span> (num_records_visited != <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>)) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Did not visit the expected number of DNS records\n&quot;</span>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_ab18693215565ea1a797096dfe19e895f"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a></div><div class="ttdeci">static int records</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00084">cdr_mysql.c:84</a></div></div>
<div class="ttc" id="dns__core_8h_html_a60c7de83431c14325042733b66a591d1"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a60c7de83431c14325042733b66a591d1">ast_dns_record_get_next</a></div><div class="ttdeci">const struct ast_dns_record * ast_dns_record_get_next(const struct ast_dns_record *record)</div><div class="ttdoc">Get the next DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00170">dns_core.c:170</a></div></div>
<div class="ttc" id="test__dns_8c_html_afc97a77c6a0610ac45975194f89a1e96"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a></div><div class="ttdeci">#define DNS_ANSWER</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00294">test_dns.c:294</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dns__core_8h_html_a9d8517652042a392b47003f26c9baeb5"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a></div><div class="ttdeci">void ast_dns_result_free(struct ast_dns_result *result)</div><div class="ttdoc">Free the DNS result information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00130">dns_core.c:130</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_ae88ff57fdf06ba45b931609978be2611"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a></div><div class="ttdeci">int ast_dns_resolver_add_record(struct ast_dns_query *query, int rr_type, int rr_class, int ttl, const char *data, const size_t size)</div><div class="ttdoc">Add a DNS record to the result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00535">dns_core.c:535</a></div></div>
<div class="ttc" id="test__dns_8c_html_a31888cf993f4e4e7afbec462ea65e6fc"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a></div><div class="ttdeci">#define DNS_ANSWER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00295">test_dns.c:295</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="structast__dns__record_html"><div class="ttname"><a href="../../d3/db7/structast__dns__record.html">ast_dns_record</a></div><div class="ttdoc">For AST_LIST. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00039">dns_internal.h:39</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="dns__core_8h_html_a39c90d1f2d020fff6587d8014ca57da8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a></div><div class="ttdeci">struct ast_dns_result * ast_dns_query_get_result(const struct ast_dns_query *query)</div><div class="ttdoc">Get the result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00077">dns_core.c:77</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__query_html"><div class="ttname"><a href="../../dd/daa/structast__dns__query.html">ast_dns_query</a></div><div class="ttdoc">A DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00137">dns_internal.h:137</a></div></div>
<div class="ttc" id="dns__core_8h_html_abad4eaaea3a60b0e8b9dc1f69a7d69fc"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abad4eaaea3a60b0e8b9dc1f69a7d69fc">ast_dns_result_get_records</a></div><div class="ttdeci">const struct ast_dns_record * ast_dns_result_get_records(const struct ast_dns_result *result)</div><div class="ttdoc">Get the first record of a DNS Result. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00102">dns_core.c:102</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a321df8f3250551f796c99524dbcc2567"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a></div><div class="ttdeci">int ast_dns_resolver_set_result(struct ast_dns_query *query, unsigned int secure, unsigned int bogus, unsigned int rcode, const char *canonical, const char *answer, size_t answer_size)</div><div class="ttdoc">Set result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00456">dns_core.c:456</a></div></div>
<div class="ttc" id="test__dns_8c_html_aea83082d294e18cd3ef8a4972ebfd322"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#aea83082d294e18cd3ef8a4972ebfd322">test_record</a></div><div class="ttdeci">static int test_record(struct ast_test *test, const struct ast_dns_record *record, int rr_type, int rr_class, int ttl, const char *data, const size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00395">test_dns.c:395</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afee0718d414509b97cf3f22b533d1cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afee0718d414509b97cf3f22b533d1cce">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[8/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_add_record_off_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00550">550</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00077">ast_dns_query_get_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00535">ast_dns_resolver_add_record()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00456">ast_dns_resolver_set_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00130">ast_dns_result_free()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00294">DNS_ANSWER</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00295">DNS_ANSWER_SIZE</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;{</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *, <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> some_query;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *V4 = <span class="stringliteral">&quot;127.0.0.1&quot;</span>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> V4_BUFSIZE = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>in_addr);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="keywordtype">char</span> v4_buf[V4_BUFSIZE];</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_add_record_off_nominal&quot;</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test adding off-nominal DNS records to a query&quot;</span>;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;         <span class="stringliteral">&quot;This test performs the following:\n&quot;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         <span class="stringliteral">&quot;\t* Ensure a nominal A record cannot be added if no result has been set.\n&quot;</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that an A record with invalid RR types cannot be added to a query\n&quot;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that an A record with invalid RR classes cannot be added to a query\n&quot;</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that an A record with invalid TTL cannot be added to a query\n&quot;</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that an A record with NULL data cannot be added to a query\n&quot;</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;         <span class="stringliteral">&quot;\t* Ensure that an A record with invalid length cannot be added to a query&quot;</span>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   memset(&amp;some_query, 0, <span class="keyword">sizeof</span>(some_query));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   inet_ntop(AF_INET, V4, v4_buf, V4_BUFSIZE);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <span class="comment">/* Add record before setting result */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, T_A, C_IN, 12345, v4_buf, V4_BUFSIZE)) {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added DNS record to query before setting a result\n&quot;</span>);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a>(&amp;some_query, 0, 0, NOERROR, <span class="stringliteral">&quot;asterisk.org&quot;</span>,</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <a class="code" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>)) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to set result for DNS query\n&quot;</span>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="comment">/* We get the result so it will be cleaned up when the function exits */</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(&amp;some_query);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="comment">/* Invalid RR types */</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, -1, C_IN, 12345, v4_buf, V4_BUFSIZE)) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added DNS record with negative RR type\n&quot;</span>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   }</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, 65536 + 1, C_IN, 12345, v4_buf, V4_BUFSIZE)) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added DNS record with too large RR type\n&quot;</span>);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   <span class="comment">/* Invalid RR classes */</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, T_A, -1, 12345, v4_buf, V4_BUFSIZE)) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added DNS record with negative RR class\n&quot;</span>);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, T_A, 65536 + 1, 12345, v4_buf, V4_BUFSIZE)) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added DNS record with too large RR class\n&quot;</span>);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="comment">/* Invalid TTL */</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, T_A, C_IN, -1, v4_buf, V4_BUFSIZE)) {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added DNS record with negative TTL\n&quot;</span>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <span class="comment">/* No data */</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, T_A, C_IN, 12345, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added a DNS record with no data\n&quot;</span>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="comment">/* Lie about the length */</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(&amp;some_query, T_A, C_IN, 12345, v4_buf, 0)) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully added a DNS record with length zero\n&quot;</span>);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_afc97a77c6a0610ac45975194f89a1e96"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a></div><div class="ttdeci">#define DNS_ANSWER</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00294">test_dns.c:294</a></div></div>
<div class="ttc" id="dns__core_8h_html_a9d8517652042a392b47003f26c9baeb5"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a></div><div class="ttdeci">void ast_dns_result_free(struct ast_dns_result *result)</div><div class="ttdoc">Free the DNS result information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00130">dns_core.c:130</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_ae88ff57fdf06ba45b931609978be2611"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a></div><div class="ttdeci">int ast_dns_resolver_add_record(struct ast_dns_query *query, int rr_type, int rr_class, int ttl, const char *data, const size_t size)</div><div class="ttdoc">Add a DNS record to the result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00535">dns_core.c:535</a></div></div>
<div class="ttc" id="test__dns_8c_html_a31888cf993f4e4e7afbec462ea65e6fc"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a></div><div class="ttdeci">#define DNS_ANSWER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00295">test_dns.c:295</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="dns__core_8h_html_a39c90d1f2d020fff6587d8014ca57da8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a></div><div class="ttdeci">struct ast_dns_result * ast_dns_query_get_result(const struct ast_dns_query *query)</div><div class="ttdoc">Get the result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00077">dns_core.c:77</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__query_html"><div class="ttname"><a href="../../dd/daa/structast__dns__query.html">ast_dns_query</a></div><div class="ttdoc">A DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00137">dns_internal.h:137</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a321df8f3250551f796c99524dbcc2567"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a></div><div class="ttdeci">int ast_dns_resolver_set_result(struct ast_dns_query *query, unsigned int secure, unsigned int bogus, unsigned int rcode, const char *canonical, const char *answer, size_t answer_size)</div><div class="ttdoc">Set result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00456">dns_core.c:456</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a42ad7ecfbdeb22a720d317d20d7056ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ad7ecfbdeb22a720d317d20d7056ba">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[9/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_resolve_sync&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00781">781</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00314">ast_dns_resolve()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00630">ast_dns_resolver_register()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00130">ast_dns_result_free()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00102">ast_dns_result_get_records()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00648">resolver_data::canceled</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">cleanup()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00650">resolver_data::resolution_complete</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00646">resolver_data::resolve_called</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00761">resolver_data_cleanup()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00746">resolver_data_init()</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>
<div class="fragment"><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;{</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *, <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_resolve_sync&quot;</span>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test a nominal synchronous DNS resolution&quot;</span>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         <span class="stringliteral">&quot;This test performs a synchronous DNS resolution of a domain. The goal of this\n&quot;</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;         <span class="stringliteral">&quot;test is not to check the records for accuracy. Rather, the goal is to ensure that\n&quot;</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;         <span class="stringliteral">&quot;the resolver is called into as expected, that the query completes entirely before\n&quot;</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;         <span class="stringliteral">&quot;returning from the synchronous resolution, that nothing tried to cancel the resolution\n,&quot;</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;         <span class="stringliteral">&quot;and that some records were returned.&quot;</span>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>)) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to register test resolver\n&quot;</span>);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ab741e73a3fcaafba5724cb28bf7aece4">resolver_data_init</a>();</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#ace452a5e50044783b7b81caf7dbee17c">ast_dns_resolve</a>(<span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A, C_IN, &amp;<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>)) {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resolution of address failed\n&quot;</span>);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>) {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;DNS resolution returned a NULL result\n&quot;</span>);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolve_called</a>) {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;DNS resolution did not call resolver&#39;s resolve() method\n&quot;</span>);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   }</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a>) {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resolver&#39;s cancel() method called for no reason\n&quot;</span>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolution_complete</a>) {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Synchronous resolution completed early?\n&quot;</span>);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d51/dns__core_8h.html#abad4eaaea3a60b0e8b9dc1f69a7d69fc">ast_dns_result_get_records</a>(<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>)) {</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Synchronous resolution yielded no records.\n&quot;</span>);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   }</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>:</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#a66d40e3200575a80d2ab6ed5ae1efdaa">resolver_data_cleanup</a>();</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div><div class="ttc" id="dns__core_8h_html_ace452a5e50044783b7b81caf7dbee17c"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#ace452a5e50044783b7b81caf7dbee17c">ast_dns_resolve</a></div><div class="ttdeci">int ast_dns_resolve(const char *name, int rr_type, int rr_class, struct ast_dns_result **result)</div><div class="ttdoc">Synchronously resolve a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00314">dns_core.c:314</a></div></div>
<div class="ttc" id="dns__core_8h_html_a9d8517652042a392b47003f26c9baeb5"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a></div><div class="ttdeci">void ast_dns_result_free(struct ast_dns_result *result)</div><div class="ttdoc">Free the DNS result information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00130">dns_core.c:130</a></div></div>
<div class="ttc" id="test__dns_8c_html_ab741e73a3fcaafba5724cb28bf7aece4"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ab741e73a3fcaafba5724cb28bf7aece4">resolver_data_init</a></div><div class="ttdeci">static void resolver_data_init(void)</div><div class="ttdoc">Initialize global mock resolver data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00746">test_dns.c:746</a></div></div>
<div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="structresolver__data_html_abd2f63f5e9e25d6c9463ba596b645ed9"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolver_data::resolve_called</a></div><div class="ttdeci">int resolve_called</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00646">test_dns.c:646</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test__dns_8c_html_a530620b8a056d611a56ba6ec615df63b"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a></div><div class="ttdeci">static struct ast_dns_resolver test_resolver</div><div class="ttdoc">The mock resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00774">test_dns.c:774</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structresolver__data_html_a5be8d5942595cc4bf15ae9b105345134"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolver_data::resolution_complete</a></div><div class="ttdeci">int resolution_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00650">test_dns.c:650</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a7cf990e0d32f790b61b1cdffc6f005a2"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a></div><div class="ttdeci">int ast_dns_resolver_register(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Register a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00630">dns_core.c:630</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="dns__core_8h_html_abad4eaaea3a60b0e8b9dc1f69a7d69fc"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abad4eaaea3a60b0e8b9dc1f69a7d69fc">ast_dns_result_get_records</a></div><div class="ttdeci">const struct ast_dns_record * ast_dns_result_get_records(const struct ast_dns_result *result)</div><div class="ttdoc">Get the first record of a DNS Result. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00102">dns_core.c:102</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_a10b51e1931bd03dd172cbfb9d3d67efb"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a></div><div class="ttdeci">static void * cleanup(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">pbx_realtime.c:124</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="structresolver__data_html_a7a04d6ad2bbf6f268250358467407c37"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">resolver_data::canceled</a></div><div class="ttdeci">int canceled</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00648">test_dns.c:648</a></div></div>
<div class="ttc" id="test__dns_8c_html_a66d40e3200575a80d2ab6ed5ae1efdaa"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a66d40e3200575a80d2ab6ed5ae1efdaa">resolver_data_cleanup</a></div><div class="ttdeci">static void resolver_data_cleanup(void)</div><div class="ttdoc">Cleanup global mock resolver data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00761">test_dns.c:761</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a48dd7232c8fd23f9b5119d8c55270dcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48dd7232c8fd23f9b5119d8c55270dcb">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[10/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_resolve_sync_off_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00862">862</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00314">ast_dns_resolve()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00630">ast_dns_resolver_register()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00130">ast_dns_result_free()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00857">fail_resolve()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d9/da7/dns__resolver_8h_source.html#l00034">ast_dns_resolver::name</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00042">stub_cancel()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;{</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> terrible_resolver = {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;Uwe Boll&#39;s Filmography&quot;</span>,</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      .priority = 0,</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      .resolve = <a class="code" href="../../da/d14/test__dns_8c.html#af9d18ca4fc298a6c1590a3b76c092aab">fail_resolve</a>,</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      .cancel = <a class="code" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a>,</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;   };</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   <span class="keyword">struct </span>dns_resolve_data {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordtype">int</span> rr_type;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordtype">int</span> rr_class;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> **<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   } resolves [] = {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      { <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,           T_A,       C_IN,      &amp;result },</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, -1,        C_IN,      &amp;result },</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, 65536 + 1, C_IN,      &amp;result },</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A,       -1,        &amp;result },</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A,       65536 + 1, &amp;result },</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A,       C_IN,      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> },</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   };</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_resolve_sync_off_nominal&quot;</span>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test off-nominal synchronous DNS resolution&quot;</span>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;         <span class="stringliteral">&quot;This test performs several off-nominal synchronous DNS resolutions:\n&quot;</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with NULL name\n&quot;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with invalid RR type\n&quot;</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with invalid RR class\n&quot;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with NULL result pointer\n&quot;</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with resolver that returns an error&quot;</span>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>)) {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to register test resolver\n&quot;</span>);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resolves); ++i) {</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d51/dns__core_8h.html#ace452a5e50044783b7b81caf7dbee17c">ast_dns_resolve</a>(resolves[i].<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, resolves[i].rr_type, resolves[i].rr_class, resolves[i].result)) {</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully resolved DNS query with invalid parameters\n&quot;</span>);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;         res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed resolution set a non-NULL result\n&quot;</span>);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;         <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>(result);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;         res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   <span class="comment">/* As a final test, try a legitimate query with a bad resolver */</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;terrible_resolver)) {</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to register the terrible resolver\n&quot;</span>);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   }</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d51/dns__core_8h.html#ace452a5e50044783b7b81caf7dbee17c">ast_dns_resolve</a>(<span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A, C_IN, &amp;result)) {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;DNS resolution succeeded when we expected it not to\n&quot;</span>);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;terrible_resolver);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;terrible_resolver);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;   <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed DNS resolution set the result to something non-NULL\n&quot;</span>);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <a class="code" href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a>(result);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   }</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div><div class="ttc" id="dns__core_8h_html_ace452a5e50044783b7b81caf7dbee17c"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#ace452a5e50044783b7b81caf7dbee17c">ast_dns_resolve</a></div><div class="ttdeci">int ast_dns_resolve(const char *name, int rr_type, int rr_class, struct ast_dns_result **result)</div><div class="ttdoc">Synchronously resolve a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00314">dns_core.c:314</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dns__core_8h_html_a9d8517652042a392b47003f26c9baeb5"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a9d8517652042a392b47003f26c9baeb5">ast_dns_result_free</a></div><div class="ttdeci">void ast_dns_result_free(struct ast_dns_result *result)</div><div class="ttdoc">Free the DNS result information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00130">dns_core.c:130</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test__dns_8c_html_a530620b8a056d611a56ba6ec615df63b"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a></div><div class="ttdeci">static struct ast_dns_resolver test_resolver</div><div class="ttdoc">The mock resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00774">test_dns.c:774</a></div></div>
<div class="ttc" id="test__dns_8c_html_a5f41ce4b5edac703c91c6aa4aba14a5d"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a></div><div class="ttdeci">static int stub_cancel(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00042">test_dns.c:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structast__dns__resolver_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">ast_dns_resolver::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of the resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00034">dns_resolver.h:34</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a7cf990e0d32f790b61b1cdffc6f005a2"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a></div><div class="ttdeci">int ast_dns_resolver_register(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Register a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00630">dns_core.c:630</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__resolver_html"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a></div><div class="ttdoc">DNS resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00032">dns_resolver.h:32</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="test__dns_8c_html_af9d18ca4fc298a6c1590a3b76c092aab"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#af9d18ca4fc298a6c1590a3b76c092aab">fail_resolve</a></div><div class="ttdeci">static int fail_resolve(struct ast_dns_query *query)</div><div class="ttdoc">A resolve() method that simply fails. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00857">test_dns.c:857</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0f353983d2cd40012be45676c15feb35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f353983d2cd40012be45676c15feb35">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[11/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_resolve_async&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01018">1018</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00204">ast_cond_timedwait</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00077">ast_dns_query_get_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00247">ast_dns_resolve_async()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00630">ast_dns_resolver_register()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00102">ast_dns_result_get_records()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00177">ast_tsnow()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l01008">async_callback()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00983">async_data_alloc()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00648">resolver_data::canceled</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">cleanup()</a>, <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00610">async_data::complete</a>, <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00612">async_data::cond</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00611">async_data::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00650">resolver_data::resolution_complete</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00646">resolver_data::resolve_called</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00761">resolver_data_cleanup()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00746">resolver_data_init()</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>
<div class="fragment"><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;{</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a> *, <a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dcd/structast__dns__query__active.html">ast_dns_query_active</a> *, active, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   <span class="keyword">struct </span>timespec <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_resolve_async&quot;</span>;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test a nominal asynchronous DNS resolution&quot;</span>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;         <span class="stringliteral">&quot;This test performs an asynchronous DNS resolution of a domain. The goal of this\n&quot;</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         <span class="stringliteral">&quot;test is not to check the records for accuracy. Rather, the goal is to ensure that\n&quot;</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;         <span class="stringliteral">&quot;the resolver is called into as expected, that we regain control before the query\n&quot;</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         <span class="stringliteral">&quot;is completed, and to ensure that nothing tried to cancel the resolution.&quot;</span>;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>)) {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to register test resolver\n&quot;</span>);</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   }</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ab741e73a3fcaafba5724cb28bf7aece4">resolver_data_init</a>();</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   <a class="code" href="../../d2/d9c/structasync__data.html">async_data</a> = <a class="code" href="../../da/d14/test__dns_8c.html#aa7f1e6c33538ed73025433d963601b68">async_data_alloc</a>();</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>) {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to allocate asynchronous data\n&quot;</span>);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   active = <a class="code" href="../../d6/d51/dns__core_8h.html#a67e1cfb2c7b24d45cf003d49923f5d9f">ast_dns_resolve_async</a>(<span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A, C_IN, <a class="code" href="../../da/d14/test__dns_8c.html#aed3c37596cb5a728433115e6d427b92d">async_callback</a>, <a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;   <span class="keywordflow">if</span> (!active) {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Asynchronous resolution of address failed\n&quot;</span>);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolve_called</a>) {</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;DNS resolution did not call resolver&#39;s resolve() method\n&quot;</span>);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   }</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a>) {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resolver&#39;s cancel() method called for no reason\n&quot;</span>);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;   }</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../de/df7/time_8h.html#a231d7586bf7d913fe4756047fd8def5e">ast_tsnow</a>();</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>.tv_sec += 10;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   <span class="keywordflow">while</span> (!<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#a520408f4775914f7510cc59db5a60b38">complete</a>) {</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d42/lock_8h.html#a6add1f30b2d53ca9384b15529a6f126e">ast_cond_timedwait</a>(&amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, &amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>) == ETIMEDOUT) {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   }</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#a520408f4775914f7510cc59db5a60b38">complete</a>) {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Asynchronous resolution timed out\n&quot;</span>);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   }</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolution_complete</a>) {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Asynchronous resolution completed early?\n&quot;</span>);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   result = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(active-&gt;query);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;   <span class="keywordflow">if</span> (!result) {</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Asynchronous resolution yielded no result\n&quot;</span>);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;   }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d51/dns__core_8h.html#abad4eaaea3a60b0e8b9dc1f69a7d69fc">ast_dns_result_get_records</a>(result)) {</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Asynchronous result had no records\n&quot;</span>);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>:</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#a66d40e3200575a80d2ab6ed5ae1efdaa">resolver_data_cleanup</a>();</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;}</div><div class="ttc" id="structasync__data_html"><div class="ttname"><a href="../../d2/d9c/structasync__data.html">async_data</a></div><div class="ttdoc">Data required for an asynchronous callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00602">res_resolver_unbound.c:602</a></div></div>
<div class="ttc" id="structasync__resolution__data_html"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a></div><div class="ttdoc">Data used by async result callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00957">test_dns.c:957</a></div></div>
<div class="ttc" id="test__dns_8c_html_ab741e73a3fcaafba5724cb28bf7aece4"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ab741e73a3fcaafba5724cb28bf7aece4">resolver_data_init</a></div><div class="ttdeci">static void resolver_data_init(void)</div><div class="ttdoc">Initialize global mock resolver data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00746">test_dns.c:746</a></div></div>
<div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="structresolver__data_html_abd2f63f5e9e25d6c9463ba596b645ed9"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolver_data::resolve_called</a></div><div class="ttdeci">int resolve_called</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00646">test_dns.c:646</a></div></div>
<div class="ttc" id="structasync__data_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d2/d9c/structasync__data.html#a1c7181c39f99ee801943a0d0aa9872b9">async_data::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00612">res_resolver_unbound.c:612</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="structasync__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">async_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00611">res_resolver_unbound.c:611</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="dns__core_8h_html_a67e1cfb2c7b24d45cf003d49923f5d9f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a67e1cfb2c7b24d45cf003d49923f5d9f">ast_dns_resolve_async</a></div><div class="ttdeci">struct ast_dns_query_active * ast_dns_resolve_async(const char *name, int rr_type, int rr_class, ast_dns_resolve_callback callback, void *data)</div><div class="ttdoc">Asynchronously resolve a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00247">dns_core.c:247</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="test__dns_8c_html_a530620b8a056d611a56ba6ec615df63b"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a></div><div class="ttdeci">static struct ast_dns_resolver test_resolver</div><div class="ttdoc">The mock resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00774">test_dns.c:774</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structresolver__data_html_a5be8d5942595cc4bf15ae9b105345134"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolver_data::resolution_complete</a></div><div class="ttdeci">int resolution_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00650">test_dns.c:650</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a7cf990e0d32f790b61b1cdffc6f005a2"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a></div><div class="ttdeci">int ast_dns_resolver_register(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Register a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00630">dns_core.c:630</a></div></div>
<div class="ttc" id="test__dns_8c_html_aed3c37596cb5a728433115e6d427b92d"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#aed3c37596cb5a728433115e6d427b92d">async_callback</a></div><div class="ttdeci">static void async_callback(const struct ast_dns_query *query)</div><div class="ttdoc">Async DNS callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l01008">test_dns.c:1008</a></div></div>
<div class="ttc" id="test__dns_8c_html_aa7f1e6c33538ed73025433d963601b68"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#aa7f1e6c33538ed73025433d963601b68">async_data_alloc</a></div><div class="ttdeci">static struct async_resolution_data * async_data_alloc(void)</div><div class="ttdoc">Allocation/initialization for async_resolution_data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00983">test_dns.c:983</a></div></div>
<div class="ttc" id="structasync__data_html_a520408f4775914f7510cc59db5a60b38"><div class="ttname"><a href="../../d2/d9c/structasync__data.html#a520408f4775914f7510cc59db5a60b38">async_data::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00610">res_resolver_unbound.c:610</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="structast__dns__query__active_html"><div class="ttname"><a href="../../d8/dcd/structast__dns__query__active.html">ast_dns_query_active</a></div><div class="ttdoc">An active DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00201">dns_internal.h:201</a></div></div>
<div class="ttc" id="dns__core_8h_html_a39c90d1f2d020fff6587d8014ca57da8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a></div><div class="ttdeci">struct ast_dns_result * ast_dns_query_get_result(const struct ast_dns_query *query)</div><div class="ttdoc">Get the result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00077">dns_core.c:77</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="dns__core_8h_html_abad4eaaea3a60b0e8b9dc1f69a7d69fc"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abad4eaaea3a60b0e8b9dc1f69a7d69fc">ast_dns_result_get_records</a></div><div class="ttdeci">const struct ast_dns_record * ast_dns_result_get_records(const struct ast_dns_result *result)</div><div class="ttdoc">Get the first record of a DNS Result. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00102">dns_core.c:102</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_a10b51e1931bd03dd172cbfb9d3d67efb"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a></div><div class="ttdeci">static void * cleanup(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">pbx_realtime.c:124</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="time_8h_html_a231d7586bf7d913fe4756047fd8def5e"><div class="ttname"><a href="../../de/df7/time_8h.html#a231d7586bf7d913fe4756047fd8def5e">ast_tsnow</a></div><div class="ttdeci">struct timespec ast_tsnow(void)</div><div class="ttdoc">Returns current timespec. Meant to avoid calling ast_tvnow() just to create a timespec from the timev...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00177">time.h:177</a></div></div>
<div class="ttc" id="structresolver__data_html_a7a04d6ad2bbf6f268250358467407c37"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">resolver_data::canceled</a></div><div class="ttdeci">int canceled</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00648">test_dns.c:648</a></div></div>
<div class="ttc" id="test__dns_8c_html_a66d40e3200575a80d2ab6ed5ae1efdaa"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a66d40e3200575a80d2ab6ed5ae1efdaa">resolver_data_cleanup</a></div><div class="ttdeci">static void resolver_data_cleanup(void)</div><div class="ttdoc">Cleanup global mock resolver data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00761">test_dns.c:761</a></div></div>
<div class="ttc" id="lock_8h_html_a6add1f30b2d53ca9384b15529a6f126e"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6add1f30b2d53ca9384b15529a6f126e">ast_cond_timedwait</a></div><div class="ttdeci">#define ast_cond_timedwait(cond, mutex, time)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00204">lock.h:204</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5abfd705374e5ab643d3e3c6702d56e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5abfd705374e5ab643d3e3c6702d56e5">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[12/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_resolve_async_off_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01121">1121</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00247">ast_dns_resolve_async()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00630">ast_dns_resolver_register()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00857">fail_resolve()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d9/da7/dns__resolver_8h_source.html#l00034">ast_dns_resolver::name</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l01116">stub_callback()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00042">stub_cancel()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;{</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> terrible_resolver = {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      .<a class="code" href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;Ed Wood&#39;s Filmography&quot;</span>,</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      .priority = 0,</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      .resolve = <a class="code" href="../../da/d14/test__dns_8c.html#af9d18ca4fc298a6c1590a3b76c092aab">fail_resolve</a>,</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      .cancel = <a class="code" href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a>,</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;   };</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;   <span class="keyword">struct </span>dns_resolve_data {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordtype">int</span> rr_type;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="keywordtype">int</span> rr_class;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <a class="code" href="../../d6/d51/dns__core_8h.html#a64f08db76c6a6c41dbf6603bbc333b93">ast_dns_resolve_callback</a> callback;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;   } resolves [] = {</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      { <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,           T_A,       C_IN,      <a class="code" href="../../da/d14/test__dns_8c.html#a9297cc5991195f91e0753ab66e8ea1c4">stub_callback</a> },</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, -1,        C_IN,      stub_callback },</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, 65536 + 1, C_IN,      stub_callback },</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A,       -1,        stub_callback },</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A,       65536 + 1, stub_callback },</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      { <span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A,       C_IN,      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> },</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   };</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/dcd/structast__dns__query__active.html">ast_dns_query_active</a> *active;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_resolve_async_off_nominal&quot;</span>;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test off-nominal asynchronous DNS resolution&quot;</span>;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;         <span class="stringliteral">&quot;This test performs several off-nominal asynchronous DNS resolutions:\n&quot;</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with NULL name\n&quot;</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with invalid RR type\n&quot;</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with invalid RR class\n&quot;</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with NULL callback pointer\n&quot;</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;         <span class="stringliteral">&quot;\t* Attempt resolution with resolver that returns an error&quot;</span>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>)) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to register test resolver\n&quot;</span>);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;   }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(resolves); ++i) {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      active = <a class="code" href="../../d6/d51/dns__core_8h.html#a67e1cfb2c7b24d45cf003d49923f5d9f">ast_dns_resolve_async</a>(resolves[i].<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, resolves[i].rr_type, resolves[i].rr_class,</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            resolves[i].callback, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">if</span> (active) {</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;         <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully performed asynchronous resolution with invalid data\n&quot;</span>);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(active, -1);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;         res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   }</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;terrible_resolver)) {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to register the DNS resolver\n&quot;</span>);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;   }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;   active = <a class="code" href="../../d6/d51/dns__core_8h.html#a67e1cfb2c7b24d45cf003d49923f5d9f">ast_dns_resolve_async</a>(<span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A, C_IN, <a class="code" href="../../da/d14/test__dns_8c.html#a9297cc5991195f91e0753ab66e8ea1c4">stub_callback</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;terrible_resolver);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   <span class="keywordflow">if</span> (active) {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Successfully performed asynchronous resolution with invalid data\n&quot;</span>);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(active, -1);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;   }</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="dns__core_8h_html_a64f08db76c6a6c41dbf6603bbc333b93"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a64f08db76c6a6c41dbf6603bbc333b93">ast_dns_resolve_callback</a></div><div class="ttdeci">void(* ast_dns_resolve_callback)(const struct ast_dns_query *query)</div><div class="ttdoc">Callback invoked when a query completes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d51/dns__core_8h_source.html#l00171">dns_core.h:171</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="dns__core_8h_html_a67e1cfb2c7b24d45cf003d49923f5d9f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a67e1cfb2c7b24d45cf003d49923f5d9f">ast_dns_resolve_async</a></div><div class="ttdeci">struct ast_dns_query_active * ast_dns_resolve_async(const char *name, int rr_type, int rr_class, ast_dns_resolve_callback callback, void *data)</div><div class="ttdoc">Asynchronously resolve a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00247">dns_core.c:247</a></div></div>
<div class="ttc" id="test__dns_8c_html_a9297cc5991195f91e0753ab66e8ea1c4"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a9297cc5991195f91e0753ab66e8ea1c4">stub_callback</a></div><div class="ttdeci">static void stub_callback(const struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l01116">test_dns.c:1116</a></div></div>
<div class="ttc" id="test__dns_8c_html_a530620b8a056d611a56ba6ec615df63b"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a></div><div class="ttdeci">static struct ast_dns_resolver test_resolver</div><div class="ttdoc">The mock resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00774">test_dns.c:774</a></div></div>
<div class="ttc" id="test__dns_8c_html_a5f41ce4b5edac703c91c6aa4aba14a5d"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a5f41ce4b5edac703c91c6aa4aba14a5d">stub_cancel</a></div><div class="ttdeci">static int stub_cancel(struct ast_dns_query *query)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00042">test_dns.c:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structast__dns__resolver_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html#a8f8f80d37794cde9472343e4487ba3eb">ast_dns_resolver::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of the resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00034">dns_resolver.h:34</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a7cf990e0d32f790b61b1cdffc6f005a2"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a></div><div class="ttdeci">int ast_dns_resolver_register(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Register a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00630">dns_core.c:630</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__dns__query__active_html"><div class="ttname"><a href="../../d8/dcd/structast__dns__query__active.html">ast_dns_query_active</a></div><div class="ttdoc">An active DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00201">dns_internal.h:201</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="structast__dns__resolver_html"><div class="ttname"><a href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a></div><div class="ttdoc">DNS resolver implementation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da7/dns__resolver_8h_source.html#l00032">dns_resolver.h:32</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__dns_8c_html_af9d18ca4fc298a6c1590a3b76c092aab"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#af9d18ca4fc298a6c1590a3b76c092aab">fail_resolve</a></div><div class="ttdeci">static int fail_resolve(struct ast_dns_query *query)</div><div class="ttdoc">A resolve() method that simply fails. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00857">test_dns.c:857</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa46614cc1dd1e12abaabcacff278487d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa46614cc1dd1e12abaabcacff278487d">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[13/13]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">resolver_resolve_async_cancel&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01200">1200</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00204">ast_cond_timedwait</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00077">ast_dns_query_get_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00247">ast_dns_resolve_async()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00272">ast_dns_resolve_cancel()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00630">ast_dns_resolver_register()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00680">ast_dns_resolver_unregister()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00177">ast_tsnow()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l01008">async_callback()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00983">async_data_alloc()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00648">resolver_data::canceled</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">cleanup()</a>, <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00610">async_data::complete</a>, <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00612">async_data::cond</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00611">async_data::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00650">resolver_data::resolution_complete</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00646">resolver_data::resolve_called</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00761">resolver_data_cleanup()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00746">resolver_data_init()</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>
<div class="fragment"><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;{</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a> *, <a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/dcd/structast__dns__query__active.html">ast_dns_query_active</a> *, active, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;   <span class="keyword">struct </span>timespec <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;resolver_resolve_async_cancel&quot;</span>;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/main/dns/&quot;</span>;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test canceling an asynchronous DNS resolution&quot;</span>;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;         <span class="stringliteral">&quot;This test performs an asynchronous DNS resolution of a domain and then cancels\n&quot;</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;         <span class="stringliteral">&quot;the resolution. The goal of this test is to ensure that the cancel() callback of\n&quot;</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         <span class="stringliteral">&quot;the resolver is called and that it properly interrupts the resolution such that no\n&quot;</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;         <span class="stringliteral">&quot;records are returned.&quot;</span>;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>)) {</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Unable to register test resolver\n&quot;</span>);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   }</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ab741e73a3fcaafba5724cb28bf7aece4">resolver_data_init</a>();</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;   <a class="code" href="../../d2/d9c/structasync__data.html">async_data</a> = <a class="code" href="../../da/d14/test__dns_8c.html#aa7f1e6c33538ed73025433d963601b68">async_data_alloc</a>();</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>) {</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to allocate asynchronous data\n&quot;</span>);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   }</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   active = <a class="code" href="../../d6/d51/dns__core_8h.html#a67e1cfb2c7b24d45cf003d49923f5d9f">ast_dns_resolve_async</a>(<span class="stringliteral">&quot;asterisk.org&quot;</span>, T_A, C_IN, <a class="code" href="../../da/d14/test__dns_8c.html#aed3c37596cb5a728433115e6d427b92d">async_callback</a>, <a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;   <span class="keywordflow">if</span> (!active) {</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Asynchronous resolution of address failed\n&quot;</span>);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolve_called</a>) {</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;DNS resolution did not call resolver&#39;s resolve() method\n&quot;</span>);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;   }</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a>) {</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resolver&#39;s cancel() method called for no reason\n&quot;</span>);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   }</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   <a class="code" href="../../d6/d51/dns__core_8h.html#a431d6a3e91423d63efdcbe645f23d223">ast_dns_resolve_cancel</a>(active);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a>) {</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resolver&#39;s cancel() method was not called\n&quot;</span>);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../de/df7/time_8h.html#a231d7586bf7d913fe4756047fd8def5e">ast_tsnow</a>();</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>.tv_sec += 10;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;   <span class="keywordflow">while</span> (!<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#a520408f4775914f7510cc59db5a60b38">complete</a>) {</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d42/lock_8h.html#a6add1f30b2d53ca9384b15529a6f126e">ast_cond_timedwait</a>(&amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, &amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>) == ETIMEDOUT) {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      }</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;   }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>-&gt;<a class="code" href="../../d2/d9c/structasync__data.html#a520408f4775914f7510cc59db5a60b38">complete</a>) {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Asynchronous resolution timed out\n&quot;</span>);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolution_complete</a>) {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Resolution completed without cancelation\n&quot;</span>);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;   }</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;   result = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(active-&gt;query);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Canceled resolution had a result\n&quot;</span>);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>:</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a>);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#a66d40e3200575a80d2ab6ed5ae1efdaa">resolver_data_cleanup</a>();</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;}</div><div class="ttc" id="structasync__data_html"><div class="ttname"><a href="../../d2/d9c/structasync__data.html">async_data</a></div><div class="ttdoc">Data required for an asynchronous callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00602">res_resolver_unbound.c:602</a></div></div>
<div class="ttc" id="structasync__resolution__data_html"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a></div><div class="ttdoc">Data used by async result callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00957">test_dns.c:957</a></div></div>
<div class="ttc" id="test__dns_8c_html_ab741e73a3fcaafba5724cb28bf7aece4"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ab741e73a3fcaafba5724cb28bf7aece4">resolver_data_init</a></div><div class="ttdeci">static void resolver_data_init(void)</div><div class="ttdoc">Initialize global mock resolver data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00746">test_dns.c:746</a></div></div>
<div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="structresolver__data_html_abd2f63f5e9e25d6c9463ba596b645ed9"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolver_data::resolve_called</a></div><div class="ttdeci">int resolve_called</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00646">test_dns.c:646</a></div></div>
<div class="ttc" id="structasync__data_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../d2/d9c/structasync__data.html#a1c7181c39f99ee801943a0d0aa9872b9">async_data::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00612">res_resolver_unbound.c:612</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_aef7d827099f07e77891ab28255079399"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#aef7d827099f07e77891ab28255079399">ast_dns_resolver_unregister</a></div><div class="ttdeci">void ast_dns_resolver_unregister(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Unregister a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00680">dns_core.c:680</a></div></div>
<div class="ttc" id="structasync__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d2/d9c/structasync__data.html#adf04f66344e3fb0a6f6a69bf39d19902">async_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00611">res_resolver_unbound.c:611</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="dns__core_8h_html_a67e1cfb2c7b24d45cf003d49923f5d9f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a67e1cfb2c7b24d45cf003d49923f5d9f">ast_dns_resolve_async</a></div><div class="ttdeci">struct ast_dns_query_active * ast_dns_resolve_async(const char *name, int rr_type, int rr_class, ast_dns_resolve_callback callback, void *data)</div><div class="ttdoc">Asynchronously resolve a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00247">dns_core.c:247</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="test__dns_8c_html_a530620b8a056d611a56ba6ec615df63b"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a530620b8a056d611a56ba6ec615df63b">test_resolver</a></div><div class="ttdeci">static struct ast_dns_resolver test_resolver</div><div class="ttdoc">The mock resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00774">test_dns.c:774</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="structresolver__data_html_a5be8d5942595cc4bf15ae9b105345134"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolver_data::resolution_complete</a></div><div class="ttdeci">int resolution_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00650">test_dns.c:650</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a7cf990e0d32f790b61b1cdffc6f005a2"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a7cf990e0d32f790b61b1cdffc6f005a2">ast_dns_resolver_register</a></div><div class="ttdeci">int ast_dns_resolver_register(struct ast_dns_resolver *resolver)</div><div class="ttdoc">Register a DNS resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00630">dns_core.c:630</a></div></div>
<div class="ttc" id="test__dns_8c_html_aed3c37596cb5a728433115e6d427b92d"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#aed3c37596cb5a728433115e6d427b92d">async_callback</a></div><div class="ttdeci">static void async_callback(const struct ast_dns_query *query)</div><div class="ttdoc">Async DNS callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l01008">test_dns.c:1008</a></div></div>
<div class="ttc" id="test__dns_8c_html_aa7f1e6c33538ed73025433d963601b68"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#aa7f1e6c33538ed73025433d963601b68">async_data_alloc</a></div><div class="ttdeci">static struct async_resolution_data * async_data_alloc(void)</div><div class="ttdoc">Allocation/initialization for async_resolution_data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00983">test_dns.c:983</a></div></div>
<div class="ttc" id="structasync__data_html_a520408f4775914f7510cc59db5a60b38"><div class="ttname"><a href="../../d2/d9c/structasync__data.html#a520408f4775914f7510cc59db5a60b38">async_data::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00610">res_resolver_unbound.c:610</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="structast__dns__query__active_html"><div class="ttname"><a href="../../d8/dcd/structast__dns__query__active.html">ast_dns_query_active</a></div><div class="ttdoc">An active DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00201">dns_internal.h:201</a></div></div>
<div class="ttc" id="dns__core_8h_html_a39c90d1f2d020fff6587d8014ca57da8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a></div><div class="ttdeci">struct ast_dns_result * ast_dns_query_get_result(const struct ast_dns_query *query)</div><div class="ttdoc">Get the result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00077">dns_core.c:77</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_a10b51e1931bd03dd172cbfb9d3d67efb"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a></div><div class="ttdeci">static void * cleanup(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">pbx_realtime.c:124</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="dns__core_8h_html_a431d6a3e91423d63efdcbe645f23d223"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a431d6a3e91423d63efdcbe645f23d223">ast_dns_resolve_cancel</a></div><div class="ttdeci">int ast_dns_resolve_cancel(struct ast_dns_query_active *active)</div><div class="ttdoc">Cancel an asynchronous DNS resolution. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00272">dns_core.c:272</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="time_8h_html_a231d7586bf7d913fe4756047fd8def5e"><div class="ttname"><a href="../../de/df7/time_8h.html#a231d7586bf7d913fe4756047fd8def5e">ast_tsnow</a></div><div class="ttdeci">struct timespec ast_tsnow(void)</div><div class="ttdoc">Returns current timespec. Meant to avoid calling ast_tvnow() just to create a timespec from the timev...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00177">time.h:177</a></div></div>
<div class="ttc" id="structresolver__data_html_a7a04d6ad2bbf6f268250358467407c37"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">resolver_data::canceled</a></div><div class="ttdeci">int canceled</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00648">test_dns.c:648</a></div></div>
<div class="ttc" id="test__dns_8c_html_a66d40e3200575a80d2ab6ed5ae1efdaa"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a66d40e3200575a80d2ab6ed5ae1efdaa">resolver_data_cleanup</a></div><div class="ttdeci">static void resolver_data_cleanup(void)</div><div class="ttdoc">Cleanup global mock resolver data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00761">test_dns.c:761</a></div></div>
<div class="ttc" id="lock_8h_html_a6add1f30b2d53ca9384b15529a6f126e"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6add1f30b2d53ca9384b15529a6f126e">ast_cond_timedwait</a></div><div class="ttdeci">#define ast_cond_timedwait(cond, mutex, time)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00204">lock.h:204</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aed3c37596cb5a728433115e6d427b92d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed3c37596cb5a728433115e6d427b92d">&#9670;&nbsp;</a></span>async_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void async_callback </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Async DNS callback. </p>
<p>This is called when an async query completes, either because it resolved or because it was canceled. In our case, this callback is used to signal to the test that it can continue</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query</td><td>The DNS query that has completed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01008">1008</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00072">ast_dns_query_get_data()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00958">async_resolution_data::complete</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00960">async_resolution_data::cond</a>, and <a class="el" href="../../da/d14/test__dns_8c_source.html#l00959">async_resolution_data::lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l01018">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;{</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a> *<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a> = <a class="code" href="../../d6/d51/dns__core_8h.html#a4c14cc60e6bf38af12b6af632ffb1fff">ast_dns_query_get_data</a>(query);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;   async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#a520408f4775914f7510cc59db5a60b38">complete</a> = 1;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;}</div><div class="ttc" id="structasync__data_html"><div class="ttname"><a href="../../d2/d9c/structasync__data.html">async_data</a></div><div class="ttdoc">Data required for an asynchronous callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00602">res_resolver_unbound.c:602</a></div></div>
<div class="ttc" id="structasync__resolution__data_html"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a></div><div class="ttdoc">Data used by async result callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00957">test_dns.c:957</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#a1c7181c39f99ee801943a0d0aa9872b9">async_resolution_data::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00960">test_dns.c:960</a></div></div>
<div class="ttc" id="dns__core_8h_html_a4c14cc60e6bf38af12b6af632ffb1fff"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a4c14cc60e6bf38af12b6af632ffb1fff">ast_dns_query_get_data</a></div><div class="ttdeci">void * ast_dns_query_get_data(const struct ast_dns_query *query)</div><div class="ttdoc">Get the user specific data of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00072">dns_core.c:72</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#adf04f66344e3fb0a6f6a69bf39d19902">async_resolution_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00959">test_dns.c:959</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_a520408f4775914f7510cc59db5a60b38"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#a520408f4775914f7510cc59db5a60b38">async_resolution_data::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00958">test_dns.c:958</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7f1e6c33538ed73025433d963601b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7f1e6c33538ed73025433d963601b68">&#9670;&nbsp;</a></span>async_data_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a>* async_data_alloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocation/initialization for <a class="el" href="../../dd/d15/structasync__resolution__data.html" title="Data used by async result callback. ">async_resolution_data</a>. </p>
<p>The DNS core mandates that a query's user data has to be ao2 allocated, so this is a helper method for doing that.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed allocation </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Newly allocated <a class="el" href="../../dd/d15/structasync__resolution__data.html" title="Data used by async result callback. ">async_resolution_data</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00983">983</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00199">ast_cond_init</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00184">ast_mutex_init</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00966">async_data_destructor()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00958">async_resolution_data::complete</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00960">async_resolution_data::cond</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00959">async_resolution_data::lock</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l01018">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;{</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a> *<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a>;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;   async_data = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*async_data), <a class="code" href="../../da/d14/test__dns_8c.html#ab517f9e6e55d67b8b83c861ef8cfacc9">async_data_destructor</a>);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;   <span class="keywordflow">if</span> (!async_data) {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;   }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;   async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#a520408f4775914f7510cc59db5a60b38">complete</a> = 0;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <span class="keywordflow">return</span> async_data;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_ab517f9e6e55d67b8b83c861ef8cfacc9"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ab517f9e6e55d67b8b83c861ef8cfacc9">async_data_destructor</a></div><div class="ttdeci">static void async_data_destructor(void *obj)</div><div class="ttdoc">Destructor for async_resolution_data. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00966">test_dns.c:966</a></div></div>
<div class="ttc" id="structasync__data_html"><div class="ttname"><a href="../../d2/d9c/structasync__data.html">async_data</a></div><div class="ttdoc">Data required for an asynchronous callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00602">res_resolver_unbound.c:602</a></div></div>
<div class="ttc" id="structasync__resolution__data_html"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a></div><div class="ttdoc">Data used by async result callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00957">test_dns.c:957</a></div></div>
<div class="ttc" id="lock_8h_html_a69e9591803d36f5683eb9b084442be9b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a></div><div class="ttdeci">#define ast_cond_init(cond, attr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00199">lock.h:199</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#a1c7181c39f99ee801943a0d0aa9872b9">async_resolution_data::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00960">test_dns.c:960</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#adf04f66344e3fb0a6f6a69bf39d19902">async_resolution_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00959">test_dns.c:959</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_a520408f4775914f7510cc59db5a60b38"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#a520408f4775914f7510cc59db5a60b38">async_resolution_data::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00958">test_dns.c:958</a></div></div>
<div class="ttc" id="lock_8h_html_a76e8ed6bb354be6c6dd9e51acc1d7a1b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a></div><div class="ttdeci">#define ast_mutex_init(pmutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00184">lock.h:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab517f9e6e55d67b8b83c861ef8cfacc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab517f9e6e55d67b8b83c861ef8cfacc9">&#9670;&nbsp;</a></span>async_data_destructor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void async_data_destructor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for <a class="el" href="../../dd/d15/structasync__resolution__data.html" title="Data used by async result callback. ">async_resolution_data</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00966">966</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00200">ast_cond_destroy</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00186">ast_mutex_destroy</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00960">async_resolution_data::cond</a>, and <a class="el" href="../../da/d14/test__dns_8c_source.html#l00959">async_resolution_data::lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00983">async_data_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;{</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a> *<a class="code" href="../../d2/d9c/structasync__data.html">async_data</a> = obj;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a>(&amp;async_data-&gt;<a class="code" href="../../dd/d15/structasync__resolution__data.html#a1c7181c39f99ee801943a0d0aa9872b9">cond</a>);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;}</div><div class="ttc" id="structasync__data_html"><div class="ttname"><a href="../../d2/d9c/structasync__data.html">async_data</a></div><div class="ttdoc">Data required for an asynchronous callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5c/res__resolver__unbound_8c_source.html#l00602">res_resolver_unbound.c:602</a></div></div>
<div class="ttc" id="structasync__resolution__data_html"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html">async_resolution_data</a></div><div class="ttdoc">Data used by async result callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00957">test_dns.c:957</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_a1c7181c39f99ee801943a0d0aa9872b9"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#a1c7181c39f99ee801943a0d0aa9872b9">async_resolution_data::cond</a></div><div class="ttdeci">ast_cond_t cond</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00960">test_dns.c:960</a></div></div>
<div class="ttc" id="lock_8h_html_a1ea2f4040a736cddbecea48b30ffedfd"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a></div><div class="ttdeci">#define ast_cond_destroy(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00200">lock.h:200</a></div></div>
<div class="ttc" id="structasync__resolution__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../dd/d15/structasync__resolution__data.html#adf04f66344e3fb0a6f6a69bf39d19902">async_resolution_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00959">test_dns.c:959</a></div></div>
<div class="ttc" id="lock_8h_html_ab8977a71822daa556f19f30ba6eec765"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a></div><div class="ttdeci">#define ast_mutex_destroy(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00186">lock.h:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af9d18ca4fc298a6c1590a3b76c092aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9d18ca4fc298a6c1590a3b76c092aab">&#9670;&nbsp;</a></span>fail_resolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int fail_resolve </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A resolve() method that simply fails. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query</td><td>The DNS query to resolve. This is ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00857">857</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00862">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;{</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01318">1318</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00127">AST_TEST_REGISTER</a>.</p>
<div class="fragment"><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;{</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_register_unregister);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_register_off_nominal);</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_unregister_off_nominal);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(<a class="code" href="../../d3/d4e/structresolver__data.html">resolver_data</a>);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_set_result);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_set_result_off_nominal);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_add_record);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_add_record_off_nominal);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_resolve_sync);</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_resolve_sync_off_nominal);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_resolve_async);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_resolve_async_off_nominal);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(resolver_resolve_async_cancel);</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;}</div><div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="test_8h_html_a34f64a69c09d98ceb693b077efd7ef97"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a></div><div class="ttdeci">#define AST_TEST_REGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00127">test.h:127</a></div></div>
<div class="ttc" id="structresolver__data_html"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html">resolver_data</a></div><div class="ttdoc">File-scoped data used during resolver tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00644">test_dns.c:644</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2607b002d7ef2ee9587fc97f431dda66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2607b002d7ef2ee9587fc97f431dda66">&#9670;&nbsp;</a></span>resolution_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* resolution_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dns_query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread spawned by the mock resolver. </p>
<p>All DNS resolvers are required to be asynchronous. The mock resolver spawns this thread for every DNS query that is executed.</p>
<p>This thread waits for 5 seconds and then returns the same A record every time. The 5 second wait is to allow for the query to be canceled if desired</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dns_query</td><td>The <a class="el" href="../../dd/daa/structast__dns__query.html" title="A DNS query. ">ast_dns_query</a> that is being resolved </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00670">670</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00204">ast_cond_timedwait</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00535">ast_dns_resolver_add_record()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00599">ast_dns_resolver_completed()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00456">ast_dns_resolver_set_result()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00177">ast_tsnow()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00654">resolver_data::cancel_cond</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00648">resolver_data::canceled</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00294">DNS_ANSWER</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00295">DNS_ANSWER_SIZE</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00652">resolver_data::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00650">resolver_data::resolution_complete</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00715">test_resolve()</a>.</p>
<div class="fragment"><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;{</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query = dns_query;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <span class="keyword">struct </span>timespec <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *V4 = <span class="stringliteral">&quot;127.0.0.1&quot;</span>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> V4_BUFSIZE = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>in_addr);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="keywordtype">char</span> v4_buf[V4_BUFSIZE];</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = <a class="code" href="../../de/df7/time_8h.html#a231d7586bf7d913fe4756047fd8def5e">ast_tsnow</a>();</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>.tv_sec += 5;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordflow">while</span> (!<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a>) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/d42/lock_8h.html#a6add1f30b2d53ca9384b15529a6f126e">ast_cond_timedwait</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">cancel_cond</a>, &amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>) == ETIMEDOUT) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a>) {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <a class="code" href="../../d9/da7/dns__resolver_8h.html#a3eae81285310e1c64e8cb9e59e79d2e9">ast_dns_resolver_completed</a>(query);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(query, -1);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a>(query, 0, 0, NOERROR, <span class="stringliteral">&quot;asterisk.org&quot;</span>, <a class="code" href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   inet_pton(AF_INET, V4, v4_buf);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a>(query, T_A, C_IN, 12345, v4_buf, V4_BUFSIZE);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolution_complete</a> = 1;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <a class="code" href="../../d9/da7/dns__resolver_8h.html#a3eae81285310e1c64e8cb9e59e79d2e9">ast_dns_resolver_completed</a>(query);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(query, -1);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_afc97a77c6a0610ac45975194f89a1e96"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#afc97a77c6a0610ac45975194f89a1e96">DNS_ANSWER</a></div><div class="ttdeci">#define DNS_ANSWER</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00294">test_dns.c:294</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_ae88ff57fdf06ba45b931609978be2611"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#ae88ff57fdf06ba45b931609978be2611">ast_dns_resolver_add_record</a></div><div class="ttdeci">int ast_dns_resolver_add_record(struct ast_dns_query *query, int rr_type, int rr_class, int ttl, const char *data, const size_t size)</div><div class="ttdoc">Add a DNS record to the result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00535">dns_core.c:535</a></div></div>
<div class="ttc" id="test__dns_8c_html_a31888cf993f4e4e7afbec462ea65e6fc"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a31888cf993f4e4e7afbec462ea65e6fc">DNS_ANSWER_SIZE</a></div><div class="ttdeci">#define DNS_ANSWER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00295">test_dns.c:295</a></div></div>
<div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structresolver__data_html_a5be8d5942595cc4bf15ae9b105345134"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolver_data::resolution_complete</a></div><div class="ttdeci">int resolution_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00650">test_dns.c:650</a></div></div>
<div class="ttc" id="structresolver__data_html_ae5a45dae03d2a7e38b46a90d3a327286"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">resolver_data::cancel_cond</a></div><div class="ttdeci">ast_cond_t cancel_cond</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00654">test_dns.c:654</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a3eae81285310e1c64e8cb9e59e79d2e9"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a3eae81285310e1c64e8cb9e59e79d2e9">ast_dns_resolver_completed</a></div><div class="ttdeci">void ast_dns_resolver_completed(struct ast_dns_query *query)</div><div class="ttdoc">Mark a DNS query as having been completed. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00599">dns_core.c:599</a></div></div>
<div class="ttc" id="structast__dns__query_html"><div class="ttname"><a href="../../dd/daa/structast__dns__query.html">ast_dns_query</a></div><div class="ttdoc">A DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00137">dns_internal.h:137</a></div></div>
<div class="ttc" id="structresolver__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">resolver_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00652">test_dns.c:652</a></div></div>
<div class="ttc" id="time_8h_html_a231d7586bf7d913fe4756047fd8def5e"><div class="ttname"><a href="../../de/df7/time_8h.html#a231d7586bf7d913fe4756047fd8def5e">ast_tsnow</a></div><div class="ttdeci">struct timespec ast_tsnow(void)</div><div class="ttdoc">Returns current timespec. Meant to avoid calling ast_tvnow() just to create a timespec from the timev...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00177">time.h:177</a></div></div>
<div class="ttc" id="structresolver__data_html_a7a04d6ad2bbf6f268250358467407c37"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">resolver_data::canceled</a></div><div class="ttdeci">int canceled</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00648">test_dns.c:648</a></div></div>
<div class="ttc" id="dns__resolver_8h_html_a321df8f3250551f796c99524dbcc2567"><div class="ttname"><a href="../../d9/da7/dns__resolver_8h.html#a321df8f3250551f796c99524dbcc2567">ast_dns_resolver_set_result</a></div><div class="ttdeci">int ast_dns_resolver_set_result(struct ast_dns_query *query, unsigned int secure, unsigned int bogus, unsigned int rcode, const char *canonical, const char *answer, size_t answer_size)</div><div class="ttdoc">Set result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00456">dns_core.c:456</a></div></div>
<div class="ttc" id="lock_8h_html_a6add1f30b2d53ca9384b15529a6f126e"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6add1f30b2d53ca9384b15529a6f126e">ast_cond_timedwait</a></div><div class="ttdeci">#define ast_cond_timedwait(cond, mutex, time)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00204">lock.h:204</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66d40e3200575a80d2ab6ed5ae1efdaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66d40e3200575a80d2ab6ed5ae1efdaa">&#9670;&nbsp;</a></span>resolver_data_cleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void resolver_data_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cleanup global mock resolver data. </p>
<p>This must be called at the end of tests that use the mock resolver </p>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00761">761</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00200">ast_cond_destroy</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00186">ast_mutex_destroy</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00654">resolver_data::cancel_cond</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00652">resolver_data::lock</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00781">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;{</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">cancel_cond</a>);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="structresolver__data_html_ae5a45dae03d2a7e38b46a90d3a327286"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">resolver_data::cancel_cond</a></div><div class="ttdeci">ast_cond_t cancel_cond</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00654">test_dns.c:654</a></div></div>
<div class="ttc" id="lock_8h_html_a1ea2f4040a736cddbecea48b30ffedfd"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a></div><div class="ttdeci">#define ast_cond_destroy(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00200">lock.h:200</a></div></div>
<div class="ttc" id="structresolver__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">resolver_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00652">test_dns.c:652</a></div></div>
<div class="ttc" id="lock_8h_html_ab8977a71822daa556f19f30ba6eec765"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a></div><div class="ttdeci">#define ast_mutex_destroy(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00186">lock.h:186</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab741e73a3fcaafba5724cb28bf7aece4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab741e73a3fcaafba5724cb28bf7aece4">&#9670;&nbsp;</a></span>resolver_data_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void resolver_data_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize global mock resolver data. </p>
<p>This must be called at the beginning of tests that use the mock resolver </p>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00746">746</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00199">ast_cond_init</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00184">ast_mutex_init</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00654">resolver_data::cancel_cond</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00648">resolver_data::canceled</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00652">resolver_data::lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00650">resolver_data::resolution_complete</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00646">resolver_data::resolve_called</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00781">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;{</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolve_called</a> = 0;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a> = 0;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolution_complete</a> = 0;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">cancel_cond</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="structresolver__data_html_abd2f63f5e9e25d6c9463ba596b645ed9"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolver_data::resolve_called</a></div><div class="ttdeci">int resolve_called</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00646">test_dns.c:646</a></div></div>
<div class="ttc" id="lock_8h_html_a69e9591803d36f5683eb9b084442be9b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a></div><div class="ttdeci">#define ast_cond_init(cond, attr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00199">lock.h:199</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structresolver__data_html_a5be8d5942595cc4bf15ae9b105345134"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a5be8d5942595cc4bf15ae9b105345134">resolver_data::resolution_complete</a></div><div class="ttdeci">int resolution_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00650">test_dns.c:650</a></div></div>
<div class="ttc" id="structresolver__data_html_ae5a45dae03d2a7e38b46a90d3a327286"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">resolver_data::cancel_cond</a></div><div class="ttdeci">ast_cond_t cancel_cond</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00654">test_dns.c:654</a></div></div>
<div class="ttc" id="structresolver__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">resolver_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00652">test_dns.c:652</a></div></div>
<div class="ttc" id="lock_8h_html_a76e8ed6bb354be6c6dd9e51acc1d7a1b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a></div><div class="ttdeci">#define ast_mutex_init(pmutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00184">lock.h:184</a></div></div>
<div class="ttc" id="structresolver__data_html_a7a04d6ad2bbf6f268250358467407c37"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">resolver_data::canceled</a></div><div class="ttdeci">int canceled</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00648">test_dns.c:648</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9297cc5991195f91e0753ab66e8ea1c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9297cc5991195f91e0753ab66e8ea1c4">&#9670;&nbsp;</a></span>stub_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void stub_callback </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stub async resolution callback </p>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01116">1116</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l01121">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;{</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a5f41ce4b5edac703c91c6aa4aba14a5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f41ce4b5edac703c91c6aa4aba14a5d">&#9670;&nbsp;</a></span>stub_cancel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int stub_cancel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00042">42</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00047">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a0ac9da5d3ada597ee3f5dc8372baf1f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ac9da5d3ada597ee3f5dc8372baf1f6">&#9670;&nbsp;</a></span>stub_resolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int stub_resolve </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00036">36</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00047">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a70e0c6a990cc94182afa0b73202a7c17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70e0c6a990cc94182afa0b73202a7c17">&#9670;&nbsp;</a></span>test_cancel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_cancel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mock resolver's cancel method. </p>
<p>This signals the resolution thread not to return any DNS results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query</td><td>DNS query to cancel </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00731">731</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00654">resolver_data::cancel_cond</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00648">resolver_data::canceled</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00652">resolver_data::lock</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>
<div class="fragment"><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">canceled</a> = 1;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">cancel_cond</a>);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="structresolver__data_html_ae5a45dae03d2a7e38b46a90d3a327286"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#ae5a45dae03d2a7e38b46a90d3a327286">resolver_data::cancel_cond</a></div><div class="ttdeci">ast_cond_t cancel_cond</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00654">test_dns.c:654</a></div></div>
<div class="ttc" id="structresolver__data_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#adf04f66344e3fb0a6f6a69bf39d19902">resolver_data::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00652">test_dns.c:652</a></div></div>
<div class="ttc" id="structresolver__data_html_a7a04d6ad2bbf6f268250358467407c37"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#a7a04d6ad2bbf6f268250358467407c37">resolver_data::canceled</a></div><div class="ttdeci">int canceled</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00648">test_dns.c:648</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea83082d294e18cd3ef8a4972ebfd322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea83082d294e18cd3ef8a4972ebfd322">&#9670;&nbsp;</a></span>test_record()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_record </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rr_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rr_class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ttl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00395">395</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00160">ast_dns_record_get_data()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00150">ast_dns_record_get_rr_class()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00155">ast_dns_record_get_ttl()</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00421">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) != rr_type) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Unexpected rr_type from DNS record\n&quot;</span>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#a2881bf7bbcf5aa487c98a402585a2c4e">ast_dns_record_get_rr_class</a>(record) != rr_class) {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Unexpected rr_class from DNS record\n&quot;</span>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#a3389d9f5ccb22eed7c90c37ce4e17fa8">ast_dns_record_get_ttl</a>(record) != ttl) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Unexpected ttl from DNS record\n&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">if</span> (memcmp(<a class="code" href="../../d6/d51/dns__core_8h.html#ae505e5cf22102f5a39588cec5708a1ad">ast_dns_record_get_data</a>(record), data, size)) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Unexpected data in DNS record\n&quot;</span>);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;}</div><div class="ttc" id="dns__core_8h_html_a3389d9f5ccb22eed7c90c37ce4e17fa8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a3389d9f5ccb22eed7c90c37ce4e17fa8">ast_dns_record_get_ttl</a></div><div class="ttdeci">int ast_dns_record_get_ttl(const struct ast_dns_record *record)</div><div class="ttdoc">Get the TTL of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00155">dns_core.c:155</a></div></div>
<div class="ttc" id="dns__core_8h_html_ae505e5cf22102f5a39588cec5708a1ad"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#ae505e5cf22102f5a39588cec5708a1ad">ast_dns_record_get_data</a></div><div class="ttdeci">const char * ast_dns_record_get_data(const struct ast_dns_record *record)</div><div class="ttdoc">Retrieve the raw DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00160">dns_core.c:160</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="dns__core_8h_html_a2881bf7bbcf5aa487c98a402585a2c4e"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a2881bf7bbcf5aa487c98a402585a2c4e">ast_dns_record_get_rr_class</a></div><div class="ttdeci">int ast_dns_record_get_rr_class(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record class of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00150">dns_core.c:150</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a75adcbb156f9eb67c5d5f044b3d7f20c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75adcbb156f9eb67c5d5f044b3d7f20c">&#9670;&nbsp;</a></span>test_resolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_resolve </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mock resolver's resolve method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query</td><td>The query to resolve </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Successfully spawned resolution thread </td></tr>
    <tr><td class="paramname">non-zero</td><td>Failed to spawn the resolution thread </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00715">715</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00563">ast_pthread_create_detached</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00670">resolution_thread()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00646">resolver_data::resolve_called</a>, and <a class="el" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.</p>
<div class="fragment"><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;{</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   pthread_t resolver_thread;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   <a class="code" href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a>.<a class="code" href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolve_called</a> = 1;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a>(&amp;resolver_thread, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../da/d14/test__dns_8c.html#a2607b002d7ef2ee9587fc97f431dda66">resolution_thread</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(query));</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div><div class="ttc" id="test__dns_8c_html_ad4f581dd0678d1cedb456334d4208134"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#ad4f581dd0678d1cedb456334d4208134">test_resolver_data</a></div><div class="ttdeci">static struct resolver_data test_resolver_data</div></div>
<div class="ttc" id="structresolver__data_html_abd2f63f5e9e25d6c9463ba596b645ed9"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html#abd2f63f5e9e25d6c9463ba596b645ed9">resolver_data::resolve_called</a></div><div class="ttdeci">int resolve_called</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00646">test_dns.c:646</a></div></div>
<div class="ttc" id="utils_8h_html_a832647380b1f97e7ac1b4492f8816d46"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a></div><div class="ttdeci">#define ast_pthread_create_detached(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00563">utils.h:563</a></div></div>
<div class="ttc" id="test__dns_8c_html_a2607b002d7ef2ee9587fc97f431dda66"><div class="ttname"><a href="../../da/d14/test__dns_8c.html#a2607b002d7ef2ee9587fc97f431dda66">resolution_thread</a></div><div class="ttdeci">static void * resolution_thread(void *dns_query)</div><div class="ttdoc">Thread spawned by the mock resolver. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00670">test_dns.c:670</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3adf24b209cfe1c8c0ac5f096d17436"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3adf24b209cfe1c8c0ac5f096d17436">&#9670;&nbsp;</a></span>test_results()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_results </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>expected_secure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>expected_bogus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>expected_rcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>expected_canonical</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>expected_answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>answer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00265">265</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00077">ast_dns_query_get_result()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00107">ast_dns_result_get_answer()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00087">ast_dns_result_get_bogus()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00097">ast_dns_result_get_canonical()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00092">ast_dns_result_get_rcode()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00082">ast_dns_result_get_secure()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, and <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00297">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   result = <a class="code" href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a>(query);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">if</span> (!result) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Unable to retrieve result from query\n&quot;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d51/dns__core_8h.html#ada6afb9cb935105d2f391b583e63933a">ast_dns_result_get_secure</a>(result) != expected_secure ||</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;         <a class="code" href="../../d6/d51/dns__core_8h.html#abf0dd7d26b3716a4dec140a3c5df48ae">ast_dns_result_get_bogus</a>(result) != expected_bogus ||</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         <a class="code" href="../../d6/d51/dns__core_8h.html#a6d8c6d6721c555cd8320e39d75aae059">ast_dns_result_get_rcode</a>(result) != expected_rcode ||</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         strcmp(<a class="code" href="../../d6/d51/dns__core_8h.html#a21e1d3cdbb282892437c30d5ee530f19">ast_dns_result_get_canonical</a>(result), expected_canonical) ||</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         memcmp(<a class="code" href="../../d6/d51/dns__core_8h.html#a99981477ae3cfdc4a30db984a92aae4a">ast_dns_result_get_answer</a>(result), expected_answer, <a class="code" href="../../d5/d8d/structast__dns__result.html#a60e7f19e0a67dbea7e21c74f1a225fef">answer_size</a>)) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(test, <span class="stringliteral">&quot;Unexpected values in result from query\n&quot;</span>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div><div class="ttc" id="dns__core_8h_html_ada6afb9cb935105d2f391b583e63933a"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#ada6afb9cb935105d2f391b583e63933a">ast_dns_result_get_secure</a></div><div class="ttdeci">unsigned int ast_dns_result_get_secure(const struct ast_dns_result *result)</div><div class="ttdoc">Get whether the result is secure or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00082">dns_core.c:82</a></div></div>
<div class="ttc" id="dns__core_8h_html_abf0dd7d26b3716a4dec140a3c5df48ae"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abf0dd7d26b3716a4dec140a3c5df48ae">ast_dns_result_get_bogus</a></div><div class="ttdeci">unsigned int ast_dns_result_get_bogus(const struct ast_dns_result *result)</div><div class="ttdoc">Get whether the result is bogus or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00087">dns_core.c:87</a></div></div>
<div class="ttc" id="dns__core_8h_html_a99981477ae3cfdc4a30db984a92aae4a"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a99981477ae3cfdc4a30db984a92aae4a">ast_dns_result_get_answer</a></div><div class="ttdeci">const char * ast_dns_result_get_answer(const struct ast_dns_result *result)</div><div class="ttdoc">Get the raw DNS answer from a DNS result. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00107">dns_core.c:107</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structast__dns__result_html"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a></div><div class="ttdoc">The result of a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00117">dns_internal.h:117</a></div></div>
<div class="ttc" id="dns__core_8h_html_a39c90d1f2d020fff6587d8014ca57da8"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a39c90d1f2d020fff6587d8014ca57da8">ast_dns_query_get_result</a></div><div class="ttdeci">struct ast_dns_result * ast_dns_query_get_result(const struct ast_dns_query *query)</div><div class="ttdoc">Get the result information for a DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00077">dns_core.c:77</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="structast__dns__result_html_a60e7f19e0a67dbea7e21c74f1a225fef"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html#a60e7f19e0a67dbea7e21c74f1a225fef">ast_dns_result::answer_size</a></div><div class="ttdeci">size_t answer_size</div><div class="ttdoc">The size of the raw DNS answer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00131">dns_internal.h:131</a></div></div>
<div class="ttc" id="dns__core_8h_html_a21e1d3cdbb282892437c30d5ee530f19"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a21e1d3cdbb282892437c30d5ee530f19">ast_dns_result_get_canonical</a></div><div class="ttdeci">const char * ast_dns_result_get_canonical(const struct ast_dns_result *result)</div><div class="ttdoc">Get the canonical name of the result. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00097">dns_core.c:97</a></div></div>
<div class="ttc" id="dns__core_8h_html_a6d8c6d6721c555cd8320e39d75aae059"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#a6d8c6d6721c555cd8320e39d75aae059">ast_dns_result_get_rcode</a></div><div class="ttdeci">unsigned int ast_dns_result_get_rcode(const struct ast_dns_result *result)</div><div class="ttdoc">Get the error rcode of a DN result. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00092">dns_core.c:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01299">1299</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/ddc/test_8h_source.html#l00128">AST_TEST_UNREGISTER</a>.</p>
<div class="fragment"><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;{</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_register_unregister);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_register_off_nominal);</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_unregister_off_nominal);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(<a class="code" href="../../d3/d4e/structresolver__data.html">resolver_data</a>);</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_set_result);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_set_result_off_nominal);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_add_record);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_add_record_off_nominal);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_resolve_sync);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_resolve_sync_off_nominal);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_resolve_async);</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_resolve_async_off_nominal);</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(resolver_resolve_async_cancel);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;}</div><div class="ttc" id="structresolver__data_html"><div class="ttname"><a href="../../d3/d4e/structresolver__data.html">resolver_data</a></div><div class="ttdoc">File-scoped data used during resolver tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d14/test__dns_8c_source.html#l00644">test_dns.c:644</a></div></div>
<div class="ttc" id="test_8h_html_a79bc64a935b14b1b181156e5ada58ead"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a></div><div class="ttdeci">#define AST_TEST_UNREGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00128">test.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;DNS API Tests&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .load_pri = <a class="el" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a1d1eb207e01a2d3bf6aa6ba271c27dee">AST_MODPRI_DEFAULT</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01337">1337</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l01337">1337</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

</div>
</div>
<a id="a530620b8a056d611a56ba6ec615df63b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530620b8a056d611a56ba6ec615df63b">&#9670;&nbsp;</a></span>test_resolver</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d6f/structast__dns__resolver.html">ast_dns_resolver</a> test_resolver</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The mock resolver. </p>
<p>The mock resolver does not care about the DNS query that is actually being made on it. It simply regurgitates the same DNS record no matter what. </p>

<p class="definition">Definition at line <a class="el" href="../../da/d14/test__dns_8c_source.html#l00774">774</a> of file <a class="el" href="../../da/d14/test__dns_8c_source.html">test_dns.c</a>.</p>

</div>
</div>
<a id="ad4f581dd0678d1cedb456334d4208134"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f581dd0678d1cedb456334d4208134">&#9670;&nbsp;</a></span>test_resolver_data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d4e/structresolver__data.html">resolver_data</a>  test_resolver_data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../da/d14/test__dns_8c_source.html#l00781">AST_TEST_DEFINE()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00670">resolution_thread()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00761">resolver_data_cleanup()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00746">resolver_data_init()</a>, <a class="el" href="../../da/d14/test__dns_8c_source.html#l00731">test_cancel()</a>, and <a class="el" href="../../da/d14/test__dns_8c_source.html#l00715">test_resolve()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:54 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
