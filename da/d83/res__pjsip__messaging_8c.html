<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_messaging.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_pjsip_messaging.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;pjsip.h&gt;</code><br />
<code>#include &lt;pjsip_ua.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d0d/message_8h_source.html">asterisk/message.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/de0/pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">asterisk/res_pjsip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">asterisk/res_pjsip_session.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">asterisk/taskprocessor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d49/uri_8h_source.html">asterisk/uri.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_pjsip_messaging.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d2c/res__pjsip__messaging_8c__incl.png" border="0" usemap="#res__pjsip__messaging_8c" alt=""/></div>
<map name="res__pjsip__messaging_8c" id="res__pjsip__messaging_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="399,244,483,271"/>
<area shape="rect" id="node14" href="../../d2/d0d/message_8h.html" title="Out&#45;of&#45;call text message support. " alt="" coords="2944,87,3091,114"/>
<area shape="rect" id="node15" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="667,87,803,114"/>
<area shape="rect" id="node20" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="1098,169,1209,196"/>
<area shape="rect" id="node32" href="../../d8/d8c/res__pjsip_8h.html" title="asterisk/res_pjsip.h" alt="" coords="2096,87,2240,114"/>
<area shape="rect" id="node45" href="../../d9/de7/res__pjsip__session_8h.html" title="asterisk/res_pjsip\l_session.h" alt="" coords="2737,80,2869,121"/>
<area shape="rect" id="node47" href="../../d0/d1e/taskprocessor_8h.html" title="An API for managing task processing threads that can be shared across modules. " alt="" coords="3115,87,3293,114"/>
<area shape="rect" id="node48" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="605,244,718,271"/>
<area shape="rect" id="node50" href="../../df/d49/uri_8h.html" title="asterisk/uri.h" alt="" coords="3317,87,3421,114"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="75,319,229,345"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="327,319,465,345"/>
<area shape="rect" id="node11" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="489,319,623,345"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="5,393,152,420"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="177,393,319,420"/>
<area shape="rect" id="node16" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="699,319,813,345"/>
<area shape="rect" id="node17" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1360,393,1517,420"/>
<area shape="rect" id="node19" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="700,393,831,420"/>
<area shape="rect" id="node18" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="2655,468,2782,495"/>
<area shape="rect" id="node21" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1821,244,1960,271"/>
<area shape="rect" id="node22" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="1795,319,1941,345"/>
<area shape="rect" id="node25" href="../../d7/d00/sched_8h.html" title="Scheduler Routines (derived from cheops) " alt="" coords="2474,319,2601,345"/>
<area shape="rect" id="node26" href="../../da/da2/devicestate_8h.html" title="Device state management. " alt="" coords="743,244,905,271"/>
<area shape="rect" id="node27" href="../../d6/dd7/presencestate_8h.html" title="Presence state management. " alt="" coords="1031,244,1211,271"/>
<area shape="rect" id="node28" href="../../d6/da0/hashtab_8h.html" title="Generic (perhaps overly so) hashtable implementation Hash Table support in Asterisk. " alt="" coords="1235,244,1375,271"/>
<area shape="rect" id="node29" href="../../d1/d99/xmldoc_8h.html" title="Asterisk XML Documentation API. " alt="" coords="963,319,1098,345"/>
<area shape="rect" id="node30" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="2319,244,2449,271"/>
<area shape="rect" id="node23" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="2010,393,2161,420"/>
<area shape="rect" id="node24" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1619,319,1770,345"/>
<area shape="rect" id="node31" href="../../d1/d16/codec_8h.html" title="Codec API. " alt="" coords="2321,319,2447,345"/>
<area shape="rect" id="node37" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="2721,319,2868,345"/>
<area shape="rect" id="node38" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="2168,169,2301,196"/>
<area shape="rect" id="node39" href="../../db/dc4/dnsmgr_8h.html" title="Background DNS update manager. " alt="" coords="2727,244,2863,271"/>
<area shape="rect" id="node40" href="../../d5/da1/udptl_8h.html" title="UDPTL support for T.38. " alt="" coords="2477,169,2597,196"/>
<area shape="rect" id="node41" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="2938,244,3094,271"/>
<area shape="rect" id="node42" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1371,169,1560,196"/>
<area shape="rect" id="node43" href="../../d7/d44/stasis__endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1501,244,1696,271"/>
<area shape="rect" id="node44" href="../../d8/d95/stream_8h.html" title="Media Stream API. " alt="" coords="2159,244,2294,271"/>
<area shape="rect" id="node46" href="../../de/d5f/sdp__srtp_8h.html" title="SRTP and SDP Security descriptions. " alt="" coords="2958,169,3101,196"/>
<area shape="rect" id="node49" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="837,319,939,345"/>
</map>
</div>
</div>
<p><a href="../../da/d83/res__pjsip__messaging_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d60/structmsg__data.html">msg_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a758f9da8805a79adbe236829c3802703"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a758f9da8805a79adbe236829c3802703">DEBUG_BUF_SIZE</a>&#160;&#160;&#160;256</td></tr>
<tr class="separator:a758f9da8805a79adbe236829c3802703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5e37b70822d3f246d9fa30873601976"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ac5e37b70822d3f246d9fa30873601976">MAX_BODY_SIZE</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:ac5e37b70822d3f246d9fa30873601976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a39cb4a522556e8f8243c71617a070"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ab8a39cb4a522556e8f8243c71617a070">MAX_HDR_SIZE</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:ab8a39cb4a522556e8f8243c71617a070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbca09b7e79fc210b9b9bf8a98f81ecd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#abbca09b7e79fc210b9b9bf8a98f81ecd">MAX_USER_SIZE</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:abbca09b7e79fc210b9b9bf8a98f81ecd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e47576e4727f58c7cd2ccef4ab0cff"><td class="memItemLeft" align="right" valign="top">static enum pjsip_status_code&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a65e47576e4727f58c7cd2ccef4ab0cff">check_content_type</a> (const pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a65e47576e4727f58c7cd2ccef4ab0cff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a755ecf7faa300a9559a5726179983ec6"><td class="memItemLeft" align="right" valign="top">static enum pjsip_status_code&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a755ecf7faa300a9559a5726179983ec6">check_content_type_in_dialog</a> (const pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a755ecf7faa300a9559a5726179983ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07a7dc49ebc610391af8c3f1aa6fad7"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#af07a7dc49ebc610391af8c3f1aa6fad7">get_outbound_endpoint</a> (const char *to, char **uri)</td></tr>
<tr class="separator:af07a7dc49ebc610391af8c3f1aa6fad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78f0c0b374876378c458ef59d9cd6a44"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a78f0c0b374876378c458ef59d9cd6a44">handle_atsign</a> (const char *to, char *destination, char **uri, char *slash, char *atsign, char *scheme)</td></tr>
<tr class="separator:a78f0c0b374876378c458ef59d9cd6a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9144a57abfda8a0a36fb3466b6ef32"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#abb9144a57abfda8a0a36fb3466b6ef32">handle_single_token</a> (const char *to, char *destination, char **uri)</td></tr>
<tr class="separator:abb9144a57abfda8a0a36fb3466b6ef32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0acd6934f5fde9ab2d1588090e69c7f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ad0acd6934f5fde9ab2d1588090e69c7f">handle_slash</a> (const char *to, char *destination, char **uri, char *slash, char *atsign, char *scheme)</td></tr>
<tr class="separator:ad0acd6934f5fde9ab2d1588090e69c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e8da67e55baa0f1cf10f3772e63c82"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ae4e8da67e55baa0f1cf10f3772e63c82">headers_to_vars</a> (const pjsip_rx_data *rdata, struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *msg)</td></tr>
<tr class="separator:ae4e8da67e55baa0f1cf10f3772e63c82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647b894e38afad7cb37c5c2be2017857"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a647b894e38afad7cb37c5c2be2017857">incoming_in_dialog_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a647b894e38afad7cb37c5c2be2017857"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dedc7718ca8396b225ec465f1dfb2fc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a7dedc7718ca8396b225ec465f1dfb2fc">insert_user_in_contact_uri</a> (const char *to, const char *endpoint_name, const char *aors, const char *<a class="el" href="../../d8/dbc/structuser.html">user</a>, char **uri)</td></tr>
<tr class="memdesc:a7dedc7718ca8396b225ec465f1dfb2fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a contact and insert a "user@" into its URI.  <a href="#a7dedc7718ca8396b225ec465f1dfb2fc">More...</a><br /></td></tr>
<tr class="separator:a7dedc7718ca8396b225ec465f1dfb2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2c279d5e676c37196c20e8b79bda541"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ae2c279d5e676c37196c20e8b79bda541">is_msg_var_blocked</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="separator:ae2c279d5e676c37196c20e8b79bda541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a604d68a2eaee78d8f5527f2dd39d2e39"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a604d68a2eaee78d8f5527f2dd39d2e39">module_on_rx_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a604d68a2eaee78d8f5527f2dd39d2e39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13b2cd8055286713dabe268419f4daaf"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d60/structmsg__data.html">msg_data</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a13b2cd8055286713dabe268419f4daaf">msg_data_create</a> (const struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *msg, const char *destination, const char *from)</td></tr>
<tr class="separator:a13b2cd8055286713dabe268419f4daaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a868e4edc38545912156ac92dc2bb6ba2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a868e4edc38545912156ac92dc2bb6ba2">msg_data_destroy</a> (void *obj)</td></tr>
<tr class="separator:a868e4edc38545912156ac92dc2bb6ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a905ea6789c66d319929f5b74270a793e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a905ea6789c66d319929f5b74270a793e">msg_send</a> (void *data)</td></tr>
<tr class="separator:a905ea6789c66d319929f5b74270a793e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8394b1c6dd395101ed928c7b9aa95f5c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a8394b1c6dd395101ed928c7b9aa95f5c">print_body</a> (pjsip_rx_data *rdata, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, int <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</td></tr>
<tr class="separator:a8394b1c6dd395101ed928c7b9aa95f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81974905ecfbcf33344c899a613aa9dc"><td class="memItemLeft" align="right" valign="top">static enum pjsip_status_code&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a81974905ecfbcf33344c899a613aa9dc">rx_data_to_ast_msg</a> (pjsip_rx_data *rdata, struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *msg)</td></tr>
<tr class="separator:a81974905ecfbcf33344c899a613aa9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee5c33e6ea7af67faf767230cdcbc09"><td class="memItemLeft" align="right" valign="top">static pj_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a> (pjsip_rx_data *rdata, enum pjsip_status_code code, pjsip_dialog *dlg, pjsip_transaction *tsx)</td></tr>
<tr class="separator:aeee5c33e6ea7af67faf767230cdcbc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc11a48a4a3b69575eb23eff5563c93d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#afc11a48a4a3b69575eb23eff5563c93d">sip_msg_send</a> (const struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *msg, const char *destination, const char *from)</td></tr>
<tr class="separator:afc11a48a4a3b69575eb23eff5563c93d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d9cc755e1f41111cb6077ef38a5f656"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a5d9cc755e1f41111cb6077ef38a5f656">sip_to_pjsip</a> (char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, int size, int capacity)</td></tr>
<tr class="separator:a5d9cc755e1f41111cb6077ef38a5f656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab158a98dd09567083bcb7ff83845434a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ab158a98dd09567083bcb7ff83845434a">update_content_type</a> (pjsip_tx_data *tdata, struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *msg, struct <a class="el" href="../../d5/d80/structast__sip__body.html">ast_sip_body</a> *body)</td></tr>
<tr class="separator:ab158a98dd09567083bcb7ff83845434a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac42e11811d33a202b6fc2875b06334c6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ac42e11811d33a202b6fc2875b06334c6">update_from</a> (pjsip_tx_data *tdata, char *from)</td></tr>
<tr class="separator:ac42e11811d33a202b6fc2875b06334c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6aa0fbe035f84fbfcc06e30d227c7e5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#af6aa0fbe035f84fbfcc06e30d227c7e5">update_to_display_name</a> (pjsip_tx_data *tdata, char *to)</td></tr>
<tr class="separator:af6aa0fbe035f84fbfcc06e30d227c7e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b354eefff1679f4159cb0e583da9b43"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a0b354eefff1679f4159cb0e583da9b43">update_to_uri</a> (pjsip_tx_data *tdata, char *to)</td></tr>
<tr class="separator:a0b354eefff1679f4159cb0e583da9b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d39ed2275ccce7bb92d5cb8306de324"><td class="memItemLeft" align="right" valign="top">static enum pjsip_status_code&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a0d39ed2275ccce7bb92d5cb8306de324">vars_to_headers</a> (const struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *msg, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:a0d39ed2275ccce7bb92d5cb8306de324"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Messaging Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_APP_DEPEND, .requires = &quot;res_pjsip,res_pjsip_session&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca8e337fca6e1a8575e04a4c8ecef07c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a></td></tr>
<tr class="separator:aca8e337fca6e1a8575e04a4c8ecef07c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a2bd7e56fa8b771cccce9605eba7d33"><td class="memItemLeft" align="right" valign="top">static pjsip_module&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a></td></tr>
<tr class="separator:a8a2bd7e56fa8b771cccce9605eba7d33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c35f42c26b1c5830f78536249397c81"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a0c35f42c26b1c5830f78536249397c81">messaging_supplement</a></td></tr>
<tr class="separator:a0c35f42c26b1c5830f78536249397c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adee47ce28cd17bbdc773df287fc062c5"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../df/dfc/structast__msg__tech.html">ast_msg_tech</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#adee47ce28cd17bbdc773df287fc062c5">msg_tech</a></td></tr>
<tr class="separator:adee47ce28cd17bbdc773df287fc062c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae429ac4d5de1dd3e9494a7fdc9e6b509"><td class="memItemLeft" align="right" valign="top">const pjsip_method&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#ae429ac4d5de1dd3e9494a7fdc9e6b509">pjsip_message_method</a> = {PJSIP_OTHER_METHOD, {&quot;MESSAGE&quot;, 7} }</td></tr>
<tr class="separator:ae429ac4d5de1dd3e9494a7fdc9e6b509"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a758f9da8805a79adbe236829c3802703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a758f9da8805a79adbe236829c3802703">&#9670;&nbsp;</a></span>DEBUG_BUF_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_BUF_SIZE&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00686">update_to_uri()</a>.</p>

</div>
</div>
<a id="ac5e37b70822d3f246d9fa30873601976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5e37b70822d3f246d9fa30873601976">&#9670;&nbsp;</a></span>MAX_BODY_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_BODY_SIZE&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00137">137</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01035">rx_data_to_ast_msg()</a>.</p>

</div>
</div>
<a id="ab8a39cb4a522556e8f8243c71617a070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8a39cb4a522556e8f8243c71617a070">&#9670;&nbsp;</a></span>MAX_HDR_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_HDR_SIZE&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00136">136</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00927">headers_to_vars()</a>.</p>

</div>
</div>
<a id="abbca09b7e79fc210b9b9bf8a98f81ecd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbca09b7e79fc210b9b9bf8a98f81ecd">&#9670;&nbsp;</a></span>MAX_USER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_USER_SIZE&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00138">138</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01611">1611</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01611">1611</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01611">1611</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<a id="a65e47576e4727f58c7cd2ccef4ab0cff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65e47576e4727f58c7cd2ccef4ab0cff">&#9670;&nbsp;</a></span>check_content_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum pjsip_status_code check_content_type </td>
          <td>(</td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00151">151</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05259">ast_sip_is_content_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01407">module_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="keywordflow">if</span> (rdata-&gt;msg_info.msg-&gt;body &amp;&amp; rdata-&gt;msg_info.msg-&gt;body-&gt;len) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      res = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a>(</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;         &amp;rdata-&gt;msg_info.msg-&gt;body-&gt;content_type, <span class="stringliteral">&quot;text&quot;</span>, <span class="stringliteral">&quot;plain&quot;</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      res = rdata-&gt;msg_info.ctype &amp;&amp;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a>(</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            &amp;rdata-&gt;msg_info.ctype-&gt;media, <span class="stringliteral">&quot;text&quot;</span>, <span class="stringliteral">&quot;plain&quot;</span>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="keywordflow">return</span> res ? PJSIP_SC_OK : PJSIP_SC_UNSUPPORTED_MEDIA_TYPE;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_ae47a39537fdf10ceba2fad9d9c380179"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a></div><div class="ttdeci">int ast_sip_is_content_type(pjsip_media_type *content_type, char *type, char *subtype)</div><div class="ttdoc">Checks if the given content type matches type/subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05259">res_pjsip.c:5259</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a755ecf7faa300a9559a5726179983ec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a755ecf7faa300a9559a5726179983ec6">&#9670;&nbsp;</a></span>check_content_type_in_dialog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum pjsip_status_code check_content_type_in_dialog </td>
          <td>(</td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00175">175</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01508">text</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01457">incoming_in_dialog_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keywordtype">int</span> res = PJSIP_SC_UNSUPPORTED_MEDIA_TYPE;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t <a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a> = { <span class="stringliteral">&quot;text&quot;</span>, 4};</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t application = { <span class="stringliteral">&quot;application&quot;</span>, 11};</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordflow">if</span> (!(rdata-&gt;msg_info.msg-&gt;body &amp;&amp; rdata-&gt;msg_info.msg-&gt;body-&gt;len &gt; 0)) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="comment">/* We&#39;ll accept any text/ or application/ content type */</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">if</span> (pj_stricmp(&amp;rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.type, &amp;text) == 0</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;         || pj_stricmp(&amp;rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.type, &amp;application) == 0) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      res = PJSIP_SC_OK;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rdata-&gt;msg_info.ctype</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      &amp;&amp; (pj_stricmp(&amp;rdata-&gt;msg_info.ctype-&gt;media.type, &amp;text) == 0</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      || pj_stricmp(&amp;rdata-&gt;msg_info.ctype-&gt;media.type, &amp;application) == 0)) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      res = PJSIP_SC_OK;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div><div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af07a7dc49ebc610391af8c3f1aa6fad7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07a7dc49ebc610391af8c3f1aa6fad7">&#9670;&nbsp;</a></span>get_outbound_endpoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a>* get_outbound_endpoint </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>uri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00617">617</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02353">ast_sip_default_outbound_endpoint()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00505">handle_atsign()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00288">handle_single_token()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00358">handle_slash()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="keywordtype">char</span> *destination;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <span class="keywordtype">char</span> *slash = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <span class="keywordtype">char</span> *atsign = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   <span class="keywordtype">char</span> *scheme = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   destination = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(to);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   slash = strchr(destination, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   atsign = strchr(destination, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   scheme = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(strstr(destination, <span class="stringliteral">&quot;sip:&quot;</span>), strstr(destination, <span class="stringliteral">&quot;sips:&quot;</span>));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="keywordflow">if</span> (!slash &amp;&amp; !atsign &amp;&amp; !scheme) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">       * If there&#39;s only a single token, it can be either...</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">       *    endpoint</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">       *    host</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#abb9144a57abfda8a0a36fb3466b6ef32">handle_single_token</a>(to, destination, uri);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="keywordflow">if</span> (slash) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">       * If there&#39;s a &#39;/&#39;, then the form must be one of the following...</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">       *    PJSIP/user@endpoint</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">       *    endpoint/aor</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">       *    endpoint/uri</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ad0acd6934f5fde9ab2d1588090e69c7f">handle_slash</a>(to, destination, uri, slash, atsign, scheme);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   }</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <span class="keywordflow">if</span> (!endpoint &amp;&amp; atsign &amp;&amp; !scheme) {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">       * If there&#39;s an &#39;@&#39; but no scheme then it&#39;s either following an endpoint name</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">       * and being followed by a domain name (which we discard).</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">       * OR is&#39;s a user@host uri without a scheme.  It&#39;s probably the latter but because</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">       * endpoint@domain looks just like user@host, we&#39;ll test for endpoint first.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a78f0c0b374876378c458ef59d9cd6a44">handle_atsign</a>(to, destination, uri, slash, atsign, scheme);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">    * If all else fails, we assume it&#39;s a URI or just a hostname.</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keywordflow">if</span> (scheme) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      *uri = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(destination);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Didn&#39;t find an endpoint but did find a scheme so using URI &#39;%s&#39; with default endpoint\n&quot;</span>,</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;         to, *uri);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      *uri = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(strlen(destination) + strlen(<span class="stringliteral">&quot;sip:&quot;</span>) + 1);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      sprintf(*uri, <span class="stringliteral">&quot;sip:%s&quot;</span>, destination);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Didn&#39;t find an endpoint and didn&#39;t find scheme so adding scheme and using URI &#39;%s&#39; with default endpoint\n&quot;</span>,</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;         to, *uri);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7f6df3c21a0eb11bad3fa1dbfc2f1dfc">ast_sip_default_outbound_endpoint</a>();</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <span class="keywordflow">return</span> endpoint;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7f6df3c21a0eb11bad3fa1dbfc2f1dfc"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7f6df3c21a0eb11bad3fa1dbfc2f1dfc">ast_sip_default_outbound_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_sip_default_outbound_endpoint(void)</div><div class="ttdoc">Retrieve the default outbound endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02353">pjsip_configuration.c:2353</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ad0acd6934f5fde9ab2d1588090e69c7f"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ad0acd6934f5fde9ab2d1588090e69c7f">handle_slash</a></div><div class="ttdeci">static struct ast_sip_endpoint * handle_slash(const char *to, char *destination, char **uri, char *slash, char *atsign, char *scheme)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00358">res_pjsip_messaging.c:358</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a78f0c0b374876378c458ef59d9cd6a44"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a78f0c0b374876378c458ef59d9cd6a44">handle_atsign</a></div><div class="ttdeci">static struct ast_sip_endpoint * handle_atsign(const char *to, char *destination, char **uri, char *slash, char *atsign, char *scheme)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00505">res_pjsip_messaging.c:505</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_abb9144a57abfda8a0a36fb3466b6ef32"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#abb9144a57abfda8a0a36fb3466b6ef32">handle_single_token</a></div><div class="ttdeci">static struct ast_sip_endpoint * handle_single_token(const char *to, char *destination, char **uri)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00288">res_pjsip_messaging.c:288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78f0c0b374876378c458ef59d9cd6a44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78f0c0b374876378c458ef59d9cd6a44">&#9670;&nbsp;</a></span>handle_atsign()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a>* handle_atsign </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>slash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>atsign</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>scheme</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00505">505</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00821">ast_sip_endpoint::aors</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02353">ast_sip_default_outbound_endpoint()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00304">ast_sip_location_retrieve_contact_from_aor_list()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l03036">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00313">ast_sip_contact::endpoint</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00303">ast_sip_contact::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00617">get_outbound_endpoint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;{</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="keywordtype">char</span> *endpoint_name = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="code" href="../../d9/d03/structcontact.html">contact</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="keywordtype">char</span> *afterat = atsign + 1;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   *atsign = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   endpoint_name = destination;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="comment">/* Apprently there may be &#39;;&lt;user_options&gt;&#39; after the endpoint name ??? */</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>(endpoint_name);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   endpoint = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;endpoint&quot;</span>, endpoint_name);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <span class="keywordflow">if</span> (!endpoint) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">       * It&#39;s probably a uri with a user but without a scheme but we don&#39;t have a way to tell.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">       * We&#39;re going to assume it is and prepend it with a scheme.</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(strlen(to) + strlen(<span class="stringliteral">&quot;sip:&quot;</span>) + 1);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      sprintf(*<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>, <span class="stringliteral">&quot;sip:%s&quot;</span>, to);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7f6df3c21a0eb11bad3fa1dbfc2f1dfc">ast_sip_default_outbound_endpoint</a>();</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Didn&#39;t find endpoint before the &#39;@&#39; so using URI &#39;%s&#39; with default endpoint\n&quot;</span>,</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;         to, *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/structast__sip__contact.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">    * OK, it&#39;s an endpoint and a domain (which we ignore)</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   contact = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a>(endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">aors</a>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="keywordflow">if</span> (!contact) {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">       * We&#39;re getting the contact using the same method as</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">       * ast_sip_create_request() so if there&#39;s no contact</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">       * we can never send this message.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(endpoint);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      endpoint = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Dest: &#39;%s&#39; MSG SEND FAIL: Found endpoint &#39;%s&#39; but didn&#39;t find contact\n&quot;</span>,</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         to, endpoint_name);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(contact);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Found endpoint &#39;%s&#39; and found contact with URI &#39;%s&#39; (discarding domain %s)\n&quot;</span>,</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      to, endpoint_name, *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>, afterat);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/structast__sip__contact.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_a6bb5769d100d0348446c7f032eca58c1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a></div><div class="ttdeci">#define AST_SIP_USER_OPTIONS_TRUNCATE_CHECK(str)</div><div class="ttdoc">Truncate the URI user field options string if enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l03036">res_pjsip.h:3036</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7f6df3c21a0eb11bad3fa1dbfc2f1dfc"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7f6df3c21a0eb11bad3fa1dbfc2f1dfc">ast_sip_default_outbound_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_sip_default_outbound_endpoint(void)</div><div class="ttdoc">Retrieve the default outbound endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02353">pjsip_configuration.c:2353</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_contact::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00313">res_pjsip.h:313</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a00fd98f03df089bd6aa358f941ae0dcd"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a></div><div class="ttdeci">struct ast_sip_contact * ast_sip_location_retrieve_contact_from_aor_list(const char *aor_list)</div><div class="ttdoc">Retrieve the first bound contact from a list of AORs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00304">location.c:304</a></div></div>
<div class="ttc" id="structast__sip__contact_html"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a></div><div class="ttdoc">Contact associated with an address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00281">res_pjsip.h:281</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structcontact_html"><div class="ttname"><a href="../../d9/d03/structcontact.html">contact</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8f/reqresp__parser_8h_source.html#l00035">reqresp_parser.h:35</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50edbc089f02d537b9a487f1a62c889e"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">ast_sip_endpoint::aors</a></div><div class="ttdeci">const ast_string_field aors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00821">res_pjsip.h:821</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">ast_sip_contact::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb9144a57abfda8a0a36fb3466b6ef32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9144a57abfda8a0a36fb3466b6ef32">&#9670;&nbsp;</a></span>handle_single_token()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a>* handle_single_token </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>uri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00288">288</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00821">ast_sip_endpoint::aors</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02353">ast_sip_default_outbound_endpoint()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00304">ast_sip_location_retrieve_contact_from_aor_list()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00313">ast_sip_contact::endpoint</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00303">ast_sip_contact::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00617">get_outbound_endpoint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                                                                                   {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d8/d8a/structast__sip__contact.html#ab4cbf7f39957c6802d6421a2eb5b6350">endpoint_name</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="code" href="../../d9/d03/structcontact.html">contact</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">    * If &quot;to&quot; is just one token, it could be an endpoint name</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">    * or a hostname without a scheme.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   endpoint = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;endpoint&quot;</span>, destination);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordflow">if</span> (!endpoint) {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">       * We can only assume it&#39;s a hostname.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordtype">char</span> *temp_uri = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(strlen(destination) + strlen(<span class="stringliteral">&quot;sip:&quot;</span>) + 1);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      sprintf(temp_uri, <span class="stringliteral">&quot;sip:%s&quot;</span>, destination);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a> = temp_uri;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7f6df3c21a0eb11bad3fa1dbfc2f1dfc">ast_sip_default_outbound_endpoint</a>();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Didn&#39;t find endpoint so adding scheme and using URI &#39;%s&#39; with default endpoint\n&quot;</span>,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         to, *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/structast__sip__contact.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   }</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">    * It&#39;s an endpoint</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   endpoint_name = destination;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   contact = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a>(endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">aors</a>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keywordflow">if</span> (!contact) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">       * We&#39;re getting the contact using the same method as</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">       * ast_sip_create_request() so if there&#39;s no contact</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">       * we can never send this message.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Dest: &#39;%s&#39; MSG SEND FAIL: Found endpoint &#39;%s&#39; but didn&#39;t find an aor/contact for it\n&quot;</span>,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         to, endpoint_name);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(endpoint);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Found endpoint &#39;%s&#39; and found contact with URI &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      to, endpoint_name, *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(contact);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/structast__sip__contact.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7f6df3c21a0eb11bad3fa1dbfc2f1dfc"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7f6df3c21a0eb11bad3fa1dbfc2f1dfc">ast_sip_default_outbound_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_sip_default_outbound_endpoint(void)</div><div class="ttdoc">Retrieve the default outbound endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02353">pjsip_configuration.c:2353</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_contact::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00313">res_pjsip.h:313</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__contact_html_ab4cbf7f39957c6802d6421a2eb5b6350"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#ab4cbf7f39957c6802d6421a2eb5b6350">ast_sip_contact::endpoint_name</a></div><div class="ttdeci">const ast_string_field endpoint_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a00fd98f03df089bd6aa358f941ae0dcd"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a></div><div class="ttdeci">struct ast_sip_contact * ast_sip_location_retrieve_contact_from_aor_list(const char *aor_list)</div><div class="ttdoc">Retrieve the first bound contact from a list of AORs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00304">location.c:304</a></div></div>
<div class="ttc" id="structast__sip__contact_html"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a></div><div class="ttdoc">Contact associated with an address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00281">res_pjsip.h:281</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structcontact_html"><div class="ttname"><a href="../../d9/d03/structcontact.html">contact</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8f/reqresp__parser_8h_source.html#l00035">reqresp_parser.h:35</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50edbc089f02d537b9a487f1a62c889e"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">ast_sip_endpoint::aors</a></div><div class="ttdeci">const ast_string_field aors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00821">res_pjsip.h:821</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">ast_sip_contact::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0acd6934f5fde9ab2d1588090e69c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0acd6934f5fde9ab2d1588090e69c7f">&#9670;&nbsp;</a></span>handle_slash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a>* handle_slash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>slash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>atsign</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>scheme</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00358">358</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00821">ast_sip_endpoint::aors</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00094">ast_begins_with()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00147">ast_sip_location_retrieve_aor()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00194">ast_sip_location_retrieve_first_aor_contact()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00213">insert_user_in_contact_uri()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00303">ast_sip_contact::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00617">get_outbound_endpoint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d8/d8a/structast__sip__contact.html#ab4cbf7f39957c6802d6421a2eb5b6350">endpoint_name</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="code" href="../../d9/d03/structcontact.html">contact</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="keywordtype">char</span> *afterslash = slash + 1;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d03/structast__sip__aor.html">ast_sip_aor</a> *aor;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a>(destination, <span class="stringliteral">&quot;PJSIP/&quot;</span>)) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Dialplan format&#39;\n&quot;</span>, to);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">       * This has to be the form PJSIP/user@endpoint</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">if</span> (!atsign || strchr(afterslash, <span class="charliteral">&#39;/&#39;</span>)) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">          * If there&#39;s no &quot;user@&quot; or there&#39;s a slash somewhere after</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">          * &quot;PJSIP/&quot; then we go no further.</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;         *uri = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="stringliteral">&quot;Dest: &#39;%s&#39; MSG SEND FAIL: Destinations beginning with &#39;PJSIP/&#39; must be in the form of &#39;PJSIP/user@endpoint&#39;\n&quot;</span>,</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            to);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      *atsign = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      user = afterslash;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      endpoint_name = atsign + 1;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; User: &#39;%s&#39;  Endpoint: &#39;%s&#39;\n&quot;</span>, to, user, endpoint_name);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">       * Either...</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">       * endpoint/aor</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">       * endpoint/uri</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      *slash = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      endpoint_name = destination;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Endpoint: &#39;%s&#39;\n&quot;</span>, to, endpoint_name);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   endpoint = <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;endpoint&quot;</span>, endpoint_name);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">if</span> (!endpoint) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      *uri = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Dest: &#39;%s&#39; MSG SEND FAIL: Didn&#39;t find endpoint with name &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         to, endpoint_name);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="keywordflow">if</span> (scheme) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">       * If we found a scheme, then everything after the slash MUST be a URI.</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">       * We don&#39;t need to do any further modification.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      *uri = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(afterslash);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Found endpoint &#39;%s&#39; and found URI &#39;%s&#39; after &#39;/&#39;\n&quot;</span>,</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;         to, endpoint_name, *uri);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">return</span> endpoint;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="keywordflow">if</span> (user) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">       * This has to be the form PJSIP/user@endpoint</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">       * Set the return URI to be the endpoint&#39;s contact URI with the user</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">       * portion set to the user that was specified before the endpoint name.</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      rc = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a7dedc7718ca8396b225ec465f1dfb2fc">insert_user_in_contact_uri</a>(to, endpoint_name, endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">aors</a>, user, uri);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">if</span> (rc != 0) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">          * insert_user_in_contact_uri prints the warning message.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(endpoint);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;         endpoint = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         *uri = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; User: &#39;%s&#39;  Endpoint: &#39;%s&#39;  URI: &#39;%s&#39;\n&quot;</span>, to, user,</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         endpoint_name, *uri);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">return</span> endpoint;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">    * We&#39;re now left with two possibilities...</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">    *    endpoint/aor</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">    * endpoint/uri-without-scheme</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   aor = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a434c2d85dbd10a9453f6d409809330d5">ast_sip_location_retrieve_aor</a>(afterslash);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">if</span> (!aor) {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">       * It&#39;s probably a URI without a scheme but we don&#39;t have a way to tell</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">       * for sure.  We&#39;re going to assume it is and prepend it with a scheme.</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      *uri = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(strlen(afterslash) + strlen(<span class="stringliteral">&quot;sip:&quot;</span>) + 1);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      sprintf(*uri, <span class="stringliteral">&quot;sip:%s&quot;</span>, afterslash);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Found endpoint &#39;%s&#39; but didn&#39;t find aor after &#39;/&#39; so using URI &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         to, endpoint_name, *uri);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">return</span> endpoint;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   }</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">    * Only one possibility left... There was an aor name after the slash.</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Found endpoint &#39;%s&#39; and found aor &#39;%s&#39; after &#39;/&#39;\n&quot;</span>,</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      to, endpoint_name, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(aor));</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   contact = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#abf39fcf3388190cf49dbc5670c7aca20">ast_sip_location_retrieve_first_aor_contact</a>(aor);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keywordflow">if</span> (!contact) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">       * An aor without a contact is useless and since</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">       * ast_sip_create_message() won&#39;t be able to find one</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">       * either, we just need to bail.</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Dest: &#39;%s&#39; MSG SEND FAIL: Found endpoint &#39;%s&#39; but didn&#39;t find contact for aor &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;         to, endpoint_name, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(aor));</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(aor);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(endpoint);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      *uri = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   *uri = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; Found endpoint &#39;%s&#39; and found contact with URI &#39;%s&#39; for aor &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      to, endpoint_name, *uri, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(aor));</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(contact);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(aor);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordflow">return</span> endpoint;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;}</div><div class="ttc" id="structast__sip__aor_html"><div class="ttname"><a href="../../d4/d03/structast__sip__aor.html">ast_sip_aor</a></div><div class="ttdoc">A SIP address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00361">res_pjsip.h:361</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a7dedc7718ca8396b225ec465f1dfb2fc"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a7dedc7718ca8396b225ec465f1dfb2fc">insert_user_in_contact_uri</a></div><div class="ttdeci">static int insert_user_in_contact_uri(const char *to, const char *endpoint_name, const char *aors, const char *user, char **uri)</div><div class="ttdoc">Find a contact and insert a &quot;user@&quot; into its URI. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00213">res_pjsip_messaging.c:213</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__contact_html_ab4cbf7f39957c6802d6421a2eb5b6350"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#ab4cbf7f39957c6802d6421a2eb5b6350">ast_sip_contact::endpoint_name</a></div><div class="ttdeci">const ast_string_field endpoint_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a434c2d85dbd10a9453f6d409809330d5"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a434c2d85dbd10a9453f6d409809330d5">ast_sip_location_retrieve_aor</a></div><div class="ttdeci">struct ast_sip_aor * ast_sip_location_retrieve_aor(const char *aor_name)</div><div class="ttdoc">Retrieve a named AOR. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00147">location.c:147</a></div></div>
<div class="ttc" id="structast__sip__contact_html"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a></div><div class="ttdoc">Contact associated with an address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00281">res_pjsip.h:281</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_abf39fcf3388190cf49dbc5670c7aca20"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#abf39fcf3388190cf49dbc5670c7aca20">ast_sip_location_retrieve_first_aor_contact</a></div><div class="ttdeci">struct ast_sip_contact * ast_sip_location_retrieve_first_aor_contact(const struct ast_sip_aor *aor)</div><div class="ttdoc">Retrieve the first bound contact for an AOR. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00194">location.c:194</a></div></div>
<div class="ttc" id="structuser_html"><div class="ttname"><a href="../../d8/dbc/structuser.html">user</a></div><div class="ttdoc">structure to hold users read from users.conf </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00312">res_phoneprov.c:312</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="strings_8h_html_ac51fa66c90ce950b248c9ff3e8c4e453"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a></div><div class="ttdeci">static int force_inline attribute_pure ast_begins_with(const char *str, const char *prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00094">strings.h:94</a></div></div>
<div class="ttc" id="structcontact_html"><div class="ttname"><a href="../../d9/d03/structcontact.html">contact</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8f/reqresp__parser_8h_source.html#l00035">reqresp_parser.h:35</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50edbc089f02d537b9a487f1a62c889e"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">ast_sip_endpoint::aors</a></div><div class="ttdeci">const ast_string_field aors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00821">res_pjsip.h:821</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">ast_sip_contact::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4e8da67e55baa0f1cf10f3772e63c82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e8da67e55baa0f1cf10f3772e63c82">&#9670;&nbsp;</a></span>headers_to_vars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int headers_to_vars </td>
          <td>(</td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00927">927</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00615">ast_msg_set_var()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00157">ast_skip_blanks()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">c</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00136">MAX_HDR_SIZE</a>, and <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01035">rx_data_to_ast_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;{</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>[<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ab8a39cb4a522556e8f8243c71617a070">MAX_HDR_SIZE</a>];</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ab8a39cb4a522556e8f8243c71617a070">MAX_HDR_SIZE</a>];</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;   pjsip_hdr *h = rdata-&gt;msg_info.msg-&gt;hdr.next;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   pjsip_hdr *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>= &amp;rdata-&gt;msg_info.msg-&gt;hdr;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   <span class="keywordflow">while</span> (h != end) {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keywordflow">if</span> ((res = pjsip_hdr_print_on(h, buf, <span class="keyword">sizeof</span>(buf)-1)) &gt; 0) {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;         buf[res] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;         <span class="keywordflow">if</span> ((c = strchr(buf, <span class="charliteral">&#39;:&#39;</span>))) {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, <a class="code" href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a>(c + 1), <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;         }</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(name, &amp;h-&gt;name, <span class="keyword">sizeof</span>(name));</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;         <span class="keywordflow">if</span> ((res = <a class="code" href="../../d2/d0d/message_8h.html#a926dc659d6f9d88782e9d0e463ba8c47">ast_msg_set_var</a>(msg, name, buf)) != 0) {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;         }</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      h = h-&gt;next;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ab8a39cb4a522556e8f8243c71617a070"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ab8a39cb4a522556e8f8243c71617a070">MAX_HDR_SIZE</a></div><div class="ttdeci">#define MAX_HDR_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00136">res_pjsip_messaging.c:136</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="message_8h_html_a926dc659d6f9d88782e9d0e463ba8c47"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a926dc659d6f9d88782e9d0e463ba8c47">ast_msg_set_var</a></div><div class="ttdeci">int ast_msg_set_var(struct ast_msg *msg, const char *name, const char *value)</div><div class="ttdoc">Set a variable on the message going to the dialplan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00615">message.c:615</a></div></div>
<div class="ttc" id="strings_8h_html_af5693da955fa3bc73bc49c47b601fc7a"><div class="ttname"><a href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a></div><div class="ttdeci">char * ast_skip_blanks(const char *str)</div><div class="ttdoc">Gets a pointer to the first non-whitespace character in a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00157">strings.h:157</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a647b894e38afad7cb37c5c2be2017857"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a647b894e38afad7cb37c5c2be2017857">&#9670;&nbsp;</a></span>incoming_in_dialog_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int incoming_in_dialog_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01457">1457</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00888">ast_channel_caller()</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01418">ast_msg_data_alloc()</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00458">AST_MSG_DATA_ATTR_BODY</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00457">AST_MSG_DATA_ATTR_CONTENT_TYPE</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00456">AST_MSG_DATA_ATTR_FROM</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00455">AST_MSG_DATA_ATTR_TO</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01533">ast_msg_data_get_attribute()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01548">ast_msg_data_queue_frame()</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00449">AST_MSG_DATA_SOURCE_TYPE_IN_DIALOG</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00175">check_content_type_in_dialog()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00421">ast_party_caller::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">msg_data::msg</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00341">ast_party_id::name</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01378">send_response()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00265">ast_party_name::str</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00463">ast_msg_data_attribute::type</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00280">ast_party_name::valid</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00224">msg_data::value</a>, and <a class="el" href="../../d2/d0d/message_8h_source.html#l00464">ast_msg_data_attribute::value</a>.</p>
<div class="fragment"><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;{</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;   <span class="keyword">enum</span> pjsip_status_code code;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;   <span class="keywordtype">int</span> rc;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;   pjsip_dialog *dlg = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   pjsip_transaction *tsx = pjsip_rdata_get_tsx(rdata);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d44/structast__msg__data.html">ast_msg_data</a> *msg;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d77/structast__party__caller.html">ast_party_caller</a> *caller;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;   pjsip_name_addr *name_addr;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;   <span class="keywordtype">size_t</span> from_len;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;   <span class="keywordtype">size_t</span> to_len;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d04/structast__msg__data__attribute.html">ast_msg_data_attribute</a> attrs[4];</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;   <span class="keywordtype">int</span> pos = 0;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   <span class="keywordtype">int</span> body_pos;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_NOT_FOUND, dlg, tsx);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;   code = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a755ecf7faa300a9559a5726179983ec6">check_content_type_in_dialog</a>(rdata);</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;   <span class="keywordflow">if</span> (code != PJSIP_SC_OK) {</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, code, dlg, tsx);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;   }</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;   caller = <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;   name_addr = (pjsip_name_addr *) rdata-&gt;msg_info.from-&gt;uri;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;   from_len = pj_strlen(&amp;name_addr-&gt;display);</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   <span class="keywordflow">if</span> (from_len) {</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      attrs[pos].type = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a7e8412f5b805e70e50a66150bad4d292">AST_MSG_DATA_ATTR_FROM</a>;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      from_len++;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      attrs[pos].value = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(from_len);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(attrs[pos].<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, &amp;name_addr-&gt;display, from_len);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      pos++;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (caller-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a> &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(caller-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>)) {</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      attrs[pos].type = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a7e8412f5b805e70e50a66150bad4d292">AST_MSG_DATA_ATTR_FROM</a>;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      attrs[pos].value = caller-&gt;<a class="code" href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      pos++;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;   }</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   name_addr = (pjsip_name_addr *) rdata-&gt;msg_info.to-&gt;uri;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;   to_len = pj_strlen(&amp;name_addr-&gt;display);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;   <span class="keywordflow">if</span> (to_len) {</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      attrs[pos].type = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a34d60938c22ee31e3eafa756c016020d">AST_MSG_DATA_ATTR_TO</a>;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      to_len++;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      attrs[pos].value = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(to_len);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(attrs[pos].<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, &amp;name_addr-&gt;display, to_len);</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      pos++;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;   }</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;   attrs[pos].type = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22ad68ccac32a7d354861a476fe99a88f2c">AST_MSG_DATA_ATTR_CONTENT_TYPE</a>;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;   attrs[pos].value = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.type.slen</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      + rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.subtype.slen + 2);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   sprintf(attrs[pos].<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, <span class="stringliteral">&quot;%.*s/%.*s&quot;</span>,</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      (<span class="keywordtype">int</span>)rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.type.slen,</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.type.ptr,</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      (<span class="keywordtype">int</span>)rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.subtype.slen,</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      rdata-&gt;msg_info.msg-&gt;body-&gt;content_type.subtype.ptr);</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;   pos++;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;   body_pos = pos;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;   attrs[pos].type = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a0f0f211998e9727566ad340464c66070">AST_MSG_DATA_ATTR_BODY</a>;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;   attrs[pos].value = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(rdata-&gt;msg_info.msg-&gt;body-&gt;len + 1);</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;   <span class="keywordflow">if</span> (!attrs[pos].value) {</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_INTERNAL_SERVER_ERROR, dlg, tsx);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;   }</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(attrs[pos].value, rdata-&gt;msg_info.msg-&gt;body-&gt;data, rdata-&gt;msg_info.msg-&gt;body-&gt;len + 1);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;   pos++;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;   msg = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#ga0f7d3a1a337b48830c3531ed90594b3a">ast_msg_data_alloc</a>(<a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga8e03c05d9a579130cae1af412fb6c580aaa3f9cf94ce8d7e55c4ac6a07075df6b">AST_MSG_DATA_SOURCE_TYPE_IN_DIALOG</a>, attrs, pos);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(attrs[body_pos].value);</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_INTERNAL_SERVER_ERROR, dlg, tsx);</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;   }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received in-dialog MESSAGE from &#39;%s:%s&#39;: %s %s\n&quot;</span>,</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <a class="code" href="../../d8/d0e/group__ast__msg__data.html#ga4edd2c0456a7d3f1658e48e2150c9665">ast_msg_data_get_attribute</a>(msg, <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a7e8412f5b805e70e50a66150bad4d292">AST_MSG_DATA_ATTR_FROM</a>),</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>),</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <a class="code" href="../../d8/d0e/group__ast__msg__data.html#ga4edd2c0456a7d3f1658e48e2150c9665">ast_msg_data_get_attribute</a>(msg, <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a34d60938c22ee31e3eafa756c016020d">AST_MSG_DATA_ATTR_TO</a>),</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <a class="code" href="../../d8/d0e/group__ast__msg__data.html#ga4edd2c0456a7d3f1658e48e2150c9665">ast_msg_data_get_attribute</a>(msg, <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a0f0f211998e9727566ad340464c66070">AST_MSG_DATA_ATTR_BODY</a>));</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;   rc = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gafd6d14befbb5e93cf537ef6052676362">ast_msg_data_queue_frame</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, msg);</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(attrs[body_pos].value);</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(msg);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;   <span class="keywordflow">if</span> (rc != 0) {</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_INTERNAL_SERVER_ERROR, dlg, tsx);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_ACCEPTED, dlg, tsx);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;   }</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;}</div><div class="ttc" id="channel_8h_html_ac2dc872b606534943c98304aed841b34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a></div><div class="ttdeci">struct ast_party_caller * ast_channel_caller(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00888">channel_internal_api.c:888</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gga44ac88ed1b656e254dcad5cf0dbd2a22ad68ccac32a7d354861a476fe99a88f2c"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22ad68ccac32a7d354861a476fe99a88f2c">AST_MSG_DATA_ATTR_CONTENT_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00457">message.h:457</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gga44ac88ed1b656e254dcad5cf0dbd2a22a0f0f211998e9727566ad340464c66070"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a0f0f211998e9727566ad340464c66070">AST_MSG_DATA_ATTR_BODY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00458">message.h:458</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="structast__msg__data_html"><div class="ttname"><a href="../../d9/d44/structast__msg__data.html">ast_msg_data</a></div><div class="ttdoc">Structure used to transport a message through the frame core. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01406">message.c:1406</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_ga0f7d3a1a337b48830c3531ed90594b3a"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#ga0f7d3a1a337b48830c3531ed90594b3a">ast_msg_data_alloc</a></div><div class="ttdeci">struct ast_msg_data * ast_msg_data_alloc(enum ast_msg_data_source_type source, struct ast_msg_data_attribute attributes[], size_t count)</div><div class="ttdoc">Allocates an ast_msg_data structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01418">message.c:1418</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gga8e03c05d9a579130cae1af412fb6c580aaa3f9cf94ce8d7e55c4ac6a07075df6b"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gga8e03c05d9a579130cae1af412fb6c580aaa3f9cf94ce8d7e55c4ac6a07075df6b">AST_MSG_DATA_SOURCE_TYPE_IN_DIALOG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00449">message.h:449</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__party__caller_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../d4/d77/structast__party__caller.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_party_caller::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdoc">Caller party ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00421">channel.h:421</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__party__caller_html"><div class="ttname"><a href="../../d4/d77/structast__party__caller.html">ast_party_caller</a></div><div class="ttdoc">Caller Party information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00419">channel.h:419</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gga44ac88ed1b656e254dcad5cf0dbd2a22a34d60938c22ee31e3eafa756c016020d"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a34d60938c22ee31e3eafa756c016020d">AST_MSG_DATA_ATTR_TO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00455">message.h:455</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gafd6d14befbb5e93cf537ef6052676362"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gafd6d14befbb5e93cf537ef6052676362">ast_msg_data_queue_frame</a></div><div class="ttdeci">int ast_msg_data_queue_frame(struct ast_channel *channel, struct ast_msg_data *msg)</div><div class="ttdoc">Queue an AST_FRAME_TEXT_DATA frame containing an ast_msg_data structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01548">message.c:1548</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gga44ac88ed1b656e254dcad5cf0dbd2a22a7e8412f5b805e70e50a66150bad4d292"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gga44ac88ed1b656e254dcad5cf0dbd2a22a7e8412f5b805e70e50a66150bad4d292">AST_MSG_DATA_ATTR_FROM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00456">message.h:456</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_ga4edd2c0456a7d3f1658e48e2150c9665"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#ga4edd2c0456a7d3f1658e48e2150c9665">ast_msg_data_get_attribute</a></div><div class="ttdeci">const char * ast_msg_data_get_attribute(struct ast_msg_data *msg, enum ast_msg_data_attribute_type attribute_type)</div><div class="ttdoc">Get attribute from ast_msg_data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01533">message.c:1533</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a755ecf7faa300a9559a5726179983ec6"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a755ecf7faa300a9559a5726179983ec6">check_content_type_in_dialog</a></div><div class="ttdeci">static enum pjsip_status_code check_content_type_in_dialog(const pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00175">res_pjsip_messaging.c:175</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__msg__data__attribute_html"><div class="ttname"><a href="../../d7/d04/structast__msg__data__attribute.html">ast_msg_data_attribute</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00462">message.h:462</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_aeee5c33e6ea7af67faf767230cdcbc09"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a></div><div class="ttdeci">static pj_status_t send_response(pjsip_rx_data *rdata, enum pjsip_status_code code, pjsip_dialog *dlg, pjsip_transaction *tsx)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01378">res_pjsip_messaging.c:1378</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7dedc7718ca8396b225ec465f1dfb2fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dedc7718ca8396b225ec465f1dfb2fc">&#9670;&nbsp;</a></span>insert_user_in_contact_uri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int insert_user_in_contact_uri </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>endpoint_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>aors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>uri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find a contact and insert a "user@" into its URI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">to</td><td>Original destination (for error messages only) </td></tr>
    <tr><td class="paramname">endpoint_name</td><td>Endpoint name (for error messages only) </td></tr>
    <tr><td class="paramname">aors</td><td>Command separated list of AORs </td></tr>
    <tr><td class="paramname">user</td><td>The user to insert in the contact URI </td></tr>
    <tr><td class="paramname">uri</td><td>Pointer to buffer in which to return the URI</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
-1 Fail</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If the contact URI found for the endpoint already has a user in its URI, it will be replaced. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00213">213</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00304">ast_sip_location_retrieve_contact_from_aor_list()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d0/d8a/muted_8c_source.html#l00077">host</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00303">ast_sip_contact::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00358">handle_slash()</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordtype">char</span> *scheme = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keywordtype">char</span> *contact_uri = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="keywordtype">char</span> *after_scheme = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/d8a/muted_8c.html#a41c3a180b50c6b2ddcc1b6843a48f205">host</a>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="code" href="../../d9/d03/structcontact.html">contact</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   contact = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a>(aors);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordflow">if</span> (!contact) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">       * We&#39;re getting the contact using the same method as</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">       * ast_sip_create_request() so if there&#39;s no contact</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">       * we can never send this message.</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Dest: &#39;%s&#39; MSG SEND FAIL: Couldn&#39;t find contact for endpoint &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;         to, <a class="code" href="../../d8/d8a/structast__sip__contact.html#ab4cbf7f39957c6802d6421a2eb5b6350">endpoint_name</a>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   contact_uri = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(contact);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Dest: &#39;%s&#39; User: &#39;%s&#39;  Endpoint: &#39;%s&#39;  ContactURI: &#39;%s&#39;\n&quot;</span>, to, <a class="code" href="../../d8/dbc/structuser.html">user</a>, <a class="code" href="../../d8/d8a/structast__sip__contact.html#ab4cbf7f39957c6802d6421a2eb5b6350">endpoint_name</a>, contact_uri);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">    * Contact URIs must have a scheme so we must insert the user between it and the host.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   scheme = contact_uri;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   after_scheme = strchr(contact_uri, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="keywordflow">if</span> (!after_scheme) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">/* A contact URI without a scheme?  Something&#39;s wrong.  Bail */</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Dest: &#39;%s&#39; MSG SEND FAIL: There was no scheme in the contact URI &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;         to, contact_uri);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">    * Terminate the scheme.</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   *after_scheme = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   after_scheme++;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    * If the contact_uri already has a user, the host starts after the &#39;@&#39;, otherwise</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">    * the host is at after_scheme.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">    * We&#39;re going to ignore the existing user.</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   host = strchr(after_scheme, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="keywordflow">if</span> (host) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      host++;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      host = after_scheme;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   *<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(strlen(scheme) + strlen(<a class="code" href="../../d8/dbc/structuser.html">user</a>) + strlen(host) + 3 <span class="comment">/* One for the &#39;:&#39;, &#39;@&#39; and terminating NULL */</span>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   sprintf(*<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>, <span class="stringliteral">&quot;%s:%s@%s&quot;</span>, scheme, <a class="code" href="../../d8/dbc/structuser.html">user</a>, host); <span class="comment">/* Safe */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__contact_html_ab4cbf7f39957c6802d6421a2eb5b6350"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#ab4cbf7f39957c6802d6421a2eb5b6350">ast_sip_contact::endpoint_name</a></div><div class="ttdeci">const ast_string_field endpoint_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
<div class="ttc" id="muted_8c_html_a41c3a180b50c6b2ddcc1b6843a48f205"><div class="ttname"><a href="../../d0/d8a/muted_8c.html#a41c3a180b50c6b2ddcc1b6843a48f205">host</a></div><div class="ttdeci">static char host[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8a/muted_8c_source.html#l00077">muted.c:77</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a00fd98f03df089bd6aa358f941ae0dcd"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a00fd98f03df089bd6aa358f941ae0dcd">ast_sip_location_retrieve_contact_from_aor_list</a></div><div class="ttdeci">struct ast_sip_contact * ast_sip_location_retrieve_contact_from_aor_list(const char *aor_list)</div><div class="ttdoc">Retrieve the first bound contact from a list of AORs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00304">location.c:304</a></div></div>
<div class="ttc" id="structast__sip__contact_html"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a></div><div class="ttdoc">Contact associated with an address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00281">res_pjsip.h:281</a></div></div>
<div class="ttc" id="structuser_html"><div class="ttname"><a href="../../d8/dbc/structuser.html">user</a></div><div class="ttdoc">structure to hold users read from users.conf </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00312">res_phoneprov.c:312</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structcontact_html"><div class="ttname"><a href="../../d9/d03/structcontact.html">contact</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8f/reqresp__parser_8h_source.html#l00035">reqresp_parser.h:35</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">ast_sip_contact::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2c279d5e676c37196c20e8b79bda541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2c279d5e676c37196c20e8b79bda541">&#9670;&nbsp;</a></span>is_msg_var_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int is_msg_var_blocked </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00857">857</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00892">vars_to_headers()</a>.</p>
<div class="fragment"><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;{</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;   <span class="comment">/* Don&#39;t block the Max-Forwards header because the user can override it */</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *hdr[] = {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="stringliteral">&quot;To&quot;</span>,</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="stringliteral">&quot;From&quot;</span>,</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="stringliteral">&quot;Via&quot;</span>,</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="stringliteral">&quot;Route&quot;</span>,</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="stringliteral">&quot;Contact&quot;</span>,</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="stringliteral">&quot;Call-ID&quot;</span>,</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="stringliteral">&quot;CSeq&quot;</span>,</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="stringliteral">&quot;Allow&quot;</span>,</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="stringliteral">&quot;Content-Length&quot;</span>,</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="stringliteral">&quot;Content-Type&quot;</span>,</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="stringliteral">&quot;Request-URI&quot;</span>,</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;   };</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(hdr); ++i) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, hdr[i])) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         <span class="comment">/* Block addition of this header. */</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01566">1566</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01569">ast_msg_tech_register()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01610">ast_msg_tech_unregister()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05133">ast_sip_create_serializer()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03315">ast_sip_register_service()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00616">ast_sip_session_register_supplement</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03331">ast_sip_unregister_service()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01559">messaging_module</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00134">pjsip_message_method</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01596">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;{</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;   }</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;   <span class="keywordflow">if</span> (pjsip_endpt_add_capability(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(),</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                   <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, PJSIP_H_ALLOW, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1,</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                   &amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ae429ac4d5de1dd3e9494a7fdc9e6b509">pjsip_message_method</a>.name) != PJ_SUCCESS) {</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a>);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;   }</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0d/message_8h.html#a98ae66acbd6268c5010acf52be7e40a4">ast_msg_tech_register</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#adee47ce28cd17bbdc773df287fc062c5">msg_tech</a>)) {</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a>);</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   }</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;   <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a> = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a>(<span class="stringliteral">&quot;pjsip/messaging&quot;</span>);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a>) {</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a>);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <a class="code" href="../../d2/d0d/message_8h.html#a8a1ffcfecf1ffbc22c526796cdf954a7">ast_msg_tech_unregister</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#adee47ce28cd17bbdc773df287fc062c5">msg_tech</a>);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;   }</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#aa21df5d2fdfb2d6e2734a3056ec3db7c">ast_sip_session_register_supplement</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a0c35f42c26b1c5830f78536249397c81">messaging_supplement</a>);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;}</div><div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ae429ac4d5de1dd3e9494a7fdc9e6b509"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ae429ac4d5de1dd3e9494a7fdc9e6b509">pjsip_message_method</a></div><div class="ttdeci">const pjsip_method pjsip_message_method</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00134">res_pjsip_messaging.c:134</a></div></div>
<div class="ttc" id="message_8h_html_a98ae66acbd6268c5010acf52be7e40a4"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a98ae66acbd6268c5010acf52be7e40a4">ast_msg_tech_register</a></div><div class="ttdeci">int ast_msg_tech_register(const struct ast_msg_tech *tech)</div><div class="ttdoc">Register a message technology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01569">message.c:1569</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_adee47ce28cd17bbdc773df287fc062c5"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#adee47ce28cd17bbdc773df287fc062c5">msg_tech</a></div><div class="ttdeci">static const struct ast_msg_tech msg_tech</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01373">res_pjsip_messaging.c:1373</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_aca8e337fca6e1a8575e04a4c8ecef07c"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a></div><div class="ttdeci">static struct ast_taskprocessor * message_serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00140">res_pjsip_messaging.c:140</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a8a2bd7e56fa8b771cccce9605eba7d33"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a></div><div class="ttdeci">static pjsip_module messaging_module</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01559">res_pjsip_messaging.c:1559</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d923ef44f62dffc05178f762b88f084"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a></div><div class="ttdeci">int ast_sip_register_service(pjsip_module *module)</div><div class="ttdoc">Register a SIP service in Asterisk. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03315">res_pjsip.c:3315</a></div></div>
<div class="ttc" id="message_8h_html_a8a1ffcfecf1ffbc22c526796cdf954a7"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a8a1ffcfecf1ffbc22c526796cdf954a7">ast_msg_tech_unregister</a></div><div class="ttdeci">int ast_msg_tech_unregister(const struct ast_msg_tech *tech)</div><div class="ttdoc">Unregister a message technology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01610">message.c:1610</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gad57aa0b914fbd6adbf8ee2fe176e1fb1"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_create_serializer(const char *name)</div><div class="ttdoc">Create a new serializer for SIP tasks. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05133">res_pjsip.c:5133</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a15aa09d9084763cdd20b7467a4cd381a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a></div><div class="ttdeci">void ast_sip_unregister_service(pjsip_module *module)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03331">res_pjsip.c:3331</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a0c35f42c26b1c5830f78536249397c81"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a0c35f42c26b1c5830f78536249397c81">messaging_supplement</a></div><div class="ttdeci">static struct ast_sip_session_supplement messaging_supplement</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01554">res_pjsip_messaging.c:1554</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_aa21df5d2fdfb2d6e2734a3056ec3db7c"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#aa21df5d2fdfb2d6e2734a3056ec3db7c">ast_sip_session_register_supplement</a></div><div class="ttdeci">#define ast_sip_session_register_supplement(supplement)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00616">res_pjsip_session.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a604d68a2eaee78d8f5527f2dd39d2e39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a604d68a2eaee78d8f5527f2dd39d2e39">&#9670;&nbsp;</a></span>module_on_rx_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t module_on_rx_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01407">1407</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00418">ast_msg_alloc()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00448">ast_msg_destroy()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00937">ast_msg_has_destination()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00958">ast_msg_queue()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00151">check_content_type()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">msg_data::msg</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00134">pjsip_message_method</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01035">rx_data_to_ast_msg()</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01378">send_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;{</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;   <span class="keyword">enum</span> pjsip_status_code code;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/da1/structast__msg.html">ast_msg</a> *msg;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   <span class="comment">/* if not a MESSAGE, don&#39;t handle */</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;   <span class="keywordflow">if</span> (pjsip_method_cmp(&amp;rdata-&gt;msg_info.msg-&gt;line.req.method, &amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ae429ac4d5de1dd3e9494a7fdc9e6b509">pjsip_message_method</a>)) {</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;   }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;   code = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a65e47576e4727f58c7cd2ccef4ab0cff">check_content_type</a>(rdata);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;   <span class="keywordflow">if</span> (code != PJSIP_SC_OK) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, code, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;   }</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;   msg = <a class="code" href="../../d2/d0d/message_8h.html#a0e4685c7cf1d71204087b992110e6357">ast_msg_alloc</a>();</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_INTERNAL_SERVER_ERROR, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;   }</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;   code = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a81974905ecfbcf33344c899a613aa9dc">rx_data_to_ast_msg</a>(rdata, msg);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;   <span class="keywordflow">if</span> (code != PJSIP_SC_OK) {</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, code, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <a class="code" href="../../d2/d0d/message_8h.html#a13b928949f293c3b6b9ba3ebe8d64075">ast_msg_destroy</a>(msg);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;   }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d0d/message_8h.html#a76b4f941b1f576c4373ff2251aeb919d">ast_msg_has_destination</a>(msg)) {</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;MESSAGE request received, but no handler wanted it\n&quot;</span>);</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_NOT_FOUND, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <a class="code" href="../../d2/d0d/message_8h.html#a13b928949f293c3b6b9ba3ebe8d64075">ast_msg_destroy</a>(msg);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;   }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;   <span class="comment">/* Send it to the messaging core.</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment">    * If we are unable to send a response, the most likely reason is that we</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment">    * are handling a retransmission of an incoming MESSAGE and were unable to</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment">    * create a transaction due to a duplicate key. If we are unable to send</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">    * a response, we should not queue the message to the dialplan</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a>(rdata, PJSIP_SC_ACCEPTED, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <a class="code" href="../../d2/d0d/message_8h.html#adcb3fd70677c50be8626deec545a42c1">ast_msg_queue</a>(msg);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;   }</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;   <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;}</div><div class="ttc" id="res__pjsip__messaging_8c_html_a81974905ecfbcf33344c899a613aa9dc"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a81974905ecfbcf33344c899a613aa9dc">rx_data_to_ast_msg</a></div><div class="ttdeci">static enum pjsip_status_code rx_data_to_ast_msg(pjsip_rx_data *rdata, struct ast_msg *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01035">res_pjsip_messaging.c:1035</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ae429ac4d5de1dd3e9494a7fdc9e6b509"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ae429ac4d5de1dd3e9494a7fdc9e6b509">pjsip_message_method</a></div><div class="ttdeci">const pjsip_method pjsip_message_method</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00134">res_pjsip_messaging.c:134</a></div></div>
<div class="ttc" id="message_8h_html_a0e4685c7cf1d71204087b992110e6357"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a0e4685c7cf1d71204087b992110e6357">ast_msg_alloc</a></div><div class="ttdeci">struct ast_msg * ast_msg_alloc(void)</div><div class="ttdoc">Allocate a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00418">message.c:418</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a65e47576e4727f58c7cd2ccef4ab0cff"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a65e47576e4727f58c7cd2ccef4ab0cff">check_content_type</a></div><div class="ttdeci">static enum pjsip_status_code check_content_type(const pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00151">res_pjsip_messaging.c:151</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="message_8h_html_adcb3fd70677c50be8626deec545a42c1"><div class="ttname"><a href="../../d2/d0d/message_8h.html#adcb3fd70677c50be8626deec545a42c1">ast_msg_queue</a></div><div class="ttdeci">int ast_msg_queue(struct ast_msg *msg)</div><div class="ttdoc">Queue a message for routing through the dialplan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00958">message.c:958</a></div></div>
<div class="ttc" id="message_8h_html_a76b4f941b1f576c4373ff2251aeb919d"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a76b4f941b1f576c4373ff2251aeb919d">ast_msg_has_destination</a></div><div class="ttdeci">int ast_msg_has_destination(const struct ast_msg *msg)</div><div class="ttdoc">Determine if a particular message has a destination via some handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00937">message.c:937</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_aeee5c33e6ea7af67faf767230cdcbc09"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#aeee5c33e6ea7af67faf767230cdcbc09">send_response</a></div><div class="ttdeci">static pj_status_t send_response(pjsip_rx_data *rdata, enum pjsip_status_code code, pjsip_dialog *dlg, pjsip_transaction *tsx)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01378">res_pjsip_messaging.c:1378</a></div></div>
<div class="ttc" id="structast__msg_html"><div class="ttname"><a href="../../df/da1/structast__msg.html">ast_msg</a></div><div class="ttdoc">A message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00233">message.c:233</a></div></div>
<div class="ttc" id="message_8h_html_a13b928949f293c3b6b9ba3ebe8d64075"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a13b928949f293c3b6b9ba3ebe8d64075">ast_msg_destroy</a></div><div class="ttdeci">struct ast_msg * ast_msg_destroy(struct ast_msg *msg)</div><div class="ttdoc">Destroy an ast_msg. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00448">message.c:448</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a13b2cd8055286713dabe268419f4daaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13b2cd8055286713dabe268419f4daaf">&#9670;&nbsp;</a></span>msg_data_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d3/d60/structmsg__data.html">msg_data</a>* msg_data_create </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01139">1139</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00442">ast_msg_ref()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01125">msg_data::destination</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">msg_data::from</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">msg_data::msg</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01129">msg_data_destroy()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01352">sip_msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;{</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   <span class="keywordtype">char</span> *uri_params;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d60/structmsg__data.html">msg_data</a> *mdata = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*mdata), <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a868e4edc38545912156ac92dc2bb6ba2">msg_data_destroy</a>);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   <span class="keywordflow">if</span> (!mdata) {</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   <span class="comment">/* typecast to suppress const warning */</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a> = <a class="code" href="../../d2/d0d/message_8h.html#a28934ed2a0553c29d7bbcecdb1adf1fb">ast_msg_ref</a>((<span class="keyword">struct</span> <a class="code" href="../../df/da1/structast__msg.html">ast_msg</a> *) msg);</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   <span class="comment">/* To starts with &#39;pjsip:&#39; which needs to be removed. */</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a> = strchr(<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>, <span class="charliteral">&#39;:&#39;</span>))) {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mdata, -1);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   ++<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>;<span class="comment">/* Now skip the &#39;:&#39; */</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;   mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>);</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">    * Sometimes from URI can contain URI parameters, so remove them.</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">    * sip:user;user-options@domain;uri-parameters</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;   uri_params = strchr(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;   <span class="keywordflow">if</span> (uri_params &amp;&amp; (uri_params = strchr(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>, <span class="charliteral">&#39;;&#39;</span>))) {</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      *uri_params = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;   }</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;   <span class="keywordflow">return</span> mdata;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;}</div><div class="ttc" id="structmsg__data_html"><div class="ttname"><a href="../../d3/d60/structmsg__data.html">msg_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00220">message.c:220</a></div></div>
<div class="ttc" id="structmsg__data_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">msg_data::from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">res_pjsip_messaging.c:1126</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structmsg__data_html_a74fb4a11550524adcccccbb455da8ece"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg_data::msg</a></div><div class="ttdeci">struct ast_msg * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">res_pjsip_messaging.c:1124</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a868e4edc38545912156ac92dc2bb6ba2"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a868e4edc38545912156ac92dc2bb6ba2">msg_data_destroy</a></div><div class="ttdeci">static void msg_data_destroy(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01129">res_pjsip_messaging.c:1129</a></div></div>
<div class="ttc" id="message_8h_html_a28934ed2a0553c29d7bbcecdb1adf1fb"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a28934ed2a0553c29d7bbcecdb1adf1fb">ast_msg_ref</a></div><div class="ttdeci">struct ast_msg * ast_msg_ref(struct ast_msg *msg)</div><div class="ttdoc">Bump a msg&amp;#39;s ref count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00442">message.c:442</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="structmsg__data_html_ae98a0878a8abb793b89317d904f8c00a"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">msg_data::destination</a></div><div class="ttdeci">char * destination</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01125">res_pjsip_messaging.c:1125</a></div></div>
<div class="ttc" id="structast__msg_html"><div class="ttname"><a href="../../df/da1/structast__msg.html">ast_msg</a></div><div class="ttdoc">A message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00233">message.c:233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a868e4edc38545912156ac92dc2bb6ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a868e4edc38545912156ac92dc2bb6ba2">&#9670;&nbsp;</a></span>msg_data_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void msg_data_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01129">1129</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00448">ast_msg_destroy()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01125">msg_data::destination</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">msg_data::from</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">msg_data::msg</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01139">msg_data_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;{</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d60/structmsg__data.html">msg_data</a> *mdata = obj;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;   <a class="code" href="../../d2/d0d/message_8h.html#a13b928949f293c3b6b9ba3ebe8d64075">ast_msg_destroy</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;}</div><div class="ttc" id="structmsg__data_html"><div class="ttname"><a href="../../d3/d60/structmsg__data.html">msg_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00220">message.c:220</a></div></div>
<div class="ttc" id="structmsg__data_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">msg_data::from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">res_pjsip_messaging.c:1126</a></div></div>
<div class="ttc" id="structmsg__data_html_a74fb4a11550524adcccccbb455da8ece"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg_data::msg</a></div><div class="ttdeci">struct ast_msg * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">res_pjsip_messaging.c:1124</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structmsg__data_html_ae98a0878a8abb793b89317d904f8c00a"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">msg_data::destination</a></div><div class="ttdeci">char * destination</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01125">res_pjsip_messaging.c:1125</a></div></div>
<div class="ttc" id="message_8h_html_a13b928949f293c3b6b9ba3ebe8d64075"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a13b928949f293c3b6b9ba3ebe8d64075">ast_msg_destroy</a></div><div class="ttdeci">struct ast_msg * ast_msg_destroy(struct ast_msg *msg)</div><div class="ttdoc">Destroy an ast_msg. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00448">message.c:448</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a905ea6789c66d319929f5b74270a793e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a905ea6789c66d319929f5b74270a793e">&#9670;&nbsp;</a></span>msg_send()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int msg_send </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">1221</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00094">ast_begins_with()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00531">ast_msg_get_body()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00536">ast_msg_get_from()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00541">ast_msg_get_to()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05091">ast_sip_add_body()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04490">ast_sip_create_request()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05034">ast_sip_send_request()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01125">msg_data::destination</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">msg_data::from</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00617">get_outbound_endpoint()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">msg_data::msg</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02029">ast_sip_body::type</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01173">update_content_type()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00788">update_from()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00753">update_to_display_name()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00686">update_to_uri()</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00892">vars_to_headers()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01352">sip_msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;{</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d60/structmsg__data.html">msg_data</a> *mdata = data; <span class="comment">/* The caller holds a reference */</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d80/structast__sip__body.html">ast_sip_body</a> body = {</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      .<a class="code" href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a> = <span class="stringliteral">&quot;text&quot;</span>,</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      .subtype = <span class="stringliteral">&quot;plain&quot;</span>,</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      .body_text = <a class="code" href="../../d2/d0d/message_8h.html#abd98509b6e22ab33822ff3c7a2e35756">ast_msg_get_body</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>)</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;   };</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keywordtype">char</span> *, uri, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *, endpoint, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;mdata From: %s msg From: %s mdata Destination: %s msg To: %s\n&quot;</span>,</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>, <a class="code" href="../../d2/d0d/message_8h.html#a393525170186b56f9e6bbcebb9968139">ast_msg_get_from</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>), mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>, <a class="code" href="../../d2/d0d/message_8h.html#a6ddbc20e42c0631602984bc83506aaf2">ast_msg_get_to</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>));</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;   endpoint = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#af07a7dc49ebc610391af8c3f1aa6fad7">get_outbound_endpoint</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>, &amp;uri);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   <span class="keywordflow">if</span> (!endpoint) {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;         <span class="stringliteral">&quot;PJSIP MESSAGE - Could not find endpoint &#39;%s&#39; and no default outbound endpoint configured\n&quot;</span>,</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;         mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;MSG_ENDPOINT_URI_FAIL&quot;</span>,</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;         <span class="stringliteral">&quot;MdataFrom: %s\r\n&quot;</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;         <span class="stringliteral">&quot;MsgFrom: %s\r\n&quot;</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         <span class="stringliteral">&quot;MdataDestination: %s\r\n&quot;</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;         <span class="stringliteral">&quot;MsgTo: %s\r\n&quot;</span>,</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;         mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>,</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;         <a class="code" href="../../d2/d0d/message_8h.html#a393525170186b56f9e6bbcebb9968139">ast_msg_get_from</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>),</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;         mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>,</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;         <a class="code" href="../../d2/d0d/message_8h.html#a6ddbc20e42c0631602984bc83506aaf2">ast_msg_get_to</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>));</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Request URI: %s\n&quot;</span>, uri);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac981149e3fb0f7fc8b6e75607b1b2ad0">ast_sip_create_request</a>(<span class="stringliteral">&quot;MESSAGE&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, endpoint, uri, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata)) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;PJSIP MESSAGE - Could not create request\n&quot;</span>);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   <span class="comment">/* If there was a To in the actual message, */</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d2/d0d/message_8h.html#a6ddbc20e42c0631602984bc83506aaf2">ast_msg_get_to</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>))) {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="keywordtype">char</span> *msg_to = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d2/d0d/message_8h.html#a6ddbc20e42c0631602984bc83506aaf2">ast_msg_get_to</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>));</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">       * It&#39;s possible that the message To was copied from</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">       * an incoming MESSAGE in which case it&#39;ll have the</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">       * pjsip: tech prepended to it.  We need to remove it.</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a>(msg_to, <span class="stringliteral">&quot;pjsip:&quot;</span>)) {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;         msg_to += 6;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a0b354eefff1679f4159cb0e583da9b43">update_to_uri</a>(tdata, msg_to);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">       * If there was no To in the message, it&#39;s still possible</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">       * that there is a display name in the mdata To.  If so,</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">       * we&#39;ll copy the URI display name to the tdata To.</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#af6aa0fbe035f84fbfcc06e30d227c7e5">update_to_display_name</a>(tdata, uri);</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;   }</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>)) {</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ac42e11811d33a202b6fc2875b06334c6">update_from</a>(tdata, mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d2/d0d/message_8h.html#a393525170186b56f9e6bbcebb9968139">ast_msg_get_from</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>))) {</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ac42e11811d33a202b6fc2875b06334c6">update_from</a>(tdata, (<span class="keywordtype">char</span> *)<a class="code" href="../../d2/d0d/message_8h.html#a393525170186b56f9e6bbcebb9968139">ast_msg_get_from</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>));</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      pjsip_name_addr *tdata_name_addr;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      pjsip_sip_uri *tdata_sip_uri;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordtype">char</span> touri[128];</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keywordtype">char</span> fromuri[128];</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      tdata_name_addr = (pjsip_name_addr *) PJSIP_MSG_TO_HDR(tdata-&gt;msg)-&gt;uri;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      tdata_sip_uri = pjsip_uri_get_uri(tdata_name_addr-&gt;uri);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, tdata_sip_uri, touri, <span class="keyword">sizeof</span>(touri));</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      tdata_name_addr = (pjsip_name_addr *) PJSIP_MSG_FROM_HDR(tdata-&gt;msg)-&gt;uri;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      tdata_sip_uri = pjsip_uri_get_uri(tdata_name_addr-&gt;uri);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, tdata_sip_uri, fromuri, <span class="keyword">sizeof</span>(fromuri));</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;MSG_FROMTO_URI&quot;</span>,</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;         <span class="stringliteral">&quot;MdataFrom: %s\r\n&quot;</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;         <span class="stringliteral">&quot;MsgFrom: %s\r\n&quot;</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;         <span class="stringliteral">&quot;MdataDestination: %s\r\n&quot;</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         <span class="stringliteral">&quot;MsgTo: %s\r\n&quot;</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;         <span class="stringliteral">&quot;Endpoint: %s\r\n&quot;</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;         <span class="stringliteral">&quot;RequestURI: %s\r\n&quot;</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;         <span class="stringliteral">&quot;ToURI: %s\r\n&quot;</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;         <span class="stringliteral">&quot;FromURI: %s\r\n&quot;</span>,</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;         mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>,</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;         <a class="code" href="../../d2/d0d/message_8h.html#a393525170186b56f9e6bbcebb9968139">ast_msg_get_from</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>),</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;         mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>,</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;         <a class="code" href="../../d2/d0d/message_8h.html#a6ddbc20e42c0631602984bc83506aaf2">ast_msg_get_to</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>),</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint),</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;         uri,</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;         touri,</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;         fromuri</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;         );</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;   }</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;   <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ab158a98dd09567083bcb7ff83845434a">update_content_type</a>(tdata, mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>, &amp;body);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9a14851d1f88b087df7237ec180de52e">ast_sip_add_body</a>(tdata, &amp;body)) {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;PJSIP MESSAGE - Could not add body to request\n&quot;</span>);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;   }</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">    * This copies any headers set with MESSAGE_DATA() to the</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">    * tdata.</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;   <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a0d39ed2275ccce7bb92d5cb8306de324">vars_to_headers</a>(mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg</a>, tdata);</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Sending message to &#39;%s&#39; (via endpoint %s) from &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      uri, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint), mdata-&gt;<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>);</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9302fd362f9d52147d928c5bc4740433">ast_sip_send_request</a>(tdata, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, endpoint, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;PJSIP MESSAGE - Could not send request\n&quot;</span>);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;   }</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div><div class="ttc" id="structmsg__data_html"><div class="ttname"><a href="../../d3/d60/structmsg__data.html">msg_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00220">message.c:220</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_af6aa0fbe035f84fbfcc06e30d227c7e5"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#af6aa0fbe035f84fbfcc06e30d227c7e5">update_to_display_name</a></div><div class="ttdeci">static int update_to_display_name(pjsip_tx_data *tdata, char *to)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00753">res_pjsip_messaging.c:753</a></div></div>
<div class="ttc" id="structmsg__data_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">msg_data::from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">res_pjsip_messaging.c:1126</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structmsg__data_html_a74fb4a11550524adcccccbb455da8ece"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a74fb4a11550524adcccccbb455da8ece">msg_data::msg</a></div><div class="ttdeci">struct ast_msg * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01124">res_pjsip_messaging.c:1124</a></div></div>
<div class="ttc" id="message_8h_html_abd98509b6e22ab33822ff3c7a2e35756"><div class="ttname"><a href="../../d2/d0d/message_8h.html#abd98509b6e22ab33822ff3c7a2e35756">ast_msg_get_body</a></div><div class="ttdeci">const char * ast_msg_get_body(const struct ast_msg *msg)</div><div class="ttdoc">Get the body of a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00531">message.c:531</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9302fd362f9d52147d928c5bc4740433"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9302fd362f9d52147d928c5bc4740433">ast_sip_send_request</a></div><div class="ttdeci">int ast_sip_send_request(pjsip_tx_data *tdata, struct pjsip_dialog *dlg, struct ast_sip_endpoint *endpoint, void *token, void(*callback)(void *token, pjsip_event *e))</div><div class="ttdoc">General purpose method for sending a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05034">res_pjsip.c:5034</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="message_8h_html_a6ddbc20e42c0631602984bc83506aaf2"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a6ddbc20e42c0631602984bc83506aaf2">ast_msg_get_to</a></div><div class="ttdeci">const char * ast_msg_get_to(const struct ast_msg *msg)</div><div class="ttdoc">Retrieve the destination of this message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00541">message.c:541</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a0d39ed2275ccce7bb92d5cb8306de324"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a0d39ed2275ccce7bb92d5cb8306de324">vars_to_headers</a></div><div class="ttdeci">static enum pjsip_status_code vars_to_headers(const struct ast_msg *msg, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00892">res_pjsip_messaging.c:892</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ab158a98dd09567083bcb7ff83845434a"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ab158a98dd09567083bcb7ff83845434a">update_content_type</a></div><div class="ttdeci">static void update_content_type(pjsip_tx_data *tdata, struct ast_msg *msg, struct ast_sip_body *body)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01173">res_pjsip_messaging.c:1173</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9a14851d1f88b087df7237ec180de52e"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9a14851d1f88b087df7237ec180de52e">ast_sip_add_body</a></div><div class="ttdeci">int ast_sip_add_body(pjsip_tx_data *tdata, const struct ast_sip_body *body)</div><div class="ttdoc">Add a body to an outbound SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05091">res_pjsip.c:5091</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__sip__body_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_body::type</a></div><div class="ttdeci">const char * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02029">res_pjsip.h:2029</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="message_8h_html_a393525170186b56f9e6bbcebb9968139"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a393525170186b56f9e6bbcebb9968139">ast_msg_get_from</a></div><div class="ttdeci">const char * ast_msg_get_from(const struct ast_msg *msg)</div><div class="ttdoc">Retrieve the source of this message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00536">message.c:536</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ac42e11811d33a202b6fc2875b06334c6"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ac42e11811d33a202b6fc2875b06334c6">update_from</a></div><div class="ttdeci">static int update_from(pjsip_tx_data *tdata, char *from)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00788">res_pjsip_messaging.c:788</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_af07a7dc49ebc610391af8c3f1aa6fad7"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#af07a7dc49ebc610391af8c3f1aa6fad7">get_outbound_endpoint</a></div><div class="ttdeci">static struct ast_sip_endpoint * get_outbound_endpoint(const char *to, char **uri)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00617">res_pjsip_messaging.c:617</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a0b354eefff1679f4159cb0e583da9b43"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a0b354eefff1679f4159cb0e583da9b43">update_to_uri</a></div><div class="ttdeci">static int update_to_uri(pjsip_tx_data *tdata, char *to)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00686">res_pjsip_messaging.c:686</a></div></div>
<div class="ttc" id="structmsg__data_html_ae98a0878a8abb793b89317d904f8c00a"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">msg_data::destination</a></div><div class="ttdeci">char * destination</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01125">res_pjsip_messaging.c:1125</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="strings_8h_html_ac51fa66c90ce950b248c9ff3e8c4e453"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a></div><div class="ttdeci">static int force_inline attribute_pure ast_begins_with(const char *str, const char *prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00094">strings.h:94</a></div></div>
<div class="ttc" id="structast__sip__body_html"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html">ast_sip_body</a></div><div class="ttdoc">SIP body description. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02027">res_pjsip.h:2027</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ac981149e3fb0f7fc8b6e75607b1b2ad0"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ac981149e3fb0f7fc8b6e75607b1b2ad0">ast_sip_create_request</a></div><div class="ttdeci">int ast_sip_create_request(const char *method, struct pjsip_dialog *dlg, struct ast_sip_endpoint *endpoint, const char *uri, struct ast_sip_contact *contact, pjsip_tx_data **tdata)</div><div class="ttdoc">General purpose method for creating a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04490">res_pjsip.c:4490</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8394b1c6dd395101ed928c7b9aa95f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8394b1c6dd395101ed928c7b9aa95f5c">&#9670;&nbsp;</a></span>print_body()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int print_body </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00964">964</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01035">rx_data_to_ast_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;{</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   <span class="keywordflow">if</span> (!rdata-&gt;msg_info.msg-&gt;body || !rdata-&gt;msg_info.msg-&gt;body-&gt;len) {</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="keywordflow">if</span> ((res = rdata-&gt;msg_info.msg-&gt;body-&gt;print_body(</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;           rdata-&gt;msg_info.msg-&gt;body, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)) &lt; 0) {</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   }</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   <span class="comment">/* remove any trailing carriage return/line feeds */</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <span class="keywordflow">while</span> (res &gt; 0 &amp;&amp; ((<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[--res] == <span class="charliteral">&#39;\r&#39;</span>) || (<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[res] == <span class="charliteral">&#39;\n&#39;</span>)));</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[++res] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81974905ecfbcf33344c899a613aa9dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81974905ecfbcf33344c899a613aa9dc">&#9670;&nbsp;</a></span>rx_data_to_ast_msg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum pjsip_status_code rx_data_to_ast_msg </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01035">1035</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00135">AST_MAX_EXTENSION</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00476">ast_msg_set_body()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00487">ast_msg_set_context()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00520">ast_msg_set_endpoint()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00498">ast_msg_set_exten()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00465">ast_msg_set_from()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00509">ast_msg_set_tech()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00454">ast_msg_set_to()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00615">ast_msg_set_var()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">ast_pjsip_rdata_get_endpoint()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l03036">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00116">context</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00118">exten</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00927">headers_to_vars()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00137">MAX_BODY_SIZE</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00964">print_body()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00994">sip_to_pjsip()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01407">module_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;{</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *, endpt, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   pjsip_uri *ruri = rdata-&gt;msg_info.msg-&gt;line.req.uri;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   pjsip_sip_uri *sip_ruri;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   pjsip_name_addr *name_addr;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ac5e37b70822d3f246d9fa30873601976">MAX_BODY_SIZE</a>];</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *field;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;   <span class="keywordtype">int</span> size;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(ruri) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(ruri)) {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_UNSUPPORTED_URI_SCHEME;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   sip_ruri = pjsip_uri_get_uri(ruri);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(exten, &amp;sip_ruri-&gt;user, <a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">    * We may want to match in the dialplan without any user</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">    * options getting in the way.</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>(exten);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   endpt = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a>(rdata);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(endpt != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   context = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(endpt-&gt;message_context, endpt-&gt;context);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   res |= <a class="code" href="../../d2/d0d/message_8h.html#a9e2045ad672c0afd5fb2616fec6bc666">ast_msg_set_context</a>(msg, <span class="stringliteral">&quot;%s&quot;</span>, context);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   res |= <a class="code" href="../../d2/d0d/message_8h.html#a71dd7465491023d1d7fd467f2920f2b8">ast_msg_set_exten</a>(msg, <span class="stringliteral">&quot;%s&quot;</span>, exten);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   <span class="comment">/* to header */</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   name_addr = (pjsip_name_addr *)rdata-&gt;msg_info.to-&gt;uri;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   size = pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, name_addr, buf, <span class="keyword">sizeof</span>(buf) - 1);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   <span class="keywordflow">if</span> (size &lt;= 0) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_INTERNAL_SERVER_ERROR;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;   }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   buf[size] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   res |= <a class="code" href="../../d2/d0d/message_8h.html#acf4073638cf23022399e3666c804e178">ast_msg_set_to</a>(msg, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a5d9cc755e1f41111cb6077ef38a5f656">sip_to_pjsip</a>(buf, ++size, <span class="keyword">sizeof</span>(buf) - 1));</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   <span class="comment">/* from header */</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   name_addr = (pjsip_name_addr *)rdata-&gt;msg_info.from-&gt;uri;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;   size = pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, name_addr, buf, <span class="keyword">sizeof</span>(buf) - 1);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   <span class="keywordflow">if</span> (size &lt;= 0) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_INTERNAL_SERVER_ERROR;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   }</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;   buf[size] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   res |= <a class="code" href="../../d2/d0d/message_8h.html#a02a688837f4e91ea078c0b1b48017ef8">ast_msg_set_from</a>(msg, <span class="stringliteral">&quot;%s&quot;</span>, buf);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   field = pj_sockaddr_print(&amp;rdata-&gt;pkt_info.src_addr, buf, <span class="keyword">sizeof</span>(buf) - 1, 3);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   res |= <a class="code" href="../../d2/d0d/message_8h.html#a926dc659d6f9d88782e9d0e463ba8c47">ast_msg_set_var</a>(msg, <span class="stringliteral">&quot;PJSIP_RECVADDR&quot;</span>, field);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   <span class="keywordflow">switch</span> (rdata-&gt;tp_info.transport-&gt;key.type) {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   <span class="keywordflow">case</span> PJSIP_TRANSPORT_UDP:</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;   <span class="keywordflow">case</span> PJSIP_TRANSPORT_UDP6:</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      field = <span class="stringliteral">&quot;udp&quot;</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   <span class="keywordflow">case</span> PJSIP_TRANSPORT_TCP:</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;   <span class="keywordflow">case</span> PJSIP_TRANSPORT_TCP6:</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      field = <span class="stringliteral">&quot;tcp&quot;</span>;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   <span class="keywordflow">case</span> PJSIP_TRANSPORT_TLS:</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;   <span class="keywordflow">case</span> PJSIP_TRANSPORT_TLS6:</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      field = <span class="stringliteral">&quot;tls&quot;</span>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      field = rdata-&gt;tp_info.transport-&gt;type_name;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   <a class="code" href="../../d2/d0d/message_8h.html#a926dc659d6f9d88782e9d0e463ba8c47">ast_msg_set_var</a>(msg, <span class="stringliteral">&quot;PJSIP_TRANSPORT&quot;</span>, field);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a8394b1c6dd395101ed928c7b9aa95f5c">print_body</a>(rdata, buf, <span class="keyword">sizeof</span>(buf) - 1) &gt; 0) {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      res |= <a class="code" href="../../d2/d0d/message_8h.html#aa21f081993590c1410b287d717a92282">ast_msg_set_body</a>(msg, <span class="stringliteral">&quot;%s&quot;</span>, buf);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <span class="comment">/* endpoint name */</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;   res |= <a class="code" href="../../d2/d0d/message_8h.html#a757a64be14a9fc2b47a37f5ce9e742d5">ast_msg_set_tech</a>(msg, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;PJSIP&quot;</span>);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   res |= <a class="code" href="../../d2/d0d/message_8h.html#a53573a834e1a26d67c26ba58a9ad8274">ast_msg_set_endpoint</a>(msg, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpt));</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   <span class="keywordflow">if</span> (endpt-&gt;id.self.name.valid) {</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      res |= <a class="code" href="../../d2/d0d/message_8h.html#a926dc659d6f9d88782e9d0e463ba8c47">ast_msg_set_var</a>(msg, <span class="stringliteral">&quot;PJSIP_ENDPOINT&quot;</span>, endpt-&gt;id.self.name.str);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   res |= <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ae4e8da67e55baa0f1cf10f3772e63c82">headers_to_vars</a>(rdata, msg);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;   <span class="keywordflow">return</span> !res ? PJSIP_SC_OK : PJSIP_SC_INTERNAL_SERVER_ERROR;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;}</div><div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a6bb5769d100d0348446c7f032eca58c1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a></div><div class="ttdeci">#define AST_SIP_USER_OPTIONS_TRUNCATE_CHECK(str)</div><div class="ttdoc">Truncate the URI user field options string if enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l03036">res_pjsip.h:3036</a></div></div>
<div class="ttc" id="message_8h_html_a757a64be14a9fc2b47a37f5ce9e742d5"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a757a64be14a9fc2b47a37f5ce9e742d5">ast_msg_set_tech</a></div><div class="ttdeci">int ast_msg_set_tech(struct ast_msg *msg, const char *fmt,...)</div><div class="ttdoc">Set the technology associated with this message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00509">message.c:509</a></div></div>
<div class="ttc" id="message_8h_html_a9e2045ad672c0afd5fb2616fec6bc666"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a9e2045ad672c0afd5fb2616fec6bc666">ast_msg_set_context</a></div><div class="ttdeci">int ast_msg_set_context(struct ast_msg *msg, const char *fmt,...)</div><div class="ttdoc">Set the dialplan context for this message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00487">message.c:487</a></div></div>
<div class="ttc" id="message_8h_html_aa21f081993590c1410b287d717a92282"><div class="ttname"><a href="../../d2/d0d/message_8h.html#aa21f081993590c1410b287d717a92282">ast_msg_set_body</a></div><div class="ttdeci">int ast_msg_set_body(struct ast_msg *msg, const char *fmt,...)</div><div class="ttdoc">Set the &amp;#39;body&amp;#39; text of a message (in UTF-8) </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00476">message.c:476</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ac5e37b70822d3f246d9fa30873601976"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ac5e37b70822d3f246d9fa30873601976">MAX_BODY_SIZE</a></div><div class="ttdeci">#define MAX_BODY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00137">res_pjsip_messaging.c:137</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a5d9cc755e1f41111cb6077ef38a5f656"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a5d9cc755e1f41111cb6077ef38a5f656">sip_to_pjsip</a></div><div class="ttdeci">static char * sip_to_pjsip(char *buf, int size, int capacity)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00994">res_pjsip_messaging.c:994</a></div></div>
<div class="ttc" id="message_8h_html_acf4073638cf23022399e3666c804e178"><div class="ttname"><a href="../../d2/d0d/message_8h.html#acf4073638cf23022399e3666c804e178">ast_msg_set_to</a></div><div class="ttdeci">int ast_msg_set_to(struct ast_msg *msg, const char *fmt,...)</div><div class="ttdoc">Set the &amp;#39;to&amp;#39; URI of a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00454">message.c:454</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a0dc7590db76dcdc0105abc92072d1b06"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_pjsip_rdata_get_endpoint(pjsip_rx_data *rdata)</div><div class="ttdoc">Get the looked-up endpoint on an out-of dialog request or response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">pjsip_distributor.c:969</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="channel_8h_html_af4e59494f74ad9e0c50170d9e276ad31"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a></div><div class="ttdeci">#define AST_MAX_EXTENSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00135">channel.h:135</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="message_8h_html_a926dc659d6f9d88782e9d0e463ba8c47"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a926dc659d6f9d88782e9d0e463ba8c47">ast_msg_set_var</a></div><div class="ttdeci">int ast_msg_set_var(struct ast_msg *msg, const char *name, const char *value)</div><div class="ttdoc">Set a variable on the message going to the dialplan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00615">message.c:615</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ae4e8da67e55baa0f1cf10f3772e63c82"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ae4e8da67e55baa0f1cf10f3772e63c82">headers_to_vars</a></div><div class="ttdeci">static int headers_to_vars(const pjsip_rx_data *rdata, struct ast_msg *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00927">res_pjsip_messaging.c:927</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a8394b1c6dd395101ed928c7b9aa95f5c"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a8394b1c6dd395101ed928c7b9aa95f5c">print_body</a></div><div class="ttdeci">static int print_body(pjsip_rx_data *rdata, char *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00964">res_pjsip_messaging.c:964</a></div></div>
<div class="ttc" id="message_8h_html_a71dd7465491023d1d7fd467f2920f2b8"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a71dd7465491023d1d7fd467f2920f2b8">ast_msg_set_exten</a></div><div class="ttdeci">int ast_msg_set_exten(struct ast_msg *msg, const char *fmt,...)</div><div class="ttdoc">Set the dialplan extension for this message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00498">message.c:498</a></div></div>
<div class="ttc" id="message_8h_html_a02a688837f4e91ea078c0b1b48017ef8"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a02a688837f4e91ea078c0b1b48017ef8">ast_msg_set_from</a></div><div class="ttdeci">int ast_msg_set_from(struct ast_msg *msg, const char *fmt,...)</div><div class="ttdoc">Set the &amp;#39;from&amp;#39; URI of a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00465">message.c:465</a></div></div>
<div class="ttc" id="message_8h_html_a53573a834e1a26d67c26ba58a9ad8274"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a53573a834e1a26d67c26ba58a9ad8274">ast_msg_set_endpoint</a></div><div class="ttdeci">int ast_msg_set_endpoint(struct ast_msg *msg, const char *fmt,...)</div><div class="ttdoc">Set the technology&amp;#39;s endpoint associated with this message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00520">message.c:520</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeee5c33e6ea7af67faf767230cdcbc09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeee5c33e6ea7af67faf767230cdcbc09">&#9670;&nbsp;</a></span>send_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_status_t send_response </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum pjsip_status_code&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_transaction *&#160;</td>
          <td class="paramname"><em>tsx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01378">1378</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">ast_pjsip_rdata_get_endpoint()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05448">ast_sip_create_response()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05420">ast_sip_send_stateful_response()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00146">status</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01457">incoming_in_dialog_request()</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01407">module_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;{</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   pj_status_t <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;   status = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d26a9ba468e7b251897c56032705447">ast_sip_create_response</a>(rdata, code, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata);</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;   <span class="keywordflow">if</span> (status != PJ_SUCCESS) {</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to create response (%d)\n&quot;</span>, status);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;   }</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;   <span class="keywordflow">if</span> (dlg &amp;&amp; tsx) {</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      status = pjsip_dlg_send_response(dlg, tsx, tdata);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a>(rdata);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      status = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae207f7592aa7a69d0425a77bb8aa494d">ast_sip_send_stateful_response</a>(rdata, tdata, endpoint);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(endpoint);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;   }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;   <span class="keywordflow">if</span> (status != PJ_SUCCESS) {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to send response (%d)\n&quot;</span>, status);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   }</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a0dc7590db76dcdc0105abc92072d1b06"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_pjsip_rdata_get_endpoint(pjsip_rx_data *rdata)</div><div class="ttdoc">Get the looked-up endpoint on an out-of dialog request or response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">pjsip_distributor.c:969</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d26a9ba468e7b251897c56032705447"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d26a9ba468e7b251897c56032705447">ast_sip_create_response</a></div><div class="ttdeci">int ast_sip_create_response(const pjsip_rx_data *rdata, int st_code, struct ast_sip_contact *contact, pjsip_tx_data **p_tdata)</div><div class="ttdoc">General purpose method for creating a SIP response. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05448">res_pjsip.c:5448</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ae207f7592aa7a69d0425a77bb8aa494d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae207f7592aa7a69d0425a77bb8aa494d">ast_sip_send_stateful_response</a></div><div class="ttdeci">int ast_sip_send_stateful_response(pjsip_rx_data *rdata, pjsip_tx_data *tdata, struct ast_sip_endpoint *sip_endpoint)</div><div class="ttdoc">Send a stateful response to an out of dialog request. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05420">res_pjsip.c:5420</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc11a48a4a3b69575eb23eff5563c93d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc11a48a4a3b69575eb23eff5563c93d">&#9670;&nbsp;</a></span>sip_msg_send()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sip_msg_send </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01352">1352</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05218">ast_sip_push_task_wait_serializer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01139">msg_data_create()</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;{</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d60/structmsg__data.html">msg_data</a> *mdata;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>)) {</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;SIP MESSAGE - a &#39;To&#39; URI  must be specified\n&quot;</span>);</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;   }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   mdata = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a13b2cd8055286713dabe268419f4daaf">msg_data_create</a>(msg, <a class="code" href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">destination</a>, <a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>);</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;   <span class="keywordflow">if</span> (!mdata) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   }</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   res = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gac231880459dcf8feacf1bb272b60472a">ast_sip_push_task_wait_serializer</a>(<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a>, <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a905ea6789c66d319929f5b74270a793e">msg_send</a>, mdata);</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(mdata, -1);</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;}</div><div class="ttc" id="structmsg__data_html"><div class="ttname"><a href="../../d3/d60/structmsg__data.html">msg_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00220">message.c:220</a></div></div>
<div class="ttc" id="structmsg__data_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">msg_data::from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">res_pjsip_messaging.c:1126</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_aca8e337fca6e1a8575e04a4c8ecef07c"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a></div><div class="ttdeci">static struct ast_taskprocessor * message_serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00140">res_pjsip_messaging.c:140</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gac231880459dcf8feacf1bb272b60472a"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gac231880459dcf8feacf1bb272b60472a">ast_sip_push_task_wait_serializer</a></div><div class="ttdeci">int ast_sip_push_task_wait_serializer(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Push a task to the serializer and wait for it to complete. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05218">res_pjsip.c:5218</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structmsg__data_html_ae98a0878a8abb793b89317d904f8c00a"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#ae98a0878a8abb793b89317d904f8c00a">msg_data::destination</a></div><div class="ttdeci">char * destination</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01125">res_pjsip_messaging.c:1125</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a905ea6789c66d319929f5b74270a793e"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a905ea6789c66d319929f5b74270a793e">msg_send</a></div><div class="ttdeci">static int msg_send(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">res_pjsip_messaging.c:1221</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a13b2cd8055286713dabe268419f4daaf"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a13b2cd8055286713dabe268419f4daaf">msg_data_create</a></div><div class="ttdeci">static struct msg_data * msg_data_create(const struct ast_msg *msg, const char *destination, const char *from)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01139">res_pjsip_messaging.c:1139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d9cc755e1f41111cb6077ef38a5f656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d9cc755e1f41111cb6077ef38a5f656">&#9670;&nbsp;</a></span>sip_to_pjsip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* sip_to_pjsip </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00994">994</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01035">rx_data_to_ast_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;{</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <span class="keywordtype">int</span> count;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *scheme;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="keywordtype">char</span> *res = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   <span class="comment">/* remove any wrapping brackets */</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <span class="keywordflow">if</span> (*<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> == <span class="charliteral">&#39;&lt;&#39;</span>) {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      ++<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      --size;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   scheme = strncmp(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="stringliteral">&quot;sip&quot;</span>, 3) ? <span class="stringliteral">&quot;pjsip:&quot;</span> : <span class="stringliteral">&quot;pj&quot;</span>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;   count = strlen(scheme);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <span class="keywordflow">if</span> (count + size &gt;= capacity) {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to handle MESSAGE- incoming uri &quot;</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;         <span class="stringliteral">&quot;too large for given buffer\n&quot;</span>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   memmove(res + count, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   memcpy(res, scheme, count);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;   <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> += size - 1;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   <span class="keywordflow">if</span> (*<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> == <span class="charliteral">&#39;&gt;&#39;</span>) {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01596">1596</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00328">AST_MODPRI_APP_DEPEND</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01610">ast_msg_tech_unregister()</a>, <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00063">ast_sip_session_unregister_supplement()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03331">ast_sip_unregister_service()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01109">ast_taskprocessor_unreference()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01566">load_module()</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01559">messaging_module</a>.</p>
<div class="fragment"><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;{</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#aae89632996ffdcf888ab251c14dc6cdb">ast_sip_session_unregister_supplement</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a0c35f42c26b1c5830f78536249397c81">messaging_supplement</a>);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;   <a class="code" href="../../d2/d0d/message_8h.html#a8a1ffcfecf1ffbc22c526796cdf954a7">ast_msg_tech_unregister</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#adee47ce28cd17bbdc773df287fc062c5">msg_tech</a>);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a>);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a>(<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a>);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;}</div><div class="ttc" id="res__pjsip__messaging_8c_html_adee47ce28cd17bbdc773df287fc062c5"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#adee47ce28cd17bbdc773df287fc062c5">msg_tech</a></div><div class="ttdeci">static const struct ast_msg_tech msg_tech</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01373">res_pjsip_messaging.c:1373</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_aae89632996ffdcf888ab251c14dc6cdb"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#aae89632996ffdcf888ab251c14dc6cdb">ast_sip_session_unregister_supplement</a></div><div class="ttdeci">void ast_sip_session_unregister_supplement(struct ast_sip_session_supplement *supplement)</div><div class="ttdoc">Unregister a an supplement to SIP session processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00063">pjsip_session.c:63</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_aca8e337fca6e1a8575e04a4c8ecef07c"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#aca8e337fca6e1a8575e04a4c8ecef07c">message_serializer</a></div><div class="ttdeci">static struct ast_taskprocessor * message_serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00140">res_pjsip_messaging.c:140</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a8a2bd7e56fa8b771cccce9605eba7d33"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a8a2bd7e56fa8b771cccce9605eba7d33">messaging_module</a></div><div class="ttdeci">static pjsip_module messaging_module</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01559">res_pjsip_messaging.c:1559</a></div></div>
<div class="ttc" id="message_8h_html_a8a1ffcfecf1ffbc22c526796cdf954a7"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a8a1ffcfecf1ffbc22c526796cdf954a7">ast_msg_tech_unregister</a></div><div class="ttdeci">int ast_msg_tech_unregister(const struct ast_msg_tech *tech)</div><div class="ttdoc">Unregister a message technology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01610">message.c:1610</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a32492eb2480cb8c46ad669622cff8556"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a></div><div class="ttdeci">void * ast_taskprocessor_unreference(struct ast_taskprocessor *tps)</div><div class="ttdoc">Unreference the specified taskprocessor and its reference count will decrement. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01109">taskprocessor.c:1109</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a15aa09d9084763cdd20b7467a4cd381a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a></div><div class="ttdeci">void ast_sip_unregister_service(pjsip_module *module)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03331">res_pjsip.c:3331</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a0c35f42c26b1c5830f78536249397c81"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a0c35f42c26b1c5830f78536249397c81">messaging_supplement</a></div><div class="ttdeci">static struct ast_sip_session_supplement messaging_supplement</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01554">res_pjsip_messaging.c:1554</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab158a98dd09567083bcb7ff83845434a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab158a98dd09567083bcb7ff83845434a">&#9670;&nbsp;</a></span>update_content_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_content_type </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d5/d80/structast__sip__body.html">ast_sip_body</a> *&#160;</td>
          <td class="paramname"><em>body</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01173">1173</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00620">ast_msg_get_var()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02031">ast_sip_body::subtype</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02029">ast_sip_body::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;{</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t CONTENT_TYPE = { <span class="stringliteral">&quot;Content-Type&quot;</span>, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;Content-Type&quot;</span>) - 1 };</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *content_type = <a class="code" href="../../d2/d0d/message_8h.html#a5e9d57452f36f2c594799b35d916c27b">ast_msg_get_var</a>(msg, pj_strbuf(&amp;CONTENT_TYPE));</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <span class="keywordflow">if</span> (content_type) {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      pj_str_t <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, subtype;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      pjsip_ctype_hdr *parsed;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="comment">/* Let pjsip do the parsing for us */</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      parsed = pjsip_parse_hdr(tdata-&gt;pool, &amp;CONTENT_TYPE,</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(content_type), strlen(content_type),</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;         <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      <span class="keywordflow">if</span> (!parsed) {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to parse &#39;%s&#39; as a content type. Using text/plain\n&quot;</span>,</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            content_type);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="comment">/* We need to turn type and subtype into zero-terminated strings */</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      pj_strdup_with_null(tdata-&gt;pool, &amp;type, &amp;parsed-&gt;media.type);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      pj_strdup_with_null(tdata-&gt;pool, &amp;subtype, &amp;parsed-&gt;media.subtype);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      body-&gt;<a class="code" href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a> = pj_strbuf(&amp;type);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      body-&gt;<a class="code" href="../../d5/d80/structast__sip__body.html#abb4ae60bbcbce3616fdd7d4238869c91">subtype</a> = pj_strbuf(&amp;subtype);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;   }</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="message_8h_html_a5e9d57452f36f2c594799b35d916c27b"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a5e9d57452f36f2c594799b35d916c27b">ast_msg_get_var</a></div><div class="ttdeci">const char * ast_msg_get_var(struct ast_msg *msg, const char *name)</div><div class="ttdoc">Get the specified variable on the message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00620">message.c:620</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__body_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_body::type</a></div><div class="ttdeci">const char * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02029">res_pjsip.h:2029</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="structast__sip__body_html_abb4ae60bbcbce3616fdd7d4238869c91"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#abb4ae60bbcbce3616fdd7d4238869c91">ast_sip_body::subtype</a></div><div class="ttdeci">const char * subtype</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02031">res_pjsip.h:2031</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac42e11811d33a202b6fc2875b06334c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac42e11811d33a202b6fc2875b06334c6">&#9670;&nbsp;</a></span>update_from()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int update_from </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00788">788</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;{</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   pjsip_name_addr *name_addr;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   pjsip_sip_uri *uri;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   pjsip_name_addr *parsed_name_addr;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>)) {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   name_addr = (pjsip_name_addr *) PJSIP_MSG_FROM_HDR(tdata-&gt;msg)-&gt;uri;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   uri = pjsip_uri_get_uri(name_addr);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   parsed_name_addr = (pjsip_name_addr *) pjsip_parse_uri(tdata-&gt;pool, <a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      strlen(<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>), PJSIP_PARSE_URI_AS_NAMEADDR);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="keywordflow">if</span> (parsed_name_addr) {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      pjsip_sip_uri *parsed_uri;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(parsed_name_addr-&gt;uri)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(parsed_name_addr-&gt;uri)) {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;From address &#39;%s&#39; is not a valid SIP/SIPS URI\n&quot;</span>, <a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      parsed_uri = pjsip_uri_get_uri(parsed_name_addr-&gt;uri);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      <span class="keywordflow">if</span> (pj_strlen(&amp;parsed_name_addr-&gt;display)) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;         pj_strdup(tdata-&gt;pool, &amp;name_addr-&gt;display, &amp;parsed_name_addr-&gt;display);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="comment">/* Unlike the To header, we only want to replace the user, host and port */</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      pj_strdup(tdata-&gt;pool, &amp;uri-&gt;user, &amp;parsed_uri-&gt;user);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      pj_strdup(tdata-&gt;pool, &amp;uri-&gt;host, &amp;parsed_uri-&gt;host);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      uri-&gt;port = parsed_uri-&gt;port;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <span class="comment">/* assume it is &#39;user[@domain]&#39; format */</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../dd/dac/structdomain.html">domain</a> = strchr(<a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>, <span class="charliteral">&#39;@&#39;</span>);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">if</span> (domain) {</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         pj_str_t pj_from;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;         pj_strset3(&amp;pj_from, <a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>, domain);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;         pj_strdup(tdata-&gt;pool, &amp;uri-&gt;user, &amp;pj_from);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;         pj_strdup2(tdata-&gt;pool, &amp;uri-&gt;host, domain + 1);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;         pj_strdup2(tdata-&gt;pool, &amp;uri-&gt;user, <a class="code" href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">from</a>);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      }</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;   }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div><div class="ttc" id="structmsg__data_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../d3/d60/structmsg__data.html#a765533dfc643627999c751f7e1514664">msg_data::from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01126">res_pjsip_messaging.c:1126</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structdomain_html"><div class="ttname"><a href="../../dd/dac/structdomain.html">domain</a></div><div class="ttdoc">Domain data structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d94/sip_8h_source.html#l00888">sip.h:888</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6aa0fbe035f84fbfcc06e30d227c7e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6aa0fbe035f84fbfcc06e30d227c7e5">&#9670;&nbsp;</a></span>update_to_display_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int update_to_display_name </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00753">753</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;{</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   pjsip_name_addr *parsed_name_addr;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   parsed_name_addr = (pjsip_name_addr *) pjsip_parse_uri(tdata-&gt;pool, to, strlen(to),</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      PJSIP_PARSE_URI_AS_NAMEADDR);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="keywordflow">if</span> (parsed_name_addr) {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">if</span> (pj_strlen(&amp;parsed_name_addr-&gt;display)) {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;         pjsip_name_addr *name_addr =</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            (pjsip_name_addr *) PJSIP_MSG_TO_HDR(tdata-&gt;msg)-&gt;uri;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;         pj_strdup(tdata-&gt;pool, &amp;name_addr-&gt;display, &amp;parsed_name_addr-&gt;display);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a0b354eefff1679f4159cb0e583da9b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b354eefff1679f4159cb0e583da9b43">&#9670;&nbsp;</a></span>update_to_uri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int update_to_uri </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00686">686</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00441">DEBUG_ATLEAST</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c.html#a758f9da8805a79adbe236829c3802703">DEBUG_BUF_SIZE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   pjsip_name_addr *parsed_name_addr;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   pjsip_sip_uri *sip_uri;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   pjsip_name_addr *tdata_name_addr;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   pjsip_sip_uri *tdata_sip_uri;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="preprocessor">#define DEBUG_BUF_SIZE 256</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   parsed_name_addr = (pjsip_name_addr *) pjsip_parse_uri(tdata-&gt;pool, to, strlen(to),</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      PJSIP_PARSE_URI_AS_NAMEADDR);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordflow">if</span> (!parsed_name_addr || (!PJSIP_URI_SCHEME_IS_SIP(parsed_name_addr-&gt;uri)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;         &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(parsed_name_addr-&gt;uri))) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;To address &#39;%s&#39; is not a valid SIP/SIPS URI\n&quot;</span>, to);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   }</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   sip_uri = pjsip_uri_get_uri(parsed_name_addr-&gt;uri);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a>(3)) {</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      buf = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a758f9da8805a79adbe236829c3802703">DEBUG_BUF_SIZE</a>);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, sip_uri, buf, <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a758f9da8805a79adbe236829c3802703">DEBUG_BUF_SIZE</a>);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Parsed To: %.*s  %s\n&quot;</span>, (<span class="keywordtype">int</span>)parsed_name_addr-&gt;display.slen,</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;         parsed_name_addr-&gt;display.ptr, buf);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   tdata_name_addr = (pjsip_name_addr *) PJSIP_MSG_TO_HDR(tdata-&gt;msg)-&gt;uri;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="keywordflow">if</span> (!tdata_name_addr || (!PJSIP_URI_SCHEME_IS_SIP(tdata_name_addr-&gt;uri)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;         &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(tdata_name_addr-&gt;uri))) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="comment">/* Highly unlikely but we have to check */</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;tdata To address &#39;%s&#39; is not a valid SIP/SIPS URI\n&quot;</span>, to);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   tdata_sip_uri = pjsip_uri_get_uri(tdata_name_addr-&gt;uri);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a>(3)) {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, tdata_sip_uri, buf, <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a758f9da8805a79adbe236829c3802703">DEBUG_BUF_SIZE</a>);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Original tdata To: %.*s  %s\n&quot;</span>, (<span class="keywordtype">int</span>)tdata_name_addr-&gt;display.slen,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;         tdata_name_addr-&gt;display.ptr, buf);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="comment">/* Replace the uri */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   pjsip_sip_uri_assign(tdata-&gt;pool, tdata_sip_uri, sip_uri);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="comment">/* The display name isn&#39;t part of the URI so we need to replace it separately */</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   pj_strdup(tdata-&gt;pool, &amp;tdata_name_addr-&gt;display, &amp;parsed_name_addr-&gt;display);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a>(3)) {</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_FROMTO_HDR, tdata_sip_uri, buf, 256);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;New tdata To: %.*s  %s\n&quot;</span>, (<span class="keywordtype">int</span>)tdata_name_addr-&gt;display.slen,</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;         tdata_name_addr-&gt;display.ptr, buf);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="preprocessor">#undef DEBUG_BUF_SIZE</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_a758f9da8805a79adbe236829c3802703"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a758f9da8805a79adbe236829c3802703">DEBUG_BUF_SIZE</a></div><div class="ttdeci">#define DEBUG_BUF_SIZE</div></div>
<div class="ttc" id="logger_8h_html_a33f6031de4ab6d1406465a7a3ee18e86"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a></div><div class="ttdeci">#define DEBUG_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00441">logger.h:441</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d39ed2275ccce7bb92d5cb8306de324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d39ed2275ccce7bb92d5cb8306de324">&#9670;&nbsp;</a></span>vars_to_headers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum pjsip_status_code vars_to_headers </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../df/da1/structast__msg.html">ast_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00892">892</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00706">ast_msg_var_iterator_destroy()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00644">ast_msg_var_iterator_init()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00689">ast_msg_var_iterator_next()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00700">ast_msg_var_unref_current()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05063">ast_sip_add_header()</a>, <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00857">is_msg_var_blocked()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00640">ast_msg_var_iterator::iter</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01221">msg_send()</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d3/d68/structmax__forwards.html">max_forwards</a>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d23/structast__msg__var__iterator.html">ast_msg_var_iterator</a> *<a class="code" href="../../d6/d23/structast__msg__var__iterator.html#ad124a1fa9e80dc3b4cd9d537ba16d3d4">iter</a>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   <span class="keywordflow">for</span> (iter = <a class="code" href="../../d2/d0d/message_8h.html#a2903b6879e5710a6226825c1a0b84bd7">ast_msg_var_iterator_init</a>(msg);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <a class="code" href="../../d2/d0d/message_8h.html#a6060c18710de4d3cc8bdc87152234450">ast_msg_var_iterator_next</a>(msg, iter, &amp;name, &amp;value);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <a class="code" href="../../d2/d0d/message_8h.html#ad11b71dc312056abfcd80727fba68fa6">ast_msg_var_unref_current</a>(iter)) {</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(name, <span class="stringliteral">&quot;Max-Forwards&quot;</span>)) {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;         <span class="comment">/* Decrement Max-Forwards for SIP loop prevention. */</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;         <span class="keywordflow">if</span> (sscanf(value, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;max_forwards) != 1 || --max_forwards == 0) {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <a class="code" href="../../d2/d0d/message_8h.html#a4303d30986de10390f263dc640d41a99">ast_msg_var_iterator_destroy</a>(iter);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;MESSAGE(Max-Forwards) reached zero.  MESSAGE not sent.\n&quot;</span>);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;         }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;         sprintf((<span class="keywordtype">char</span> *) value, <span class="stringliteral">&quot;%d&quot;</span>, max_forwards);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#acef4d0aef5bdc92f0b6b188e48f2e90f">ast_sip_add_header</a>(tdata, name, value);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#ae2c279d5e676c37196c20e8b79bda541">is_msg_var_blocked</a>(name)) {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#acef4d0aef5bdc92f0b6b188e48f2e90f">ast_sip_add_header</a>(tdata, name, value);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;   }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;   <a class="code" href="../../d2/d0d/message_8h.html#a4303d30986de10390f263dc640d41a99">ast_msg_var_iterator_destroy</a>(iter);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   <span class="keywordflow">return</span> PJSIP_SC_OK;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;}</div><div class="ttc" id="structast__msg__var__iterator_html_ad124a1fa9e80dc3b4cd9d537ba16d3d4"><div class="ttname"><a href="../../d6/d23/structast__msg__var__iterator.html#ad124a1fa9e80dc3b4cd9d537ba16d3d4">ast_msg_var_iterator::iter</a></div><div class="ttdeci">struct ao2_iterator iter</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00640">message.c:640</a></div></div>
<div class="ttc" id="message_8h_html_a6060c18710de4d3cc8bdc87152234450"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a6060c18710de4d3cc8bdc87152234450">ast_msg_var_iterator_next</a></div><div class="ttdeci">int ast_msg_var_iterator_next(const struct ast_msg *msg, struct ast_msg_var_iterator *iter, const char **name, const char **value)</div><div class="ttdoc">Get the next variable name and value that is set for sending outbound. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00689">message.c:689</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="message_8h_html_a4303d30986de10390f263dc640d41a99"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a4303d30986de10390f263dc640d41a99">ast_msg_var_iterator_destroy</a></div><div class="ttdeci">void ast_msg_var_iterator_destroy(struct ast_msg_var_iterator *iter)</div><div class="ttdoc">Destroy a message variable iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00706">message.c:706</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_acef4d0aef5bdc92f0b6b188e48f2e90f"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#acef4d0aef5bdc92f0b6b188e48f2e90f">ast_sip_add_header</a></div><div class="ttdeci">int ast_sip_add_header(pjsip_tx_data *tdata, const char *name, const char *value)</div><div class="ttdoc">Add a header to an outbound SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05063">res_pjsip.c:5063</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="message_8h_html_ad11b71dc312056abfcd80727fba68fa6"><div class="ttname"><a href="../../d2/d0d/message_8h.html#ad11b71dc312056abfcd80727fba68fa6">ast_msg_var_unref_current</a></div><div class="ttdeci">void ast_msg_var_unref_current(struct ast_msg_var_iterator *iter)</div><div class="ttdoc">Unref a message var from inside an iterator loop. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00700">message.c:700</a></div></div>
<div class="ttc" id="structmax__forwards_html"><div class="ttname"><a href="../../d3/d68/structmax__forwards.html">max_forwards</a></div><div class="ttdoc">Channel datastore data for max forwards. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/ddd/max__forwards_8c_source.html#l00029">max_forwards.c:29</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structast__msg__var__iterator_html"><div class="ttname"><a href="../../d6/d23/structast__msg__var__iterator.html">ast_msg_var_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00639">message.c:639</a></div></div>
<div class="ttc" id="res__pjsip__messaging_8c_html_ae2c279d5e676c37196c20e8b79bda541"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#ae2c279d5e676c37196c20e8b79bda541">is_msg_var_blocked</a></div><div class="ttdeci">static int is_msg_var_blocked(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l00857">res_pjsip_messaging.c:857</a></div></div>
<div class="ttc" id="message_8h_html_a2903b6879e5710a6226825c1a0b84bd7"><div class="ttname"><a href="../../d2/d0d/message_8h.html#a2903b6879e5710a6226825c1a0b84bd7">ast_msg_var_iterator_init</a></div><div class="ttdeci">struct ast_msg_var_iterator * ast_msg_var_iterator_init(const struct ast_msg *msg)</div><div class="ttdoc">Create a new message variable iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00644">message.c:644</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Messaging Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_APP_DEPEND, .requires = &quot;res_pjsip,res_pjsip_session&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01611">1611</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01611">1611</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<a id="aca8e337fca6e1a8575e04a4c8ecef07c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca8e337fca6e1a8575e04a4c8ecef07c">&#9670;&nbsp;</a></span>message_serializer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* message_serializer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00140">140</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<a id="a8a2bd7e56fa8b771cccce9605eba7d33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a2bd7e56fa8b771cccce9605eba7d33">&#9670;&nbsp;</a></span>messaging_module</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_module messaging_module</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01559">1559</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01566">load_module()</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01596">unload_module()</a>.</p>

</div>
</div>
<a id="a0c35f42c26b1c5830f78536249397c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c35f42c26b1c5830f78536249397c81">&#9670;&nbsp;</a></span>messaging_supplement</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> messaging_supplement</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .method = <span class="stringliteral">&quot;MESSAGE&quot;</span>,</div><div class="line">   .incoming_request = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#a647b894e38afad7cb37c5c2be2017857">incoming_in_dialog_request</a></div><div class="line">}</div><div class="ttc" id="res__pjsip__messaging_8c_html_a647b894e38afad7cb37c5c2be2017857"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#a647b894e38afad7cb37c5c2be2017857">incoming_in_dialog_request</a></div><div class="ttdeci">static int incoming_in_dialog_request(struct ast_sip_session *session, struct pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01457">res_pjsip_messaging.c:1457</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01554">1554</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

</div>
</div>
<a id="adee47ce28cd17bbdc773df287fc062c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adee47ce28cd17bbdc773df287fc062c5">&#9670;&nbsp;</a></span>msg_tech</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../df/dfc/structast__msg__tech.html">ast_msg_tech</a> msg_tech</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .name = <span class="stringliteral">&quot;pjsip&quot;</span>,</div><div class="line">   .msg_send = <a class="code" href="../../da/d83/res__pjsip__messaging_8c.html#afc11a48a4a3b69575eb23eff5563c93d">sip_msg_send</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__messaging_8c_html_afc11a48a4a3b69575eb23eff5563c93d"><div class="ttname"><a href="../../da/d83/res__pjsip__messaging_8c.html#afc11a48a4a3b69575eb23eff5563c93d">sip_msg_send</a></div><div class="ttdeci">static int sip_msg_send(const struct ast_msg *msg, const char *destination, const char *from)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d83/res__pjsip__messaging_8c_source.html#l01352">res_pjsip_messaging.c:1352</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01373">1373</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01306">action_messagesend()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01369">ast_msg_send()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l01226">msg_send_exec()</a>.</p>

</div>
</div>
<a id="ae429ac4d5de1dd3e9494a7fdc9e6b509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae429ac4d5de1dd3e9494a7fdc9e6b509">&#9670;&nbsp;</a></span>pjsip_message_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const pjsip_method pjsip_message_method = {PJSIP_OTHER_METHOD, {&quot;MESSAGE&quot;, 7} }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l00134">134</a> of file <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html">res_pjsip_messaging.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01566">load_module()</a>, and <a class="el" href="../../da/d83/res__pjsip__messaging_8c_source.html#l01407">module_on_rx_request()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:31 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
