<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: stasis_state.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stasis_state.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d96/stasis__state_8h_source.html">asterisk/stasis_state.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stasis_state.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d83/stasis__state_8c__incl.png" border="0" usemap="#stasis__state_8c" alt=""/></div>
<map name="stasis__state_8c" id="stasis__state_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="935,155,1019,181"/>
<area shape="rect" id="node22" href="../../d1/d96/stasis__state_8h.html" title="Stasis State API. " alt="" coords="1383,80,1548,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="335,229,489,256"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="847,229,985,256"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="1009,229,1143,256"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="5,304,152,331"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1325,304,1467,331"/>
<area shape="rect" id="node23" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1465,155,1591,181"/>
<area shape="rect" id="node24" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="1609,229,1724,256"/>
<area shape="rect" id="node25" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="1749,229,1894,256"/>
<area shape="rect" id="node26" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1471,229,1585,256"/>
<area shape="rect" id="node27" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="1322,229,1446,256"/>
</map>
</div>
</div>
<p><a href="../../dc/d1d/stasis__state_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4164890c59a04f9e6aa478793a22cdb8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a4164890c59a04f9e6aa478793a22cdb8">STATE_BUCKETS</a>&#160;&#160;&#160;57</td></tr>
<tr class="separator:a4164890c59a04f9e6aa478793a22cdb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d69e7d941254c112769ae1d6c2ae5f5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a>(mgr,  top,  <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)&#160;&#160;&#160;<a class="el" href="../../dc/d1d/stasis__state_8c.html#a31c607c76c11df6be57c1d0420e6652c">__state_find_or_add</a>(mgr, top, <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, __FILE__, __LINE__, __PRETTY_FUNCTION__)</td></tr>
<tr class="separator:a9d69e7d941254c112769ae1d6c2ae5f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a31c607c76c11df6be57c1d0420e6652c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a31c607c76c11df6be57c1d0420e6652c">__state_find_or_add</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *state_topic, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, const char *file, int line, const char *func)</td></tr>
<tr class="separator:a31c607c76c11df6be57c1d0420e6652c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3383d2620a9e0d5e725e387cee0df931"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a3383d2620a9e0d5e725e387cee0df931">AO2_STRING_FIELD_CMP_FN</a> (<a class="el" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a>, <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="separator:a3383d2620a9e0d5e725e387cee0df931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc79fbd2228483c4d1fc4223ca9817f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#adc79fbd2228483c4d1fc4223ca9817f1">AO2_STRING_FIELD_HASH_FN</a> (<a class="el" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a>, <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="separator:adc79fbd2228483c4d1fc4223ca9817f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd1d8f6f30acc71e2af57c3f0f2fbdac"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#acd1d8f6f30acc71e2af57c3f0f2fbdac">handle_stasis_state</a> (struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="el" href="../../d4/d88/structstate.html">state</a>, <a class="el" href="../../d1/d96/stasis__state_8h.html#a38a9925f7539e3a27a8dcab3c6946bde">on_stasis_state</a> <a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, void *data)</td></tr>
<tr class="separator:acd1d8f6f30acc71e2af57c3f0f2fbdac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b695bcf759083a5037c9a5ceaf952db"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a6b695bcf759083a5037c9a5ceaf952db">handle_stasis_state_proxy</a> (void *obj, void *arg, void *data, int flags)</td></tr>
<tr class="separator:a6b695bcf759083a5037c9a5ceaf952db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a375c8275bb862ff8c0fe9520060f5bc8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a375c8275bb862ff8c0fe9520060f5bc8">handle_stasis_state_subscribed</a> (void *obj, void *arg, void *data, int flags)</td></tr>
<tr class="separator:a375c8275bb862ff8c0fe9520060f5bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8928fc6d762aa8d6bfbc48a12b04e6a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#aa8928fc6d762aa8d6bfbc48a12b04e6a">publisher_dtor</a> (void *obj)</td></tr>
<tr class="separator:aa8928fc6d762aa8d6bfbc48a12b04e6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7228670846162446fdf5bd2500c1f64d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a7228670846162446fdf5bd2500c1f64d">stasis_state_add_observer</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, struct <a class="el" href="../../d5/d92/structstasis__state__observer.html">stasis_state_observer</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#ac7df966a74e4dedc4011a0b8e50f4a42">observer</a>)</td></tr>
<tr class="memdesc:a7228670846162446fdf5bd2500c1f64d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an observer to receive managed state related events.  <a href="#a7228670846162446fdf5bd2500c1f64d">More...</a><br /></td></tr>
<tr class="separator:a7228670846162446fdf5bd2500c1f64d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef7869676ec68c22cc1ac42cadaa36c9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#aef7869676ec68c22cc1ac42cadaa36c9">stasis_state_add_publisher</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:aef7869676ec68c22cc1ac42cadaa36c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a publisher to the managed state for the given id.  <a href="#aef7869676ec68c22cc1ac42cadaa36c9">More...</a><br /></td></tr>
<tr class="separator:aef7869676ec68c22cc1ac42cadaa36c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0826641b8fbe326ff48602f0406be308"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a0826641b8fbe326ff48602f0406be308">stasis_state_add_subscriber</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:a0826641b8fbe326ff48602f0406be308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a subscriber to the managed stasis state for the given id.  <a href="#a0826641b8fbe326ff48602f0406be308">More...</a><br /></td></tr>
<tr class="separator:a0826641b8fbe326ff48602f0406be308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3ba55cdf54059b5767c05fe34da9b32"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#af3ba55cdf54059b5767c05fe34da9b32">stasis_state_all_topic</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager)</td></tr>
<tr class="memdesc:af3ba55cdf54059b5767c05fe34da9b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the manager's topic (the topic that all state topics get forwarded to)  <a href="#af3ba55cdf54059b5767c05fe34da9b32">More...</a><br /></td></tr>
<tr class="separator:af3ba55cdf54059b5767c05fe34da9b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a248667e66debb56942035089d06a5421"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a248667e66debb56942035089d06a5421">stasis_state_callback_all</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, <a class="el" href="../../d1/d96/stasis__state_8h.html#a38a9925f7539e3a27a8dcab3c6946bde">on_stasis_state</a> <a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, void *data)</td></tr>
<tr class="memdesc:a248667e66debb56942035089d06a5421"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each managed state call the given handler.  <a href="#a248667e66debb56942035089d06a5421">More...</a><br /></td></tr>
<tr class="separator:a248667e66debb56942035089d06a5421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ac58c28d8742426b40f0c5c7404e76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#ac0ac58c28d8742426b40f0c5c7404e76">stasis_state_callback_subscribed</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, <a class="el" href="../../d1/d96/stasis__state_8h.html#a38a9925f7539e3a27a8dcab3c6946bde">on_stasis_state</a> <a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, void *data)</td></tr>
<tr class="memdesc:ac0ac58c28d8742426b40f0c5c7404e76"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each managed, and explicitly subscribed state call the given handler.  <a href="#ac0ac58c28d8742426b40f0c5c7404e76">More...</a><br /></td></tr>
<tr class="separator:ac0ac58c28d8742426b40f0c5c7404e76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e620ce0dace97fda1d99361dda73c9b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a1e620ce0dace97fda1d99361dda73c9b">stasis_state_manager_create</a> (const char *topic_name)</td></tr>
<tr class="memdesc:a1e620ce0dace97fda1d99361dda73c9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a stasis state manager.  <a href="#a1e620ce0dace97fda1d99361dda73c9b">More...</a><br /></td></tr>
<tr class="separator:a1e620ce0dace97fda1d99361dda73c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae22f3fe7bbecf70b943d4b72ec9ffcea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#ae22f3fe7bbecf70b943d4b72ec9ffcea">stasis_state_publish</a> (struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *pub, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:ae22f3fe7bbecf70b943d4b72ec9ffcea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish to a managed state (topic) using a publisher.  <a href="#ae22f3fe7bbecf70b943d4b72ec9ffcea">More...</a><br /></td></tr>
<tr class="separator:ae22f3fe7bbecf70b943d4b72ec9ffcea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dbc6c2a3b37e5ab135e410681a23142"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a2dbc6c2a3b37e5ab135e410681a23142">stasis_state_publish_by_id</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:a2dbc6c2a3b37e5ab135e410681a23142"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish to a managed named by id topic, and add an implicit subscriber.  <a href="#a2dbc6c2a3b37e5ab135e410681a23142">More...</a><br /></td></tr>
<tr class="separator:a2dbc6c2a3b37e5ab135e410681a23142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb3e1eb79879c114539587a240b455ab"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#acb3e1eb79879c114539587a240b455ab">stasis_state_publisher_id</a> (const struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *pub)</td></tr>
<tr class="memdesc:acb3e1eb79879c114539587a240b455ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the publisher's underlying state's unique id.  <a href="#acb3e1eb79879c114539587a240b455ab">More...</a><br /></td></tr>
<tr class="separator:acb3e1eb79879c114539587a240b455ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323883cc18a212f8eb7ffd4200b0218c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a323883cc18a212f8eb7ffd4200b0218c">stasis_state_publisher_topic</a> (struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *pub)</td></tr>
<tr class="memdesc:a323883cc18a212f8eb7ffd4200b0218c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the publisher's topic.  <a href="#a323883cc18a212f8eb7ffd4200b0218c">More...</a><br /></td></tr>
<tr class="separator:a323883cc18a212f8eb7ffd4200b0218c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48ab5b2a6061ca20c816a9ccdf85aeeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a48ab5b2a6061ca20c816a9ccdf85aeeb">stasis_state_remove_observer</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, struct <a class="el" href="../../d5/d92/structstasis__state__observer.html">stasis_state_observer</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#ac7df966a74e4dedc4011a0b8e50f4a42">observer</a>)</td></tr>
<tr class="memdesc:a48ab5b2a6061ca20c816a9ccdf85aeeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an observer (will no longer receive managed state related events).  <a href="#a48ab5b2a6061ca20c816a9ccdf85aeeb">More...</a><br /></td></tr>
<tr class="separator:a48ab5b2a6061ca20c816a9ccdf85aeeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd6a2d9bb8e46b049966355cda567a37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#acd6a2d9bb8e46b049966355cda567a37">stasis_state_remove_publish_by_id</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:acd6a2d9bb8e46b049966355cda567a37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish to a managed named by id topic, and remove an implicit publisher.  <a href="#acd6a2d9bb8e46b049966355cda567a37">More...</a><br /></td></tr>
<tr class="separator:acd6a2d9bb8e46b049966355cda567a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af61eaf43040b329d68b476e647f6a7d6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#af61eaf43040b329d68b476e647f6a7d6">stasis_state_subscribe_pool</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data)</td></tr>
<tr class="memdesc:af61eaf43040b329d68b476e647f6a7d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a subscriber, and subscribe to its underlying stasis topic.  <a href="#af61eaf43040b329d68b476e647f6a7d6">More...</a><br /></td></tr>
<tr class="separator:af61eaf43040b329d68b476e647f6a7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3effc7b9731f157205bb2b65c3a2f1b8"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a3effc7b9731f157205bb2b65c3a2f1b8">stasis_state_subscriber_data</a> (struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a3effc7b9731f157205bb2b65c3a2f1b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the last known state stasis message payload for the subscriber.  <a href="#a3effc7b9731f157205bb2b65c3a2f1b8">More...</a><br /></td></tr>
<tr class="separator:a3effc7b9731f157205bb2b65c3a2f1b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eeb2acddec8b7683035b25e8a4cf886"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a5eeb2acddec8b7683035b25e8a4cf886">stasis_state_subscriber_id</a> (const struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a5eeb2acddec8b7683035b25e8a4cf886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the underlying subscribed to state's unique id.  <a href="#a5eeb2acddec8b7683035b25e8a4cf886">More...</a><br /></td></tr>
<tr class="separator:a5eeb2acddec8b7683035b25e8a4cf886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf6aa9b3aba2f94825472d43f81ad284"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#aaf6aa9b3aba2f94825472d43f81ad284">stasis_state_subscriber_subscription</a> (struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:aaf6aa9b3aba2f94825472d43f81ad284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the stasis topic subscription if available.  <a href="#aaf6aa9b3aba2f94825472d43f81ad284">More...</a><br /></td></tr>
<tr class="separator:aaf6aa9b3aba2f94825472d43f81ad284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a904a0f91e443cb185f82e39512381974"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a904a0f91e443cb185f82e39512381974">stasis_state_subscriber_topic</a> (struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a904a0f91e443cb185f82e39512381974"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the subscriber's topic.  <a href="#a904a0f91e443cb185f82e39512381974">More...</a><br /></td></tr>
<tr class="separator:a904a0f91e443cb185f82e39512381974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4096e710d5f849bf345dde006d269548"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a4096e710d5f849bf345dde006d269548">stasis_state_topic</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:a4096e710d5f849bf345dde006d269548"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a managed topic creating one if not currently managed.  <a href="#a4096e710d5f849bf345dde006d269548">More...</a><br /></td></tr>
<tr class="separator:a4096e710d5f849bf345dde006d269548"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a479b995c5d232c9296809bff7216e37a"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a479b995c5d232c9296809bff7216e37a">stasis_state_unsubscribe</a> (struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a479b995c5d232c9296809bff7216e37a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribe from the stasis topic and stasis state.  <a href="#a479b995c5d232c9296809bff7216e37a">More...</a><br /></td></tr>
<tr class="separator:a479b995c5d232c9296809bff7216e37a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858f0158644f3bb53e1298c98a93f300"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a858f0158644f3bb53e1298c98a93f300">stasis_state_unsubscribe_and_join</a> (struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a858f0158644f3bb53e1298c98a93f300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribe from the stasis topic, block until the final message is received, and then unsubscribe from stasis state.  <a href="#a858f0158644f3bb53e1298c98a93f300">More...</a><br /></td></tr>
<tr class="separator:a858f0158644f3bb53e1298c98a93f300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c57132104024fa2e61e7c7c293c83e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a21c57132104024fa2e61e7c7c293c83e">state_alloc</a> (struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager, struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *state_topic, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, const char *file, int line, const char *func)</td></tr>
<tr class="separator:a21c57132104024fa2e61e7c7c293c83e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883b15d906b1dfa79ace4534deae8543"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a883b15d906b1dfa79ace4534deae8543">state_dtor</a> (void *obj)</td></tr>
<tr class="separator:a883b15d906b1dfa79ace4534deae8543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76bf47e293ac2a764061da3ea1a7d671"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a76bf47e293ac2a764061da3ea1a7d671">state_find_and_remove_eid</a> (struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="el" href="../../d4/d88/structstate.html">state</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="separator:a76bf47e293ac2a764061da3ea1a7d671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78067dcb8032e3a734d8ab2528ad3e99"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a78067dcb8032e3a734d8ab2528ad3e99">state_find_or_add_eid</a> (struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="el" href="../../d4/d88/structstate.html">state</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="separator:a78067dcb8032e3a734d8ab2528ad3e99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affbf31fec99eae22d9bab4d664b97c75"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#affbf31fec99eae22d9bab4d664b97c75">state_id_by_topic</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *<a class="el" href="../../df/d72/group__Group__AMI.html#gadeff73697d2789905f4c3a21671ef6d3">manager_topic</a>, const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *state_topic)</td></tr>
<tr class="separator:affbf31fec99eae22d9bab4d664b97c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce96ad06685e89abf4561ed930029a7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a0ce96ad06685e89abf4561ed930029a7">state_manager_dtor</a> (void *obj)</td></tr>
<tr class="separator:a0ce96ad06685e89abf4561ed930029a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a148f4b94cf1fd1d4e828cbccaea3f585"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#a148f4b94cf1fd1d4e828cbccaea3f585">state_proxy_dtor</a> (void *obj)</td></tr>
<tr class="separator:a148f4b94cf1fd1d4e828cbccaea3f585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad131a2b602c52fcb48dc43eeac8763c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#aad131a2b602c52fcb48dc43eeac8763c">state_proxy_sub_cb</a> (void *obj, void *data)</td></tr>
<tr class="separator:aad131a2b602c52fcb48dc43eeac8763c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c06124c1a71446a10d133c905b0f03"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d1d/stasis__state_8c.html#aa4c06124c1a71446a10d133c905b0f03">subscriber_dtor</a> (void *obj)</td></tr>
<tr class="separator:aa4c06124c1a71446a10d133c905b0f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4164890c59a04f9e6aa478793a22cdb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4164890c59a04f9e6aa478793a22cdb8">&#9670;&nbsp;</a></span>STATE_BUCKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_BUCKETS&#160;&#160;&#160;57</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The number of buckets to use for managed states </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00077">77</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00324">stasis_state_manager_create()</a>.</p>

</div>
</div>
<a id="a9d69e7d941254c112769ae1d6c2ae5f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d69e7d941254c112769ae1d6c2ae5f5">&#9670;&nbsp;</a></span>state_find_or_add</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define state_find_or_add</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">mgr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">top, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../dc/d1d/stasis__state_8c.html#a31c607c76c11df6be57c1d0420e6652c">__state_find_or_add</a>(mgr, top, <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, __FILE__, __LINE__, __PRETTY_FUNCTION__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00270">270</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00531">stasis_state_add_publisher()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00412">stasis_state_add_subscriber()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00638">stasis_state_publish_by_id()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00369">stasis_state_topic()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a31c607c76c11df6be57c1d0420e6652c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c607c76c11df6be57c1d0420e6652c">&#9670;&nbsp;</a></span>__state_find_or_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a>* __state_find_or_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>state_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00271">271</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state_manager::all_topic</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01768">ao2_weakproxy_find</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l00959">state</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00104">state_id_by_topic()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>.</p>
<div class="fragment"><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;{</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordtype">id</span> = <a class="code" href="../../dc/d1d/stasis__state_8c.html#affbf31fec99eae22d9bab4d664b97c75">state_id_by_topic</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>, state_topic);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   state = <a class="code" href="../../d5/da5/astobj2_8h.html#aa78a383f537bc7a35efb8eaabcdc44e9">ao2_weakproxy_find</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>, <span class="keywordtype">id</span>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      state = <a class="code" href="../../dc/d1d/stasis__state_8c.html#a21c57132104024fa2e61e7c7c293c83e">state_alloc</a>(manager, state_topic, <span class="keywordtype">id</span>, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, line, func);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div><div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="stasis__state_8c_html_affbf31fec99eae22d9bab4d664b97c75"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#affbf31fec99eae22d9bab4d664b97c75">state_id_by_topic</a></div><div class="ttdeci">static const char * state_id_by_topic(struct stasis_topic *manager_topic, const struct stasis_topic *state_topic)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00104">stasis_state.c:104</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a4b36465264544dbb0063d66a9010d866"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">stasis_state_manager::all_topic</a></div><div class="ttdeci">struct stasis_topic * all_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state.c:83</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a21c57132104024fa2e61e7c7c293c83e"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a21c57132104024fa2e61e7c7c293c83e">state_alloc</a></div><div class="ttdeci">static struct stasis_state * state_alloc(struct stasis_state_manager *manager, struct stasis_topic *state_topic, const char *id, const char *file, int line, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00167">stasis_state.c:167</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa78a383f537bc7a35efb8eaabcdc44e9"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa78a383f537bc7a35efb8eaabcdc44e9">ao2_weakproxy_find</a></div><div class="ttdeci">#define ao2_weakproxy_find(c, arg, flags, tag)</div><div class="ttdoc">Perform an ao2_find on a container with ao2_weakproxy objects, returning the real object...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01768">astobj2.h:1768</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3383d2620a9e0d5e725e387cee0df931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3383d2620a9e0d5e725e387cee0df931">&#9670;&nbsp;</a></span>AO2_STRING_FIELD_CMP_FN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AO2_STRING_FIELD_CMP_FN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adc79fbd2228483c4d1fc4223ca9817f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc79fbd2228483c4d1fc4223ca9817f1">&#9670;&nbsp;</a></span>AO2_STRING_FIELD_HASH_FN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AO2_STRING_FIELD_HASH_FN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acd1d8f6f30acc71e2af57c3f0f2fbdac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd1d8f6f30acc71e2af57c3f0f2fbdac">&#9670;&nbsp;</a></span>handle_stasis_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_stasis_state </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d96/stasis__state_8h.html#a38a9925f7539e3a27a8dcab3c6946bde">on_stasis_state</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00708">708</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state::msg</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00726">handle_stasis_state_proxy()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00749">handle_stasis_state_subscribed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;{</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">    * State needs to be locked here while we retrieve and bump the reference on its message</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">    * object. Doing so guarantees the message object will live throughout its handling.</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(state);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   msg = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">msg</a>);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(state);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   res = <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>(state-&gt;id, msg, <a class="code" href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">data</a>);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(msg);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;}</div><div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="structstasis__state_html_aa24737e537b6b1f647b3f22392ac8abe"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">stasis_state::msg</a></div><div class="ttdeci">struct stasis_message * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state.c:63</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structstasis__message_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">stasis_message::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00129">stasis_message.c:129</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b695bcf759083a5037c9a5ceaf952db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b695bcf759083a5037c9a5ceaf952db">&#9670;&nbsp;</a></span>handle_stasis_state_proxy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_stasis_state_proxy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00726">726</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00625">ao2_weakproxy_get_object</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00708">handle_stasis_state()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00740">stasis_state_callback_all()</a>.</p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;{</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#abece8912c184829337118e2bdfc86307">ao2_weakproxy_get_object</a>(obj, 0);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordflow">if</span> (state) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      res = <a class="code" href="../../dc/d1d/stasis__state_8c.html#acd1d8f6f30acc71e2af57c3f0f2fbdac">handle_stasis_state</a>(state, arg, data);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;}</div><div class="ttc" id="stasis__state_8c_html_acd1d8f6f30acc71e2af57c3f0f2fbdac"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#acd1d8f6f30acc71e2af57c3f0f2fbdac">handle_stasis_state</a></div><div class="ttdeci">static int handle_stasis_state(struct stasis_state *state, on_stasis_state handler, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00708">stasis_state.c:708</a></div></div>
<div class="ttc" id="astobj2_8h_html_abece8912c184829337118e2bdfc86307"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abece8912c184829337118e2bdfc86307">ao2_weakproxy_get_object</a></div><div class="ttdeci">#define ao2_weakproxy_get_object(weakproxy, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00625">astobj2.h:625</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a375c8275bb862ff8c0fe9520060f5bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a375c8275bb862ff8c0fe9520060f5bc8">&#9670;&nbsp;</a></span>handle_stasis_state_subscribed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_stasis_state_subscribed </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00749">749</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00625">ao2_weakproxy_get_object</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00708">handle_stasis_state()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00052">stasis_state::num_subscribers</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00763">stasis_state_callback_subscribed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;{</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#abece8912c184829337118e2bdfc86307">ao2_weakproxy_get_object</a>(obj, 0);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="keywordflow">if</span> (state &amp;&amp; state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aeffbfbab5dabd4de4beb0c6190b01759">num_subscribers</a>) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      res = <a class="code" href="../../dc/d1d/stasis__state_8c.html#acd1d8f6f30acc71e2af57c3f0f2fbdac">handle_stasis_state</a>(state, arg, data);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;}</div><div class="ttc" id="stasis__state_8c_html_acd1d8f6f30acc71e2af57c3f0f2fbdac"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#acd1d8f6f30acc71e2af57c3f0f2fbdac">handle_stasis_state</a></div><div class="ttdeci">static int handle_stasis_state(struct stasis_state *state, on_stasis_state handler, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00708">stasis_state.c:708</a></div></div>
<div class="ttc" id="astobj2_8h_html_abece8912c184829337118e2bdfc86307"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abece8912c184829337118e2bdfc86307">ao2_weakproxy_get_object</a></div><div class="ttdeci">#define ao2_weakproxy_get_object(weakproxy, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00625">astobj2.h:625</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
<div class="ttc" id="structstasis__state_html_aeffbfbab5dabd4de4beb0c6190b01759"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aeffbfbab5dabd4de4beb0c6190b01759">stasis_state::num_subscribers</a></div><div class="ttdeci">unsigned int num_subscribers</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00052">stasis_state.c:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8928fc6d762aa8d6bfbc48a12b04e6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8928fc6d762aa8d6bfbc48a12b04e6a">&#9670;&nbsp;</a></span>publisher_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void publisher_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00524">524</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state_publisher::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00531">stasis_state_add_publisher()</a>.</p>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *pub = obj;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>, -1);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div><div class="ttc" id="structstasis__state__publisher_html"><div class="ttname"><a href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00519">stasis_state.c:519</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__state__publisher_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_publisher::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state.c:521</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7228670846162446fdf5bd2500c1f64d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7228670846162446fdf5bd2500c1f64d">&#9670;&nbsp;</a></span>stasis_state_add_observer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_state_add_observer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d5/d92/structstasis__state__observer.html">stasis_state_observer</a> *&#160;</td>
          <td class="paramname"><em>observer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an observer to receive managed state related events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The state manager </td></tr>
    <tr><td class="paramname">observer</td><td>The observer handling events</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if successfully registered </td></tr>
    <tr><td class="paramname">-1</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00688">688</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00900">AST_VECTOR_RW_UNLOCK</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00890">AST_VECTOR_RW_WRLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00296">ast_mwi_add_observer()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00131">subscriptions_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;{</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a468985d2b5ca7410d91108bdd0484348">AST_VECTOR_RW_WRLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   res = <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;manager-&gt;observers, observer);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;}</div><div class="ttc" id="vector_8h_html_a5ad3dd1d3da5d4ebf6a44d32e42c4c91"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_UNLOCK(vec)</div><div class="ttdoc">Unlock vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00900">vector.h:900</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="vector_8h_html_a468985d2b5ca7410d91108bdd0484348"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a468985d2b5ca7410d91108bdd0484348">AST_VECTOR_RW_WRLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_WRLOCK(vec)</div><div class="ttdoc">Obtain write lock on vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00890">vector.h:890</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef7869676ec68c22cc1ac42cadaa36c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef7869676ec68c22cc1ac42cadaa36c9">&#9670;&nbsp;</a></span>stasis_state_add_publisher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a>* stasis_state_add_publisher </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a publisher to the managed state for the given id. </p>
<p>Adds a publisher to a managed state based on id. If managed state does not already exists for the given id then new managed state is created. Otherwise the existing state is used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The manager object </td></tr>
    <tr><td class="paramname">id</td><td>The unique id of a managed state</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>stasis state publisher </td></tr>
    <tr><td class="paramname">NULL</td><td>if an error occurred</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00531">531</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state_manager::all_topic</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00524">publisher_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state_publisher::state</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00270">state_find_or_add</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00290">ast_mwi_add_publisher()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00205">publishers_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;{</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *pub = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keyword">sizeof</span>(*pub), <a class="code" href="../../dc/d1d/stasis__state_8c.html#aa8928fc6d762aa8d6bfbc48a12b04e6a">publisher_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="keywordflow">if</span> (!pub) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to create publisher to %s/%s\n&quot;</span>,</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>), <span class="keywordtype">id</span>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a> = <a class="code" href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a>(manager, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="keywordflow">if</span> (!pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(pub, -1);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordflow">return</span> pub;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="ttc" id="stasis__state_8c_html_a9d69e7d941254c112769ae1d6c2ae5f5"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a></div><div class="ttdeci">#define state_find_or_add(mgr, top, id)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00270">stasis_state.c:270</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structstasis__state__publisher_html"><div class="ttname"><a href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00519">stasis_state.c:519</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a4b36465264544dbb0063d66a9010d866"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">stasis_state_manager::all_topic</a></div><div class="ttdeci">struct stasis_topic * all_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state.c:83</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis__state_8c_html_aa8928fc6d762aa8d6bfbc48a12b04e6a"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#aa8928fc6d762aa8d6bfbc48a12b04e6a">publisher_dtor</a></div><div class="ttdeci">static void publisher_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00524">stasis_state.c:524</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="structstasis__state__publisher_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_publisher::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state.c:521</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0826641b8fbe326ff48602f0406be308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0826641b8fbe326ff48602f0406be308">&#9670;&nbsp;</a></span>stasis_state_add_subscriber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a>* stasis_state_add_subscriber </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a subscriber to the managed stasis state for the given id. </p>
<p>Adds a subscriber to a managed state based on id. If managed state does not already exists for the given id then new managed state is created. Otherwise the existing state is subscribed to.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The manager object </td></tr>
    <tr><td class="paramname">id</td><td>The unique id of a managed state</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>stasis state subscriber </td></tr>
    <tr><td class="paramname">NULL</td><td>if an error occurred</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00412">412</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state_manager::all_topic</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00880">AST_VECTOR_RW_RDLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00900">AST_VECTOR_RW_UNLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00052">stasis_state::num_subscribers</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state_subscriber::state</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00270">state_find_or_add</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00391">subscriber_dtor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00224">ast_mwi_add_subscriber()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00446">stasis_state_subscribe_pool()</a>.</p>
<div class="fragment"><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="keywordtype">size_t</span> i;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keyword">sizeof</span>(*sub), <a class="code" href="../../dc/d1d/stasis__state_8c.html#aa4c06124c1a71446a10d133c905b0f03">subscriber_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to create subscriber to %s/%s\n&quot;</span>,</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;         <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>), <span class="keywordtype">id</span>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a> = <a class="code" href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a>(manager, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>) {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub, -1);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   ++sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aeffbfbab5dabd4de4beb0c6190b01759">num_subscribers</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;manager-&gt;observers); ++i) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;manager-&gt;observers, i)-&gt;on_subscribe) {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;manager-&gt;observers, i)-&gt;on_subscribe(<span class="keywordtype">id</span>, sub);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div><div class="ttc" id="structstasis__state__subscriber_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_subscriber::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state.c:386</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a9d69e7d941254c112769ae1d6c2ae5f5"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a></div><div class="ttdeci">#define state_find_or_add(mgr, top, id)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00270">stasis_state.c:270</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="vector_8h_html_a5ad3dd1d3da5d4ebf6a44d32e42c4c91"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_UNLOCK(vec)</div><div class="ttdoc">Unlock vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00900">vector.h:900</a></div></div>
<div class="ttc" id="vector_8h_html_ad414eae87431bad2a7fc4dffa9d06350"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_RDLOCK(vec)</div><div class="ttdoc">Obtain read lock on vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00880">vector.h:880</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a4b36465264544dbb0063d66a9010d866"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">stasis_state_manager::all_topic</a></div><div class="ttdeci">struct stasis_topic * all_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state.c:83</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stasis__state_8c_html_aa4c06124c1a71446a10d133c905b0f03"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#aa4c06124c1a71446a10d133c905b0f03">subscriber_dtor</a></div><div class="ttdeci">static void subscriber_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00391">stasis_state.c:391</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structstasis__state__subscriber_html"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00384">stasis_state.c:384</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="structstasis__state_html_aeffbfbab5dabd4de4beb0c6190b01759"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aeffbfbab5dabd4de4beb0c6190b01759">stasis_state::num_subscribers</a></div><div class="ttdeci">unsigned int num_subscribers</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00052">stasis_state.c:52</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3ba55cdf54059b5767c05fe34da9b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3ba55cdf54059b5767c05fe34da9b32">&#9670;&nbsp;</a></span>stasis_state_all_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_state_all_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the manager's topic (the topic that all state topics get forwarded to) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The manager object</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>manager's topic.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00364">364</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state_manager::all_topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00085">ast_mwi_topic_all()</a>.</p>
<div class="fragment"><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordflow">return</span> manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div><div class="ttc" id="structstasis__state__manager_html_a4b36465264544dbb0063d66a9010d866"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">stasis_state_manager::all_topic</a></div><div class="ttdeci">struct stasis_topic * all_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state.c:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a248667e66debb56942035089d06a5421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a248667e66debb56942035089d06a5421">&#9670;&nbsp;</a></span>stasis_state_callback_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_state_callback_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d96/stasis__state_8h.html#a38a9925f7539e3a27a8dcab3c6946bde">on_stasis_state</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each managed state call the given handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The state manager </td></tr>
    <tr><td class="paramname">handler</td><td>The handler to call for each managed state </td></tr>
    <tr><td class="paramname">data</td><td>User to data to pass on to the handler</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00740">740</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01743">ao2_callback_data</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00726">handle_stasis_state_proxy()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01053">OBJ_MULTIPLE</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00333">ast_mwi_state_callback_all()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00328">publish()</a>.</p>
<div class="fragment"><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;{</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <a class="code" href="../../dc/d1d/stasis__state_8c.html#a6b695bcf759083a5037c9a5ceaf952db">handle_stasis_state_proxy</a>, <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, data);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_a63fd831fe48aed32d3ef992ad8e45293"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a></div><div class="ttdeci">#define ao2_callback_data(container, flags, cb_fn, arg, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01743">astobj2.h:1743</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a6b695bcf759083a5037c9a5ceaf952db"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a6b695bcf759083a5037c9a5ceaf952db">handle_stasis_state_proxy</a></div><div class="ttdeci">static int handle_stasis_state_proxy(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00726">stasis_state.c:726</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0ac58c28d8742426b40f0c5c7404e76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0ac58c28d8742426b40f0c5c7404e76">&#9670;&nbsp;</a></span>stasis_state_callback_subscribed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_state_callback_subscribed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d96/stasis__state_8h.html#a38a9925f7539e3a27a8dcab3c6946bde">on_stasis_state</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each managed, and explicitly subscribed state call the given handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The state manager </td></tr>
    <tr><td class="paramname">handler</td><td>The handler to call for each managed state </td></tr>
    <tr><td class="paramname">data</td><td>User to data to pass on to the handler</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00763">763</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01743">ao2_callback_data</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00749">handle_stasis_state_subscribed()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01053">OBJ_MULTIPLE</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00343">ast_mwi_state_callback_subscribed()</a>.</p>
<div class="fragment"><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;{</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>,</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <a class="code" href="../../dc/d1d/stasis__state_8c.html#a375c8275bb862ff8c0fe9520060f5bc8">handle_stasis_state_subscribed</a>, <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, data);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a375c8275bb862ff8c0fe9520060f5bc8"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a375c8275bb862ff8c0fe9520060f5bc8">handle_stasis_state_subscribed</a></div><div class="ttdeci">static int handle_stasis_state_subscribed(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00749">stasis_state.c:749</a></div></div>
<div class="ttc" id="astobj2_8h_html_a63fd831fe48aed32d3ef992ad8e45293"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a></div><div class="ttdeci">#define ao2_callback_data(container, flags, cb_fn, arg, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01743">astobj2.h:1743</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e620ce0dace97fda1d99361dda73c9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e620ce0dace97fda1d99361dda73c9b">&#9670;&nbsp;</a></span>stasis_state_manager_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a>* stasis_state_manager_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a stasis state manager. </p>
<dl class="section note"><dt>Note</dt><dd>The state manager is an ao2_object. When done simply decrement its reference for object cleanup.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic_name</td><td>The name of the topic to create that all state topics get forwarded to</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>stasis state manager </td></tr>
    <tr><td class="paramname">NULL</td><td>if an error occurred</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00324">324</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state_manager::all_topic</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00958">ao2_container_register()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00158">AST_VECTOR_RW_INIT</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state_proxy::manager</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00077">STATE_BUCKETS</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00292">state_manager_dtor()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00356">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d6/db4/mwi_8c_source.html#l00502">mwi_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   manager = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*manager), <a class="code" href="../../dc/d1d/stasis__state_8c.html#a0ce96ad06685e89abf4561ed930029a7">state_manager_dtor</a>,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="keywordflow">if</span> (!manager) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="../../dc/d1d/stasis__state_8c.html#a4164890c59a04f9e6aa478793a22cdb8">STATE_BUCKETS</a>, stasis_state_proxy_hash_fn, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, stasis_state_proxy_cmp_fn);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <span class="keywordflow">if</span> (!manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>) {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(manager, -1);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a> = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(topic_name);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">if</span> (!manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(manager, -1);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#af82e9e2b45ad967329a74e88352d7973">AST_VECTOR_RW_INIT</a>(&amp;manager-&gt;observers, 2) != 0) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(manager, -1);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#ifdef AO2_DEBUG</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordtype">char</span> *container_name =</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(strlen(<a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>)) + strlen(<span class="stringliteral">&quot;-manager&quot;</span>) + 1);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      sprintf(container_name, <span class="stringliteral">&quot;%s-manager&quot;</span>, <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>));</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a>(container_name, manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>, state_prnt_obj);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordflow">return</span> manager;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div><div class="ttc" id="vector_8h_html_af82e9e2b45ad967329a74e88352d7973"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af82e9e2b45ad967329a74e88352d7973">AST_VECTOR_RW_INIT</a></div><div class="ttdeci">#define AST_VECTOR_RW_INIT(vec, size)</div><div class="ttdoc">Initialize a vector with a read/write lock. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00158">vector.h:158</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a4b36465264544dbb0063d66a9010d866"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">stasis_state_manager::all_topic</a></div><div class="ttdeci">struct stasis_topic * all_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_abdb952d2373503555d96f02f130c5770"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a></div><div class="ttdeci">int ao2_container_register(const char *name, struct ao2_container *self, ao2_prnt_obj_fn *prnt_obj)</div><div class="ttdoc">Register a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00958">astobj2_container.c:958</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__state__manager_html"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00079">stasis_state.c:79</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a4164890c59a04f9e6aa478793a22cdb8"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a4164890c59a04f9e6aa478793a22cdb8">STATE_BUCKETS</a></div><div class="ttdeci">#define STATE_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00077">stasis_state.c:77</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a0ce96ad06685e89abf4561ed930029a7"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a0ce96ad06685e89abf4561ed930029a7">state_manager_dtor</a></div><div class="ttdeci">static void state_manager_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00292">stasis_state.c:292</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae22f3fe7bbecf70b943d4b72ec9ffcea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae22f3fe7bbecf70b943d4b72ec9ffcea">&#9670;&nbsp;</a></span>stasis_state_publish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_state_publish </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish to a managed state (topic) using a publisher. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pub</td><td>The publisher to use to publish the message </td></tr>
    <tr><td class="paramname">msg</td><td>The message to publish</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00562">562</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00517">ao2_replace</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state::msg</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state_publisher::state</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00353">ast_mwi_publish()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00293">explicit_publish_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;{</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a>(pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">msg</a>, msg);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, msg);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div><div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="structstasis__state_html_aa24737e537b6b1f647b3f22392ac8abe"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">stasis_state::msg</a></div><div class="ttdeci">struct stasis_message * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state.c:63</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa81c8462bd0574f4f9e09e71f2772f44"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a></div><div class="ttdeci">#define ao2_replace(dst, src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00517">astobj2.h:517</a></div></div>
<div class="ttc" id="structstasis__state__publisher_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_publisher::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state.c:521</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2dbc6c2a3b37e5ab135e410681a23142"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dbc6c2a3b37e5ab135e410681a23142">&#9670;&nbsp;</a></span>stasis_state_publish_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_state_publish_by_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish to a managed named by id topic, and add an implicit subscriber. </p>
<dl class="section note"><dt>Note</dt><dd>It is recommended when adding new publisher functionality within a module to create and use an explicit publisher instead of using this method.</dd></dl>
<p>This creates an implicit publisher keyed off the eid. This ability was mainly implemented in order to maintain compatibility with already established code. Allowing the creation of an implicit publisher made is so less changes were required when stasis state module was initially added.</p>
<p>There should only ever be one publisher for a specifically named managed topic within the system. This being the case we can use the eid to implicitly track the publisher. However once publishing is no longer needed for a topic a call to stasis_state_remove_publish_by_id is required in order to remove the implicit publisher. Thus allowing for its eventual destruction. Without the call to remove a memory leak will occur.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The state manager </td></tr>
    <tr><td class="paramname">id</td><td>A state's unique id </td></tr>
    <tr><td class="paramname">eid</td><td>The unique system id </td></tr>
    <tr><td class="paramname">msg</td><td>The message to publish</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00638">638</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00517">ao2_replace</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state::msg</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l00959">state</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00270">state_find_or_add</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00586">state_find_or_add_eid()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00370">ast_mwi_publish_by_mailbox()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00272">implicit_publish_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;{</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   state = <a class="code" href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a>(manager, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(state);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <a class="code" href="../../dc/d1d/stasis__state_8c.html#a78067dcb8032e3a734d8ab2528ad3e99">state_find_or_add_eid</a>(state, eid);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">msg</a>, msg);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(state);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, msg);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;}</div><div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a9d69e7d941254c112769ae1d6c2ae5f5"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a></div><div class="ttdeci">#define state_find_or_add(mgr, top, id)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00270">stasis_state.c:270</a></div></div>
<div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="structstasis__state_html_aa24737e537b6b1f647b3f22392ac8abe"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">stasis_state::msg</a></div><div class="ttdeci">struct stasis_message * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state.c:63</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa81c8462bd0574f4f9e09e71f2772f44"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a></div><div class="ttdeci">#define ao2_replace(dst, src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00517">astobj2.h:517</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a78067dcb8032e3a734d8ab2528ad3e99"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a78067dcb8032e3a734d8ab2528ad3e99">state_find_or_add_eid</a></div><div class="ttdeci">static void state_find_or_add_eid(struct stasis_state *state, const struct ast_eid *eid)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00586">stasis_state.c:586</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb3e1eb79879c114539587a240b455ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb3e1eb79879c114539587a240b455ab">&#9670;&nbsp;</a></span>stasis_state_publisher_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* stasis_state_publisher_id </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *&#160;</td>
          <td class="paramname"><em>pub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the publisher's underlying state's unique id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pub</td><td>A stasis state publisher</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>managed state's id</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00552">552</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state_publisher::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00353">ast_mwi_publish()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00293">explicit_publish_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;{</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordflow">return</span> pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;id;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div><div class="ttc" id="structstasis__state__publisher_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_publisher::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state.c:521</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a323883cc18a212f8eb7ffd4200b0218c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a323883cc18a212f8eb7ffd4200b0218c">&#9670;&nbsp;</a></span>stasis_state_publisher_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_state_publisher_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/dcc/structstasis__state__publisher.html">stasis_state_publisher</a> *&#160;</td>
          <td class="paramname"><em>pub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the publisher's topic. </p>
<dl class="section note"><dt>Note</dt><dd>Returned topic's reference count is NOT incremented. However, the topic is guaranteed to live for the lifetime of the publisher.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pub</td><td>A stasis state publisher</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>publisher's topic</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00557">557</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state_publisher::state</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>
<div class="fragment"><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;{</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="keywordflow">return</span> pub-&gt;<a class="code" href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div><div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="structstasis__state__publisher_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../df/dcc/structstasis__state__publisher.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_publisher::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00521">stasis_state.c:521</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a48ab5b2a6061ca20c816a9ccdf85aeeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48ab5b2a6061ca20c816a9ccdf85aeeb">&#9670;&nbsp;</a></span>stasis_state_remove_observer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_state_remove_observer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d5/d92/structstasis__state__observer.html">stasis_state_observer</a> *&#160;</td>
          <td class="paramname"><em>observer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove an observer (will no longer receive managed state related events). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The state manager </td></tr>
    <tr><td class="paramname">observer</td><td>The observer being removed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00700">700</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00573">AST_VECTOR_ELEM_CLEANUP_NOOP</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00585">AST_VECTOR_REMOVE_ELEM_UNORDERED</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00900">AST_VECTOR_RW_UNLOCK</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00890">AST_VECTOR_RW_WRLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00302">ast_mwi_remove_observer()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00113">subscriptions_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;{</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a468985d2b5ca7410d91108bdd0484348">AST_VECTOR_RW_WRLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a79df3872d03069f077e7cab2262b8550">AST_VECTOR_REMOVE_ELEM_UNORDERED</a>(&amp;manager-&gt;observers, observer, <a class="code" href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a>);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div><div class="ttc" id="vector_8h_html_a79df3872d03069f077e7cab2262b8550"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a79df3872d03069f077e7cab2262b8550">AST_VECTOR_REMOVE_ELEM_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_ELEM_UNORDERED(vec, elem, cleanup)</div><div class="ttdoc">Remove an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00585">vector.h:585</a></div></div>
<div class="ttc" id="vector_8h_html_a5ad3dd1d3da5d4ebf6a44d32e42c4c91"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_UNLOCK(vec)</div><div class="ttdoc">Unlock vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00900">vector.h:900</a></div></div>
<div class="ttc" id="vector_8h_html_a1885c25b9d767a53d1df9b641f53951a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a></div><div class="ttdeci">#define AST_VECTOR_ELEM_CLEANUP_NOOP(elem)</div><div class="ttdoc">Vector element cleanup that does nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00573">vector.h:573</a></div></div>
<div class="ttc" id="vector_8h_html_a468985d2b5ca7410d91108bdd0484348"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a468985d2b5ca7410d91108bdd0484348">AST_VECTOR_RW_WRLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_WRLOCK(vec)</div><div class="ttdoc">Obtain write lock on vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00890">vector.h:890</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd6a2d9bb8e46b049966355cda567a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd6a2d9bb8e46b049966355cda567a37">&#9670;&nbsp;</a></span>stasis_state_remove_publish_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_state_remove_publish_by_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish to a managed named by id topic, and remove an implicit publisher. </p>
<p>This function should be called after calling stasis_state_publish_by_id at least once for the same manager, id, and eid. If the given stasis message is NULL then the implicit publisher is removed, but no last message is published.</p>
<p>See note and description on stasis_state_publish_by_id for more details about if, and when this function should be used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The state manager </td></tr>
    <tr><td class="paramname">id</td><td>A state's unique id </td></tr>
    <tr><td class="paramname">eid</td><td>The unique system id </td></tr>
    <tr><td class="paramname">msg</td><td>The message to publish (can be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00658">658</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01768">ao2_weakproxy_find</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00620">state_find_and_remove_eid()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00399">ast_delete_mwi_state_full()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00179">publishers_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aa78a383f537bc7a35efb8eaabcdc44e9">ao2_weakproxy_find</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>, <span class="keywordtype">id</span>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">       * In most circumstances state should already exist here. However, if there is no</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">       * state then it can mean one of a few things:</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">       * 1. This function was called prior to an implicit publish for the same given</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">       *    manager, and id.</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">       * 2. This function was called more than once for the same manager, and id.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">       * 3. There is ref count problem with the explicit subscribers, and publishers.</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Attempted to remove state for id &#39;%s&#39;, but state not found\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   <span class="keywordflow">if</span> (msg) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, msg);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(state);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <a class="code" href="../../dc/d1d/stasis__state_8c.html#a76bf47e293ac2a764061da3ea1a7d671">state_find_and_remove_eid</a>(state, eid);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(state);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;}</div><div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa78a383f537bc7a35efb8eaabcdc44e9"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa78a383f537bc7a35efb8eaabcdc44e9">ao2_weakproxy_find</a></div><div class="ttdeci">#define ao2_weakproxy_find(c, arg, flags, tag)</div><div class="ttdoc">Perform an ao2_find on a container with ao2_weakproxy objects, returning the real object...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01768">astobj2.h:1768</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a76bf47e293ac2a764061da3ea1a7d671"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a76bf47e293ac2a764061da3ea1a7d671">state_find_and_remove_eid</a></div><div class="ttdeci">static void state_find_and_remove_eid(struct stasis_state *state, const struct ast_eid *eid)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00620">stasis_state.c:620</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af61eaf43040b329d68b476e647f6a7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af61eaf43040b329d68b476e647f6a7d6">&#9670;&nbsp;</a></span>stasis_state_subscribe_pool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a>* stasis_state_subscribe_pool </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a subscriber, and subscribe to its underlying stasis topic. </p>
<p>Adds a subscriber to a managed state based on id. If managed state does not already exists for the given id then new managed state is created. Otherwise the existing state is subscribed to. If the state is successfully subscribed to then a stasis subscription is subsequently created as well.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The manager object </td></tr>
    <tr><td class="paramname">id</td><td>The unique id of a managed state </td></tr>
    <tr><td class="paramname">callback</td><td>The stasis subscription callback </td></tr>
    <tr><td class="paramname">data</td><td>A user data object passed to the stasis subscription</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>stasis state subscriber </td></tr>
    <tr><td class="paramname">NULL</td><td>if an error occurred</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00446">446</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00412">stasis_state_add_subscriber()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state_subscriber::stasis_sub</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00682">stasis_subscribe_pool</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state_subscriber::state</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00230">ast_mwi_subscribe_pool()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00131">subscriptions_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = <a class="code" href="../../dc/d1d/stasis__state_8c.html#a0826641b8fbe326ff48602f0406be308">stasis_state_add_subscriber</a>(manager, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordflow">if</span> (!sub) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   topic = sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Creating stasis state subscription to id &#39;%s&#39;. Topic: &#39;%s&#39;:%p %d\n&quot;</span>,</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordtype">id</span>, <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(topic), topic, (<span class="keywordtype">int</span>)<a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(topic, 0));</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_sub</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a597f7a30fe616c9f083a93ed168955ed">stasis_subscribe_pool</a>(topic, callback, data);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="keywordflow">if</span> (!sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_sub</a>) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub, -1);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div><div class="ttc" id="structstasis__state__subscriber_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_subscriber::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state.c:386</a></div></div>
<div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a0826641b8fbe326ff48602f0406be308"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a0826641b8fbe326ff48602f0406be308">stasis_state_add_subscriber</a></div><div class="ttdeci">struct stasis_state_subscriber * stasis_state_add_subscriber(struct stasis_state_manager *manager, const char *id)</div><div class="ttdoc">Add a subscriber to the managed stasis state for the given id. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00412">stasis_state.c:412</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="stasis_8h_html_a597f7a30fe616c9f083a93ed168955ed"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a597f7a30fe616c9f083a93ed168955ed">stasis_subscribe_pool</a></div><div class="ttdeci">#define stasis_subscribe_pool(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00682">stasis.h:682</a></div></div>
<div class="ttc" id="structstasis__state__subscriber_html_a8e97d3a592559eb7249c724b027f80c1"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_state_subscriber::stasis_sub</a></div><div class="ttdeci">struct stasis_subscription * stasis_sub</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state.c:388</a></div></div>
<div class="ttc" id="structstasis__state__subscriber_html"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00384">stasis_state.c:384</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3effc7b9731f157205bb2b65c3a2f1b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3effc7b9731f157205bb2b65c3a2f1b8">&#9670;&nbsp;</a></span>stasis_state_subscriber_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* stasis_state_subscriber_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the last known state stasis message payload for the subscriber. </p>
<p>If a stasis message has been published to this state, this function returns that message's payload object. If no stasis message has been published on the state, or the message's payload does not exist then NULL is returned.</p>
<dl class="section note"><dt>Note</dt><dd>Returned data's reference count is incremented</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>A stasis state subscriber</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>subscriber's state message data </td></tr>
    <tr><td class="paramname">NULL</td><td>if no data has been published yet</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00497">497</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state::msg</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state_subscriber::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00264">ast_mwi_subscriber_data()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00096">handle_validate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;{</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="keywordtype">void</span> *res;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">    * The data&#39;s reference needs to be bumped before returning so it doesn&#39;t disappear</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">    * for the caller. Lock state, so the underlying message data is not replaced while</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">    * retrieving.</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   res = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(<a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">msg</a>));</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div><div class="ttc" id="structstasis__state__subscriber_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_subscriber::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state.c:386</a></div></div>
<div class="ttc" id="structstasis__state_html_aa24737e537b6b1f647b3f22392ac8abe"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">stasis_state::msg</a></div><div class="ttdeci">struct stasis_message * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state.c:63</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5eeb2acddec8b7683035b25e8a4cf886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eeb2acddec8b7683035b25e8a4cf886">&#9670;&nbsp;</a></span>stasis_state_subscriber_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* stasis_state_subscriber_id </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the underlying subscribed to state's unique id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>A stasis state subscriber</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>managed state's id</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00487">487</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state_subscriber::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00264">ast_mwi_subscriber_data()</a>.</p>
<div class="fragment"><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;id;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div><div class="ttc" id="structstasis__state__subscriber_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_subscriber::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state.c:386</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf6aa9b3aba2f94825472d43f81ad284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf6aa9b3aba2f94825472d43f81ad284">&#9670;&nbsp;</a></span>stasis_state_subscriber_subscription()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a>* stasis_state_subscriber_subscription </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the stasis topic subscription if available. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>A stasis state subscriber</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>subscriber's stasis subscription </td></tr>
    <tr><td class="paramname">NULL</td><td>if no subscription available</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00513">513</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state_subscriber::stasis_sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00272">ast_mwi_subscriber_subscription()</a>.</p>
<div class="fragment"><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_sub</a>;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div><div class="ttc" id="structstasis__state__subscriber_html_a8e97d3a592559eb7249c724b027f80c1"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_state_subscriber::stasis_sub</a></div><div class="ttdeci">struct stasis_subscription * stasis_sub</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state.c:388</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a904a0f91e443cb185f82e39512381974"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a904a0f91e443cb185f82e39512381974">&#9670;&nbsp;</a></span>stasis_state_subscriber_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_state_subscriber_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the subscriber's topic. </p>
<dl class="section note"><dt>Note</dt><dd>Returned topic's reference count is NOT incremented. However, the topic is guaranteed to live for the lifetime of the subscriber.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>A stasis state subscriber</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>subscriber's topic</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00492">492</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state_subscriber::state</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00259">ast_mwi_subscriber_topic()</a>.</p>
<div class="fragment"><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;{</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div><div class="ttc" id="structstasis__state__subscriber_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_subscriber::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state.c:386</a></div></div>
<div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4096e710d5f849bf345dde006d269548"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4096e710d5f849bf345dde006d269548">&#9670;&nbsp;</a></span>stasis_state_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_state_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a managed topic creating one if not currently managed. </p>
<p>WARNING This function should not be called before adding a publisher or subscriber or it will cause a memory leak within the stasis state manager. This function is here in order to allow for compatibility with how things used to work.</p>
<p>Also much like the similar functionality from before it returns the stasis topic, but does not bump its reference.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">manager</td><td>The manager object </td></tr>
    <tr><td class="paramname">id</td><td>The unique id of/for the topic</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>managed stasis topic. </td></tr>
    <tr><td class="paramname">NULL</td><td>if an error occurred</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00369">369</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l00959">state</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00270">state_find_or_add</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00100">ast_mwi_topic()</a>.</p>
<div class="fragment"><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   state = <a class="code" href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a>(manager, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   topic = state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a9d69e7d941254c112769ae1d6c2ae5f5"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a9d69e7d941254c112769ae1d6c2ae5f5">state_find_or_add</a></div><div class="ttdeci">#define state_find_or_add(mgr, top, id)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00270">stasis_state.c:270</a></div></div>
<div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a479b995c5d232c9296809bff7216e37a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a479b995c5d232c9296809bff7216e37a">&#9670;&nbsp;</a></span>stasis_state_unsubscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* stasis_state_unsubscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribe from the stasis topic and stasis state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>A stasis state subscriber</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00470">470</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state_subscriber::stasis_sub</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">stasis_unsubscribe()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00249">ast_mwi_unsubscribe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;{</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_sub</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_sub</a>);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub, -1);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__state__subscriber_html_a8e97d3a592559eb7249c724b027f80c1"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_state_subscriber::stasis_sub</a></div><div class="ttdeci">struct stasis_subscription * stasis_sub</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state.c:388</a></div></div>
<div class="ttc" id="stasis_8h_html_a3498301077e2005383f0d261c471388b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00973">stasis.c:973</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a858f0158644f3bb53e1298c98a93f300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858f0158644f3bb53e1298c98a93f300">&#9670;&nbsp;</a></span>stasis_state_unsubscribe_and_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* stasis_state_unsubscribe_and_join </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribe from the stasis topic, block until the final message is received, and then unsubscribe from stasis state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>A stasis state subscriber</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.28.0 </dd>
<dd>
16.5.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00477">477</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state_subscriber::stasis_sub</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">stasis_unsubscribe_and_join()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00254">ast_mwi_unsubscribe_and_join()</a>, and <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00113">subscriptions_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;{</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <span class="keywordflow">if</span> (sub) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_sub</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_sub</a>);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub, -1);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__state__subscriber_html_a8e97d3a592559eb7249c724b027f80c1"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a8e97d3a592559eb7249c724b027f80c1">stasis_state_subscriber::stasis_sub</a></div><div class="ttdeci">struct stasis_subscription * stasis_sub</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00388">stasis_state.c:388</a></div></div>
<div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a21c57132104024fa2e61e7c7c293c83e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c57132104024fa2e61e7c7c293c83e">&#9670;&nbsp;</a></span>state_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a>* state_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *&#160;</td>
          <td class="paramname"><em>manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>state_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">167</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00765">__ao2_alloc()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state_manager::all_topic</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00557">ao2_t_weakproxy_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00586">ao2_t_weakproxy_set_object</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00931">ao2_weakproxy_subscribe()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00059">stasis_state::forward</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00036">stasis_state_proxy::id</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state_proxy::manager</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00057">stasis_state::manager</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01578">stasis_forward_all()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l00959">state</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00121">state_dtor()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00104">state_id_by_topic()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00136">state_proxy_dtor()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00142">state_proxy_sub_cb()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00271">__state_find_or_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a> *proxy = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="keywordflow">if</span> (!<span class="keywordtype">id</span>) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">/* If not given an id, then a state topic is required */</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(state_topic != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="comment">/* Get the id we&#39;ll key off of from the state topic */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordtype">id</span> = <a class="code" href="../../dc/d1d/stasis__state_8c.html#affbf31fec99eae22d9bab4d664b97c75">state_id_by_topic</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>, state_topic);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   state = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc036c9ca7cf5266f1058d67b8ef541">__ao2_alloc</a>(<span class="keyword">sizeof</span>(*state), <a class="code" href="../../dc/d1d/stasis__state_8c.html#a883b15d906b1dfa79ace4534deae8543">state_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <span class="keywordtype">id</span>, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, line, func);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keywordflow">if</span> (!state) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="keywordflow">if</span> (!state_topic) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">       * To provide further detail and to ensure that the topic is unique within the</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">       * scope of the system we prefix it with the manager&#39;s topic name, which should</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">       * itself already be unique.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;name, <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>), <span class="keywordtype">id</span>) &lt; 0) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a> = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(name);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(name);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">if</span> (!state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">       * Since the state topic was passed in, go ahead and bump its reference.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">       * By doing this here first, it allows us to consistently decrease the reference on</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">       * state allocation error.</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state_topic, +1);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a> = state_topic;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   proxy = <a class="code" href="../../d5/da5/astobj2_8h.html#a927c9a5bce40a0164c297325eea4a562">ao2_t_weakproxy_alloc</a>(<span class="keyword">sizeof</span>(*proxy) + strlen(<span class="keywordtype">id</span>) + 1, <a class="code" href="../../dc/d1d/stasis__state_8c.html#a148f4b94cf1fd1d4e828cbccaea3f585">state_proxy_dtor</a>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordflow">if</span> (!proxy) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   strcpy(proxy-&gt;<a class="code" href="../../d2/dd2/structstasis__state__proxy.html#abe9e57df6ac773738500092fe3cf7fca">id</a>, <span class="keywordtype">id</span>); <span class="comment">/* Safe */</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   state-&gt;id = proxy-&gt;<a class="code" href="../../d2/dd2/structstasis__state__proxy.html#abe9e57df6ac773738500092fe3cf7fca">id</a>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   proxy-&gt;<a class="code" href="../../d2/dd2/structstasis__state__proxy.html#ad86cafe95375bae0b285452fe5edc104">manager</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(manager);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#ad86cafe95375bae0b285452fe5edc104">manager</a> = proxy-&gt;<a class="code" href="../../d2/dd2/structstasis__state__proxy.html#ad86cafe95375bae0b285452fe5edc104">manager</a>; <span class="comment">/* state-&gt;manager is owned by the proxy */</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#afd101b3d2cc1eb673b30afb631718b79">forward</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="keywordflow">if</span> (!state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#afd101b3d2cc1eb673b30afb631718b79">forward</a>) {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;state-&gt;eids, 2)) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#afd157ff946d91f29f2ec5fa43a81b9c1">ao2_t_weakproxy_set_object</a>(proxy, state, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>, <span class="stringliteral">&quot;weakproxy link&quot;</span>)) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#a0f7c2d3037d7c36c8c88fdb2cb65c6e1">ao2_weakproxy_subscribe</a>(proxy, <a class="code" href="../../dc/d1d/stasis__state_8c.html#aad131a2b602c52fcb48dc43eeac8763c">state_proxy_sub_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>)) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>, proxy, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>)) {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">goto</span> error_return;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(proxy, -1);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;error_return:</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to allocate state &#39;%s&#39; in manager &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         <span class="keywordtype">id</span>, <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>));</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(proxy);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="ttc" id="structstasis__state_html_afd101b3d2cc1eb673b30afb631718b79"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#afd101b3d2cc1eb673b30afb631718b79">stasis_state::forward</a></div><div class="ttdeci">struct stasis_forward * forward</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00059">stasis_state.c:59</a></div></div>
<div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a883b15d906b1dfa79ace4534deae8543"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a883b15d906b1dfa79ace4534deae8543">state_dtor</a></div><div class="ttdeci">static void state_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00121">stasis_state.c:121</a></div></div>
<div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="stasis__state_8c_html_a148f4b94cf1fd1d4e828cbccaea3f585"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#a148f4b94cf1fd1d4e828cbccaea3f585">state_proxy_dtor</a></div><div class="ttdeci">static void state_proxy_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00136">stasis_state.c:136</a></div></div>
<div class="ttc" id="structstasis__state_html_ad86cafe95375bae0b285452fe5edc104"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#ad86cafe95375bae0b285452fe5edc104">stasis_state::manager</a></div><div class="ttdeci">struct stasis_state_manager * manager</div><div class="ttdoc">The manager that owns and handles this state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00057">stasis_state.c:57</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc036c9ca7cf5266f1058d67b8ef541"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc036c9ca7cf5266f1058d67b8ef541">__ao2_alloc</a></div><div class="ttdeci">void * __ao2_alloc(size_t data_size, ao2_destructor_fn destructor_fn, unsigned int options, const char *tag, const char *file, int line, const char *func) attribute_warn_unused_result</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00765">astobj2.c:765</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="astobj2_8h_html_a0f7c2d3037d7c36c8c88fdb2cb65c6e1"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a0f7c2d3037d7c36c8c88fdb2cb65c6e1">ao2_weakproxy_subscribe</a></div><div class="ttdeci">int ao2_weakproxy_subscribe(void *weakproxy, ao2_weakproxy_notification_cb cb, void *data, int flags)</div><div class="ttdoc">Request notification when weakproxy points to NULL. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00931">astobj2.c:931</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__state_8c_html_aad131a2b602c52fcb48dc43eeac8763c"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#aad131a2b602c52fcb48dc43eeac8763c">state_proxy_sub_cb</a></div><div class="ttdeci">static void state_proxy_sub_cb(void *obj, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00142">stasis_state.c:142</a></div></div>
<div class="ttc" id="stasis__state_8c_html_affbf31fec99eae22d9bab4d664b97c75"><div class="ttname"><a href="../../dc/d1d/stasis__state_8c.html#affbf31fec99eae22d9bab4d664b97c75">state_id_by_topic</a></div><div class="ttdeci">static const char * state_id_by_topic(struct stasis_topic *manager_topic, const struct stasis_topic *state_topic)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00104">stasis_state.c:104</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a4b36465264544dbb0063d66a9010d866"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">stasis_state_manager::all_topic</a></div><div class="ttdeci">struct stasis_topic * all_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__state__proxy_html_ad86cafe95375bae0b285452fe5edc104"><div class="ttname"><a href="../../d2/dd2/structstasis__state__proxy.html#ad86cafe95375bae0b285452fe5edc104">stasis_state_proxy::manager</a></div><div class="ttdeci">struct stasis_state_manager * manager</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state.c:34</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_afd157ff946d91f29f2ec5fa43a81b9c1"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#afd157ff946d91f29f2ec5fa43a81b9c1">ao2_t_weakproxy_set_object</a></div><div class="ttdeci">#define ao2_t_weakproxy_set_object(weakproxy, obj, flags, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00586">astobj2.h:586</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__state__proxy_html_abe9e57df6ac773738500092fe3cf7fca"><div class="ttname"><a href="../../d2/dd2/structstasis__state__proxy.html#abe9e57df6ac773738500092fe3cf7fca">stasis_state_proxy::id</a></div><div class="ttdeci">char id[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00036">stasis_state.c:36</a></div></div>
<div class="ttc" id="structstasis__state__proxy_html"><div class="ttname"><a href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00031">stasis_state.c:31</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
<div class="ttc" id="astobj2_8h_html_a927c9a5bce40a0164c297325eea4a562"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a927c9a5bce40a0164c297325eea4a562">ao2_t_weakproxy_alloc</a></div><div class="ttdeci">#define ao2_t_weakproxy_alloc(data_size, destructor_fn, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00557">astobj2.h:557</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
<div class="ttc" id="stasis_8h_html_a2513a93567ddc93510f7896b777da119"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a></div><div class="ttdeci">struct stasis_forward * stasis_forward_all(struct stasis_topic *from_topic, struct stasis_topic *to_topic)</div><div class="ttdoc">Create a subscription which forwards all messages from one topic to another. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01578">stasis.c:1578</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a883b15d906b1dfa79ace4534deae8543"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883b15d906b1dfa79ace4534deae8543">&#9670;&nbsp;</a></span>state_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void state_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00121">121</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00059">stasis_state::forward</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state::msg</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01548">stasis_forward_cancel()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;{</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d75/structstasis__state.html">stasis_state</a> *<a class="code" href="../../d4/d88/structstate.html">state</a> = obj;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#afd101b3d2cc1eb673b30afb631718b79">forward</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#afd101b3d2cc1eb673b30afb631718b79">forward</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">topic</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">msg</a>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   state-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">msg</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="comment">/* All eids should have been removed */</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;state-&gt;eids) == 0);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;state-&gt;eids);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="ttc" id="structstasis__state_html_afd101b3d2cc1eb673b30afb631718b79"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#afd101b3d2cc1eb673b30afb631718b79">stasis_state::forward</a></div><div class="ttdeci">struct stasis_forward * forward</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00059">stasis_state.c:59</a></div></div>
<div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structstasis__state_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#a136460a7868b48ef576c0fa505ef96db">stasis_state::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state.c:61</a></div></div>
<div class="ttc" id="structstasis__state_html_aa24737e537b6b1f647b3f22392ac8abe"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aa24737e537b6b1f647b3f22392ac8abe">stasis_state::msg</a></div><div class="ttdeci">struct stasis_message * msg</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00063">stasis_state.c:63</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8h_html_a5713715b0f26f4943d0af05363b07027"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a></div><div class="ttdeci">struct stasis_forward * stasis_forward_cancel(struct stasis_forward *forward)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01548">stasis.c:1548</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__state_html"><div class="ttname"><a href="../../d6/d75/structstasis__state.html">stasis_state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00050">stasis_state.c:50</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76bf47e293ac2a764061da3ea1a7d671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76bf47e293ac2a764061da3ea1a7d671">&#9670;&nbsp;</a></span>state_find_and_remove_eid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void state_find_and_remove_eid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00620">620</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00438">AST_VECTOR_REMOVE_UNORDERED</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00658">stasis_state_remove_publish_by_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;{</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   <span class="keywordtype">size_t</span> i;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <span class="keywordflow">if</span> (!eid) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      eid = &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;state-&gt;eids); ++i) {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(<a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(&amp;state-&gt;eids, i), eid)) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#a88927df275257d9c9431252e016503ec">AST_VECTOR_REMOVE_UNORDERED</a>(&amp;state-&gt;eids, i);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <span class="comment">/* Balance the reference from state_find_or_add_eid */</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, -1);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;}</div><div class="ttc" id="vector_8h_html_a88927df275257d9c9431252e016503ec"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a88927df275257d9c9431252e016503ec">AST_VECTOR_REMOVE_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_UNORDERED(vec, idx)</div><div class="ttdoc">Remove an element from an unordered vector by index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00438">vector.h:438</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78067dcb8032e3a734d8ab2528ad3e99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78067dcb8032e3a734d8ab2528ad3e99">&#9670;&nbsp;</a></span>state_find_or_add_eid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void state_find_or_add_eid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d75/structstasis__state.html">stasis_state</a> *&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00586">586</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00638">stasis_state_publish_by_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;{</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <span class="keywordtype">size_t</span> i;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">if</span> (!eid) {</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      eid = &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;state-&gt;eids); ++i) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(<a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(&amp;state-&gt;eids, i), eid)) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="keywordflow">if</span> (i == <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;state-&gt;eids)) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;state-&gt;eids, *eid)) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;         <span class="comment">/* This ensures state cannot be freed if it has any eids */</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(state, +1);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div><div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="affbf31fec99eae22d9bab4d664b97c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affbf31fec99eae22d9bab4d664b97c75">&#9670;&nbsp;</a></span>state_id_by_topic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char* state_id_by_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>manager_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>state_topic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00104">104</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00094">ast_begins_with()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00036">stasis_state_proxy::id</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00271">__state_find_or_add()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="comment">/* This topic should always belong to the manager */</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a>(<a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager_topic),</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(state_topic)));</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <span class="keywordtype">id</span> = strchr(<a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(state_topic), <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="comment">/* The state&#39;s unique id should always exist */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<span class="keywordtype">id</span> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; (<span class="keywordtype">id</span> + 1) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="keywordflow">return</span> (<span class="keywordtype">id</span> + 1);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="strings_8h_html_ac51fa66c90ce950b248c9ff3e8c4e453"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a></div><div class="ttdeci">static int force_inline attribute_pure ast_begins_with(const char *str, const char *prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00094">strings.h:94</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ce96ad06685e89abf4561ed930029a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce96ad06685e89abf4561ed930029a7">&#9670;&nbsp;</a></span>state_manager_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void state_manager_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00292">292</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state_manager::all_topic</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00985">ao2_container_unregister()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00202">AST_VECTOR_RW_FREE</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state_proxy::manager</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00061">stasis_state::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00324">stasis_state_manager_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager = obj;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">#ifdef AO2_DEBUG</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordtype">char</span> *container_name =</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(strlen(<a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>)) + strlen(<span class="stringliteral">&quot;-manager&quot;</span>) + 1);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      sprintf(container_name, <span class="stringliteral">&quot;%s-manager&quot;</span>, <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>));</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a4b8c1cca9dace1cf1bbadc5039f3dedf">ao2_container_unregister</a>(container_name);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   manager-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">all_topic</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a7b85c5439f23cf3a3b365b7c12643ac8">AST_VECTOR_RW_FREE</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a4b36465264544dbb0063d66a9010d866"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a4b36465264544dbb0063d66a9010d866">stasis_state_manager::all_topic</a></div><div class="ttdeci">struct stasis_topic * all_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00083">stasis_state.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_a4b8c1cca9dace1cf1bbadc5039f3dedf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a4b8c1cca9dace1cf1bbadc5039f3dedf">ao2_container_unregister</a></div><div class="ttdeci">void ao2_container_unregister(const char *name)</div><div class="ttdoc">Unregister a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00985">astobj2_container.c:985</a></div></div>
<div class="ttc" id="vector_8h_html_a7b85c5439f23cf3a3b365b7c12643ac8"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a7b85c5439f23cf3a3b365b7c12643ac8">AST_VECTOR_RW_FREE</a></div><div class="ttdeci">#define AST_VECTOR_RW_FREE(vec)</div><div class="ttdoc">Deallocates this locked vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00202">vector.h:202</a></div></div>
<div class="ttc" id="structstasis__state__manager_html"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00079">stasis_state.c:79</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a148f4b94cf1fd1d4e828cbccaea3f585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a148f4b94cf1fd1d4e828cbccaea3f585">&#9670;&nbsp;</a></span>state_proxy_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void state_proxy_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00136">136</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state_proxy::manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                        {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a> *proxy = obj;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(proxy-&gt;<a class="code" href="../../d2/dd2/structstasis__state__proxy.html#ad86cafe95375bae0b285452fe5edc104">manager</a>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div><div class="ttc" id="structstasis__state__proxy_html_ad86cafe95375bae0b285452fe5edc104"><div class="ttname"><a href="../../d2/dd2/structstasis__state__proxy.html#ad86cafe95375bae0b285452fe5edc104">stasis_state_proxy::manager</a></div><div class="ttdeci">struct stasis_state_manager * manager</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state.c:34</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__state__proxy_html"><div class="ttname"><a href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00031">stasis_state.c:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aad131a2b602c52fcb48dc43eeac8763c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad131a2b602c52fcb48dc43eeac8763c">&#9670;&nbsp;</a></span>state_proxy_sub_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void state_proxy_sub_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00142">142</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01598">ao2_unlink</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state_proxy::manager</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state_manager::states</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a> *proxy = obj;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(proxy-&gt;<a class="code" href="../../d2/dd2/structstasis__state__proxy.html#ad86cafe95375bae0b285452fe5edc104">manager</a>-&gt;<a class="code" href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">states</a>, proxy);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div><div class="ttc" id="structstasis__state__proxy_html_ad86cafe95375bae0b285452fe5edc104"><div class="ttname"><a href="../../d2/dd2/structstasis__state__proxy.html#ad86cafe95375bae0b285452fe5edc104">stasis_state_proxy::manager</a></div><div class="ttdeci">struct stasis_state_manager * manager</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state.c:34</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="structstasis__state__proxy_html"><div class="ttname"><a href="../../d2/dd2/structstasis__state__proxy.html">stasis_state_proxy</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00031">stasis_state.c:31</a></div></div>
<div class="ttc" id="structstasis__state__manager_html_a18c5b21cd31cd417cb9d1a534cce95e1"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html#a18c5b21cd31cd417cb9d1a534cce95e1">stasis_state_manager::states</a></div><div class="ttdeci">struct ao2_container * states</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00081">stasis_state.c:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4c06124c1a71446a10d133c905b0f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4c06124c1a71446a10d133c905b0f03">&#9670;&nbsp;</a></span>subscriber_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void subscriber_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00391">391</a> of file <a class="el" href="../../dc/d1d/stasis__state_8c_source.html">stasis_state.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00880">AST_VECTOR_RW_RDLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00900">AST_VECTOR_RW_UNLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00034">stasis_state_proxy::manager</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00057">stasis_state::manager</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00052">stasis_state::num_subscribers</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state_subscriber::state</a>, and <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00412">stasis_state_add_subscriber()</a>.</p>
<div class="fragment"><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordtype">size_t</span> i;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a> = obj;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a> *manager = sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#ad86cafe95375bae0b285452fe5edc104">manager</a>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;manager-&gt;observers); ++i) {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;manager-&gt;observers, i)-&gt;on_unsubscribe) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;manager-&gt;observers, i)-&gt;on_unsubscribe(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;id, sub);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      }</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;manager-&gt;observers);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   --sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>-&gt;<a class="code" href="../../d6/d75/structstasis__state.html#aeffbfbab5dabd4de4beb0c6190b01759">num_subscribers</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sub-&gt;<a class="code" href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">state</a>, -1);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div><div class="ttc" id="structstasis__state__subscriber_html_a7657b2fb6d92ad0e32691de4b271867a"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html#a7657b2fb6d92ad0e32691de4b271867a">stasis_state_subscriber::state</a></div><div class="ttdeci">struct stasis_state * state</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00386">stasis_state.c:386</a></div></div>
<div class="ttc" id="vector_8h_html_a5ad3dd1d3da5d4ebf6a44d32e42c4c91"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_UNLOCK(vec)</div><div class="ttdoc">Unlock vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00900">vector.h:900</a></div></div>
<div class="ttc" id="structstasis__state_html_ad86cafe95375bae0b285452fe5edc104"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#ad86cafe95375bae0b285452fe5edc104">stasis_state::manager</a></div><div class="ttdeci">struct stasis_state_manager * manager</div><div class="ttdoc">The manager that owns and handles this state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00057">stasis_state.c:57</a></div></div>
<div class="ttc" id="vector_8h_html_ad414eae87431bad2a7fc4dffa9d06350"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_RDLOCK(vec)</div><div class="ttdoc">Obtain read lock on vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00880">vector.h:880</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structstasis__state__manager_html"><div class="ttname"><a href="../../d8/d25/structstasis__state__manager.html">stasis_state_manager</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00079">stasis_state.c:79</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structstasis__state__subscriber_html"><div class="ttname"><a href="../../d7/d67/structstasis__state__subscriber.html">stasis_state_subscriber</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00384">stasis_state.c:384</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="structstasis__state_html_aeffbfbab5dabd4de4beb0c6190b01759"><div class="ttname"><a href="../../d6/d75/structstasis__state.html#aeffbfbab5dabd4de4beb0c6190b01759">stasis_state::num_subscribers</a></div><div class="ttdeci">unsigned int num_subscribers</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d1d/stasis__state_8c_source.html#l00052">stasis_state.c:52</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:50 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
