<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_publish_asterisk.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_pjsip_publish_asterisk.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;regex.h&gt;</code><br />
<code>#include &lt;pjsip.h&gt;</code><br />
<code>#include &lt;pjsip_simple.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">asterisk/res_pjsip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/dd4/res__pjsip__outbound__publish_8h_source.html">asterisk/res_pjsip_outbound_publish.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html">asterisk/res_pjsip_pubsub.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d8c/logger_8h_source.html">asterisk/logger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/d33/mwi_8h_source.html">asterisk/mwi.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_pjsip_publish_asterisk.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d84/res__pjsip__publish__asterisk_8c__incl.png" border="0" usemap="#res__pjsip__publish__asterisk_8c" alt=""/></div>
<map name="res__pjsip__publish__asterisk_8c" id="res__pjsip__publish__asterisk_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="975,251,1059,278"/>
<area shape="rect" id="node25" href="../../d8/d8c/res__pjsip_8h.html" title="asterisk/res_pjsip.h" alt="" coords="2655,87,2799,114"/>
<area shape="rect" id="node34" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1683,408,1810,435"/>
<area shape="rect" id="node46" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html" title="asterisk/res_pjsip\l_outbound_publish.h" alt="" coords="3439,244,3593,285"/>
<area shape="rect" id="node47" href="../../dc/db0/res__pjsip__pubsub_8h.html" title="asterisk/res_pjsip\l_pubsub.h" alt="" coords="3594,80,3726,121"/>
<area shape="rect" id="node48" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1312,87,1448,114"/>
<area shape="rect" id="node49" href="../../dc/d33/mwi_8h.html" title="Asterisk MWI API. " alt="" coords="1495,87,1609,114"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="345,333,500,360"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="869,333,1006,360"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="1030,333,1165,360"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="5,408,152,435"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="435,408,578,435"/>
<area shape="rect" id="node29" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="2059,408,2216,435"/>
<area shape="rect" id="node31" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="3083,483,3210,509"/>
<area shape="rect" id="node32" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="2347,251,2493,278"/>
<area shape="rect" id="node35" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="3387,333,3538,360"/>
<area shape="rect" id="node36" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1915,251,2053,278"/>
<area shape="rect" id="node38" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1801,333,1951,360"/>
<area shape="rect" id="node39" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="1735,169,1868,196"/>
<area shape="rect" id="node40" href="../../db/dc4/dnsmgr_8h.html" title="Background DNS update manager. " alt="" coords="2780,169,2916,196"/>
<area shape="rect" id="node41" href="../../d5/da1/udptl_8h.html" title="UDPTL support for T.38. " alt="" coords="2156,169,2276,196"/>
<area shape="rect" id="node42" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="2941,169,3097,196"/>
<area shape="rect" id="node43" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1943,169,2132,196"/>
<area shape="rect" id="node44" href="../../d7/d44/stasis__endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="2128,251,2323,278"/>
<area shape="rect" id="node45" href="../../d8/d95/stream_8h.html" title="Media Stream API. " alt="" coords="3223,251,3358,278"/>
<area shape="rect" id="node30" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="2064,483,2211,509"/>
<area shape="rect" id="node37" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1517,333,1632,360"/>
<area shape="rect" id="node50" href="../../d1/d96/stasis__state_8h.html" title="Stasis State API. " alt="" coords="1393,169,1559,196"/>
</map>
</div>
</div>
<p><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure which contains Asterisk device state publisher state information.  <a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure which contains Asterisk mailbox publisher state information.  <a href="../../d3/df1/structasterisk__mwi__publisher__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure which contains Asterisk publication information.  <a href="../../dd/db3/structasterisk__publication__config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a153cb152b61029edeb05f294cbbc0059"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a153cb152b61029edeb05f294cbbc0059">asterisk_devicestate_publisher_state_destroy</a> (void *obj)</td></tr>
<tr class="memdesc:a153cb152b61029edeb05f294cbbc0059"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy callback for Asterisk devicestate publisher state information from datastore.  <a href="#a153cb152b61029edeb05f294cbbc0059">More...</a><br /></td></tr>
<tr class="separator:a153cb152b61029edeb05f294cbbc0059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15b57d7620dae0cee0a3ad8c9136064"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#af15b57d7620dae0cee0a3ad8c9136064">asterisk_mwi_publisher_state_destroy</a> (void *obj)</td></tr>
<tr class="memdesc:af15b57d7620dae0cee0a3ad8c9136064"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy callback for Asterisk mwi publisher state information from datastore.  <a href="#af15b57d7620dae0cee0a3ad8c9136064">More...</a><br /></td></tr>
<tr class="separator:af15b57d7620dae0cee0a3ad8c9136064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15bf28546452c2262131fdf61a4919d2"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a15bf28546452c2262131fdf61a4919d2">asterisk_publication_config_alloc</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a15bf28546452c2262131fdf61a4919d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocator function for Asterisk publication configuration.  <a href="#a15bf28546452c2262131fdf61a4919d2">More...</a><br /></td></tr>
<tr class="separator:a15bf28546452c2262131fdf61a4919d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14763dabea8aae54b9c519e9225ed8c5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a14763dabea8aae54b9c519e9225ed8c5">asterisk_publication_config_destroy</a> (void *obj)</td></tr>
<tr class="memdesc:a14763dabea8aae54b9c519e9225ed8c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor function for Asterisk publication configuration.  <a href="#a14763dabea8aae54b9c519e9225ed8c5">More...</a><br /></td></tr>
<tr class="separator:a14763dabea8aae54b9c519e9225ed8c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a3a24e5c2296374c30b0a7fb5d95529"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a8a3a24e5c2296374c30b0a7fb5d95529">asterisk_publication_devicestate</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub, struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="el" href="../../d0/d8a/muted_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *pubsub_eid, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json)</td></tr>
<tr class="separator:a8a3a24e5c2296374c30b0a7fb5d95529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dab8946fa4eb59b953b090ffd62a063"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3dab8946fa4eb59b953b090ffd62a063">asterisk_publication_devicestate_refresh</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub, struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="el" href="../../d0/d8a/muted_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *pubsub_eid, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json)</td></tr>
<tr class="separator:a3dab8946fa4eb59b953b090ffd62a063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0d829696b4c54e83e0db72a8d6115a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#acf0d829696b4c54e83e0db72a8d6115a">asterisk_publication_devicestate_state_change</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub, pjsip_msg_body *body, enum <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562">ast_sip_publish_state</a> <a class="el" href="../../d4/d88/structstate.html">state</a>)</td></tr>
<tr class="separator:acf0d829696b4c54e83e0db72a8d6115a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18fdcfe4b4b4583c43ac56151429bd19"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a18fdcfe4b4b4583c43ac56151429bd19">asterisk_publication_mailboxstate</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub, struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="el" href="../../d0/d8a/muted_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *pubsub_eid, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json)</td></tr>
<tr class="separator:a18fdcfe4b4b4583c43ac56151429bd19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae078c983426e40f08beec994a721a687"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae078c983426e40f08beec994a721a687">asterisk_publication_mwi_refresh</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub, struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="el" href="../../d0/d8a/muted_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *pubsub_eid, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *json)</td></tr>
<tr class="separator:ae078c983426e40f08beec994a721a687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff7a7c696db1a20b65ec992a06c0ed7c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aff7a7c696db1a20b65ec992a06c0ed7c">asterisk_publication_mwi_state_change</a> (struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *pub, pjsip_msg_body *body, enum <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562">ast_sip_publish_state</a> <a class="el" href="../../d4/d88/structstate.html">state</a>)</td></tr>
<tr class="separator:aff7a7c696db1a20b65ec992a06c0ed7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9cc981b192e9f8aaeae3fed03f4c6c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#add9cc981b192e9f8aaeae3fed03f4c6c">asterisk_publication_new</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, const char *resource, const char *event_configuration)</td></tr>
<tr class="separator:add9cc981b192e9f8aaeae3fed03f4c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eb1409f4eea742398544863fd284276"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a6eb1409f4eea742398544863fd284276">asterisk_publication_send_refresh</a> (void)</td></tr>
<tr class="memdesc:a6eb1409f4eea742398544863fd284276"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal function to send refresh requests to all publications.  <a href="#a6eb1409f4eea742398544863fd284276">More...</a><br /></td></tr>
<tr class="separator:a6eb1409f4eea742398544863fd284276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54744c95e39e0fc811e0ef3e09f17164"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a54744c95e39e0fc811e0ef3e09f17164">asterisk_publisher_devstate_cb</a> (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:a54744c95e39e0fc811e0ef3e09f17164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for device state events.  <a href="#a54744c95e39e0fc811e0ef3e09f17164">More...</a><br /></td></tr>
<tr class="separator:a54744c95e39e0fc811e0ef3e09f17164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bb31efe5ad6f5ecf1d8a64332115cab"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3bb31efe5ad6f5ecf1d8a64332115cab">asterisk_publisher_mwistate_cb</a> (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:a3bb31efe5ad6f5ecf1d8a64332115cab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for mailbox state events.  <a href="#a3bb31efe5ad6f5ecf1d8a64332115cab">More...</a><br /></td></tr>
<tr class="separator:a3bb31efe5ad6f5ecf1d8a64332115cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8523fe5f7acfb21272ae5d8540ea7db6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a8523fe5f7acfb21272ae5d8540ea7db6">asterisk_start_devicestate_publishing</a> (struct <a class="el" href="../../d6/d73/structast__sip__outbound__publish.html">ast_sip_outbound_publish</a> *configuration, struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *client)</td></tr>
<tr class="separator:a8523fe5f7acfb21272ae5d8540ea7db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f1eb91c0d170ec6209debabe34a729"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a27f1eb91c0d170ec6209debabe34a729">asterisk_start_mwi_publishing</a> (struct <a class="el" href="../../d6/d73/structast__sip__outbound__publish.html">ast_sip_outbound_publish</a> *configuration, struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *client)</td></tr>
<tr class="separator:a27f1eb91c0d170ec6209debabe34a729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a228cf4bd890d2155c264e1abb40638eb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a228cf4bd890d2155c264e1abb40638eb">asterisk_stop_devicestate_publishing</a> (struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *client)</td></tr>
<tr class="separator:a228cf4bd890d2155c264e1abb40638eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e78451d3636e537c9f34da01b62f2c6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a4e78451d3636e537c9f34da01b62f2c6">asterisk_stop_mwi_publishing</a> (struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *client)</td></tr>
<tr class="separator:a4e78451d3636e537c9f34da01b62f2c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5383b1b80e6d2df56a59122b27ff017"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a> (regex_t *<a class="el" href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a>, const char *<a class="el" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>)</td></tr>
<tr class="separator:ab5383b1b80e6d2df56a59122b27ff017"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa073dd3fd02ac2d0b962a7b040b0b706"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa073dd3fd02ac2d0b962a7b040b0b706">cached_devstate_cb</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:aa073dd3fd02ac2d0b962a7b040b0b706"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa80e2e72f681ff7bff288f322b871487"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa80e2e72f681ff7bff288f322b871487">cached_mwistate_cb</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:aa80e2e72f681ff7bff288f322b871487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ccc2e92e49accab4f22fa8a97a9c87"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a77ccc2e92e49accab4f22fa8a97a9c87">regex_filter_handler</a> (const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *opt, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="el" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, void *obj)</td></tr>
<tr class="separator:a77ccc2e92e49accab4f22fa8a97a9c87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a> (void)</td></tr>
<tr class="separator:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae971c2a576960c2686d9377b127caea9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae971c2a576960c2686d9377b127caea9">send_refresh_cb</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:ae971c2a576960c2686d9377b127caea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Asterisk Event <a class="el" href="../../d1/da4/res__corosync_8c.html#a9bfa8c10a4adec48448b4c49ec5b3cb5abd1a204dcfa4933760cd12e779f36fc5">PUBLISH</a> Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .reload = reload_module, .unload = unload_module, .load_pri = AST_MODPRI_CHANNEL_DEPEND + 5, .requires = &quot;res_pjsip,res_pjsip_outbound_publish,res_pjsip_pubsub&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a065a2a4147e199cb6b86b3f19bc0b184"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a></td></tr>
<tr class="separator:a065a2a4147e199cb6b86b3f19bc0b184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac29f24c7e97bcbb87b802bb1cc2bca82"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/d7d/structast__sip__event__publisher__handler.html">ast_sip_event_publisher_handler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ac29f24c7e97bcbb87b802bb1cc2bca82">asterisk_devicestate_publisher_handler</a></td></tr>
<tr class="separator:ac29f24c7e97bcbb87b802bb1cc2bca82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5bba0c85c012b82bb439cdd3a9b59ce"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae5bba0c85c012b82bb439cdd3a9b59ce">asterisk_devicestate_publisher_state_datastore</a></td></tr>
<tr class="memdesc:ae5bba0c85c012b82bb439cdd3a9b59ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Datastore for attaching devicestate publisher state information.  <a href="#ae5bba0c85c012b82bb439cdd3a9b59ce">More...</a><br /></td></tr>
<tr class="separator:ae5bba0c85c012b82bb439cdd3a9b59ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd29e2fefb02a8d50b2fc6b24b6e1cf"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a></td></tr>
<tr class="separator:aecd29e2fefb02a8d50b2fc6b24b6e1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08c237b30dd3b1ca497ccb5eb0eca8e7"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/d7d/structast__sip__event__publisher__handler.html">ast_sip_event_publisher_handler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a08c237b30dd3b1ca497ccb5eb0eca8e7">asterisk_mwi_publisher_handler</a></td></tr>
<tr class="separator:a08c237b30dd3b1ca497ccb5eb0eca8e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c0ef2a71fb872a04bf13333a0284c5"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae8c0ef2a71fb872a04bf13333a0284c5">asterisk_mwi_publisher_state_datastore</a></td></tr>
<tr class="memdesc:ae8c0ef2a71fb872a04bf13333a0284c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Datastore for attaching devicestate publisher state information.  <a href="#ae8c0ef2a71fb872a04bf13333a0284c5">More...</a><br /></td></tr>
<tr class="separator:ae8c0ef2a71fb872a04bf13333a0284c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00942">942</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00942">942</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00942">942</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="a153cb152b61029edeb05f294cbbc0059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a153cb152b61029edeb05f294cbbc0059">&#9670;&nbsp;</a></span>asterisk_devicestate_publisher_state_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void asterisk_devicestate_publisher_state_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy callback for Asterisk devicestate publisher state information from datastore. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00132">132</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">asterisk_devicestate_publisher_state::client</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00091">asterisk_devicestate_publisher_state::device_state_filter</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00089">asterisk_devicestate_publisher_state::device_state_regex</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a> *publisher_state = obj;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">client</a>);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keywordflow">if</span> (publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#ad194d0988a40ea1a3e7d9495c8c0b003">device_state_filter</a>) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      regfree(&amp;publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a117331eae05adada5f30ca06c94a9572">device_state_regex</a>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div><div class="ttc" id="structasterisk__devicestate__publisher__state_html_a117331eae05adada5f30ca06c94a9572"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a117331eae05adada5f30ca06c94a9572">asterisk_devicestate_publisher_state::device_state_regex</a></div><div class="ttdeci">regex_t device_state_regex</div><div class="ttdoc">Regex used for filtering outbound device state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00089">res_pjsip_publish_asterisk.c:89</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_ad194d0988a40ea1a3e7d9495c8c0b003"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#ad194d0988a40ea1a3e7d9495c8c0b003">asterisk_devicestate_publisher_state::device_state_filter</a></div><div class="ttdeci">unsigned int device_state_filter</div><div class="ttdoc">Device state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00091">res_pjsip_publish_asterisk.c:91</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a5592324b65dd693db5308f4d96e85edf"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">asterisk_devicestate_publisher_state::client</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * client</div><div class="ttdoc">The publish client to send PUBLISH messages on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">res_pjsip_publish_asterisk.c:85</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk device state publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00083">res_pjsip_publish_asterisk.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af15b57d7620dae0cee0a3ad8c9136064"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15b57d7620dae0cee0a3ad8c9136064">&#9670;&nbsp;</a></span>asterisk_mwi_publisher_state_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void asterisk_mwi_publisher_state_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy callback for Asterisk mwi publisher state information from datastore. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00150">150</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00097">asterisk_mwi_publisher_state::client</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00103">asterisk_mwi_publisher_state::mailbox_state_filter</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00101">asterisk_mwi_publisher_state::mailbox_state_regex</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a> *publisher_state = obj;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">client</a>);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="keywordflow">if</span> (publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a6a6cce9017bb79d2c034439cf2ceb27f">mailbox_state_filter</a>) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      regfree(&amp;publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a32af426a78f232ce1dda0d1fd0479319">mailbox_state_regex</a>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div><div class="ttc" id="structasterisk__mwi__publisher__state_html"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk mailbox publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00095">res_pjsip_publish_asterisk.c:95</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a5592324b65dd693db5308f4d96e85edf"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">asterisk_mwi_publisher_state::client</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * client</div><div class="ttdoc">The publish client to send PUBLISH messages on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00097">res_pjsip_publish_asterisk.c:97</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a6a6cce9017bb79d2c034439cf2ceb27f"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a6a6cce9017bb79d2c034439cf2ceb27f">asterisk_mwi_publisher_state::mailbox_state_filter</a></div><div class="ttdeci">unsigned int mailbox_state_filter</div><div class="ttdoc">Mailbox state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00103">res_pjsip_publish_asterisk.c:103</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a32af426a78f232ce1dda0d1fd0479319"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a32af426a78f232ce1dda0d1fd0479319">asterisk_mwi_publisher_state::mailbox_state_regex</a></div><div class="ttdeci">regex_t mailbox_state_regex</div><div class="ttdoc">Regex used for filtering outbound mailbox state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00101">res_pjsip_publish_asterisk.c:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a15bf28546452c2262131fdf61a4919d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15bf28546452c2262131fdf61a4919d2">&#9670;&nbsp;</a></span>asterisk_publication_config_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* asterisk_publication_config_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocator function for Asterisk publication configuration. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00827">827</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01728">ast_sorcery_generic_alloc()</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00353">ast_string_field_init</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00819">asterisk_publication_config_destroy()</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00862">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = <a class="code" href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a>(<span class="keyword">sizeof</span>(*config),</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a14763dabea8aae54b9c519e9225ed8c5">asterisk_publication_config_destroy</a>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="keywordflow">if</span> (!config || <a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(config, 256)) {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(config);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a14763dabea8aae54b9c519e9225ed8c5"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a14763dabea8aae54b9c519e9225ed8c5">asterisk_publication_config_destroy</a></div><div class="ttdeci">static void asterisk_publication_config_destroy(void *obj)</div><div class="ttdoc">Destructor function for Asterisk publication configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00819">res_pjsip_publish_asterisk.c:819</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="sorcery_8h_html_a4c03ccef909474831717c93679065508"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a4c03ccef909474831717c93679065508">ast_sorcery_generic_alloc</a></div><div class="ttdeci">void * ast_sorcery_generic_alloc(size_t size, ao2_destructor_fn destructor)</div><div class="ttdoc">Allocate a generic sorcery capable object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01728">sorcery.c:1728</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14763dabea8aae54b9c519e9225ed8c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14763dabea8aae54b9c519e9225ed8c5">&#9670;&nbsp;</a></span>asterisk_publication_config_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void asterisk_publication_config_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor function for Asterisk publication configuration. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00819">819</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00368">ast_string_field_free_memory</a>, and <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00827">asterisk_publication_config_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;{</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = obj;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(config);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a3a24e5c2296374c30b0a7fb5d95529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a3a24e5c2296374c30b0a7fb5d95529">&#9670;&nbsp;</a></span>asterisk_publication_devicestate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_publication_devicestate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>pubsub_eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00492">492</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../da/da2/devicestate_8h_source.html#l00070">AST_DEVSTATE_CACHABLE</a>, <a class="el" href="../../da/da2/devicestate_8h_source.html#l00069">AST_DEVSTATE_NOT_CACHABLE</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00260">ast_devstate_val()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00322">ast_json_integer_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00273">ast_json_string_get()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00709">ast_publish_device_state_full()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::device_state</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00122">asterisk_publication_config::device_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00120">asterisk_publication_config::device_state_regex</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00594">asterisk_publication_devicestate_state_change()</a>.</p>
<div class="fragment"><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;{</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *device = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;device&quot;</span>));</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d88/structstate.html">state</a> = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;state&quot;</span>));</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="keywordtype">int</span> cachable = <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;cachable&quot;</span>));</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="keywordflow">if</span> (!config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a94510320ab2cca510497b755654f2c4d">device_state</a>) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Received device state event for resource &#39;%s&#39; but it is not configured to accept them\n&quot;</span>,</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config));</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(device) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(state)) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received incomplete device state event for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config));</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="keywordflow">if</span> (config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#ad194d0988a40ea1a3e7d9495c8c0b003">device_state_filter</a> &amp;&amp; regexec(&amp;config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a117331eae05adada5f30ca06c94a9572">device_state_regex</a>, device, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Received device state on resource &#39;%s&#39; for device &#39;%s&#39; but it has been filtered out\n&quot;</span>,</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config), device);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <a class="code" href="../../da/da2/devicestate_8h.html#afe9dc809c9ea4d32dfb4abd5fd92dfb2">ast_publish_device_state_full</a>(device, <a class="code" href="../../da/da2/devicestate_8h.html#ae148e0b95218b57b0348ab53f2f82657">ast_devstate_val</a>(state),</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      cachable == <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a> ? <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a> : <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a4dbd4bd0c7bf0b9d8c3c2c800d39cfc1">AST_DEVSTATE_NOT_CACHABLE</a>,</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      pubsub_eid);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="devicestate_8h_html_ae148e0b95218b57b0348ab53f2f82657"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#ae148e0b95218b57b0348ab53f2f82657">ast_devstate_val</a></div><div class="ttdeci">enum ast_device_state ast_devstate_val(const char *val)</div><div class="ttdoc">Convert device state from text to integer value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00260">devicestate.c:260</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="devicestate_8h_html_afe9dc809c9ea4d32dfb4abd5fd92dfb2"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#afe9dc809c9ea4d32dfb4abd5fd92dfb2">ast_publish_device_state_full</a></div><div class="ttdeci">int ast_publish_device_state_full(const char *device, enum ast_device_state state, enum ast_devstate_cache cachable, struct ast_eid *eid)</div><div class="ttdoc">Publish a device state update with EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00709">devicestate.c:709</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_ad194d0988a40ea1a3e7d9495c8c0b003"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#ad194d0988a40ea1a3e7d9495c8c0b003">asterisk_publication_config::device_state_filter</a></div><div class="ttdeci">unsigned int device_state_filter</div><div class="ttdoc">Device state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00122">res_pjsip_publish_asterisk.c:122</a></div></div>
<div class="ttc" id="devicestate_8h_html_a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00070">devicestate.h:70</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="devicestate_8h_html_a26cbac580d3e86b529f90058f6e91ac7a4dbd4bd0c7bf0b9d8c3c2c800d39cfc1"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a4dbd4bd0c7bf0b9d8c3c2c800d39cfc1">AST_DEVSTATE_NOT_CACHABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00069">devicestate.h:69</a></div></div>
<div class="ttc" id="json_8h_html_ad20fdcbab1ed5c078284a687cced2877"><div class="ttname"><a href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a></div><div class="ttdeci">intmax_t ast_json_integer_get(const struct ast_json *integer)</div><div class="ttdoc">Get the value from a JSON integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00322">json.c:322</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a94510320ab2cca510497b755654f2c4d"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a94510320ab2cca510497b755654f2c4d">asterisk_publication_config::device_state</a></div><div class="ttdeci">unsigned int device_state</div><div class="ttdoc">Accept inbound device state events. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">res_pjsip_publish_asterisk.c:116</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a117331eae05adada5f30ca06c94a9572"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a117331eae05adada5f30ca06c94a9572">asterisk_publication_config::device_state_regex</a></div><div class="ttdeci">regex_t device_state_regex</div><div class="ttdoc">Regex used for filtering inbound device state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00120">res_pjsip_publish_asterisk.c:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dab8946fa4eb59b953b090ffd62a063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dab8946fa4eb59b953b090ffd62a063">&#9670;&nbsp;</a></span>asterisk_publication_devicestate_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_publication_devicestate_refresh </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>pubsub_eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00559">559</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00673">ast_device_state_cache()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00528">ast_sip_publish_client_get()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">ast_sip_publish_client_get_datastore()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00285">cached_devstate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">asterisk_devicestate_publisher_state::client</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::devicestate_publish</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache_dump()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00594">asterisk_publication_devicestate_state_change()</a>.</p>
<div class="fragment"><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *client;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *cached;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#acaeb988872c220dfdc34e4bc538abc33">devicestate_publish</a>)) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   client = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#aefd7c57ffa48b8af08a6037348cc8051">ast_sip_publish_client_get</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#acaeb988872c220dfdc34e4bc538abc33">devicestate_publish</a>);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="keywordflow">if</span> (!client) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Received refresh request for devicestate on publication &#39;%s&#39; but publish &#39;%s&#39; is not available\n&quot;</span>,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config), config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#acaeb988872c220dfdc34e4bc538abc33">devicestate_publish</a>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   datastore = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a>(client, <span class="stringliteral">&quot;asterisk-devicestate-publisher&quot;</span>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client, -1);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   cached = <a class="code" href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a>(<a class="code" href="../../da/da2/devicestate_8h.html#a52892d3b3fec63dbcf67954d8c3589d5">ast_device_state_cache</a>(), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <span class="keywordflow">if</span> (cached) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cached, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa073dd3fd02ac2d0b962a7b040b0b706">cached_devstate_cb</a>, datastore);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cached, -1);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client, -1);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, -1);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_aefd7c57ffa48b8af08a6037348cc8051"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#aefd7c57ffa48b8af08a6037348cc8051">ast_sip_publish_client_get</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * ast_sip_publish_client_get(const char *name)</div><div class="ttdoc">Find a publish client using its name. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00528">res_pjsip_outbound_publish.c:528</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="stasis_8h_html_a8c5612920b22beb93b5e8acbdae40078"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a></div><div class="ttdeci">struct ao2_container * stasis_cache_dump(struct stasis_cache *cache, struct stasis_message_type *type)</div><div class="ttdoc">Dump cached items to a subscription for the ast_eid_default entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache.c:736</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__outbound__publish__client_html"><div class="ttname"><a href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a></div><div class="ttdoc">Outbound publish client state information (persists for lifetime of a publish) </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00228">res_pjsip_outbound_publish.c:228</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_ac8dca3a60f8f4b4be12867de93989b85"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a></div><div class="ttdeci">struct ast_datastore * ast_sip_publish_client_get_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Retrieve an event publisher datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">res_pjsip_outbound_publish.c:737</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="devicestate_8h_html_a52892d3b3fec63dbcf67954d8c3589d5"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a52892d3b3fec63dbcf67954d8c3589d5">ast_device_state_cache</a></div><div class="ttdeci">struct stasis_cache * ast_device_state_cache(void)</div><div class="ttdoc">Backend cache for ast_device_state_topic_cached() </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00673">devicestate.c:673</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_aa073dd3fd02ac2d0b962a7b040b0b706"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa073dd3fd02ac2d0b962a7b040b0b706">cached_devstate_cb</a></div><div class="ttdeci">static int cached_devstate_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00285">res_pjsip_publish_asterisk.c:285</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_acaeb988872c220dfdc34e4bc538abc33"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#acaeb988872c220dfdc34e4bc538abc33">asterisk_publication_config::devicestate_publish</a></div><div class="ttdeci">const ast_string_field devicestate_publish</div><div class="ttdoc">Optional name of a device state publish item struct ast_string_field_mgr __field_mgr used to request ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">res_pjsip_publish_asterisk.c:116</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acf0d829696b4c54e83e0db72a8d6115a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf0d829696b4c54e83e0db72a8d6115a">&#9670;&nbsp;</a></span>asterisk_publication_devicestate_state_change()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_publication_devicestate_state_change </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_msg_body *&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562">ast_sip_publish_state</a>&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00594">594</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00564">ast_json_load_buf()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00273">ast_json_string_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05259">ast_sip_is_content_type()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03430">ast_sip_publication_get_event_configuration()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02825">ast_str_to_eid()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00492">asterisk_publication_devicestate()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00559">asterisk_publication_devicestate_refresh()</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>
<div class="fragment"><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *, <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>,</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#ada9f3d03df5f52f4aeb09f6d952f46de">ast_sip_publication_get_event_configuration</a>(pub)), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, json, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *eid, *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d86/structast__eid.html">ast_eid</a> pubsub_eid;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   <span class="comment">/* If no configuration exists for this publication it has most likely been removed, so drop this immediately */</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>) {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   <span class="comment">/* If no body exists this is a refresh and can be ignored */</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <span class="keywordflow">if</span> (!body) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="comment">/* We only accept JSON for content */</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a>(&amp;body-&gt;content_type, <span class="stringliteral">&quot;application&quot;</span>, <span class="stringliteral">&quot;json&quot;</span>)) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Received unsupported content type for Asterisk event on resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   json = <a class="code" href="../../d4/d05/json_8h.html#aa1ad8d1561851ac6a4e97e82025266e4">ast_json_load_buf</a>(body-&gt;data, body-&gt;len, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received unparseable JSON event for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   eid = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;eid&quot;</span>));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="keywordflow">if</span> (!eid) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received event without eid for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#ad60a8c795e1f64b7beeed705425c555f">ast_str_to_eid</a>(&amp;pubsub_eid, eid);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   type = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;type&quot;</span>));</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received event without type for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(type, <span class="stringliteral">&quot;devicestate&quot;</span>)) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      res = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a8a3a24e5c2296374c30b0a7fb5d95529">asterisk_publication_devicestate</a>(pub, <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, &amp;pubsub_eid, json);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(type, <span class="stringliteral">&quot;refresh&quot;</span>)) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      res = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3dab8946fa4eb59b953b090ffd62a063">asterisk_publication_devicestate_refresh</a>(pub, <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, &amp;pubsub_eid, json);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="json_8h_html_aa1ad8d1561851ac6a4e97e82025266e4"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa1ad8d1561851ac6a4e97e82025266e4">ast_json_load_buf</a></div><div class="ttdeci">struct ast_json * ast_json_load_buf(const char *buffer, size_t buflen, struct ast_json_error *error)</div><div class="ttdoc">Parse buffer with known length into a JSON object or array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00564">json.c:564</a></div></div>
<div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a3dab8946fa4eb59b953b090ffd62a063"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3dab8946fa4eb59b953b090ffd62a063">asterisk_publication_devicestate_refresh</a></div><div class="ttdeci">static int asterisk_publication_devicestate_refresh(struct ast_sip_publication *pub, struct asterisk_publication_config *config, struct ast_eid *pubsub_eid, struct ast_json *json)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00559">res_pjsip_publish_asterisk.c:559</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__eid_html"><div class="ttname"><a href="../../d0/d86/structast__eid.html">ast_eid</a></div><div class="ttdoc">An Entity ID is essentially a MAC address, brief and unique. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00786">utils.h:786</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_ada9f3d03df5f52f4aeb09f6d952f46de"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#ada9f3d03df5f52f4aeb09f6d952f46de">ast_sip_publication_get_event_configuration</a></div><div class="ttdeci">const char * ast_sip_publication_get_event_configuration(const struct ast_sip_publication *pub)</div><div class="ttdoc">Given a publication, get the configuration name for the event type in use. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03430">res_pjsip_pubsub.c:3430</a></div></div>
<div class="ttc" id="utils_8h_html_ad60a8c795e1f64b7beeed705425c555f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad60a8c795e1f64b7beeed705425c555f">ast_str_to_eid</a></div><div class="ttdeci">int ast_str_to_eid(struct ast_eid *eid, const char *s)</div><div class="ttdoc">Convert a string into an EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02825">main/utils.c:2825</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ae47a39537fdf10ceba2fad9d9c380179"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a></div><div class="ttdeci">int ast_sip_is_content_type(pjsip_media_type *content_type, char *type, char *subtype)</div><div class="ttdoc">Checks if the given content type matches type/subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05259">res_pjsip.c:5259</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a8a3a24e5c2296374c30b0a7fb5d95529"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a8a3a24e5c2296374c30b0a7fb5d95529">asterisk_publication_devicestate</a></div><div class="ttdeci">static int asterisk_publication_devicestate(struct ast_sip_publication *pub, struct asterisk_publication_config *config, struct ast_eid *pubsub_eid, struct ast_json *json)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00492">res_pjsip_publish_asterisk.c:492</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a18fdcfe4b4b4583c43ac56151429bd19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18fdcfe4b4b4583c43ac56151429bd19">&#9670;&nbsp;</a></span>asterisk_publication_mailboxstate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_publication_mailboxstate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>pubsub_eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00524">524</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00322">ast_json_integer_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00273">ast_json_string_get()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00388">ast_publish_mwi_state_full()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l00204">mailbox</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00124">asterisk_publication_config::mailbox_state</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00128">asterisk_publication_config::mailbox_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00126">asterisk_publication_config::mailbox_state_regex</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00685">asterisk_publication_mwi_state_change()</a>.</p>
<div class="fragment"><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;{</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *uniqueid = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;uniqueid&quot;</span>));</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="keywordtype">int</span> old_msgs = <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;old&quot;</span>));</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <span class="keywordtype">int</span> new_msgs = <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;new&quot;</span>));</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <span class="keywordtype">char</span> *item_id;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="keywordflow">if</span> (!config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a72a4cb17896bbf1ce992a78c38180f02">mailbox_state</a>) {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Received mailbox state event for resource &#39;%s&#39; but it is not configured to accept them\n&quot;</span>,</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config));</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uniqueid)) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received incomplete mailbox state event for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config));</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="keywordflow">if</span> (config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a6a6cce9017bb79d2c034439cf2ceb27f">mailbox_state_filter</a> &amp;&amp; regexec(&amp;config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a32af426a78f232ce1dda0d1fd0479319">mailbox_state_regex</a>, uniqueid, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Received mailbox state on resource &#39;%s&#39; for uniqueid &#39;%s&#39; but it has been filtered out\n&quot;</span>,</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config), uniqueid);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   item_id = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(uniqueid);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   mailbox = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;item_id, <span class="stringliteral">&quot;@&quot;</span>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <a class="code" href="../../dc/d33/mwi_8h.html#a889083170a9d78ccdbfbcb75406ed98d">ast_publish_mwi_state_full</a>(mailbox, item_id, new_msgs, old_msgs, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, pubsub_eid);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div><div class="ttc" id="structasterisk__publication__config_html_a72a4cb17896bbf1ce992a78c38180f02"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a72a4cb17896bbf1ce992a78c38180f02">asterisk_publication_config::mailbox_state</a></div><div class="ttdeci">unsigned int mailbox_state</div><div class="ttdoc">Accept inbound mailbox state events. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00124">res_pjsip_publish_asterisk.c:124</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a6a6cce9017bb79d2c034439cf2ceb27f"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a6a6cce9017bb79d2c034439cf2ceb27f">asterisk_publication_config::mailbox_state_filter</a></div><div class="ttdeci">unsigned int mailbox_state_filter</div><div class="ttdoc">Mailbox state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00128">res_pjsip_publish_asterisk.c:128</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a32af426a78f232ce1dda0d1fd0479319"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a32af426a78f232ce1dda0d1fd0479319">asterisk_publication_config::mailbox_state_regex</a></div><div class="ttdeci">regex_t mailbox_state_regex</div><div class="ttdoc">Regex used for filtering inbound mailbox state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00126">res_pjsip_publish_asterisk.c:126</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a6b49cafa2a3d359a2e865992f551874a"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a></div><div class="ttdeci">static char mailbox[AST_MAX_MAILBOX_UNIQUEID]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00204">chan_mgcp.c:204</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="mwi_8h_html_a889083170a9d78ccdbfbcb75406ed98d"><div class="ttname"><a href="../../dc/d33/mwi_8h.html#a889083170a9d78ccdbfbcb75406ed98d">ast_publish_mwi_state_full</a></div><div class="ttdeci">int ast_publish_mwi_state_full(const char *mailbox, const char *context, int new_msgs, int old_msgs, const char *channel_id, struct ast_eid *eid)</div><div class="ttdoc">Publish a MWI state update via stasis with all parameters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/mwi_8c_source.html#l00388">mwi.c:388</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="json_8h_html_ad20fdcbab1ed5c078284a687cced2877"><div class="ttname"><a href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a></div><div class="ttdeci">intmax_t ast_json_integer_get(const struct ast_json *integer)</div><div class="ttdoc">Get the value from a JSON integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00322">json.c:322</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae078c983426e40f08beec994a721a687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae078c983426e40f08beec994a721a687">&#9670;&nbsp;</a></span>asterisk_publication_mwi_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_publication_mwi_refresh </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>pubsub_eid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>json</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00650">650</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00090">ast_mwi_state_cache()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00528">ast_sip_publish_client_get()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">ast_sip_publish_client_get_datastore()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00296">cached_mwistate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">asterisk_devicestate_publisher_state::client</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::mailboxstate_publish</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache_dump()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00685">asterisk_publication_mwi_state_change()</a>.</p>
<div class="fragment"><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;{</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *client;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *cached;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a6871330fea353e00feaccea7712a0b21">mailboxstate_publish</a>)) {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   client = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#aefd7c57ffa48b8af08a6037348cc8051">ast_sip_publish_client_get</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a6871330fea353e00feaccea7712a0b21">mailboxstate_publish</a>);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keywordflow">if</span> (!client) {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Received refresh request for mwi state on publication &#39;%s&#39; but publish &#39;%s&#39; is not available\n&quot;</span>,</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(config), config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a6871330fea353e00feaccea7712a0b21">mailboxstate_publish</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   datastore = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a>(client, <span class="stringliteral">&quot;asterisk-mwi-publisher&quot;</span>);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client, -1);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   cached = <a class="code" href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7fc6473ab80d2117f1bcb1359721fdce">ast_mwi_state_cache</a>(), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keywordflow">if</span> (cached) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cached, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa80e2e72f681ff7bff288f322b871487">cached_mwistate_cb</a>, datastore);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cached, -1);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client, -1);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, -1);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div><div class="ttc" id="structasterisk__publication__config_html_a6871330fea353e00feaccea7712a0b21"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a6871330fea353e00feaccea7712a0b21">asterisk_publication_config::mailboxstate_publish</a></div><div class="ttdeci">const ast_string_field mailboxstate_publish</div><div class="ttdoc">Optional name of a mailbox state publish item, used to request the remote side update us...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">res_pjsip_publish_asterisk.c:116</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7fc6473ab80d2117f1bcb1359721fdce"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7fc6473ab80d2117f1bcb1359721fdce">ast_mwi_state_cache</a></div><div class="ttdeci">struct stasis_cache * ast_mwi_state_cache(void)</div><div class="ttdoc">Backend cache for ast_mwi_topic_cached(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/mwi_8c_source.html#l00090">mwi.c:90</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_aefd7c57ffa48b8af08a6037348cc8051"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#aefd7c57ffa48b8af08a6037348cc8051">ast_sip_publish_client_get</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * ast_sip_publish_client_get(const char *name)</div><div class="ttdoc">Find a publish client using its name. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00528">res_pjsip_outbound_publish.c:528</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="stasis_8h_html_a8c5612920b22beb93b5e8acbdae40078"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a></div><div class="ttdeci">struct ao2_container * stasis_cache_dump(struct stasis_cache *cache, struct stasis_message_type *type)</div><div class="ttdoc">Dump cached items to a subscription for the ast_eid_default entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache.c:736</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__outbound__publish__client_html"><div class="ttname"><a href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a></div><div class="ttdoc">Outbound publish client state information (persists for lifetime of a publish) </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00228">res_pjsip_outbound_publish.c:228</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_ac8dca3a60f8f4b4be12867de93989b85"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a></div><div class="ttdeci">struct ast_datastore * ast_sip_publish_client_get_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Retrieve an event publisher datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">res_pjsip_outbound_publish.c:737</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_aa80e2e72f681ff7bff288f322b871487"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa80e2e72f681ff7bff288f322b871487">cached_mwistate_cb</a></div><div class="ttdeci">static int cached_mwistate_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00296">res_pjsip_publish_asterisk.c:296</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff7a7c696db1a20b65ec992a06c0ed7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff7a7c696db1a20b65ec992a06c0ed7c">&#9670;&nbsp;</a></span>asterisk_publication_mwi_state_change()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_publication_mwi_state_change </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/da6/structast__sip__publication.html">ast_sip_publication</a> *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_msg_body *&#160;</td>
          <td class="paramname"><em>body</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h.html#a0a56204d9bae50c4103725ef62aab562">ast_sip_publish_state</a>&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00685">685</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00564">ast_json_load_buf()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00273">ast_json_string_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05259">ast_sip_is_content_type()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03430">ast_sip_publication_get_event_configuration()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02825">ast_str_to_eid()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00524">asterisk_publication_mailboxstate()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00650">asterisk_publication_mwi_refresh()</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *, <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#ada9f3d03df5f52f4aeb09f6d952f46de">ast_sip_publication_get_event_configuration</a>(pub)), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, json, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *eid, *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d86/structast__eid.html">ast_eid</a> pubsub_eid;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <span class="comment">/* If no configuration exists for this publication it has most likely been removed, so drop this immediately */</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="comment">/* If no body exists this is a refresh and can be ignored */</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordflow">if</span> (!body) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="comment">/* We only accept JSON for content */</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a>(&amp;body-&gt;content_type, <span class="stringliteral">&quot;application&quot;</span>, <span class="stringliteral">&quot;json&quot;</span>)) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Received unsupported content type for Asterisk event on resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   json = <a class="code" href="../../d4/d05/json_8h.html#aa1ad8d1561851ac6a4e97e82025266e4">ast_json_load_buf</a>(body-&gt;data, body-&gt;len, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received unparseable JSON event for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   eid = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;eid&quot;</span>));</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="keywordflow">if</span> (!eid) {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received event without eid for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#ad60a8c795e1f64b7beeed705425c555f">ast_str_to_eid</a>(&amp;pubsub_eid, eid);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   type = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;type&quot;</span>));</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Received event without type for resource &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>));</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(type, <span class="stringliteral">&quot;mailboxstate&quot;</span>)) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      res = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a18fdcfe4b4b4583c43ac56151429bd19">asterisk_publication_mailboxstate</a>(pub, <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, &amp;pubsub_eid, json);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(type, <span class="stringliteral">&quot;refresh&quot;</span>)) {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      res = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae078c983426e40f08beec994a721a687">asterisk_publication_mwi_refresh</a>(pub, <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, &amp;pubsub_eid, json);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ae078c983426e40f08beec994a721a687"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae078c983426e40f08beec994a721a687">asterisk_publication_mwi_refresh</a></div><div class="ttdeci">static int asterisk_publication_mwi_refresh(struct ast_sip_publication *pub, struct asterisk_publication_config *config, struct ast_eid *pubsub_eid, struct ast_json *json)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00650">res_pjsip_publish_asterisk.c:650</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="json_8h_html_aa1ad8d1561851ac6a4e97e82025266e4"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa1ad8d1561851ac6a4e97e82025266e4">ast_json_load_buf</a></div><div class="ttdeci">struct ast_json * ast_json_load_buf(const char *buffer, size_t buflen, struct ast_json_error *error)</div><div class="ttdoc">Parse buffer with known length into a JSON object or array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00564">json.c:564</a></div></div>
<div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__eid_html"><div class="ttname"><a href="../../d0/d86/structast__eid.html">ast_eid</a></div><div class="ttdoc">An Entity ID is essentially a MAC address, brief and unique. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00786">utils.h:786</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_ada9f3d03df5f52f4aeb09f6d952f46de"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#ada9f3d03df5f52f4aeb09f6d952f46de">ast_sip_publication_get_event_configuration</a></div><div class="ttdeci">const char * ast_sip_publication_get_event_configuration(const struct ast_sip_publication *pub)</div><div class="ttdoc">Given a publication, get the configuration name for the event type in use. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l03430">res_pjsip_pubsub.c:3430</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a18fdcfe4b4b4583c43ac56151429bd19"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a18fdcfe4b4b4583c43ac56151429bd19">asterisk_publication_mailboxstate</a></div><div class="ttdeci">static int asterisk_publication_mailboxstate(struct ast_sip_publication *pub, struct asterisk_publication_config *config, struct ast_eid *pubsub_eid, struct ast_json *json)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00524">res_pjsip_publish_asterisk.c:524</a></div></div>
<div class="ttc" id="utils_8h_html_ad60a8c795e1f64b7beeed705425c555f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad60a8c795e1f64b7beeed705425c555f">ast_str_to_eid</a></div><div class="ttdeci">int ast_str_to_eid(struct ast_eid *eid, const char *s)</div><div class="ttdoc">Convert a string into an EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02825">main/utils.c:2825</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ae47a39537fdf10ceba2fad9d9c380179"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a></div><div class="ttdeci">int ast_sip_is_content_type(pjsip_media_type *content_type, char *type, char *subtype)</div><div class="ttdoc">Checks if the given content type matches type/subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05259">res_pjsip.c:5259</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add9cc981b192e9f8aaeae3fed03f4c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9cc981b192e9f8aaeae3fed03f4c6c">&#9670;&nbsp;</a></span>asterisk_publication_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_publication_new </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>event_configuration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00479">479</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>
<div class="fragment"><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;{</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *, <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      event_configuration), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="comment">/* If no inbound Asterisk publication configuration exists reject the PUBLISH */</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>) {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">return</span> 404;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordflow">return</span> 200;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6eb1409f4eea742398544863fd284276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eb1409f4eea742398544863fd284276">&#9670;&nbsp;</a></span>asterisk_publication_send_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void asterisk_publication_send_refresh </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal function to send refresh requests to all publications. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00766">766</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02587">ast_eid_to_str()</a>, <a class="el" href="../../d4/d05/json_8h_source.html#l00763">ast_json_dump_string</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00052">ast_json_free()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00591">ast_json_pack()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00123">AST_RETRIEVE_FLAG_ALL</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00120">AST_RETRIEVE_FLAG_MULTIPLE</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01897">ast_sorcery_retrieve_by_fields()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02033">ast_sip_body::body_text</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00741">send_refresh_cb()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01508">text</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02029">ast_sip_body::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00862">load_module()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00918">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;{</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *publications = <a class="code" href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a> | <a class="code" href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="keywordtype">char</span> eid_str[20];</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d80/structast__sip__body.html">ast_sip_body</a> body = {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      .<a class="code" href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a> = <span class="stringliteral">&quot;application&quot;</span>,</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      .subtype = <span class="stringliteral">&quot;json&quot;</span>,</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   };</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   <span class="keywordflow">if</span> (!publications) {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   }</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a>(eid_str, <span class="keyword">sizeof</span>(eid_str), &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   json = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="stringliteral">&quot;{ s: s, s: s }&quot;</span>,</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;refresh&quot;</span>,</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="stringliteral">&quot;eid&quot;</span>, eid_str);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(publications, -1);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   text = <a class="code" href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a>(json);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <span class="keywordflow">if</span> (!text) {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(publications, -1);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   body.<a class="code" href="../../d5/d80/structast__sip__body.html#a88687b0dd98d5307f1219432b73b8412">body_text</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(publications, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae971c2a576960c2686d9377b127caea9">send_refresh_cb</a>, &amp;body);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a>(text);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(publications, -1);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div><div class="ttc" id="structast__sip__body_html_a88687b0dd98d5307f1219432b73b8412"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a88687b0dd98d5307f1219432b73b8412">ast_sip_body::body_text</a></div><div class="ttdeci">const char * body_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02033">res_pjsip.h:2033</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ae971c2a576960c2686d9377b127caea9"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae971c2a576960c2686d9377b127caea9">send_refresh_cb</a></div><div class="ttdeci">static int send_refresh_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00741">res_pjsip_publish_asterisk.c:741</a></div></div>
<div class="ttc" id="utils_8h_html_a8ebf6841073ea2a063a0c86a5092a85b"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a></div><div class="ttdeci">char * ast_eid_to_str(char *s, int maxlen, struct ast_eid *eid)</div><div class="ttdoc">Convert an EID to a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02587">main/utils.c:2587</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="json_8h_html_a38eea5afa847432f7c10af8e69fb013e"><div class="ttname"><a href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a></div><div class="ttdeci">void ast_json_free(void *p)</div><div class="ttdoc">Asterisk&amp;#39;s custom JSON allocator. Exposed for use by unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00052">json.c:52</a></div></div>
<div class="ttc" id="json_8h_html_a51a96b2baa67b671ac68a9fcaebbaeea"><div class="ttname"><a href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a></div><div class="ttdeci">#define ast_json_dump_string(root)</div><div class="ttdoc">Encode a JSON value to a compact string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00763">json.h:763</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a643c7c50af2691bb16052509d47b61cd">AST_RETRIEVE_FLAG_ALL</a></div><div class="ttdoc">Perform no matching, return all objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00123">sorcery.h:123</a></div></div>
<div class="ttc" id="sorcery_8h_html_a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a320e98591a38316a313a3ca83ea8df20a019a4a531b83f4ab0b35a3c788bf8d55">AST_RETRIEVE_FLAG_MULTIPLE</a></div><div class="ttdoc">Return all matching objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00120">sorcery.h:120</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__body_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_body::type</a></div><div class="ttdeci">const char * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02029">res_pjsip.h:2029</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_aaa9cd237841a70862001f580b23212c9"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aaa9cd237841a70862001f580b23212c9">ast_sorcery_retrieve_by_fields</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_fields(const struct ast_sorcery *sorcery, const char *type, unsigned int flags, struct ast_variable *fields)</div><div class="ttdoc">Retrieve an object or multiple objects using specific fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01897">sorcery.c:1897</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="structast__sip__body_html"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html">ast_sip_body</a></div><div class="ttdoc">SIP body description. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02027">res_pjsip.h:2027</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54744c95e39e0fc811e0ef3e09f17164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54744c95e39e0fc811e0ef3e09f17164">&#9670;&nbsp;</a></span>asterisk_publisher_devstate_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void asterisk_publisher_devstate_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function for device state events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="../../d5/d78/structast__event.html" title="An event. ">ast_event</a></td><td></td></tr>
    <tr><td class="paramname">data</td><td>void pointer to ast_client structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">173</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00255">ast_devstate_str()</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02587">ast_eid_to_str()</a>, <a class="el" href="../../d4/d05/json_8h_source.html#l00763">ast_json_dump_string</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00052">ast_json_free()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00591">ast_json_pack()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00842">ast_sip_publish_client_send()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02033">ast_sip_body::body_text</a>, <a class="el" href="../../da/da2/devicestate_8h_source.html#l00252">ast_device_state_message::cachable</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">asterisk_devicestate_publisher_state::client</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00070">ast_datastore::data</a>, <a class="el" href="../../da/da2/devicestate_8h_source.html#l00242">ast_device_state_message::device</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00091">asterisk_devicestate_publisher_state::device_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00089">asterisk_devicestate_publisher_state::device_state_regex</a>, <a class="el" href="../../da/da2/devicestate_8h_source.html#l00248">ast_device_state_message::eid</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01152">stasis_subscription_is_subscribed()</a>, <a class="el" href="../../da/da2/devicestate_8h_source.html#l00250">ast_device_state_message::state</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01508">text</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02029">ast_sip_body::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00285">cached_devstate_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore = <a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a> *publisher_state = datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d92/structast__device__state__message.html">ast_device_state_message</a> *dev_state;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keywordtype">char</span> eid_str[20];</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d80/structast__sip__body.html">ast_sip_body</a> body = {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      .<a class="code" href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a> = <span class="stringliteral">&quot;application&quot;</span>,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      .subtype = <span class="stringliteral">&quot;json&quot;</span>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   };</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a>(sub) || <a class="code" href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type</a>() != <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(msg)) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   dev_state = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="keywordflow">if</span> (!dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a39d1b63955a48c72508fa9f884d05762">eid</a> || <a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(&amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>, dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a39d1b63955a48c72508fa9f884d05762">eid</a>)) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">/* If the event is aggregate or didn&#39;t originate from this server, don&#39;t send it out. */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordflow">if</span> (publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#ad194d0988a40ea1a3e7d9495c8c0b003">device_state_filter</a> &amp;&amp; regexec(&amp;publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a117331eae05adada5f30ca06c94a9572">device_state_regex</a>, dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a8059c3b19eb356cf729e5d25b139647e">device</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="comment">/* Outgoing device state has been filtered and the device name does not match */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a>(eid_str, <span class="keyword">sizeof</span>(eid_str), &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   json = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="stringliteral">&quot;{ s: s, s: s, s: s, s: i, s:s }&quot;</span>,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;devicestate&quot;</span>,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="stringliteral">&quot;device&quot;</span>, dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a8059c3b19eb356cf729e5d25b139647e">device</a>,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="stringliteral">&quot;state&quot;</span>, <a class="code" href="../../da/da2/devicestate_8h.html#a6190de57ac370315e51f2c46724d5b10">ast_devstate_str</a>(dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">state</a>),</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="stringliteral">&quot;cachable&quot;</span>, dev_state-&gt;<a class="code" href="../../db/d92/structast__device__state__message.html#ac2f672c1450e8212e5462a749d393b0b">cachable</a>,</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="stringliteral">&quot;eid&quot;</span>, eid_str);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   text = <a class="code" href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a>(json);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="keywordflow">if</span> (!text) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   body.<a class="code" href="../../d5/d80/structast__sip__body.html#a88687b0dd98d5307f1219432b73b8412">body_text</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a4fc13fb50475b59d055cbec2d8ece47c">ast_sip_publish_client_send</a>(publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">client</a>, &amp;body);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a>(text);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div><div class="ttc" id="structast__sip__body_html_a88687b0dd98d5307f1219432b73b8412"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a88687b0dd98d5307f1219432b73b8412">ast_sip_body::body_text</a></div><div class="ttdeci">const char * body_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02033">res_pjsip.h:2033</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="utils_8h_html_a8ebf6841073ea2a063a0c86a5092a85b"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a></div><div class="ttdeci">char * ast_eid_to_str(char *s, int maxlen, struct ast_eid *eid)</div><div class="ttdoc">Convert an EID to a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02587">main/utils.c:2587</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a117331eae05adada5f30ca06c94a9572"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a117331eae05adada5f30ca06c94a9572">asterisk_devicestate_publisher_state::device_state_regex</a></div><div class="ttdeci">regex_t device_state_regex</div><div class="ttdoc">Regex used for filtering outbound device state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00089">res_pjsip_publish_asterisk.c:89</a></div></div>
<div class="ttc" id="json_8h_html_a38eea5afa847432f7c10af8e69fb013e"><div class="ttname"><a href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a></div><div class="ttdeci">void ast_json_free(void *p)</div><div class="ttdoc">Asterisk&amp;#39;s custom JSON allocator. Exposed for use by unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00052">json.c:52</a></div></div>
<div class="ttc" id="structast__device__state__message_html_a1acd064aff48cf4d5eafec1030f8429d"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html#a1acd064aff48cf4d5eafec1030f8429d">ast_device_state_message::state</a></div><div class="ttdeci">enum ast_device_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00250">devicestate.h:250</a></div></div>
<div class="ttc" id="stasis_8h_html_acd5bedbb2212956dac77be47dceef510"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a></div><div class="ttdeci">int stasis_subscription_is_subscribed(const struct stasis_subscription *sub)</div><div class="ttdoc">Returns whether a subscription is currently subscribed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01152">stasis.c:1152</a></div></div>
<div class="ttc" id="json_8h_html_a51a96b2baa67b671ac68a9fcaebbaeea"><div class="ttname"><a href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a></div><div class="ttdeci">#define ast_json_dump_string(root)</div><div class="ttdoc">Encode a JSON value to a compact string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00763">json.h:763</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="structast__device__state__message_html_ac2f672c1450e8212e5462a749d393b0b"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html#ac2f672c1450e8212e5462a749d393b0b">ast_device_state_message::cachable</a></div><div class="ttdeci">enum ast_devstate_cache cachable</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00252">devicestate.h:252</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="devicestate_8h_html_a9459272db1c8c968ed1aff1387f0f9fd"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type</a></div><div class="ttdeci">struct stasis_message_type * ast_device_state_message_type(void)</div><div class="ttdoc">Get the Stasis message type for device state messages. </div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a4fc13fb50475b59d055cbec2d8ece47c"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a4fc13fb50475b59d055cbec2d8ece47c">ast_sip_publish_client_send</a></div><div class="ttdeci">int ast_sip_publish_client_send(struct ast_sip_outbound_publish_client *client, const struct ast_sip_body *body)</div><div class="ttdoc">Send an outgoing PUBLISH message using a client. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00842">res_pjsip_outbound_publish.c:842</a></div></div>
<div class="ttc" id="structast__device__state__message_html_a39d1b63955a48c72508fa9f884d05762"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html#a39d1b63955a48c72508fa9f884d05762">ast_device_state_message::eid</a></div><div class="ttdeci">const struct ast_eid * eid</div><div class="ttdoc">The EID of the server where this message originated. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00248">devicestate.h:248</a></div></div>
<div class="ttc" id="structast__sip__body_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_body::type</a></div><div class="ttdeci">const char * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02029">res_pjsip.h:2029</a></div></div>
<div class="ttc" id="structast__device__state__message_html_a8059c3b19eb356cf729e5d25b139647e"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html#a8059c3b19eb356cf729e5d25b139647e">ast_device_state_message::device</a></div><div class="ttdeci">const char * device</div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00242">devicestate.h:242</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_ad194d0988a40ea1a3e7d9495c8c0b003"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#ad194d0988a40ea1a3e7d9495c8c0b003">asterisk_devicestate_publisher_state::device_state_filter</a></div><div class="ttdeci">unsigned int device_state_filter</div><div class="ttdoc">Device state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00091">res_pjsip_publish_asterisk.c:91</a></div></div>
<div class="ttc" id="devicestate_8h_html_a6190de57ac370315e51f2c46724d5b10"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a6190de57ac370315e51f2c46724d5b10">ast_devstate_str</a></div><div class="ttdeci">const char * ast_devstate_str(enum ast_device_state devstate) attribute_pure</div><div class="ttdoc">Convert device state to text string that is easier to parse. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00255">devicestate.c:255</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a5592324b65dd693db5308f4d96e85edf"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">asterisk_devicestate_publisher_state::client</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * client</div><div class="ttdoc">The publish client to send PUBLISH messages on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">res_pjsip_publish_asterisk.c:85</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk device state publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00083">res_pjsip_publish_asterisk.c:83</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="structast__datastore_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">ast_datastore::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00070">datastore.h:70</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="structast__device__state__message_html"><div class="ttname"><a href="../../db/d92/structast__device__state__message.html">ast_device_state_message</a></div><div class="ttdoc">The structure that contains device state. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00240">devicestate.h:240</a></div></div>
<div class="ttc" id="structast__sip__body_html"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html">ast_sip_body</a></div><div class="ttdoc">SIP body description. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02027">res_pjsip.h:2027</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bb31efe5ad6f5ecf1d8a64332115cab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bb31efe5ad6f5ecf1d8a64332115cab">&#9670;&nbsp;</a></span>asterisk_publisher_mwistate_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void asterisk_publisher_mwistate_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function for mailbox state events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="../../d5/d78/structast__event.html" title="An event. ">ast_event</a></td><td></td></tr>
    <tr><td class="paramname">data</td><td>void pointer to ast_client structure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">232</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02842">ast_eid_cmp()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02587">ast_eid_to_str()</a>, <a class="el" href="../../d4/d05/json_8h_source.html#l00763">ast_json_dump_string</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00052">ast_json_free()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00591">ast_json_pack()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00842">ast_sip_publish_client_send()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02033">ast_sip_body::body_text</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00097">asterisk_mwi_publisher_state::client</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00070">ast_datastore::data</a>, <a class="el" href="../../dc/d33/mwi_8h_source.html#l00465">ast_mwi_state::eid</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00103">asterisk_mwi_publisher_state::mailbox_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00101">asterisk_mwi_publisher_state::mailbox_state_regex</a>, <a class="el" href="../../dc/d33/mwi_8h_source.html#l00461">ast_mwi_state::new_msgs</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dc/d33/mwi_8h_source.html#l00462">ast_mwi_state::old_msgs</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01152">stasis_subscription_is_subscribed()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01508">text</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02029">ast_sip_body::type</a>, and <a class="el" href="../../dc/d33/mwi_8h_source.html#l00460">ast_mwi_state::uniqueid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00296">cached_mwistate_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore = <a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a> *publisher_state = datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d45/structast__mwi__state.html">ast_mwi_state</a> *mwi_state;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <span class="keywordtype">char</span> eid_str[20];</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d80/structast__sip__body.html">ast_sip_body</a> body = {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      .<a class="code" href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a> = <span class="stringliteral">&quot;application&quot;</span>,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      .subtype = <span class="stringliteral">&quot;json&quot;</span>,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   };</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a>(sub) || <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type</a>() != <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(msg)) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   mwi_state = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a>(&amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>, &amp;mwi_state-&gt;<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaa1d7e6e6eb6d297e62f2d79dbdfaafb4">eid</a>)) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="comment">/* If the event is aggregate or didn&#39;t originate from this server, don&#39;t send it out. */</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">if</span> (publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a6a6cce9017bb79d2c034439cf2ceb27f">mailbox_state_filter</a> &amp;&amp; regexec(&amp;publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a32af426a78f232ce1dda0d1fd0479319">mailbox_state_regex</a>, mwi_state-&gt;<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga753c7b39e3284d771f13f513b003d033">uniqueid</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">/* Outgoing mailbox state has been filtered and the uniqueid does not match */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a>(eid_str, <span class="keyword">sizeof</span>(eid_str), &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   json = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="stringliteral">&quot;{ s: s, s: s, s: i, s: i, s:s }&quot;</span>,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;mailboxstate&quot;</span>,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="stringliteral">&quot;uniqueid&quot;</span>, mwi_state-&gt;<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga753c7b39e3284d771f13f513b003d033">uniqueid</a>,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="stringliteral">&quot;old&quot;</span>, mwi_state-&gt;<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga4369ae7c984aba22ce6d0e92718f2b29">old_msgs</a>,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="stringliteral">&quot;new&quot;</span>, mwi_state-&gt;<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga70de9f16a229e2c5bf1a973372949d3e">new_msgs</a>,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="stringliteral">&quot;eid&quot;</span>, eid_str);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   text = <a class="code" href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a>(json);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">if</span> (!text) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   body.<a class="code" href="../../d5/d80/structast__sip__body.html#a88687b0dd98d5307f1219432b73b8412">body_text</a> = <a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a4fc13fb50475b59d055cbec2d8ece47c">ast_sip_publish_client_send</a>(publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">client</a>, &amp;body);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a>(text);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="ttc" id="structast__sip__body_html_a88687b0dd98d5307f1219432b73b8412"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a88687b0dd98d5307f1219432b73b8412">ast_sip_body::body_text</a></div><div class="ttdeci">const char * body_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02033">res_pjsip.h:2033</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk mailbox publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00095">res_pjsip_publish_asterisk.c:95</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="utils_8h_html_a8ebf6841073ea2a063a0c86a5092a85b"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a></div><div class="ttdeci">char * ast_eid_to_str(char *s, int maxlen, struct ast_eid *eid)</div><div class="ttdoc">Convert an EID to a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02587">main/utils.c:2587</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="json_8h_html_a38eea5afa847432f7c10af8e69fb013e"><div class="ttname"><a href="../../d4/d05/json_8h.html#a38eea5afa847432f7c10af8e69fb013e">ast_json_free</a></div><div class="ttdeci">void ast_json_free(void *p)</div><div class="ttdoc">Asterisk&amp;#39;s custom JSON allocator. Exposed for use by unit tests. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00052">json.c:52</a></div></div>
<div class="ttc" id="stasis_8h_html_acd5bedbb2212956dac77be47dceef510"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a></div><div class="ttdeci">int stasis_subscription_is_subscribed(const struct stasis_subscription *sub)</div><div class="ttdoc">Returns whether a subscription is currently subscribed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01152">stasis.c:1152</a></div></div>
<div class="ttc" id="json_8h_html_a51a96b2baa67b671ac68a9fcaebbaeea"><div class="ttname"><a href="../../d4/d05/json_8h.html#a51a96b2baa67b671ac68a9fcaebbaeea">ast_json_dump_string</a></div><div class="ttdeci">#define ast_json_dump_string(root)</div><div class="ttdoc">Encode a JSON value to a compact string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00763">json.h:763</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a4e9f7c7ca75b0ff48b60b136e3961b61"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a4e9f7c7ca75b0ff48b60b136e3961b61">ast_eid_cmp</a></div><div class="ttdeci">int ast_eid_cmp(const struct ast_eid *eid1, const struct ast_eid *eid2)</div><div class="ttdoc">Compare two EIDs. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02842">main/utils.c:2842</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a4fc13fb50475b59d055cbec2d8ece47c"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a4fc13fb50475b59d055cbec2d8ece47c">ast_sip_publish_client_send</a></div><div class="ttdeci">int ast_sip_publish_client_send(struct ast_sip_outbound_publish_client *client, const struct ast_sip_body *body)</div><div class="ttdoc">Send an outgoing PUBLISH message using a client. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00842">res_pjsip_outbound_publish.c:842</a></div></div>
<div class="ttc" id="structast__sip__body_html_a763fd8db6bba8fbbbc113ca0d61c47c2"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html#a763fd8db6bba8fbbbc113ca0d61c47c2">ast_sip_body::type</a></div><div class="ttdeci">const char * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02029">res_pjsip.h:2029</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga4369ae7c984aba22ce6d0e92718f2b29"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga4369ae7c984aba22ce6d0e92718f2b29">ast_mwi_state::old_msgs</a></div><div class="ttdeci">int old_msgs</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00462">mwi.h:462</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a5592324b65dd693db5308f4d96e85edf"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">asterisk_mwi_publisher_state::client</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * client</div><div class="ttdoc">The publish client to send PUBLISH messages on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00097">res_pjsip_publish_asterisk.c:97</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a6a6cce9017bb79d2c034439cf2ceb27f"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a6a6cce9017bb79d2c034439cf2ceb27f">asterisk_mwi_publisher_state::mailbox_state_filter</a></div><div class="ttdeci">unsigned int mailbox_state_filter</div><div class="ttdoc">Mailbox state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00103">res_pjsip_publish_asterisk.c:103</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf226cf2d1a4dbbbf220521d58c05ac0f"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type</a></div><div class="ttdeci">struct stasis_message_type * ast_mwi_state_type(void)</div><div class="ttdoc">Get the Stasis Message Bus API message type for MWI messages. </div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="structast__datastore_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">ast_datastore::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00070">datastore.h:70</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga70de9f16a229e2c5bf1a973372949d3e"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga70de9f16a229e2c5bf1a973372949d3e">ast_mwi_state::new_msgs</a></div><div class="ttdeci">int new_msgs</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00461">mwi.h:461</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga753c7b39e3284d771f13f513b003d033">ast_mwi_state::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00460">mwi.h:460</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="structast__mwi__state_html"><div class="ttname"><a href="../../d6/d45/structast__mwi__state.html">ast_mwi_state</a></div><div class="ttdoc">The structure that contains MWI state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00457">mwi.h:457</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaa1d7e6e6eb6d297e62f2d79dbdfaafb4"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaa1d7e6e6eb6d297e62f2d79dbdfaafb4">ast_mwi_state::eid</a></div><div class="ttdeci">struct ast_eid eid</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/mwi_8h_source.html#l00465">mwi.h:465</a></div></div>
<div class="ttc" id="structast__sip__body_html"><div class="ttname"><a href="../../d5/d80/structast__sip__body.html">ast_sip_body</a></div><div class="ttdoc">SIP body description. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02027">res_pjsip.h:2027</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a32af426a78f232ce1dda0d1fd0479319"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a32af426a78f232ce1dda0d1fd0479319">asterisk_mwi_publisher_state::mailbox_state_regex</a></div><div class="ttdeci">regex_t mailbox_state_regex</div><div class="ttdoc">Regex used for filtering outbound mailbox state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00101">res_pjsip_publish_asterisk.c:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8523fe5f7acfb21272ae5d8540ea7db6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8523fe5f7acfb21272ae5d8540ea7db6">&#9670;&nbsp;</a></span>asterisk_start_devicestate_publishing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_start_devicestate_publishing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d73/structast__sip__outbound__publish.html">ast_sip_outbound_publish</a> *&#160;</td>
          <td class="paramname"><em>configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *&#160;</td>
          <td class="paramname"><em>client</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">322</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00673">ast_device_state_cache()</a>, <a class="el" href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00668">ast_device_state_topic_all()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00724">ast_sip_publish_client_add_datastore()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00694">ast_sip_publish_client_alloc_datastore()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">ast_sip_publish_client_remove_datastore()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02330">ast_sorcery_object_get_extended()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">asterisk_publisher_devstate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00307">build_regex()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00285">cached_devstate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">asterisk_devicestate_publisher_state::client</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00091">asterisk_devicestate_publisher_state::device_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00089">asterisk_devicestate_publisher_state::device_state_regex</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00087">asterisk_devicestate_publisher_state::device_state_subscription</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache_dump()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00652">stasis_subscribe</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00300">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;{</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *, datastore, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a> *publisher_state;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *cached;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   datastore = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a8b50ad87195f077e1adfd02bd92bfe93">ast_sip_publish_client_alloc_datastore</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae5bba0c85c012b82bb439cdd3a9b59ce">asterisk_devicestate_publisher_state_datastore</a>,</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="stringliteral">&quot;asterisk-devicestate-publisher&quot;</span>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   publisher_state = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a>));</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="keywordflow">if</span> (!publisher_state) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   datastore-&gt;data = publisher_state;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   value = <a class="code" href="../../d8/d25/sorcery_8h.html#ae70a3da16c7f573f76426568cb156aa2">ast_sorcery_object_get_extended</a>(configuration, <span class="stringliteral">&quot;device_state_filter&quot;</span>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(value)) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a>(&amp;publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a117331eae05adada5f30ca06c94a9572">device_state_regex</a>, value)) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#ad194d0988a40ea1a3e7d9495c8c0b003">device_state_filter</a> = 1;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">client</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(client);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0161add0b2a4e7baeb8c5765f22235f0">ast_sip_publish_client_add_datastore</a>(client, datastore)) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a> = <a class="code" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>(<a class="code" href="../../da/da2/devicestate_8h.html#a9fa7376e8e627cf5a512209005692013">ast_device_state_topic_all</a>(),</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a54744c95e39e0fc811e0ef3e09f17164">asterisk_publisher_devstate_cb</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(datastore));</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="keywordflow">if</span> (!publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a>) {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a>(client, <span class="stringliteral">&quot;asterisk-devicestate-publisher&quot;</span>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, -1);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type</a>());</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>());</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   cached = <a class="code" href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a>(<a class="code" href="../../da/da2/devicestate_8h.html#a52892d3b3fec63dbcf67954d8c3589d5">ast_device_state_cache</a>(), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cached, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa073dd3fd02ac2d0b962a7b040b0b706">cached_devstate_cb</a>, datastore);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cached, -1);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ae5bba0c85c012b82bb439cdd3a9b59ce"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae5bba0c85c012b82bb439cdd3a9b59ce">asterisk_devicestate_publisher_state_datastore</a></div><div class="ttdeci">static const struct ast_datastore_info asterisk_devicestate_publisher_state_datastore</div><div class="ttdoc">Datastore for attaching devicestate publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00144">res_pjsip_publish_asterisk.c:144</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ab5383b1b80e6d2df56a59122b27ff017"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a></div><div class="ttdeci">static int build_regex(regex_t *regex, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00307">res_pjsip_publish_asterisk.c:307</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a117331eae05adada5f30ca06c94a9572"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a117331eae05adada5f30ca06c94a9572">asterisk_devicestate_publisher_state::device_state_regex</a></div><div class="ttdeci">regex_t device_state_regex</div><div class="ttdoc">Regex used for filtering outbound device state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00089">res_pjsip_publish_asterisk.c:89</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="stasis_8h_html_a8c5612920b22beb93b5e8acbdae40078"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a></div><div class="ttdeci">struct ao2_container * stasis_cache_dump(struct stasis_cache *cache, struct stasis_message_type *type)</div><div class="ttdoc">Dump cached items to a subscription for the ast_eid_default entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache.c:736</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a0370232b5fce85a4edb5b940f0cc1019"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a></div><div class="ttdeci">void ast_sip_publish_client_remove_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Remove a publication datastore from an event publisher. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">res_pjsip_outbound_publish.c:743</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="sorcery_8h_html_ae70a3da16c7f573f76426568cb156aa2"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ae70a3da16c7f573f76426568cb156aa2">ast_sorcery_object_get_extended</a></div><div class="ttdeci">const char * ast_sorcery_object_get_extended(const void *object, const char *name)</div><div class="ttdoc">Get an extended field value from a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02330">sorcery.c:2330</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a18209247c41af6331b56bc68672ef8aa"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">asterisk_devicestate_publisher_state::device_state_subscription</a></div><div class="ttdeci">struct stasis_subscription * device_state_subscription</div><div class="ttdoc">Device state subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00087">res_pjsip_publish_asterisk.c:87</a></div></div>
<div class="ttc" id="devicestate_8h_html_a9459272db1c8c968ed1aff1387f0f9fd"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a9459272db1c8c968ed1aff1387f0f9fd">ast_device_state_message_type</a></div><div class="ttdeci">struct stasis_message_type * ast_device_state_message_type(void)</div><div class="ttdoc">Get the Stasis message type for device state messages. </div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_ad194d0988a40ea1a3e7d9495c8c0b003"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#ad194d0988a40ea1a3e7d9495c8c0b003">asterisk_devicestate_publisher_state::device_state_filter</a></div><div class="ttdeci">unsigned int device_state_filter</div><div class="ttdoc">Device state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00091">res_pjsip_publish_asterisk.c:91</a></div></div>
<div class="ttc" id="stasis_8h_html_ae3fe7fe099389094244002113814ec23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a></div><div class="ttdeci">#define stasis_subscribe(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00652">stasis.h:652</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a5592324b65dd693db5308f4d96e85edf"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">asterisk_devicestate_publisher_state::client</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * client</div><div class="ttdoc">The publish client to send PUBLISH messages on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">res_pjsip_publish_asterisk.c:85</a></div></div>
<div class="ttc" id="devicestate_8h_html_a52892d3b3fec63dbcf67954d8c3589d5"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a52892d3b3fec63dbcf67954d8c3589d5">ast_device_state_cache</a></div><div class="ttdeci">struct stasis_cache * ast_device_state_cache(void)</div><div class="ttdoc">Backend cache for ast_device_state_topic_cached() </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00673">devicestate.c:673</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a0161add0b2a4e7baeb8c5765f22235f0"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0161add0b2a4e7baeb8c5765f22235f0">ast_sip_publish_client_add_datastore</a></div><div class="ttdeci">int ast_sip_publish_client_add_datastore(struct ast_sip_outbound_publish_client *client, struct ast_datastore *datastore)</div><div class="ttdoc">Add a datastore to a SIP event publisher. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00724">res_pjsip_outbound_publish.c:724</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a8b50ad87195f077e1adfd02bd92bfe93"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a8b50ad87195f077e1adfd02bd92bfe93">ast_sip_publish_client_alloc_datastore</a></div><div class="ttdeci">struct ast_datastore * ast_sip_publish_client_alloc_datastore(const struct ast_datastore_info *info, const char *uid)</div><div class="ttdoc">Alternative for ast_datastore_alloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00694">res_pjsip_outbound_publish.c:694</a></div></div>
<div class="ttc" id="devicestate_8h_html_a9fa7376e8e627cf5a512209005692013"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a9fa7376e8e627cf5a512209005692013">ast_device_state_topic_all</a></div><div class="ttdeci">struct stasis_topic * ast_device_state_topic_all(void)</div><div class="ttdoc">Get the Stasis topic for device state messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00668">devicestate.c:668</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk device state publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00083">res_pjsip_publish_asterisk.c:83</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_aa073dd3fd02ac2d0b962a7b040b0b706"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa073dd3fd02ac2d0b962a7b040b0b706">cached_devstate_cb</a></div><div class="ttdeci">static int cached_devstate_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00285">res_pjsip_publish_asterisk.c:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a54744c95e39e0fc811e0ef3e09f17164"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a54744c95e39e0fc811e0ef3e09f17164">asterisk_publisher_devstate_cb</a></div><div class="ttdeci">static void asterisk_publisher_devstate_cb(void *data, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Callback function for device state events. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">res_pjsip_publish_asterisk.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a27f1eb91c0d170ec6209debabe34a729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27f1eb91c0d170ec6209debabe34a729">&#9670;&nbsp;</a></span>asterisk_start_mwi_publishing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_start_mwi_publishing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d73/structast__sip__outbound__publish.html">ast_sip_outbound_publish</a> *&#160;</td>
          <td class="paramname"><em>configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *&#160;</td>
          <td class="paramname"><em>client</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">401</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00090">ast_mwi_state_cache()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00085">ast_mwi_topic_all()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00724">ast_sip_publish_client_add_datastore()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00694">ast_sip_publish_client_alloc_datastore()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">ast_sip_publish_client_remove_datastore()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02330">ast_sorcery_object_get_extended()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">asterisk_publisher_mwistate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00307">build_regex()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00296">cached_mwistate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00097">asterisk_mwi_publisher_state::client</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00103">asterisk_mwi_publisher_state::mailbox_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00101">asterisk_mwi_publisher_state::mailbox_state_regex</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00099">asterisk_mwi_publisher_state::mailbox_state_subscription</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache_dump()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00652">stasis_subscribe</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00300">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>
<div class="fragment"><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;{</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *, datastore, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a> *publisher_state;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *cached;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   datastore = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a8b50ad87195f077e1adfd02bd92bfe93">ast_sip_publish_client_alloc_datastore</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae8c0ef2a71fb872a04bf13333a0284c5">asterisk_mwi_publisher_state_datastore</a>, <span class="stringliteral">&quot;asterisk-mwi-publisher&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   publisher_state = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a>));</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="keywordflow">if</span> (!publisher_state) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   datastore-&gt;data = publisher_state;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   value = <a class="code" href="../../d8/d25/sorcery_8h.html#ae70a3da16c7f573f76426568cb156aa2">ast_sorcery_object_get_extended</a>(configuration, <span class="stringliteral">&quot;mailbox_state_filter&quot;</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(value)) {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a>(&amp;publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a32af426a78f232ce1dda0d1fd0479319">mailbox_state_regex</a>, value)) {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a6a6cce9017bb79d2c034439cf2ceb27f">mailbox_state_filter</a> = 1;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">client</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(client);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0161add0b2a4e7baeb8c5765f22235f0">ast_sip_publish_client_add_datastore</a>(client, datastore)) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a> = <a class="code" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga547ae87810e6cd121cea7b3149343366">ast_mwi_topic_all</a>(),</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3bb31efe5ad6f5ecf1d8a64332115cab">asterisk_publisher_mwistate_cb</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(datastore));</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keywordflow">if</span> (!publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a>) {</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a>(client, <span class="stringliteral">&quot;asterisk-mwi-publisher&quot;</span>);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, -1);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type</a>());</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>());</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   cached = <a class="code" href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7fc6473ab80d2117f1bcb1359721fdce">ast_mwi_state_cache</a>(), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cached, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa80e2e72f681ff7bff288f322b871487">cached_mwistate_cb</a>, datastore);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cached, -1);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="ttc" id="structasterisk__mwi__publisher__state_html"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk mailbox publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00095">res_pjsip_publish_asterisk.c:95</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ab5383b1b80e6d2df56a59122b27ff017"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a></div><div class="ttdeci">static int build_regex(regex_t *regex, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00307">res_pjsip_publish_asterisk.c:307</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7fc6473ab80d2117f1bcb1359721fdce"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7fc6473ab80d2117f1bcb1359721fdce">ast_mwi_state_cache</a></div><div class="ttdeci">struct stasis_cache * ast_mwi_state_cache(void)</div><div class="ttdoc">Backend cache for ast_mwi_topic_cached(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/mwi_8c_source.html#l00090">mwi.c:90</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga547ae87810e6cd121cea7b3149343366"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga547ae87810e6cd121cea7b3149343366">ast_mwi_topic_all</a></div><div class="ttdeci">struct stasis_topic * ast_mwi_topic_all(void)</div><div class="ttdoc">Get the Stasis Message Bus API topic for MWI messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db4/mwi_8c_source.html#l00085">mwi.c:85</a></div></div>
<div class="ttc" id="stasis_8h_html_a8c5612920b22beb93b5e8acbdae40078"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a></div><div class="ttdeci">struct ao2_container * stasis_cache_dump(struct stasis_cache *cache, struct stasis_message_type *type)</div><div class="ttdoc">Dump cached items to a subscription for the ast_eid_default entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache.c:736</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a0370232b5fce85a4edb5b940f0cc1019"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a></div><div class="ttdeci">void ast_sip_publish_client_remove_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Remove a publication datastore from an event publisher. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">res_pjsip_outbound_publish.c:743</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="sorcery_8h_html_ae70a3da16c7f573f76426568cb156aa2"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ae70a3da16c7f573f76426568cb156aa2">ast_sorcery_object_get_extended</a></div><div class="ttdeci">const char * ast_sorcery_object_get_extended(const void *object, const char *name)</div><div class="ttdoc">Get an extended field value from a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02330">sorcery.c:2330</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a3bb31efe5ad6f5ecf1d8a64332115cab"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3bb31efe5ad6f5ecf1d8a64332115cab">asterisk_publisher_mwistate_cb</a></div><div class="ttdeci">static void asterisk_publisher_mwistate_cb(void *data, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Callback function for mailbox state events. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">res_pjsip_publish_asterisk.c:232</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a5592324b65dd693db5308f4d96e85edf"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a5592324b65dd693db5308f4d96e85edf">asterisk_mwi_publisher_state::client</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * client</div><div class="ttdoc">The publish client to send PUBLISH messages on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00097">res_pjsip_publish_asterisk.c:97</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a6a6cce9017bb79d2c034439cf2ceb27f"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a6a6cce9017bb79d2c034439cf2ceb27f">asterisk_mwi_publisher_state::mailbox_state_filter</a></div><div class="ttdeci">unsigned int mailbox_state_filter</div><div class="ttdoc">Mailbox state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00103">res_pjsip_publish_asterisk.c:103</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_aa80e2e72f681ff7bff288f322b871487"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aa80e2e72f681ff7bff288f322b871487">cached_mwistate_cb</a></div><div class="ttdeci">static int cached_mwistate_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00296">res_pjsip_publish_asterisk.c:296</a></div></div>
<div class="ttc" id="stasis_8h_html_ae3fe7fe099389094244002113814ec23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a></div><div class="ttdeci">#define stasis_subscribe(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00652">stasis.h:652</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a0161add0b2a4e7baeb8c5765f22235f0"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0161add0b2a4e7baeb8c5765f22235f0">ast_sip_publish_client_add_datastore</a></div><div class="ttdeci">int ast_sip_publish_client_add_datastore(struct ast_sip_outbound_publish_client *client, struct ast_datastore *datastore)</div><div class="ttdoc">Add a datastore to a SIP event publisher. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00724">res_pjsip_outbound_publish.c:724</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a8b50ad87195f077e1adfd02bd92bfe93"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a8b50ad87195f077e1adfd02bd92bfe93">ast_sip_publish_client_alloc_datastore</a></div><div class="ttdeci">struct ast_datastore * ast_sip_publish_client_alloc_datastore(const struct ast_datastore_info *info, const char *uid)</div><div class="ttdoc">Alternative for ast_datastore_alloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00694">res_pjsip_outbound_publish.c:694</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf226cf2d1a4dbbbf220521d58c05ac0f"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf226cf2d1a4dbbbf220521d58c05ac0f">ast_mwi_state_type</a></div><div class="ttdeci">struct stasis_message_type * ast_mwi_state_type(void)</div><div class="ttdoc">Get the Stasis Message Bus API message type for MWI messages. </div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a2617043b932a6e0f835227b9eaed750e"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">asterisk_mwi_publisher_state::mailbox_state_subscription</a></div><div class="ttdeci">struct stasis_subscription * mailbox_state_subscription</div><div class="ttdoc">Mailbox state subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00099">res_pjsip_publish_asterisk.c:99</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ae8c0ef2a71fb872a04bf13333a0284c5"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ae8c0ef2a71fb872a04bf13333a0284c5">asterisk_mwi_publisher_state_datastore</a></div><div class="ttdeci">static const struct ast_datastore_info asterisk_mwi_publisher_state_datastore</div><div class="ttdoc">Datastore for attaching devicestate publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00162">res_pjsip_publish_asterisk.c:162</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a32af426a78f232ce1dda0d1fd0479319"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a32af426a78f232ce1dda0d1fd0479319">asterisk_mwi_publisher_state::mailbox_state_regex</a></div><div class="ttdeci">regex_t mailbox_state_regex</div><div class="ttdoc">Regex used for filtering outbound mailbox state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00101">res_pjsip_publish_asterisk.c:101</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a228cf4bd890d2155c264e1abb40638eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a228cf4bd890d2155c264e1abb40638eb">&#9670;&nbsp;</a></span>asterisk_stop_devicestate_publishing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_stop_devicestate_publishing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *&#160;</td>
          <td class="paramname"><em>client</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00374">374</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">ast_sip_publish_client_get_datastore()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">ast_sip_publish_client_remove_datastore()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00087">asterisk_devicestate_publisher_state::device_state_subscription</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">stasis_unsubscribe_and_join()</a>.</p>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *, datastore, <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a>(client, <span class="stringliteral">&quot;asterisk-devicestate-publisher&quot;</span>),</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a> *publisher_state;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   publisher_state = datastore-&gt;data;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="keywordflow">if</span> (publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a>) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a>);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, -1);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a>(client, <span class="stringliteral">&quot;asterisk-devicestate-publisher&quot;</span>);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div><div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a0370232b5fce85a4edb5b940f0cc1019"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a></div><div class="ttdeci">void ast_sip_publish_client_remove_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Remove a publication datastore from an event publisher. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">res_pjsip_outbound_publish.c:743</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a18209247c41af6331b56bc68672ef8aa"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">asterisk_devicestate_publisher_state::device_state_subscription</a></div><div class="ttdeci">struct stasis_subscription * device_state_subscription</div><div class="ttdoc">Device state subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00087">res_pjsip_publish_asterisk.c:87</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_ac8dca3a60f8f4b4be12867de93989b85"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a></div><div class="ttdeci">struct ast_datastore * ast_sip_publish_client_get_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Retrieve an event publisher datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">res_pjsip_outbound_publish.c:737</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk device state publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00083">res_pjsip_publish_asterisk.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e78451d3636e537c9f34da01b62f2c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e78451d3636e537c9f34da01b62f2c6">&#9670;&nbsp;</a></span>asterisk_stop_mwi_publishing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int asterisk_stop_mwi_publishing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *&#160;</td>
          <td class="paramname"><em>client</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00452">452</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">ast_sip_publish_client_get_datastore()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">ast_sip_publish_client_remove_datastore()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00099">asterisk_mwi_publisher_state::mailbox_state_subscription</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">stasis_unsubscribe_and_join()</a>.</p>
<div class="fragment"><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;{</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *, datastore, <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a>(client, <span class="stringliteral">&quot;asterisk-mwi-publisher&quot;</span>),</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a> *publisher_state;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   publisher_state = datastore-&gt;data;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="keywordflow">if</span> (publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a>) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a>);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, -1);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a>(client, <span class="stringliteral">&quot;asterisk-mwi-publisher&quot;</span>);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div><div class="ttc" id="structasterisk__mwi__publisher__state_html"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk mailbox publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00095">res_pjsip_publish_asterisk.c:95</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a0370232b5fce85a4edb5b940f0cc1019"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a0370232b5fce85a4edb5b940f0cc1019">ast_sip_publish_client_remove_datastore</a></div><div class="ttdeci">void ast_sip_publish_client_remove_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Remove a publication datastore from an event publisher. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00743">res_pjsip_outbound_publish.c:743</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_ac8dca3a60f8f4b4be12867de93989b85"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#ac8dca3a60f8f4b4be12867de93989b85">ast_sip_publish_client_get_datastore</a></div><div class="ttdeci">struct ast_datastore * ast_sip_publish_client_get_datastore(struct ast_sip_outbound_publish_client *client, const char *name)</div><div class="ttdoc">Retrieve an event publisher datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00737">res_pjsip_outbound_publish.c:737</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a2617043b932a6e0f835227b9eaed750e"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">asterisk_mwi_publisher_state::mailbox_state_subscription</a></div><div class="ttdeci">struct stasis_subscription * mailbox_state_subscription</div><div class="ttdoc">Mailbox state subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00099">res_pjsip_publish_asterisk.c:99</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5383b1b80e6d2df56a59122b27ff017"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5383b1b80e6d2df56a59122b27ff017">&#9670;&nbsp;</a></span>build_regex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int build_regex </td>
          <td>(</td>
          <td class="paramtype">regex_t *&#160;</td>
          <td class="paramname"><em>regex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00307">307</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00840">regex_filter_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="keywordflow">if</span> ((res = regcomp(<a class="code" href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a>, <a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>, REG_EXTENDED | REG_ICASE | REG_NOSUB))) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = regerror(res, <a class="code" href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      regerror(res, <a class="code" href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a>, buf, len);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not compile regex &#39;%s&#39;: %s\n&quot;</span>, <a class="code" href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a>, buf);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="app__queue_8c_html_a5633b1433389cec21ade3811bbe9ca5b"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#a5633b1433389cec21ade3811bbe9ca5b">text</a></div><div class="ttdeci">char * text</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01508">app_queue.c:1508</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="func__strings_8c_html_a1b62eb9e3ebf087509f4301aa6336931"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#a1b62eb9e3ebf087509f4301aa6336931">regex</a></div><div class="ttdeci">static int regex(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00948">func_strings.c:948</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa073dd3fd02ac2d0b962a7b040b0b706"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa073dd3fd02ac2d0b962a7b040b0b706">&#9670;&nbsp;</a></span>cached_devstate_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cached_devstate_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00285">285</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">asterisk_publisher_devstate_cb()</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00070">ast_datastore::data</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00087">asterisk_devicestate_publisher_state::device_state_subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00559">asterisk_publication_devicestate_refresh()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>.</p>
<div class="fragment"><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg = obj;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore = arg;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a> *publisher_state = datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a54744c95e39e0fc811e0ef3e09f17164">asterisk_publisher_devstate_cb</a>(arg, publisher_state-&gt;<a class="code" href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">device_state_subscription</a>, msg);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div><div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html_a18209247c41af6331b56bc68672ef8aa"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html#a18209247c41af6331b56bc68672ef8aa">asterisk_devicestate_publisher_state::device_state_subscription</a></div><div class="ttdeci">struct stasis_subscription * device_state_subscription</div><div class="ttdoc">Device state subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00087">res_pjsip_publish_asterisk.c:87</a></div></div>
<div class="ttc" id="structasterisk__devicestate__publisher__state_html"><div class="ttname"><a href="../../d1/d18/structasterisk__devicestate__publisher__state.html">asterisk_devicestate_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk device state publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00083">res_pjsip_publish_asterisk.c:83</a></div></div>
<div class="ttc" id="structast__datastore_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">ast_datastore::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00070">datastore.h:70</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a54744c95e39e0fc811e0ef3e09f17164"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a54744c95e39e0fc811e0ef3e09f17164">asterisk_publisher_devstate_cb</a></div><div class="ttdeci">static void asterisk_publisher_devstate_cb(void *data, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Callback function for device state events. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">res_pjsip_publish_asterisk.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa80e2e72f681ff7bff288f322b871487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa80e2e72f681ff7bff288f322b871487">&#9670;&nbsp;</a></span>cached_mwistate_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cached_mwistate_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00296">296</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">asterisk_publisher_mwistate_cb()</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00070">ast_datastore::data</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00099">asterisk_mwi_publisher_state::mailbox_state_subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00650">asterisk_publication_mwi_refresh()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg = obj;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore = arg;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a> *publisher_state = datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3bb31efe5ad6f5ecf1d8a64332115cab">asterisk_publisher_mwistate_cb</a>(arg, publisher_state-&gt;<a class="code" href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">mailbox_state_subscription</a>, msg);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div><div class="ttc" id="structasterisk__mwi__publisher__state_html"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html">asterisk_mwi_publisher_state</a></div><div class="ttdoc">Structure which contains Asterisk mailbox publisher state information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00095">res_pjsip_publish_asterisk.c:95</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a3bb31efe5ad6f5ecf1d8a64332115cab"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a3bb31efe5ad6f5ecf1d8a64332115cab">asterisk_publisher_mwistate_cb</a></div><div class="ttdeci">static void asterisk_publisher_mwistate_cb(void *data, struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Callback function for mailbox state events. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">res_pjsip_publish_asterisk.c:232</a></div></div>
<div class="ttc" id="structasterisk__mwi__publisher__state_html_a2617043b932a6e0f835227b9eaed750e"><div class="ttname"><a href="../../d3/df1/structasterisk__mwi__publisher__state.html#a2617043b932a6e0f835227b9eaed750e">asterisk_mwi_publisher_state::mailbox_state_subscription</a></div><div class="ttdeci">struct stasis_subscription * mailbox_state_subscription</div><div class="ttdoc">Mailbox state subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00099">res_pjsip_publish_asterisk.c:99</a></div></div>
<div class="ttc" id="structast__datastore_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">ast_datastore::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00070">datastore.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00862">862</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02847">ast_eid_is_empty()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00614">ast_sip_register_event_publisher_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02718">ast_sip_register_publish_handler()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00641">ast_sip_unregister_event_publisher_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02738">ast_sip_unregister_publish_handler()</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00456">ast_sorcery_apply_config</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00477">ast_sorcery_apply_default</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00955">ast_sorcery_object_field_register</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l01005">ast_sorcery_object_field_register_custom</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00838">ast_sorcery_object_register</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01442">ast_sorcery_reload_object()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00827">asterisk_publication_config_alloc()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00766">asterisk_publication_send_refresh()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::device_state</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::devicestate_publish</a>, <a class="el" href="../../dd/dd4/res__pjsip__outbound__publish_8h_source.html#l00043">ast_sip_event_publisher_handler::event_name</a>, <a class="el" href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">ast_sip_publish_handler::event_name</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00816">FLDSET</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00124">asterisk_publication_config::mailbox_state</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::mailboxstate_publish</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00294">OPT_BOOL_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00399">OPT_NOOP_T</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00435">OPT_STRINGFIELD_T</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00840">regex_filter_handler()</a>, and <a class="el" href="../../db/dfe/config__options_8h_source.html#l00827">STRFLDSET</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00925">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;{</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a9052010ef014bd56be478fab26feb2e1">ast_eid_is_empty</a>(&amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>)) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Entity ID is not set.\n&quot;</span>);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a9db9fd1cf5ec967af2ad3a63c27e0233">ast_sorcery_apply_config</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;res_pjsip_publish_asterisk&quot;</span>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;config&quot;</span>, <span class="stringliteral">&quot;pjsip.conf,criteria=type=asterisk-publication&quot;</span>);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a15bf28546452c2262131fdf61a4919d2">asterisk_publication_config_alloc</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to register &#39;asterisk-publication&#39; type with sorcery\n&quot;</span>);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;   }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a>, 0, 0);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;devicestate_publish&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a>, devicestate_publish));</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;mailboxstate_publish&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a>, mailboxstate_publish));</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;device_state&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a>, device_state));</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;device_state_filter&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a77ccc2e92e49accab4f22fa8a97a9c87">regex_filter_handler</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;mailbox_state&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a>, mailbox_state));</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>, <span class="stringliteral">&quot;mailbox_state_filter&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a77ccc2e92e49accab4f22fa8a97a9c87">regex_filter_handler</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a14d30548053458724404f5c041483cfa">ast_sip_register_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a>)) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to register event publication handler %s\n&quot;</span>,</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;         <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a>.<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;   }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a14d30548053458724404f5c041483cfa">ast_sip_register_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a>)) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to register event publication handler %s\n&quot;</span>,</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;         <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a>.<a class="code" href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a>);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;   }</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a8898d2239bd93b0949c090b451a8d196">ast_sip_register_event_publisher_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ac29f24c7e97bcbb87b802bb1cc2bca82">asterisk_devicestate_publisher_handler</a>)) {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to register event publisher handler %s\n&quot;</span>,</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;         <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ac29f24c7e97bcbb87b802bb1cc2bca82">asterisk_devicestate_publisher_handler</a>.<a class="code" href="../../de/d7d/structast__sip__event__publisher__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a>);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a8898d2239bd93b0949c090b451a8d196">ast_sip_register_event_publisher_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a08c237b30dd3b1ca497ccb5eb0eca8e7">asterisk_mwi_publisher_handler</a>)) {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to register event publisher handler %s\n&quot;</span>,</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;         <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a08c237b30dd3b1ca497ccb5eb0eca8e7">asterisk_mwi_publisher_handler</a>.<a class="code" href="../../de/d7d/structast__sip__event__publisher__handler.html#aeccf279e6fca0e5f8536fdf76c838728">event_name</a>);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a19a9158e2cabc358e93d877e0b8b8b03">ast_sip_unregister_event_publisher_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a08c237b30dd3b1ca497ccb5eb0eca8e7">asterisk_mwi_publisher_handler</a>);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a>);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a>);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   }</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a6eb1409f4eea742398544863fd284276">asterisk_publication_send_refresh</a>();</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;}</div><div class="ttc" id="structast__sip__publish__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../d5/d9f/structast__sip__publish__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_publish_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdoc">The name of the event this handler deals with. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/res__pjsip__pubsub_8h_source.html#l00051">res_pjsip_pubsub.h:51</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a0df2cc9dc9bf09ee71252c183fe64bd7">OPT_NOOP_T</a></div><div class="ttdoc">Type for a default handler that should do nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00399">config_options.h:399</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a14d30548053458724404f5c041483cfa"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a14d30548053458724404f5c041483cfa">ast_sip_register_publish_handler</a></div><div class="ttdeci">int ast_sip_register_publish_handler(struct ast_sip_publish_handler *handler)</div><div class="ttdoc">Register a publish handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02718">res_pjsip_pubsub.c:2718</a></div></div>
<div class="ttc" id="sorcery_8h_html_a9db9fd1cf5ec967af2ad3a63c27e0233"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a9db9fd1cf5ec967af2ad3a63c27e0233">ast_sorcery_apply_config</a></div><div class="ttdeci">#define ast_sorcery_apply_config(sorcery, name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00456">sorcery.h:456</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a15bf28546452c2262131fdf61a4919d2"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a15bf28546452c2262131fdf61a4919d2">asterisk_publication_config_alloc</a></div><div class="ttdeci">static void * asterisk_publication_config_alloc(const char *name)</div><div class="ttdoc">Allocator function for Asterisk publication configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00827">res_pjsip_publish_asterisk.c:827</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="sorcery_8h_html_a720c9774873ec35bae0a0160954767e7"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a></div><div class="ttdeci">#define ast_sorcery_object_field_register_custom(sorcery, type, name, default_val, config_handler, sorcery_handler, multiple_handler, flags,...)</div><div class="ttdoc">Register a field within an object with custom handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l01005">sorcery.h:1005</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a19a9158e2cabc358e93d877e0b8b8b03"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a19a9158e2cabc358e93d877e0b8b8b03">ast_sip_unregister_event_publisher_handler</a></div><div class="ttdeci">void ast_sip_unregister_event_publisher_handler(struct ast_sip_event_publisher_handler *handler)</div><div class="ttdoc">Unregister a publish handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00641">res_pjsip_outbound_publish.c:641</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a065a2a4147e199cb6b86b3f19bc0b184"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a></div><div class="ttdeci">struct ast_sip_publish_handler asterisk_devicestate_publication_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00806">res_pjsip_publish_asterisk.c:806</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ac29f24c7e97bcbb87b802bb1cc2bca82"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ac29f24c7e97bcbb87b802bb1cc2bca82">asterisk_devicestate_publisher_handler</a></div><div class="ttdeci">struct ast_sip_event_publisher_handler asterisk_devicestate_publisher_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00395">res_pjsip_publish_asterisk.c:395</a></div></div>
<div class="ttc" id="structast__sip__event__publisher__handler_html_aeccf279e6fca0e5f8536fdf76c838728"><div class="ttname"><a href="../../de/d7d/structast__sip__event__publisher__handler.html#aeccf279e6fca0e5f8536fdf76c838728">ast_sip_event_publisher_handler::event_name</a></div><div class="ttdeci">const char * event_name</div><div class="ttdoc">The name of the event this handler deals with. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd4/res__pjsip__outbound__publish_8h_source.html#l00043">res_pjsip_outbound_publish.h:43</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a08c237b30dd3b1ca497ccb5eb0eca8e7"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a08c237b30dd3b1ca497ccb5eb0eca8e7">asterisk_mwi_publisher_handler</a></div><div class="ttdeci">struct ast_sip_event_publisher_handler asterisk_mwi_publisher_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00473">res_pjsip_publish_asterisk.c:473</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_aecd29e2fefb02a8d50b2fc6b24b6e1cf"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a></div><div class="ttdeci">struct ast_sip_publish_handler asterisk_mwi_publication_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00812">res_pjsip_publish_asterisk.c:812</a></div></div>
<div class="ttc" id="sorcery_8h_html_a5ee86f00f6e2240f74772d59edf0f74a"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a></div><div class="ttdeci">#define ast_sorcery_object_register(sorcery, type, alloc, transform, apply)</div><div class="ttdoc">Register an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00838">sorcery.h:838</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a6eb1409f4eea742398544863fd284276"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a6eb1409f4eea742398544863fd284276">asterisk_publication_send_refresh</a></div><div class="ttdeci">static void asterisk_publication_send_refresh(void)</div><div class="ttdoc">Internal function to send refresh requests to all publications. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00766">res_pjsip_publish_asterisk.c:766</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a></div><div class="ttdoc">Type for default option handler for bools (ast_true/ast_false) </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00294">config_options.h:294</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad1165cf9d45ed5ffa1555371be9ae770"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a></div><div class="ttdeci">#define ast_sorcery_apply_default(sorcery, type, name, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00477">sorcery.h:477</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a77ccc2e92e49accab4f22fa8a97a9c87"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a77ccc2e92e49accab4f22fa8a97a9c87">regex_filter_handler</a></div><div class="ttdeci">static int regex_filter_handler(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00840">res_pjsip_publish_asterisk.c:840</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="config__options_8h_html_a3e5be807d4a10b6da6382a40a0004ace"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a></div><div class="ttdeci">#define STRFLDSET(type,...)</div><div class="ttdoc">Convert a struct and a list of stringfield fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00827">config_options.h:827</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a65b342a28c864a472dfff5ea27de8691"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a></div><div class="ttdeci">void ast_sip_unregister_publish_handler(struct ast_sip_publish_handler *handler)</div><div class="ttdoc">Unregister a publish handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02738">res_pjsip_pubsub.c:2738</a></div></div>
<div class="ttc" id="sorcery_8h_html_aa7102b6e71e4fa6525b24a6123a2f6d4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a></div><div class="ttdeci">#define ast_sorcery_object_field_register(sorcery, type, name, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a field within an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00955">sorcery.h:955</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a8898d2239bd93b0949c090b451a8d196"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a8898d2239bd93b0949c090b451a8d196">ast_sip_register_event_publisher_handler</a></div><div class="ttdeci">int ast_sip_register_event_publisher_handler(struct ast_sip_event_publisher_handler *handler)</div><div class="ttdoc">Register an event publisher handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00614">res_pjsip_outbound_publish.c:614</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a></div><div class="ttdoc">Type for default option handler for stringfields. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00435">config_options.h:435</a></div></div>
<div class="ttc" id="utils_8h_html_a9052010ef014bd56be478fab26feb2e1"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a9052010ef014bd56be478fab26feb2e1">ast_eid_is_empty</a></div><div class="ttdeci">int ast_eid_is_empty(const struct ast_eid *eid)</div><div class="ttdoc">Check if EID is empty. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02847">main/utils.c:2847</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad98ae6e153f53b0c3c40119acc5e5266"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a></div><div class="ttdeci">void ast_sorcery_reload_object(const struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Inform any wizards of a specific object type to reload persistent objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01442">sorcery.c:1442</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77ccc2e92e49accab4f22fa8a97a9c87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77ccc2e92e49accab4f22fa8a97a9c87">&#9670;&nbsp;</a></span>regex_filter_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int regex_filter_handler </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../db/de0/structaco__option.html">aco_option</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00840">840</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00307">build_regex()</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00122">asterisk_publication_config::device_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00120">asterisk_publication_config::device_state_regex</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00128">asterisk_publication_config::mailbox_state_filter</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00126">asterisk_publication_config::mailbox_state_regex</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">ast_variable::name</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00862">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;{</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = obj;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>)) {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   <span class="keywordflow">if</span> (!strcmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;device_state_filter&quot;</span>)) {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">if</span> (!(res = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a>(&amp;config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a117331eae05adada5f30ca06c94a9572">device_state_regex</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>))) {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;         config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#ad194d0988a40ea1a3e7d9495c8c0b003">device_state_filter</a> = 1;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;mailbox_state_filter&quot;</span>)) {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">if</span> (!(res = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a>(&amp;config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a32af426a78f232ce1dda0d1fd0479319">mailbox_state_regex</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>))) {</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a6a6cce9017bb79d2c034439cf2ceb27f">mailbox_state_filter</a> = 1;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ab5383b1b80e6d2df56a59122b27ff017"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ab5383b1b80e6d2df56a59122b27ff017">build_regex</a></div><div class="ttdeci">static int build_regex(regex_t *regex, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00307">res_pjsip_publish_asterisk.c:307</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a6a6cce9017bb79d2c034439cf2ceb27f"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a6a6cce9017bb79d2c034439cf2ceb27f">asterisk_publication_config::mailbox_state_filter</a></div><div class="ttdeci">unsigned int mailbox_state_filter</div><div class="ttdoc">Mailbox state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00128">res_pjsip_publish_asterisk.c:128</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a32af426a78f232ce1dda0d1fd0479319"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a32af426a78f232ce1dda0d1fd0479319">asterisk_publication_config::mailbox_state_regex</a></div><div class="ttdeci">regex_t mailbox_state_regex</div><div class="ttdoc">Regex used for filtering inbound mailbox state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00126">res_pjsip_publish_asterisk.c:126</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_ad194d0988a40ea1a3e7d9495c8c0b003"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#ad194d0988a40ea1a3e7d9495c8c0b003">asterisk_publication_config::device_state_filter</a></div><div class="ttdeci">unsigned int device_state_filter</div><div class="ttdoc">Device state should be filtered. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00122">res_pjsip_publish_asterisk.c:122</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a117331eae05adada5f30ca06c94a9572"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a117331eae05adada5f30ca06c94a9572">asterisk_publication_config::device_state_regex</a></div><div class="ttdeci">regex_t device_state_regex</div><div class="ttdoc">Regex used for filtering inbound device state. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00120">res_pjsip_publish_asterisk.c:120</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c6ac25ea7536c0bc9ed18cbcf917527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6ac25ea7536c0bc9ed18cbcf917527">&#9670;&nbsp;</a></span>reload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int reload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00918">918</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01442">ast_sorcery_reload_object()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00766">asterisk_publication_send_refresh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00925">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;{</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a6eb1409f4eea742398544863fd284276">asterisk_publication_send_refresh</a>();</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a6eb1409f4eea742398544863fd284276"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a6eb1409f4eea742398544863fd284276">asterisk_publication_send_refresh</a></div><div class="ttdeci">static void asterisk_publication_send_refresh(void)</div><div class="ttdoc">Internal function to send refresh requests to all publications. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00766">res_pjsip_publish_asterisk.c:766</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad98ae6e153f53b0c3c40119acc5e5266"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a></div><div class="ttdeci">void ast_sorcery_reload_object(const struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Inform any wizards of a specific object type to reload persistent objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01442">sorcery.c:1442</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae971c2a576960c2686d9377b127caea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae971c2a576960c2686d9377b127caea9">&#9670;&nbsp;</a></span>send_refresh_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int send_refresh_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00741">741</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00528">ast_sip_publish_client_get()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00842">ast_sip_publish_client_send()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00085">asterisk_devicestate_publisher_state::client</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::devicestate_publish</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">asterisk_publication_config::mailboxstate_publish</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00766">asterisk_publication_send_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;{</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a> = obj;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a> *client;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#acaeb988872c220dfdc34e4bc538abc33">devicestate_publish</a>)) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      client = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#aefd7c57ffa48b8af08a6037348cc8051">ast_sip_publish_client_get</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#acaeb988872c220dfdc34e4bc538abc33">devicestate_publish</a>);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keywordflow">if</span> (client) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;         <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a4fc13fb50475b59d055cbec2d8ece47c">ast_sip_publish_client_send</a>(client, arg);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client, -1);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a6871330fea353e00feaccea7712a0b21">mailboxstate_publish</a>)) {</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      client = <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#aefd7c57ffa48b8af08a6037348cc8051">ast_sip_publish_client_get</a>(config-&gt;<a class="code" href="../../dd/db3/structasterisk__publication__config.html#a6871330fea353e00feaccea7712a0b21">mailboxstate_publish</a>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">if</span> (client) {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;         <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a4fc13fb50475b59d055cbec2d8ece47c">ast_sip_publish_client_send</a>(client, arg);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(client, -1);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_a6871330fea353e00feaccea7712a0b21"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#a6871330fea353e00feaccea7712a0b21">asterisk_publication_config::mailboxstate_publish</a></div><div class="ttdeci">const ast_string_field mailboxstate_publish</div><div class="ttdoc">Optional name of a mailbox state publish item, used to request the remote side update us...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">res_pjsip_publish_asterisk.c:116</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_aefd7c57ffa48b8af08a6037348cc8051"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#aefd7c57ffa48b8af08a6037348cc8051">ast_sip_publish_client_get</a></div><div class="ttdeci">struct ast_sip_outbound_publish_client * ast_sip_publish_client_get(const char *name)</div><div class="ttdoc">Find a publish client using its name. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00528">res_pjsip_outbound_publish.c:528</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="res__pjsip__outbound__publish_8h_html_a4fc13fb50475b59d055cbec2d8ece47c"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a4fc13fb50475b59d055cbec2d8ece47c">ast_sip_publish_client_send</a></div><div class="ttdeci">int ast_sip_publish_client_send(struct ast_sip_outbound_publish_client *client, const struct ast_sip_body *body)</div><div class="ttdoc">Send an outgoing PUBLISH message using a client. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00842">res_pjsip_outbound_publish.c:842</a></div></div>
<div class="ttc" id="structast__sip__outbound__publish__client_html"><div class="ttname"><a href="../../d3/dd9/structast__sip__outbound__publish__client.html">ast_sip_outbound_publish_client</a></div><div class="ttdoc">Outbound publish client state information (persists for lifetime of a publish) </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00228">res_pjsip_outbound_publish.c:228</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html">asterisk_publication_config</a></div><div class="ttdoc">Structure which contains Asterisk publication information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00107">res_pjsip_publish_asterisk.c:107</a></div></div>
<div class="ttc" id="structasterisk__publication__config_html_acaeb988872c220dfdc34e4bc538abc33"><div class="ttname"><a href="../../dd/db3/structasterisk__publication__config.html#acaeb988872c220dfdc34e4bc538abc33">asterisk_publication_config::devicestate_publish</a></div><div class="ttdeci">const ast_string_field devicestate_publish</div><div class="ttdoc">Optional name of a device state publish item struct ast_string_field_mgr __field_mgr used to request ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00116">res_pjsip_publish_asterisk.c:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00925">925</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00326">AST_MODPRI_CHANNEL_DEPEND</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00641">ast_sip_unregister_event_publisher_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02738">ast_sip_unregister_publish_handler()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01061">ast_sorcery_object_unregister()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00862">load_module()</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00741">reload()</a>, and <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00918">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;{</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a>);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   <a class="code" href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a>);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;   <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a19a9158e2cabc358e93d877e0b8b8b03">ast_sip_unregister_event_publisher_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ac29f24c7e97bcbb87b802bb1cc2bca82">asterisk_devicestate_publisher_handler</a>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   <a class="code" href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a19a9158e2cabc358e93d877e0b8b8b03">ast_sip_unregister_event_publisher_handler</a>(&amp;<a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a08c237b30dd3b1ca497ccb5eb0eca8e7">asterisk_mwi_publisher_handler</a>);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a7956acdd8675b6d55407ea134fb371cc">ast_sorcery_object_unregister</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;asterisk-publication&quot;</span>);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;}</div><div class="ttc" id="res__pjsip__outbound__publish_8h_html_a19a9158e2cabc358e93d877e0b8b8b03"><div class="ttname"><a href="../../dd/dd4/res__pjsip__outbound__publish_8h.html#a19a9158e2cabc358e93d877e0b8b8b03">ast_sip_unregister_event_publisher_handler</a></div><div class="ttdeci">void ast_sip_unregister_event_publisher_handler(struct ast_sip_event_publisher_handler *handler)</div><div class="ttdoc">Unregister a publish handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00641">res_pjsip_outbound_publish.c:641</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a065a2a4147e199cb6b86b3f19bc0b184"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a065a2a4147e199cb6b86b3f19bc0b184">asterisk_devicestate_publication_handler</a></div><div class="ttdeci">struct ast_sip_publish_handler asterisk_devicestate_publication_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00806">res_pjsip_publish_asterisk.c:806</a></div></div>
<div class="ttc" id="sorcery_8h_html_a7956acdd8675b6d55407ea134fb371cc"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a7956acdd8675b6d55407ea134fb371cc">ast_sorcery_object_unregister</a></div><div class="ttdeci">int ast_sorcery_object_unregister(struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Unregister an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01061">sorcery.c:1061</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_ac29f24c7e97bcbb87b802bb1cc2bca82"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#ac29f24c7e97bcbb87b802bb1cc2bca82">asterisk_devicestate_publisher_handler</a></div><div class="ttdeci">struct ast_sip_event_publisher_handler asterisk_devicestate_publisher_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00395">res_pjsip_publish_asterisk.c:395</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a08c237b30dd3b1ca497ccb5eb0eca8e7"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a08c237b30dd3b1ca497ccb5eb0eca8e7">asterisk_mwi_publisher_handler</a></div><div class="ttdeci">struct ast_sip_event_publisher_handler asterisk_mwi_publisher_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00473">res_pjsip_publish_asterisk.c:473</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_aecd29e2fefb02a8d50b2fc6b24b6e1cf"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aecd29e2fefb02a8d50b2fc6b24b6e1cf">asterisk_mwi_publication_handler</a></div><div class="ttdeci">struct ast_sip_publish_handler asterisk_mwi_publication_handler</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00812">res_pjsip_publish_asterisk.c:812</a></div></div>
<div class="ttc" id="res__pjsip__pubsub_8h_html_a65b342a28c864a472dfff5ea27de8691"><div class="ttname"><a href="../../dc/db0/res__pjsip__pubsub_8h.html#a65b342a28c864a472dfff5ea27de8691">ast_sip_unregister_publish_handler</a></div><div class="ttdeci">void ast_sip_unregister_publish_handler(struct ast_sip_publish_handler *handler)</div><div class="ttdoc">Unregister a publish handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l02738">res_pjsip_pubsub.c:2738</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Asterisk Event <a class="el" href="../../d1/da4/res__corosync_8c.html#a9bfa8c10a4adec48448b4c49ec5b3cb5abd1a204dcfa4933760cd12e779f36fc5">PUBLISH</a> Support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .reload = reload_module, .unload = unload_module, .load_pri = AST_MODPRI_CHANNEL_DEPEND + 5, .requires = &quot;res_pjsip,res_pjsip_outbound_publish,res_pjsip_pubsub&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00942">942</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00942">942</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="a065a2a4147e199cb6b86b3f19bc0b184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a065a2a4147e199cb6b86b3f19bc0b184">&#9670;&nbsp;</a></span>asterisk_devicestate_publication_handler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> asterisk_devicestate_publication_handler</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .event_name = <span class="stringliteral">&quot;asterisk-devicestate&quot;</span>,</div><div class="line">   .new_publication = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#add9cc981b192e9f8aaeae3fed03f4c6c">asterisk_publication_new</a>,</div><div class="line">   .publication_state_change = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#acf0d829696b4c54e83e0db72a8d6115a">asterisk_publication_devicestate_state_change</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_acf0d829696b4c54e83e0db72a8d6115a"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#acf0d829696b4c54e83e0db72a8d6115a">asterisk_publication_devicestate_state_change</a></div><div class="ttdeci">static int asterisk_publication_devicestate_state_change(struct ast_sip_publication *pub, pjsip_msg_body *body, enum ast_sip_publish_state state)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00594">res_pjsip_publish_asterisk.c:594</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_add9cc981b192e9f8aaeae3fed03f4c6c"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#add9cc981b192e9f8aaeae3fed03f4c6c">asterisk_publication_new</a></div><div class="ttdeci">static int asterisk_publication_new(struct ast_sip_endpoint *endpoint, const char *resource, const char *event_configuration)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00479">res_pjsip_publish_asterisk.c:479</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00806">806</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="ac29f24c7e97bcbb87b802bb1cc2bca82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac29f24c7e97bcbb87b802bb1cc2bca82">&#9670;&nbsp;</a></span>asterisk_devicestate_publisher_handler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d7d/structast__sip__event__publisher__handler.html">ast_sip_event_publisher_handler</a> asterisk_devicestate_publisher_handler</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .event_name = <span class="stringliteral">&quot;asterisk-devicestate&quot;</span>,</div><div class="line">   .start_publishing = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a8523fe5f7acfb21272ae5d8540ea7db6">asterisk_start_devicestate_publishing</a>,</div><div class="line">   .stop_publishing = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a228cf4bd890d2155c264e1abb40638eb">asterisk_stop_devicestate_publishing</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a228cf4bd890d2155c264e1abb40638eb"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a228cf4bd890d2155c264e1abb40638eb">asterisk_stop_devicestate_publishing</a></div><div class="ttdeci">static int asterisk_stop_devicestate_publishing(struct ast_sip_outbound_publish_client *client)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00374">res_pjsip_publish_asterisk.c:374</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a8523fe5f7acfb21272ae5d8540ea7db6"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a8523fe5f7acfb21272ae5d8540ea7db6">asterisk_start_devicestate_publishing</a></div><div class="ttdeci">static int asterisk_start_devicestate_publishing(struct ast_sip_outbound_publish *configuration, struct ast_sip_outbound_publish_client *client)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">res_pjsip_publish_asterisk.c:322</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00395">395</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="ae5bba0c85c012b82bb439cdd3a9b59ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5bba0c85c012b82bb439cdd3a9b59ce">&#9670;&nbsp;</a></span>asterisk_devicestate_publisher_state_datastore</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> asterisk_devicestate_publisher_state_datastore</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .type = <span class="stringliteral">&quot;asterisk-devicestate-publisher&quot;</span>,</div><div class="line">   .destroy = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a153cb152b61029edeb05f294cbbc0059">asterisk_devicestate_publisher_state_destroy</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a153cb152b61029edeb05f294cbbc0059"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a153cb152b61029edeb05f294cbbc0059">asterisk_devicestate_publisher_state_destroy</a></div><div class="ttdeci">static void asterisk_devicestate_publisher_state_destroy(void *obj)</div><div class="ttdoc">Destroy callback for Asterisk devicestate publisher state information from datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00132">res_pjsip_publish_asterisk.c:132</a></div></div>
</div><!-- fragment -->
<p>Datastore for attaching devicestate publisher state information. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00144">144</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="aecd29e2fefb02a8d50b2fc6b24b6e1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecd29e2fefb02a8d50b2fc6b24b6e1cf">&#9670;&nbsp;</a></span>asterisk_mwi_publication_handler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d5/d9f/structast__sip__publish__handler.html">ast_sip_publish_handler</a> asterisk_mwi_publication_handler</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .event_name = <span class="stringliteral">&quot;asterisk-mwi&quot;</span>,</div><div class="line">   .new_publication = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#add9cc981b192e9f8aaeae3fed03f4c6c">asterisk_publication_new</a>,</div><div class="line">   .publication_state_change = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aff7a7c696db1a20b65ec992a06c0ed7c">asterisk_publication_mwi_state_change</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_add9cc981b192e9f8aaeae3fed03f4c6c"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#add9cc981b192e9f8aaeae3fed03f4c6c">asterisk_publication_new</a></div><div class="ttdeci">static int asterisk_publication_new(struct ast_sip_endpoint *endpoint, const char *resource, const char *event_configuration)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00479">res_pjsip_publish_asterisk.c:479</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_aff7a7c696db1a20b65ec992a06c0ed7c"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#aff7a7c696db1a20b65ec992a06c0ed7c">asterisk_publication_mwi_state_change</a></div><div class="ttdeci">static int asterisk_publication_mwi_state_change(struct ast_sip_publication *pub, pjsip_msg_body *body, enum ast_sip_publish_state state)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00685">res_pjsip_publish_asterisk.c:685</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00812">812</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="a08c237b30dd3b1ca497ccb5eb0eca8e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08c237b30dd3b1ca497ccb5eb0eca8e7">&#9670;&nbsp;</a></span>asterisk_mwi_publisher_handler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d7d/structast__sip__event__publisher__handler.html">ast_sip_event_publisher_handler</a> asterisk_mwi_publisher_handler</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .event_name = <span class="stringliteral">&quot;asterisk-mwi&quot;</span>,</div><div class="line">   .start_publishing = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a27f1eb91c0d170ec6209debabe34a729">asterisk_start_mwi_publishing</a>,</div><div class="line">   .stop_publishing = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a4e78451d3636e537c9f34da01b62f2c6">asterisk_stop_mwi_publishing</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a27f1eb91c0d170ec6209debabe34a729"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a27f1eb91c0d170ec6209debabe34a729">asterisk_start_mwi_publishing</a></div><div class="ttdeci">static int asterisk_start_mwi_publishing(struct ast_sip_outbound_publish *configuration, struct ast_sip_outbound_publish_client *client)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">res_pjsip_publish_asterisk.c:401</a></div></div>
<div class="ttc" id="res__pjsip__publish__asterisk_8c_html_a4e78451d3636e537c9f34da01b62f2c6"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#a4e78451d3636e537c9f34da01b62f2c6">asterisk_stop_mwi_publishing</a></div><div class="ttdeci">static int asterisk_stop_mwi_publishing(struct ast_sip_outbound_publish_client *client)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00452">res_pjsip_publish_asterisk.c:452</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00473">473</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
<a id="ae8c0ef2a71fb872a04bf13333a0284c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c0ef2a71fb872a04bf13333a0284c5">&#9670;&nbsp;</a></span>asterisk_mwi_publisher_state_datastore</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> asterisk_mwi_publisher_state_datastore</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .type = <span class="stringliteral">&quot;asterisk-mwi-publisher&quot;</span>,</div><div class="line">   .destroy = <a class="code" href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#af15b57d7620dae0cee0a3ad8c9136064">asterisk_mwi_publisher_state_destroy</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__publish__asterisk_8c_html_af15b57d7620dae0cee0a3ad8c9136064"><div class="ttname"><a href="../../dc/d7a/res__pjsip__publish__asterisk_8c.html#af15b57d7620dae0cee0a3ad8c9136064">asterisk_mwi_publisher_state_destroy</a></div><div class="ttdeci">static void asterisk_mwi_publisher_state_destroy(void *obj)</div><div class="ttdoc">Destroy callback for Asterisk mwi publisher state information from datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00150">res_pjsip_publish_asterisk.c:150</a></div></div>
</div><!-- fragment -->
<p>Datastore for attaching devicestate publisher state information. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00162">162</a> of file <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html">res_pjsip_publish_asterisk.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:32 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
